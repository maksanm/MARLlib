{"episode_reward_max": -279.40293803066015, "episode_reward_min": -355.1383618116379, "episode_reward_mean": -312.1675806593868, "episode_len_mean": 66.75409836065573, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {"shared_policy": -125.79163304964702}, "policy_reward_max": {"shared_policy": -88.27156214912733}, "policy_reward_mean": {"shared_policy": -104.05586021979558}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-313.5679015442729, -301.2351281642914, -296.2523092664778, -318.8787045478821, -313.9303191304207, -300.39007195830345, -292.876794140786, -315.610549306497, -317.98282150924206, -295.15678453445435, -306.76253363490105, -298.08226938545704, -319.06086215376854, -304.7111826054752, -311.5736984163523, -315.665210083127, -332.15723529458046, -290.1175442188978, -300.273420907557, -321.51030944287777, -332.19585755467415, -321.6169904768467, -315.688226044178, -355.1383618116379, -290.1170043796301, -293.5261091664434, -316.4459116831422, -317.4915558695793, -314.3620429933071, -322.4201735854149, -305.5444967448712, -301.3059106171131, -324.60313415527344, -308.7657293751836, -324.68854182958603, -319.2097664773465, -304.3688349328004, -305.7590892165899, -304.37384252250195, -324.5401130914688, -312.54295539855957, -339.4014610052109, -336.09131766855717, -314.0310167968273, -314.80730724334717, -296.1288979947567, -280.0581797659397, -329.34003318846226, -332.8865547180176, -312.00266943871975, -279.40293803066015, -306.15963016450405, -293.47821313142776, -300.1781656742096, -290.76112389564514, -338.8953387439251, -308.2491048127413, -319.1656655371189, -311.83391162008047, -325.1202866509557, -333.7303059697151], "episode_lengths": [64, 44, 65, 62, 67, 78, 58, 59, 67, 53, 69, 64, 68, 70, 61, 59, 66, 131, 49, 62, 91, 53, 94, 84, 73, 84, 71, 57, 59, 48, 68, 88, 66, 68, 50, 61, 62, 65, 63, 49, 67, 64, 83, 48, 65, 63, 74, 64, 59, 63, 105, 55, 85, 71, 61, 77, 61, 48, 58, 74, 57], "policy_shared_policy_reward": [-99.91816829641661, -99.90972511221966, -113.74000813563666, -97.42828879753749, -108.37561968962352, -95.43121967713039, -105.8057628373305, -93.68589408571522, -96.76065234343211, -101.37061295906703, -115.0432976881663, -102.46479390064876, -111.10344604651134, -100.67630873123805, -102.15056435267131, -107.58284298578899, -95.35415304700534, -97.45307592550914, -93.06910556678972, -105.5600531299909, -94.24763544400534, -99.90185928406815, -100.58800643185775, -115.12068359057109, -101.3907464494308, -114.77145357926688, -101.82062148054442, -106.2065737048785, -94.79166359702747, -94.1585472325484, -99.2455009619395, -109.35096482435863, -98.16606784860294, -95.18443570534389, -107.8121005098025, -95.08573317031066, -112.59844415386519, -101.64885350068411, -104.81356449921927, -101.85859473546347, -99.15740594392022, -103.69518192609152, -113.93524630864462, -98.72864550848803, -98.90980659921965, -100.72277155021827, -101.40784908334415, -113.53458944956462, -108.35588524738948, -106.55075738827388, -117.25059265891711, -92.71135034163794, -92.66566315790018, -104.74053071935973, -98.57167236010234, -107.47090868155162, -94.23083986590306, -103.53206230203311, -115.85364131132762, -102.12460582951705, -106.6896599829197, -106.89654338359833, -118.60965418815613, -103.21466825405757, -102.82132066289584, -115.5810015598933, -101.44160657127699, -112.44905724128088, -101.79756223162016, -114.29736288388571, -124.29579468568167, -116.54520424207053, -104.10935598611832, -92.53384973108768, -93.47379866242409, -94.49965505798659, -106.08420832951865, -92.94224577893814, -99.69084429492554, -112.19703181584677, -104.5580355723699, -101.62095151344936, -101.85895256201427, -114.0116517941157, -100.36786715189616, -113.37376217047374, -100.62041367093722, -115.3465548157692, -103.41262027621269, -103.660998493433, -98.09278531869253, -98.11638235052428, -109.33532907565436, -96.89474979043007, -107.2242614030838, -97.18689942359924, -103.95541163285574, -116.56154783566794, -104.08617468674979, -98.20267641544342, -97.67085535079241, -112.89219760894775, -103.92169225215912, -104.1124238371849, -116.654425740242, -103.83610703547797, -113.9543060262998, -101.41935341556868, -96.51675638572003, -99.21530888477962, -108.63676966230075, -99.26802744468054, -109.81994916995367, -96.67111260195574, -97.28944720327854, -97.7700529396534, -109.31434237957001, -104.11085979143779, -115.34622595707576, -105.08302734295528, -107.92013818025589, -107.00908416509628, -97.6137330532074, -106.51205941041312, -109.62303026517233, -123.26637132962546, -105.68235821525256, -104.6173264036576, -125.79163304964702, -104.20041346549988, -99.3471602499485, -110.48344308137894, -103.23227310180664, -100.61086678504944, -110.96416735649109, -107.08088086048762, -94.6591753239433, -94.38884181032579, -100.69369985659918, -88.27156214912733, -91.09291776021323, -104.57824064791203, -118.76628851890564, -105.99550402164459, -106.83052444458008, -106.44270652532578, -119.61332374811172, -99.98683686554432, -112.64752495288849, -99.36830762028694, -89.3144501845042, -88.84943408022325, -101.23905376593272, -97.82651445766291, -108.96305351456007, -99.3700621922811, -104.86885563532512, -94.33289961020152, -94.27645788590114, -103.56965331236522, -104.05427275101344, -92.55423961083095, -93.05192778507869, -92.72154192129771, -104.98765418926875, -108.57210943102837, -120.20489597320557, -110.11833333969116, -97.12441098193328, -99.45850853125255, -111.66618529955547, -114.11563978592555, -102.13945240775745, -102.91057334343593, -111.10109333197276, -99.15638655672471, -101.57643173138301, -109.14277993390958, -112.85302762190501, -103.1244790951411, -106.78887941439947, -118.56653400262198, -108.3748925526937]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18357467613920458, "mean_inference_ms": 0.6939215535428848, "mean_action_processing_ms": 0.09765136944428893, "mean_env_wait_ms": 0.7636654747940201, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 5000, "timesteps_this_iter": 0, "agent_timesteps_total": 15000, "timers": {"sample_time_ms": 8718.914, "sample_throughput": 573.466, "load_time_ms": 0.999, "load_throughput": 5002748.092, "learn_time_ms": 1948.276, "learn_throughput": 2566.372, "update_time_ms": 9.003}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005000000000000001, "total_loss": 4773.2732421875, "policy_loss": -0.003961874904620188, "vf_loss": 4773.33330078125, "vf_explained_var": 9.860992431640626e-05, "kl": 0.002755836641881668, "entropy": 5.684543132781982, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 5000, "num_agent_steps_sampled": 15000, "num_steps_trained": 5000, "num_agent_steps_trained": 15000}, "done": false, "episodes_total": 61, "training_iteration": 1, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-01-31", "timestamp": 1706230891, "time_this_iter_s": 10.661401748657227, "time_total_s": 10.661401748657227, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402530040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10.661401748657227, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 6.7875, "ram_util_percent": 48.41875}}
{"episode_reward_max": -6.86010457575324, "episode_reward_min": -371.0454815030098, "episode_reward_mean": -300.65966178868064, "episode_len_mean": 86.27835051546391, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {"shared_policy": -133.9157435099284}, "policy_reward_max": {"shared_policy": -2.0922368516524728}, "policy_reward_mean": {"shared_policy": -100.21988726289354}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-313.5679015442729, -301.2351281642914, -296.2523092664778, -318.8787045478821, -313.9303191304207, -300.39007195830345, -292.876794140786, -315.610549306497, -317.98282150924206, -295.15678453445435, -306.76253363490105, -298.08226938545704, -319.06086215376854, -304.7111826054752, -311.5736984163523, -315.665210083127, -332.15723529458046, -290.1175442188978, -300.273420907557, -321.51030944287777, -332.19585755467415, -321.6169904768467, -315.688226044178, -355.1383618116379, -290.1170043796301, -293.5261091664434, -316.4459116831422, -317.4915558695793, -314.3620429933071, -322.4201735854149, -305.5444967448712, -301.3059106171131, -324.60313415527344, -308.7657293751836, -324.68854182958603, -319.2097664773465, -304.3688349328004, -305.7590892165899, -304.37384252250195, -324.5401130914688, -312.54295539855957, -339.4014610052109, -336.09131766855717, -314.0310167968273, -314.80730724334717, -296.1288979947567, -280.0581797659397, -329.34003318846226, -332.8865547180176, -312.00266943871975, -279.40293803066015, -306.15963016450405, -293.47821313142776, -300.1781656742096, -290.76112389564514, -338.8953387439251, -308.2491048127413, -319.1656655371189, -311.83391162008047, -325.1202866509557, -333.7303059697151, -308.1078373938799, -303.0289419144392, -306.7899583596736, -302.7734361588955, -303.6256717443466, -316.8340182341635, -304.11686727404594, -322.0391941871494, -45.91918369010092, -317.42198272794485, -301.38047590851784, -305.67082203552127, -318.0444764494896, -302.9867502748966, -299.76533068716526, -301.50337424874306, -323.4900929033756, -315.58825746178627, -312.0611625611782, -316.60696712136274, -321.1807188093663, -320.66646660864353, -314.1611017584801, -303.60408579558134, -306.13751144707203, -83.76946220919493, -305.31040024757385, -298.157811075449, -62.397217005491356, -290.024359382689, -6.86010457575324, -311.77576887607574, -314.8489642441273, -287.02538549900055, -297.0451329052448, -371.0454815030098], "episode_lengths": [64, 44, 65, 62, 67, 78, 58, 59, 67, 53, 69, 64, 68, 70, 61, 59, 66, 131, 49, 62, 91, 53, 94, 84, 73, 84, 71, 57, 59, 48, 68, 88, 66, 68, 50, 61, 62, 65, 63, 49, 67, 64, 83, 48, 65, 63, 74, 64, 59, 63, 105, 55, 85, 71, 61, 77, 61, 48, 58, 74, 57, 57, 51, 67, 51, 70, 55, 48, 86, 500, 62, 66, 56, 58, 105, 154, 64, 79, 61, 59, 92, 81, 51, 97, 73, 96, 500, 63, 62, 500, 71, 500, 45, 48, 66, 82, 121], "policy_shared_policy_reward": [-99.91816829641661, -99.90972511221966, -113.74000813563666, -97.42828879753749, -108.37561968962352, -95.43121967713039, -105.8057628373305, -93.68589408571522, -96.76065234343211, -101.37061295906703, -115.0432976881663, -102.46479390064876, -111.10344604651134, -100.67630873123805, -102.15056435267131, -107.58284298578899, -95.35415304700534, -97.45307592550914, -93.06910556678972, -105.5600531299909, -94.24763544400534, -99.90185928406815, -100.58800643185775, -115.12068359057109, -101.3907464494308, -114.77145357926688, -101.82062148054442, -106.2065737048785, -94.79166359702747, -94.1585472325484, -99.2455009619395, -109.35096482435863, -98.16606784860294, -95.18443570534389, -107.8121005098025, -95.08573317031066, -112.59844415386519, -101.64885350068411, -104.81356449921927, -101.85859473546347, -99.15740594392022, -103.69518192609152, -113.93524630864462, -98.72864550848803, -98.90980659921965, -100.72277155021827, -101.40784908334415, -113.53458944956462, -108.35588524738948, -106.55075738827388, -117.25059265891711, -92.71135034163794, -92.66566315790018, -104.74053071935973, -98.57167236010234, -107.47090868155162, -94.23083986590306, -103.53206230203311, -115.85364131132762, -102.12460582951705, -106.6896599829197, -106.89654338359833, -118.60965418815613, -103.21466825405757, -102.82132066289584, -115.5810015598933, -101.44160657127699, -112.44905724128088, -101.79756223162016, -114.29736288388571, -124.29579468568167, -116.54520424207053, -104.10935598611832, -92.53384973108768, -93.47379866242409, -94.49965505798659, -106.08420832951865, -92.94224577893814, -99.69084429492554, -112.19703181584677, -104.5580355723699, -101.62095151344936, -101.85895256201427, -114.0116517941157, -100.36786715189616, -113.37376217047374, -100.62041367093722, -115.3465548157692, -103.41262027621269, -103.660998493433, -98.09278531869253, -98.11638235052428, -109.33532907565436, -96.89474979043007, -107.2242614030838, -97.18689942359924, -103.95541163285574, -116.56154783566794, -104.08617468674979, -98.20267641544342, -97.67085535079241, -112.89219760894775, -103.92169225215912, -104.1124238371849, -116.654425740242, -103.83610703547797, -113.9543060262998, -101.41935341556868, -96.51675638572003, -99.21530888477962, -108.63676966230075, -99.26802744468054, -109.81994916995367, -96.67111260195574, -97.28944720327854, -97.7700529396534, -109.31434237957001, -104.11085979143779, -115.34622595707576, -105.08302734295528, -107.92013818025589, -107.00908416509628, -97.6137330532074, -106.51205941041312, -109.62303026517233, -123.26637132962546, -105.68235821525256, -104.6173264036576, -125.79163304964702, -104.20041346549988, -99.3471602499485, -110.48344308137894, -103.23227310180664, -100.61086678504944, -110.96416735649109, -107.08088086048762, -94.6591753239433, -94.38884181032579, -100.69369985659918, -88.27156214912733, -91.09291776021323, -104.57824064791203, -118.76628851890564, -105.99550402164459, -106.83052444458008, -106.44270652532578, -119.61332374811172, -99.98683686554432, -112.64752495288849, -99.36830762028694, -89.3144501845042, -88.84943408022325, -101.23905376593272, -97.82651445766291, -108.96305351456007, -99.3700621922811, -104.86885563532512, -94.33289961020152, -94.27645788590114, -103.56965331236522, -104.05427275101344, -92.55423961083095, -93.05192778507869, -92.72154192129771, -104.98765418926875, -108.57210943102837, -120.20489597320557, -110.11833333969116, -97.12441098193328, -99.45850853125255, -111.66618529955547, -114.11563978592555, -102.13945240775745, -102.91057334343593, -111.10109333197276, -99.15638655672471, -101.57643173138301, -109.14277993390958, -112.85302762190501, -103.1244790951411, -106.78887941439947, -118.56653400262198, -108.3748925526937, -98.32357941567898, -110.2935898900032, -99.49066808819771, -97.46613306800525, -108.81346968809764, -96.74933915833633, -97.3765566367656, -99.38936692476273, -110.0240347981453, -99.13975526889166, -95.33046846588454, -108.30321242411932, -109.0470351378123, -97.50847176710765, -97.07016483942668, -98.75909255320828, -101.8533762494723, -116.22154943148296, -98.08497327566147, -97.88872736692429, -108.14316663146019, -103.98910952607791, -102.86059019031624, -115.18949447075526, -15.698482329646751, -15.27999133865039, -14.940710021803781, -102.72818049788475, -113.52523183822632, -101.16857039183378, -96.62683124343555, -96.83879459897678, -107.91485006610553, -97.2526248904566, -110.60476301113765, -97.81343413392703, -102.64483737945557, -114.29517912864685, -101.10445994138718, -98.07219757636389, -96.7075264354547, -108.20702626307806, -107.66563030083975, -96.55045138796171, -95.54924899836382, -108.65484420458476, -96.24809313813846, -96.60043690601985, -103.43816007177035, -104.55212573210399, -115.4998070995013, -103.31058293581009, -99.8414771258831, -112.43619740009308, -111.34014024337134, -99.92512821157774, -100.79589410622916, -115.69793625672659, -100.40213315685591, -100.50689770778021, -101.44679217537245, -113.50957824786505, -106.22434838612875, -101.11381007730961, -103.45905101299286, -116.09360551834106, -100.28840552767119, -101.22768949468932, -112.6450067361196, -96.7332759425044, -108.89813679456711, -97.97267305850983, -97.28288154304028, -98.52534118294716, -110.3292887210846, -27.650617046902582, -28.1217681268851, -27.99707703540723, -97.496815909942, -109.81755002339682, -97.99603431423506, -106.27988881866138, -96.94834492603938, -94.92957733074824, -20.839894910653435, -20.606326212485634, -20.950995882352196, -104.49580256144206, -93.57834074894588, -91.95021607230107, -2.0922368516524728, -2.178901781638473, -2.588965942462295, -98.80798425277075, -98.86572923262915, -114.10205539067587, -112.73525482416153, -100.8426941037178, -101.27101531624794, -90.89310665925345, -92.55144198735556, -103.58083685239157, -93.4711734255155, -94.98883180816969, -108.58512767155966, -117.64101860920589, -119.48871938387553, -133.9157435099284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18116144758456412, "mean_inference_ms": 0.7070197449467641, "mean_action_processing_ms": 0.09768079841564943, "mean_env_wait_ms": 0.7698056593304128, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 10000, "timesteps_this_iter": 0, "agent_timesteps_total": 30000, "timers": {"sample_time_ms": 9837.556, "sample_throughput": 508.256, "load_time_ms": 0.5, "load_throughput": 10005496.183, "learn_time_ms": 2005.789, "learn_throughput": 2492.785, "update_time_ms": 9.0}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005000000000000001, "total_loss": 2351.8185302734373, "policy_loss": -0.0028413070905146222, "vf_loss": 2351.877880859375, "vf_explained_var": 0.004355919361114502, "kl": 0.0022733064623028506, "entropy": 5.671597957611084, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 10000, "num_agent_steps_sampled": 30000, "num_steps_trained": 10000, "num_agent_steps_trained": 30000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 97, "training_iteration": 2, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-01-42", "timestamp": 1706230902, "time_this_iter_s": 11.039364099502563, "time_total_s": 21.70076584815979, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402417160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 21.70076584815979, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 9.013333333333332, "ram_util_percent": 48.88666666666666}}
{"episode_reward_max": 19.157824173569665, "episode_reward_min": -371.0454815030098, "episode_reward_mean": -288.60804728484015, "episode_len_mean": 102.45, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {"shared_policy": -133.9157435099284}, "policy_reward_max": {"shared_policy": 6.593720426162079}, "policy_reward_mean": {"shared_policy": -96.20268242828004}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-319.1656655371189, -311.83391162008047, -325.1202866509557, -333.7303059697151, -308.1078373938799, -303.0289419144392, -306.7899583596736, -302.7734361588955, -303.6256717443466, -316.8340182341635, -304.11686727404594, -322.0391941871494, -45.91918369010092, -317.42198272794485, -301.38047590851784, -305.67082203552127, -318.0444764494896, -302.9867502748966, -299.76533068716526, -301.50337424874306, -323.4900929033756, -315.58825746178627, -312.0611625611782, -316.60696712136274, -321.1807188093663, -320.66646660864353, -314.1611017584801, -303.60408579558134, -306.13751144707203, -83.76946220919493, -305.31040024757385, -298.157811075449, -62.397217005491356, -290.024359382689, -6.86010457575324, -311.77576887607574, -314.8489642441273, -287.02538549900055, -297.0451329052448, -371.0454815030098, -296.4766252338886, -318.9452875480056, -289.39638498425484, -334.12840084731585, -296.852352976799, -324.26395201683044, -292.46475057303905, -322.3472549319267, -302.57470716536045, -296.90190163627267, -298.9855902045965, -309.273605465889, -293.3283671999816, -301.0484873056412, -319.23590175807476, -290.7436625957489, -326.1800806224346, -294.2658740580082, -46.628836899995804, -307.9438086152077, -305.5102781653404, -328.48742574453354, -316.58755323663354, -319.0551731288433, -298.8661261498928, 19.157824173569665, -306.6914729848504, -310.04902151227, -298.08900820463896, -301.39508989453316, -304.0890755876899, -320.19849902391434, -312.94994482398033, -324.5073341280222, -306.28308983147144, -312.9831890463829, -341.41425663232803, -330.28122245520353, -21.72554663568735, -315.88288873434067, -321.42206164449453, -298.647482521832, -324.79286029934883, -307.74289271235466, -295.71553944796324, -324.14725279808044, -322.17619812488556, -302.02248099446297, -307.78472358360887, -320.42094188928604, -326.89787980914116, -310.6111964583397, -306.6365271359682, -305.9163391292095, -25.263689711689963, -305.65591635368764, -296.1592930853367, -305.02545496821404, -320.84542897343636, -303.4314213991165], "episode_lengths": [48, 58, 74, 57, 57, 51, 67, 51, 70, 55, 48, 86, 500, 62, 66, 56, 58, 105, 154, 64, 79, 61, 59, 92, 81, 51, 97, 73, 96, 500, 63, 62, 500, 71, 500, 45, 48, 66, 82, 121, 70, 47, 98, 69, 101, 47, 67, 82, 59, 59, 69, 56, 71, 79, 42, 108, 75, 68, 500, 60, 72, 75, 47, 63, 56, 500, 68, 61, 64, 83, 57, 58, 48, 63, 72, 50, 55, 55, 500, 59, 54, 55, 65, 71, 83, 71, 60, 59, 52, 65, 63, 74, 75, 76, 500, 70, 62, 72, 60, 91], "policy_shared_policy_reward": [-114.11563978592555, -102.13945240775745, -102.91057334343593, -111.10109333197276, -99.15638655672471, -101.57643173138301, -109.14277993390958, -112.85302762190501, -103.1244790951411, -106.78887941439947, -118.56653400262198, -108.3748925526937, -98.32357941567898, -110.2935898900032, -99.49066808819771, -97.46613306800525, -108.81346968809764, -96.74933915833633, -97.3765566367656, -99.38936692476273, -110.0240347981453, -99.13975526889166, -95.33046846588454, -108.30321242411932, -109.0470351378123, -97.50847176710765, -97.07016483942668, -98.75909255320828, -101.8533762494723, -116.22154943148296, -98.08497327566147, -97.88872736692429, -108.14316663146019, -103.98910952607791, -102.86059019031624, -115.18949447075526, -15.698482329646751, -15.27999133865039, -14.940710021803781, -102.72818049788475, -113.52523183822632, -101.16857039183378, -96.62683124343555, -96.83879459897678, -107.91485006610553, -97.2526248904566, -110.60476301113765, -97.81343413392703, -102.64483737945557, -114.29517912864685, -101.10445994138718, -98.07219757636389, -96.7075264354547, -108.20702626307806, -107.66563030083975, -96.55045138796171, -95.54924899836382, -108.65484420458476, -96.24809313813846, -96.60043690601985, -103.43816007177035, -104.55212573210399, -115.4998070995013, -103.31058293581009, -99.8414771258831, -112.43619740009308, -111.34014024337134, -99.92512821157774, -100.79589410622916, -115.69793625672659, -100.40213315685591, -100.50689770778021, -101.44679217537245, -113.50957824786505, -106.22434838612875, -101.11381007730961, -103.45905101299286, -116.09360551834106, -100.28840552767119, -101.22768949468932, -112.6450067361196, -96.7332759425044, -108.89813679456711, -97.97267305850983, -97.28288154304028, -98.52534118294716, -110.3292887210846, -27.650617046902582, -28.1217681268851, -27.99707703540723, -97.496815909942, -109.81755002339682, -97.99603431423506, -106.27988881866138, -96.94834492603938, -94.92957733074824, -20.839894910653435, -20.606326212485634, -20.950995882352196, -104.49580256144206, -93.57834074894588, -91.95021607230107, -2.0922368516524728, -2.178901781638473, -2.588965942462295, -98.80798425277075, -98.86572923262915, -114.10205539067587, -112.73525482416153, -100.8426941037178, -101.27101531624794, -90.89310665925345, -92.55144198735556, -103.58083685239157, -93.4711734255155, -94.98883180816969, -108.58512767155966, -117.64101860920589, -119.48871938387553, -133.9157435099284, -94.83499344189963, -105.83107288678488, -95.81055890520415, -113.96783196926117, -102.7678711116314, -102.20958446711302, -103.9315397143364, -92.38963356614113, -93.07521170377731, -109.89622958501181, -119.29159589608511, -104.9405753662189, -93.95107862353325, -95.82194206118584, -107.07933229207993, -114.8679972489675, -103.7204889257749, -105.67546584208807, -93.17347636322181, -105.18362996975581, -94.10764424006145, -103.37387076020241, -103.0054791867733, -115.96790498495102, -96.63992376625538, -109.11623293161392, -96.81855046749115, -108.36076126495998, -94.14476766313116, -94.39637270818154, -98.54189662138621, -94.4701588700215, -105.97353471318881, -99.41204700867335, -98.04573569695155, -111.81582276026408, -94.99437511960666, -105.46835706631343, -92.86563501406151, -97.15517516930899, -108.43997712930044, -95.45333500703177, -116.30452354749045, -101.57691334684691, -101.35446486373743, -92.93420434991519, -104.14237649242084, -93.66708175341289, -115.00640630722046, -104.93677452206612, -106.23689979314804, -94.40410605072975, -93.9958564043045, -105.86591160297394, -15.509850166738033, -15.33025123924017, -15.788735494017601, -98.18738536039989, -98.51683692137401, -111.23958633343379, -98.11063998937607, -109.07970124483109, -98.31993693113327, -107.53010183572769, -114.79950577020645, -106.1578181385994, -102.09453204274178, -114.3399807214737, -100.15304047241807, -112.61296457052231, -102.2985511124134, -104.14365744590759, -96.3165771663189, -107.35591632127762, -95.1936326622963, 6.593720426162079, 6.335025688012436, 6.22907805939515, -109.77176044384639, -99.23159186045329, -97.68812068055074, -111.03658839066824, -98.5644668241342, -100.44796629746756, -96.25099492073059, -107.7065823674202, -94.13143091648817, -96.81239002943039, -108.06274765729904, -96.51995220780373, -109.39003000656764, -96.48132270822923, -98.21772287289302, -104.11067239443462, -102.63783759872119, -113.44998903075854, -102.34944401184718, -100.7931238214175, -109.80737699071567, -116.77859270572662, -104.18006503582001, -103.54867638647556, -98.81208124756813, -110.28360533714294, -97.18740324676037, -100.91646734873454, -100.11802200476329, -111.94869969288509, -121.46419334411621, -111.00688117742538, -108.94318211078644, -104.24292372912169, -118.41304188966751, -107.62525683641434, -7.469946652650833, -7.203861758112907, -7.051738224923611, -112.42849479118983, -101.44799063603084, -102.00640330712001, -115.89857639869055, -101.75429461648068, -103.76919062932333, -108.0088260571162, -95.6465571920077, -94.9920992727081, -104.52274844050407, -114.81164008378983, -105.45847177505493, -109.6481214662393, -98.06474061806998, -100.03003062804541, -106.43409923712413, -93.74063757310311, -95.54080263773601, -104.75861367583275, -103.6850696504116, -115.70356947183609, -113.60968606670698, -103.2390918036302, -105.3274202545484, -97.12585281332335, -107.45972376068434, -97.4369044204553, -111.81078404188156, -98.0264443717897, -97.94749516993761, -102.6699450214704, -114.00579597552618, -103.74520089228949, -104.42967612544696, -116.926471332709, -105.54173235098521, -99.1716942191124, -100.06364315748215, -111.37585908174515, -97.27425310512385, -110.6899845202764, -98.67228951056799, -97.5743377606074, -98.1576814154784, -110.18431995312373, -8.284737775723144, -8.87473599116008, -8.10421594480674, -97.02054411234955, -110.33581064144771, -98.2995615998904, -95.5425197482109, -94.39648112654686, -106.22029221057892, -96.92142175634703, -110.35366596778235, -97.75036724408469, -103.08212850491206, -114.2518821756045, -103.5114182929198, -108.86123593648276, -97.13329162200293, -97.43689384063086]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17419642227037446, "mean_inference_ms": 0.7206062199617379, "mean_action_processing_ms": 0.09570203846343235, "mean_env_wait_ms": 0.7786973416035684, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 15000, "timesteps_this_iter": 0, "agent_timesteps_total": 45000, "timers": {"sample_time_ms": 10178.978, "sample_throughput": 491.208, "load_time_ms": 0.333, "load_throughput": 15008244.275, "learn_time_ms": 1989.302, "learn_throughput": 2513.445, "update_time_ms": 9.002}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 0.0005000000000000001, "total_loss": 3949.4992919921874, "policy_loss": -0.0030783088362341003, "vf_loss": 3949.5594482421875, "vf_explained_var": 0.0067433655261993405, "kl": 0.003318975404545578, "entropy": 5.726818418502807, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 15000, "num_agent_steps_sampled": 45000, "num_steps_trained": 15000, "num_agent_steps_trained": 45000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 157, "training_iteration": 3, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-01-53", "timestamp": 1706230913, "time_this_iter_s": 10.72847604751587, "time_total_s": 32.42924189567566, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214024175E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 32.42924189567566, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 8.26, "ram_util_percent": 48.97333333333333}}
{"episode_reward_max": -1.8773066475987719, "episode_reward_min": -341.41425663232803, "episode_reward_mean": -300.5535095321294, "episode_len_mean": 83.95, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {"shared_policy": -121.46419334411621}, "policy_reward_max": {"shared_policy": -0.19770776977142646}, "policy_reward_mean": {"shared_policy": -100.18450317737647}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-298.08900820463896, -301.39508989453316, -304.0890755876899, -320.19849902391434, -312.94994482398033, -324.5073341280222, -306.28308983147144, -312.9831890463829, -341.41425663232803, -330.28122245520353, -21.72554663568735, -315.88288873434067, -321.42206164449453, -298.647482521832, -324.79286029934883, -307.74289271235466, -295.71553944796324, -324.14725279808044, -322.17619812488556, -302.02248099446297, -307.78472358360887, -320.42094188928604, -326.89787980914116, -310.6111964583397, -306.6365271359682, -305.9163391292095, -25.263689711689963, -305.65591635368764, -296.1592930853367, -305.02545496821404, -320.84542897343636, -303.4314213991165, -300.7936459556222, -318.2207727134228, -309.93085849285126, -279.63332659751177, -333.9944015443325, -278.32205111533403, -296.88716607540846, -338.5570514500141, -329.61861833184963, -300.12968850135803, -322.2729280292988, -308.4394162222743, -271.54610840976244, -118.5060920640825, -314.5542992949486, -300.3091699779034, -312.08996594138443, -321.09884521365166, -310.97619940247387, -310.65483784675604, -306.3066740781069, -299.50854900479317, -309.89368855953217, -319.532245606184, -310.39798867702484, -1.8773066475987719, -290.6806256324053, -322.24107453227043, -298.3715006411076, -299.1064297556877, -307.75942364288494, -304.219454664737, -317.5862891972065, -323.79472920298576, -333.8600217998028, -310.3803810402751, -287.2433116585016, -318.75345477461815, -308.23221872001886, -323.6587574481964, -322.6164954304695, -291.7710897549987, -307.80061142891645, -323.45961129665375, -311.04514363221824, -335.0377206802368, -319.1859726086259, -311.2460402548313, -319.4777791798115, -333.5731703341007, -320.20395517349243, -307.04323676833883, -327.04906406998634, -288.87191731110215, -303.4997488707304, -310.07496439665556, -312.56836697459227, -291.6438816934824, -293.32382045686245, -322.9402827098966, -315.7199560701847, -313.1220774650574, -340.8336454629898, -293.84806320071226, -310.63927149772644, -305.09189538657665, -334.47210800647736, -298.1367685943842], "episode_lengths": [64, 83, 57, 58, 48, 63, 72, 50, 55, 55, 500, 59, 54, 55, 65, 71, 83, 71, 60, 59, 52, 65, 63, 74, 75, 76, 500, 70, 62, 72, 60, 91, 65, 61, 82, 69, 62, 70, 69, 70, 73, 56, 112, 87, 87, 500, 75, 72, 68, 59, 59, 115, 69, 65, 48, 59, 68, 500, 69, 81, 57, 69, 56, 69, 58, 71, 52, 52, 66, 70, 76, 63, 49, 66, 137, 53, 53, 68, 46, 57, 58, 64, 55, 56, 66, 77, 71, 58, 60, 68, 64, 63, 69, 85, 59, 76, 72, 66, 44, 64], "policy_shared_policy_reward": [-96.25099492073059, -107.7065823674202, -94.13143091648817, -96.81239002943039, -108.06274765729904, -96.51995220780373, -109.39003000656764, -96.48132270822923, -98.21772287289302, -104.11067239443462, -102.63783759872119, -113.44998903075854, -102.34944401184718, -100.7931238214175, -109.80737699071567, -116.77859270572662, -104.18006503582001, -103.54867638647556, -98.81208124756813, -110.28360533714294, -97.18740324676037, -100.91646734873454, -100.11802200476329, -111.94869969288509, -121.46419334411621, -111.00688117742538, -108.94318211078644, -104.24292372912169, -118.41304188966751, -107.62525683641434, -7.469946652650833, -7.203861758112907, -7.051738224923611, -112.42849479118983, -101.44799063603084, -102.00640330712001, -115.89857639869055, -101.75429461648068, -103.76919062932333, -108.0088260571162, -95.6465571920077, -94.9920992727081, -104.52274844050407, -114.81164008378983, -105.45847177505493, -109.6481214662393, -98.06474061806998, -100.03003062804541, -106.43409923712413, -93.74063757310311, -95.54080263773601, -104.75861367583275, -103.6850696504116, -115.70356947183609, -113.60968606670698, -103.2390918036302, -105.3274202545484, -97.12585281332335, -107.45972376068434, -97.4369044204553, -111.81078404188156, -98.0264443717897, -97.94749516993761, -102.6699450214704, -114.00579597552618, -103.74520089228949, -104.42967612544696, -116.926471332709, -105.54173235098521, -99.1716942191124, -100.06364315748215, -111.37585908174515, -97.27425310512385, -110.6899845202764, -98.67228951056799, -97.5743377606074, -98.1576814154784, -110.18431995312373, -8.284737775723144, -8.87473599116008, -8.10421594480674, -97.02054411234955, -110.33581064144771, -98.2995615998904, -95.5425197482109, -94.39648112654686, -106.22029221057892, -96.92142175634703, -110.35366596778235, -97.75036724408469, -103.08212850491206, -114.2518821756045, -103.5114182929198, -108.86123593648276, -97.13329162200293, -97.43689384063086, -96.02608865002792, -108.87103794018428, -95.89651936541001, -112.26313515504202, -102.68990366657576, -103.26773389180502, -110.18204645315807, -99.98448998729388, -99.76432205239932, -101.22786229848862, -88.94987764209509, -89.45558665692806, -108.08956841627757, -117.14961821834247, -108.75521490971248, -100.62197687228522, -88.42129437377056, -89.27877986927828, -107.0237367550532, -94.58770837138097, -95.2757209489743, -120.2055469751358, -109.33717495203018, -109.01432952284813, -118.98514207204184, -103.22169027974209, -107.41178598006567, -107.92460038264593, -95.52555560072264, -96.67953251798949, -103.58039000630379, -115.71727687120438, -102.97526115179062, -99.07884052892527, -111.02988137801489, -98.33069431533417, -98.0988806684812, -87.11152302225432, -86.3357047190269, -39.3464508180817, -39.702543457349144, -39.45709778865179, -112.29000246524811, -101.27395561337471, -100.99034121632576, -108.33560355504355, -95.59383310874304, -96.3797333141168, -99.2455833721906, -112.95296585559845, -99.89141671359539, -103.33406723539035, -104.30760912100475, -113.45716885725658, -100.1817513604959, -99.20419019864252, -111.59025784333548, -100.43017538388571, -111.28208549817404, -98.94257696469626, -97.65604447821777, -98.04658804337184, -110.60404155651729, -97.59798602263133, -95.01870275537173, -106.89186022679012, -99.7407728433609, -99.41675186157227, -110.736163854599, -100.38154966632526, -114.83939460913341, -104.31130133072536, -110.2210171421369, -100.12898697455725, -100.04798456033072, -0.19770776977142646, -1.0024920304616387, -0.6771068473657067, -104.57200451691946, -93.66704373558363, -92.44157737990221, -103.70015539725622, -103.21007483204207, -115.33084430297217, -96.44842251141867, -106.52997209628424, -95.39310603340468, -102.75531498591106, -103.29537389675777, -93.0557408730189, -100.47846152385077, -110.10751142104468, -97.17345069798952, -109.39424697558086, -96.67573830361168, -98.14946938554446, -101.49580126007399, -102.96379526456198, -113.12669267257056, -103.52262231707573, -105.35013246536255, -114.92197442054749, -120.55413389205933, -106.69184559583664, -106.61404231190681, -98.4687829737862, -111.89626481135687, -100.01533325513205, -91.45598360399406, -102.99839482704799, -92.7889332274596, -102.16099881132445, -114.29434307416281, -102.29811288913092, -97.716525601844, -109.47660929958026, -101.03908381859462, -114.81701958179474, -103.53227931261063, -105.30945855379105, -103.12388621767363, -115.59921302398047, -103.89339618881544, -104.46307656168938, -92.27405422180891, -95.0339589715004, -98.09933911512296, -98.4606553564469, -111.2406169573466, -115.56165379285812, -103.75877690315247, -104.13918060064316, -107.49981860319774, -101.02226746889453, -102.52305756012599, -108.64187455177307, -108.02199935913086, -118.37384676933289, -100.55509058882794, -101.3317231287559, -117.29915889104208, -110.78595725695293, -99.189500639836, -101.2705823580424, -113.60544157028198, -101.10074606537819, -104.7715915441513, -110.38117186228435, -118.93066720167796, -104.26133127013843, -115.4658071200053, -100.85736046234767, -103.88078759113948, -98.06728370472169, -98.27029162769517, -110.705661435922, -115.06877020994823, -104.42322702209155, -107.55706683794658, -93.75316230456035, -103.79662869373958, -91.32212631280224, -96.68254202107589, -108.66027144591014, -98.15693540374438, -110.74634635448456, -98.72213294357061, -100.60648509860039, -100.34887020786604, -100.04212041695914, -112.17737634976706, -91.83107317984104, -105.434386074543, -94.37842243909836, -92.34928218026957, -93.99269257982573, -106.98184569676718, -105.75253715117773, -115.77841540177664, -101.40933015694222, -101.72199410200119, -101.38568577170372, -112.6122761964798, -111.87455004453659, -100.45812165737152, -100.78940576314926, -120.690289636453, -111.14179452260336, -109.00156130393347, -94.84250237544379, -94.56526671846709, -104.44029410680136, -99.67133504152298, -98.50959342718124, -112.45834302902222, -109.72513288259506, -97.49115243554115, -97.87561006844044, -118.86396918694179, -106.43065128723781, -109.17748753229777, -107.7086511850357, -95.23488199710846, -95.19323541224003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17320633548258813, "mean_inference_ms": 0.7091900446992722, "mean_action_processing_ms": 0.09298527237192973, "mean_env_wait_ms": 0.7693342371558741, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 20000, "timesteps_this_iter": 0, "agent_timesteps_total": 60000, "timers": {"sample_time_ms": 10370.759, "sample_throughput": 482.125, "load_time_ms": 0.25, "load_throughput": 20010992.366, "learn_time_ms": 2002.381, "learn_throughput": 2497.027, "update_time_ms": 9.631}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 0.0005000000000000001, "total_loss": 4571.53359375, "policy_loss": -0.0024498177780550635, "vf_loss": 4571.594287109375, "vf_explained_var": -0.004062676429748535, "kl": 0.0028801826614659434, "entropy": 5.821639823913574, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 20000, "num_agent_steps_sampled": 60000, "num_steps_trained": 20000, "num_agent_steps_trained": 60000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 225, "training_iteration": 4, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-02-04", "timestamp": 1706230924, "time_this_iter_s": 11.00419807434082, "time_total_s": 43.43343997001648, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214024171F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 43.43343997001648, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 9.568750000000001, "ram_util_percent": 48.975}}
{"episode_reward_max": -1.8773066475987719, "episode_reward_min": -340.8336454629898, "episode_reward_mean": -306.0888488029031, "episode_len_mean": 74.38, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {"shared_policy": -120.690289636453}, "policy_reward_max": {"shared_policy": -0.19770776977142646}, "policy_reward_mean": {"shared_policy": -102.02961626763437}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-321.09884521365166, -310.97619940247387, -310.65483784675604, -306.3066740781069, -299.50854900479317, -309.89368855953217, -319.532245606184, -310.39798867702484, -1.8773066475987719, -290.6806256324053, -322.24107453227043, -298.3715006411076, -299.1064297556877, -307.75942364288494, -304.219454664737, -317.5862891972065, -323.79472920298576, -333.8600217998028, -310.3803810402751, -287.2433116585016, -318.75345477461815, -308.23221872001886, -323.6587574481964, -322.6164954304695, -291.7710897549987, -307.80061142891645, -323.45961129665375, -311.04514363221824, -335.0377206802368, -319.1859726086259, -311.2460402548313, -319.4777791798115, -333.5731703341007, -320.20395517349243, -307.04323676833883, -327.04906406998634, -288.87191731110215, -303.4997488707304, -310.07496439665556, -312.56836697459227, -291.6438816934824, -293.32382045686245, -322.9402827098966, -315.7199560701847, -313.1220774650574, -340.8336454629898, -293.84806320071226, -310.63927149772644, -305.09189538657665, -334.47210800647736, -298.1367685943842, -307.379723623395, -302.11744007468224, -303.54635274410253, -320.53780311346054, -311.2169127613306, -100.76888753473753, -324.8386949598789, -296.8398793152883, -339.3378674387932, -312.02469781041145, -328.3038628399372, -313.96164187788963, -310.7276563346386, -316.5209902524948, -306.08930180966854, -323.58054459095, -306.05112087726593, -340.7652156725526, -280.4189617931843, -294.752339527011, -296.50185883417726, -317.20583087205887, -300.066392660141, -303.25936398655176, -320.90255692601204, -326.6853048801422, -281.1862553022802, -291.4380647391081, -305.67586870491505, -315.47250433266163, -283.8749592155218, -311.90643953904515, -323.494438149035, -303.1429831236601, -307.94501608610153, -303.4784715473652, -311.57415917515755, -303.81730920076376, -328.63800859451294, -317.43708196282387, -314.5762024074793, -310.26195257902145, -331.019886136055, -287.2159416228533, -305.3864610549063, -319.0911150723696, -315.7548412233591, -308.7432356029749, -322.9218153506518], "episode_lengths": [59, 59, 115, 69, 65, 48, 59, 68, 500, 69, 81, 57, 69, 56, 69, 58, 71, 52, 52, 66, 70, 76, 63, 49, 66, 137, 53, 53, 68, 46, 57, 58, 64, 55, 56, 66, 77, 71, 58, 60, 68, 64, 63, 69, 85, 59, 76, 72, 66, 44, 64, 52, 56, 67, 69, 57, 500, 69, 71, 115, 54, 53, 53, 68, 57, 68, 65, 61, 124, 124, 75, 51, 41, 59, 63, 67, 74, 66, 63, 83, 41, 79, 63, 55, 58, 63, 78, 62, 57, 39, 105, 56, 58, 47, 110, 55, 38, 39, 63, 72], "policy_shared_policy_reward": [-103.33406723539035, -104.30760912100475, -113.45716885725658, -100.1817513604959, -99.20419019864252, -111.59025784333548, -100.43017538388571, -111.28208549817404, -98.94257696469626, -97.65604447821777, -98.04658804337184, -110.60404155651729, -97.59798602263133, -95.01870275537173, -106.89186022679012, -99.7407728433609, -99.41675186157227, -110.736163854599, -100.38154966632526, -114.83939460913341, -104.31130133072536, -110.2210171421369, -100.12898697455725, -100.04798456033072, -0.19770776977142646, -1.0024920304616387, -0.6771068473657067, -104.57200451691946, -93.66704373558363, -92.44157737990221, -103.70015539725622, -103.21007483204207, -115.33084430297217, -96.44842251141867, -106.52997209628424, -95.39310603340468, -102.75531498591106, -103.29537389675777, -93.0557408730189, -100.47846152385077, -110.10751142104468, -97.17345069798952, -109.39424697558086, -96.67573830361168, -98.14946938554446, -101.49580126007399, -102.96379526456198, -113.12669267257056, -103.52262231707573, -105.35013246536255, -114.92197442054749, -120.55413389205933, -106.69184559583664, -106.61404231190681, -98.4687829737862, -111.89626481135687, -100.01533325513205, -91.45598360399406, -102.99839482704799, -92.7889332274596, -102.16099881132445, -114.29434307416281, -102.29811288913092, -97.716525601844, -109.47660929958026, -101.03908381859462, -114.81701958179474, -103.53227931261063, -105.30945855379105, -103.12388621767363, -115.59921302398047, -103.89339618881544, -104.46307656168938, -92.27405422180891, -95.0339589715004, -98.09933911512296, -98.4606553564469, -111.2406169573466, -115.56165379285812, -103.75877690315247, -104.13918060064316, -107.49981860319774, -101.02226746889453, -102.52305756012599, -108.64187455177307, -108.02199935913086, -118.37384676933289, -100.55509058882794, -101.3317231287559, -117.29915889104208, -110.78595725695293, -99.189500639836, -101.2705823580424, -113.60544157028198, -101.10074606537819, -104.7715915441513, -110.38117186228435, -118.93066720167796, -104.26133127013843, -115.4658071200053, -100.85736046234767, -103.88078759113948, -98.06728370472169, -98.27029162769517, -110.705661435922, -115.06877020994823, -104.42322702209155, -107.55706683794658, -93.75316230456035, -103.79662869373958, -91.32212631280224, -96.68254202107589, -108.66027144591014, -98.15693540374438, -110.74634635448456, -98.72213294357061, -100.60648509860039, -100.34887020786604, -100.04212041695914, -112.17737634976706, -91.83107317984104, -105.434386074543, -94.37842243909836, -92.34928218026957, -93.99269257982573, -106.98184569676718, -105.75253715117773, -115.77841540177664, -101.40933015694222, -101.72199410200119, -101.38568577170372, -112.6122761964798, -111.87455004453659, -100.45812165737152, -100.78940576314926, -120.690289636453, -111.14179452260336, -109.00156130393347, -94.84250237544379, -94.56526671846709, -104.44029410680136, -99.67133504152298, -98.50959342718124, -112.45834302902222, -109.72513288259506, -97.49115243554115, -97.87561006844044, -118.86396918694179, -106.43065128723781, -109.17748753229777, -107.7086511850357, -95.23488199710846, -95.19323541224003, -97.17941055198511, -110.34719647963843, -99.85311659177145, -96.46289377411208, -109.15601952870688, -96.49852677186331, -100.25052579243979, -94.87215371926627, -108.42367323239645, -99.36846234401068, -110.5517444809278, -110.6175962885221, -101.69077757994334, -110.91890637079875, -98.60722881058852, -32.99665525058906, -34.572848300139114, -33.19938398400943, -104.46170604228973, -103.84288600087166, -116.53410291671753, -95.90916581948599, -93.62260401367288, -107.30810948212942, -109.26734087864558, -109.83487425247829, -120.23565230766933, -100.4849501947562, -99.39190695683162, -112.14784065882365, -117.94800684849422, -104.23255802194278, -106.12329796950023, -100.27277956902981, -99.857855245471, -113.83100706338882, -112.89313753445944, -99.53713258107504, -98.29738621910414, -112.46889237562816, -101.92843619982402, -102.12366167704265, -98.39953557650249, -110.27225420872371, -97.41751202444236, -103.15528204043707, -116.02772762378058, -104.39753492673239, -98.1813829044501, -109.40991346041362, -98.45982451240222, -114.90165229638419, -112.72120252003273, -113.1423608561357, -100.58624709645908, -89.90399743119876, -89.92871726552646, -95.56164886554083, -93.71569830675921, -105.4749923547109, -94.53209741786122, -95.21748353540897, -106.75227788090706, -101.22653237978618, -101.59009269873302, -114.38920579353969, -108.94981799523036, -95.40808407465617, -95.70849059025447, -109.03214102983475, -96.56069497019053, -97.66652798652649, -114.63332106669745, -103.72721662123999, -102.54201923807463, -115.28520512580872, -104.38480633497238, -107.01529341936111, -101.16182348132133, -89.03149601444602, -90.99293580651283, -106.19861362377803, -92.51289101193349, -92.72656010339658, -97.83820425967376, -98.34771452347438, -109.48994992176692, -101.51532453298569, -99.99961753189564, -113.9575622677803, -101.75432262818019, -90.52006220320861, -91.60057438413303, -100.46686111887297, -112.05144061644873, -99.38813780372342, -115.17420695225398, -101.82776828358571, -106.4924629131953, -108.75989631811778, -96.89546176294486, -97.48762504259746, -109.70410776138306, -98.12969428300858, -100.1112140417099, -97.78915412227313, -108.77526945869128, -96.91404796640079, -101.1715501745542, -99.43633394440016, -110.96627505620322, -96.86639549334845, -109.48055030902228, -97.470363398393, -104.47571110725403, -119.34304010868073, -104.81925737857819, -114.66449167331061, -101.88113387425742, -100.89145641525587, -113.23385268449783, -100.07924251258373, -101.26310721039772, -110.41617438197136, -99.57175388932228, -100.27402430772781, -106.02841953436534, -118.53445420662563, -106.45701239506404, -91.85633358856043, -103.62007548411688, -91.739532550176, -96.84436878127357, -109.81469555695853, -98.72739671667418, -114.3472578128179, -101.13987502952418, -103.60398223002753, -111.72239249944687, -100.54845674335957, -103.48399198055267, -98.12761062880358, -110.80231757958731, -99.81330739458403, -103.10690844555697, -103.81499217947325, -115.99991472562155]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17381114667693762, "mean_inference_ms": 0.7071395871756495, "mean_action_processing_ms": 0.0929529910005595, "mean_env_wait_ms": 0.7700077524185847, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 25000, "timesteps_this_iter": 0, "agent_timesteps_total": 75000, "timers": {"sample_time_ms": 10506.902, "sample_throughput": 475.878, "load_time_ms": 0.2, "load_throughput": 25013740.458, "learn_time_ms": 1996.24, "learn_throughput": 2504.709, "update_time_ms": 9.549}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0125, "cur_lr": 0.0005000000000000001, "total_loss": 2789.0966064453123, "policy_loss": -0.0024451595904678046, "vf_loss": 2789.155908203125, "vf_explained_var": 0.011453181505203247, "kl": 0.0032148869067903083, "entropy": 5.696117830276489, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 25000, "num_agent_steps_sampled": 75000, "num_steps_trained": 25000, "num_agent_steps_trained": 75000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 274, "training_iteration": 5, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-02-15", "timestamp": 1706230935, "time_this_iter_s": 10.95219898223877, "time_total_s": 54.38563895225525, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140424F9D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 54.38563895225525, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 8.6125, "ram_util_percent": 49.1125}}
{"episode_reward_max": 21.367388725280748, "episode_reward_min": -340.7652156725526, "episode_reward_mean": -295.2814220746048, "episode_len_mean": 84.23, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {"shared_policy": -119.60086504618327}, "policy_reward_max": {"shared_policy": 7.658291627963379}, "policy_reward_mean": {"shared_policy": -98.42714069153493}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-312.02469781041145, -328.3038628399372, -313.96164187788963, -310.7276563346386, -316.5209902524948, -306.08930180966854, -323.58054459095, -306.05112087726593, -340.7652156725526, -280.4189617931843, -294.752339527011, -296.50185883417726, -317.20583087205887, -300.066392660141, -303.25936398655176, -320.90255692601204, -326.6853048801422, -281.1862553022802, -291.4380647391081, -305.67586870491505, -315.47250433266163, -283.8749592155218, -311.90643953904515, -323.494438149035, -303.1429831236601, -307.94501608610153, -303.4784715473652, -311.57415917515755, -303.81730920076376, -328.63800859451294, -317.43708196282387, -314.5762024074793, -310.26195257902145, -331.019886136055, -287.2159416228533, -305.3864610549063, -319.0911150723696, -315.7548412233591, -308.7432356029749, -322.9218153506518, -12.88419865816833, -301.45132260024553, -18.00182039290668, -299.34956991672516, -298.60210017859936, -305.91046806424856, -286.59175746142864, -308.0443435013294, -289.86009797453886, -288.4486954882741, -310.49547672271734, -306.5586503148079, -295.4023502022028, -308.0252184383571, -316.8727151751518, -307.2642192542553, -310.16115149855614, -311.68390518426895, 21.367388725280748, -316.31784984469414, -323.64868672192097, -304.81360626220703, -305.1810702085495, -300.3022656366229, -304.6168985664845, -320.0817510485649, -310.14885237812996, -311.2006371319294, -296.43909502774477, -322.1715196967125, -302.03794717788696, -282.88522934913635, -9.750168338418007, -319.58437246084213, -297.5819130167365, -285.54361924529076, -287.9672765620053, -298.9072319790721, -323.9665769338608, -313.0057904422283, -300.08337939530617, -312.92324498295784, -289.2348243445158, -304.1245293021202, -284.06843710690737, -314.1137458756566, -309.5744752511382, -340.1784782856703, -290.8268105238676, -328.5445323958993, -314.91029711067677, -309.54415033757687, -290.80784000456333, -314.73949381709105, -292.53919948637486, -314.969743847847, -313.34569215774536, -282.83779177069664, -314.29349383711815, -314.21836502850056], "episode_lengths": [54, 53, 53, 68, 57, 68, 65, 61, 124, 124, 75, 51, 41, 59, 63, 67, 74, 66, 63, 83, 41, 79, 63, 55, 58, 63, 78, 62, 57, 39, 105, 56, 58, 47, 110, 55, 38, 39, 63, 72, 500, 53, 500, 62, 62, 77, 67, 56, 68, 66, 74, 64, 67, 65, 56, 47, 70, 52, 500, 37, 54, 58, 50, 59, 83, 57, 80, 55, 69, 60, 63, 73, 500, 64, 57, 130, 69, 87, 51, 87, 85, 46, 69, 68, 71, 55, 64, 227, 64, 86, 79, 48, 73, 48, 67, 61, 58, 81, 53, 64], "policy_shared_policy_reward": [-100.4849501947562, -99.39190695683162, -112.14784065882365, -117.94800684849422, -104.23255802194278, -106.12329796950023, -100.27277956902981, -99.857855245471, -113.83100706338882, -112.89313753445944, -99.53713258107504, -98.29738621910414, -112.46889237562816, -101.92843619982402, -102.12366167704265, -98.39953557650249, -110.27225420872371, -97.41751202444236, -103.15528204043707, -116.02772762378058, -104.39753492673239, -98.1813829044501, -109.40991346041362, -98.45982451240222, -114.90165229638419, -112.72120252003273, -113.1423608561357, -100.58624709645908, -89.90399743119876, -89.92871726552646, -95.56164886554083, -93.71569830675921, -105.4749923547109, -94.53209741786122, -95.21748353540897, -106.75227788090706, -101.22653237978618, -101.59009269873302, -114.38920579353969, -108.94981799523036, -95.40808407465617, -95.70849059025447, -109.03214102983475, -96.56069497019053, -97.66652798652649, -114.63332106669745, -103.72721662123999, -102.54201923807463, -115.28520512580872, -104.38480633497238, -107.01529341936111, -101.16182348132133, -89.03149601444602, -90.99293580651283, -106.19861362377803, -92.51289101193349, -92.72656010339658, -97.83820425967376, -98.34771452347438, -109.48994992176692, -101.51532453298569, -99.99961753189564, -113.9575622677803, -101.75432262818019, -90.52006220320861, -91.60057438413303, -100.46686111887297, -112.05144061644873, -99.38813780372342, -115.17420695225398, -101.82776828358571, -106.4924629131953, -108.75989631811778, -96.89546176294486, -97.48762504259746, -109.70410776138306, -98.12969428300858, -100.1112140417099, -97.78915412227313, -108.77526945869128, -96.91404796640079, -101.1715501745542, -99.43633394440016, -110.96627505620322, -96.86639549334845, -109.48055030902228, -97.470363398393, -104.47571110725403, -119.34304010868073, -104.81925737857819, -114.66449167331061, -101.88113387425742, -100.89145641525587, -113.23385268449783, -100.07924251258373, -101.26310721039772, -110.41617438197136, -99.57175388932228, -100.27402430772781, -106.02841953436534, -118.53445420662563, -106.45701239506404, -91.85633358856043, -103.62007548411688, -91.739532550176, -96.84436878127357, -109.81469555695853, -98.72739671667418, -114.3472578128179, -101.13987502952418, -103.60398223002753, -111.72239249944687, -100.54845674335957, -103.48399198055267, -98.12761062880358, -110.80231757958731, -99.81330739458403, -103.10690844555697, -103.81499217947325, -115.99991472562155, -4.20850456009309, -4.322373087207481, -4.353321010867759, -107.28995852669081, -95.90602502723536, -98.25533904631934, -5.9758176604906765, -5.5974893594781605, -6.428513372937843, -107.36594009399414, -96.33083808422089, -95.65279173851013, -108.58229933182399, -93.89557024339835, -96.12423060337703, -101.59022092819214, -96.27862107008696, -108.04162606596947, -103.02281777064006, -92.43107358614604, -91.13786610464255, -109.67812117934227, -99.39845305681229, -98.96776926517487, -103.20370094974837, -93.81391467650732, -92.84248234828314, -104.3156382640203, -92.06966014703116, -92.06339707722267, -98.71342261632284, -100.77474941809973, -111.00730468829474, -97.83176517486572, -109.71144741773605, -99.01543772220612, -106.33770555257797, -94.74957332015038, -94.31507132947445, -111.54102406899135, -97.14389940227072, -99.34029496709506, -100.80437157551448, -113.10463790098827, -102.9637056986491, -99.11188866694769, -97.72142689426741, -110.43090369304022, -110.57711255550385, -99.87685230374336, -99.70718663930893, -110.57316990693411, -101.06096537907919, -100.04976989825568, 6.505869050820664, 7.658291627963379, 7.2032280464967045, -114.1184052626292, -101.11929906407993, -101.08014551798503, -115.94625778992972, -102.37191245456538, -105.3305164774259, -109.00776588916779, -98.00478035211563, -97.80106002092361, -98.19453038771948, -110.05059756835303, -96.93594225247702, -108.48596451679866, -95.62680529306333, -96.18949582676093, -97.27207257350287, -98.07941405971846, -109.26541193326315, -115.19358227650325, -103.1922375659148, -101.69593120614688, -99.59133358796439, -110.94573410352072, -99.61178468664488, -111.04698044061661, -99.91719138622284, -100.23646530508995, -95.14642171561718, -106.9011640548706, -94.39150925725698, -104.6485565106074, -103.01893423000972, -114.50402895609538, -108.1917495528857, -97.47359002629916, -96.37260759870212, -100.93141910433769, -91.1604483127594, -90.79336193203926, -3.2113285660743713, -3.616433322429657, -2.9224064499139786, -113.60134079058966, -103.67769672473273, -102.30533494551977, -96.05730206767718, -94.03814730296533, -107.48646364609401, -91.72860796252887, -91.60459498564403, -102.21041629711787, -103.50674946109454, -93.09269014994304, -91.36783695096771, -107.31123065948486, -95.25474714487791, -96.34125417470932, -103.33478690187137, -116.8846006790797, -103.74718935290973, -100.47449311614037, -111.51259279251099, -101.01870453357697, -97.43055166800818, -107.73437203963599, -94.91845568766198, -100.69569652279219, -100.32219817241034, -111.90535028775534, -92.49358669420084, -103.79569866259894, -92.94553898771605, -98.4845800002416, -96.71146102746329, -108.92848827441534, -92.14862296978633, -102.80840704838435, -89.1114070887367, -99.15423401941857, -114.02125110228857, -100.93826075394949, -111.03661010662715, -98.99582876513402, -99.54203637937705, -114.47505980730057, -112.41598553955555, -113.28743293881416, -92.79325909912586, -93.80717143416405, -104.2263799905777, -104.39282993475597, -104.55083741496007, -119.60086504618327, -101.48494902253151, -113.43544232845306, -99.98990575969219, -100.28135251005492, -110.31100090344748, -98.9517969240745, -95.15203048785528, -104.10622825225195, -91.54958126445612, -112.55067416032156, -100.84213220079741, -101.34668745597205, -93.8821326593558, -93.40854671100776, -105.2485201160113, -110.73313665390015, -101.31267201900482, -102.92393517494202, -100.21922210852306, -99.87223247687022, -113.2542375723521, -90.66988091667494, -102.20638151963553, -89.9615293343862, -112.91176966826121, -100.08119455973308, -101.30052960912387, -112.78791377941768, -100.29032963017623, -101.14012161890666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17417198521967328, "mean_inference_ms": 0.7065146939463541, "mean_action_processing_ms": 0.09555630223922508, "mean_env_wait_ms": 0.7735600504213497, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 30000, "timesteps_this_iter": 0, "agent_timesteps_total": 90000, "timers": {"sample_time_ms": 10559.306, "sample_throughput": 473.516, "load_time_ms": 0.318, "load_throughput": 15705082.376, "learn_time_ms": 1987.52, "learn_throughput": 2515.699, "update_time_ms": 9.543}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005000000000000001, "total_loss": 3340.179833984375, "policy_loss": -0.0033645902429800143, "vf_loss": 3340.240966796875, "vf_explained_var": 0.003664654493331909, "kl": 0.004190861250391084, "entropy": 5.783581209182739, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 30000, "num_agent_steps_sampled": 90000, "num_steps_trained": 30000, "num_agent_steps_trained": 90000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 334, "training_iteration": 6, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-02-26", "timestamp": 1706230946, "time_this_iter_s": 10.76904010772705, "time_total_s": 65.1546790599823, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D480D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 65.1546790599823, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 7.94, "ram_util_percent": 49.20666666666668}}
{"episode_reward_max": 21.367388725280748, "episode_reward_min": -601.9736500382423, "episode_reward_mean": -300.50263407164255, "episode_len_mean": 85.91, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {"shared_policy": -208.63800462086996}, "policy_reward_max": {"shared_policy": 7.658291627963379}, "policy_reward_mean": {"shared_policy": -100.16754469054752}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-310.16115149855614, -311.68390518426895, 21.367388725280748, -316.31784984469414, -323.64868672192097, -304.81360626220703, -305.1810702085495, -300.3022656366229, -304.6168985664845, -320.0817510485649, -310.14885237812996, -311.2006371319294, -296.43909502774477, -322.1715196967125, -302.03794717788696, -282.88522934913635, -9.750168338418007, -319.58437246084213, -297.5819130167365, -285.54361924529076, -287.9672765620053, -298.9072319790721, -323.9665769338608, -313.0057904422283, -300.08337939530617, -312.92324498295784, -289.2348243445158, -304.1245293021202, -284.06843710690737, -314.1137458756566, -309.5744752511382, -340.1784782856703, -290.8268105238676, -328.5445323958993, -314.91029711067677, -309.54415033757687, -290.80784000456333, -314.73949381709105, -292.53919948637486, -314.969743847847, -313.34569215774536, -282.83779177069664, -314.29349383711815, -314.21836502850056, -36.963692076504245, -292.86041337251663, -296.57665645331144, -303.95922537148, -313.1587279736996, -315.31179424375296, -309.6421056436375, -328.0427179783583, -323.47321316599846, -316.6501672714949, -308.1569560021162, -310.31907193362713, -298.941785633564, -280.20591312646866, -323.15206003189087, -308.02731812372804, -307.1744966506958, -315.93226331472397, -601.9736500382423, -315.7147979140282, -332.8183696866036, -330.23230580240494, -344.8125235959888, -301.9234610795975, -305.5284038297832, -300.06571209430695, -279.17181535065174, -307.7509346604347, -329.444630920887, -318.32847589254385, -317.1873609125614, -299.3893762677908, -310.3130535930395, -298.50872498750687, -311.9756056275219, -317.8004533946514, -311.28265452384954, -318.05433815717697, -301.3501665443182, -321.61981166899204, -312.77781011909246, -323.3947210609913, -303.96937257796526, -326.4058258831501, -317.2980193942785, -312.98107017949224, -335.2647832632065, -284.89671345055103, -287.7907669097185, -317.91528895869857, -294.9404980391264, -300.8995762988925, -309.32156348228455, -314.7735407948494, -303.0714104343206, -68.25869055837393], "episode_lengths": [70, 52, 500, 37, 54, 58, 50, 59, 83, 57, 80, 55, 69, 60, 63, 73, 500, 64, 57, 130, 69, 87, 51, 87, 85, 46, 69, 68, 71, 55, 64, 227, 64, 86, 79, 48, 73, 48, 67, 61, 58, 81, 53, 64, 500, 82, 61, 67, 62, 61, 68, 81, 42, 69, 48, 78, 67, 79, 64, 63, 61, 44, 69, 56, 59, 54, 142, 61, 84, 61, 99, 89, 63, 65, 71, 60, 62, 71, 68, 52, 68, 55, 62, 46, 72, 90, 87, 64, 70, 60, 68, 76, 60, 49, 82, 77, 71, 43, 76, 500], "policy_shared_policy_reward": [-110.57711255550385, -99.87685230374336, -99.70718663930893, -110.57316990693411, -101.06096537907919, -100.04976989825568, 6.505869050820664, 7.658291627963379, 7.2032280464967045, -114.1184052626292, -101.11929906407993, -101.08014551798503, -115.94625778992972, -102.37191245456538, -105.3305164774259, -109.00776588916779, -98.00478035211563, -97.80106002092361, -98.19453038771948, -110.05059756835303, -96.93594225247702, -108.48596451679866, -95.62680529306333, -96.18949582676093, -97.27207257350287, -98.07941405971846, -109.26541193326315, -115.19358227650325, -103.1922375659148, -101.69593120614688, -99.59133358796439, -110.94573410352072, -99.61178468664488, -111.04698044061661, -99.91719138622284, -100.23646530508995, -95.14642171561718, -106.9011640548706, -94.39150925725698, -104.6485565106074, -103.01893423000972, -114.50402895609538, -108.1917495528857, -97.47359002629916, -96.37260759870212, -100.93141910433769, -91.1604483127594, -90.79336193203926, -3.2113285660743713, -3.616433322429657, -2.9224064499139786, -113.60134079058966, -103.67769672473273, -102.30533494551977, -96.05730206767718, -94.03814730296533, -107.48646364609401, -91.72860796252887, -91.60459498564403, -102.21041629711787, -103.50674946109454, -93.09269014994304, -91.36783695096771, -107.31123065948486, -95.25474714487791, -96.34125417470932, -103.33478690187137, -116.8846006790797, -103.74718935290973, -100.47449311614037, -111.51259279251099, -101.01870453357697, -97.43055166800818, -107.73437203963599, -94.91845568766198, -100.69569652279219, -100.32219817241034, -111.90535028775534, -92.49358669420084, -103.79569866259894, -92.94553898771605, -98.4845800002416, -96.71146102746329, -108.92848827441534, -92.14862296978633, -102.80840704838435, -89.1114070887367, -99.15423401941857, -114.02125110228857, -100.93826075394949, -111.03661010662715, -98.99582876513402, -99.54203637937705, -114.47505980730057, -112.41598553955555, -113.28743293881416, -92.79325909912586, -93.80717143416405, -104.2263799905777, -104.39282993475597, -104.55083741496007, -119.60086504618327, -101.48494902253151, -113.43544232845306, -99.98990575969219, -100.28135251005492, -110.31100090344748, -98.9517969240745, -95.15203048785528, -104.10622825225195, -91.54958126445612, -112.55067416032156, -100.84213220079741, -101.34668745597205, -93.8821326593558, -93.40854671100776, -105.2485201160113, -110.73313665390015, -101.31267201900482, -102.92393517494202, -100.21922210852306, -99.87223247687022, -113.2542375723521, -90.66988091667494, -102.20638151963553, -89.9615293343862, -112.91176966826121, -100.08119455973308, -101.30052960912387, -112.78791377941768, -100.29032963017623, -101.14012161890666, -12.22898167620103, -12.396818595627948, -12.337891804675266, -94.64515542984009, -92.75044268369675, -105.4648152589798, -93.22083065162103, -96.0985618631045, -107.25726393858592, -108.37583229939143, -97.1260402450959, -98.45735282699268, -107.41828270753226, -102.84995727737746, -102.89048798878989, -101.91570654511452, -112.98465460538864, -100.4114330932498, -100.31688370307288, -111.7012137969335, -97.62400814363113, -117.13373388846716, -105.70787843068442, -105.20110565920672, -104.65909630060196, -102.54738464951515, -116.26673221588135, -112.8805453379949, -101.02204770346484, -102.74757423003516, -98.76122663915157, -111.08436781167984, -98.31136155128479, -98.76937958101432, -111.7861674229304, -99.76352492968242, -107.52549348274867, -95.99224639932315, -95.42404575149219, -90.82615433136623, -88.89945221940677, -100.48030657569568, -115.36756877104442, -104.05837375919025, -103.72611750165622, -98.78806189447641, -98.28953805193305, -110.94971817731857, -110.52978763977687, -97.26401935021083, -99.38068966070811, -102.42550940314929, -112.10776926080386, -101.39898465077083, -208.63800462086996, -196.78738187750182, -196.5482635398706, -103.26457031567892, -101.2091705997785, -111.24105699857077, -119.21168728669485, -106.11012115081152, -107.4965612490972, -106.27086245020232, -118.79885413249335, -105.16258921970925, -111.5879322787126, -122.42945389946303, -110.79513741781315, -96.6979074627161, -109.05889445543289, -96.16665916144848, -109.61334015925726, -98.23153447111449, -97.68352919941148, -107.51137775182724, -95.67286548018456, -96.88146886229515, -101.21164284149806, -88.92073988417785, -89.03943262497584, -97.77460530400276, -99.40437093377113, -110.57195842266083, -105.17577803134918, -105.11609679460526, -119.15275609493256, -99.7074174185594, -99.30577151974043, -119.31528695424399, -101.78714859485626, -113.30717432498932, -102.09303799271584, -96.14601810773215, -107.89479245742163, -95.34856570263705, -99.39030079046886, -98.98272594312827, -111.9400268594424, -95.48799692591032, -96.23076273997626, -106.78996532162031, -102.4232511719068, -98.42280451518795, -111.12954994042715, -103.07022599379222, -114.67232255140941, -100.0579048494498, -99.57036777337393, -111.11595257123312, -100.59633417924246, -102.5780765414238, -113.30756318569183, -102.16869843006134, -96.85887812574705, -108.0151004989942, -96.47618791957697, -102.51101454595725, -115.39665458599727, -103.71214253703754, -111.61536670724551, -101.42984278003375, -99.73260063181321, -103.79713452855746, -116.07423923412959, -103.52334729830424, -109.90233784914017, -96.40371362119913, -97.66332110762596, -104.08390814065933, -104.91767027974129, -117.40424746274948, -97.97473530471325, -110.08363562822342, -109.23964846134186, -99.19672094658017, -112.6885432600975, -101.09580597281456, -104.38923400640488, -108.36529237031937, -122.51025688648224, -103.07269380489986, -91.8060089747111, -90.01801067094009, -91.64972542226315, -92.44648388028145, -103.69455760717392, -100.88701363777122, -115.01754494508108, -102.01073037584624, -106.00740395983061, -93.95396098991236, -94.97913308938345, -97.0027292072773, -108.21763682365417, -95.67921026796103, -97.14251854022345, -98.1113866766294, -114.06765826543173, -100.25555964559317, -114.3803083896637, -100.13767275959253, -97.36001696189246, -108.8900115688642, -96.82138190356395, -21.80898963908355, -21.5799574131767, -24.869743506113693]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1716643158768215, "mean_inference_ms": 0.7067202866791729, "mean_action_processing_ms": 0.09717041472782646, "mean_env_wait_ms": 0.7757637320768673, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 35000, "timesteps_this_iter": 0, "agent_timesteps_total": 105000, "timers": {"sample_time_ms": 10575.722, "sample_throughput": 472.781, "load_time_ms": 0.273, "load_throughput": 18322596.106, "learn_time_ms": 1983.879, "learn_throughput": 2520.315, "update_time_ms": 9.475}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.003125, "cur_lr": 0.0005000000000000001, "total_loss": 3280.3047607421877, "policy_loss": -0.0021738649574512435, "vf_loss": 3280.3642333984376, "vf_explained_var": 0.002877366542816162, "kl": 0.0024333420049525113, "entropy": 5.72822208404541, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 35000, "num_agent_steps_sampled": 105000, "num_steps_trained": 35000, "num_agent_steps_trained": 105000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 390, "training_iteration": 7, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-02-37", "timestamp": 1706230957, "time_this_iter_s": 10.661661624908447, "time_total_s": 75.81634068489075, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002146F7DD1F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 75.81634068489075, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 8.020000000000001, "ram_util_percent": 49.13999999999999}}
{"episode_reward_max": 4.9448526389896585, "episode_reward_min": -601.9736500382423, "episode_reward_mean": -305.1387332565617, "episode_len_mean": 87.54, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {"shared_policy": -208.63800462086996}, "policy_reward_max": {"shared_policy": 1.8714669259885852}, "policy_reward_mean": {"shared_policy": -101.71291108552056}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-323.15206003189087, -308.02731812372804, -307.1744966506958, -315.93226331472397, -601.9736500382423, -315.7147979140282, -332.8183696866036, -330.23230580240494, -344.8125235959888, -301.9234610795975, -305.5284038297832, -300.06571209430695, -279.17181535065174, -307.7509346604347, -329.444630920887, -318.32847589254385, -317.1873609125614, -299.3893762677908, -310.3130535930395, -298.50872498750687, -311.9756056275219, -317.8004533946514, -311.28265452384954, -318.05433815717697, -301.3501665443182, -321.61981166899204, -312.77781011909246, -323.3947210609913, -303.96937257796526, -326.4058258831501, -317.2980193942785, -312.98107017949224, -335.2647832632065, -284.89671345055103, -287.7907669097185, -317.91528895869857, -294.9404980391264, -300.8995762988925, -309.32156348228455, -314.7735407948494, -303.0714104343206, -68.25869055837393, -300.77396830916405, -329.2107614129782, -314.2061592265964, -314.5899604856968, -306.5790488831699, -315.1209954377264, -317.6703751087189, -318.35093723237514, -318.41358256340027, -290.98194197565317, -324.5916929580271, 4.9448526389896585, -318.50147262215614, -298.34479155018926, -300.48936316743493, -303.16752173006535, -325.3495318572968, -329.75364212691784, -307.7877578288317, -301.96492776274687, -306.24620430544024, -310.01050205063075, -320.4979619123042, -317.3818439282477, -301.91554573178297, -323.55019813776016, -297.98677991330624, -308.6757434755564, -319.935364574194, -327.71440087258816, -320.4489196687937, -319.8647708892823, -321.8781713023782, -287.24758890271187, -320.9222807511688, -316.29412008821964, -307.5425936430693, -325.09654984623194, -318.4008576273918, -44.78037510812284, -314.3396491706372, -317.27557286620146, -298.54648028314114, -322.94322696328163, -307.6360418200493, -301.95679031312466, -296.75549944490194, -314.56071528792387, -327.9446261227131, -344.3694869875908, -27.86823565512897, -327.0439279079437, -334.79673171043396, -325.6998367756605, -309.9324889779091, -318.5214212089777, -306.2337270565331, -326.6620987057686], "episode_lengths": [64, 63, 61, 44, 69, 56, 59, 54, 142, 61, 84, 61, 99, 89, 63, 65, 71, 60, 62, 71, 68, 52, 68, 55, 62, 46, 72, 90, 87, 64, 70, 60, 68, 76, 60, 49, 82, 77, 71, 43, 76, 500, 63, 62, 82, 65, 63, 77, 60, 53, 63, 79, 51, 500, 74, 88, 97, 57, 120, 67, 61, 57, 52, 56, 85, 68, 64, 74, 91, 51, 64, 54, 69, 62, 456, 68, 40, 74, 68, 60, 66, 500, 45, 67, 61, 49, 54, 65, 74, 65, 52, 56, 500, 43, 60, 74, 75, 43, 56, 60], "policy_shared_policy_reward": [-115.36756877104442, -104.05837375919025, -103.72611750165622, -98.78806189447641, -98.28953805193305, -110.94971817731857, -110.52978763977687, -97.26401935021083, -99.38068966070811, -102.42550940314929, -112.10776926080386, -101.39898465077083, -208.63800462086996, -196.78738187750182, -196.5482635398706, -103.26457031567892, -101.2091705997785, -111.24105699857077, -119.21168728669485, -106.11012115081152, -107.4965612490972, -106.27086245020232, -118.79885413249335, -105.16258921970925, -111.5879322787126, -122.42945389946303, -110.79513741781315, -96.6979074627161, -109.05889445543289, -96.16665916144848, -109.61334015925726, -98.23153447111449, -97.68352919941148, -107.51137775182724, -95.67286548018456, -96.88146886229515, -101.21164284149806, -88.92073988417785, -89.03943262497584, -97.77460530400276, -99.40437093377113, -110.57195842266083, -105.17577803134918, -105.11609679460526, -119.15275609493256, -99.7074174185594, -99.30577151974043, -119.31528695424399, -101.78714859485626, -113.30717432498932, -102.09303799271584, -96.14601810773215, -107.89479245742163, -95.34856570263705, -99.39030079046886, -98.98272594312827, -111.9400268594424, -95.48799692591032, -96.23076273997626, -106.78996532162031, -102.4232511719068, -98.42280451518795, -111.12954994042715, -103.07022599379222, -114.67232255140941, -100.0579048494498, -99.57036777337393, -111.11595257123312, -100.59633417924246, -102.5780765414238, -113.30756318569183, -102.16869843006134, -96.85887812574705, -108.0151004989942, -96.47618791957697, -102.51101454595725, -115.39665458599727, -103.71214253703754, -111.61536670724551, -101.42984278003375, -99.73260063181321, -103.79713452855746, -116.07423923412959, -103.52334729830424, -109.90233784914017, -96.40371362119913, -97.66332110762596, -104.08390814065933, -104.91767027974129, -117.40424746274948, -97.97473530471325, -110.08363562822342, -109.23964846134186, -99.19672094658017, -112.6885432600975, -101.09580597281456, -104.38923400640488, -108.36529237031937, -122.51025688648224, -103.07269380489986, -91.8060089747111, -90.01801067094009, -91.64972542226315, -92.44648388028145, -103.69455760717392, -100.88701363777122, -115.01754494508108, -102.01073037584624, -106.00740395983061, -93.95396098991236, -94.97913308938345, -97.0027292072773, -108.21763682365417, -95.67921026796103, -97.14251854022345, -98.1113866766294, -114.06765826543173, -100.25555964559317, -114.3803083896637, -100.13767275959253, -97.36001696189246, -108.8900115688642, -96.82138190356395, -21.80898963908355, -21.5799574131767, -24.869743506113693, -96.35225094358127, -96.66322163740794, -107.75849572817485, -103.10735461612543, -104.88176827629408, -121.22163852055868, -97.92636038114628, -100.51730742057165, -115.76249142487845, -100.80053202311198, -101.03327400485675, -112.75615445772807, -97.46861834948263, -110.73353960116705, -98.37689093252024, -113.62680421272914, -100.52547998788457, -100.96871123711269, -102.921681702137, -100.8654060959816, -113.88328731060028, -102.13175115982692, -114.77197913328807, -101.44720693926017, -113.35266415278117, -102.57559318343799, -102.48532522718112, -104.78248078624408, -92.65981458375852, -93.53964660565059, -116.44033924738567, -103.35913251216213, -104.79222119847934, 1.5219958225885932, 1.8714669259885852, 1.55138989041248, -102.21477801601092, -102.1338219443957, -114.15287266174953, -109.21387493610382, -96.08274757862091, -93.04816903546453, -110.2886966864268, -95.11460891614358, -95.08605756486456, -96.27639340857665, -109.55788473288219, -97.33324358860652, -117.79925219217937, -103.82607582459848, -103.724203840519, -106.01994970440865, -118.65282320976257, -105.08086921274662, -99.46863202253978, -98.3777493784825, -109.9413764278094, -107.59673853715262, -96.72634219129881, -97.64184703429541, -111.26571985085806, -96.72814685975513, -98.25233759482703, -112.33279792467754, -99.34567255775134, -98.33203156820188, -116.10369171698889, -102.87479277451834, -101.51947742079696, -101.54830696185431, -99.45309724782905, -116.38043971856436, -97.24597184856734, -108.54738607009253, -96.12218781312308, -115.0820189913114, -104.77745058139166, -103.69072856505713, -96.7310402393341, -94.46150778234005, -106.79423189163208, -111.1868210832278, -98.92271540562312, -98.56620698670547, -113.88128211100897, -102.99691816171011, -103.0571643014749, -103.9527670989434, -117.74678639570872, -106.01484737793605, -103.17899405459563, -103.07813934485118, -114.19178626934688, -102.7578128774961, -114.54974933465323, -102.55720867713293, -103.45898006111383, -104.35476332902908, -114.06442791223526, -103.03767461578052, -91.63346294562022, -92.57645134131114, -102.8920333882173, -115.43666162093481, -102.59358574201664, -112.68138986825943, -101.23471055924892, -102.37801966071129, -99.87270065148672, -95.71984231968722, -111.95005067189535, -117.08095037937164, -104.6858679652214, -103.32973150163889, -113.14299142360687, -102.71393156051636, -102.54393464326859, -15.041392038265869, -14.734556789199516, -15.004426280657455, -101.0475198229154, -99.98289846380553, -113.30923088391623, -111.36698996027312, -101.01027299960455, -104.89830990632376, -107.31835548082988, -96.27400581041972, -94.95411899189155, -104.02870480219524, -104.15240798393886, -114.76211417714755, -99.36327979962032, -97.42618695894878, -110.84657506148021, -96.50524400174618, -96.96173369884491, -108.48981261253357, -107.3764477968216, -94.6733218356967, -94.70572981238365, -101.14183034499487, -112.36974384387335, -101.04914109905562, -118.23655319213867, -105.06136831641197, -104.64670461416245, -108.55976366996765, -113.98890280723572, -121.82082051038742, -9.023855882386371, -9.411088372270271, -9.433291400472328, -116.65034413337708, -105.14098733663559, -105.25259643793106, -117.55696562925975, -114.52723173300426, -102.71253434816997, -106.24985265731812, -115.65148431062698, -103.79849980771542, -99.1320787469546, -110.49121365944545, -100.30919657150905, -100.97070826590061, -102.95575714111328, -114.5949558019638, -97.30852238213023, -110.14093061288199, -98.7842740615209, -117.25900220870972, -105.37502425909042, -104.02807223796844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17164612208112243, "mean_inference_ms": 0.7083706349424135, "mean_action_processing_ms": 0.0971147546763286, "mean_env_wait_ms": 0.7766726631805679, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 40000, "timesteps_this_iter": 0, "agent_timesteps_total": 120000, "timers": {"sample_time_ms": 10607.954, "sample_throughput": 471.344, "load_time_ms": 0.239, "load_throughput": 20940109.835, "learn_time_ms": 1984.533, "learn_throughput": 2519.484, "update_time_ms": 9.416}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005000000000000001, "total_loss": 3063.6871337890625, "policy_loss": -0.0029877950077162652, "vf_loss": 3063.747607421875, "vf_explained_var": 0.0035407960414886473, "kl": 0.004184553737287505, "entropy": 5.748292064666748, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 40000, "num_agent_steps_sampled": 120000, "num_steps_trained": 40000, "num_agent_steps_trained": 120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 448, "training_iteration": 8, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-02-48", "timestamp": 1706230968, "time_this_iter_s": 10.831218481063843, "time_total_s": 86.64755916595459, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021400813D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 86.64755916595459, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 10.459999999999999, "ram_util_percent": 49.17333333333334}}
{"episode_reward_max": 12.413794584572287, "episode_reward_min": -635.785406589508, "episode_reward_mean": -296.24805242941716, "episode_len_mean": 108.65, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {"shared_policy": -220.16588461399078}, "policy_reward_max": {"shared_policy": 4.36633716026941}, "policy_reward_mean": {"shared_policy": -98.74935080980572}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-68.25869055837393, -300.77396830916405, -329.2107614129782, -314.2061592265964, -314.5899604856968, -306.5790488831699, -315.1209954377264, -317.6703751087189, -318.35093723237514, -318.41358256340027, -290.98194197565317, -324.5916929580271, 4.9448526389896585, -318.50147262215614, -298.34479155018926, -300.48936316743493, -303.16752173006535, -325.3495318572968, -329.75364212691784, -307.7877578288317, -301.96492776274687, -306.24620430544024, -310.01050205063075, -320.4979619123042, -317.3818439282477, -301.91554573178297, -323.55019813776016, -297.98677991330624, -308.6757434755564, -319.935364574194, -327.71440087258816, -320.4489196687937, -319.8647708892823, -321.8781713023782, -287.24758890271187, -320.9222807511688, -316.29412008821964, -307.5425936430693, -325.09654984623194, -318.4008576273918, -44.78037510812284, -314.3396491706372, -317.27557286620146, -298.54648028314114, -322.94322696328163, -307.6360418200493, -301.95679031312466, -296.75549944490194, -314.56071528792387, -327.9446261227131, -344.3694869875908, -27.86823565512897, -327.0439279079437, -334.79673171043396, -325.6998367756605, -309.9324889779091, -318.5214212089777, -306.2337270565331, -326.6620987057686, -307.3902232795954, -304.8119348436594, -324.22481310367584, -314.87557151913643, -322.01801231503487, -310.0227174088359, -329.448689699173, -314.336671218276, 12.413794584572287, -333.4400351047516, -43.521264508366585, -112.72792454063874, -310.4858939051628, -302.71975343488157, -323.5547372996807, -63.59584923088543, -597.3003595396876, -24.18191230669619, -311.7759141921997, -328.59037840366364, -313.0261141806841, -321.3831426054239, -293.4920625537634, -319.86884319782257, -337.55175782740116, -321.10063207149506, -296.2430638819933, -319.32250478863716, -322.3968379497528, -309.22733409702784, -300.9941864423454, -284.2318930029869, -308.5963499471545, -292.7099961936474, -315.6030877530575, -341.59667201340204, -318.5395519733429, -635.785406589508, -319.1064026504755, -329.16664930433035, -319.61429250240326], "episode_lengths": [500, 63, 62, 82, 65, 63, 77, 60, 53, 63, 79, 51, 500, 74, 88, 97, 57, 120, 67, 61, 57, 52, 56, 85, 68, 64, 74, 91, 51, 64, 54, 69, 62, 456, 68, 40, 74, 68, 60, 66, 500, 45, 67, 61, 49, 54, 65, 74, 65, 52, 56, 500, 43, 60, 74, 75, 43, 56, 60, 65, 75, 44, 62, 64, 77, 55, 58, 500, 76, 500, 500, 58, 74, 46, 500, 87, 500, 72, 53, 40, 62, 68, 75, 85, 54, 76, 59, 63, 81, 98, 92, 60, 68, 60, 82, 51, 65, 54, 61, 85], "policy_shared_policy_reward": [-21.80898963908355, -21.5799574131767, -24.869743506113693, -96.35225094358127, -96.66322163740794, -107.75849572817485, -103.10735461612543, -104.88176827629408, -121.22163852055868, -97.92636038114628, -100.51730742057165, -115.76249142487845, -100.80053202311198, -101.03327400485675, -112.75615445772807, -97.46861834948263, -110.73353960116705, -98.37689093252024, -113.62680421272914, -100.52547998788457, -100.96871123711269, -102.921681702137, -100.8654060959816, -113.88328731060028, -102.13175115982692, -114.77197913328807, -101.44720693926017, -113.35266415278117, -102.57559318343799, -102.48532522718112, -104.78248078624408, -92.65981458375852, -93.53964660565059, -116.44033924738567, -103.35913251216213, -104.79222119847934, 1.5219958225885932, 1.8714669259885852, 1.55138989041248, -102.21477801601092, -102.1338219443957, -114.15287266174953, -109.21387493610382, -96.08274757862091, -93.04816903546453, -110.2886966864268, -95.11460891614358, -95.08605756486456, -96.27639340857665, -109.55788473288219, -97.33324358860652, -117.79925219217937, -103.82607582459848, -103.724203840519, -106.01994970440865, -118.65282320976257, -105.08086921274662, -99.46863202253978, -98.3777493784825, -109.9413764278094, -107.59673853715262, -96.72634219129881, -97.64184703429541, -111.26571985085806, -96.72814685975513, -98.25233759482703, -112.33279792467754, -99.34567255775134, -98.33203156820188, -116.10369171698889, -102.87479277451834, -101.51947742079696, -101.54830696185431, -99.45309724782905, -116.38043971856436, -97.24597184856734, -108.54738607009253, -96.12218781312308, -115.0820189913114, -104.77745058139166, -103.69072856505713, -96.7310402393341, -94.46150778234005, -106.79423189163208, -111.1868210832278, -98.92271540562312, -98.56620698670547, -113.88128211100897, -102.99691816171011, -103.0571643014749, -103.9527670989434, -117.74678639570872, -106.01484737793605, -103.17899405459563, -103.07813934485118, -114.19178626934688, -102.7578128774961, -114.54974933465323, -102.55720867713293, -103.45898006111383, -104.35476332902908, -114.06442791223526, -103.03767461578052, -91.63346294562022, -92.57645134131114, -102.8920333882173, -115.43666162093481, -102.59358574201664, -112.68138986825943, -101.23471055924892, -102.37801966071129, -99.87270065148672, -95.71984231968722, -111.95005067189535, -117.08095037937164, -104.6858679652214, -103.32973150163889, -113.14299142360687, -102.71393156051636, -102.54393464326859, -15.041392038265869, -14.734556789199516, -15.004426280657455, -101.0475198229154, -99.98289846380553, -113.30923088391623, -111.36698996027312, -101.01027299960455, -104.89830990632376, -107.31835548082988, -96.27400581041972, -94.95411899189155, -104.02870480219524, -104.15240798393886, -114.76211417714755, -99.36327979962032, -97.42618695894878, -110.84657506148021, -96.50524400174618, -96.96173369884491, -108.48981261253357, -107.3764477968216, -94.6733218356967, -94.70572981238365, -101.14183034499487, -112.36974384387335, -101.04914109905562, -118.23655319213867, -105.06136831641197, -104.64670461416245, -108.55976366996765, -113.98890280723572, -121.82082051038742, -9.023855882386371, -9.411088372270271, -9.433291400472328, -116.65034413337708, -105.14098733663559, -105.25259643793106, -117.55696562925975, -114.52723173300426, -102.71253434816997, -106.24985265731812, -115.65148431062698, -103.79849980771542, -99.1320787469546, -110.49121365944545, -100.30919657150905, -100.97070826590061, -102.95575714111328, -114.5949558019638, -97.30852238213023, -110.14093061288199, -98.7842740615209, -117.25900220870972, -105.37502425909042, -104.02807223796844, -110.06982884804408, -98.03638815383117, -99.28400627772014, -97.0757810821136, -109.20103200276694, -98.5351217587789, -104.08389626940092, -115.71141197284064, -104.42950486143431, -112.13627396027248, -100.82366956273715, -101.91562799612682, -115.53178878625235, -102.6138408680757, -103.87238266070685, -99.5133253534635, -113.17296560605368, -97.33642644931874, -105.96220300594966, -105.9067775408427, -117.57970915238063, -112.34440914789836, -100.69203108052413, -101.30023098985355, 4.36633716026941, 3.9855267355839317, 4.061930688718945, -117.71290167172751, -107.5609727104505, -108.16616072257361, -14.378182731568813, -14.455259025096893, -14.687822751700878, -37.104603633284576, -38.61986762285233, -37.00345328450204, -112.13853571812312, -98.81778318683307, -99.52957500020663, -108.8381046752135, -96.55214643540482, -97.32950232426326, -104.48655924201012, -103.08681643009186, -115.98136162757874, -20.931367325286075, -21.050221222142383, -21.61426068345706, -192.35410745193562, -194.96974482138953, -209.97650726636252, -9.388350735108062, -7.549446413914367, -7.244115157673761, -110.34063728650412, -100.47170402606329, -100.96357287963232, -105.01666047175726, -117.6354835232099, -105.9382344086965, -100.68632766604424, -112.26363807916641, -100.07614843547344, -101.73014580706756, -103.57455215851466, -116.07844463984172, -93.39402099947135, -105.30072970191638, -94.79731185237567, -103.36812394857407, -114.63467735052109, -101.86604189872742, -108.75598005453746, -121.25477246443431, -107.5410053084294, -114.04573484261832, -103.31006362040839, -103.74483360846838, -94.55741809060177, -94.36382771780094, -107.3218180735906, -112.85581636428833, -100.99741104245186, -105.46927738189697, -103.05217773715655, -103.79039348165195, -115.55426673094432, -111.28362478812537, -99.54486550887427, -98.39884380002817, -95.60596995179853, -96.50287637611231, -108.88534011443457, -90.30907219648361, -103.4808394908905, -90.4419813156128, -98.08315244565408, -110.88382975260417, -99.62936774889629, -92.72099140286446, -103.51388531923294, -96.47511947154999, -101.76814985275269, -100.34677174687386, -113.48816615343094, -108.62527278562388, -122.03832050164542, -110.93307872613272, -101.58941960334778, -102.08597010374069, -114.86416226625443, -208.27305030822754, -220.16588461399078, -207.34647166728973, -101.12842444082102, -114.45429440339407, -103.52368380626044, -103.53191200147073, -104.9358550409476, -120.69888226191203, -102.26112856467566, -115.31686826546988, -102.03629567225775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1733795767627328, "mean_inference_ms": 0.7136476116283366, "mean_action_processing_ms": 0.09763679227515505, "mean_env_wait_ms": 0.7788029837452961, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 45000, "timesteps_this_iter": 0, "agent_timesteps_total": 135000, "timers": {"sample_time_ms": 10636.706, "sample_throughput": 470.07, "load_time_ms": 0.323, "load_throughput": 15472061.644, "learn_time_ms": 1976.015, "learn_throughput": 2530.345, "update_time_ms": 9.419}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0005000000000000001, "total_loss": 2420.69765625, "policy_loss": -0.002263350980433998, "vf_loss": 2420.756884765625, "vf_explained_var": 0.0033480048179626463, "kl": 0.0035989601019548343, "entropy": 5.697150325775146, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 45000, "num_agent_steps_sampled": 135000, "num_steps_trained": 45000, "num_agent_steps_trained": 135000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 489, "training_iteration": 9, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-02-58", "timestamp": 1706230978, "time_this_iter_s": 10.7545645236969, "time_total_s": 97.40212368965149, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402554790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 97.40212368965149, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 8.575, "ram_util_percent": 49.237500000000004}}
{"episode_reward_max": 12.413794584572287, "episode_reward_min": -635.785406589508, "episode_reward_mean": -296.0499375627376, "episode_len_mean": 108.77, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -220.16588461399078}, "policy_reward_max": {"shared_policy": 4.36633716026941}, "policy_reward_mean": {"shared_policy": -98.68331252091254}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-321.8781713023782, -287.24758890271187, -320.9222807511688, -316.29412008821964, -307.5425936430693, -325.09654984623194, -318.4008576273918, -44.78037510812284, -314.3396491706372, -317.27557286620146, -298.54648028314114, -322.94322696328163, -307.6360418200493, -301.95679031312466, -296.75549944490194, -314.56071528792387, -327.9446261227131, -344.3694869875908, -27.86823565512897, -327.0439279079437, -334.79673171043396, -325.6998367756605, -309.9324889779091, -318.5214212089777, -306.2337270565331, -326.6620987057686, -307.3902232795954, -304.8119348436594, -324.22481310367584, -314.87557151913643, -322.01801231503487, -310.0227174088359, -329.448689699173, -314.336671218276, 12.413794584572287, -333.4400351047516, -43.521264508366585, -112.72792454063874, -310.4858939051628, -302.71975343488157, -323.5547372996807, -63.59584923088543, -597.3003595396876, -24.18191230669619, -311.7759141921997, -328.59037840366364, -313.0261141806841, -321.3831426054239, -293.4920625537634, -319.86884319782257, -337.55175782740116, -321.10063207149506, -296.2430638819933, -319.32250478863716, -322.3968379497528, -309.22733409702784, -300.9941864423454, -284.2318930029869, -308.5963499471545, -292.7099961936474, -315.6030877530575, -341.59667201340204, -318.5395519733429, -635.785406589508, -319.1064026504755, -329.16664930433035, -319.61429250240326, -300.7087197601795, 6.030121788382502, -293.44326880574226, -292.8853010237217, -323.37971901893616, -320.8447256088257, -314.50656992942095, -300.3992042988539, -310.28266797959805, -320.3749854564667, -326.1913409233093, -330.83181917667395, -307.6896144002676, -326.2327877879143, -315.16341838240623, -289.2914676964283, -322.252971470356, -315.3731095343829, -306.1146123111248, -312.898888796568, -337.9223720431328, -327.6459470242262, -322.047222673893, -300.3566214889288, -308.7975940927863, -301.2709902226925, -310.6863245368004, -295.13607797026634, -327.11773474514484, -338.2974264025688, -330.71921306848526, -307.78558316826826, -22.960840940475464], "episode_lengths": [456, 68, 40, 74, 68, 60, 66, 500, 45, 67, 61, 49, 54, 65, 74, 65, 52, 56, 500, 43, 60, 74, 75, 43, 56, 60, 65, 75, 44, 62, 64, 77, 55, 58, 500, 76, 500, 500, 58, 74, 46, 500, 87, 500, 72, 53, 40, 62, 68, 75, 85, 54, 76, 59, 63, 81, 98, 92, 60, 68, 60, 82, 51, 65, 54, 61, 85, 90, 500, 63, 66, 94, 61, 63, 55, 88, 75, 62, 67, 75, 65, 59, 64, 60, 60, 78, 65, 68, 71, 46, 61, 69, 86, 80, 64, 89, 73, 71, 53, 500], "policy_shared_policy_reward": [-103.45898006111383, -104.35476332902908, -114.06442791223526, -103.03767461578052, -91.63346294562022, -92.57645134131114, -102.8920333882173, -115.43666162093481, -102.59358574201664, -112.68138986825943, -101.23471055924892, -102.37801966071129, -99.87270065148672, -95.71984231968722, -111.95005067189535, -117.08095037937164, -104.6858679652214, -103.32973150163889, -113.14299142360687, -102.71393156051636, -102.54393464326859, -15.041392038265869, -14.734556789199516, -15.004426280657455, -101.0475198229154, -99.98289846380553, -113.30923088391623, -111.36698996027312, -101.01027299960455, -104.89830990632376, -107.31835548082988, -96.27400581041972, -94.95411899189155, -104.02870480219524, -104.15240798393886, -114.76211417714755, -99.36327979962032, -97.42618695894878, -110.84657506148021, -96.50524400174618, -96.96173369884491, -108.48981261253357, -107.3764477968216, -94.6733218356967, -94.70572981238365, -101.14183034499487, -112.36974384387335, -101.04914109905562, -118.23655319213867, -105.06136831641197, -104.64670461416245, -108.55976366996765, -113.98890280723572, -121.82082051038742, -9.023855882386371, -9.411088372270271, -9.433291400472328, -116.65034413337708, -105.14098733663559, -105.25259643793106, -117.55696562925975, -114.52723173300426, -102.71253434816997, -106.24985265731812, -115.65148431062698, -103.79849980771542, -99.1320787469546, -110.49121365944545, -100.30919657150905, -100.97070826590061, -102.95575714111328, -114.5949558019638, -97.30852238213023, -110.14093061288199, -98.7842740615209, -117.25900220870972, -105.37502425909042, -104.02807223796844, -110.06982884804408, -98.03638815383117, -99.28400627772014, -97.0757810821136, -109.20103200276694, -98.5351217587789, -104.08389626940092, -115.71141197284064, -104.42950486143431, -112.13627396027248, -100.82366956273715, -101.91562799612682, -115.53178878625235, -102.6138408680757, -103.87238266070685, -99.5133253534635, -113.17296560605368, -97.33642644931874, -105.96220300594966, -105.9067775408427, -117.57970915238063, -112.34440914789836, -100.69203108052413, -101.30023098985355, 4.36633716026941, 3.9855267355839317, 4.061930688718945, -117.71290167172751, -107.5609727104505, -108.16616072257361, -14.378182731568813, -14.455259025096893, -14.687822751700878, -37.104603633284576, -38.61986762285233, -37.00345328450204, -112.13853571812312, -98.81778318683307, -99.52957500020663, -108.8381046752135, -96.55214643540482, -97.32950232426326, -104.48655924201012, -103.08681643009186, -115.98136162757874, -20.931367325286075, -21.050221222142383, -21.61426068345706, -192.35410745193562, -194.96974482138953, -209.97650726636252, -9.388350735108062, -7.549446413914367, -7.244115157673761, -110.34063728650412, -100.47170402606329, -100.96357287963232, -105.01666047175726, -117.6354835232099, -105.9382344086965, -100.68632766604424, -112.26363807916641, -100.07614843547344, -101.73014580706756, -103.57455215851466, -116.07844463984172, -93.39402099947135, -105.30072970191638, -94.79731185237567, -103.36812394857407, -114.63467735052109, -101.86604189872742, -108.75598005453746, -121.25477246443431, -107.5410053084294, -114.04573484261832, -103.31006362040839, -103.74483360846838, -94.55741809060177, -94.36382771780094, -107.3218180735906, -112.85581636428833, -100.99741104245186, -105.46927738189697, -103.05217773715655, -103.79039348165195, -115.55426673094432, -111.28362478812537, -99.54486550887427, -98.39884380002817, -95.60596995179853, -96.50287637611231, -108.88534011443457, -90.30907219648361, -103.4808394908905, -90.4419813156128, -98.08315244565408, -110.88382975260417, -99.62936774889629, -92.72099140286446, -103.51388531923294, -96.47511947154999, -101.76814985275269, -100.34677174687386, -113.48816615343094, -108.62527278562388, -122.03832050164542, -110.93307872613272, -101.58941960334778, -102.08597010374069, -114.86416226625443, -208.27305030822754, -220.16588461399078, -207.34647166728973, -101.12842444082102, -114.45429440339407, -103.52368380626044, -103.53191200147073, -104.9358550409476, -120.69888226191203, -102.26112856467566, -115.31686826546988, -102.03629567225775, -106.78676042954127, -97.00445670882861, -96.91750262180965, 2.1045914689699714, 1.6662203172842567, 2.2593100021282737, -94.25332162777583, -104.96149841944377, -94.22844875852267, -106.30949290593466, -93.21337523063025, -93.36243288715681, -103.64900561173758, -117.99553724129996, -101.73517616589865, -102.99890625476837, -114.50830686092377, -103.33751249313354, -101.36463515957198, -113.16018529733023, -99.98174947251877, -96.00859340031943, -95.48107940455279, -108.90953149398169, -100.17223110795021, -99.30649398267269, -110.80394288897514, -114.62407513459524, -103.05847688515982, -102.69243343671164, -115.21682945887248, -104.87377373377483, -106.10073773066203, -105.02086540063223, -108.48509033521017, -117.32586344083151, -99.75486175219218, -110.3826253215472, -97.55212732652824, -103.08532455563545, -104.51850691437721, -118.62895631790161, -99.83814657727878, -112.98703805605571, -102.33823374907176, -104.92620325088501, -92.00498080253601, -92.36028364300728, -114.88785672187805, -103.71172803640366, -103.65338671207428, -101.18019874890646, -99.71228543420634, -114.48062535127005, -109.81675583124161, -99.10854923725128, -97.18930724263191, -112.65527041753134, -99.07824086149535, -101.16537751754126, -108.27479282021523, -121.32670277357101, -108.32087644934654, -103.6935141136249, -117.59542735417685, -106.35700555642447, -105.08022630214691, -102.71442377567291, -114.25257259607315, -96.98452059427898, -95.87696146468322, -107.49513942996661, -97.94563745707273, -98.76545289158821, -112.08650374412537, -108.06225766738257, -96.20863934357962, -97.00009321173033, -110.41809916496277, -100.02525702118874, -100.24296835064888, -107.04269909858704, -93.68144744634628, -94.41193142533302, -104.20365603268147, -104.44278144836426, -118.47129726409912, -108.6172354221344, -119.85605657100677, -109.82413440942764, -105.91773555676143, -117.2232584754626, -107.57821903626125, -98.49820505579314, -111.3971298535665, -97.8902482589086, -7.68053213506937, -7.551228389143944, -7.72908041626215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17256883984246907, "mean_inference_ms": 0.7091241019915425, "mean_action_processing_ms": 0.096711663707219, "mean_env_wait_ms": 0.7763500200432837, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 50000, "timesteps_this_iter": 0, "agent_timesteps_total": 150000, "timers": {"sample_time_ms": 10621.175, "sample_throughput": 470.758, "load_time_ms": 0.291, "load_throughput": 17191179.605, "learn_time_ms": 1969.89, "learn_throughput": 2538.212, "update_time_ms": 9.277}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005000000000000001, "total_loss": 1666.9910888671875, "policy_loss": -0.002134265294111515, "vf_loss": 1667.0490112304688, "vf_explained_var": 0.0018752455711364747, "kl": 0.002137084323477648, "entropy": 5.584450531005859, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 50000, "num_agent_steps_sampled": 150000, "num_steps_trained": 50000, "num_agent_steps_trained": 150000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 522, "training_iteration": 10, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-03-09", "timestamp": 1706230989, "time_this_iter_s": 10.458164691925049, "time_total_s": 107.86028838157654, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D5AD30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 107.86028838157654, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 6.335714285714286, "ram_util_percent": 49.24285714285715}}
{"episode_reward_max": 19.400963723659487, "episode_reward_min": -635.785406589508, "episode_reward_mean": -278.02290404520346, "episode_len_mean": 127.6, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {"shared_policy": -220.16588461399078}, "policy_reward_max": {"shared_policy": 6.671818027893693}, "policy_reward_mean": {"shared_policy": -92.67430134840116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.521264508366585, -112.72792454063874, -310.4858939051628, -302.71975343488157, -323.5547372996807, -63.59584923088543, -597.3003595396876, -24.18191230669619, -311.7759141921997, -328.59037840366364, -313.0261141806841, -321.3831426054239, -293.4920625537634, -319.86884319782257, -337.55175782740116, -321.10063207149506, -296.2430638819933, -319.32250478863716, -322.3968379497528, -309.22733409702784, -300.9941864423454, -284.2318930029869, -308.5963499471545, -292.7099961936474, -315.6030877530575, -341.59667201340204, -318.5395519733429, -635.785406589508, -319.1064026504755, -329.16664930433035, -319.61429250240326, -300.7087197601795, 6.030121788382502, -293.44326880574226, -292.8853010237217, -323.37971901893616, -320.8447256088257, -314.50656992942095, -300.3992042988539, -310.28266797959805, -320.3749854564667, -326.1913409233093, -330.83181917667395, -307.6896144002676, -326.2327877879143, -315.16341838240623, -289.2914676964283, -322.252971470356, -315.3731095343829, -306.1146123111248, -312.898888796568, -337.9223720431328, -327.6459470242262, -322.047222673893, -300.3566214889288, -308.7975940927863, -301.2709902226925, -310.6863245368004, -295.13607797026634, -327.11773474514484, -338.2974264025688, -330.71921306848526, -307.78558316826826, -22.960840940475464, 13.815026070922599, -304.1329991389066, -297.9031014953507, -322.896271109581, 19.400963723659487, -319.6564198583365, -309.45911865215754, -315.2239712178707, -322.88012996315956, -302.23611810058355, -24.719975292682676, -292.2436871752143, -323.837019957602, -297.2360890507698, -310.7501081377268, -305.5278798639775, -323.9577736593783, -35.505357161164284, -25.636499039828777, -297.7813154691831, -327.85550794005394, -311.2777639776468, -323.3513100296259, -290.4332658709027, 18.3016738332808, -14.570653002709165, -312.41012012399733, -305.1824558749795, -320.9130249992013, 19.220213882625075, -317.92778669297695, -314.16313831135636, -287.8124338686466, -318.9189327955246, -294.4983391612768, -310.5399271994829], "episode_lengths": [500, 500, 58, 74, 46, 500, 87, 500, 72, 53, 40, 62, 68, 75, 85, 54, 76, 59, 63, 81, 98, 92, 60, 68, 60, 82, 51, 65, 54, 61, 85, 90, 500, 63, 66, 94, 61, 63, 55, 88, 75, 62, 67, 75, 65, 59, 64, 60, 60, 78, 65, 68, 71, 46, 61, 69, 86, 80, 64, 89, 73, 71, 53, 500, 500, 61, 59, 72, 500, 69, 58, 77, 63, 59, 500, 103, 59, 111, 49, 68, 57, 500, 500, 58, 44, 69, 42, 65, 500, 500, 43, 56, 54, 500, 63, 53, 77, 61, 68, 72], "policy_shared_policy_reward": [-14.378182731568813, -14.455259025096893, -14.687822751700878, -37.104603633284576, -38.61986762285233, -37.00345328450204, -112.13853571812312, -98.81778318683307, -99.52957500020663, -108.8381046752135, -96.55214643540482, -97.32950232426326, -104.48655924201012, -103.08681643009186, -115.98136162757874, -20.931367325286075, -21.050221222142383, -21.61426068345706, -192.35410745193562, -194.96974482138953, -209.97650726636252, -9.388350735108062, -7.549446413914367, -7.244115157673761, -110.34063728650412, -100.47170402606329, -100.96357287963232, -105.01666047175726, -117.6354835232099, -105.9382344086965, -100.68632766604424, -112.26363807916641, -100.07614843547344, -101.73014580706756, -103.57455215851466, -116.07844463984172, -93.39402099947135, -105.30072970191638, -94.79731185237567, -103.36812394857407, -114.63467735052109, -101.86604189872742, -108.75598005453746, -121.25477246443431, -107.5410053084294, -114.04573484261832, -103.31006362040839, -103.74483360846838, -94.55741809060177, -94.36382771780094, -107.3218180735906, -112.85581636428833, -100.99741104245186, -105.46927738189697, -103.05217773715655, -103.79039348165195, -115.55426673094432, -111.28362478812537, -99.54486550887427, -98.39884380002817, -95.60596995179853, -96.50287637611231, -108.88534011443457, -90.30907219648361, -103.4808394908905, -90.4419813156128, -98.08315244565408, -110.88382975260417, -99.62936774889629, -92.72099140286446, -103.51388531923294, -96.47511947154999, -101.76814985275269, -100.34677174687386, -113.48816615343094, -108.62527278562388, -122.03832050164542, -110.93307872613272, -101.58941960334778, -102.08597010374069, -114.86416226625443, -208.27305030822754, -220.16588461399078, -207.34647166728973, -101.12842444082102, -114.45429440339407, -103.52368380626044, -103.53191200147073, -104.9358550409476, -120.69888226191203, -102.26112856467566, -115.31686826546988, -102.03629567225775, -106.78676042954127, -97.00445670882861, -96.91750262180965, 2.1045914689699714, 1.6662203172842567, 2.2593100021282737, -94.25332162777583, -104.96149841944377, -94.22844875852267, -106.30949290593466, -93.21337523063025, -93.36243288715681, -103.64900561173758, -117.99553724129996, -101.73517616589865, -102.99890625476837, -114.50830686092377, -103.33751249313354, -101.36463515957198, -113.16018529733023, -99.98174947251877, -96.00859340031943, -95.48107940455279, -108.90953149398169, -100.17223110795021, -99.30649398267269, -110.80394288897514, -114.62407513459524, -103.05847688515982, -102.69243343671164, -115.21682945887248, -104.87377373377483, -106.10073773066203, -105.02086540063223, -108.48509033521017, -117.32586344083151, -99.75486175219218, -110.3826253215472, -97.55212732652824, -103.08532455563545, -104.51850691437721, -118.62895631790161, -99.83814657727878, -112.98703805605571, -102.33823374907176, -104.92620325088501, -92.00498080253601, -92.36028364300728, -114.88785672187805, -103.71172803640366, -103.65338671207428, -101.18019874890646, -99.71228543420634, -114.48062535127005, -109.81675583124161, -99.10854923725128, -97.18930724263191, -112.65527041753134, -99.07824086149535, -101.16537751754126, -108.27479282021523, -121.32670277357101, -108.32087644934654, -103.6935141136249, -117.59542735417685, -106.35700555642447, -105.08022630214691, -102.71442377567291, -114.25257259607315, -96.98452059427898, -95.87696146468322, -107.49513942996661, -97.94563745707273, -98.76545289158821, -112.08650374412537, -108.06225766738257, -96.20863934357962, -97.00009321173033, -110.41809916496277, -100.02525702118874, -100.24296835064888, -107.04269909858704, -93.68144744634628, -94.41193142533302, -104.20365603268147, -104.44278144836426, -118.47129726409912, -108.6172354221344, -119.85605657100677, -109.82413440942764, -105.91773555676143, -117.2232584754626, -107.57821903626125, -98.49820505579314, -111.3971298535665, -97.8902482589086, -7.68053213506937, -7.551228389143944, -7.72908041626215, 4.683646147449807, 4.900826529910162, 4.23055339356263, -97.08092562357585, -94.76821195768814, -112.28386155764262, -107.41346273819606, -94.84436747575334, -95.64527128140132, -115.28474014997482, -104.41786062717438, -103.1936703324318, 6.65909035007158, 6.671818027893693, 6.070055345694215, -113.51564164956412, -103.56092240413031, -102.57985580464205, -100.35081655563167, -106.20589514573416, -102.90240695079169, -111.85672210653624, -101.7043870886167, -101.6628620227178, -113.95396068692207, -103.45646947622299, -105.4696998000145, -108.41745012998581, -95.93433742970228, -97.88433054089546, -8.112352651854366, -8.092094672222942, -8.515527968605369, -93.40476874262094, -93.3677639812231, -105.47115445137024, -102.8916302099824, -116.65829503536224, -104.28709471225739, -95.02254290382068, -106.68687609831493, -95.52667004863422, -112.69288529952368, -99.06188388665518, -98.99533895154795, -97.99052848418555, -109.90564181407294, -97.63170956571898, -102.82453331723809, -105.56745731830597, -115.56578302383423, -11.842462345957756, -11.623416393995285, -12.039478421211243, -7.734784223139286, -7.743637338280678, -10.158077478408813, -108.54054113229117, -95.02538395424685, -94.21539038264504, -105.19668451944987, -117.5202583471934, -105.13856507341067, -111.54168260097504, -100.31895470619202, -99.41712667047977, -101.29140674571197, -118.59466008345287, -103.46524320046107, -104.42864708105724, -94.10534582535426, -91.8992729644912, 5.856682702898979, 6.402955714613199, 6.042035415768623, -5.142750302950546, -4.8593422869841305, -4.568560412774488, -101.32912912964821, -99.35773330368102, -111.7232576906681, -109.38483409086864, -97.34362806628148, -98.45399371782939, -101.7847003315886, -103.00822122891745, -116.12010343869528, 6.313174674908311, 6.6204118827978675, 6.286627324918896, -108.26140433053176, -109.7262934545676, -99.94008890787761, -99.48233157520494, -113.82313998540243, -100.85766675074896, -91.17219260334969, -92.09277278184891, -104.54746848344803, -112.50649684667587, -103.13809075951576, -103.27434518933296, -94.58441950877508, -106.66716911395392, -93.24675053854784, -100.40044365326564, -110.6423133412997, -99.4971702049176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16888230423866474, "mean_inference_ms": 0.7051740355423232, "mean_action_processing_ms": 0.09629450530629072, "mean_env_wait_ms": 0.7789582907880837, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 55000, "timesteps_this_iter": 0, "agent_timesteps_total": 165000, "timers": {"sample_time_ms": 10860.799, "sample_throughput": 460.371, "load_time_ms": 0.191, "load_throughput": 26191482.453, "learn_time_ms": 1972.608, "learn_throughput": 2534.715, "update_time_ms": 9.276}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005000000000000001, "total_loss": 1498.030126953125, "policy_loss": -0.0026164567808480976, "vf_loss": 1498.0884155273438, "vf_explained_var": 0.003698587417602539, "kl": 0.0031381501670708556, "entropy": 5.564226722717285, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 55000, "num_agent_steps_sampled": 165000, "num_steps_trained": 55000, "num_agent_steps_trained": 165000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 558, "training_iteration": 11, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-03-20", "timestamp": 1706231000, "time_this_iter_s": 11.147695779800415, "time_total_s": 119.00798416137695, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140239E4C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 119.00798416137695, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 10.2375, "ram_util_percent": 49.19375000000001}}
{"episode_reward_max": 19.400963723659487, "episode_reward_min": -338.2974264025688, "episode_reward_mean": -257.2172087565938, "episode_len_mean": 144.17, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"shared_policy": -121.32670277357101}, "policy_reward_max": {"shared_policy": 6.671818027893693}, "policy_reward_mean": {"shared_policy": -85.73906958553125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-300.7087197601795, 6.030121788382502, -293.44326880574226, -292.8853010237217, -323.37971901893616, -320.8447256088257, -314.50656992942095, -300.3992042988539, -310.28266797959805, -320.3749854564667, -326.1913409233093, -330.83181917667395, -307.6896144002676, -326.2327877879143, -315.16341838240623, -289.2914676964283, -322.252971470356, -315.3731095343829, -306.1146123111248, -312.898888796568, -337.9223720431328, -327.6459470242262, -322.047222673893, -300.3566214889288, -308.7975940927863, -301.2709902226925, -310.6863245368004, -295.13607797026634, -327.11773474514484, -338.2974264025688, -330.71921306848526, -307.78558316826826, -22.960840940475464, 13.815026070922599, -304.1329991389066, -297.9031014953507, -322.896271109581, 19.400963723659487, -319.6564198583365, -309.45911865215754, -315.2239712178707, -322.88012996315956, -302.23611810058355, -24.719975292682676, -292.2436871752143, -323.837019957602, -297.2360890507698, -310.7501081377268, -305.5278798639775, -323.9577736593783, -35.505357161164284, -25.636499039828777, -297.7813154691831, -327.85550794005394, -311.2777639776468, -323.3513100296259, -290.4332658709027, 18.3016738332808, -14.570653002709165, -312.41012012399733, -305.1824558749795, -320.9130249992013, 19.220213882625075, -317.92778669297695, -314.16313831135636, -287.8124338686466, -318.9189327955246, -294.4983391612768, -310.5399271994829, -24.623946622014046, -309.25923949480057, -284.29091411828995, -319.7350127398968, -317.3383729457855, -316.36505392193794, -34.439429596066475, -315.8257525861263, -278.7270751185715, -303.0512478649616, -314.1120597720147, -314.7870495915413, -23.83250863850118, -27.885002814233317, -21.831335693597822, -300.07915065437555, -310.37375646829605, -321.2587897181511, -31.18222363293171, -310.5373954921961, -300.83812046423554, -308.8885189145804, -313.0996165275574, -309.16826055943966, -275.33391173928976, -4.380529426038294, -14.660469908267274, -314.64309050887823, -321.5394723713398, -294.4435127489269, -320.91041937470436], "episode_lengths": [90, 500, 63, 66, 94, 61, 63, 55, 88, 75, 62, 67, 75, 65, 59, 64, 60, 60, 78, 65, 68, 71, 46, 61, 69, 86, 80, 64, 89, 73, 71, 53, 500, 500, 61, 59, 72, 500, 69, 58, 77, 63, 59, 500, 103, 59, 111, 49, 68, 57, 500, 500, 58, 44, 69, 42, 65, 500, 500, 43, 56, 54, 500, 63, 53, 77, 61, 68, 72, 500, 62, 65, 65, 48, 60, 500, 59, 100, 79, 52, 62, 500, 500, 500, 97, 56, 90, 500, 56, 53, 66, 68, 65, 87, 500, 500, 42, 49, 63, 42], "policy_shared_policy_reward": [-106.78676042954127, -97.00445670882861, -96.91750262180965, 2.1045914689699714, 1.6662203172842567, 2.2593100021282737, -94.25332162777583, -104.96149841944377, -94.22844875852267, -106.30949290593466, -93.21337523063025, -93.36243288715681, -103.64900561173758, -117.99553724129996, -101.73517616589865, -102.99890625476837, -114.50830686092377, -103.33751249313354, -101.36463515957198, -113.16018529733023, -99.98174947251877, -96.00859340031943, -95.48107940455279, -108.90953149398169, -100.17223110795021, -99.30649398267269, -110.80394288897514, -114.62407513459524, -103.05847688515982, -102.69243343671164, -115.21682945887248, -104.87377373377483, -106.10073773066203, -105.02086540063223, -108.48509033521017, -117.32586344083151, -99.75486175219218, -110.3826253215472, -97.55212732652824, -103.08532455563545, -104.51850691437721, -118.62895631790161, -99.83814657727878, -112.98703805605571, -102.33823374907176, -104.92620325088501, -92.00498080253601, -92.36028364300728, -114.88785672187805, -103.71172803640366, -103.65338671207428, -101.18019874890646, -99.71228543420634, -114.48062535127005, -109.81675583124161, -99.10854923725128, -97.18930724263191, -112.65527041753134, -99.07824086149535, -101.16537751754126, -108.27479282021523, -121.32670277357101, -108.32087644934654, -103.6935141136249, -117.59542735417685, -106.35700555642447, -105.08022630214691, -102.71442377567291, -114.25257259607315, -96.98452059427898, -95.87696146468322, -107.49513942996661, -97.94563745707273, -98.76545289158821, -112.08650374412537, -108.06225766738257, -96.20863934357962, -97.00009321173033, -110.41809916496277, -100.02525702118874, -100.24296835064888, -107.04269909858704, -93.68144744634628, -94.41193142533302, -104.20365603268147, -104.44278144836426, -118.47129726409912, -108.6172354221344, -119.85605657100677, -109.82413440942764, -105.91773555676143, -117.2232584754626, -107.57821903626125, -98.49820505579314, -111.3971298535665, -97.8902482589086, -7.68053213506937, -7.551228389143944, -7.72908041626215, 4.683646147449807, 4.900826529910162, 4.23055339356263, -97.08092562357585, -94.76821195768814, -112.28386155764262, -107.41346273819606, -94.84436747575334, -95.64527128140132, -115.28474014997482, -104.41786062717438, -103.1936703324318, 6.65909035007158, 6.671818027893693, 6.070055345694215, -113.51564164956412, -103.56092240413031, -102.57985580464205, -100.35081655563167, -106.20589514573416, -102.90240695079169, -111.85672210653624, -101.7043870886167, -101.6628620227178, -113.95396068692207, -103.45646947622299, -105.4696998000145, -108.41745012998581, -95.93433742970228, -97.88433054089546, -8.112352651854366, -8.092094672222942, -8.515527968605369, -93.40476874262094, -93.3677639812231, -105.47115445137024, -102.8916302099824, -116.65829503536224, -104.28709471225739, -95.02254290382068, -106.68687609831493, -95.52667004863422, -112.69288529952368, -99.06188388665518, -98.99533895154795, -97.99052848418555, -109.90564181407294, -97.63170956571898, -102.82453331723809, -105.56745731830597, -115.56578302383423, -11.842462345957756, -11.623416393995285, -12.039478421211243, -7.734784223139286, -7.743637338280678, -10.158077478408813, -108.54054113229117, -95.02538395424685, -94.21539038264504, -105.19668451944987, -117.5202583471934, -105.13856507341067, -111.54168260097504, -100.31895470619202, -99.41712667047977, -101.29140674571197, -118.59466008345287, -103.46524320046107, -104.42864708105724, -94.10534582535426, -91.8992729644912, 5.856682702898979, 6.402955714613199, 6.042035415768623, -5.142750302950546, -4.8593422869841305, -4.568560412774488, -101.32912912964821, -99.35773330368102, -111.7232576906681, -109.38483409086864, -97.34362806628148, -98.45399371782939, -101.7847003315886, -103.00822122891745, -116.12010343869528, 6.313174674908311, 6.6204118827978675, 6.286627324918896, -108.26140433053176, -109.7262934545676, -99.94008890787761, -99.48233157520494, -113.82313998540243, -100.85766675074896, -91.17219260334969, -92.09277278184891, -104.54746848344803, -112.50649684667587, -103.13809075951576, -103.27434518933296, -94.58441950877508, -106.66716911395392, -93.24675053854784, -100.40044365326564, -110.6423133412997, -99.4971702049176, -8.076258823275566, -8.115784525871277, -8.431903272867203, -99.17361127336821, -110.53425403436026, -99.55137418707213, -96.54184883832932, -93.95424535870552, -93.79481992125511, -113.44079288840294, -102.69680190086365, -103.59741795063019, -114.41133455435435, -100.68200812737147, -102.24503026405971, -114.33778349558513, -101.19131405154864, -100.83595637480418, -11.042707026004791, -11.529819130897522, -11.866903439164162, -108.44908320903778, -102.4414754807949, -104.93519389629364, -90.66333341598511, -100.41067379713058, -87.65306790545583, -108.55861260493597, -97.15480505426726, -97.33783020575842, -104.16280513008437, -106.64965172608694, -103.29960291584334, -114.12573119004568, -100.90755571921667, -99.75376268227896, -7.805805856982872, -7.92398562530677, -8.10271715621154, -9.405828672150776, -9.35850925246875, -9.120664889613792, -7.270613600810378, -7.1967727591594155, -7.363949333628028, -95.513760574162, -107.98472040891647, -96.58066967129707, -99.04647818207741, -111.7743775844574, -99.55290070176125, -102.73252073923747, -114.6623328725497, -103.86393610636394, -11.073744595050812, -10.1606934517622, -9.947785586118698, -111.18763762712479, -99.17284692823887, -100.17691093683243, -108.21520117918651, -97.39672137300174, -95.22619791204731, -98.63608468075594, -111.11562039454779, -99.13681383927664, -101.41223382949829, -97.55234670639038, -114.1350359916687, -112.29055392742157, -99.11637696623802, -97.76132966578007, -101.3775725166003, -86.97764864812295, -86.97869057456653, -1.3433379729588921, -1.7957036246856148, -1.2414878283937867, -5.186096603671714, -4.893345932165786, -4.581027372429773, -100.10147762546937, -112.59492800633113, -101.94668487707774, -102.44728692869346, -102.13553466896217, -116.95665077368419, -93.82401539757848, -106.78930205106735, -93.83019530028105, -104.05556003252666, -115.05775252978007, -101.79710681239764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16851406009195966, "mean_inference_ms": 0.7081358013010035, "mean_action_processing_ms": 0.09690504665219699, "mean_env_wait_ms": 0.7841189953694134, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 60000, "timesteps_this_iter": 0, "agent_timesteps_total": 180000, "timers": {"sample_time_ms": 10845.717, "sample_throughput": 461.011, "load_time_ms": 0.291, "load_throughput": 17189770.492, "learn_time_ms": 1959.374, "learn_throughput": 2551.836, "update_time_ms": 9.277}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1205.3078002929688, "policy_loss": -0.0023900377823117937, "vf_loss": 1205.3648315429687, "vf_explained_var": 0.0035857200622558595, "kl": 0.0034863300941668203, "entropy": 5.463152027130127, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 60000, "num_agent_steps_sampled": 180000, "num_steps_trained": 60000, "num_agent_steps_trained": 180000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 589, "training_iteration": 12, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-03-31", "timestamp": 1706231011, "time_this_iter_s": 10.730011940002441, "time_total_s": 129.7379961013794, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140239EA60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 129.7379961013794, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 6.073333333333333, "ram_util_percent": 49.239999999999995}}
{"episode_reward_max": 19.400963723659487, "episode_reward_min": -338.2974264025688, "episode_reward_mean": -250.7810375407792, "episode_len_mean": 153.87, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {"shared_policy": -120.45183944702148}, "policy_reward_max": {"shared_policy": 6.671818027893693}, "policy_reward_mean": {"shared_policy": -83.59367918025974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-338.2974264025688, -330.71921306848526, -307.78558316826826, -22.960840940475464, 13.815026070922599, -304.1329991389066, -297.9031014953507, -322.896271109581, 19.400963723659487, -319.6564198583365, -309.45911865215754, -315.2239712178707, -322.88012996315956, -302.23611810058355, -24.719975292682676, -292.2436871752143, -323.837019957602, -297.2360890507698, -310.7501081377268, -305.5278798639775, -323.9577736593783, -35.505357161164284, -25.636499039828777, -297.7813154691831, -327.85550794005394, -311.2777639776468, -323.3513100296259, -290.4332658709027, 18.3016738332808, -14.570653002709165, -312.41012012399733, -305.1824558749795, -320.9130249992013, 19.220213882625075, -317.92778669297695, -314.16313831135636, -287.8124338686466, -318.9189327955246, -294.4983391612768, -310.5399271994829, -24.623946622014046, -309.25923949480057, -284.29091411828995, -319.7350127398968, -317.3383729457855, -316.36505392193794, -34.439429596066475, -315.8257525861263, -278.7270751185715, -303.0512478649616, -314.1120597720147, -314.7870495915413, -23.83250863850118, -27.885002814233317, -21.831335693597822, -300.07915065437555, -310.37375646829605, -321.2587897181511, -31.18222363293171, -310.5373954921961, -300.83812046423554, -308.8885189145804, -313.0996165275574, -309.16826055943966, -275.33391173928976, -4.380529426038294, -14.660469908267274, -314.64309050887823, -321.5394723713398, -294.4435127489269, -320.91041937470436, -322.2648757100106, -313.1788257807493, -307.25477561354637, -308.62301306053996, -318.18523651361465, -313.35737913288176, -309.30662866681814, -305.00344569236046, -292.4897606447339, 5.432508520781994, -299.70032879477367, -306.70283928513527, -300.8186287134886, -304.772008985281, -4.85033370181921, -331.64841751754284, -333.4898287951946, -315.772379308939, -302.00697034597397, -321.9977189004421, -293.1817356944084, -312.8909883648157, -293.01153077557683, -328.34553867578506, 11.087428867816897, -326.17862586677074, -317.713519513607, -327.49347750842577, -316.4799596145749], "episode_lengths": [73, 71, 53, 500, 500, 61, 59, 72, 500, 69, 58, 77, 63, 59, 500, 103, 59, 111, 49, 68, 57, 500, 500, 58, 44, 69, 42, 65, 500, 500, 43, 56, 54, 500, 63, 53, 77, 61, 68, 72, 500, 62, 65, 65, 48, 60, 500, 59, 100, 79, 52, 62, 500, 500, 500, 97, 56, 90, 500, 56, 53, 66, 68, 65, 87, 500, 500, 42, 49, 63, 42, 64, 71, 63, 64, 42, 67, 64, 88, 66, 500, 56, 64, 68, 97, 500, 110, 58, 88, 51, 45, 68, 120, 68, 61, 500, 127, 64, 129, 51], "policy_shared_policy_reward": [-108.6172354221344, -119.85605657100677, -109.82413440942764, -105.91773555676143, -117.2232584754626, -107.57821903626125, -98.49820505579314, -111.3971298535665, -97.8902482589086, -7.68053213506937, -7.551228389143944, -7.72908041626215, 4.683646147449807, 4.900826529910162, 4.23055339356263, -97.08092562357585, -94.76821195768814, -112.28386155764262, -107.41346273819606, -94.84436747575334, -95.64527128140132, -115.28474014997482, -104.41786062717438, -103.1936703324318, 6.65909035007158, 6.671818027893693, 6.070055345694215, -113.51564164956412, -103.56092240413031, -102.57985580464205, -100.35081655563167, -106.20589514573416, -102.90240695079169, -111.85672210653624, -101.7043870886167, -101.6628620227178, -113.95396068692207, -103.45646947622299, -105.4696998000145, -108.41745012998581, -95.93433742970228, -97.88433054089546, -8.112352651854366, -8.092094672222942, -8.515527968605369, -93.40476874262094, -93.3677639812231, -105.47115445137024, -102.8916302099824, -116.65829503536224, -104.28709471225739, -95.02254290382068, -106.68687609831493, -95.52667004863422, -112.69288529952368, -99.06188388665518, -98.99533895154795, -97.99052848418555, -109.90564181407294, -97.63170956571898, -102.82453331723809, -105.56745731830597, -115.56578302383423, -11.842462345957756, -11.623416393995285, -12.039478421211243, -7.734784223139286, -7.743637338280678, -10.158077478408813, -108.54054113229117, -95.02538395424685, -94.21539038264504, -105.19668451944987, -117.5202583471934, -105.13856507341067, -111.54168260097504, -100.31895470619202, -99.41712667047977, -101.29140674571197, -118.59466008345287, -103.46524320046107, -104.42864708105724, -94.10534582535426, -91.8992729644912, 5.856682702898979, 6.402955714613199, 6.042035415768623, -5.142750302950546, -4.8593422869841305, -4.568560412774488, -101.32912912964821, -99.35773330368102, -111.7232576906681, -109.38483409086864, -97.34362806628148, -98.45399371782939, -101.7847003315886, -103.00822122891745, -116.12010343869528, 6.313174674908311, 6.6204118827978675, 6.286627324918896, -108.26140433053176, -109.7262934545676, -99.94008890787761, -99.48233157520494, -113.82313998540243, -100.85766675074896, -91.17219260334969, -92.09277278184891, -104.54746848344803, -112.50649684667587, -103.13809075951576, -103.27434518933296, -94.58441950877508, -106.66716911395392, -93.24675053854784, -100.40044365326564, -110.6423133412997, -99.4971702049176, -8.076258823275566, -8.115784525871277, -8.431903272867203, -99.17361127336821, -110.53425403436026, -99.55137418707213, -96.54184883832932, -93.95424535870552, -93.79481992125511, -113.44079288840294, -102.69680190086365, -103.59741795063019, -114.41133455435435, -100.68200812737147, -102.24503026405971, -114.33778349558513, -101.19131405154864, -100.83595637480418, -11.042707026004791, -11.529819130897522, -11.866903439164162, -108.44908320903778, -102.4414754807949, -104.93519389629364, -90.66333341598511, -100.41067379713058, -87.65306790545583, -108.55861260493597, -97.15480505426726, -97.33783020575842, -104.16280513008437, -106.64965172608694, -103.29960291584334, -114.12573119004568, -100.90755571921667, -99.75376268227896, -7.805805856982872, -7.92398562530677, -8.10271715621154, -9.405828672150776, -9.35850925246875, -9.120664889613792, -7.270613600810378, -7.1967727591594155, -7.363949333628028, -95.513760574162, -107.98472040891647, -96.58066967129707, -99.04647818207741, -111.7743775844574, -99.55290070176125, -102.73252073923747, -114.6623328725497, -103.86393610636394, -11.073744595050812, -10.1606934517622, -9.947785586118698, -111.18763762712479, -99.17284692823887, -100.17691093683243, -108.21520117918651, -97.39672137300174, -95.22619791204731, -98.63608468075594, -111.11562039454779, -99.13681383927664, -101.41223382949829, -97.55234670639038, -114.1350359916687, -112.29055392742157, -99.11637696623802, -97.76132966578007, -101.3775725166003, -86.97764864812295, -86.97869057456653, -1.3433379729588921, -1.7957036246856148, -1.2414878283937867, -5.186096603671714, -4.893345932165786, -4.581027372429773, -100.10147762546937, -112.59492800633113, -101.94668487707774, -102.44728692869346, -102.13553466896217, -116.95665077368419, -93.82401539757848, -106.78930205106735, -93.83019530028105, -104.05556003252666, -115.05775252978007, -101.79710681239764, -113.94337632258734, -105.52988954385123, -102.79160984357199, -99.43473004798095, -113.55173901716869, -100.1923567155997, -109.9788319071134, -98.31410025556883, -98.96184345086417, -97.401507537812, -110.92726624011993, -100.29423928260803, -102.39490054051082, -114.4729538957278, -101.31738207737605, -99.23625370301306, -100.53845432400703, -113.58267110586166, -111.30446602900824, -99.59760715564093, -98.404555482169, -97.93808201452097, -109.6080167790254, -97.45734689881405, -91.72235311816137, -91.31363076965015, -109.45377675692241, 1.850383073091507, 1.8890002891421318, 1.693125158548355, -97.3522239701512, -99.53073246280353, -102.81737236181895, -110.53000152111053, -98.42654645442963, -97.74629130959511, -107.82339502374332, -96.20157864193122, -96.79365504781406, -97.82869896292686, -109.37946712970734, -97.56384289264679, -1.816358198722213, -1.7142095093925889, -1.319765993704408, -105.78756800293922, -106.35696752369404, -119.50388199090958, -107.14021998643875, -120.45183944702148, -105.89776936173439, -112.00992896159491, -101.30303083856901, -102.45941950877508, -108.6196619272232, -97.01825097203255, -96.36905744671822, -103.42928338050842, -103.78907892107964, -114.77935659885406, -93.3061195810636, -95.16237332423529, -104.71324278910956, -99.82528732468685, -99.81501163293919, -113.2506894071897, -105.27506996194522, -93.01115488881867, -94.72530592481296, -104.81973032156627, -117.01038638750713, -106.51542196671168, 3.6648323560754363, 3.7100292916099136, 3.7125672201315467, -104.61287092665832, -105.25950540105502, -116.30624953905742, -113.3136975367864, -101.43728967507681, -102.96253230174383, -103.94164583583674, -117.963374098142, -105.588457574447, -100.65302275617918, -100.56405466546616, -115.2628821929296]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1682001586252646, "mean_inference_ms": 0.7109005958024127, "mean_action_processing_ms": 0.09710654056128255, "mean_env_wait_ms": 0.7852354621059638, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 65000, "timesteps_this_iter": 0, "agent_timesteps_total": 195000, "timers": {"sample_time_ms": 10823.708, "sample_throughput": 461.949, "load_time_ms": 0.291, "load_throughput": 17189770.492, "learn_time_ms": 1956.013, "learn_throughput": 2556.22, "update_time_ms": 9.295}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1310.8865234375, "policy_loss": -0.002233965028862883, "vf_loss": 1310.94375, "vf_explained_var": 0.0032669723033905028, "kl": 0.003081953873335687, "entropy": 5.495175743103028, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 65000, "num_agent_steps_sampled": 195000, "num_steps_trained": 65000, "num_agent_steps_trained": 195000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 618, "training_iteration": 13, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-03-41", "timestamp": 1706231021, "time_this_iter_s": 10.604551315307617, "time_total_s": 140.342547416687, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002146F757550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 140.342547416687, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 6.213333333333334, "ram_util_percent": 49.2}}
{"episode_reward_max": 21.151025451719732, "episode_reward_min": -601.7122869044542, "episode_reward_mean": -242.27118349787312, "episode_len_mean": 171.33, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {"shared_policy": -209.51750320196152}, "policy_reward_max": {"shared_policy": 7.208431216577679}, "policy_reward_mean": {"shared_policy": -80.75706116595772}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.3016738332808, -14.570653002709165, -312.41012012399733, -305.1824558749795, -320.9130249992013, 19.220213882625075, -317.92778669297695, -314.16313831135636, -287.8124338686466, -318.9189327955246, -294.4983391612768, -310.5399271994829, -24.623946622014046, -309.25923949480057, -284.29091411828995, -319.7350127398968, -317.3383729457855, -316.36505392193794, -34.439429596066475, -315.8257525861263, -278.7270751185715, -303.0512478649616, -314.1120597720147, -314.7870495915413, -23.83250863850118, -27.885002814233317, -21.831335693597822, -300.07915065437555, -310.37375646829605, -321.2587897181511, -31.18222363293171, -310.5373954921961, -300.83812046423554, -308.8885189145804, -313.0996165275574, -309.16826055943966, -275.33391173928976, -4.380529426038294, -14.660469908267274, -314.64309050887823, -321.5394723713398, -294.4435127489269, -320.91041937470436, -322.2648757100106, -313.1788257807493, -307.25477561354637, -308.62301306053996, -318.18523651361465, -313.35737913288176, -309.30662866681814, -305.00344569236046, -292.4897606447339, 5.432508520781994, -299.70032879477367, -306.70283928513527, -300.8186287134886, -304.772008985281, -4.85033370181921, -331.64841751754284, -333.4898287951946, -315.772379308939, -302.00697034597397, -321.9977189004421, -293.1817356944084, -312.8909883648157, -293.01153077557683, -328.34553867578506, 11.087428867816897, -326.17862586677074, -317.713519513607, -327.49347750842577, -316.4799596145749, -19.675267800688744, -25.39250020682813, -284.44097658619285, -268.1521691530943, 17.542629703879356, -284.1606371998787, -322.7867768108845, 21.151025451719732, -291.7942811697722, -316.4374630087987, -276.9882749319077, -47.30328742414713, -298.8942374289036, -309.54493775963783, -292.2139084339142, -293.03942534700036, -351.2756501585245, 12.096373230218859, -24.385642506182222, -308.1063857469708, -331.27296005934477, -291.4252162501216, -4.98547327890995, -329.3868346065283, -286.54303377121687, 13.597754728049011, -601.7122869044542, -304.53350822627544], "episode_lengths": [500, 500, 43, 56, 54, 500, 63, 53, 77, 61, 68, 72, 500, 62, 65, 65, 48, 60, 500, 59, 100, 79, 52, 62, 500, 500, 500, 97, 56, 90, 500, 56, 53, 66, 68, 65, 87, 500, 500, 42, 49, 63, 42, 64, 71, 63, 64, 42, 67, 64, 88, 66, 500, 56, 64, 68, 97, 500, 110, 58, 88, 51, 45, 68, 120, 68, 61, 500, 127, 64, 129, 51, 500, 500, 66, 120, 500, 116, 52, 500, 109, 80, 102, 500, 103, 72, 73, 76, 105, 500, 500, 77, 83, 82, 500, 77, 100, 500, 107, 86], "policy_shared_policy_reward": [5.856682702898979, 6.402955714613199, 6.042035415768623, -5.142750302950546, -4.8593422869841305, -4.568560412774488, -101.32912912964821, -99.35773330368102, -111.7232576906681, -109.38483409086864, -97.34362806628148, -98.45399371782939, -101.7847003315886, -103.00822122891745, -116.12010343869528, 6.313174674908311, 6.6204118827978675, 6.286627324918896, -108.26140433053176, -109.7262934545676, -99.94008890787761, -99.48233157520494, -113.82313998540243, -100.85766675074896, -91.17219260334969, -92.09277278184891, -104.54746848344803, -112.50649684667587, -103.13809075951576, -103.27434518933296, -94.58441950877508, -106.66716911395392, -93.24675053854784, -100.40044365326564, -110.6423133412997, -99.4971702049176, -8.076258823275566, -8.115784525871277, -8.431903272867203, -99.17361127336821, -110.53425403436026, -99.55137418707213, -96.54184883832932, -93.95424535870552, -93.79481992125511, -113.44079288840294, -102.69680190086365, -103.59741795063019, -114.41133455435435, -100.68200812737147, -102.24503026405971, -114.33778349558513, -101.19131405154864, -100.83595637480418, -11.042707026004791, -11.529819130897522, -11.866903439164162, -108.44908320903778, -102.4414754807949, -104.93519389629364, -90.66333341598511, -100.41067379713058, -87.65306790545583, -108.55861260493597, -97.15480505426726, -97.33783020575842, -104.16280513008437, -106.64965172608694, -103.29960291584334, -114.12573119004568, -100.90755571921667, -99.75376268227896, -7.805805856982872, -7.92398562530677, -8.10271715621154, -9.405828672150776, -9.35850925246875, -9.120664889613792, -7.270613600810378, -7.1967727591594155, -7.363949333628028, -95.513760574162, -107.98472040891647, -96.58066967129707, -99.04647818207741, -111.7743775844574, -99.55290070176125, -102.73252073923747, -114.6623328725497, -103.86393610636394, -11.073744595050812, -10.1606934517622, -9.947785586118698, -111.18763762712479, -99.17284692823887, -100.17691093683243, -108.21520117918651, -97.39672137300174, -95.22619791204731, -98.63608468075594, -111.11562039454779, -99.13681383927664, -101.41223382949829, -97.55234670639038, -114.1350359916687, -112.29055392742157, -99.11637696623802, -97.76132966578007, -101.3775725166003, -86.97764864812295, -86.97869057456653, -1.3433379729588921, -1.7957036246856148, -1.2414878283937867, -5.186096603671714, -4.893345932165786, -4.581027372429773, -100.10147762546937, -112.59492800633113, -101.94668487707774, -102.44728692869346, -102.13553466896217, -116.95665077368419, -93.82401539757848, -106.78930205106735, -93.83019530028105, -104.05556003252666, -115.05775252978007, -101.79710681239764, -113.94337632258734, -105.52988954385123, -102.79160984357199, -99.43473004798095, -113.55173901716869, -100.1923567155997, -109.9788319071134, -98.31410025556883, -98.96184345086417, -97.401507537812, -110.92726624011993, -100.29423928260803, -102.39490054051082, -114.4729538957278, -101.31738207737605, -99.23625370301306, -100.53845432400703, -113.58267110586166, -111.30446602900824, -99.59760715564093, -98.404555482169, -97.93808201452097, -109.6080167790254, -97.45734689881405, -91.72235311816137, -91.31363076965015, -109.45377675692241, 1.850383073091507, 1.8890002891421318, 1.693125158548355, -97.3522239701512, -99.53073246280353, -102.81737236181895, -110.53000152111053, -98.42654645442963, -97.74629130959511, -107.82339502374332, -96.20157864193122, -96.79365504781406, -97.82869896292686, -109.37946712970734, -97.56384289264679, -1.816358198722213, -1.7142095093925889, -1.319765993704408, -105.78756800293922, -106.35696752369404, -119.50388199090958, -107.14021998643875, -120.45183944702148, -105.89776936173439, -112.00992896159491, -101.30303083856901, -102.45941950877508, -108.6196619272232, -97.01825097203255, -96.36905744671822, -103.42928338050842, -103.78907892107964, -114.77935659885406, -93.3061195810636, -95.16237332423529, -104.71324278910956, -99.82528732468685, -99.81501163293919, -113.2506894071897, -105.27506996194522, -93.01115488881867, -94.72530592481296, -104.81973032156627, -117.01038638750713, -106.51542196671168, 3.6648323560754363, 3.7100292916099136, 3.7125672201315467, -104.61287092665832, -105.25950540105502, -116.30624953905742, -113.3136975367864, -101.43728967507681, -102.96253230174383, -103.94164583583674, -117.963374098142, -105.588457574447, -100.65302275617918, -100.56405466546616, -115.2628821929296, -6.546269126236439, -6.711630553007126, -6.417368121445179, -7.639161909619972, -8.047802338997528, -9.705535958210632, -90.27319451794028, -103.82278233766556, -90.344999730587, -86.5578398903211, -96.63336791594824, -84.96096134682497, 5.843488827347755, 6.135301098227501, 5.5638397783041, -91.13034802675247, -101.95754128694534, -91.07274788618088, -101.79815046985945, -102.62286402781805, -118.365762313207, 7.208431216577679, 7.120515520373971, 6.822078714768082, -94.0972206791242, -104.73161541422209, -92.96544507642588, -102.60645433266959, -100.71353615665188, -113.11747251947722, -100.33369566996893, -88.60346253712973, -88.05111672480902, -15.57756595313549, -15.74502032250166, -15.98070114850998, -94.88540104279916, -94.61029960463445, -109.39853678146999, -98.46091310183208, -98.79699463645618, -112.2870300213496, -105.4729508360227, -93.44100882609686, -93.29994877179465, -93.75860620786747, -105.7752417822679, -93.50557735686502, -112.31928946077824, -125.78021997213364, -113.17614072561264, 4.058636928598077, 4.0232004771629875, 4.014535824457795, -7.959226501484721, -8.318828736742347, -8.107587267955154, -110.91680893301964, -98.56059530377388, -98.62898151017725, -112.56494571020207, -114.35857929786047, -104.34943505128226, -106.08533946673076, -92.83799743155639, -92.50187935183446, -1.6588892017801697, -1.702925821145385, -1.6236582559843953, -104.10118479033312, -117.78413619597754, -107.50151362021765, -91.28639980405569, -103.30142217874527, -91.95521178841591, 4.73817057410875, 4.926497242103011, 3.9330869118372505, -195.36936585605145, -209.51750320196152, -196.82541784644127, -96.78315186003844, -109.26239953438441, -98.4879568318526]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16855485361483158, "mean_inference_ms": 0.7096654823974038, "mean_action_processing_ms": 0.0971781859120118, "mean_env_wait_ms": 0.7852753192723873, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 70000, "timesteps_this_iter": 0, "agent_timesteps_total": 210000, "timers": {"sample_time_ms": 10795.303, "sample_throughput": 463.164, "load_time_ms": 0.291, "load_throughput": 17189770.492, "learn_time_ms": 1948.338, "learn_throughput": 2566.29, "update_time_ms": 8.996}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1226.1372802734375, "policy_loss": -0.0026812362819770286, "vf_loss": 1226.1949462890625, "vf_explained_var": 0.0037053287029266357, "kl": 0.0036908008652990565, "entropy": 5.495265769958496, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 70000, "num_agent_steps_sampled": 210000, "num_steps_trained": 70000, "num_agent_steps_trained": 210000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 646, "training_iteration": 14, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-03-52", "timestamp": 1706231032, "time_this_iter_s": 10.676294565200806, "time_total_s": 151.01884198188782, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402530AF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 151.01884198188782, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 9.180000000000001, "ram_util_percent": 49.24666666666668}}
{"episode_reward_max": 21.151025451719732, "episode_reward_min": -601.7122869044542, "episode_reward_mean": -239.93956027089618, "episode_len_mean": 179.79, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {"shared_policy": -209.51750320196152}, "policy_reward_max": {"shared_policy": 7.208431216577679}, "policy_reward_mean": {"shared_policy": -79.97985342363206}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-314.7870495915413, -23.83250863850118, -27.885002814233317, -21.831335693597822, -300.07915065437555, -310.37375646829605, -321.2587897181511, -31.18222363293171, -310.5373954921961, -300.83812046423554, -308.8885189145804, -313.0996165275574, -309.16826055943966, -275.33391173928976, -4.380529426038294, -14.660469908267274, -314.64309050887823, -321.5394723713398, -294.4435127489269, -320.91041937470436, -322.2648757100106, -313.1788257807493, -307.25477561354637, -308.62301306053996, -318.18523651361465, -313.35737913288176, -309.30662866681814, -305.00344569236046, -292.4897606447339, 5.432508520781994, -299.70032879477367, -306.70283928513527, -300.8186287134886, -304.772008985281, -4.85033370181921, -331.64841751754284, -333.4898287951946, -315.772379308939, -302.00697034597397, -321.9977189004421, -293.1817356944084, -312.8909883648157, -293.01153077557683, -328.34553867578506, 11.087428867816897, -326.17862586677074, -317.713519513607, -327.49347750842577, -316.4799596145749, -19.675267800688744, -25.39250020682813, -284.44097658619285, -268.1521691530943, 17.542629703879356, -284.1606371998787, -322.7867768108845, 21.151025451719732, -291.7942811697722, -316.4374630087987, -276.9882749319077, -47.30328742414713, -298.8942374289036, -309.54493775963783, -292.2139084339142, -293.03942534700036, -351.2756501585245, 12.096373230218859, -24.385642506182222, -308.1063857469708, -331.27296005934477, -291.4252162501216, -4.98547327890995, -329.3868346065283, -286.54303377121687, 13.597754728049011, -601.7122869044542, -304.53350822627544, 1.8389700651168681, -59.83260685950519, -34.788292832672624, -318.7392967194319, -293.7293941415847, -297.15915589407086, -300.3730768635869, -315.0455252677203, -309.9958310574293, 2.4086036942899085, -326.30972933769226, -311.80145328491926, -326.59720965474844, -272.5640082452446, -43.81976440409201, -306.42463152110577, -321.42212331295013, -290.0621320307255, -259.9607279635966, -317.01055847108364, -340.7547956109047, -280.6332076787949, -21.244759004563093], "episode_lengths": [62, 500, 500, 500, 97, 56, 90, 500, 56, 53, 66, 68, 65, 87, 500, 500, 42, 49, 63, 42, 64, 71, 63, 64, 42, 67, 64, 88, 66, 500, 56, 64, 68, 97, 500, 110, 58, 88, 51, 45, 68, 120, 68, 61, 500, 127, 64, 129, 51, 500, 500, 66, 120, 500, 116, 52, 500, 109, 80, 102, 500, 103, 72, 73, 76, 105, 500, 500, 77, 83, 82, 500, 77, 100, 500, 107, 86, 500, 500, 500, 64, 108, 65, 117, 78, 53, 500, 50, 43, 47, 329, 500, 54, 71, 60, 114, 57, 73, 100, 500], "policy_shared_policy_reward": [-114.12573119004568, -100.90755571921667, -99.75376268227896, -7.805805856982872, -7.92398562530677, -8.10271715621154, -9.405828672150776, -9.35850925246875, -9.120664889613792, -7.270613600810378, -7.1967727591594155, -7.363949333628028, -95.513760574162, -107.98472040891647, -96.58066967129707, -99.04647818207741, -111.7743775844574, -99.55290070176125, -102.73252073923747, -114.6623328725497, -103.86393610636394, -11.073744595050812, -10.1606934517622, -9.947785586118698, -111.18763762712479, -99.17284692823887, -100.17691093683243, -108.21520117918651, -97.39672137300174, -95.22619791204731, -98.63608468075594, -111.11562039454779, -99.13681383927664, -101.41223382949829, -97.55234670639038, -114.1350359916687, -112.29055392742157, -99.11637696623802, -97.76132966578007, -101.3775725166003, -86.97764864812295, -86.97869057456653, -1.3433379729588921, -1.7957036246856148, -1.2414878283937867, -5.186096603671714, -4.893345932165786, -4.581027372429773, -100.10147762546937, -112.59492800633113, -101.94668487707774, -102.44728692869346, -102.13553466896217, -116.95665077368419, -93.82401539757848, -106.78930205106735, -93.83019530028105, -104.05556003252666, -115.05775252978007, -101.79710681239764, -113.94337632258734, -105.52988954385123, -102.79160984357199, -99.43473004798095, -113.55173901716869, -100.1923567155997, -109.9788319071134, -98.31410025556883, -98.96184345086417, -97.401507537812, -110.92726624011993, -100.29423928260803, -102.39490054051082, -114.4729538957278, -101.31738207737605, -99.23625370301306, -100.53845432400703, -113.58267110586166, -111.30446602900824, -99.59760715564093, -98.404555482169, -97.93808201452097, -109.6080167790254, -97.45734689881405, -91.72235311816137, -91.31363076965015, -109.45377675692241, 1.850383073091507, 1.8890002891421318, 1.693125158548355, -97.3522239701512, -99.53073246280353, -102.81737236181895, -110.53000152111053, -98.42654645442963, -97.74629130959511, -107.82339502374332, -96.20157864193122, -96.79365504781406, -97.82869896292686, -109.37946712970734, -97.56384289264679, -1.816358198722213, -1.7142095093925889, -1.319765993704408, -105.78756800293922, -106.35696752369404, -119.50388199090958, -107.14021998643875, -120.45183944702148, -105.89776936173439, -112.00992896159491, -101.30303083856901, -102.45941950877508, -108.6196619272232, -97.01825097203255, -96.36905744671822, -103.42928338050842, -103.78907892107964, -114.77935659885406, -93.3061195810636, -95.16237332423529, -104.71324278910956, -99.82528732468685, -99.81501163293919, -113.2506894071897, -105.27506996194522, -93.01115488881867, -94.72530592481296, -104.81973032156627, -117.01038638750713, -106.51542196671168, 3.6648323560754363, 3.7100292916099136, 3.7125672201315467, -104.61287092665832, -105.25950540105502, -116.30624953905742, -113.3136975367864, -101.43728967507681, -102.96253230174383, -103.94164583583674, -117.963374098142, -105.588457574447, -100.65302275617918, -100.56405466546616, -115.2628821929296, -6.546269126236439, -6.711630553007126, -6.417368121445179, -7.639161909619972, -8.047802338997528, -9.705535958210632, -90.27319451794028, -103.82278233766556, -90.344999730587, -86.5578398903211, -96.63336791594824, -84.96096134682497, 5.843488827347755, 6.135301098227501, 5.5638397783041, -91.13034802675247, -101.95754128694534, -91.07274788618088, -101.79815046985945, -102.62286402781805, -118.365762313207, 7.208431216577679, 7.120515520373971, 6.822078714768082, -94.0972206791242, -104.73161541422209, -92.96544507642588, -102.60645433266959, -100.71353615665188, -113.11747251947722, -100.33369566996893, -88.60346253712973, -88.05111672480902, -15.57756595313549, -15.74502032250166, -15.98070114850998, -94.88540104279916, -94.61029960463445, -109.39853678146999, -98.46091310183208, -98.79699463645618, -112.2870300213496, -105.4729508360227, -93.44100882609686, -93.29994877179465, -93.75860620786747, -105.7752417822679, -93.50557735686502, -112.31928946077824, -125.78021997213364, -113.17614072561264, 4.058636928598077, 4.0232004771629875, 4.014535824457795, -7.959226501484721, -8.318828736742347, -8.107587267955154, -110.91680893301964, -98.56059530377388, -98.62898151017725, -112.56494571020207, -114.35857929786047, -104.34943505128226, -106.08533946673076, -92.83799743155639, -92.50187935183446, -1.6588892017801697, -1.702925821145385, -1.6236582559843953, -104.10118479033312, -117.78413619597754, -107.50151362021765, -91.28639980405569, -103.30142217874527, -91.95521178841591, 4.73817057410875, 4.926497242103011, 3.9330869118372505, -195.36936585605145, -209.51750320196152, -196.82541784644127, -96.78315186003844, -109.26239953438441, -98.4879568318526, 0.406972279151276, 0.8814437290032657, 0.5505540569623264, -19.68838717291753, -19.727036500970527, -20.417183185617134, -11.579419535895198, -11.480827828248351, -11.728045468529075, -114.35734977324805, -101.60708216329417, -102.7748647828897, -93.92746946712336, -93.33623827372989, -106.46568640073141, -94.93311566859484, -94.72185007855296, -107.50419014692307, -95.0041678523024, -96.36651050051054, -109.00239851077399, -101.56903581817946, -99.78600734968981, -113.69048209985098, -112.3546825448672, -98.413241888086, -99.22790662447612, 0.776454900701836, 0.9426614654560836, 0.6894873281319889, -102.73924146095912, -106.34354803959529, -117.22693983713786, -100.04683343569438, -112.58130876223247, -99.17331108699243, -119.09834746519725, -105.44967178503673, -102.04919040451448, -92.22752044598262, -89.67293101983766, -90.66355677942435, -14.19912877290821, -14.989140932758659, -14.631494698425143, -111.35639135042827, -96.94932725528876, -98.11891291538875, -115.0632393360138, -103.33063036203384, -103.0282536149025, -93.02592883507411, -92.6268860201041, -104.40931717554729, -82.53782626613975, -94.55506286025047, -82.86783883720636, -100.32183003922304, -103.34626485904059, -113.34246357282004, -109.96127484242122, -121.25570563475291, -109.53781513373058, -93.48732872804007, -88.4253103931745, -98.72056855758032, -7.130142904818058, -7.133444629609585, -6.98117147013545]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16724301765304642, "mean_inference_ms": 0.7034781406764578, "mean_action_processing_ms": 0.09739681191527567, "mean_env_wait_ms": 0.7840449573778143, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 75000, "timesteps_this_iter": 0, "agent_timesteps_total": 225000, "timers": {"sample_time_ms": 10765.54, "sample_throughput": 464.445, "load_time_ms": 0.291, "load_throughput": 17189770.492, "learn_time_ms": 1938.745, "learn_throughput": 2578.988, "update_time_ms": 8.975}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0005000000000000001, "total_loss": 933.1202209472656, "policy_loss": -0.0022840197243386264, "vf_loss": 933.1773010253906, "vf_explained_var": 0.00519443154335022, "kl": 0.002599479770289945, "entropy": 5.47663688659668, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 75000, "num_agent_steps_sampled": 225000, "num_steps_trained": 75000, "num_agent_steps_trained": 225000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 669, "training_iteration": 15, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-04-03", "timestamp": 1706231043, "time_this_iter_s": 10.635623455047607, "time_total_s": 161.65446543693542, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140251FEE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 161.65446543693542, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 9.425, "ram_util_percent": 49.237500000000004}}
{"episode_reward_max": 21.151025451719732, "episode_reward_min": -611.3270464837551, "episode_reward_mean": -239.17160590769723, "episode_len_mean": 185.55, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {"shared_policy": -211.5817379554113}, "policy_reward_max": {"shared_policy": 7.208431216577679}, "policy_reward_mean": {"shared_policy": -79.7238686358991}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-309.30662866681814, -305.00344569236046, -292.4897606447339, 5.432508520781994, -299.70032879477367, -306.70283928513527, -300.8186287134886, -304.772008985281, -4.85033370181921, -331.64841751754284, -333.4898287951946, -315.772379308939, -302.00697034597397, -321.9977189004421, -293.1817356944084, -312.8909883648157, -293.01153077557683, -328.34553867578506, 11.087428867816897, -326.17862586677074, -317.713519513607, -327.49347750842577, -316.4799596145749, -19.675267800688744, -25.39250020682813, -284.44097658619285, -268.1521691530943, 17.542629703879356, -284.1606371998787, -322.7867768108845, 21.151025451719732, -291.7942811697722, -316.4374630087987, -276.9882749319077, -47.30328742414713, -298.8942374289036, -309.54493775963783, -292.2139084339142, -293.03942534700036, -351.2756501585245, 12.096373230218859, -24.385642506182222, -308.1063857469708, -331.27296005934477, -291.4252162501216, -4.98547327890995, -329.3868346065283, -286.54303377121687, 13.597754728049011, -601.7122869044542, -304.53350822627544, 1.8389700651168681, -59.83260685950519, -34.788292832672624, -318.7392967194319, -293.7293941415847, -297.15915589407086, -300.3730768635869, -315.0455252677203, -309.9958310574293, 2.4086036942899085, -326.30972933769226, -311.80145328491926, -326.59720965474844, -272.5640082452446, -43.81976440409201, -306.42463152110577, -321.42212331295013, -290.0621320307255, -259.9607279635966, -317.01055847108364, -340.7547956109047, -280.6332076787949, -21.244759004563093, -30.7430712133646, 8.97022058814764, -274.27970354259014, -309.22536502778536, -312.0420151054859, -317.4545649290085, -302.83284282684326, -25.687719739973545, -314.96199388615787, -304.1489272415638, -36.35328548029065, -301.2653276026249, -320.42019225656986, -317.0741864964366, -328.08184134960175, -296.1239808052778, -10.973320722579984, -312.8611773997545, -19.4649822935462, -278.48255414515734, -309.1352814435959, -307.93546847533435, -313.56343334913254, -611.3270464837551, -319.6300932019949, 19.356349691748605], "episode_lengths": [64, 88, 66, 500, 56, 64, 68, 97, 500, 110, 58, 88, 51, 45, 68, 120, 68, 61, 500, 127, 64, 129, 51, 500, 500, 66, 120, 500, 116, 52, 500, 109, 80, 102, 500, 103, 72, 73, 76, 105, 500, 500, 77, 83, 82, 500, 77, 100, 500, 107, 86, 500, 500, 500, 64, 108, 65, 117, 78, 53, 500, 50, 43, 47, 329, 500, 54, 71, 60, 114, 57, 73, 100, 500, 500, 500, 90, 78, 69, 49, 66, 500, 41, 101, 500, 65, 76, 54, 44, 110, 500, 72, 500, 88, 72, 64, 75, 69, 60, 500], "policy_shared_policy_reward": [-111.30446602900824, -99.59760715564093, -98.404555482169, -97.93808201452097, -109.6080167790254, -97.45734689881405, -91.72235311816137, -91.31363076965015, -109.45377675692241, 1.850383073091507, 1.8890002891421318, 1.693125158548355, -97.3522239701512, -99.53073246280353, -102.81737236181895, -110.53000152111053, -98.42654645442963, -97.74629130959511, -107.82339502374332, -96.20157864193122, -96.79365504781406, -97.82869896292686, -109.37946712970734, -97.56384289264679, -1.816358198722213, -1.7142095093925889, -1.319765993704408, -105.78756800293922, -106.35696752369404, -119.50388199090958, -107.14021998643875, -120.45183944702148, -105.89776936173439, -112.00992896159491, -101.30303083856901, -102.45941950877508, -108.6196619272232, -97.01825097203255, -96.36905744671822, -103.42928338050842, -103.78907892107964, -114.77935659885406, -93.3061195810636, -95.16237332423529, -104.71324278910956, -99.82528732468685, -99.81501163293919, -113.2506894071897, -105.27506996194522, -93.01115488881867, -94.72530592481296, -104.81973032156627, -117.01038638750713, -106.51542196671168, 3.6648323560754363, 3.7100292916099136, 3.7125672201315467, -104.61287092665832, -105.25950540105502, -116.30624953905742, -113.3136975367864, -101.43728967507681, -102.96253230174383, -103.94164583583674, -117.963374098142, -105.588457574447, -100.65302275617918, -100.56405466546616, -115.2628821929296, -6.546269126236439, -6.711630553007126, -6.417368121445179, -7.639161909619972, -8.047802338997528, -9.705535958210632, -90.27319451794028, -103.82278233766556, -90.344999730587, -86.5578398903211, -96.63336791594824, -84.96096134682497, 5.843488827347755, 6.135301098227501, 5.5638397783041, -91.13034802675247, -101.95754128694534, -91.07274788618088, -101.79815046985945, -102.62286402781805, -118.365762313207, 7.208431216577679, 7.120515520373971, 6.822078714768082, -94.0972206791242, -104.73161541422209, -92.96544507642588, -102.60645433266959, -100.71353615665188, -113.11747251947722, -100.33369566996893, -88.60346253712973, -88.05111672480902, -15.57756595313549, -15.74502032250166, -15.98070114850998, -94.88540104279916, -94.61029960463445, -109.39853678146999, -98.46091310183208, -98.79699463645618, -112.2870300213496, -105.4729508360227, -93.44100882609686, -93.29994877179465, -93.75860620786747, -105.7752417822679, -93.50557735686502, -112.31928946077824, -125.78021997213364, -113.17614072561264, 4.058636928598077, 4.0232004771629875, 4.014535824457795, -7.959226501484721, -8.318828736742347, -8.107587267955154, -110.91680893301964, -98.56059530377388, -98.62898151017725, -112.56494571020207, -114.35857929786047, -104.34943505128226, -106.08533946673076, -92.83799743155639, -92.50187935183446, -1.6588892017801697, -1.702925821145385, -1.6236582559843953, -104.10118479033312, -117.78413619597754, -107.50151362021765, -91.28639980405569, -103.30142217874527, -91.95521178841591, 4.73817057410875, 4.926497242103011, 3.9330869118372505, -195.36936585605145, -209.51750320196152, -196.82541784644127, -96.78315186003844, -109.26239953438441, -98.4879568318526, 0.406972279151276, 0.8814437290032657, 0.5505540569623264, -19.68838717291753, -19.727036500970527, -20.417183185617134, -11.579419535895198, -11.480827828248351, -11.728045468529075, -114.35734977324805, -101.60708216329417, -102.7748647828897, -93.92746946712336, -93.33623827372989, -106.46568640073141, -94.93311566859484, -94.72185007855296, -107.50419014692307, -95.0041678523024, -96.36651050051054, -109.00239851077399, -101.56903581817946, -99.78600734968981, -113.69048209985098, -112.3546825448672, -98.413241888086, -99.22790662447612, 0.776454900701836, 0.9426614654560836, 0.6894873281319889, -102.73924146095912, -106.34354803959529, -117.22693983713786, -100.04683343569438, -112.58130876223247, -99.17331108699243, -119.09834746519725, -105.44967178503673, -102.04919040451448, -92.22752044598262, -89.67293101983766, -90.66355677942435, -14.19912877290821, -14.989140932758659, -14.631494698425143, -111.35639135042827, -96.94932725528876, -98.11891291538875, -115.0632393360138, -103.33063036203384, -103.0282536149025, -93.02592883507411, -92.6268860201041, -104.40931717554729, -82.53782626613975, -94.55506286025047, -82.86783883720636, -100.32183003922304, -103.34626485904059, -113.34246357282004, -109.96127484242122, -121.25570563475291, -109.53781513373058, -93.48732872804007, -88.4253103931745, -98.72056855758032, -7.130142904818058, -7.133444629609585, -6.98117147013545, -10.377155467867851, -10.13846680521965, -10.2274489402771, 3.304683856666088, 2.4537806510925293, 3.211756080389023, -87.61467584967613, -86.90236480534077, -99.76266288757324, -97.77774434288344, -97.40418586631617, -114.04343481858572, -99.70909522970518, -111.76589371760687, -100.56702615817389, -113.14383925994238, -100.91003002723059, -103.40069564183554, -96.82578985393047, -108.49149253964424, -97.51556043326855, -8.324508421123028, -8.461102038621902, -8.902109280228615, -100.3939102422446, -113.90410023927689, -100.66398340463638, -108.95022195577621, -97.94721898436546, -97.25148630142212, -12.07535907626152, -11.98504151776433, -12.292884886264801, -108.15443062782288, -97.81925880908966, -95.29163816571236, -101.42597573498885, -102.7940712372462, -116.20014528433482, -113.9209448893865, -101.06053016831478, -102.09271143873534, -105.18146620194118, -104.75219057003657, -118.14818457762401, -94.07299136122069, -107.69794513781866, -94.3530443062385, -3.6796602507432397, -3.7080061336358483, -3.5856543382008965, -99.79347062607607, -111.86177929242453, -101.20592748125395, -6.564156174659729, -6.5689240247011185, -6.331902094185352, -101.99563652276993, -88.32000583410263, -88.16691178828478, -111.3518226146698, -98.57805222272873, -99.20540660619736, -111.95822894573212, -96.97059116791934, -99.00664836168289, -100.74366839726767, -111.48180188735327, -101.33796306451163, -199.83668621381128, -199.90862231453264, -211.5817379554113, -114.17661438385646, -103.22394127647082, -102.22953754166763, 6.265900974472359, 6.4078450401624, 6.682603677113846]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16656197907798748, "mean_inference_ms": 0.7030758625688202, "mean_action_processing_ms": 0.09754241074376913, "mean_env_wait_ms": 0.7853791616841241, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 80000, "timesteps_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"sample_time_ms": 10774.071, "sample_throughput": 464.077, "load_time_ms": 0.301, "load_throughput": 16624272.691, "learn_time_ms": 1932.823, "learn_throughput": 2586.889, "update_time_ms": 9.023}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0005000000000000001, "total_loss": 1242.3189575195313, "policy_loss": -0.002342826753764804, "vf_loss": 1242.3769287109376, "vf_explained_var": 0.007475996017456054, "kl": 0.0031835217145294, "entropy": 5.561108255386353, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 80000, "num_agent_steps_sampled": 240000, "num_steps_trained": 80000, "num_agent_steps_trained": 240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 695, "training_iteration": 16, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-04-14", "timestamp": 1706231054, "time_this_iter_s": 10.889778137207031, "time_total_s": 172.54424357414246, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402DF91F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 172.54424357414246, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 7.926666666666666, "ram_util_percent": 49.48666666666667}}
{"episode_reward_max": 30.289528444409342, "episode_reward_min": -611.3270464837551, "episode_reward_mean": -238.042286734723, "episode_len_mean": 186.33, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {"shared_policy": -211.5817379554113}, "policy_reward_max": {"shared_policy": 10.431677947441727}, "policy_reward_mean": {"shared_policy": -79.34742891157434}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-292.2139084339142, -293.03942534700036, -351.2756501585245, 12.096373230218859, -24.385642506182222, -308.1063857469708, -331.27296005934477, -291.4252162501216, -4.98547327890995, -329.3868346065283, -286.54303377121687, 13.597754728049011, -601.7122869044542, -304.53350822627544, 1.8389700651168681, -59.83260685950519, -34.788292832672624, -318.7392967194319, -293.7293941415847, -297.15915589407086, -300.3730768635869, -315.0455252677203, -309.9958310574293, 2.4086036942899085, -326.30972933769226, -311.80145328491926, -326.59720965474844, -272.5640082452446, -43.81976440409201, -306.42463152110577, -321.42212331295013, -290.0621320307255, -259.9607279635966, -317.01055847108364, -340.7547956109047, -280.6332076787949, -21.244759004563093, -30.7430712133646, 8.97022058814764, -274.27970354259014, -309.22536502778536, -312.0420151054859, -317.4545649290085, -302.83284282684326, -25.687719739973545, -314.96199388615787, -304.1489272415638, -36.35328548029065, -301.2653276026249, -320.42019225656986, -317.0741864964366, -328.08184134960175, -296.1239808052778, -10.973320722579984, -312.8611773997545, -19.4649822935462, -278.48255414515734, -309.1352814435959, -307.93546847533435, -313.56343334913254, -611.3270464837551, -319.6300932019949, 19.356349691748605, -14.527971470728545, -277.6853006742895, -316.09677287936216, -289.9656493663788, -312.24891782179475, -311.83668215572834, -315.5898600833025, -44.21669606864454, -341.019597614184, -72.01536520943033, -311.3938246667385, -323.40012913942337, -314.08850498497486, -308.8522280305624, -31.905642114579692, -307.29060186445713, -14.559820130467429, -21.05881920456889, -323.98534899950033, -312.51840034127235, -305.40242421627045, -322.6617216169834, -315.5889101102948, -293.2905526459217, -318.23379820585257, -316.31147499382496, -296.5877394080162, -298.3010531514883, -6.1974514424801015, 30.289528444409342, -311.2127273231745, -292.2070404291153, 23.939180897548795, -296.292507186532, -278.74683057516813, -335.2869738340378, -324.9313363879919], "episode_lengths": [73, 76, 105, 500, 500, 77, 83, 82, 500, 77, 100, 500, 107, 86, 500, 500, 500, 64, 108, 65, 117, 78, 53, 500, 50, 43, 47, 329, 500, 54, 71, 60, 114, 57, 73, 100, 500, 500, 500, 90, 78, 69, 49, 66, 500, 41, 101, 500, 65, 76, 54, 44, 110, 500, 72, 500, 88, 72, 64, 75, 69, 60, 500, 500, 87, 49, 72, 64, 76, 68, 500, 57, 500, 53, 50, 58, 66, 500, 65, 500, 500, 63, 63, 63, 54, 88, 80, 63, 70, 87, 82, 500, 500, 94, 59, 500, 71, 104, 69, 66], "policy_shared_policy_reward": [-105.4729508360227, -93.44100882609686, -93.29994877179465, -93.75860620786747, -105.7752417822679, -93.50557735686502, -112.31928946077824, -125.78021997213364, -113.17614072561264, 4.058636928598077, 4.0232004771629875, 4.014535824457795, -7.959226501484721, -8.318828736742347, -8.107587267955154, -110.91680893301964, -98.56059530377388, -98.62898151017725, -112.56494571020207, -114.35857929786047, -104.34943505128226, -106.08533946673076, -92.83799743155639, -92.50187935183446, -1.6588892017801697, -1.702925821145385, -1.6236582559843953, -104.10118479033312, -117.78413619597754, -107.50151362021765, -91.28639980405569, -103.30142217874527, -91.95521178841591, 4.73817057410875, 4.926497242103011, 3.9330869118372505, -195.36936585605145, -209.51750320196152, -196.82541784644127, -96.78315186003844, -109.26239953438441, -98.4879568318526, 0.406972279151276, 0.8814437290032657, 0.5505540569623264, -19.68838717291753, -19.727036500970527, -20.417183185617134, -11.579419535895198, -11.480827828248351, -11.728045468529075, -114.35734977324805, -101.60708216329417, -102.7748647828897, -93.92746946712336, -93.33623827372989, -106.46568640073141, -94.93311566859484, -94.72185007855296, -107.50419014692307, -95.0041678523024, -96.36651050051054, -109.00239851077399, -101.56903581817946, -99.78600734968981, -113.69048209985098, -112.3546825448672, -98.413241888086, -99.22790662447612, 0.776454900701836, 0.9426614654560836, 0.6894873281319889, -102.73924146095912, -106.34354803959529, -117.22693983713786, -100.04683343569438, -112.58130876223247, -99.17331108699243, -119.09834746519725, -105.44967178503673, -102.04919040451448, -92.22752044598262, -89.67293101983766, -90.66355677942435, -14.19912877290821, -14.989140932758659, -14.631494698425143, -111.35639135042827, -96.94932725528876, -98.11891291538875, -115.0632393360138, -103.33063036203384, -103.0282536149025, -93.02592883507411, -92.6268860201041, -104.40931717554729, -82.53782626613975, -94.55506286025047, -82.86783883720636, -100.32183003922304, -103.34626485904059, -113.34246357282004, -109.96127484242122, -121.25570563475291, -109.53781513373058, -93.48732872804007, -88.4253103931745, -98.72056855758032, -7.130142904818058, -7.133444629609585, -6.98117147013545, -10.377155467867851, -10.13846680521965, -10.2274489402771, 3.304683856666088, 2.4537806510925293, 3.211756080389023, -87.61467584967613, -86.90236480534077, -99.76266288757324, -97.77774434288344, -97.40418586631617, -114.04343481858572, -99.70909522970518, -111.76589371760687, -100.56702615817389, -113.14383925994238, -100.91003002723059, -103.40069564183554, -96.82578985393047, -108.49149253964424, -97.51556043326855, -8.324508421123028, -8.461102038621902, -8.902109280228615, -100.3939102422446, -113.90410023927689, -100.66398340463638, -108.95022195577621, -97.94721898436546, -97.25148630142212, -12.07535907626152, -11.98504151776433, -12.292884886264801, -108.15443062782288, -97.81925880908966, -95.29163816571236, -101.42597573498885, -102.7940712372462, -116.20014528433482, -113.9209448893865, -101.06053016831478, -102.09271143873534, -105.18146620194118, -104.75219057003657, -118.14818457762401, -94.07299136122069, -107.69794513781866, -94.3530443062385, -3.6796602507432397, -3.7080061336358483, -3.5856543382008965, -99.79347062607607, -111.86177929242453, -101.20592748125395, -6.564156174659729, -6.5689240247011185, -6.331902094185352, -101.99563652276993, -88.32000583410263, -88.16691178828478, -111.3518226146698, -98.57805222272873, -99.20540660619736, -111.95822894573212, -96.97059116791934, -99.00664836168289, -100.74366839726767, -111.48180188735327, -101.33796306451163, -199.83668621381128, -199.90862231453264, -211.5817379554113, -114.17661438385646, -103.22394127647082, -102.22953754166763, 6.265900974472359, 6.4078450401624, 6.682603677113846, -4.518498904382199, -4.99764480193457, -5.011827764411777, -88.22045104702315, -101.21937306722006, -88.24547656004628, -100.60348774989447, -113.92597552140555, -101.56730960806212, -92.22978059450786, -104.14807025591533, -93.58779851595561, -113.05764478445053, -98.96072230115533, -100.23055073618889, -98.74205146233241, -97.4939410040776, -115.60068968931834, -113.79440440734228, -100.73068665627702, -101.06476901968321, -13.993787954250976, -15.893849770228073, -14.329058344165489, -107.91210218705237, -121.85789203643799, -111.24960339069366, -23.883893289913736, -24.134788927932583, -23.996682991584144, -111.90106342236201, -99.8120295504729, -99.68073169390361, -102.97030659516653, -102.92637886603674, -117.50344367822012, -115.53212980429332, -99.4105579952399, -99.14581718544166, -99.19337194164595, -97.88642201324305, -111.77243407567343, -10.531284535924598, -10.60738465438287, -10.766972924272224, -97.9756601601839, -110.94209921360016, -98.37284249067307, -4.832298936943218, -4.909730958441898, -4.817790235082313, -6.821808834870666, -7.105494533975929, -7.131515835722297, -103.80567463239035, -103.59177114566168, -116.58790322144827, -110.57961506644885, -100.96086261669795, -100.97792265812556, -110.29529428482056, -98.13405430316925, -96.97307562828064, -103.34529059131941, -103.48749788602194, -115.82893313964209, -101.33389470974605, -100.06252067039411, -114.19249473015468, -105.86013575394949, -93.78321600457033, -93.64720088740191, -103.54418279727301, -101.3796276052793, -113.30998780330023, -113.83583641052246, -100.39263470470905, -102.08300387859344, -106.92985091606776, -94.74877868096034, -94.90910981098811, -97.03672196467718, -106.44712220629057, -94.81720898052058, -2.180700394014522, -2.1098210091392247, -1.9069300393263546, 9.947723696629197, 10.431677947441727, 9.910126800338418, -115.05236033598582, -98.3122501919667, -97.84811679522197, -99.08791987101237, -94.79330448309581, -98.32581607500713, 7.866713389754295, 7.780849806964397, 8.291617700830102, -106.6164533495903, -94.77288891375065, -94.90316492319107, -89.37141724427542, -100.48934452732405, -88.88606880356869, -120.52721613645554, -107.5824804008007, -107.17727729678154, -102.67584767440955, -104.22205273310344, -118.03343598047893]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16540639417407152, "mean_inference_ms": 0.703327748072686, "mean_action_processing_ms": 0.0971213196633499, "mean_env_wait_ms": 0.7883483707699105, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 85000, "timesteps_this_iter": 0, "agent_timesteps_total": 255000, "timers": {"sample_time_ms": 10775.882, "sample_throughput": 463.999, "load_time_ms": 0.301, "load_throughput": 16624272.691, "learn_time_ms": 1932.665, "learn_throughput": 2587.101, "update_time_ms": 9.03}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0005000000000000001, "total_loss": 1456.1013916015625, "policy_loss": -0.0024126274936863367, "vf_loss": 1456.1609985351563, "vf_explained_var": 0.01971089243888855, "kl": 0.003501917963151495, "entropy": 5.721872282028198, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 85000, "num_agent_steps_sampled": 255000, "num_steps_trained": 85000, "num_agent_steps_trained": 255000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 732, "training_iteration": 17, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-04-24", "timestamp": 1706231064, "time_this_iter_s": 10.733620643615723, "time_total_s": 183.27786421775818, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021400813D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 183.27786421775818, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 9.740000000000002, "ram_util_percent": 49.239999999999995}}
{"episode_reward_max": 30.289528444409342, "episode_reward_min": -611.3270464837551, "episode_reward_mean": -243.08662191328824, "episode_len_mean": 175.92, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {"shared_policy": -211.5817379554113}, "policy_reward_max": {"shared_policy": 10.431677947441727}, "policy_reward_mean": {"shared_policy": -81.02887397109609}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-272.5640082452446, -43.81976440409201, -306.42463152110577, -321.42212331295013, -290.0621320307255, -259.9607279635966, -317.01055847108364, -340.7547956109047, -280.6332076787949, -21.244759004563093, -30.7430712133646, 8.97022058814764, -274.27970354259014, -309.22536502778536, -312.0420151054859, -317.4545649290085, -302.83284282684326, -25.687719739973545, -314.96199388615787, -304.1489272415638, -36.35328548029065, -301.2653276026249, -320.42019225656986, -317.0741864964366, -328.08184134960175, -296.1239808052778, -10.973320722579984, -312.8611773997545, -19.4649822935462, -278.48255414515734, -309.1352814435959, -307.93546847533435, -313.56343334913254, -611.3270464837551, -319.6300932019949, 19.356349691748605, -14.527971470728545, -277.6853006742895, -316.09677287936216, -289.9656493663788, -312.24891782179475, -311.83668215572834, -315.5898600833025, -44.21669606864454, -341.019597614184, -72.01536520943033, -311.3938246667385, -323.40012913942337, -314.08850498497486, -308.8522280305624, -31.905642114579692, -307.29060186445713, -14.559820130467429, -21.05881920456889, -323.98534899950033, -312.51840034127235, -305.40242421627045, -322.6617216169834, -315.5889101102948, -293.2905526459217, -318.23379820585257, -316.31147499382496, -296.5877394080162, -298.3010531514883, -6.1974514424801015, 30.289528444409342, -311.2127273231745, -292.2070404291153, 23.939180897548795, -296.292507186532, -278.74683057516813, -335.2869738340378, -324.9313363879919, 2.2328191250562526, -17.07864512503147, -312.2380936741829, -321.2850838005543, -321.697790697217, -316.27661214768887, -303.4052703678608, -311.0364842414856, -311.85686630010605, -41.79738226532939, -298.6688363701105, -314.1280459612608, -332.995301425457, -310.80103151500225, -295.9762337356806, 25.5096766874194, -329.15306478738785, -329.30334091186523, -45.27952754497528, -318.90682174265385, -28.550319314003005, -315.2842434942723, -320.58294428884983, -345.77975042164326, -335.27734738588333, -315.00038039684296, -323.1267912387848], "episode_lengths": [329, 500, 54, 71, 60, 114, 57, 73, 100, 500, 500, 500, 90, 78, 69, 49, 66, 500, 41, 101, 500, 65, 76, 54, 44, 110, 500, 72, 500, 88, 72, 64, 75, 69, 60, 500, 500, 87, 49, 72, 64, 76, 68, 500, 57, 500, 53, 50, 58, 66, 500, 65, 500, 500, 63, 63, 63, 54, 88, 80, 63, 70, 87, 82, 500, 500, 94, 59, 500, 71, 104, 69, 66, 500, 500, 47, 58, 62, 61, 82, 60, 61, 500, 71, 63, 85, 90, 68, 500, 59, 60, 500, 61, 500, 64, 94, 97, 65, 59, 83], "policy_shared_policy_reward": [-92.22752044598262, -89.67293101983766, -90.66355677942435, -14.19912877290821, -14.989140932758659, -14.631494698425143, -111.35639135042827, -96.94932725528876, -98.11891291538875, -115.0632393360138, -103.33063036203384, -103.0282536149025, -93.02592883507411, -92.6268860201041, -104.40931717554729, -82.53782626613975, -94.55506286025047, -82.86783883720636, -100.32183003922304, -103.34626485904059, -113.34246357282004, -109.96127484242122, -121.25570563475291, -109.53781513373058, -93.48732872804007, -88.4253103931745, -98.72056855758032, -7.130142904818058, -7.133444629609585, -6.98117147013545, -10.377155467867851, -10.13846680521965, -10.2274489402771, 3.304683856666088, 2.4537806510925293, 3.211756080389023, -87.61467584967613, -86.90236480534077, -99.76266288757324, -97.77774434288344, -97.40418586631617, -114.04343481858572, -99.70909522970518, -111.76589371760687, -100.56702615817389, -113.14383925994238, -100.91003002723059, -103.40069564183554, -96.82578985393047, -108.49149253964424, -97.51556043326855, -8.324508421123028, -8.461102038621902, -8.902109280228615, -100.3939102422446, -113.90410023927689, -100.66398340463638, -108.95022195577621, -97.94721898436546, -97.25148630142212, -12.07535907626152, -11.98504151776433, -12.292884886264801, -108.15443062782288, -97.81925880908966, -95.29163816571236, -101.42597573498885, -102.7940712372462, -116.20014528433482, -113.9209448893865, -101.06053016831478, -102.09271143873534, -105.18146620194118, -104.75219057003657, -118.14818457762401, -94.07299136122069, -107.69794513781866, -94.3530443062385, -3.6796602507432397, -3.7080061336358483, -3.5856543382008965, -99.79347062607607, -111.86177929242453, -101.20592748125395, -6.564156174659729, -6.5689240247011185, -6.331902094185352, -101.99563652276993, -88.32000583410263, -88.16691178828478, -111.3518226146698, -98.57805222272873, -99.20540660619736, -111.95822894573212, -96.97059116791934, -99.00664836168289, -100.74366839726767, -111.48180188735327, -101.33796306451163, -199.83668621381128, -199.90862231453264, -211.5817379554113, -114.17661438385646, -103.22394127647082, -102.22953754166763, 6.265900974472359, 6.4078450401624, 6.682603677113846, -4.518498904382199, -4.99764480193457, -5.011827764411777, -88.22045104702315, -101.21937306722006, -88.24547656004628, -100.60348774989447, -113.92597552140555, -101.56730960806212, -92.22978059450786, -104.14807025591533, -93.58779851595561, -113.05764478445053, -98.96072230115533, -100.23055073618889, -98.74205146233241, -97.4939410040776, -115.60068968931834, -113.79440440734228, -100.73068665627702, -101.06476901968321, -13.993787954250976, -15.893849770228073, -14.329058344165489, -107.91210218705237, -121.85789203643799, -111.24960339069366, -23.883893289913736, -24.134788927932583, -23.996682991584144, -111.90106342236201, -99.8120295504729, -99.68073169390361, -102.97030659516653, -102.92637886603674, -117.50344367822012, -115.53212980429332, -99.4105579952399, -99.14581718544166, -99.19337194164595, -97.88642201324305, -111.77243407567343, -10.531284535924598, -10.60738465438287, -10.766972924272224, -97.9756601601839, -110.94209921360016, -98.37284249067307, -4.832298936943218, -4.909730958441898, -4.817790235082313, -6.821808834870666, -7.105494533975929, -7.131515835722297, -103.80567463239035, -103.59177114566168, -116.58790322144827, -110.57961506644885, -100.96086261669795, -100.97792265812556, -110.29529428482056, -98.13405430316925, -96.97307562828064, -103.34529059131941, -103.48749788602194, -115.82893313964209, -101.33389470974605, -100.06252067039411, -114.19249473015468, -105.86013575394949, -93.78321600457033, -93.64720088740191, -103.54418279727301, -101.3796276052793, -113.30998780330023, -113.83583641052246, -100.39263470470905, -102.08300387859344, -106.92985091606776, -94.74877868096034, -94.90910981098811, -97.03672196467718, -106.44712220629057, -94.81720898052058, -2.180700394014522, -2.1098210091392247, -1.9069300393263546, 9.947723696629197, 10.431677947441727, 9.910126800338418, -115.05236033598582, -98.3122501919667, -97.84811679522197, -99.08791987101237, -94.79330448309581, -98.32581607500713, 7.866713389754295, 7.780849806964397, 8.291617700830102, -106.6164533495903, -94.77288891375065, -94.90316492319107, -89.37141724427542, -100.48934452732405, -88.88606880356869, -120.52721613645554, -107.5824804008007, -107.17727729678154, -102.67584767440955, -104.22205273310344, -118.03343598047893, 0.8349791293342861, 0.8211576317747387, 0.5766823639472278, -6.117206007242203, -5.339234933257103, -5.6222041845321655, -100.72137779990832, -98.65737355748813, -112.85934231678645, -102.68918372193973, -114.85251984993617, -103.74338022867839, -102.95057450731596, -116.22526129086813, -102.52195489903292, -100.839180752635, -114.3218280673027, -101.11560332775116, -97.34072489539783, -109.22882376114528, -96.8357217113177, -100.23884281516075, -112.42580860853195, -98.37183281779289, -111.36198554436366, -99.8078224460284, -100.687058309714, -13.058967438836902, -13.137376231451839, -15.601038595040649, -107.31913127501807, -95.70505835612616, -95.64464673896632, -99.67025163273017, -111.54306511084239, -102.91472921768825, -105.95308917760849, -119.01744294166565, -108.02476930618286, -100.41788871089618, -99.42977088193099, -110.9533719221751, -107.50172124306361, -94.40558035920064, -94.06893213341634, 8.648678181072071, 8.584195976456002, 8.276802529891327, -105.17302602529526, -105.48177242279053, -118.49826633930206, -106.33181085189185, -117.63669659694037, -105.33483346303305, -15.211276665329933, -15.05934762954712, -15.008903250098228, -103.04260096947353, -100.97358554104964, -114.89063523213069, -9.514440911511585, -9.399975332121059, -9.635903070370361, -100.48855303724608, -114.02631505330405, -100.76937540372214, -103.20242389539878, -113.74747193853061, -103.63304845492046, -110.81668332219124, -124.27778571844101, -110.68528138101101, -107.37666879097621, -120.06679658095042, -107.83388201395671, -113.10404274861018, -101.48336384693782, -100.41297380129497, -102.33532025416693, -103.9711244304975, -116.82034655412039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16488325050176048, "mean_inference_ms": 0.7060784793860649, "mean_action_processing_ms": 0.0969862429491355, "mean_env_wait_ms": 0.7910416670557316, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 90000, "timesteps_this_iter": 0, "agent_timesteps_total": 270000, "timers": {"sample_time_ms": 10875.94, "sample_throughput": 459.73, "load_time_ms": 0.401, "load_throughput": 12474879.543, "learn_time_ms": 1927.171, "learn_throughput": 2594.476, "update_time_ms": 8.95}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0005000000000000001, "total_loss": 1113.8470825195313, "policy_loss": -0.002821443752230435, "vf_loss": 1113.9050659179688, "vf_explained_var": 0.05468847751617432, "kl": 0.0037649019126571328, "entropy": 5.522106456756592, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 90000, "num_agent_steps_sampled": 270000, "num_steps_trained": 90000, "num_agent_steps_trained": 270000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 759, "training_iteration": 18, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-04-36", "timestamp": 1706231076, "time_this_iter_s": 11.780466318130493, "time_total_s": 195.05833053588867, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021400813EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 195.05833053588867, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 7.305882352941176, "ram_util_percent": 49.46470588235294}}
{"episode_reward_max": 30.289528444409342, "episode_reward_min": -611.3270464837551, "episode_reward_mean": -240.9000788192381, "episode_len_mean": 178.06, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {"shared_policy": -211.5817379554113}, "policy_reward_max": {"shared_policy": 10.431677947441727}, "policy_reward_mean": {"shared_policy": -80.30002627307937}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-314.96199388615787, -304.1489272415638, -36.35328548029065, -301.2653276026249, -320.42019225656986, -317.0741864964366, -328.08184134960175, -296.1239808052778, -10.973320722579984, -312.8611773997545, -19.4649822935462, -278.48255414515734, -309.1352814435959, -307.93546847533435, -313.56343334913254, -611.3270464837551, -319.6300932019949, 19.356349691748605, -14.527971470728545, -277.6853006742895, -316.09677287936216, -289.9656493663788, -312.24891782179475, -311.83668215572834, -315.5898600833025, -44.21669606864454, -341.019597614184, -72.01536520943033, -311.3938246667385, -323.40012913942337, -314.08850498497486, -308.8522280305624, -31.905642114579692, -307.29060186445713, -14.559820130467429, -21.05881920456889, -323.98534899950033, -312.51840034127235, -305.40242421627045, -322.6617216169834, -315.5889101102948, -293.2905526459217, -318.23379820585257, -316.31147499382496, -296.5877394080162, -298.3010531514883, -6.1974514424801015, 30.289528444409342, -311.2127273231745, -292.2070404291153, 23.939180897548795, -296.292507186532, -278.74683057516813, -335.2869738340378, -324.9313363879919, 2.2328191250562526, -17.07864512503147, -312.2380936741829, -321.2850838005543, -321.697790697217, -316.27661214768887, -303.4052703678608, -311.0364842414856, -311.85686630010605, -41.79738226532939, -298.6688363701105, -314.1280459612608, -332.995301425457, -310.80103151500225, -295.9762337356806, 25.5096766874194, -329.15306478738785, -329.30334091186523, -45.27952754497528, -318.90682174265385, -28.550319314003005, -315.2842434942723, -320.58294428884983, -345.77975042164326, -335.27734738588333, -315.00038039684296, -323.1267912387848, -336.2711336016655, -264.3432967066765, -54.38171790167691, -286.75598664581776, -344.3433079048991, -1.2403016760945604, -26.74709392711523, -305.6090034097433, -315.49003157019615, -319.0889637717046, -320.83708825707436, -319.1043280363083, 0.5509949959814264, -270.7887390255928, 20.744269147515297, -310.3926144316793, -340.31506514549255, -4.124052766710548], "episode_lengths": [41, 101, 500, 65, 76, 54, 44, 110, 500, 72, 500, 88, 72, 64, 75, 69, 60, 500, 500, 87, 49, 72, 64, 76, 68, 500, 57, 500, 53, 50, 58, 66, 500, 65, 500, 500, 63, 63, 63, 54, 88, 80, 63, 70, 87, 82, 500, 500, 94, 59, 500, 71, 104, 69, 66, 500, 500, 47, 58, 62, 61, 82, 60, 61, 500, 71, 63, 85, 90, 68, 500, 59, 60, 500, 61, 500, 64, 94, 97, 65, 59, 83, 86, 104, 500, 83, 156, 500, 500, 81, 83, 53, 49, 49, 500, 80, 500, 40, 60, 500], "policy_shared_policy_reward": [-100.3939102422446, -113.90410023927689, -100.66398340463638, -108.95022195577621, -97.94721898436546, -97.25148630142212, -12.07535907626152, -11.98504151776433, -12.292884886264801, -108.15443062782288, -97.81925880908966, -95.29163816571236, -101.42597573498885, -102.7940712372462, -116.20014528433482, -113.9209448893865, -101.06053016831478, -102.09271143873534, -105.18146620194118, -104.75219057003657, -118.14818457762401, -94.07299136122069, -107.69794513781866, -94.3530443062385, -3.6796602507432397, -3.7080061336358483, -3.5856543382008965, -99.79347062607607, -111.86177929242453, -101.20592748125395, -6.564156174659729, -6.5689240247011185, -6.331902094185352, -101.99563652276993, -88.32000583410263, -88.16691178828478, -111.3518226146698, -98.57805222272873, -99.20540660619736, -111.95822894573212, -96.97059116791934, -99.00664836168289, -100.74366839726767, -111.48180188735327, -101.33796306451163, -199.83668621381128, -199.90862231453264, -211.5817379554113, -114.17661438385646, -103.22394127647082, -102.22953754166763, 6.265900974472359, 6.4078450401624, 6.682603677113846, -4.518498904382199, -4.99764480193457, -5.011827764411777, -88.22045104702315, -101.21937306722006, -88.24547656004628, -100.60348774989447, -113.92597552140555, -101.56730960806212, -92.22978059450786, -104.14807025591533, -93.58779851595561, -113.05764478445053, -98.96072230115533, -100.23055073618889, -98.74205146233241, -97.4939410040776, -115.60068968931834, -113.79440440734228, -100.73068665627702, -101.06476901968321, -13.993787954250976, -15.893849770228073, -14.329058344165489, -107.91210218705237, -121.85789203643799, -111.24960339069366, -23.883893289913736, -24.134788927932583, -23.996682991584144, -111.90106342236201, -99.8120295504729, -99.68073169390361, -102.97030659516653, -102.92637886603674, -117.50344367822012, -115.53212980429332, -99.4105579952399, -99.14581718544166, -99.19337194164595, -97.88642201324305, -111.77243407567343, -10.531284535924598, -10.60738465438287, -10.766972924272224, -97.9756601601839, -110.94209921360016, -98.37284249067307, -4.832298936943218, -4.909730958441898, -4.817790235082313, -6.821808834870666, -7.105494533975929, -7.131515835722297, -103.80567463239035, -103.59177114566168, -116.58790322144827, -110.57961506644885, -100.96086261669795, -100.97792265812556, -110.29529428482056, -98.13405430316925, -96.97307562828064, -103.34529059131941, -103.48749788602194, -115.82893313964209, -101.33389470974605, -100.06252067039411, -114.19249473015468, -105.86013575394949, -93.78321600457033, -93.64720088740191, -103.54418279727301, -101.3796276052793, -113.30998780330023, -113.83583641052246, -100.39263470470905, -102.08300387859344, -106.92985091606776, -94.74877868096034, -94.90910981098811, -97.03672196467718, -106.44712220629057, -94.81720898052058, -2.180700394014522, -2.1098210091392247, -1.9069300393263546, 9.947723696629197, 10.431677947441727, 9.910126800338418, -115.05236033598582, -98.3122501919667, -97.84811679522197, -99.08791987101237, -94.79330448309581, -98.32581607500713, 7.866713389754295, 7.780849806964397, 8.291617700830102, -106.6164533495903, -94.77288891375065, -94.90316492319107, -89.37141724427542, -100.48934452732405, -88.88606880356869, -120.52721613645554, -107.5824804008007, -107.17727729678154, -102.67584767440955, -104.22205273310344, -118.03343598047893, 0.8349791293342861, 0.8211576317747387, 0.5766823639472278, -6.117206007242203, -5.339234933257103, -5.6222041845321655, -100.72137779990832, -98.65737355748813, -112.85934231678645, -102.68918372193973, -114.85251984993617, -103.74338022867839, -102.95057450731596, -116.22526129086813, -102.52195489903292, -100.839180752635, -114.3218280673027, -101.11560332775116, -97.34072489539783, -109.22882376114528, -96.8357217113177, -100.23884281516075, -112.42580860853195, -98.37183281779289, -111.36198554436366, -99.8078224460284, -100.687058309714, -13.058967438836902, -13.137376231451839, -15.601038595040649, -107.31913127501807, -95.70505835612616, -95.64464673896632, -99.67025163273017, -111.54306511084239, -102.91472921768825, -105.95308917760849, -119.01744294166565, -108.02476930618286, -100.41788871089618, -99.42977088193099, -110.9533719221751, -107.50172124306361, -94.40558035920064, -94.06893213341634, 8.648678181072071, 8.584195976456002, 8.276802529891327, -105.17302602529526, -105.48177242279053, -118.49826633930206, -106.33181085189185, -117.63669659694037, -105.33483346303305, -15.211276665329933, -15.05934762954712, -15.008903250098228, -103.04260096947353, -100.97358554104964, -114.89063523213069, -9.514440911511585, -9.399975332121059, -9.635903070370361, -100.48855303724608, -114.02631505330405, -100.76937540372214, -103.20242389539878, -113.74747193853061, -103.63304845492046, -110.81668332219124, -124.27778571844101, -110.68528138101101, -107.37666879097621, -120.06679658095042, -107.83388201395671, -113.10404274861018, -101.48336384693782, -100.41297380129497, -102.33532025416693, -103.9711244304975, -116.82034655412039, -107.37932550162077, -121.40866523981094, -107.48314286023378, -90.5440046787262, -89.99052369594574, -83.80876833200455, -17.94118757421772, -18.3281096170346, -18.112420710424587, -90.94456940392654, -103.87905828158061, -91.93235896031062, -123.60015547275543, -111.22744536399841, -109.51570706814528, -0.43567778666815116, -0.23394083728393866, -0.5706830521424706, -8.83411326756081, -8.725815036644548, -9.187165622909873, -109.84314288695654, -97.09451440473399, -98.67134611805281, -103.08054413398108, -102.90910910566649, -109.50037833054861, -101.33019556089616, -102.47016273935637, -115.28860547145209, -115.89249249299368, -102.8927933027347, -102.051802461346, -117.10690593719482, -100.73208226263523, -101.26533983647823, 0.3244488040606086, -0.2658335020144875, 0.49237969393530534, -87.15683653950691, -98.40037971735, -85.23152276873589, 6.835887789726257, 6.767513066530228, 7.140868291258812, -98.85748643924794, -111.94791146119437, -99.58721653123698, -107.37744238972664, -108.2553308904171, -124.68229186534882, -1.2571875502665932, -1.0646902707715924, -1.8021749456723626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16483459937568934, "mean_inference_ms": 0.7060768258167106, "mean_action_processing_ms": 0.09678244432248526, "mean_env_wait_ms": 0.7920895722053669, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 95000, "timesteps_this_iter": 0, "agent_timesteps_total": 285000, "timers": {"sample_time_ms": 10863.458, "sample_throughput": 460.259, "load_time_ms": 0.301, "load_throughput": 16612420.786, "learn_time_ms": 1923.957, "learn_throughput": 2598.811, "update_time_ms": 8.805}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0005000000000000001, "total_loss": 575.73173828125, "policy_loss": -0.0022509999344032306, "vf_loss": 575.7883117675781, "vf_explained_var": 0.18389576077461242, "kl": 0.0025997321266937774, "entropy": 5.432214832305908, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 95000, "num_agent_steps_sampled": 285000, "num_steps_trained": 95000, "num_agent_steps_trained": 285000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 777, "training_iteration": 19, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-04-47", "timestamp": 1706231087, "time_this_iter_s": 10.652779579162598, "time_total_s": 205.71111011505127, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D29CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 205.71111011505127, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 5.773333333333334, "ram_util_percent": 49.553333333333335}}
{"episode_reward_max": 30.289528444409342, "episode_reward_min": -349.42354308255017, "episode_reward_mean": -228.0917062534648, "episode_len_mean": 195.76, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": -124.68229186534882}, "policy_reward_max": {"shared_policy": 10.431677947441727}, "policy_reward_mean": {"shared_policy": -76.03056875115493}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-316.09677287936216, -289.9656493663788, -312.24891782179475, -311.83668215572834, -315.5898600833025, -44.21669606864454, -341.019597614184, -72.01536520943033, -311.3938246667385, -323.40012913942337, -314.08850498497486, -308.8522280305624, -31.905642114579692, -307.29060186445713, -14.559820130467429, -21.05881920456889, -323.98534899950033, -312.51840034127235, -305.40242421627045, -322.6617216169834, -315.5889101102948, -293.2905526459217, -318.23379820585257, -316.31147499382496, -296.5877394080162, -298.3010531514883, -6.1974514424801015, 30.289528444409342, -311.2127273231745, -292.2070404291153, 23.939180897548795, -296.292507186532, -278.74683057516813, -335.2869738340378, -324.9313363879919, 2.2328191250562526, -17.07864512503147, -312.2380936741829, -321.2850838005543, -321.697790697217, -316.27661214768887, -303.4052703678608, -311.0364842414856, -311.85686630010605, -41.79738226532939, -298.6688363701105, -314.1280459612608, -332.995301425457, -310.80103151500225, -295.9762337356806, 25.5096766874194, -329.15306478738785, -329.30334091186523, -45.27952754497528, -318.90682174265385, -28.550319314003005, -315.2842434942723, -320.58294428884983, -345.77975042164326, -335.27734738588333, -315.00038039684296, -323.1267912387848, -336.2711336016655, -264.3432967066765, -54.38171790167691, -286.75598664581776, -344.3433079048991, -1.2403016760945604, -26.74709392711523, -305.6090034097433, -315.49003157019615, -319.0889637717046, -320.83708825707436, -319.1043280363083, 0.5509949959814264, -270.7887390255928, 20.744269147515297, -310.3926144316793, -340.31506514549255, -4.124052766710548, -5.081229574978352, -305.7191716432572, -284.9144511371851, -314.61571088433266, -4.869444634765401, -305.82805770635605, -307.98859109636396, 3.0487839132547094, -292.57574012875557, -349.42354308255017, -58.893751084804556, -285.98758667334914, -288.8218752495013, -1.9404653236270093, -27.89389209449294, -271.91649144887924, -305.35192799568176, -293.50472351908684, 11.565960541367517, -3.1108496859669685], "episode_lengths": [49, 72, 64, 76, 68, 500, 57, 500, 53, 50, 58, 66, 500, 65, 500, 500, 63, 63, 63, 54, 88, 80, 63, 70, 87, 82, 500, 500, 94, 59, 500, 71, 104, 69, 66, 500, 500, 47, 58, 62, 61, 82, 60, 61, 500, 71, 63, 85, 90, 68, 500, 59, 60, 500, 61, 500, 64, 94, 97, 65, 59, 83, 86, 104, 500, 83, 156, 500, 500, 81, 83, 53, 49, 49, 500, 80, 500, 40, 60, 500, 500, 72, 84, 63, 500, 60, 61, 500, 78, 475, 500, 64, 96, 500, 500, 109, 109, 77, 500, 500], "policy_shared_policy_reward": [-100.60348774989447, -113.92597552140555, -101.56730960806212, -92.22978059450786, -104.14807025591533, -93.58779851595561, -113.05764478445053, -98.96072230115533, -100.23055073618889, -98.74205146233241, -97.4939410040776, -115.60068968931834, -113.79440440734228, -100.73068665627702, -101.06476901968321, -13.993787954250976, -15.893849770228073, -14.329058344165489, -107.91210218705237, -121.85789203643799, -111.24960339069366, -23.883893289913736, -24.134788927932583, -23.996682991584144, -111.90106342236201, -99.8120295504729, -99.68073169390361, -102.97030659516653, -102.92637886603674, -117.50344367822012, -115.53212980429332, -99.4105579952399, -99.14581718544166, -99.19337194164595, -97.88642201324305, -111.77243407567343, -10.531284535924598, -10.60738465438287, -10.766972924272224, -97.9756601601839, -110.94209921360016, -98.37284249067307, -4.832298936943218, -4.909730958441898, -4.817790235082313, -6.821808834870666, -7.105494533975929, -7.131515835722297, -103.80567463239035, -103.59177114566168, -116.58790322144827, -110.57961506644885, -100.96086261669795, -100.97792265812556, -110.29529428482056, -98.13405430316925, -96.97307562828064, -103.34529059131941, -103.48749788602194, -115.82893313964209, -101.33389470974605, -100.06252067039411, -114.19249473015468, -105.86013575394949, -93.78321600457033, -93.64720088740191, -103.54418279727301, -101.3796276052793, -113.30998780330023, -113.83583641052246, -100.39263470470905, -102.08300387859344, -106.92985091606776, -94.74877868096034, -94.90910981098811, -97.03672196467718, -106.44712220629057, -94.81720898052058, -2.180700394014522, -2.1098210091392247, -1.9069300393263546, 9.947723696629197, 10.431677947441727, 9.910126800338418, -115.05236033598582, -98.3122501919667, -97.84811679522197, -99.08791987101237, -94.79330448309581, -98.32581607500713, 7.866713389754295, 7.780849806964397, 8.291617700830102, -106.6164533495903, -94.77288891375065, -94.90316492319107, -89.37141724427542, -100.48934452732405, -88.88606880356869, -120.52721613645554, -107.5824804008007, -107.17727729678154, -102.67584767440955, -104.22205273310344, -118.03343598047893, 0.8349791293342861, 0.8211576317747387, 0.5766823639472278, -6.117206007242203, -5.339234933257103, -5.6222041845321655, -100.72137779990832, -98.65737355748813, -112.85934231678645, -102.68918372193973, -114.85251984993617, -103.74338022867839, -102.95057450731596, -116.22526129086813, -102.52195489903292, -100.839180752635, -114.3218280673027, -101.11560332775116, -97.34072489539783, -109.22882376114528, -96.8357217113177, -100.23884281516075, -112.42580860853195, -98.37183281779289, -111.36198554436366, -99.8078224460284, -100.687058309714, -13.058967438836902, -13.137376231451839, -15.601038595040649, -107.31913127501807, -95.70505835612616, -95.64464673896632, -99.67025163273017, -111.54306511084239, -102.91472921768825, -105.95308917760849, -119.01744294166565, -108.02476930618286, -100.41788871089618, -99.42977088193099, -110.9533719221751, -107.50172124306361, -94.40558035920064, -94.06893213341634, 8.648678181072071, 8.584195976456002, 8.276802529891327, -105.17302602529526, -105.48177242279053, -118.49826633930206, -106.33181085189185, -117.63669659694037, -105.33483346303305, -15.211276665329933, -15.05934762954712, -15.008903250098228, -103.04260096947353, -100.97358554104964, -114.89063523213069, -9.514440911511585, -9.399975332121059, -9.635903070370361, -100.48855303724608, -114.02631505330405, -100.76937540372214, -103.20242389539878, -113.74747193853061, -103.63304845492046, -110.81668332219124, -124.27778571844101, -110.68528138101101, -107.37666879097621, -120.06679658095042, -107.83388201395671, -113.10404274861018, -101.48336384693782, -100.41297380129497, -102.33532025416693, -103.9711244304975, -116.82034655412039, -107.37932550162077, -121.40866523981094, -107.48314286023378, -90.5440046787262, -89.99052369594574, -83.80876833200455, -17.94118757421772, -18.3281096170346, -18.112420710424587, -90.94456940392654, -103.87905828158061, -91.93235896031062, -123.60015547275543, -111.22744536399841, -109.51570706814528, -0.43567778666815116, -0.23394083728393866, -0.5706830521424706, -8.83411326756081, -8.725815036644548, -9.187165622909873, -109.84314288695654, -97.09451440473399, -98.67134611805281, -103.08054413398108, -102.90910910566649, -109.50037833054861, -101.33019556089616, -102.47016273935637, -115.28860547145209, -115.89249249299368, -102.8927933027347, -102.051802461346, -117.10690593719482, -100.73208226263523, -101.26533983647823, 0.3244488040606086, -0.2658335020144875, 0.49237969393530534, -87.15683653950691, -98.40037971735, -85.23152276873589, 6.835887789726257, 6.767513066530228, 7.140868291258812, -98.85748643924794, -111.94791146119437, -99.58721653123698, -107.37744238972664, -108.2553308904171, -124.68229186534882, -1.2571875502665932, -1.0646902707715924, -1.8021749456723626, -1.701182633638382, -1.8906599879264832, -1.4893869534134865, -97.27380577226481, -98.02901167174181, -110.41635419925055, -90.48341151575248, -102.69899938503902, -91.73204023639362, -111.17402868469557, -102.00991453727087, -101.43176766236624, -1.6433843175570217, -1.555806970844671, -1.6702533463637081, -110.80092416206996, -97.26848409573238, -97.75864944855373, -97.32175494388989, -111.4504431684812, -99.2163929839929, 1.3653289029995506, 0.9362719456354682, 0.7471830646196906, -106.04211650292079, -93.53818915287654, -92.99543447295825, -119.68969587484996, -115.05302351216476, -114.68082369553547, -19.24281200766564, -19.446889668703086, -20.20404940843583, -94.27284660935402, -93.11786272749305, -98.59687733650208, -91.99550831814608, -106.02730842431387, -90.7990585070414, -0.6037717486421315, -0.922858471671745, -0.4138351033131329, -9.233357613285392, -9.163704668482154, -9.496829812725395, -87.27232935031256, -99.1279345949491, -85.51622750361761, -109.47542115052542, -98.45758750041327, -97.4189193447431, -93.87914967536926, -107.13697147369385, -92.48860237002373, 3.752947290738419, 4.1396266122659, 3.6733866383631977, -0.6309880241751671, -1.2604872435331345, -1.219374418258667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1641478116297616, "mean_inference_ms": 0.7075882082043221, "mean_action_processing_ms": 0.09658138295060636, "mean_env_wait_ms": 0.7942008616912811, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 100000, "timesteps_this_iter": 0, "agent_timesteps_total": 300000, "timers": {"sample_time_ms": 10871.72, "sample_throughput": 459.909, "load_time_ms": 0.401, "load_throughput": 12469687.24, "learn_time_ms": 1924.236, "learn_throughput": 2598.434, "update_time_ms": 8.805}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0005000000000000001, "total_loss": 635.0286499023438, "policy_loss": -0.0024531166001409144, "vf_loss": 635.0867004394531, "vf_explained_var": 0.2164969801902771, "kl": 0.00325952116400261, "entropy": 5.560790157318115, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 100000, "num_agent_steps_sampled": 300000, "num_steps_trained": 100000, "num_agent_steps_trained": 300000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 797, "training_iteration": 20, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-04-58", "timestamp": 1706231098, "time_this_iter_s": 10.580301761627197, "time_total_s": 216.29141187667847, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214024E85E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 216.29141187667847, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 6.166666666666667, "ram_util_percent": 49.52666666666667}}
{"episode_reward_max": 30.289528444409342, "episode_reward_min": -349.42354308255017, "episode_reward_mean": -222.00874332516455, "episode_len_mean": 210.62, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -124.68229186534882}, "policy_reward_max": {"shared_policy": 10.431677947441727}, "policy_reward_mean": {"shared_policy": -74.00291444172153}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-323.98534899950033, -312.51840034127235, -305.40242421627045, -322.6617216169834, -315.5889101102948, -293.2905526459217, -318.23379820585257, -316.31147499382496, -296.5877394080162, -298.3010531514883, -6.1974514424801015, 30.289528444409342, -311.2127273231745, -292.2070404291153, 23.939180897548795, -296.292507186532, -278.74683057516813, -335.2869738340378, -324.9313363879919, 2.2328191250562526, -17.07864512503147, -312.2380936741829, -321.2850838005543, -321.697790697217, -316.27661214768887, -303.4052703678608, -311.0364842414856, -311.85686630010605, -41.79738226532939, -298.6688363701105, -314.1280459612608, -332.995301425457, -310.80103151500225, -295.9762337356806, 25.5096766874194, -329.15306478738785, -329.30334091186523, -45.27952754497528, -318.90682174265385, -28.550319314003005, -315.2842434942723, -320.58294428884983, -345.77975042164326, -335.27734738588333, -315.00038039684296, -323.1267912387848, -336.2711336016655, -264.3432967066765, -54.38171790167691, -286.75598664581776, -344.3433079048991, -1.2403016760945604, -26.74709392711523, -305.6090034097433, -315.49003157019615, -319.0889637717046, -320.83708825707436, -319.1043280363083, 0.5509949959814264, -270.7887390255928, 20.744269147515297, -310.3926144316793, -340.31506514549255, -4.124052766710548, -5.081229574978352, -305.7191716432572, -284.9144511371851, -314.61571088433266, -4.869444634765401, -305.82805770635605, -307.98859109636396, 3.0487839132547094, -292.57574012875557, -349.42354308255017, -58.893751084804556, -285.98758667334914, -288.8218752495013, -1.9404653236270093, -27.89389209449294, -271.91649144887924, -305.35192799568176, -293.50472351908684, 11.565960541367517, -3.1108496859669685, -340.4526118636132, -306.2936703786254, -305.8916603028774, -313.18514122813946, -39.53765282034874, 2.6470247656106665, -34.11584213376048, -46.300470404326916, -18.452272064983873, -24.06748192757368, -301.5455053150654, -309.6820731163025, -300.2016092389822, -27.336328320205226, -315.69750546664, -347.13001868873835], "episode_lengths": [63, 63, 63, 54, 88, 80, 63, 70, 87, 82, 500, 500, 94, 59, 500, 71, 104, 69, 66, 500, 500, 47, 58, 62, 61, 82, 60, 61, 500, 71, 63, 85, 90, 68, 500, 59, 60, 500, 61, 500, 64, 94, 97, 65, 59, 83, 86, 104, 500, 83, 156, 500, 500, 81, 83, 53, 49, 49, 500, 80, 500, 40, 60, 500, 500, 72, 84, 63, 500, 60, 61, 500, 78, 475, 500, 64, 96, 500, 500, 109, 109, 77, 500, 500, 345, 63, 55, 66, 500, 500, 500, 500, 500, 500, 107, 70, 97, 500, 52, 309], "policy_shared_policy_reward": [-103.80567463239035, -103.59177114566168, -116.58790322144827, -110.57961506644885, -100.96086261669795, -100.97792265812556, -110.29529428482056, -98.13405430316925, -96.97307562828064, -103.34529059131941, -103.48749788602194, -115.82893313964209, -101.33389470974605, -100.06252067039411, -114.19249473015468, -105.86013575394949, -93.78321600457033, -93.64720088740191, -103.54418279727301, -101.3796276052793, -113.30998780330023, -113.83583641052246, -100.39263470470905, -102.08300387859344, -106.92985091606776, -94.74877868096034, -94.90910981098811, -97.03672196467718, -106.44712220629057, -94.81720898052058, -2.180700394014522, -2.1098210091392247, -1.9069300393263546, 9.947723696629197, 10.431677947441727, 9.910126800338418, -115.05236033598582, -98.3122501919667, -97.84811679522197, -99.08791987101237, -94.79330448309581, -98.32581607500713, 7.866713389754295, 7.780849806964397, 8.291617700830102, -106.6164533495903, -94.77288891375065, -94.90316492319107, -89.37141724427542, -100.48934452732405, -88.88606880356869, -120.52721613645554, -107.5824804008007, -107.17727729678154, -102.67584767440955, -104.22205273310344, -118.03343598047893, 0.8349791293342861, 0.8211576317747387, 0.5766823639472278, -6.117206007242203, -5.339234933257103, -5.6222041845321655, -100.72137779990832, -98.65737355748813, -112.85934231678645, -102.68918372193973, -114.85251984993617, -103.74338022867839, -102.95057450731596, -116.22526129086813, -102.52195489903292, -100.839180752635, -114.3218280673027, -101.11560332775116, -97.34072489539783, -109.22882376114528, -96.8357217113177, -100.23884281516075, -112.42580860853195, -98.37183281779289, -111.36198554436366, -99.8078224460284, -100.687058309714, -13.058967438836902, -13.137376231451839, -15.601038595040649, -107.31913127501807, -95.70505835612616, -95.64464673896632, -99.67025163273017, -111.54306511084239, -102.91472921768825, -105.95308917760849, -119.01744294166565, -108.02476930618286, -100.41788871089618, -99.42977088193099, -110.9533719221751, -107.50172124306361, -94.40558035920064, -94.06893213341634, 8.648678181072071, 8.584195976456002, 8.276802529891327, -105.17302602529526, -105.48177242279053, -118.49826633930206, -106.33181085189185, -117.63669659694037, -105.33483346303305, -15.211276665329933, -15.05934762954712, -15.008903250098228, -103.04260096947353, -100.97358554104964, -114.89063523213069, -9.514440911511585, -9.399975332121059, -9.635903070370361, -100.48855303724608, -114.02631505330405, -100.76937540372214, -103.20242389539878, -113.74747193853061, -103.63304845492046, -110.81668332219124, -124.27778571844101, -110.68528138101101, -107.37666879097621, -120.06679658095042, -107.83388201395671, -113.10404274861018, -101.48336384693782, -100.41297380129497, -102.33532025416693, -103.9711244304975, -116.82034655412039, -107.37932550162077, -121.40866523981094, -107.48314286023378, -90.5440046787262, -89.99052369594574, -83.80876833200455, -17.94118757421772, -18.3281096170346, -18.112420710424587, -90.94456940392654, -103.87905828158061, -91.93235896031062, -123.60015547275543, -111.22744536399841, -109.51570706814528, -0.43567778666815116, -0.23394083728393866, -0.5706830521424706, -8.83411326756081, -8.725815036644548, -9.187165622909873, -109.84314288695654, -97.09451440473399, -98.67134611805281, -103.08054413398108, -102.90910910566649, -109.50037833054861, -101.33019556089616, -102.47016273935637, -115.28860547145209, -115.89249249299368, -102.8927933027347, -102.051802461346, -117.10690593719482, -100.73208226263523, -101.26533983647823, 0.3244488040606086, -0.2658335020144875, 0.49237969393530534, -87.15683653950691, -98.40037971735, -85.23152276873589, 6.835887789726257, 6.767513066530228, 7.140868291258812, -98.85748643924794, -111.94791146119437, -99.58721653123698, -107.37744238972664, -108.2553308904171, -124.68229186534882, -1.2571875502665932, -1.0646902707715924, -1.8021749456723626, -1.701182633638382, -1.8906599879264832, -1.4893869534134865, -97.27380577226481, -98.02901167174181, -110.41635419925055, -90.48341151575248, -102.69899938503902, -91.73204023639362, -111.17402868469557, -102.00991453727087, -101.43176766236624, -1.6433843175570217, -1.555806970844671, -1.6702533463637081, -110.80092416206996, -97.26848409573238, -97.75864944855373, -97.32175494388989, -111.4504431684812, -99.2163929839929, 1.3653289029995506, 0.9362719456354682, 0.7471830646196906, -106.04211650292079, -93.53818915287654, -92.99543447295825, -119.68969587484996, -115.05302351216476, -114.68082369553547, -19.24281200766564, -19.446889668703086, -20.20404940843583, -94.27284660935402, -93.11786272749305, -98.59687733650208, -91.99550831814608, -106.02730842431387, -90.7990585070414, -0.6037717486421315, -0.922858471671745, -0.4138351033131329, -9.233357613285392, -9.163704668482154, -9.496829812725395, -87.27232935031256, -99.1279345949491, -85.51622750361761, -109.47542115052542, -98.45758750041327, -97.4189193447431, -93.87914967536926, -107.13697147369385, -92.48860237002373, 3.752947290738419, 4.1396266122659, 3.6733866383631977, -0.6309880241751671, -1.2604872435331345, -1.219374418258667, -113.6200882891814, -113.47242523233096, -113.36009834210078, -98.34682315339646, -97.93116230269274, -110.01568492253622, -97.92229056358337, -111.7468672990799, -96.22250244021416, -100.33103216191134, -112.83347453673682, -100.02063452949128, -13.381215438246727, -12.836509972810745, -13.319927409291267, 0.873038123051316, 0.7472407693664138, 1.0267458731929366, -11.444119786222785, -11.221099545558303, -11.450622801979392, -15.410746082663536, -15.80192905664444, -15.08779526501894, -6.095475611587375, -6.174563897152751, -6.182232556243747, -7.826457031071186, -8.240194141864777, -8.000830754637718, -109.25643779834112, -95.24643682440123, -97.04263069232306, -98.28707013527553, -98.28937445084254, -113.10562853018443, -97.02917601664862, -95.30105132361254, -107.87138189872107, -9.01995797703664, -9.1188893566529, -9.197480986515686, -99.92564733823141, -115.77578123410544, -99.99607689430317, -114.363862435023, -121.62700423101585, -111.13915202269952]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16391312621163562, "mean_inference_ms": 0.7070461011558795, "mean_action_processing_ms": 0.09651036222490639, "mean_env_wait_ms": 0.7938292680759167, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 105000, "timesteps_this_iter": 0, "agent_timesteps_total": 315000, "timers": {"sample_time_ms": 10817.012, "sample_throughput": 462.235, "load_time_ms": 0.401, "load_throughput": 12469687.24, "learn_time_ms": 1914.046, "learn_throughput": 2612.267, "update_time_ms": 8.706}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0005000000000000001, "total_loss": 511.6488830566406, "policy_loss": -0.003084181295099375, "vf_loss": 511.70513610839845, "vf_explained_var": 0.17861989736557007, "kl": 0.004727341898253938, "entropy": 5.315351724624634, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 105000, "num_agent_steps_sampled": 315000, "num_steps_trained": 105000, "num_agent_steps_trained": 315000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 813, "training_iteration": 21, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-05-08", "timestamp": 1706231108, "time_this_iter_s": 10.48324704170227, "time_total_s": 226.77465891838074, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140234DEE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 226.77465891838074, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 8.366666666666667, "ram_util_percent": 49.49333333333333}}
{"episode_reward_max": 32.45443815365432, "episode_reward_min": -349.42354308255017, "episode_reward_mean": -201.31459478405537, "episode_len_mean": 240.63, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {"shared_policy": -125.24592959880829}, "policy_reward_max": {"shared_policy": 11.164262065043047}, "policy_reward_mean": {"shared_policy": -67.10486492801847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.939180897548795, -296.292507186532, -278.74683057516813, -335.2869738340378, -324.9313363879919, 2.2328191250562526, -17.07864512503147, -312.2380936741829, -321.2850838005543, -321.697790697217, -316.27661214768887, -303.4052703678608, -311.0364842414856, -311.85686630010605, -41.79738226532939, -298.6688363701105, -314.1280459612608, -332.995301425457, -310.80103151500225, -295.9762337356806, 25.5096766874194, -329.15306478738785, -329.30334091186523, -45.27952754497528, -318.90682174265385, -28.550319314003005, -315.2842434942723, -320.58294428884983, -345.77975042164326, -335.27734738588333, -315.00038039684296, -323.1267912387848, -336.2711336016655, -264.3432967066765, -54.38171790167691, -286.75598664581776, -344.3433079048991, -1.2403016760945604, -26.74709392711523, -305.6090034097433, -315.49003157019615, -319.0889637717046, -320.83708825707436, -319.1043280363083, 0.5509949959814264, -270.7887390255928, 20.744269147515297, -310.3926144316793, -340.31506514549255, -4.124052766710548, -5.081229574978352, -305.7191716432572, -284.9144511371851, -314.61571088433266, -4.869444634765401, -305.82805770635605, -307.98859109636396, 3.0487839132547094, -292.57574012875557, -349.42354308255017, -58.893751084804556, -285.98758667334914, -288.8218752495013, -1.9404653236270093, -27.89389209449294, -271.91649144887924, -305.35192799568176, -293.50472351908684, 11.565960541367517, -3.1108496859669685, -340.4526118636132, -306.2936703786254, -305.8916603028774, -313.18514122813946, -39.53765282034874, 2.6470247656106665, -34.11584213376048, -46.300470404326916, -18.452272064983873, -24.06748192757368, -301.5455053150654, -309.6820731163025, -300.2016092389822, -27.336328320205226, -315.69750546664, -347.13001868873835, 32.45443815365432, 12.44508841354397, -316.2775395140052, 18.96778509765862, -296.7819514423609, -4.57188527099791, -347.5158641934395, -30.53242371976377, 2.978104546666117, -318.4973863300402, -290.65947814285755, 3.3273647651076033, -27.56761694699526, -50.562895745039015], "episode_lengths": [500, 71, 104, 69, 66, 500, 500, 47, 58, 62, 61, 82, 60, 61, 500, 71, 63, 85, 90, 68, 500, 59, 60, 500, 61, 500, 64, 94, 97, 65, 59, 83, 86, 104, 500, 83, 156, 500, 500, 81, 83, 53, 49, 49, 500, 80, 500, 40, 60, 500, 500, 72, 84, 63, 500, 60, 61, 500, 78, 475, 500, 64, 96, 500, 500, 109, 109, 77, 500, 500, 345, 63, 55, 66, 500, 500, 500, 500, 500, 500, 107, 70, 97, 500, 52, 309, 500, 500, 50, 500, 71, 500, 91, 500, 500, 79, 76, 500, 500, 500], "policy_shared_policy_reward": [7.866713389754295, 7.780849806964397, 8.291617700830102, -106.6164533495903, -94.77288891375065, -94.90316492319107, -89.37141724427542, -100.48934452732405, -88.88606880356869, -120.52721613645554, -107.5824804008007, -107.17727729678154, -102.67584767440955, -104.22205273310344, -118.03343598047893, 0.8349791293342861, 0.8211576317747387, 0.5766823639472278, -6.117206007242203, -5.339234933257103, -5.6222041845321655, -100.72137779990832, -98.65737355748813, -112.85934231678645, -102.68918372193973, -114.85251984993617, -103.74338022867839, -102.95057450731596, -116.22526129086813, -102.52195489903292, -100.839180752635, -114.3218280673027, -101.11560332775116, -97.34072489539783, -109.22882376114528, -96.8357217113177, -100.23884281516075, -112.42580860853195, -98.37183281779289, -111.36198554436366, -99.8078224460284, -100.687058309714, -13.058967438836902, -13.137376231451839, -15.601038595040649, -107.31913127501807, -95.70505835612616, -95.64464673896632, -99.67025163273017, -111.54306511084239, -102.91472921768825, -105.95308917760849, -119.01744294166565, -108.02476930618286, -100.41788871089618, -99.42977088193099, -110.9533719221751, -107.50172124306361, -94.40558035920064, -94.06893213341634, 8.648678181072071, 8.584195976456002, 8.276802529891327, -105.17302602529526, -105.48177242279053, -118.49826633930206, -106.33181085189185, -117.63669659694037, -105.33483346303305, -15.211276665329933, -15.05934762954712, -15.008903250098228, -103.04260096947353, -100.97358554104964, -114.89063523213069, -9.514440911511585, -9.399975332121059, -9.635903070370361, -100.48855303724608, -114.02631505330405, -100.76937540372214, -103.20242389539878, -113.74747193853061, -103.63304845492046, -110.81668332219124, -124.27778571844101, -110.68528138101101, -107.37666879097621, -120.06679658095042, -107.83388201395671, -113.10404274861018, -101.48336384693782, -100.41297380129497, -102.33532025416693, -103.9711244304975, -116.82034655412039, -107.37932550162077, -121.40866523981094, -107.48314286023378, -90.5440046787262, -89.99052369594574, -83.80876833200455, -17.94118757421772, -18.3281096170346, -18.112420710424587, -90.94456940392654, -103.87905828158061, -91.93235896031062, -123.60015547275543, -111.22744536399841, -109.51570706814528, -0.43567778666815116, -0.23394083728393866, -0.5706830521424706, -8.83411326756081, -8.725815036644548, -9.187165622909873, -109.84314288695654, -97.09451440473399, -98.67134611805281, -103.08054413398108, -102.90910910566649, -109.50037833054861, -101.33019556089616, -102.47016273935637, -115.28860547145209, -115.89249249299368, -102.8927933027347, -102.051802461346, -117.10690593719482, -100.73208226263523, -101.26533983647823, 0.3244488040606086, -0.2658335020144875, 0.49237969393530534, -87.15683653950691, -98.40037971735, -85.23152276873589, 6.835887789726257, 6.767513066530228, 7.140868291258812, -98.85748643924794, -111.94791146119437, -99.58721653123698, -107.37744238972664, -108.2553308904171, -124.68229186534882, -1.2571875502665932, -1.0646902707715924, -1.8021749456723626, -1.701182633638382, -1.8906599879264832, -1.4893869534134865, -97.27380577226481, -98.02901167174181, -110.41635419925055, -90.48341151575248, -102.69899938503902, -91.73204023639362, -111.17402868469557, -102.00991453727087, -101.43176766236624, -1.6433843175570217, -1.555806970844671, -1.6702533463637081, -110.80092416206996, -97.26848409573238, -97.75864944855373, -97.32175494388989, -111.4504431684812, -99.2163929839929, 1.3653289029995506, 0.9362719456354682, 0.7471830646196906, -106.04211650292079, -93.53818915287654, -92.99543447295825, -119.68969587484996, -115.05302351216476, -114.68082369553547, -19.24281200766564, -19.446889668703086, -20.20404940843583, -94.27284660935402, -93.11786272749305, -98.59687733650208, -91.99550831814608, -106.02730842431387, -90.7990585070414, -0.6037717486421315, -0.922858471671745, -0.4138351033131329, -9.233357613285392, -9.163704668482154, -9.496829812725395, -87.27232935031256, -99.1279345949491, -85.51622750361761, -109.47542115052542, -98.45758750041327, -97.4189193447431, -93.87914967536926, -107.13697147369385, -92.48860237002373, 3.752947290738419, 4.1396266122659, 3.6733866383631977, -0.6309880241751671, -1.2604872435331345, -1.219374418258667, -113.6200882891814, -113.47242523233096, -113.36009834210078, -98.34682315339646, -97.93116230269274, -110.01568492253622, -97.92229056358337, -111.7468672990799, -96.22250244021416, -100.33103216191134, -112.83347453673682, -100.02063452949128, -13.381215438246727, -12.836509972810745, -13.319927409291267, 0.873038123051316, 0.7472407693664138, 1.0267458731929366, -11.444119786222785, -11.221099545558303, -11.450622801979392, -15.410746082663536, -15.80192905664444, -15.08779526501894, -6.095475611587375, -6.174563897152751, -6.182232556243747, -7.826457031071186, -8.240194141864777, -8.000830754637718, -109.25643779834112, -95.24643682440123, -97.04263069232306, -98.28707013527553, -98.28937445084254, -113.10562853018443, -97.02917601664862, -95.30105132361254, -107.87138189872107, -9.01995797703664, -9.1188893566529, -9.197480986515686, -99.92564733823141, -115.77578123410544, -99.99607689430317, -114.363862435023, -121.62700423101585, -111.13915202269952, 10.80811997254689, 11.164262065043047, 10.482056116064385, 3.7413093099991386, 4.241414743165166, 4.4623643603796666, -115.17405871550243, -99.79106158266465, -101.31241921583812, 6.526159671445683, 6.193155338366822, 6.2484700878461155, -106.62828143437704, -94.89098179837069, -95.26268820961317, -1.4809348744650777, -1.8187921245892937, -1.272158271943539, -110.71347618103027, -111.55645841360092, -125.24592959880829, -9.674588421980545, -10.62422362963359, -10.233611668149635, 0.9539426515499656, 1.246820653478295, 0.7773412416378562, -103.11066814263663, -100.56252528595118, -114.82419290145239, -106.18078343073527, -92.62142873803775, -91.85726597408454, 1.3196895370880668, 0.9505791316429679, 1.0570960963765685, -9.582756504416466, -8.826463229954243, -9.15839721262455, -17.021243219574302, -16.874909420808166, -16.666743104656547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16353302529563174, "mean_inference_ms": 0.708539437930309, "mean_action_processing_ms": 0.0968512345874848, "mean_env_wait_ms": 0.7954347409211148, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 110000, "timesteps_this_iter": 0, "agent_timesteps_total": 330000, "timers": {"sample_time_ms": 10778.447, "sample_throughput": 463.889, "load_time_ms": 0.301, "load_throughput": 16611104.95, "learn_time_ms": 1912.477, "learn_throughput": 2614.41, "update_time_ms": 8.805}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0005000000000000001, "total_loss": 268.161279296875, "policy_loss": -0.0021892793798081733, "vf_loss": 268.2156921386719, "vf_explained_var": 0.27061285376548766, "kl": 0.0035276176407959005, "entropy": 5.222370290756226, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 110000, "num_agent_steps_sampled": 330000, "num_steps_trained": 110000, "num_agent_steps_trained": 330000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 827, "training_iteration": 22, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-05-19", "timestamp": 1706231119, "time_this_iter_s": 10.415857076644897, "time_total_s": 237.19051599502563, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401A96790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 237.19051599502563, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 5.807142857142857, "ram_util_percent": 49.42142857142857}}
{"episode_reward_max": 32.45443815365432, "episode_reward_min": -349.42354308255017, "episode_reward_mean": -186.23143923737808, "episode_len_mean": 264.31, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {"shared_policy": -125.24592959880829}, "policy_reward_max": {"shared_policy": 11.164262065043047}, "policy_reward_mean": {"shared_policy": -62.077146412459356}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-295.9762337356806, 25.5096766874194, -329.15306478738785, -329.30334091186523, -45.27952754497528, -318.90682174265385, -28.550319314003005, -315.2842434942723, -320.58294428884983, -345.77975042164326, -335.27734738588333, -315.00038039684296, -323.1267912387848, -336.2711336016655, -264.3432967066765, -54.38171790167691, -286.75598664581776, -344.3433079048991, -1.2403016760945604, -26.74709392711523, -305.6090034097433, -315.49003157019615, -319.0889637717046, -320.83708825707436, -319.1043280363083, 0.5509949959814264, -270.7887390255928, 20.744269147515297, -310.3926144316793, -340.31506514549255, -4.124052766710548, -5.081229574978352, -305.7191716432572, -284.9144511371851, -314.61571088433266, -4.869444634765401, -305.82805770635605, -307.98859109636396, 3.0487839132547094, -292.57574012875557, -349.42354308255017, -58.893751084804556, -285.98758667334914, -288.8218752495013, -1.9404653236270093, -27.89389209449294, -271.91649144887924, -305.35192799568176, -293.50472351908684, 11.565960541367517, -3.1108496859669685, -340.4526118636132, -306.2936703786254, -305.8916603028774, -313.18514122813946, -39.53765282034874, 2.6470247656106665, -34.11584213376048, -46.300470404326916, -18.452272064983873, -24.06748192757368, -301.5455053150654, -309.6820731163025, -300.2016092389822, -27.336328320205226, -315.69750546664, -347.13001868873835, 32.45443815365432, 12.44508841354397, -316.2775395140052, 18.96778509765862, -296.7819514423609, -4.57188527099791, -347.5158641934395, -30.53242371976377, 2.978104546666117, -318.4973863300402, -290.65947814285755, 3.3273647651076033, -27.56761694699526, -50.562895745039015, 17.70535436272621, -306.35497307777405, -313.8141809254885, -291.7400984950364, -22.880682185292258, -318.53152964264154, -11.497795224189773, -33.57861163467169, -61.2060218006372, 15.898007655516238, -11.953396353404997, -311.6853530406952, -325.73977402597666, -301.81333607807755, -317.9325602352619, -40.05849255621436, 26.217470817267895, -320.19623792171484, -284.87332682311535], "episode_lengths": [68, 500, 59, 60, 500, 61, 500, 64, 94, 97, 65, 59, 83, 86, 104, 500, 83, 156, 500, 500, 81, 83, 53, 49, 49, 500, 80, 500, 40, 60, 500, 500, 72, 84, 63, 500, 60, 61, 500, 78, 475, 500, 64, 96, 500, 500, 109, 109, 77, 500, 500, 345, 63, 55, 66, 500, 500, 500, 500, 500, 500, 107, 70, 97, 500, 52, 309, 500, 500, 50, 500, 71, 500, 91, 500, 500, 79, 76, 500, 500, 500, 500, 54, 85, 68, 500, 105, 500, 500, 500, 500, 500, 113, 168, 64, 120, 500, 500, 40, 101], "policy_shared_policy_reward": [-107.50172124306361, -94.40558035920064, -94.06893213341634, 8.648678181072071, 8.584195976456002, 8.276802529891327, -105.17302602529526, -105.48177242279053, -118.49826633930206, -106.33181085189185, -117.63669659694037, -105.33483346303305, -15.211276665329933, -15.05934762954712, -15.008903250098228, -103.04260096947353, -100.97358554104964, -114.89063523213069, -9.514440911511585, -9.399975332121059, -9.635903070370361, -100.48855303724608, -114.02631505330405, -100.76937540372214, -103.20242389539878, -113.74747193853061, -103.63304845492046, -110.81668332219124, -124.27778571844101, -110.68528138101101, -107.37666879097621, -120.06679658095042, -107.83388201395671, -113.10404274861018, -101.48336384693782, -100.41297380129497, -102.33532025416693, -103.9711244304975, -116.82034655412039, -107.37932550162077, -121.40866523981094, -107.48314286023378, -90.5440046787262, -89.99052369594574, -83.80876833200455, -17.94118757421772, -18.3281096170346, -18.112420710424587, -90.94456940392654, -103.87905828158061, -91.93235896031062, -123.60015547275543, -111.22744536399841, -109.51570706814528, -0.43567778666815116, -0.23394083728393866, -0.5706830521424706, -8.83411326756081, -8.725815036644548, -9.187165622909873, -109.84314288695654, -97.09451440473399, -98.67134611805281, -103.08054413398108, -102.90910910566649, -109.50037833054861, -101.33019556089616, -102.47016273935637, -115.28860547145209, -115.89249249299368, -102.8927933027347, -102.051802461346, -117.10690593719482, -100.73208226263523, -101.26533983647823, 0.3244488040606086, -0.2658335020144875, 0.49237969393530534, -87.15683653950691, -98.40037971735, -85.23152276873589, 6.835887789726257, 6.767513066530228, 7.140868291258812, -98.85748643924794, -111.94791146119437, -99.58721653123698, -107.37744238972664, -108.2553308904171, -124.68229186534882, -1.2571875502665932, -1.0646902707715924, -1.8021749456723626, -1.701182633638382, -1.8906599879264832, -1.4893869534134865, -97.27380577226481, -98.02901167174181, -110.41635419925055, -90.48341151575248, -102.69899938503902, -91.73204023639362, -111.17402868469557, -102.00991453727087, -101.43176766236624, -1.6433843175570217, -1.555806970844671, -1.6702533463637081, -110.80092416206996, -97.26848409573238, -97.75864944855373, -97.32175494388989, -111.4504431684812, -99.2163929839929, 1.3653289029995506, 0.9362719456354682, 0.7471830646196906, -106.04211650292079, -93.53818915287654, -92.99543447295825, -119.68969587484996, -115.05302351216476, -114.68082369553547, -19.24281200766564, -19.446889668703086, -20.20404940843583, -94.27284660935402, -93.11786272749305, -98.59687733650208, -91.99550831814608, -106.02730842431387, -90.7990585070414, -0.6037717486421315, -0.922858471671745, -0.4138351033131329, -9.233357613285392, -9.163704668482154, -9.496829812725395, -87.27232935031256, -99.1279345949491, -85.51622750361761, -109.47542115052542, -98.45758750041327, -97.4189193447431, -93.87914967536926, -107.13697147369385, -92.48860237002373, 3.752947290738419, 4.1396266122659, 3.6733866383631977, -0.6309880241751671, -1.2604872435331345, -1.219374418258667, -113.6200882891814, -113.47242523233096, -113.36009834210078, -98.34682315339646, -97.93116230269274, -110.01568492253622, -97.92229056358337, -111.7468672990799, -96.22250244021416, -100.33103216191134, -112.83347453673682, -100.02063452949128, -13.381215438246727, -12.836509972810745, -13.319927409291267, 0.873038123051316, 0.7472407693664138, 1.0267458731929366, -11.444119786222785, -11.221099545558303, -11.450622801979392, -15.410746082663536, -15.80192905664444, -15.08779526501894, -6.095475611587375, -6.174563897152751, -6.182232556243747, -7.826457031071186, -8.240194141864777, -8.000830754637718, -109.25643779834112, -95.24643682440123, -97.04263069232306, -98.28707013527553, -98.28937445084254, -113.10562853018443, -97.02917601664862, -95.30105132361254, -107.87138189872107, -9.01995797703664, -9.1188893566529, -9.197480986515686, -99.92564733823141, -115.77578123410544, -99.99607689430317, -114.363862435023, -121.62700423101585, -111.13915202269952, 10.80811997254689, 11.164262065043047, 10.482056116064385, 3.7413093099991386, 4.241414743165166, 4.4623643603796666, -115.17405871550243, -99.79106158266465, -101.31241921583812, 6.526159671445683, 6.193155338366822, 6.2484700878461155, -106.62828143437704, -94.89098179837069, -95.26268820961317, -1.4809348744650777, -1.8187921245892937, -1.272158271943539, -110.71347618103027, -111.55645841360092, -125.24592959880829, -9.674588421980545, -10.62422362963359, -10.233611668149635, 0.9539426515499656, 1.246820653478295, 0.7773412416378562, -103.11066814263663, -100.56252528595118, -114.82419290145239, -106.18078343073527, -92.62142873803775, -91.85726597408454, 1.3196895370880668, 0.9505791316429679, 1.0570960963765685, -9.582756504416466, -8.826463229954243, -9.15839721262455, -17.021243219574302, -16.874909420808166, -16.666743104656547, 5.859639883041382, 5.992092803120613, 5.853621676564217, -102.88964293400447, -102.58447192112605, -100.88085822264354, -100.41423499087493, -101.06318406263988, -112.33676187197368, -105.45258935292563, -93.27164049943289, -93.01586864267787, -7.649853373567268, -7.516316617528602, -7.714512194196388, -102.96753267447154, -115.7008449236552, -99.86315204451482, -4.170840809742614, -3.5631751815478054, -3.7637792328993527, -11.010012112557888, -11.147617518901825, -11.420982003211975, -20.61344130833944, -20.165981193383537, -20.426599298914276, 4.953661228219659, 5.573655900234968, 5.370690527061612, -4.00887078170976, -4.193668444951385, -3.7508571267438526, -102.16267828146617, -103.60693279902141, -105.91574196020763, -104.29458833982548, -114.08057320614657, -107.36461248000464, -97.04860651493073, -110.26777827739716, -94.49695128574967, -101.61700663963954, -103.60449192921321, -112.71106166640918, -13.282365967830032, -13.613233809669822, -13.162892778714507, 8.472659692168236, 8.89596651494503, 8.848844610154629, -102.1770438750585, -102.38873751958212, -115.63045652707419, -92.09120925267538, -103.32295443614325, -89.45916313429674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1625691442992891, "mean_inference_ms": 0.7071868838979823, "mean_action_processing_ms": 0.09693126964728188, "mean_env_wait_ms": 0.795396983099494, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 115000, "timesteps_this_iter": 0, "agent_timesteps_total": 345000, "timers": {"sample_time_ms": 10779.534, "sample_throughput": 463.842, "load_time_ms": 0.301, "load_throughput": 16611104.95, "learn_time_ms": 1916.917, "learn_throughput": 2608.356, "update_time_ms": 8.787}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0005000000000000001, "total_loss": 530.46650390625, "policy_loss": -0.002234562860445588, "vf_loss": 530.5229858398437, "vf_explained_var": 0.29697832465171814, "kl": 0.0036205670330702448, "entropy": 5.423121356964112, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 115000, "num_agent_steps_sampled": 345000, "num_steps_trained": 115000, "num_agent_steps_trained": 345000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 846, "training_iteration": 23, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-05-29", "timestamp": 1706231129, "time_this_iter_s": 10.669636964797974, "time_total_s": 247.8601529598236, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214018EEF70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 247.8601529598236, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 7.340000000000002, "ram_util_percent": 49.473333333333336}}
{"episode_reward_max": 32.45443815365432, "episode_reward_min": -349.42354308255017, "episode_reward_mean": -164.27579962242163, "episode_len_mean": 294.1, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {"shared_policy": -125.24592959880829}, "policy_reward_max": {"shared_policy": 11.164262065043047}, "policy_reward_mean": {"shared_policy": -54.75859987414055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-264.3432967066765, -54.38171790167691, -286.75598664581776, -344.3433079048991, -1.2403016760945604, -26.74709392711523, -305.6090034097433, -315.49003157019615, -319.0889637717046, -320.83708825707436, -319.1043280363083, 0.5509949959814264, -270.7887390255928, 20.744269147515297, -310.3926144316793, -340.31506514549255, -4.124052766710548, -5.081229574978352, -305.7191716432572, -284.9144511371851, -314.61571088433266, -4.869444634765401, -305.82805770635605, -307.98859109636396, 3.0487839132547094, -292.57574012875557, -349.42354308255017, -58.893751084804556, -285.98758667334914, -288.8218752495013, -1.9404653236270093, -27.89389209449294, -271.91649144887924, -305.35192799568176, -293.50472351908684, 11.565960541367517, -3.1108496859669685, -340.4526118636132, -306.2936703786254, -305.8916603028774, -313.18514122813946, -39.53765282034874, 2.6470247656106665, -34.11584213376048, -46.300470404326916, -18.452272064983873, -24.06748192757368, -301.5455053150654, -309.6820731163025, -300.2016092389822, -27.336328320205226, -315.69750546664, -347.13001868873835, 32.45443815365432, 12.44508841354397, -316.2775395140052, 18.96778509765862, -296.7819514423609, -4.57188527099791, -347.5158641934395, -30.53242371976377, 2.978104546666117, -318.4973863300402, -290.65947814285755, 3.3273647651076033, -27.56761694699526, -50.562895745039015, 17.70535436272621, -306.35497307777405, -313.8141809254885, -291.7400984950364, -22.880682185292258, -318.53152964264154, -11.497795224189773, -33.57861163467169, -61.2060218006372, 15.898007655516238, -11.953396353404997, -311.6853530406952, -325.73977402597666, -301.81333607807755, -317.9325602352619, -40.05849255621436, 26.217470817267895, -320.19623792171484, -284.87332682311535, -2.1233605071902275, 12.174263080582008, -321.689573943615, 7.673152033239603, -8.234218403697042, -333.387501552701, -48.47547161579132, -16.300261333584814, -4.569175422191648, -51.9083916284144, 9.383573263883576, -296.8472670027987, -43.90766209363939, -319.2063655555248], "episode_lengths": [104, 500, 83, 156, 500, 500, 81, 83, 53, 49, 49, 500, 80, 500, 40, 60, 500, 500, 72, 84, 63, 500, 60, 61, 500, 78, 475, 500, 64, 96, 500, 500, 109, 109, 77, 500, 500, 345, 63, 55, 66, 500, 500, 500, 500, 500, 500, 107, 70, 97, 500, 52, 309, 500, 500, 50, 500, 71, 500, 91, 500, 500, 79, 76, 500, 500, 500, 500, 54, 85, 68, 500, 105, 500, 500, 500, 500, 500, 113, 168, 64, 120, 500, 500, 40, 101, 500, 500, 60, 500, 500, 79, 500, 500, 500, 500, 500, 78, 500, 58], "policy_shared_policy_reward": [-90.5440046787262, -89.99052369594574, -83.80876833200455, -17.94118757421772, -18.3281096170346, -18.112420710424587, -90.94456940392654, -103.87905828158061, -91.93235896031062, -123.60015547275543, -111.22744536399841, -109.51570706814528, -0.43567778666815116, -0.23394083728393866, -0.5706830521424706, -8.83411326756081, -8.725815036644548, -9.187165622909873, -109.84314288695654, -97.09451440473399, -98.67134611805281, -103.08054413398108, -102.90910910566649, -109.50037833054861, -101.33019556089616, -102.47016273935637, -115.28860547145209, -115.89249249299368, -102.8927933027347, -102.051802461346, -117.10690593719482, -100.73208226263523, -101.26533983647823, 0.3244488040606086, -0.2658335020144875, 0.49237969393530534, -87.15683653950691, -98.40037971735, -85.23152276873589, 6.835887789726257, 6.767513066530228, 7.140868291258812, -98.85748643924794, -111.94791146119437, -99.58721653123698, -107.37744238972664, -108.2553308904171, -124.68229186534882, -1.2571875502665932, -1.0646902707715924, -1.8021749456723626, -1.701182633638382, -1.8906599879264832, -1.4893869534134865, -97.27380577226481, -98.02901167174181, -110.41635419925055, -90.48341151575248, -102.69899938503902, -91.73204023639362, -111.17402868469557, -102.00991453727087, -101.43176766236624, -1.6433843175570217, -1.555806970844671, -1.6702533463637081, -110.80092416206996, -97.26848409573238, -97.75864944855373, -97.32175494388989, -111.4504431684812, -99.2163929839929, 1.3653289029995506, 0.9362719456354682, 0.7471830646196906, -106.04211650292079, -93.53818915287654, -92.99543447295825, -119.68969587484996, -115.05302351216476, -114.68082369553547, -19.24281200766564, -19.446889668703086, -20.20404940843583, -94.27284660935402, -93.11786272749305, -98.59687733650208, -91.99550831814608, -106.02730842431387, -90.7990585070414, -0.6037717486421315, -0.922858471671745, -0.4138351033131329, -9.233357613285392, -9.163704668482154, -9.496829812725395, -87.27232935031256, -99.1279345949491, -85.51622750361761, -109.47542115052542, -98.45758750041327, -97.4189193447431, -93.87914967536926, -107.13697147369385, -92.48860237002373, 3.752947290738419, 4.1396266122659, 3.6733866383631977, -0.6309880241751671, -1.2604872435331345, -1.219374418258667, -113.6200882891814, -113.47242523233096, -113.36009834210078, -98.34682315339646, -97.93116230269274, -110.01568492253622, -97.92229056358337, -111.7468672990799, -96.22250244021416, -100.33103216191134, -112.83347453673682, -100.02063452949128, -13.381215438246727, -12.836509972810745, -13.319927409291267, 0.873038123051316, 0.7472407693664138, 1.0267458731929366, -11.444119786222785, -11.221099545558303, -11.450622801979392, -15.410746082663536, -15.80192905664444, -15.08779526501894, -6.095475611587375, -6.174563897152751, -6.182232556243747, -7.826457031071186, -8.240194141864777, -8.000830754637718, -109.25643779834112, -95.24643682440123, -97.04263069232306, -98.28707013527553, -98.28937445084254, -113.10562853018443, -97.02917601664862, -95.30105132361254, -107.87138189872107, -9.01995797703664, -9.1188893566529, -9.197480986515686, -99.92564733823141, -115.77578123410544, -99.99607689430317, -114.363862435023, -121.62700423101585, -111.13915202269952, 10.80811997254689, 11.164262065043047, 10.482056116064385, 3.7413093099991386, 4.241414743165166, 4.4623643603796666, -115.17405871550243, -99.79106158266465, -101.31241921583812, 6.526159671445683, 6.193155338366822, 6.2484700878461155, -106.62828143437704, -94.89098179837069, -95.26268820961317, -1.4809348744650777, -1.8187921245892937, -1.272158271943539, -110.71347618103027, -111.55645841360092, -125.24592959880829, -9.674588421980545, -10.62422362963359, -10.233611668149635, 0.9539426515499656, 1.246820653478295, 0.7773412416378562, -103.11066814263663, -100.56252528595118, -114.82419290145239, -106.18078343073527, -92.62142873803775, -91.85726597408454, 1.3196895370880668, 0.9505791316429679, 1.0570960963765685, -9.582756504416466, -8.826463229954243, -9.15839721262455, -17.021243219574302, -16.874909420808166, -16.666743104656547, 5.859639883041382, 5.992092803120613, 5.853621676564217, -102.88964293400447, -102.58447192112605, -100.88085822264354, -100.41423499087493, -101.06318406263988, -112.33676187197368, -105.45258935292563, -93.27164049943289, -93.01586864267787, -7.649853373567268, -7.516316617528602, -7.714512194196388, -102.96753267447154, -115.7008449236552, -99.86315204451482, -4.170840809742614, -3.5631751815478054, -3.7637792328993527, -11.010012112557888, -11.147617518901825, -11.420982003211975, -20.61344130833944, -20.165981193383537, -20.426599298914276, 4.953661228219659, 5.573655900234968, 5.370690527061612, -4.00887078170976, -4.193668444951385, -3.7508571267438526, -102.16267828146617, -103.60693279902141, -105.91574196020763, -104.29458833982548, -114.08057320614657, -107.36461248000464, -97.04860651493073, -110.26777827739716, -94.49695128574967, -101.61700663963954, -103.60449192921321, -112.71106166640918, -13.282365967830032, -13.613233809669822, -13.162892778714507, 8.472659692168236, 8.89596651494503, 8.848844610154629, -102.1770438750585, -102.38873751958212, -115.63045652707419, -92.09120925267538, -103.32295443614325, -89.45916313429674, -1.2557655274868011, -0.25947578996419907, -0.6081191897392273, 3.9453353037436756, 4.015795183678463, 4.2131325931598695, -103.41010331114134, -101.97773843010268, -116.30173220237097, 2.654506303369999, 2.7940881811082363, 2.224557548761368, -2.2231174161036904, -2.822909792264312, -3.18819119532904, -117.63842868804932, -106.40098775923252, -109.34808510541916, -16.114159919321537, -16.21371003240347, -16.147601664066315, -5.406478313108295, -5.178302941222995, -5.715480079253524, -1.4655376200874741, -1.7686245193084176, -1.3350132827957566, -17.230978113909565, -17.1975546417137, -17.479858872791134, 3.0491394897301944, 3.138237667580441, 3.196196106572941, -95.39045930405459, -107.06473179658255, -94.39207590216151, -14.495490896205112, -14.818732137481376, -14.5934390599529, -102.02686644593875, -102.06068567434947, -115.11881343523662]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16206485694103137, "mean_inference_ms": 0.7065260598421275, "mean_action_processing_ms": 0.09736750159412391, "mean_env_wait_ms": 0.7958547027951219, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 120000, "timesteps_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"sample_time_ms": 10779.6, "sample_throughput": 463.839, "load_time_ms": 0.301, "load_throughput": 16611104.95, "learn_time_ms": 1912.337, "learn_throughput": 2614.602, "update_time_ms": 8.834}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0005000000000000001, "total_loss": 232.31221771240234, "policy_loss": -0.002065138333875982, "vf_loss": 232.36767120361327, "vf_explained_var": 0.25172610878944396, "kl": 0.003681113473433438, "entropy": 5.3391026020050045, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 360000, "num_steps_trained": 120000, "num_agent_steps_trained": 360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 860, "training_iteration": 24, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-05-40", "timestamp": 1706231140, "time_this_iter_s": 10.581570148468018, "time_total_s": 258.4417231082916, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D8C700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 258.4417231082916, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 6.760000000000002, "ram_util_percent": 49.513333333333335}}
{"episode_reward_max": 32.45443815365432, "episode_reward_min": -349.42354308255017, "episode_reward_mean": -148.7723046691832, "episode_len_mean": 314.49, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {"shared_policy": -125.24592959880829}, "policy_reward_max": {"shared_policy": 11.164262065043047}, "policy_reward_mean": {"shared_policy": -49.59076822306107}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.744269147515297, -310.3926144316793, -340.31506514549255, -4.124052766710548, -5.081229574978352, -305.7191716432572, -284.9144511371851, -314.61571088433266, -4.869444634765401, -305.82805770635605, -307.98859109636396, 3.0487839132547094, -292.57574012875557, -349.42354308255017, -58.893751084804556, -285.98758667334914, -288.8218752495013, -1.9404653236270093, -27.89389209449294, -271.91649144887924, -305.35192799568176, -293.50472351908684, 11.565960541367517, -3.1108496859669685, -340.4526118636132, -306.2936703786254, -305.8916603028774, -313.18514122813946, -39.53765282034874, 2.6470247656106665, -34.11584213376048, -46.300470404326916, -18.452272064983873, -24.06748192757368, -301.5455053150654, -309.6820731163025, -300.2016092389822, -27.336328320205226, -315.69750546664, -347.13001868873835, 32.45443815365432, 12.44508841354397, -316.2775395140052, 18.96778509765862, -296.7819514423609, -4.57188527099791, -347.5158641934395, -30.53242371976377, 2.978104546666117, -318.4973863300402, -290.65947814285755, 3.3273647651076033, -27.56761694699526, -50.562895745039015, 17.70535436272621, -306.35497307777405, -313.8141809254885, -291.7400984950364, -22.880682185292258, -318.53152964264154, -11.497795224189773, -33.57861163467169, -61.2060218006372, 15.898007655516238, -11.953396353404997, -311.6853530406952, -325.73977402597666, -301.81333607807755, -317.9325602352619, -40.05849255621436, 26.217470817267895, -320.19623792171484, -284.87332682311535, -2.1233605071902275, 12.174263080582008, -321.689573943615, 7.673152033239603, -8.234218403697042, -333.387501552701, -48.47547161579132, -16.300261333584814, -4.569175422191648, -51.9083916284144, 9.383573263883576, -296.8472670027987, -43.90766209363939, -319.2063655555248, -287.11095756292343, 5.752236369997249, -14.969333365559592, -39.5294032972306, -8.473803007975249, -327.63675850629807, 0.20179353654384613, -300.4607676640153, -43.115170534700155, -297.59104469418526, 3.9514893665909767, 4.5410240739583685, 26.611326772719607], "episode_lengths": [500, 40, 60, 500, 500, 72, 84, 63, 500, 60, 61, 500, 78, 475, 500, 64, 96, 500, 500, 109, 109, 77, 500, 500, 345, 63, 55, 66, 500, 500, 500, 500, 500, 500, 107, 70, 97, 500, 52, 309, 500, 500, 50, 500, 71, 500, 91, 500, 500, 79, 76, 500, 500, 500, 500, 54, 85, 68, 500, 105, 500, 500, 500, 500, 500, 113, 168, 64, 120, 500, 500, 40, 101, 500, 500, 60, 500, 500, 79, 500, 500, 500, 500, 500, 78, 500, 58, 64, 500, 500, 500, 500, 72, 500, 61, 500, 80, 500, 500, 500], "policy_shared_policy_reward": [6.835887789726257, 6.767513066530228, 7.140868291258812, -98.85748643924794, -111.94791146119437, -99.58721653123698, -107.37744238972664, -108.2553308904171, -124.68229186534882, -1.2571875502665932, -1.0646902707715924, -1.8021749456723626, -1.701182633638382, -1.8906599879264832, -1.4893869534134865, -97.27380577226481, -98.02901167174181, -110.41635419925055, -90.48341151575248, -102.69899938503902, -91.73204023639362, -111.17402868469557, -102.00991453727087, -101.43176766236624, -1.6433843175570217, -1.555806970844671, -1.6702533463637081, -110.80092416206996, -97.26848409573238, -97.75864944855373, -97.32175494388989, -111.4504431684812, -99.2163929839929, 1.3653289029995506, 0.9362719456354682, 0.7471830646196906, -106.04211650292079, -93.53818915287654, -92.99543447295825, -119.68969587484996, -115.05302351216476, -114.68082369553547, -19.24281200766564, -19.446889668703086, -20.20404940843583, -94.27284660935402, -93.11786272749305, -98.59687733650208, -91.99550831814608, -106.02730842431387, -90.7990585070414, -0.6037717486421315, -0.922858471671745, -0.4138351033131329, -9.233357613285392, -9.163704668482154, -9.496829812725395, -87.27232935031256, -99.1279345949491, -85.51622750361761, -109.47542115052542, -98.45758750041327, -97.4189193447431, -93.87914967536926, -107.13697147369385, -92.48860237002373, 3.752947290738419, 4.1396266122659, 3.6733866383631977, -0.6309880241751671, -1.2604872435331345, -1.219374418258667, -113.6200882891814, -113.47242523233096, -113.36009834210078, -98.34682315339646, -97.93116230269274, -110.01568492253622, -97.92229056358337, -111.7468672990799, -96.22250244021416, -100.33103216191134, -112.83347453673682, -100.02063452949128, -13.381215438246727, -12.836509972810745, -13.319927409291267, 0.873038123051316, 0.7472407693664138, 1.0267458731929366, -11.444119786222785, -11.221099545558303, -11.450622801979392, -15.410746082663536, -15.80192905664444, -15.08779526501894, -6.095475611587375, -6.174563897152751, -6.182232556243747, -7.826457031071186, -8.240194141864777, -8.000830754637718, -109.25643779834112, -95.24643682440123, -97.04263069232306, -98.28707013527553, -98.28937445084254, -113.10562853018443, -97.02917601664862, -95.30105132361254, -107.87138189872107, -9.01995797703664, -9.1188893566529, -9.197480986515686, -99.92564733823141, -115.77578123410544, -99.99607689430317, -114.363862435023, -121.62700423101585, -111.13915202269952, 10.80811997254689, 11.164262065043047, 10.482056116064385, 3.7413093099991386, 4.241414743165166, 4.4623643603796666, -115.17405871550243, -99.79106158266465, -101.31241921583812, 6.526159671445683, 6.193155338366822, 6.2484700878461155, -106.62828143437704, -94.89098179837069, -95.26268820961317, -1.4809348744650777, -1.8187921245892937, -1.272158271943539, -110.71347618103027, -111.55645841360092, -125.24592959880829, -9.674588421980545, -10.62422362963359, -10.233611668149635, 0.9539426515499656, 1.246820653478295, 0.7773412416378562, -103.11066814263663, -100.56252528595118, -114.82419290145239, -106.18078343073527, -92.62142873803775, -91.85726597408454, 1.3196895370880668, 0.9505791316429679, 1.0570960963765685, -9.582756504416466, -8.826463229954243, -9.15839721262455, -17.021243219574302, -16.874909420808166, -16.666743104656547, 5.859639883041382, 5.992092803120613, 5.853621676564217, -102.88964293400447, -102.58447192112605, -100.88085822264354, -100.41423499087493, -101.06318406263988, -112.33676187197368, -105.45258935292563, -93.27164049943289, -93.01586864267787, -7.649853373567268, -7.516316617528602, -7.714512194196388, -102.96753267447154, -115.7008449236552, -99.86315204451482, -4.170840809742614, -3.5631751815478054, -3.7637792328993527, -11.010012112557888, -11.147617518901825, -11.420982003211975, -20.61344130833944, -20.165981193383537, -20.426599298914276, 4.953661228219659, 5.573655900234968, 5.370690527061612, -4.00887078170976, -4.193668444951385, -3.7508571267438526, -102.16267828146617, -103.60693279902141, -105.91574196020763, -104.29458833982548, -114.08057320614657, -107.36461248000464, -97.04860651493073, -110.26777827739716, -94.49695128574967, -101.61700663963954, -103.60449192921321, -112.71106166640918, -13.282365967830032, -13.613233809669822, -13.162892778714507, 8.472659692168236, 8.89596651494503, 8.848844610154629, -102.1770438750585, -102.38873751958212, -115.63045652707419, -92.09120925267538, -103.32295443614325, -89.45916313429674, -1.2557655274868011, -0.25947578996419907, -0.6081191897392273, 3.9453353037436756, 4.015795183678463, 4.2131325931598695, -103.41010331114134, -101.97773843010268, -116.30173220237097, 2.654506303369999, 2.7940881811082363, 2.224557548761368, -2.2231174161036904, -2.822909792264312, -3.18819119532904, -117.63842868804932, -106.40098775923252, -109.34808510541916, -16.114159919321537, -16.21371003240347, -16.147601664066315, -5.406478313108295, -5.178302941222995, -5.715480079253524, -1.4655376200874741, -1.7686245193084176, -1.3350132827957566, -17.230978113909565, -17.1975546417137, -17.479858872791134, 3.0491394897301944, 3.138237667580441, 3.196196106572941, -95.39045930405459, -107.06473179658255, -94.39207590216151, -14.495490896205112, -14.818732137481376, -14.5934390599529, -102.02686644593875, -102.06068567434947, -115.11881343523662, -97.01903514067332, -92.06709347168605, -98.02482895056407, 2.084379100551203, 1.8245680605371746, 1.843289208908871, -4.787006686131164, -4.925171444813415, -5.257155234615013, -13.084927067160606, -13.546050503849983, -12.898425726220012, -2.960568433006614, -3.093724389870971, -2.419510185097664, -105.57013863325119, -116.49023824930191, -105.57638162374496, 0.07092665880918503, 0.2892735227942467, -0.15840664505958557, -96.63435452679794, -95.89700651417176, -107.92940662304561, -14.423911854624748, -14.536862507462502, -14.154396172612906, -95.95572449763617, -107.08130963643393, -94.55401056011519, 1.388254538178444, 1.3334507122635841, 1.2297841161489487, 1.5815582598249023, 1.4841267938415115, 1.4753390202919547, 8.86729474117358, 9.010477372755602, 8.733554658790425]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16106688442052186, "mean_inference_ms": 0.7061383538195605, "mean_action_processing_ms": 0.09735462936510977, "mean_env_wait_ms": 0.7963270240826976, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 125000, "timesteps_this_iter": 0, "agent_timesteps_total": 375000, "timers": {"sample_time_ms": 10744.349, "sample_throughput": 465.361, "load_time_ms": 0.301, "load_throughput": 16611104.95, "learn_time_ms": 1913.718, "learn_throughput": 2612.715, "update_time_ms": 8.834}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005000000000000001, "total_loss": 211.8412612915039, "policy_loss": -0.0019866518669854117, "vf_loss": 211.89522857666014, "vf_explained_var": 0.2372984230518341, "kl": 0.005029548346649702, "entropy": 5.1981964111328125, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 125000, "num_agent_steps_sampled": 375000, "num_steps_trained": 125000, "num_agent_steps_trained": 375000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 873, "training_iteration": 25, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-05-50", "timestamp": 1706231150, "time_this_iter_s": 10.340821743011475, "time_total_s": 268.7825448513031, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214024E8700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 268.7825448513031, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 6.080000000000001, "ram_util_percent": 49.5}}
{"episode_reward_max": 32.45443815365432, "episode_reward_min": -347.5158641934395, "episode_reward_mean": -135.00603208101123, "episode_len_mean": 328.36, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {"shared_policy": -125.24592959880829}, "policy_reward_max": {"shared_policy": 11.164262065043047}, "policy_reward_mean": {"shared_policy": -45.00201069367042}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.893751084804556, -285.98758667334914, -288.8218752495013, -1.9404653236270093, -27.89389209449294, -271.91649144887924, -305.35192799568176, -293.50472351908684, 11.565960541367517, -3.1108496859669685, -340.4526118636132, -306.2936703786254, -305.8916603028774, -313.18514122813946, -39.53765282034874, 2.6470247656106665, -34.11584213376048, -46.300470404326916, -18.452272064983873, -24.06748192757368, -301.5455053150654, -309.6820731163025, -300.2016092389822, -27.336328320205226, -315.69750546664, -347.13001868873835, 32.45443815365432, 12.44508841354397, -316.2775395140052, 18.96778509765862, -296.7819514423609, -4.57188527099791, -347.5158641934395, -30.53242371976377, 2.978104546666117, -318.4973863300402, -290.65947814285755, 3.3273647651076033, -27.56761694699526, -50.562895745039015, 17.70535436272621, -306.35497307777405, -313.8141809254885, -291.7400984950364, -22.880682185292258, -318.53152964264154, -11.497795224189773, -33.57861163467169, -61.2060218006372, 15.898007655516238, -11.953396353404997, -311.6853530406952, -325.73977402597666, -301.81333607807755, -317.9325602352619, -40.05849255621436, 26.217470817267895, -320.19623792171484, -284.87332682311535, -2.1233605071902275, 12.174263080582008, -321.689573943615, 7.673152033239603, -8.234218403697042, -333.387501552701, -48.47547161579132, -16.300261333584814, -4.569175422191648, -51.9083916284144, 9.383573263883576, -296.8472670027987, -43.90766209363939, -319.2063655555248, -287.11095756292343, 5.752236369997249, -14.969333365559592, -39.5294032972306, -8.473803007975249, -327.63675850629807, 0.20179353654384613, -300.4607676640153, -43.115170534700155, -297.59104469418526, 3.9514893665909767, 4.5410240739583685, 26.611326772719607, 5.986404605209813, -284.94380562752485, 5.655734173953505, 5.9155746474861814, -271.7790288850665, 0.17160606384277344, -258.9237107411027, -296.3683594763279, 2.69897054135798, 1.0471768155694008, -17.593991756439223, -22.96338614821434, 23.95588719239457, -318.28643175959587], "episode_lengths": [500, 64, 96, 500, 500, 109, 109, 77, 500, 500, 345, 63, 55, 66, 500, 500, 500, 500, 500, 500, 107, 70, 97, 500, 52, 309, 500, 500, 50, 500, 71, 500, 91, 500, 500, 79, 76, 500, 500, 500, 500, 54, 85, 68, 500, 105, 500, 500, 500, 500, 500, 113, 168, 64, 120, 500, 500, 40, 101, 500, 500, 60, 500, 500, 79, 500, 500, 500, 500, 500, 78, 500, 58, 64, 500, 500, 500, 500, 72, 500, 61, 500, 80, 500, 500, 500, 500, 75, 500, 500, 82, 500, 118, 67, 500, 500, 500, 500, 500, 38], "policy_shared_policy_reward": [-19.24281200766564, -19.446889668703086, -20.20404940843583, -94.27284660935402, -93.11786272749305, -98.59687733650208, -91.99550831814608, -106.02730842431387, -90.7990585070414, -0.6037717486421315, -0.922858471671745, -0.4138351033131329, -9.233357613285392, -9.163704668482154, -9.496829812725395, -87.27232935031256, -99.1279345949491, -85.51622750361761, -109.47542115052542, -98.45758750041327, -97.4189193447431, -93.87914967536926, -107.13697147369385, -92.48860237002373, 3.752947290738419, 4.1396266122659, 3.6733866383631977, -0.6309880241751671, -1.2604872435331345, -1.219374418258667, -113.6200882891814, -113.47242523233096, -113.36009834210078, -98.34682315339646, -97.93116230269274, -110.01568492253622, -97.92229056358337, -111.7468672990799, -96.22250244021416, -100.33103216191134, -112.83347453673682, -100.02063452949128, -13.381215438246727, -12.836509972810745, -13.319927409291267, 0.873038123051316, 0.7472407693664138, 1.0267458731929366, -11.444119786222785, -11.221099545558303, -11.450622801979392, -15.410746082663536, -15.80192905664444, -15.08779526501894, -6.095475611587375, -6.174563897152751, -6.182232556243747, -7.826457031071186, -8.240194141864777, -8.000830754637718, -109.25643779834112, -95.24643682440123, -97.04263069232306, -98.28707013527553, -98.28937445084254, -113.10562853018443, -97.02917601664862, -95.30105132361254, -107.87138189872107, -9.01995797703664, -9.1188893566529, -9.197480986515686, -99.92564733823141, -115.77578123410544, -99.99607689430317, -114.363862435023, -121.62700423101585, -111.13915202269952, 10.80811997254689, 11.164262065043047, 10.482056116064385, 3.7413093099991386, 4.241414743165166, 4.4623643603796666, -115.17405871550243, -99.79106158266465, -101.31241921583812, 6.526159671445683, 6.193155338366822, 6.2484700878461155, -106.62828143437704, -94.89098179837069, -95.26268820961317, -1.4809348744650777, -1.8187921245892937, -1.272158271943539, -110.71347618103027, -111.55645841360092, -125.24592959880829, -9.674588421980545, -10.62422362963359, -10.233611668149635, 0.9539426515499656, 1.246820653478295, 0.7773412416378562, -103.11066814263663, -100.56252528595118, -114.82419290145239, -106.18078343073527, -92.62142873803775, -91.85726597408454, 1.3196895370880668, 0.9505791316429679, 1.0570960963765685, -9.582756504416466, -8.826463229954243, -9.15839721262455, -17.021243219574302, -16.874909420808166, -16.666743104656547, 5.859639883041382, 5.992092803120613, 5.853621676564217, -102.88964293400447, -102.58447192112605, -100.88085822264354, -100.41423499087493, -101.06318406263988, -112.33676187197368, -105.45258935292563, -93.27164049943289, -93.01586864267787, -7.649853373567268, -7.516316617528602, -7.714512194196388, -102.96753267447154, -115.7008449236552, -99.86315204451482, -4.170840809742614, -3.5631751815478054, -3.7637792328993527, -11.010012112557888, -11.147617518901825, -11.420982003211975, -20.61344130833944, -20.165981193383537, -20.426599298914276, 4.953661228219659, 5.573655900234968, 5.370690527061612, -4.00887078170976, -4.193668444951385, -3.7508571267438526, -102.16267828146617, -103.60693279902141, -105.91574196020763, -104.29458833982548, -114.08057320614657, -107.36461248000464, -97.04860651493073, -110.26777827739716, -94.49695128574967, -101.61700663963954, -103.60449192921321, -112.71106166640918, -13.282365967830032, -13.613233809669822, -13.162892778714507, 8.472659692168236, 8.89596651494503, 8.848844610154629, -102.1770438750585, -102.38873751958212, -115.63045652707419, -92.09120925267538, -103.32295443614325, -89.45916313429674, -1.2557655274868011, -0.25947578996419907, -0.6081191897392273, 3.9453353037436756, 4.015795183678463, 4.2131325931598695, -103.41010331114134, -101.97773843010268, -116.30173220237097, 2.654506303369999, 2.7940881811082363, 2.224557548761368, -2.2231174161036904, -2.822909792264312, -3.18819119532904, -117.63842868804932, -106.40098775923252, -109.34808510541916, -16.114159919321537, -16.21371003240347, -16.147601664066315, -5.406478313108295, -5.178302941222995, -5.715480079253524, -1.4655376200874741, -1.7686245193084176, -1.3350132827957566, -17.230978113909565, -17.1975546417137, -17.479858872791134, 3.0491394897301944, 3.138237667580441, 3.196196106572941, -95.39045930405459, -107.06473179658255, -94.39207590216151, -14.495490896205112, -14.818732137481376, -14.5934390599529, -102.02686644593875, -102.06068567434947, -115.11881343523662, -97.01903514067332, -92.06709347168605, -98.02482895056407, 2.084379100551203, 1.8245680605371746, 1.843289208908871, -4.787006686131164, -4.925171444813415, -5.257155234615013, -13.084927067160606, -13.546050503849983, -12.898425726220012, -2.960568433006614, -3.093724389870971, -2.419510185097664, -105.57013863325119, -116.49023824930191, -105.57638162374496, 0.07092665880918503, 0.2892735227942467, -0.15840664505958557, -96.63435452679794, -95.89700651417176, -107.92940662304561, -14.423911854624748, -14.536862507462502, -14.154396172612906, -95.95572449763617, -107.08130963643393, -94.55401056011519, 1.388254538178444, 1.3334507122635841, 1.2297841161489487, 1.5815582598249023, 1.4841267938415115, 1.4753390202919547, 8.86729474117358, 9.010477372755602, 8.733554658790425, 2.221119639774159, 2.078137521942452, 1.6871474434932026, -90.49312657117844, -89.14097594469786, -105.30970311164856, 2.161931584278733, 1.9481395209828918, 1.54566306869188, 2.0293881098429267, 2.031106847027928, 1.8550796906153266, -100.52122871081035, -86.08248415092628, -85.1753160233299, 0.08698636293411255, 0.08336389064788818, 0.001255810260772705, -90.68911596139273, -84.14717885603508, -84.08741592367491, -107.25202610095343, -95.2261190613111, -93.8902143140634, 0.9036630739768299, 0.9942780410249981, 0.8010294263561519, 0.40761419385671616, 0.24630379676818848, 0.39325882494449615, -5.693223314980671, -5.777261170248195, -6.123507271210357, -7.540777303278446, -7.601223789155483, -7.821385055780411, 8.152082715959594, 7.745994848509625, 8.057809627925351, -103.59501566489539, -101.45328234632811, -113.2381337483724]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1599475024378093, "mean_inference_ms": 0.7043217250952432, "mean_action_processing_ms": 0.09704577375014231, "mean_env_wait_ms": 0.7964786961610588, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 130000, "timesteps_this_iter": 0, "agent_timesteps_total": 390000, "timers": {"sample_time_ms": 10685.964, "sample_throughput": 467.904, "load_time_ms": 0.2, "load_throughput": 24995852.205, "learn_time_ms": 1915.033, "learn_throughput": 2610.921, "update_time_ms": 8.734}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005000000000000001, "total_loss": 212.6466537475586, "policy_loss": -0.0029541800651078807, "vf_loss": 212.7024688720703, "vf_explained_var": 0.31414944529533384, "kl": 0.003924790237217935, "entropy": 5.286754941940307, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 130000, "num_agent_steps_sampled": 390000, "num_steps_trained": 130000, "num_agent_steps_trained": 390000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 887, "training_iteration": 26, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-06-01", "timestamp": 1706231161, "time_this_iter_s": 10.30029034614563, "time_total_s": 279.08283519744873, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021404232DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 279.08283519744873, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 4.885714285714286, "ram_util_percent": 49.55000000000001}}
{"episode_reward_max": 32.45443815365432, "episode_reward_min": -347.5158641934395, "episode_reward_mean": -123.64373665961669, "episode_len_mean": 341.66, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -125.24592959880829}, "policy_reward_max": {"shared_policy": 11.164262065043047}, "policy_reward_mean": {"shared_policy": -41.21457888653891}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-305.8916603028774, -313.18514122813946, -39.53765282034874, 2.6470247656106665, -34.11584213376048, -46.300470404326916, -18.452272064983873, -24.06748192757368, -301.5455053150654, -309.6820731163025, -300.2016092389822, -27.336328320205226, -315.69750546664, -347.13001868873835, 32.45443815365432, 12.44508841354397, -316.2775395140052, 18.96778509765862, -296.7819514423609, -4.57188527099791, -347.5158641934395, -30.53242371976377, 2.978104546666117, -318.4973863300402, -290.65947814285755, 3.3273647651076033, -27.56761694699526, -50.562895745039015, 17.70535436272621, -306.35497307777405, -313.8141809254885, -291.7400984950364, -22.880682185292258, -318.53152964264154, -11.497795224189773, -33.57861163467169, -61.2060218006372, 15.898007655516238, -11.953396353404997, -311.6853530406952, -325.73977402597666, -301.81333607807755, -317.9325602352619, -40.05849255621436, 26.217470817267895, -320.19623792171484, -284.87332682311535, -2.1233605071902275, 12.174263080582008, -321.689573943615, 7.673152033239603, -8.234218403697042, -333.387501552701, -48.47547161579132, -16.300261333584814, -4.569175422191648, -51.9083916284144, 9.383573263883576, -296.8472670027987, -43.90766209363939, -319.2063655555248, -287.11095756292343, 5.752236369997249, -14.969333365559592, -39.5294032972306, -8.473803007975249, -327.63675850629807, 0.20179353654384613, -300.4607676640153, -43.115170534700155, -297.59104469418526, 3.9514893665909767, 4.5410240739583685, 26.611326772719607, 5.986404605209813, -284.94380562752485, 5.655734173953505, 5.9155746474861814, -271.7790288850665, 0.17160606384277344, -258.9237107411027, -296.3683594763279, 2.69897054135798, 1.0471768155694008, -17.593991756439223, -22.96338614821434, 23.95588719239457, -318.28643175959587, -21.522114969789982, 14.825856879353523, 7.33997785300015, -21.32010287418963, 12.915048263967037, -8.612019941210747, -24.866759307682543, -300.2365637719631, -316.80732700228697, -290.75425330363214, -47.571655195206404, -39.762429267168045], "episode_lengths": [55, 66, 500, 500, 500, 500, 500, 500, 107, 70, 97, 500, 52, 309, 500, 500, 50, 500, 71, 500, 91, 500, 500, 79, 76, 500, 500, 500, 500, 54, 85, 68, 500, 105, 500, 500, 500, 500, 500, 113, 168, 64, 120, 500, 500, 40, 101, 500, 500, 60, 500, 500, 79, 500, 500, 500, 500, 500, 78, 500, 58, 64, 500, 500, 500, 500, 72, 500, 61, 500, 80, 500, 500, 500, 500, 75, 500, 500, 82, 500, 118, 67, 500, 500, 500, 500, 500, 38, 500, 500, 500, 500, 500, 500, 500, 67, 65, 61, 500, 500], "policy_shared_policy_reward": [-97.92229056358337, -111.7468672990799, -96.22250244021416, -100.33103216191134, -112.83347453673682, -100.02063452949128, -13.381215438246727, -12.836509972810745, -13.319927409291267, 0.873038123051316, 0.7472407693664138, 1.0267458731929366, -11.444119786222785, -11.221099545558303, -11.450622801979392, -15.410746082663536, -15.80192905664444, -15.08779526501894, -6.095475611587375, -6.174563897152751, -6.182232556243747, -7.826457031071186, -8.240194141864777, -8.000830754637718, -109.25643779834112, -95.24643682440123, -97.04263069232306, -98.28707013527553, -98.28937445084254, -113.10562853018443, -97.02917601664862, -95.30105132361254, -107.87138189872107, -9.01995797703664, -9.1188893566529, -9.197480986515686, -99.92564733823141, -115.77578123410544, -99.99607689430317, -114.363862435023, -121.62700423101585, -111.13915202269952, 10.80811997254689, 11.164262065043047, 10.482056116064385, 3.7413093099991386, 4.241414743165166, 4.4623643603796666, -115.17405871550243, -99.79106158266465, -101.31241921583812, 6.526159671445683, 6.193155338366822, 6.2484700878461155, -106.62828143437704, -94.89098179837069, -95.26268820961317, -1.4809348744650777, -1.8187921245892937, -1.272158271943539, -110.71347618103027, -111.55645841360092, -125.24592959880829, -9.674588421980545, -10.62422362963359, -10.233611668149635, 0.9539426515499656, 1.246820653478295, 0.7773412416378562, -103.11066814263663, -100.56252528595118, -114.82419290145239, -106.18078343073527, -92.62142873803775, -91.85726597408454, 1.3196895370880668, 0.9505791316429679, 1.0570960963765685, -9.582756504416466, -8.826463229954243, -9.15839721262455, -17.021243219574302, -16.874909420808166, -16.666743104656547, 5.859639883041382, 5.992092803120613, 5.853621676564217, -102.88964293400447, -102.58447192112605, -100.88085822264354, -100.41423499087493, -101.06318406263988, -112.33676187197368, -105.45258935292563, -93.27164049943289, -93.01586864267787, -7.649853373567268, -7.516316617528602, -7.714512194196388, -102.96753267447154, -115.7008449236552, -99.86315204451482, -4.170840809742614, -3.5631751815478054, -3.7637792328993527, -11.010012112557888, -11.147617518901825, -11.420982003211975, -20.61344130833944, -20.165981193383537, -20.426599298914276, 4.953661228219659, 5.573655900234968, 5.370690527061612, -4.00887078170976, -4.193668444951385, -3.7508571267438526, -102.16267828146617, -103.60693279902141, -105.91574196020763, -104.29458833982548, -114.08057320614657, -107.36461248000464, -97.04860651493073, -110.26777827739716, -94.49695128574967, -101.61700663963954, -103.60449192921321, -112.71106166640918, -13.282365967830032, -13.613233809669822, -13.162892778714507, 8.472659692168236, 8.89596651494503, 8.848844610154629, -102.1770438750585, -102.38873751958212, -115.63045652707419, -92.09120925267538, -103.32295443614325, -89.45916313429674, -1.2557655274868011, -0.25947578996419907, -0.6081191897392273, 3.9453353037436756, 4.015795183678463, 4.2131325931598695, -103.41010331114134, -101.97773843010268, -116.30173220237097, 2.654506303369999, 2.7940881811082363, 2.224557548761368, -2.2231174161036904, -2.822909792264312, -3.18819119532904, -117.63842868804932, -106.40098775923252, -109.34808510541916, -16.114159919321537, -16.21371003240347, -16.147601664066315, -5.406478313108295, -5.178302941222995, -5.715480079253524, -1.4655376200874741, -1.7686245193084176, -1.3350132827957566, -17.230978113909565, -17.1975546417137, -17.479858872791134, 3.0491394897301944, 3.138237667580441, 3.196196106572941, -95.39045930405459, -107.06473179658255, -94.39207590216151, -14.495490896205112, -14.818732137481376, -14.5934390599529, -102.02686644593875, -102.06068567434947, -115.11881343523662, -97.01903514067332, -92.06709347168605, -98.02482895056407, 2.084379100551203, 1.8245680605371746, 1.843289208908871, -4.787006686131164, -4.925171444813415, -5.257155234615013, -13.084927067160606, -13.546050503849983, -12.898425726220012, -2.960568433006614, -3.093724389870971, -2.419510185097664, -105.57013863325119, -116.49023824930191, -105.57638162374496, 0.07092665880918503, 0.2892735227942467, -0.15840664505958557, -96.63435452679794, -95.89700651417176, -107.92940662304561, -14.423911854624748, -14.536862507462502, -14.154396172612906, -95.95572449763617, -107.08130963643393, -94.55401056011519, 1.388254538178444, 1.3334507122635841, 1.2297841161489487, 1.5815582598249023, 1.4841267938415115, 1.4753390202919547, 8.86729474117358, 9.010477372755602, 8.733554658790425, 2.221119639774159, 2.078137521942452, 1.6871474434932026, -90.49312657117844, -89.14097594469786, -105.30970311164856, 2.161931584278733, 1.9481395209828918, 1.54566306869188, 2.0293881098429267, 2.031106847027928, 1.8550796906153266, -100.52122871081035, -86.08248415092628, -85.1753160233299, 0.08698636293411255, 0.08336389064788818, 0.001255810260772705, -90.68911596139273, -84.14717885603508, -84.08741592367491, -107.25202610095343, -95.2261190613111, -93.8902143140634, 0.9036630739768299, 0.9942780410249981, 0.8010294263561519, 0.40761419385671616, 0.24630379676818848, 0.39325882494449615, -5.693223314980671, -5.777261170248195, -6.123507271210357, -7.540777303278446, -7.601223789155483, -7.821385055780411, 8.152082715959594, 7.745994848509625, 8.057809627925351, -103.59501566489539, -101.45328234632811, -113.2381337483724, -7.456342846155167, -6.503187872469425, -7.56258425116539, 5.095379739999771, 4.935703217983246, 4.794773921370506, 2.4927179788549694, 2.140393768747643, 2.7068661053975376, -7.146050820748016, -7.206241490940258, -6.967810562501356, 4.542238116264343, 4.5649344101548195, 3.8078757375478745, -2.9435227811336517, -2.518296167254448, -3.150200992822647, -7.876177323361247, -7.926302408178657, -9.064279576142638, -96.00300444165866, -96.08749953905742, -108.14605979124705, -113.47182508309683, -101.6960249443849, -101.6394769748052, -93.02604191253583, -105.05944554011027, -92.66876585098605, -15.718129836022854, -15.638336185365915, -16.215189173817635, -13.34271801263094, -13.311305843293667, -13.108405411243439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15915960646000127, "mean_inference_ms": 0.703174401477021, "mean_action_processing_ms": 0.09694526168580023, "mean_env_wait_ms": 0.7963892236862834, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 135000, "timesteps_this_iter": 0, "agent_timesteps_total": 405000, "timers": {"sample_time_ms": 10673.364, "sample_throughput": 468.456, "load_time_ms": 0.2, "load_throughput": 24995852.205, "learn_time_ms": 1908.092, "learn_throughput": 2620.419, "update_time_ms": 8.714}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005000000000000001, "total_loss": 163.68767700195312, "policy_loss": -0.0017537823993572844, "vf_loss": 163.74319152832032, "vf_explained_var": 0.24210548400878906, "kl": 0.0050638618355176345, "entropy": 5.375599431991577, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 135000, "num_agent_steps_sampled": 405000, "num_steps_trained": 135000, "num_agent_steps_trained": 405000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 899, "training_iteration": 27, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-06-11", "timestamp": 1706231171, "time_this_iter_s": 10.527669906616211, "time_total_s": 289.61050510406494, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D47790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 289.61050510406494, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 8.44, "ram_util_percent": 49.55333333333335}}
{"episode_reward_max": 32.45443815365432, "episode_reward_min": -347.5158641934395, "episode_reward_mean": -113.55952285159611, "episode_len_mean": 354.65, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -125.24592959880829}, "policy_reward_max": {"shared_policy": 11.164262065043047}, "policy_reward_mean": {"shared_policy": -37.85317428386538}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-315.69750546664, -347.13001868873835, 32.45443815365432, 12.44508841354397, -316.2775395140052, 18.96778509765862, -296.7819514423609, -4.57188527099791, -347.5158641934395, -30.53242371976377, 2.978104546666117, -318.4973863300402, -290.65947814285755, 3.3273647651076033, -27.56761694699526, -50.562895745039015, 17.70535436272621, -306.35497307777405, -313.8141809254885, -291.7400984950364, -22.880682185292258, -318.53152964264154, -11.497795224189773, -33.57861163467169, -61.2060218006372, 15.898007655516238, -11.953396353404997, -311.6853530406952, -325.73977402597666, -301.81333607807755, -317.9325602352619, -40.05849255621436, 26.217470817267895, -320.19623792171484, -284.87332682311535, -2.1233605071902275, 12.174263080582008, -321.689573943615, 7.673152033239603, -8.234218403697042, -333.387501552701, -48.47547161579132, -16.300261333584814, -4.569175422191648, -51.9083916284144, 9.383573263883576, -296.8472670027987, -43.90766209363939, -319.2063655555248, -287.11095756292343, 5.752236369997249, -14.969333365559592, -39.5294032972306, -8.473803007975249, -327.63675850629807, 0.20179353654384613, -300.4607676640153, -43.115170534700155, -297.59104469418526, 3.9514893665909767, 4.5410240739583685, 26.611326772719607, 5.986404605209813, -284.94380562752485, 5.655734173953505, 5.9155746474861814, -271.7790288850665, 0.17160606384277344, -258.9237107411027, -296.3683594763279, 2.69897054135798, 1.0471768155694008, -17.593991756439223, -22.96338614821434, 23.95588719239457, -318.28643175959587, -21.522114969789982, 14.825856879353523, 7.33997785300015, -21.32010287418963, 12.915048263967037, -8.612019941210747, -24.866759307682543, -300.2365637719631, -316.80732700228697, -290.75425330363214, -47.571655195206404, -39.762429267168045, 7.814629230648251, 0.264447323977933, 16.102820865809917, -41.07256668806076, -9.057385906577139, -4.13394878245893, 25.656271330080912, -32.41828387975694, -319.3050322234631, -25.355210760608344, -326.94068644195795, -0.8026853725314282], "episode_lengths": [52, 309, 500, 500, 50, 500, 71, 500, 91, 500, 500, 79, 76, 500, 500, 500, 500, 54, 85, 68, 500, 105, 500, 500, 500, 500, 500, 113, 168, 64, 120, 500, 500, 40, 101, 500, 500, 60, 500, 500, 79, 500, 500, 500, 500, 500, 78, 500, 58, 64, 500, 500, 500, 500, 72, 500, 61, 500, 80, 500, 500, 500, 500, 75, 500, 500, 82, 500, 118, 67, 500, 500, 500, 500, 500, 38, 500, 500, 500, 500, 500, 500, 500, 67, 65, 61, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 138, 500, 56, 500], "policy_shared_policy_reward": [-99.92564733823141, -115.77578123410544, -99.99607689430317, -114.363862435023, -121.62700423101585, -111.13915202269952, 10.80811997254689, 11.164262065043047, 10.482056116064385, 3.7413093099991386, 4.241414743165166, 4.4623643603796666, -115.17405871550243, -99.79106158266465, -101.31241921583812, 6.526159671445683, 6.193155338366822, 6.2484700878461155, -106.62828143437704, -94.89098179837069, -95.26268820961317, -1.4809348744650777, -1.8187921245892937, -1.272158271943539, -110.71347618103027, -111.55645841360092, -125.24592959880829, -9.674588421980545, -10.62422362963359, -10.233611668149635, 0.9539426515499656, 1.246820653478295, 0.7773412416378562, -103.11066814263663, -100.56252528595118, -114.82419290145239, -106.18078343073527, -92.62142873803775, -91.85726597408454, 1.3196895370880668, 0.9505791316429679, 1.0570960963765685, -9.582756504416466, -8.826463229954243, -9.15839721262455, -17.021243219574302, -16.874909420808166, -16.666743104656547, 5.859639883041382, 5.992092803120613, 5.853621676564217, -102.88964293400447, -102.58447192112605, -100.88085822264354, -100.41423499087493, -101.06318406263988, -112.33676187197368, -105.45258935292563, -93.27164049943289, -93.01586864267787, -7.649853373567268, -7.516316617528602, -7.714512194196388, -102.96753267447154, -115.7008449236552, -99.86315204451482, -4.170840809742614, -3.5631751815478054, -3.7637792328993527, -11.010012112557888, -11.147617518901825, -11.420982003211975, -20.61344130833944, -20.165981193383537, -20.426599298914276, 4.953661228219659, 5.573655900234968, 5.370690527061612, -4.00887078170976, -4.193668444951385, -3.7508571267438526, -102.16267828146617, -103.60693279902141, -105.91574196020763, -104.29458833982548, -114.08057320614657, -107.36461248000464, -97.04860651493073, -110.26777827739716, -94.49695128574967, -101.61700663963954, -103.60449192921321, -112.71106166640918, -13.282365967830032, -13.613233809669822, -13.162892778714507, 8.472659692168236, 8.89596651494503, 8.848844610154629, -102.1770438750585, -102.38873751958212, -115.63045652707419, -92.09120925267538, -103.32295443614325, -89.45916313429674, -1.2557655274868011, -0.25947578996419907, -0.6081191897392273, 3.9453353037436756, 4.015795183678463, 4.2131325931598695, -103.41010331114134, -101.97773843010268, -116.30173220237097, 2.654506303369999, 2.7940881811082363, 2.224557548761368, -2.2231174161036904, -2.822909792264312, -3.18819119532904, -117.63842868804932, -106.40098775923252, -109.34808510541916, -16.114159919321537, -16.21371003240347, -16.147601664066315, -5.406478313108295, -5.178302941222995, -5.715480079253524, -1.4655376200874741, -1.7686245193084176, -1.3350132827957566, -17.230978113909565, -17.1975546417137, -17.479858872791134, 3.0491394897301944, 3.138237667580441, 3.196196106572941, -95.39045930405459, -107.06473179658255, -94.39207590216151, -14.495490896205112, -14.818732137481376, -14.5934390599529, -102.02686644593875, -102.06068567434947, -115.11881343523662, -97.01903514067332, -92.06709347168605, -98.02482895056407, 2.084379100551203, 1.8245680605371746, 1.843289208908871, -4.787006686131164, -4.925171444813415, -5.257155234615013, -13.084927067160606, -13.546050503849983, -12.898425726220012, -2.960568433006614, -3.093724389870971, -2.419510185097664, -105.57013863325119, -116.49023824930191, -105.57638162374496, 0.07092665880918503, 0.2892735227942467, -0.15840664505958557, -96.63435452679794, -95.89700651417176, -107.92940662304561, -14.423911854624748, -14.536862507462502, -14.154396172612906, -95.95572449763617, -107.08130963643393, -94.55401056011519, 1.388254538178444, 1.3334507122635841, 1.2297841161489487, 1.5815582598249023, 1.4841267938415115, 1.4753390202919547, 8.86729474117358, 9.010477372755602, 8.733554658790425, 2.221119639774159, 2.078137521942452, 1.6871474434932026, -90.49312657117844, -89.14097594469786, -105.30970311164856, 2.161931584278733, 1.9481395209828918, 1.54566306869188, 2.0293881098429267, 2.031106847027928, 1.8550796906153266, -100.52122871081035, -86.08248415092628, -85.1753160233299, 0.08698636293411255, 0.08336389064788818, 0.001255810260772705, -90.68911596139273, -84.14717885603508, -84.08741592367491, -107.25202610095343, -95.2261190613111, -93.8902143140634, 0.9036630739768299, 0.9942780410249981, 0.8010294263561519, 0.40761419385671616, 0.24630379676818848, 0.39325882494449615, -5.693223314980671, -5.777261170248195, -6.123507271210357, -7.540777303278446, -7.601223789155483, -7.821385055780411, 8.152082715959594, 7.745994848509625, 8.057809627925351, -103.59501566489539, -101.45328234632811, -113.2381337483724, -7.456342846155167, -6.503187872469425, -7.56258425116539, 5.095379739999771, 4.935703217983246, 4.794773921370506, 2.4927179788549694, 2.140393768747643, 2.7068661053975376, -7.146050820748016, -7.206241490940258, -6.967810562501356, 4.542238116264343, 4.5649344101548195, 3.8078757375478745, -2.9435227811336517, -2.518296167254448, -3.150200992822647, -7.876177323361247, -7.926302408178657, -9.064279576142638, -96.00300444165866, -96.08749953905742, -108.14605979124705, -113.47182508309683, -101.6960249443849, -101.6394769748052, -93.02604191253583, -105.05944554011027, -92.66876585098605, -15.718129836022854, -15.638336185365915, -16.215189173817635, -13.34271801263094, -13.311305843293667, -13.108405411243439, 2.6639484564463203, 2.733729495356471, 2.4169512788454597, 0.15596147378285252, 0.11528625835974537, -0.006800408164664873, 5.491061858832836, 5.3505669683218, 5.261192038655281, -13.323193699121475, -13.545406371355057, -14.203966617584229, -2.8282846709092553, -2.9050813068946297, -3.3240199287732537, -1.3947156493862565, -1.8056079049905236, -0.9336252280821498, 8.753898938496903, 9.25190399245669, 7.65046839912732, -10.278921718398735, -10.575598026315376, -11.563764135042831, -102.23309959967932, -103.25190942486128, -113.82002319892248, -8.611877237757056, -8.544904564817756, -8.198428958033531, -104.40136748055617, -103.9578918243448, -118.58142713705699, -0.1755402783552853, -0.4707819024721829, -0.15636319170396007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15821539779981914, "mean_inference_ms": 0.7021019628119128, "mean_action_processing_ms": 0.09667996442092348, "mean_env_wait_ms": 0.7965149467116416, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 140000, "timesteps_this_iter": 0, "agent_timesteps_total": 420000, "timers": {"sample_time_ms": 10536.447, "sample_throughput": 474.543, "load_time_ms": 0.1, "load_throughput": 50003624.225, "learn_time_ms": 1904.763, "learn_throughput": 2624.998, "update_time_ms": 8.793}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005000000000000001, "total_loss": 162.54137725830077, "policy_loss": -0.0028908290997519794, "vf_loss": 162.59764556884767, "vf_explained_var": 0.08775834441184997, "kl": 0.005261014192367209, "entropy": 5.337735414505005, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 140000, "num_agent_steps_sampled": 420000, "num_steps_trained": 140000, "num_agent_steps_trained": 420000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 911, "training_iteration": 28, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-06-22", "timestamp": 1706231182, "time_this_iter_s": 10.444483518600464, "time_total_s": 300.0549886226654, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402DF0E50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 300.0549886226654, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 7.113333333333333, "ram_util_percent": 49.62666666666667}}
{"episode_reward_max": 46.03141586203125, "episode_reward_min": -351.60241919755936, "episode_reward_mean": -106.12549311292358, "episode_len_mean": 363.16, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {"shared_policy": -124.51506223281226}, "policy_reward_max": {"shared_policy": 15.562446377860994}, "policy_reward_mean": {"shared_policy": -35.37516437097454}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.562895745039015, 17.70535436272621, -306.35497307777405, -313.8141809254885, -291.7400984950364, -22.880682185292258, -318.53152964264154, -11.497795224189773, -33.57861163467169, -61.2060218006372, 15.898007655516238, -11.953396353404997, -311.6853530406952, -325.73977402597666, -301.81333607807755, -317.9325602352619, -40.05849255621436, 26.217470817267895, -320.19623792171484, -284.87332682311535, -2.1233605071902275, 12.174263080582008, -321.689573943615, 7.673152033239603, -8.234218403697042, -333.387501552701, -48.47547161579132, -16.300261333584814, -4.569175422191648, -51.9083916284144, 9.383573263883576, -296.8472670027987, -43.90766209363939, -319.2063655555248, -287.11095756292343, 5.752236369997249, -14.969333365559592, -39.5294032972306, -8.473803007975249, -327.63675850629807, 0.20179353654384613, -300.4607676640153, -43.115170534700155, -297.59104469418526, 3.9514893665909767, 4.5410240739583685, 26.611326772719607, 5.986404605209813, -284.94380562752485, 5.655734173953505, 5.9155746474861814, -271.7790288850665, 0.17160606384277344, -258.9237107411027, -296.3683594763279, 2.69897054135798, 1.0471768155694008, -17.593991756439223, -22.96338614821434, 23.95588719239457, -318.28643175959587, -21.522114969789982, 14.825856879353523, 7.33997785300015, -21.32010287418963, 12.915048263967037, -8.612019941210747, -24.866759307682543, -300.2365637719631, -316.80732700228697, -290.75425330363214, -47.571655195206404, -39.762429267168045, 7.814629230648251, 0.264447323977933, 16.102820865809917, -41.07256668806076, -9.057385906577139, -4.13394878245893, 25.656271330080912, -32.41828387975694, -319.3050322234631, -25.355210760608344, -326.94068644195795, -0.8026853725314282, 46.03141586203125, -321.9484675079584, 6.049376033246503, 6.565026193857165, 2.6398298516869403, -25.489062685519457, -299.91381994262343, 22.728961139917345, -307.7800045013428, -4.2643356136977815, -351.60241919755936, 7.571359504014239, 6.533841535449014, -274.9390154853463, 6.161399941891432], "episode_lengths": [500, 500, 54, 85, 68, 500, 105, 500, 500, 500, 500, 500, 113, 168, 64, 120, 500, 500, 40, 101, 500, 500, 60, 500, 500, 79, 500, 500, 500, 500, 500, 78, 500, 58, 64, 500, 500, 500, 500, 72, 500, 61, 500, 80, 500, 500, 500, 500, 75, 500, 500, 82, 500, 118, 67, 500, 500, 500, 500, 500, 38, 500, 500, 500, 500, 500, 500, 500, 67, 65, 61, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 138, 500, 56, 500, 500, 220, 500, 500, 500, 500, 61, 500, 70, 500, 133, 500, 500, 95, 500], "policy_shared_policy_reward": [-17.021243219574302, -16.874909420808166, -16.666743104656547, 5.859639883041382, 5.992092803120613, 5.853621676564217, -102.88964293400447, -102.58447192112605, -100.88085822264354, -100.41423499087493, -101.06318406263988, -112.33676187197368, -105.45258935292563, -93.27164049943289, -93.01586864267787, -7.649853373567268, -7.516316617528602, -7.714512194196388, -102.96753267447154, -115.7008449236552, -99.86315204451482, -4.170840809742614, -3.5631751815478054, -3.7637792328993527, -11.010012112557888, -11.147617518901825, -11.420982003211975, -20.61344130833944, -20.165981193383537, -20.426599298914276, 4.953661228219659, 5.573655900234968, 5.370690527061612, -4.00887078170976, -4.193668444951385, -3.7508571267438526, -102.16267828146617, -103.60693279902141, -105.91574196020763, -104.29458833982548, -114.08057320614657, -107.36461248000464, -97.04860651493073, -110.26777827739716, -94.49695128574967, -101.61700663963954, -103.60449192921321, -112.71106166640918, -13.282365967830032, -13.613233809669822, -13.162892778714507, 8.472659692168236, 8.89596651494503, 8.848844610154629, -102.1770438750585, -102.38873751958212, -115.63045652707419, -92.09120925267538, -103.32295443614325, -89.45916313429674, -1.2557655274868011, -0.25947578996419907, -0.6081191897392273, 3.9453353037436756, 4.015795183678463, 4.2131325931598695, -103.41010331114134, -101.97773843010268, -116.30173220237097, 2.654506303369999, 2.7940881811082363, 2.224557548761368, -2.2231174161036904, -2.822909792264312, -3.18819119532904, -117.63842868804932, -106.40098775923252, -109.34808510541916, -16.114159919321537, -16.21371003240347, -16.147601664066315, -5.406478313108295, -5.178302941222995, -5.715480079253524, -1.4655376200874741, -1.7686245193084176, -1.3350132827957566, -17.230978113909565, -17.1975546417137, -17.479858872791134, 3.0491394897301944, 3.138237667580441, 3.196196106572941, -95.39045930405459, -107.06473179658255, -94.39207590216151, -14.495490896205112, -14.818732137481376, -14.5934390599529, -102.02686644593875, -102.06068567434947, -115.11881343523662, -97.01903514067332, -92.06709347168605, -98.02482895056407, 2.084379100551203, 1.8245680605371746, 1.843289208908871, -4.787006686131164, -4.925171444813415, -5.257155234615013, -13.084927067160606, -13.546050503849983, -12.898425726220012, -2.960568433006614, -3.093724389870971, -2.419510185097664, -105.57013863325119, -116.49023824930191, -105.57638162374496, 0.07092665880918503, 0.2892735227942467, -0.15840664505958557, -96.63435452679794, -95.89700651417176, -107.92940662304561, -14.423911854624748, -14.536862507462502, -14.154396172612906, -95.95572449763617, -107.08130963643393, -94.55401056011519, 1.388254538178444, 1.3334507122635841, 1.2297841161489487, 1.5815582598249023, 1.4841267938415115, 1.4753390202919547, 8.86729474117358, 9.010477372755602, 8.733554658790425, 2.221119639774159, 2.078137521942452, 1.6871474434932026, -90.49312657117844, -89.14097594469786, -105.30970311164856, 2.161931584278733, 1.9481395209828918, 1.54566306869188, 2.0293881098429267, 2.031106847027928, 1.8550796906153266, -100.52122871081035, -86.08248415092628, -85.1753160233299, 0.08698636293411255, 0.08336389064788818, 0.001255810260772705, -90.68911596139273, -84.14717885603508, -84.08741592367491, -107.25202610095343, -95.2261190613111, -93.8902143140634, 0.9036630739768299, 0.9942780410249981, 0.8010294263561519, 0.40761419385671616, 0.24630379676818848, 0.39325882494449615, -5.693223314980671, -5.777261170248195, -6.123507271210357, -7.540777303278446, -7.601223789155483, -7.821385055780411, 8.152082715959594, 7.745994848509625, 8.057809627925351, -103.59501566489539, -101.45328234632811, -113.2381337483724, -7.456342846155167, -6.503187872469425, -7.56258425116539, 5.095379739999771, 4.935703217983246, 4.794773921370506, 2.4927179788549694, 2.140393768747643, 2.7068661053975376, -7.146050820748016, -7.206241490940258, -6.967810562501356, 4.542238116264343, 4.5649344101548195, 3.8078757375478745, -2.9435227811336517, -2.518296167254448, -3.150200992822647, -7.876177323361247, -7.926302408178657, -9.064279576142638, -96.00300444165866, -96.08749953905742, -108.14605979124705, -113.47182508309683, -101.6960249443849, -101.6394769748052, -93.02604191253583, -105.05944554011027, -92.66876585098605, -15.718129836022854, -15.638336185365915, -16.215189173817635, -13.34271801263094, -13.311305843293667, -13.108405411243439, 2.6639484564463203, 2.733729495356471, 2.4169512788454597, 0.15596147378285252, 0.11528625835974537, -0.006800408164664873, 5.491061858832836, 5.3505669683218, 5.261192038655281, -13.323193699121475, -13.545406371355057, -14.203966617584229, -2.8282846709092553, -2.9050813068946297, -3.3240199287732537, -1.3947156493862565, -1.8056079049905236, -0.9336252280821498, 8.753898938496903, 9.25190399245669, 7.65046839912732, -10.278921718398735, -10.575598026315376, -11.563764135042831, -102.23309959967932, -103.25190942486128, -113.82002319892248, -8.611877237757056, -8.544904564817756, -8.198428958033531, -104.40136748055617, -103.9578918243448, -118.58142713705699, -0.1755402783552853, -0.4707819024721829, -0.15636319170396007, 15.24292706946531, 15.22604241470495, 15.562446377860994, -103.53965503970782, -103.89558693269889, -114.51322553555171, 2.1027515505750927, 2.3115576853354725, 1.6350667973359378, 2.1298253039518897, 2.2345182547966544, 2.2006826351086204, 1.105261159439877, 0.7524950553973468, 0.7820736368497165, -8.250887040048838, -8.245195299386978, -8.992980346083641, -103.99317248662314, -97.74587628369531, -98.17477117230496, 7.754175672928483, 7.492254609862954, 7.482530857125909, -100.70158274968466, -101.89658315976462, -105.18183859189352, -1.7582402626673428, -0.8879092397789208, -1.618186111251518, -113.94336919983229, -124.51506223281226, -113.14398776491484, 2.827767842759684, 2.2516975750525745, 2.491894086201981, 2.31519604971011, 1.9059211661418232, 2.3127243195970806, -88.19145409266154, -98.54725321630637, -88.20030817637841, 2.1291699297726154, 1.8439205959439278, 2.1883094161748886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1572697914576885, "mean_inference_ms": 0.7010799974606121, "mean_action_processing_ms": 0.0963971441378188, "mean_env_wait_ms": 0.7968440285342737, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 145000, "timesteps_this_iter": 0, "agent_timesteps_total": 435000, "timers": {"sample_time_ms": 10512.129, "sample_throughput": 475.641, "load_time_ms": 0.1, "load_throughput": 50003624.225, "learn_time_ms": 1909.241, "learn_throughput": 2618.841, "update_time_ms": 8.9}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005000000000000001, "total_loss": 352.95643920898436, "policy_loss": -0.002194523486069677, "vf_loss": 353.01369018554686, "vf_explained_var": 0.13512529730796813, "kl": 0.0036131817236333213, "entropy": 5.506354522705078, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 145000, "num_agent_steps_sampled": 435000, "num_steps_trained": 145000, "num_agent_steps_trained": 435000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 926, "training_iteration": 29, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-06-32", "timestamp": 1706231192, "time_this_iter_s": 10.485952138900757, "time_total_s": 310.54094076156616, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214025304C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 310.54094076156616, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 7.213333333333333, "ram_util_percent": 49.71333333333334}}
{"episode_reward_max": 46.03141586203125, "episode_reward_min": -624.3609877377748, "episode_reward_mean": -99.34853754251264, "episode_len_mean": 375.54, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -218.82679724693298}, "policy_reward_max": {"shared_policy": 15.562446377860994}, "policy_reward_mean": {"shared_policy": -33.116179180837555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.953396353404997, -311.6853530406952, -325.73977402597666, -301.81333607807755, -317.9325602352619, -40.05849255621436, 26.217470817267895, -320.19623792171484, -284.87332682311535, -2.1233605071902275, 12.174263080582008, -321.689573943615, 7.673152033239603, -8.234218403697042, -333.387501552701, -48.47547161579132, -16.300261333584814, -4.569175422191648, -51.9083916284144, 9.383573263883576, -296.8472670027987, -43.90766209363939, -319.2063655555248, -287.11095756292343, 5.752236369997249, -14.969333365559592, -39.5294032972306, -8.473803007975249, -327.63675850629807, 0.20179353654384613, -300.4607676640153, -43.115170534700155, -297.59104469418526, 3.9514893665909767, 4.5410240739583685, 26.611326772719607, 5.986404605209813, -284.94380562752485, 5.655734173953505, 5.9155746474861814, -271.7790288850665, 0.17160606384277344, -258.9237107411027, -296.3683594763279, 2.69897054135798, 1.0471768155694008, -17.593991756439223, -22.96338614821434, 23.95588719239457, -318.28643175959587, -21.522114969789982, 14.825856879353523, 7.33997785300015, -21.32010287418963, 12.915048263967037, -8.612019941210747, -24.866759307682543, -300.2365637719631, -316.80732700228697, -290.75425330363214, -47.571655195206404, -39.762429267168045, 7.814629230648251, 0.264447323977933, 16.102820865809917, -41.07256668806076, -9.057385906577139, -4.13394878245893, 25.656271330080912, -32.41828387975694, -319.3050322234631, -25.355210760608344, -326.94068644195795, -0.8026853725314282, 46.03141586203125, -321.9484675079584, 6.049376033246503, 6.565026193857165, 2.6398298516869403, -25.489062685519457, -299.91381994262343, 22.728961139917345, -307.7800045013428, -4.2643356136977815, -351.60241919755936, 7.571359504014239, 6.533841535449014, -274.9390154853463, 6.161399941891432, -7.535422205925016, -31.3118672668934, -9.433246970176725, -28.357404142618194, -624.3609877377748, -24.76693657785654, 7.6725161038339, 36.01618967950341, -4.226368457078948, 2.9700310118496134, -15.534373108297586], "episode_lengths": [500, 113, 168, 64, 120, 500, 500, 40, 101, 500, 500, 60, 500, 500, 79, 500, 500, 500, 500, 500, 78, 500, 58, 64, 500, 500, 500, 500, 72, 500, 61, 500, 80, 500, 500, 500, 500, 75, 500, 500, 82, 500, 118, 67, 500, 500, 500, 500, 500, 38, 500, 500, 500, 500, 500, 500, 500, 67, 65, 61, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 138, 500, 56, 500, 500, 220, 500, 500, 500, 500, 61, 500, 70, 500, 133, 500, 500, 95, 500, 500, 500, 500, 500, 50, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-4.00887078170976, -4.193668444951385, -3.7508571267438526, -102.16267828146617, -103.60693279902141, -105.91574196020763, -104.29458833982548, -114.08057320614657, -107.36461248000464, -97.04860651493073, -110.26777827739716, -94.49695128574967, -101.61700663963954, -103.60449192921321, -112.71106166640918, -13.282365967830032, -13.613233809669822, -13.162892778714507, 8.472659692168236, 8.89596651494503, 8.848844610154629, -102.1770438750585, -102.38873751958212, -115.63045652707419, -92.09120925267538, -103.32295443614325, -89.45916313429674, -1.2557655274868011, -0.25947578996419907, -0.6081191897392273, 3.9453353037436756, 4.015795183678463, 4.2131325931598695, -103.41010331114134, -101.97773843010268, -116.30173220237097, 2.654506303369999, 2.7940881811082363, 2.224557548761368, -2.2231174161036904, -2.822909792264312, -3.18819119532904, -117.63842868804932, -106.40098775923252, -109.34808510541916, -16.114159919321537, -16.21371003240347, -16.147601664066315, -5.406478313108295, -5.178302941222995, -5.715480079253524, -1.4655376200874741, -1.7686245193084176, -1.3350132827957566, -17.230978113909565, -17.1975546417137, -17.479858872791134, 3.0491394897301944, 3.138237667580441, 3.196196106572941, -95.39045930405459, -107.06473179658255, -94.39207590216151, -14.495490896205112, -14.818732137481376, -14.5934390599529, -102.02686644593875, -102.06068567434947, -115.11881343523662, -97.01903514067332, -92.06709347168605, -98.02482895056407, 2.084379100551203, 1.8245680605371746, 1.843289208908871, -4.787006686131164, -4.925171444813415, -5.257155234615013, -13.084927067160606, -13.546050503849983, -12.898425726220012, -2.960568433006614, -3.093724389870971, -2.419510185097664, -105.57013863325119, -116.49023824930191, -105.57638162374496, 0.07092665880918503, 0.2892735227942467, -0.15840664505958557, -96.63435452679794, -95.89700651417176, -107.92940662304561, -14.423911854624748, -14.536862507462502, -14.154396172612906, -95.95572449763617, -107.08130963643393, -94.55401056011519, 1.388254538178444, 1.3334507122635841, 1.2297841161489487, 1.5815582598249023, 1.4841267938415115, 1.4753390202919547, 8.86729474117358, 9.010477372755602, 8.733554658790425, 2.221119639774159, 2.078137521942452, 1.6871474434932026, -90.49312657117844, -89.14097594469786, -105.30970311164856, 2.161931584278733, 1.9481395209828918, 1.54566306869188, 2.0293881098429267, 2.031106847027928, 1.8550796906153266, -100.52122871081035, -86.08248415092628, -85.1753160233299, 0.08698636293411255, 0.08336389064788818, 0.001255810260772705, -90.68911596139273, -84.14717885603508, -84.08741592367491, -107.25202610095343, -95.2261190613111, -93.8902143140634, 0.9036630739768299, 0.9942780410249981, 0.8010294263561519, 0.40761419385671616, 0.24630379676818848, 0.39325882494449615, -5.693223314980671, -5.777261170248195, -6.123507271210357, -7.540777303278446, -7.601223789155483, -7.821385055780411, 8.152082715959594, 7.745994848509625, 8.057809627925351, -103.59501566489539, -101.45328234632811, -113.2381337483724, -7.456342846155167, -6.503187872469425, -7.56258425116539, 5.095379739999771, 4.935703217983246, 4.794773921370506, 2.4927179788549694, 2.140393768747643, 2.7068661053975376, -7.146050820748016, -7.206241490940258, -6.967810562501356, 4.542238116264343, 4.5649344101548195, 3.8078757375478745, -2.9435227811336517, -2.518296167254448, -3.150200992822647, -7.876177323361247, -7.926302408178657, -9.064279576142638, -96.00300444165866, -96.08749953905742, -108.14605979124705, -113.47182508309683, -101.6960249443849, -101.6394769748052, -93.02604191253583, -105.05944554011027, -92.66876585098605, -15.718129836022854, -15.638336185365915, -16.215189173817635, -13.34271801263094, -13.311305843293667, -13.108405411243439, 2.6639484564463203, 2.733729495356471, 2.4169512788454597, 0.15596147378285252, 0.11528625835974537, -0.006800408164664873, 5.491061858832836, 5.3505669683218, 5.261192038655281, -13.323193699121475, -13.545406371355057, -14.203966617584229, -2.8282846709092553, -2.9050813068946297, -3.3240199287732537, -1.3947156493862565, -1.8056079049905236, -0.9336252280821498, 8.753898938496903, 9.25190399245669, 7.65046839912732, -10.278921718398735, -10.575598026315376, -11.563764135042831, -102.23309959967932, -103.25190942486128, -113.82002319892248, -8.611877237757056, -8.544904564817756, -8.198428958033531, -104.40136748055617, -103.9578918243448, -118.58142713705699, -0.1755402783552853, -0.4707819024721829, -0.15636319170396007, 15.24292706946531, 15.22604241470495, 15.562446377860994, -103.53965503970782, -103.89558693269889, -114.51322553555171, 2.1027515505750927, 2.3115576853354725, 1.6350667973359378, 2.1298253039518897, 2.2345182547966544, 2.2006826351086204, 1.105261159439877, 0.7524950553973468, 0.7820736368497165, -8.250887040048838, -8.245195299386978, -8.992980346083641, -103.99317248662314, -97.74587628369531, -98.17477117230496, 7.754175672928483, 7.492254609862954, 7.482530857125909, -100.70158274968466, -101.89658315976462, -105.18183859189352, -1.7582402626673428, -0.8879092397789208, -1.618186111251518, -113.94336919983229, -124.51506223281226, -113.14398776491484, 2.827767842759684, 2.2516975750525745, 2.491894086201981, 2.31519604971011, 1.9059211661418232, 2.3127243195970806, -88.19145409266154, -98.54725321630637, -88.20030817637841, 2.1291699297726154, 1.8439205959439278, 2.1883094161748886, -2.5309097220500405, -2.5249291410048897, -2.479583342870086, -10.214049304525062, -10.484983260432884, -10.612834701935455, -2.543003549178451, -2.775326659282058, -4.114916761716216, -9.018816689650222, -9.406160379449531, -9.93242707351844, -205.13816916942596, -218.82679724693298, -200.3960213214159, -8.048470497131348, -8.15412975102663, -8.564336329698563, 2.6052560334404262, 3.0866978553434166, 1.9805622150500568, 12.1530125538508, 12.156548003355653, 11.70662912229696, -1.2923700908819882, -1.2654676834742276, -1.6685306827227322, 0.757336224118859, 0.8308832893768852, 1.3818114983538692, -5.36690565943718, -5.258337773382664, -4.909129675477743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1564799144387639, "mean_inference_ms": 0.699585150559109, "mean_action_processing_ms": 0.09620118573864903, "mean_env_wait_ms": 0.7968613118103842, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 150000, "timesteps_this_iter": 0, "agent_timesteps_total": 450000, "timers": {"sample_time_ms": 10545.785, "sample_throughput": 474.123, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1918.717, "learn_throughput": 2605.907, "update_time_ms": 9.299}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005000000000000001, "total_loss": 245.27755584716797, "policy_loss": -0.00174729360478465, "vf_loss": 245.3346954345703, "vf_explained_var": 0.12727838158607482, "kl": 0.006658460057226376, "entropy": 5.539349746704102, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 150000, "num_agent_steps_sampled": 450000, "num_steps_trained": 150000, "num_agent_steps_trained": 450000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 937, "training_iteration": 30, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-06-43", "timestamp": 1706231203, "time_this_iter_s": 10.961908102035522, "time_total_s": 321.5028488636017, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402530A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 321.5028488636017, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 8.753333333333334, "ram_util_percent": 49.873333333333335}}
{"episode_reward_max": 46.03141586203125, "episode_reward_min": -624.3609877377748, "episode_reward_mean": -85.17448511258233, "episode_len_mean": 395.89, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -218.82679724693298}, "policy_reward_max": {"shared_policy": 15.562446377860994}, "policy_reward_mean": {"shared_policy": -28.391495037527456}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-321.689573943615, 7.673152033239603, -8.234218403697042, -333.387501552701, -48.47547161579132, -16.300261333584814, -4.569175422191648, -51.9083916284144, 9.383573263883576, -296.8472670027987, -43.90766209363939, -319.2063655555248, -287.11095756292343, 5.752236369997249, -14.969333365559592, -39.5294032972306, -8.473803007975249, -327.63675850629807, 0.20179353654384613, -300.4607676640153, -43.115170534700155, -297.59104469418526, 3.9514893665909767, 4.5410240739583685, 26.611326772719607, 5.986404605209813, -284.94380562752485, 5.655734173953505, 5.9155746474861814, -271.7790288850665, 0.17160606384277344, -258.9237107411027, -296.3683594763279, 2.69897054135798, 1.0471768155694008, -17.593991756439223, -22.96338614821434, 23.95588719239457, -318.28643175959587, -21.522114969789982, 14.825856879353523, 7.33997785300015, -21.32010287418963, 12.915048263967037, -8.612019941210747, -24.866759307682543, -300.2365637719631, -316.80732700228697, -290.75425330363214, -47.571655195206404, -39.762429267168045, 7.814629230648251, 0.264447323977933, 16.102820865809917, -41.07256668806076, -9.057385906577139, -4.13394878245893, 25.656271330080912, -32.41828387975694, -319.3050322234631, -25.355210760608344, -326.94068644195795, -0.8026853725314282, 46.03141586203125, -321.9484675079584, 6.049376033246503, 6.565026193857165, 2.6398298516869403, -25.489062685519457, -299.91381994262343, 22.728961139917345, -307.7800045013428, -4.2643356136977815, -351.60241919755936, 7.571359504014239, 6.533841535449014, -274.9390154853463, 6.161399941891432, -7.535422205925016, -31.3118672668934, -9.433246970176725, -28.357404142618194, -624.3609877377748, -24.76693657785654, 7.6725161038339, 36.01618967950341, -4.226368457078948, 2.9700310118496134, -15.534373108297586, -69.41179972142004, -20.471897579729557, -43.57876391708854, -282.13921190053225, -28.578132927417784, 6.671861515380442, -8.920980580151081, 30.400356233119936, 11.806654442101703, -49.80291794985533, -6.554028265178218], "episode_lengths": [60, 500, 500, 79, 500, 500, 500, 500, 500, 78, 500, 58, 64, 500, 500, 500, 500, 72, 500, 61, 500, 80, 500, 500, 500, 500, 75, 500, 500, 82, 500, 118, 67, 500, 500, 500, 500, 500, 38, 500, 500, 500, 500, 500, 500, 500, 67, 65, 61, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 138, 500, 56, 500, 500, 220, 500, 500, 500, 500, 61, 500, 70, 500, 133, 500, 500, 95, 500, 500, 500, 500, 500, 50, 500, 500, 500, 500, 500, 500, 500, 500, 500, 141, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-103.41010331114134, -101.97773843010268, -116.30173220237097, 2.654506303369999, 2.7940881811082363, 2.224557548761368, -2.2231174161036904, -2.822909792264312, -3.18819119532904, -117.63842868804932, -106.40098775923252, -109.34808510541916, -16.114159919321537, -16.21371003240347, -16.147601664066315, -5.406478313108295, -5.178302941222995, -5.715480079253524, -1.4655376200874741, -1.7686245193084176, -1.3350132827957566, -17.230978113909565, -17.1975546417137, -17.479858872791134, 3.0491394897301944, 3.138237667580441, 3.196196106572941, -95.39045930405459, -107.06473179658255, -94.39207590216151, -14.495490896205112, -14.818732137481376, -14.5934390599529, -102.02686644593875, -102.06068567434947, -115.11881343523662, -97.01903514067332, -92.06709347168605, -98.02482895056407, 2.084379100551203, 1.8245680605371746, 1.843289208908871, -4.787006686131164, -4.925171444813415, -5.257155234615013, -13.084927067160606, -13.546050503849983, -12.898425726220012, -2.960568433006614, -3.093724389870971, -2.419510185097664, -105.57013863325119, -116.49023824930191, -105.57638162374496, 0.07092665880918503, 0.2892735227942467, -0.15840664505958557, -96.63435452679794, -95.89700651417176, -107.92940662304561, -14.423911854624748, -14.536862507462502, -14.154396172612906, -95.95572449763617, -107.08130963643393, -94.55401056011519, 1.388254538178444, 1.3334507122635841, 1.2297841161489487, 1.5815582598249023, 1.4841267938415115, 1.4753390202919547, 8.86729474117358, 9.010477372755602, 8.733554658790425, 2.221119639774159, 2.078137521942452, 1.6871474434932026, -90.49312657117844, -89.14097594469786, -105.30970311164856, 2.161931584278733, 1.9481395209828918, 1.54566306869188, 2.0293881098429267, 2.031106847027928, 1.8550796906153266, -100.52122871081035, -86.08248415092628, -85.1753160233299, 0.08698636293411255, 0.08336389064788818, 0.001255810260772705, -90.68911596139273, -84.14717885603508, -84.08741592367491, -107.25202610095343, -95.2261190613111, -93.8902143140634, 0.9036630739768299, 0.9942780410249981, 0.8010294263561519, 0.40761419385671616, 0.24630379676818848, 0.39325882494449615, -5.693223314980671, -5.777261170248195, -6.123507271210357, -7.540777303278446, -7.601223789155483, -7.821385055780411, 8.152082715959594, 7.745994848509625, 8.057809627925351, -103.59501566489539, -101.45328234632811, -113.2381337483724, -7.456342846155167, -6.503187872469425, -7.56258425116539, 5.095379739999771, 4.935703217983246, 4.794773921370506, 2.4927179788549694, 2.140393768747643, 2.7068661053975376, -7.146050820748016, -7.206241490940258, -6.967810562501356, 4.542238116264343, 4.5649344101548195, 3.8078757375478745, -2.9435227811336517, -2.518296167254448, -3.150200992822647, -7.876177323361247, -7.926302408178657, -9.064279576142638, -96.00300444165866, -96.08749953905742, -108.14605979124705, -113.47182508309683, -101.6960249443849, -101.6394769748052, -93.02604191253583, -105.05944554011027, -92.66876585098605, -15.718129836022854, -15.638336185365915, -16.215189173817635, -13.34271801263094, -13.311305843293667, -13.108405411243439, 2.6639484564463203, 2.733729495356471, 2.4169512788454597, 0.15596147378285252, 0.11528625835974537, -0.006800408164664873, 5.491061858832836, 5.3505669683218, 5.261192038655281, -13.323193699121475, -13.545406371355057, -14.203966617584229, -2.8282846709092553, -2.9050813068946297, -3.3240199287732537, -1.3947156493862565, -1.8056079049905236, -0.9336252280821498, 8.753898938496903, 9.25190399245669, 7.65046839912732, -10.278921718398735, -10.575598026315376, -11.563764135042831, -102.23309959967932, -103.25190942486128, -113.82002319892248, -8.611877237757056, -8.544904564817756, -8.198428958033531, -104.40136748055617, -103.9578918243448, -118.58142713705699, -0.1755402783552853, -0.4707819024721829, -0.15636319170396007, 15.24292706946531, 15.22604241470495, 15.562446377860994, -103.53965503970782, -103.89558693269889, -114.51322553555171, 2.1027515505750927, 2.3115576853354725, 1.6350667973359378, 2.1298253039518897, 2.2345182547966544, 2.2006826351086204, 1.105261159439877, 0.7524950553973468, 0.7820736368497165, -8.250887040048838, -8.245195299386978, -8.992980346083641, -103.99317248662314, -97.74587628369531, -98.17477117230496, 7.754175672928483, 7.492254609862954, 7.482530857125909, -100.70158274968466, -101.89658315976462, -105.18183859189352, -1.7582402626673428, -0.8879092397789208, -1.618186111251518, -113.94336919983229, -124.51506223281226, -113.14398776491484, 2.827767842759684, 2.2516975750525745, 2.491894086201981, 2.31519604971011, 1.9059211661418232, 2.3127243195970806, -88.19145409266154, -98.54725321630637, -88.20030817637841, 2.1291699297726154, 1.8439205959439278, 2.1883094161748886, -2.5309097220500405, -2.5249291410048897, -2.479583342870086, -10.214049304525062, -10.484983260432884, -10.612834701935455, -2.543003549178451, -2.775326659282058, -4.114916761716216, -9.018816689650222, -9.406160379449531, -9.93242707351844, -205.13816916942596, -218.82679724693298, -200.3960213214159, -8.048470497131348, -8.15412975102663, -8.564336329698563, 2.6052560334404262, 3.0866978553434166, 1.9805622150500568, 12.1530125538508, 12.156548003355653, 11.70662912229696, -1.2923700908819882, -1.2654676834742276, -1.6685306827227322, 0.757336224118859, 0.8308832893768852, 1.3818114983538692, -5.36690565943718, -5.258337773382664, -4.909129675477743, -22.866920965413257, -23.116168255607292, -23.428710500399276, -7.1884802132844925, -6.812399640679359, -6.471017725765705, -14.570390512545913, -14.553430085380882, -14.454943319161742, -102.41322163740794, -89.72995862613122, -89.9960316369931, -9.386661765476077, -9.515370768805354, -9.676100393136352, 2.0524875968694687, 2.650051490403712, 1.9693224281072617, -2.94668011367321, -3.151879459619522, -2.822421006858349, 10.089684250454098, 10.145411277810723, 10.165260704855115, 4.41838527595003, 3.7237677027781757, 3.6645014633734974, -16.451056078076363, -16.091113574802876, -17.26074829697609, -1.9776290977994648, -2.0429913649956433, -2.5334078023831097]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15587498345819678, "mean_inference_ms": 0.6992374723697731, "mean_action_processing_ms": 0.09623824294606964, "mean_env_wait_ms": 0.797650484264444, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 155000, "timesteps_this_iter": 0, "agent_timesteps_total": 465000, "timers": {"sample_time_ms": 10566.139, "sample_throughput": 473.21, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1920.847, "learn_throughput": 2603.019, "update_time_ms": 9.249}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005000000000000001, "total_loss": 77.78189620971679, "policy_loss": -0.002698889847770314, "vf_loss": 77.84045715332032, "vf_explained_var": 0.15415220856666564, "kl": 0.0055824358947596285, "entropy": 5.586372995376587, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 155000, "num_agent_steps_sampled": 465000, "num_steps_trained": 155000, "num_agent_steps_trained": 465000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 948, "training_iteration": 31, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-06-54", "timestamp": 1706231214, "time_this_iter_s": 10.620649814605713, "time_total_s": 332.1234986782074, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021404232550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 332.1234986782074, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 6.999999999999999, "ram_util_percent": 50.66000000000001}}
{"episode_reward_max": 46.03141586203125, "episode_reward_min": -624.3609877377748, "episode_reward_mean": -80.991324389386, "episode_len_mean": 401.48, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -218.82679724693298}, "policy_reward_max": {"shared_policy": 15.562446377860994}, "policy_reward_mean": {"shared_policy": -26.997108129795336}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-287.11095756292343, 5.752236369997249, -14.969333365559592, -39.5294032972306, -8.473803007975249, -327.63675850629807, 0.20179353654384613, -300.4607676640153, -43.115170534700155, -297.59104469418526, 3.9514893665909767, 4.5410240739583685, 26.611326772719607, 5.986404605209813, -284.94380562752485, 5.655734173953505, 5.9155746474861814, -271.7790288850665, 0.17160606384277344, -258.9237107411027, -296.3683594763279, 2.69897054135798, 1.0471768155694008, -17.593991756439223, -22.96338614821434, 23.95588719239457, -318.28643175959587, -21.522114969789982, 14.825856879353523, 7.33997785300015, -21.32010287418963, 12.915048263967037, -8.612019941210747, -24.866759307682543, -300.2365637719631, -316.80732700228697, -290.75425330363214, -47.571655195206404, -39.762429267168045, 7.814629230648251, 0.264447323977933, 16.102820865809917, -41.07256668806076, -9.057385906577139, -4.13394878245893, 25.656271330080912, -32.41828387975694, -319.3050322234631, -25.355210760608344, -326.94068644195795, -0.8026853725314282, 46.03141586203125, -321.9484675079584, 6.049376033246503, 6.565026193857165, 2.6398298516869403, -25.489062685519457, -299.91381994262343, 22.728961139917345, -307.7800045013428, -4.2643356136977815, -351.60241919755936, 7.571359504014239, 6.533841535449014, -274.9390154853463, 6.161399941891432, -7.535422205925016, -31.3118672668934, -9.433246970176725, -28.357404142618194, -624.3609877377748, -24.76693657785654, 7.6725161038339, 36.01618967950341, -4.226368457078948, 2.9700310118496134, -15.534373108297586, -69.41179972142004, -20.471897579729557, -43.57876391708854, -282.13921190053225, -28.578132927417784, 6.671861515380442, -8.920980580151081, 30.400356233119936, 11.806654442101703, -49.80291794985533, -6.554028265178218, -11.123064134269967, 11.396584019064903, -312.6764124929905, 0.1387624628841735, -10.605055548250675, -13.045635551214218, -10.948785834014444, -318.1351944692433, -315.6618286073208, -13.257405197247891, -15.508916312828674, 0.27386073023079405], "episode_lengths": [64, 500, 500, 500, 500, 72, 500, 61, 500, 80, 500, 500, 500, 500, 75, 500, 500, 82, 500, 118, 67, 500, 500, 500, 500, 500, 38, 500, 500, 500, 500, 500, 500, 500, 67, 65, 61, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 138, 500, 56, 500, 500, 220, 500, 500, 500, 500, 61, 500, 70, 500, 133, 500, 500, 95, 500, 500, 500, 500, 500, 50, 500, 500, 500, 500, 500, 500, 500, 500, 500, 141, 500, 500, 500, 500, 500, 500, 500, 500, 500, 187, 500, 500, 500, 500, 82, 65, 500, 500, 500], "policy_shared_policy_reward": [-97.01903514067332, -92.06709347168605, -98.02482895056407, 2.084379100551203, 1.8245680605371746, 1.843289208908871, -4.787006686131164, -4.925171444813415, -5.257155234615013, -13.084927067160606, -13.546050503849983, -12.898425726220012, -2.960568433006614, -3.093724389870971, -2.419510185097664, -105.57013863325119, -116.49023824930191, -105.57638162374496, 0.07092665880918503, 0.2892735227942467, -0.15840664505958557, -96.63435452679794, -95.89700651417176, -107.92940662304561, -14.423911854624748, -14.536862507462502, -14.154396172612906, -95.95572449763617, -107.08130963643393, -94.55401056011519, 1.388254538178444, 1.3334507122635841, 1.2297841161489487, 1.5815582598249023, 1.4841267938415115, 1.4753390202919547, 8.86729474117358, 9.010477372755602, 8.733554658790425, 2.221119639774159, 2.078137521942452, 1.6871474434932026, -90.49312657117844, -89.14097594469786, -105.30970311164856, 2.161931584278733, 1.9481395209828918, 1.54566306869188, 2.0293881098429267, 2.031106847027928, 1.8550796906153266, -100.52122871081035, -86.08248415092628, -85.1753160233299, 0.08698636293411255, 0.08336389064788818, 0.001255810260772705, -90.68911596139273, -84.14717885603508, -84.08741592367491, -107.25202610095343, -95.2261190613111, -93.8902143140634, 0.9036630739768299, 0.9942780410249981, 0.8010294263561519, 0.40761419385671616, 0.24630379676818848, 0.39325882494449615, -5.693223314980671, -5.777261170248195, -6.123507271210357, -7.540777303278446, -7.601223789155483, -7.821385055780411, 8.152082715959594, 7.745994848509625, 8.057809627925351, -103.59501566489539, -101.45328234632811, -113.2381337483724, -7.456342846155167, -6.503187872469425, -7.56258425116539, 5.095379739999771, 4.935703217983246, 4.794773921370506, 2.4927179788549694, 2.140393768747643, 2.7068661053975376, -7.146050820748016, -7.206241490940258, -6.967810562501356, 4.542238116264343, 4.5649344101548195, 3.8078757375478745, -2.9435227811336517, -2.518296167254448, -3.150200992822647, -7.876177323361247, -7.926302408178657, -9.064279576142638, -96.00300444165866, -96.08749953905742, -108.14605979124705, -113.47182508309683, -101.6960249443849, -101.6394769748052, -93.02604191253583, -105.05944554011027, -92.66876585098605, -15.718129836022854, -15.638336185365915, -16.215189173817635, -13.34271801263094, -13.311305843293667, -13.108405411243439, 2.6639484564463203, 2.733729495356471, 2.4169512788454597, 0.15596147378285252, 0.11528625835974537, -0.006800408164664873, 5.491061858832836, 5.3505669683218, 5.261192038655281, -13.323193699121475, -13.545406371355057, -14.203966617584229, -2.8282846709092553, -2.9050813068946297, -3.3240199287732537, -1.3947156493862565, -1.8056079049905236, -0.9336252280821498, 8.753898938496903, 9.25190399245669, 7.65046839912732, -10.278921718398735, -10.575598026315376, -11.563764135042831, -102.23309959967932, -103.25190942486128, -113.82002319892248, -8.611877237757056, -8.544904564817756, -8.198428958033531, -104.40136748055617, -103.9578918243448, -118.58142713705699, -0.1755402783552853, -0.4707819024721829, -0.15636319170396007, 15.24292706946531, 15.22604241470495, 15.562446377860994, -103.53965503970782, -103.89558693269889, -114.51322553555171, 2.1027515505750927, 2.3115576853354725, 1.6350667973359378, 2.1298253039518897, 2.2345182547966544, 2.2006826351086204, 1.105261159439877, 0.7524950553973468, 0.7820736368497165, -8.250887040048838, -8.245195299386978, -8.992980346083641, -103.99317248662314, -97.74587628369531, -98.17477117230496, 7.754175672928483, 7.492254609862954, 7.482530857125909, -100.70158274968466, -101.89658315976462, -105.18183859189352, -1.7582402626673428, -0.8879092397789208, -1.618186111251518, -113.94336919983229, -124.51506223281226, -113.14398776491484, 2.827767842759684, 2.2516975750525745, 2.491894086201981, 2.31519604971011, 1.9059211661418232, 2.3127243195970806, -88.19145409266154, -98.54725321630637, -88.20030817637841, 2.1291699297726154, 1.8439205959439278, 2.1883094161748886, -2.5309097220500405, -2.5249291410048897, -2.479583342870086, -10.214049304525062, -10.484983260432884, -10.612834701935455, -2.543003549178451, -2.775326659282058, -4.114916761716216, -9.018816689650222, -9.406160379449531, -9.93242707351844, -205.13816916942596, -218.82679724693298, -200.3960213214159, -8.048470497131348, -8.15412975102663, -8.564336329698563, 2.6052560334404262, 3.0866978553434166, 1.9805622150500568, 12.1530125538508, 12.156548003355653, 11.70662912229696, -1.2923700908819882, -1.2654676834742276, -1.6685306827227322, 0.757336224118859, 0.8308832893768852, 1.3818114983538692, -5.36690565943718, -5.258337773382664, -4.909129675477743, -22.866920965413257, -23.116168255607292, -23.428710500399276, -7.1884802132844925, -6.812399640679359, -6.471017725765705, -14.570390512545913, -14.553430085380882, -14.454943319161742, -102.41322163740794, -89.72995862613122, -89.9960316369931, -9.386661765476077, -9.515370768805354, -9.676100393136352, 2.0524875968694687, 2.650051490403712, 1.9693224281072617, -2.94668011367321, -3.151879459619522, -2.822421006858349, 10.089684250454098, 10.145411277810723, 10.165260704855115, 4.41838527595003, 3.7237677027781757, 3.6645014633734974, -16.451056078076363, -16.091113574802876, -17.26074829697609, -1.9776290977994648, -2.0429913649956433, -2.5334078023831097, -3.6691273103157727, -3.604074260840818, -3.8498625631133763, 4.0273158103227615, 4.242019563913345, 3.1272486448287964, -100.37804882725081, -100.85848580797514, -111.43987785776457, 0.030120437343910567, 0.32936810826261365, -0.22072608272235072, -3.380931705236435, -3.4492849335074425, -3.774838909506798, -4.004612699151039, -4.464719206094742, -4.576303645968437, -3.5726697159310277, -3.4159065199395116, -3.960209598143905, -104.15290580689907, -103.42144567146897, -110.56084299087524, -116.74448279539745, -100.47006366650264, -98.44728214542071, -4.651981731255859, -4.589519863327354, -4.015903602664679, -5.150159473220512, -4.7861677749703375, -5.572589064637825, 0.5058169489105495, 0.05657059450943791, -0.2885268131891934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15514700334829679, "mean_inference_ms": 0.6987580671529808, "mean_action_processing_ms": 0.09605655459109254, "mean_env_wait_ms": 0.7983044866560423, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 160000, "timesteps_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"sample_time_ms": 10563.011, "sample_throughput": 473.35, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1917.271, "learn_throughput": 2607.873, "update_time_ms": 9.256}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005000000000000001, "total_loss": 203.56239013671876, "policy_loss": -0.0020648647568235036, "vf_loss": 203.62137603759766, "vf_explained_var": 0.11195855736732482, "kl": 0.0055747006437762035, "entropy": 5.692654323577881, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 160000, "num_agent_steps_sampled": 480000, "num_steps_trained": 160000, "num_agent_steps_trained": 480000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 960, "training_iteration": 32, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-07-04", "timestamp": 1706231224, "time_this_iter_s": 10.3402841091156, "time_total_s": 342.463782787323, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214018EE940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 342.463782787323, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 6.286666666666665, "ram_util_percent": 50.40666666666665}}
{"episode_reward_max": 46.03141586203125, "episode_reward_min": -624.3609877377748, "episode_reward_mean": -74.21131766841282, "episode_len_mean": 411.28, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -218.82679724693298}, "policy_reward_max": {"shared_policy": 15.562446377860994}, "policy_reward_mean": {"shared_policy": -24.737105889470943}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.611326772719607, 5.986404605209813, -284.94380562752485, 5.655734173953505, 5.9155746474861814, -271.7790288850665, 0.17160606384277344, -258.9237107411027, -296.3683594763279, 2.69897054135798, 1.0471768155694008, -17.593991756439223, -22.96338614821434, 23.95588719239457, -318.28643175959587, -21.522114969789982, 14.825856879353523, 7.33997785300015, -21.32010287418963, 12.915048263967037, -8.612019941210747, -24.866759307682543, -300.2365637719631, -316.80732700228697, -290.75425330363214, -47.571655195206404, -39.762429267168045, 7.814629230648251, 0.264447323977933, 16.102820865809917, -41.07256668806076, -9.057385906577139, -4.13394878245893, 25.656271330080912, -32.41828387975694, -319.3050322234631, -25.355210760608344, -326.94068644195795, -0.8026853725314282, 46.03141586203125, -321.9484675079584, 6.049376033246503, 6.565026193857165, 2.6398298516869403, -25.489062685519457, -299.91381994262343, 22.728961139917345, -307.7800045013428, -4.2643356136977815, -351.60241919755936, 7.571359504014239, 6.533841535449014, -274.9390154853463, 6.161399941891432, -7.535422205925016, -31.3118672668934, -9.433246970176725, -28.357404142618194, -624.3609877377748, -24.76693657785654, 7.6725161038339, 36.01618967950341, -4.226368457078948, 2.9700310118496134, -15.534373108297586, -69.41179972142004, -20.471897579729557, -43.57876391708854, -282.13921190053225, -28.578132927417784, 6.671861515380442, -8.920980580151081, 30.400356233119936, 11.806654442101703, -49.80291794985533, -6.554028265178218, -11.123064134269967, 11.396584019064903, -312.6764124929905, 0.1387624628841735, -10.605055548250675, -13.045635551214218, -10.948785834014444, -318.1351944692433, -315.6618286073208, -13.257405197247891, -15.508916312828674, 0.27386073023079405, 6.888257242739201, -293.7946131676436, 21.849608972668648, 2.685017727315426, -23.857582543045297, -10.530416651628926, -11.654143534600749, 2.3210610318928815, -22.244202695786953, -271.1458948962391, -22.11172080039981, -4.8453938737511635], "episode_lengths": [500, 500, 75, 500, 500, 82, 500, 118, 67, 500, 500, 500, 500, 500, 38, 500, 500, 500, 500, 500, 500, 500, 67, 65, 61, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 138, 500, 56, 500, 500, 220, 500, 500, 500, 500, 61, 500, 70, 500, 133, 500, 500, 95, 500, 500, 500, 500, 500, 50, 500, 500, 500, 500, 500, 500, 500, 500, 500, 141, 500, 500, 500, 500, 500, 500, 500, 500, 500, 187, 500, 500, 500, 500, 82, 65, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 175, 500, 500], "policy_shared_policy_reward": [8.86729474117358, 9.010477372755602, 8.733554658790425, 2.221119639774159, 2.078137521942452, 1.6871474434932026, -90.49312657117844, -89.14097594469786, -105.30970311164856, 2.161931584278733, 1.9481395209828918, 1.54566306869188, 2.0293881098429267, 2.031106847027928, 1.8550796906153266, -100.52122871081035, -86.08248415092628, -85.1753160233299, 0.08698636293411255, 0.08336389064788818, 0.001255810260772705, -90.68911596139273, -84.14717885603508, -84.08741592367491, -107.25202610095343, -95.2261190613111, -93.8902143140634, 0.9036630739768299, 0.9942780410249981, 0.8010294263561519, 0.40761419385671616, 0.24630379676818848, 0.39325882494449615, -5.693223314980671, -5.777261170248195, -6.123507271210357, -7.540777303278446, -7.601223789155483, -7.821385055780411, 8.152082715959594, 7.745994848509625, 8.057809627925351, -103.59501566489539, -101.45328234632811, -113.2381337483724, -7.456342846155167, -6.503187872469425, -7.56258425116539, 5.095379739999771, 4.935703217983246, 4.794773921370506, 2.4927179788549694, 2.140393768747643, 2.7068661053975376, -7.146050820748016, -7.206241490940258, -6.967810562501356, 4.542238116264343, 4.5649344101548195, 3.8078757375478745, -2.9435227811336517, -2.518296167254448, -3.150200992822647, -7.876177323361247, -7.926302408178657, -9.064279576142638, -96.00300444165866, -96.08749953905742, -108.14605979124705, -113.47182508309683, -101.6960249443849, -101.6394769748052, -93.02604191253583, -105.05944554011027, -92.66876585098605, -15.718129836022854, -15.638336185365915, -16.215189173817635, -13.34271801263094, -13.311305843293667, -13.108405411243439, 2.6639484564463203, 2.733729495356471, 2.4169512788454597, 0.15596147378285252, 0.11528625835974537, -0.006800408164664873, 5.491061858832836, 5.3505669683218, 5.261192038655281, -13.323193699121475, -13.545406371355057, -14.203966617584229, -2.8282846709092553, -2.9050813068946297, -3.3240199287732537, -1.3947156493862565, -1.8056079049905236, -0.9336252280821498, 8.753898938496903, 9.25190399245669, 7.65046839912732, -10.278921718398735, -10.575598026315376, -11.563764135042831, -102.23309959967932, -103.25190942486128, -113.82002319892248, -8.611877237757056, -8.544904564817756, -8.198428958033531, -104.40136748055617, -103.9578918243448, -118.58142713705699, -0.1755402783552853, -0.4707819024721829, -0.15636319170396007, 15.24292706946531, 15.22604241470495, 15.562446377860994, -103.53965503970782, -103.89558693269889, -114.51322553555171, 2.1027515505750927, 2.3115576853354725, 1.6350667973359378, 2.1298253039518897, 2.2345182547966544, 2.2006826351086204, 1.105261159439877, 0.7524950553973468, 0.7820736368497165, -8.250887040048838, -8.245195299386978, -8.992980346083641, -103.99317248662314, -97.74587628369531, -98.17477117230496, 7.754175672928483, 7.492254609862954, 7.482530857125909, -100.70158274968466, -101.89658315976462, -105.18183859189352, -1.7582402626673428, -0.8879092397789208, -1.618186111251518, -113.94336919983229, -124.51506223281226, -113.14398776491484, 2.827767842759684, 2.2516975750525745, 2.491894086201981, 2.31519604971011, 1.9059211661418232, 2.3127243195970806, -88.19145409266154, -98.54725321630637, -88.20030817637841, 2.1291699297726154, 1.8439205959439278, 2.1883094161748886, -2.5309097220500405, -2.5249291410048897, -2.479583342870086, -10.214049304525062, -10.484983260432884, -10.612834701935455, -2.543003549178451, -2.775326659282058, -4.114916761716216, -9.018816689650222, -9.406160379449531, -9.93242707351844, -205.13816916942596, -218.82679724693298, -200.3960213214159, -8.048470497131348, -8.15412975102663, -8.564336329698563, 2.6052560334404262, 3.0866978553434166, 1.9805622150500568, 12.1530125538508, 12.156548003355653, 11.70662912229696, -1.2923700908819882, -1.2654676834742276, -1.6685306827227322, 0.757336224118859, 0.8308832893768852, 1.3818114983538692, -5.36690565943718, -5.258337773382664, -4.909129675477743, -22.866920965413257, -23.116168255607292, -23.428710500399276, -7.1884802132844925, -6.812399640679359, -6.471017725765705, -14.570390512545913, -14.553430085380882, -14.454943319161742, -102.41322163740794, -89.72995862613122, -89.9960316369931, -9.386661765476077, -9.515370768805354, -9.676100393136352, 2.0524875968694687, 2.650051490403712, 1.9693224281072617, -2.94668011367321, -3.151879459619522, -2.822421006858349, 10.089684250454098, 10.145411277810723, 10.165260704855115, 4.41838527595003, 3.7237677027781757, 3.6645014633734974, -16.451056078076363, -16.091113574802876, -17.26074829697609, -1.9776290977994648, -2.0429913649956433, -2.5334078023831097, -3.6691273103157727, -3.604074260840818, -3.8498625631133763, 4.0273158103227615, 4.242019563913345, 3.1272486448287964, -100.37804882725081, -100.85848580797514, -111.43987785776457, 0.030120437343910567, 0.32936810826261365, -0.22072608272235072, -3.380931705236435, -3.4492849335074425, -3.774838909506798, -4.004612699151039, -4.464719206094742, -4.576303645968437, -3.5726697159310277, -3.4159065199395116, -3.960209598143905, -104.15290580689907, -103.42144567146897, -110.56084299087524, -116.74448279539745, -100.47006366650264, -98.44728214542071, -4.651981731255859, -4.589519863327354, -4.015903602664679, -5.150159473220512, -4.7861677749703375, -5.572589064637825, 0.5058169489105495, 0.05657059450943791, -0.2885268131891934, 2.4513993337750435, 2.520517885684967, 1.91634002327919, -92.50130670269331, -92.85480836530527, -108.43849809964499, 7.242542788386345, 7.656079143285751, 6.9509870409965515, 0.7827442735433578, 0.8577123135328293, 1.0445611402392387, -7.404768093178674, -8.160485828916237, -8.292328620950386, -3.6718118215600697, -3.580316568414375, -3.278288261654481, -3.5421003575126377, -3.8941116432348934, -4.217931533853218, 0.6295304050048145, 0.967975682889417, 0.72355494399865, -7.402131326496601, -7.472974389791489, -7.369096979498863, -95.55879779656729, -87.67736824726066, -87.90972885241112, -6.913927366336196, -7.372420450051635, -7.8253729840119775, -1.3766241557896137, -1.3217504806816578, -2.147019237279892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15436032986422746, "mean_inference_ms": 0.6984226284784917, "mean_action_processing_ms": 0.09593182843147843, "mean_env_wait_ms": 0.798759346174392, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 165000, "timesteps_this_iter": 0, "agent_timesteps_total": 495000, "timers": {"sample_time_ms": 10556.319, "sample_throughput": 473.65, "load_time_ms": 0.017, "load_throughput": 296207909.605, "learn_time_ms": 1910.158, "learn_throughput": 2617.585, "update_time_ms": 9.181}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005000000000000001, "total_loss": 121.37694091796875, "policy_loss": -0.0021868872021790775, "vf_loss": 121.43853149414062, "vf_explained_var": 0.2624281167984009, "kl": 0.004265779478012097, "entropy": 5.940584802627564, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 165000, "num_agent_steps_sampled": 495000, "num_steps_trained": 165000, "num_agent_steps_trained": 495000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 972, "training_iteration": 33, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-07-15", "timestamp": 1706231235, "time_this_iter_s": 10.569112300872803, "time_total_s": 353.0328950881958, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002146F566430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 353.0328950881958, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 7.379999999999999, "ram_util_percent": 50.39999999999999}}
{"episode_reward_max": 46.03141586203125, "episode_reward_min": -624.3609877377748, "episode_reward_mean": -72.72194858052885, "episode_len_mean": 415.42, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -218.82679724693298}, "policy_reward_max": {"shared_policy": 15.562446377860994}, "policy_reward_mean": {"shared_policy": -24.240649526842958}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.96338614821434, 23.95588719239457, -318.28643175959587, -21.522114969789982, 14.825856879353523, 7.33997785300015, -21.32010287418963, 12.915048263967037, -8.612019941210747, -24.866759307682543, -300.2365637719631, -316.80732700228697, -290.75425330363214, -47.571655195206404, -39.762429267168045, 7.814629230648251, 0.264447323977933, 16.102820865809917, -41.07256668806076, -9.057385906577139, -4.13394878245893, 25.656271330080912, -32.41828387975694, -319.3050322234631, -25.355210760608344, -326.94068644195795, -0.8026853725314282, 46.03141586203125, -321.9484675079584, 6.049376033246503, 6.565026193857165, 2.6398298516869403, -25.489062685519457, -299.91381994262343, 22.728961139917345, -307.7800045013428, -4.2643356136977815, -351.60241919755936, 7.571359504014239, 6.533841535449014, -274.9390154853463, 6.161399941891432, -7.535422205925016, -31.3118672668934, -9.433246970176725, -28.357404142618194, -624.3609877377748, -24.76693657785654, 7.6725161038339, 36.01618967950341, -4.226368457078948, 2.9700310118496134, -15.534373108297586, -69.41179972142004, -20.471897579729557, -43.57876391708854, -282.13921190053225, -28.578132927417784, 6.671861515380442, -8.920980580151081, 30.400356233119936, 11.806654442101703, -49.80291794985533, -6.554028265178218, -11.123064134269967, 11.396584019064903, -312.6764124929905, 0.1387624628841735, -10.605055548250675, -13.045635551214218, -10.948785834014444, -318.1351944692433, -315.6618286073208, -13.257405197247891, -15.508916312828674, 0.27386073023079405, 6.888257242739201, -293.7946131676436, 21.849608972668648, 2.685017727315426, -23.857582543045297, -10.530416651628926, -11.654143534600749, 2.3210610318928815, -22.244202695786953, -271.1458948962391, -22.11172080039981, -4.8453938737511635, -265.4664967134595, 13.28053968178574, 17.309480063617215, 3.3046259710099264, -0.5856253392994404, -56.36028173565866, -286.69477144628763, -322.1692751348019, 2.9541726559400416, -41.564909905195236, -23.563512604683638, 26.970860429108114], "episode_lengths": [500, 500, 38, 500, 500, 500, 500, 500, 500, 500, 67, 65, 61, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 138, 500, 56, 500, 500, 220, 500, 500, 500, 500, 61, 500, 70, 500, 133, 500, 500, 95, 500, 500, 500, 500, 500, 50, 500, 500, 500, 500, 500, 500, 500, 500, 500, 141, 500, 500, 500, 500, 500, 500, 500, 500, 500, 187, 500, 500, 500, 500, 82, 65, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 175, 500, 500, 129, 500, 500, 500, 500, 500, 62, 65, 500, 500, 500, 500], "policy_shared_policy_reward": [-7.540777303278446, -7.601223789155483, -7.821385055780411, 8.152082715959594, 7.745994848509625, 8.057809627925351, -103.59501566489539, -101.45328234632811, -113.2381337483724, -7.456342846155167, -6.503187872469425, -7.56258425116539, 5.095379739999771, 4.935703217983246, 4.794773921370506, 2.4927179788549694, 2.140393768747643, 2.7068661053975376, -7.146050820748016, -7.206241490940258, -6.967810562501356, 4.542238116264343, 4.5649344101548195, 3.8078757375478745, -2.9435227811336517, -2.518296167254448, -3.150200992822647, -7.876177323361247, -7.926302408178657, -9.064279576142638, -96.00300444165866, -96.08749953905742, -108.14605979124705, -113.47182508309683, -101.6960249443849, -101.6394769748052, -93.02604191253583, -105.05944554011027, -92.66876585098605, -15.718129836022854, -15.638336185365915, -16.215189173817635, -13.34271801263094, -13.311305843293667, -13.108405411243439, 2.6639484564463203, 2.733729495356471, 2.4169512788454597, 0.15596147378285252, 0.11528625835974537, -0.006800408164664873, 5.491061858832836, 5.3505669683218, 5.261192038655281, -13.323193699121475, -13.545406371355057, -14.203966617584229, -2.8282846709092553, -2.9050813068946297, -3.3240199287732537, -1.3947156493862565, -1.8056079049905236, -0.9336252280821498, 8.753898938496903, 9.25190399245669, 7.65046839912732, -10.278921718398735, -10.575598026315376, -11.563764135042831, -102.23309959967932, -103.25190942486128, -113.82002319892248, -8.611877237757056, -8.544904564817756, -8.198428958033531, -104.40136748055617, -103.9578918243448, -118.58142713705699, -0.1755402783552853, -0.4707819024721829, -0.15636319170396007, 15.24292706946531, 15.22604241470495, 15.562446377860994, -103.53965503970782, -103.89558693269889, -114.51322553555171, 2.1027515505750927, 2.3115576853354725, 1.6350667973359378, 2.1298253039518897, 2.2345182547966544, 2.2006826351086204, 1.105261159439877, 0.7524950553973468, 0.7820736368497165, -8.250887040048838, -8.245195299386978, -8.992980346083641, -103.99317248662314, -97.74587628369531, -98.17477117230496, 7.754175672928483, 7.492254609862954, 7.482530857125909, -100.70158274968466, -101.89658315976462, -105.18183859189352, -1.7582402626673428, -0.8879092397789208, -1.618186111251518, -113.94336919983229, -124.51506223281226, -113.14398776491484, 2.827767842759684, 2.2516975750525745, 2.491894086201981, 2.31519604971011, 1.9059211661418232, 2.3127243195970806, -88.19145409266154, -98.54725321630637, -88.20030817637841, 2.1291699297726154, 1.8439205959439278, 2.1883094161748886, -2.5309097220500405, -2.5249291410048897, -2.479583342870086, -10.214049304525062, -10.484983260432884, -10.612834701935455, -2.543003549178451, -2.775326659282058, -4.114916761716216, -9.018816689650222, -9.406160379449531, -9.93242707351844, -205.13816916942596, -218.82679724693298, -200.3960213214159, -8.048470497131348, -8.15412975102663, -8.564336329698563, 2.6052560334404262, 3.0866978553434166, 1.9805622150500568, 12.1530125538508, 12.156548003355653, 11.70662912229696, -1.2923700908819882, -1.2654676834742276, -1.6685306827227322, 0.757336224118859, 0.8308832893768852, 1.3818114983538692, -5.36690565943718, -5.258337773382664, -4.909129675477743, -22.866920965413257, -23.116168255607292, -23.428710500399276, -7.1884802132844925, -6.812399640679359, -6.471017725765705, -14.570390512545913, -14.553430085380882, -14.454943319161742, -102.41322163740794, -89.72995862613122, -89.9960316369931, -9.386661765476077, -9.515370768805354, -9.676100393136352, 2.0524875968694687, 2.650051490403712, 1.9693224281072617, -2.94668011367321, -3.151879459619522, -2.822421006858349, 10.089684250454098, 10.145411277810723, 10.165260704855115, 4.41838527595003, 3.7237677027781757, 3.6645014633734974, -16.451056078076363, -16.091113574802876, -17.26074829697609, -1.9776290977994648, -2.0429913649956433, -2.5334078023831097, -3.6691273103157727, -3.604074260840818, -3.8498625631133763, 4.0273158103227615, 4.242019563913345, 3.1272486448287964, -100.37804882725081, -100.85848580797514, -111.43987785776457, 0.030120437343910567, 0.32936810826261365, -0.22072608272235072, -3.380931705236435, -3.4492849335074425, -3.774838909506798, -4.004612699151039, -4.464719206094742, -4.576303645968437, -3.5726697159310277, -3.4159065199395116, -3.960209598143905, -104.15290580689907, -103.42144567146897, -110.56084299087524, -116.74448279539745, -100.47006366650264, -98.44728214542071, -4.651981731255859, -4.589519863327354, -4.015903602664679, -5.150159473220512, -4.7861677749703375, -5.572589064637825, 0.5058169489105495, 0.05657059450943791, -0.2885268131891934, 2.4513993337750435, 2.520517885684967, 1.91634002327919, -92.50130670269331, -92.85480836530527, -108.43849809964499, 7.242542788386345, 7.656079143285751, 6.9509870409965515, 0.7827442735433578, 0.8577123135328293, 1.0445611402392387, -7.404768093178674, -8.160485828916237, -8.292328620950386, -3.6718118215600697, -3.580316568414375, -3.278288261654481, -3.5421003575126377, -3.8941116432348934, -4.217931533853218, 0.6295304050048145, 0.967975682889417, 0.72355494399865, -7.402131326496601, -7.472974389791489, -7.369096979498863, -95.55879779656729, -87.67736824726066, -87.90972885241112, -6.913927366336196, -7.372420450051635, -7.8253729840119775, -1.3766241557896137, -1.3217504806816578, -2.147019237279892, -82.33005095024905, -100.97712393601736, -82.15932182719311, 4.143745183944702, 4.305321976542473, 4.831472521298565, 5.703332429130867, 5.63447207709153, 5.971675557394818, 1.020969706277043, 0.8595424468318527, 1.4241138179010306, -0.5184371769428253, -0.2943423017859459, 0.22715413942933083, -17.84433261553447, -18.102881322304412, -20.413067797819778, -93.75761345773935, -95.30292046070099, -97.63423752784729, -103.24164425333342, -115.10978927214941, -103.81784160931906, 1.2659399261077198, 1.0287887652715, 0.6594439645608219, -13.04742480814457, -13.756439045071602, -14.761046051979065, -7.996519401669502, -7.7700021006166935, -7.796991102397442, 9.288415285448224, 8.59981135527292, 9.082633788386971]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15355934183660924, "mean_inference_ms": 0.6973745707349495, "mean_action_processing_ms": 0.0957393920479753, "mean_env_wait_ms": 0.7988992765533994, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 170000, "timesteps_this_iter": 0, "agent_timesteps_total": 510000, "timers": {"sample_time_ms": 10527.638, "sample_throughput": 474.94, "load_time_ms": 0.017, "load_throughput": 296207909.605, "learn_time_ms": 1907.539, "learn_throughput": 2621.179, "update_time_ms": 9.281}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005000000000000001, "total_loss": 148.05950164794922, "policy_loss": -0.0024800666726628507, "vf_loss": 148.12142181396484, "vf_explained_var": 0.24394240379333496, "kl": 0.004843858070673697, "entropy": 5.943567228317261, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 170000, "num_agent_steps_sampled": 510000, "num_steps_trained": 170000, "num_agent_steps_trained": 510000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 984, "training_iteration": 34, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-07-25", "timestamp": 1706231245, "time_this_iter_s": 10.343984842300415, "time_total_s": 363.3768799304962, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401AE6DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 363.3768799304962, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 6.521428571428572, "ram_util_percent": 50.392857142857146}}
{"episode_reward_max": 46.03141586203125, "episode_reward_min": -624.3609877377748, "episode_reward_mean": -72.95228910016478, "episode_len_mean": 416.52, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -218.82679724693298}, "policy_reward_max": {"shared_policy": 15.562446377860994}, "policy_reward_mean": {"shared_policy": -24.317429700054934}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-300.2365637719631, -316.80732700228697, -290.75425330363214, -47.571655195206404, -39.762429267168045, 7.814629230648251, 0.264447323977933, 16.102820865809917, -41.07256668806076, -9.057385906577139, -4.13394878245893, 25.656271330080912, -32.41828387975694, -319.3050322234631, -25.355210760608344, -326.94068644195795, -0.8026853725314282, 46.03141586203125, -321.9484675079584, 6.049376033246503, 6.565026193857165, 2.6398298516869403, -25.489062685519457, -299.91381994262343, 22.728961139917345, -307.7800045013428, -4.2643356136977815, -351.60241919755936, 7.571359504014239, 6.533841535449014, -274.9390154853463, 6.161399941891432, -7.535422205925016, -31.3118672668934, -9.433246970176725, -28.357404142618194, -624.3609877377748, -24.76693657785654, 7.6725161038339, 36.01618967950341, -4.226368457078948, 2.9700310118496134, -15.534373108297586, -69.41179972142004, -20.471897579729557, -43.57876391708854, -282.13921190053225, -28.578132927417784, 6.671861515380442, -8.920980580151081, 30.400356233119936, 11.806654442101703, -49.80291794985533, -6.554028265178218, -11.123064134269967, 11.396584019064903, -312.6764124929905, 0.1387624628841735, -10.605055548250675, -13.045635551214218, -10.948785834014444, -318.1351944692433, -315.6618286073208, -13.257405197247891, -15.508916312828674, 0.27386073023079405, 6.888257242739201, -293.7946131676436, 21.849608972668648, 2.685017727315426, -23.857582543045297, -10.530416651628926, -11.654143534600749, 2.3210610318928815, -22.244202695786953, -271.1458948962391, -22.11172080039981, -4.8453938737511635, -265.4664967134595, 13.28053968178574, 17.309480063617215, 3.3046259710099264, -0.5856253392994404, -56.36028173565866, -286.69477144628763, -322.1692751348019, 2.9541726559400416, -41.564909905195236, -23.563512604683638, 26.970860429108114, -20.51586303114894, 19.781877953559146, 30.802140340208993, -4.00474788993597, -50.72180529683828, -43.38944970071316, 1.1149007156491137, 9.31646115332839, 11.537076048552962, -335.48868706822395], "episode_lengths": [67, 65, 61, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 138, 500, 56, 500, 500, 220, 500, 500, 500, 500, 61, 500, 70, 500, 133, 500, 500, 95, 500, 500, 500, 500, 500, 50, 500, 500, 500, 500, 500, 500, 500, 500, 500, 141, 500, 500, 500, 500, 500, 500, 500, 500, 500, 187, 500, 500, 500, 500, 82, 65, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 175, 500, 500, 129, 500, 500, 500, 500, 500, 62, 65, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148], "policy_shared_policy_reward": [-96.00300444165866, -96.08749953905742, -108.14605979124705, -113.47182508309683, -101.6960249443849, -101.6394769748052, -93.02604191253583, -105.05944554011027, -92.66876585098605, -15.718129836022854, -15.638336185365915, -16.215189173817635, -13.34271801263094, -13.311305843293667, -13.108405411243439, 2.6639484564463203, 2.733729495356471, 2.4169512788454597, 0.15596147378285252, 0.11528625835974537, -0.006800408164664873, 5.491061858832836, 5.3505669683218, 5.261192038655281, -13.323193699121475, -13.545406371355057, -14.203966617584229, -2.8282846709092553, -2.9050813068946297, -3.3240199287732537, -1.3947156493862565, -1.8056079049905236, -0.9336252280821498, 8.753898938496903, 9.25190399245669, 7.65046839912732, -10.278921718398735, -10.575598026315376, -11.563764135042831, -102.23309959967932, -103.25190942486128, -113.82002319892248, -8.611877237757056, -8.544904564817756, -8.198428958033531, -104.40136748055617, -103.9578918243448, -118.58142713705699, -0.1755402783552853, -0.4707819024721829, -0.15636319170396007, 15.24292706946531, 15.22604241470495, 15.562446377860994, -103.53965503970782, -103.89558693269889, -114.51322553555171, 2.1027515505750927, 2.3115576853354725, 1.6350667973359378, 2.1298253039518897, 2.2345182547966544, 2.2006826351086204, 1.105261159439877, 0.7524950553973468, 0.7820736368497165, -8.250887040048838, -8.245195299386978, -8.992980346083641, -103.99317248662314, -97.74587628369531, -98.17477117230496, 7.754175672928483, 7.492254609862954, 7.482530857125909, -100.70158274968466, -101.89658315976462, -105.18183859189352, -1.7582402626673428, -0.8879092397789208, -1.618186111251518, -113.94336919983229, -124.51506223281226, -113.14398776491484, 2.827767842759684, 2.2516975750525745, 2.491894086201981, 2.31519604971011, 1.9059211661418232, 2.3127243195970806, -88.19145409266154, -98.54725321630637, -88.20030817637841, 2.1291699297726154, 1.8439205959439278, 2.1883094161748886, -2.5309097220500405, -2.5249291410048897, -2.479583342870086, -10.214049304525062, -10.484983260432884, -10.612834701935455, -2.543003549178451, -2.775326659282058, -4.114916761716216, -9.018816689650222, -9.406160379449531, -9.93242707351844, -205.13816916942596, -218.82679724693298, -200.3960213214159, -8.048470497131348, -8.15412975102663, -8.564336329698563, 2.6052560334404262, 3.0866978553434166, 1.9805622150500568, 12.1530125538508, 12.156548003355653, 11.70662912229696, -1.2923700908819882, -1.2654676834742276, -1.6685306827227322, 0.757336224118859, 0.8308832893768852, 1.3818114983538692, -5.36690565943718, -5.258337773382664, -4.909129675477743, -22.866920965413257, -23.116168255607292, -23.428710500399276, -7.1884802132844925, -6.812399640679359, -6.471017725765705, -14.570390512545913, -14.553430085380882, -14.454943319161742, -102.41322163740794, -89.72995862613122, -89.9960316369931, -9.386661765476077, -9.515370768805354, -9.676100393136352, 2.0524875968694687, 2.650051490403712, 1.9693224281072617, -2.94668011367321, -3.151879459619522, -2.822421006858349, 10.089684250454098, 10.145411277810723, 10.165260704855115, 4.41838527595003, 3.7237677027781757, 3.6645014633734974, -16.451056078076363, -16.091113574802876, -17.26074829697609, -1.9776290977994648, -2.0429913649956433, -2.5334078023831097, -3.6691273103157727, -3.604074260840818, -3.8498625631133763, 4.0273158103227615, 4.242019563913345, 3.1272486448287964, -100.37804882725081, -100.85848580797514, -111.43987785776457, 0.030120437343910567, 0.32936810826261365, -0.22072608272235072, -3.380931705236435, -3.4492849335074425, -3.774838909506798, -4.004612699151039, -4.464719206094742, -4.576303645968437, -3.5726697159310277, -3.4159065199395116, -3.960209598143905, -104.15290580689907, -103.42144567146897, -110.56084299087524, -116.74448279539745, -100.47006366650264, -98.44728214542071, -4.651981731255859, -4.589519863327354, -4.015903602664679, -5.150159473220512, -4.7861677749703375, -5.572589064637825, 0.5058169489105495, 0.05657059450943791, -0.2885268131891934, 2.4513993337750435, 2.520517885684967, 1.91634002327919, -92.50130670269331, -92.85480836530527, -108.43849809964499, 7.242542788386345, 7.656079143285751, 6.9509870409965515, 0.7827442735433578, 0.8577123135328293, 1.0445611402392387, -7.404768093178674, -8.160485828916237, -8.292328620950386, -3.6718118215600697, -3.580316568414375, -3.278288261654481, -3.5421003575126377, -3.8941116432348934, -4.217931533853218, 0.6295304050048145, 0.967975682889417, 0.72355494399865, -7.402131326496601, -7.472974389791489, -7.369096979498863, -95.55879779656729, -87.67736824726066, -87.90972885241112, -6.913927366336196, -7.372420450051635, -7.8253729840119775, -1.3766241557896137, -1.3217504806816578, -2.147019237279892, -82.33005095024905, -100.97712393601736, -82.15932182719311, 4.143745183944702, 4.305321976542473, 4.831472521298565, 5.703332429130867, 5.63447207709153, 5.971675557394818, 1.020969706277043, 0.8595424468318527, 1.4241138179010306, -0.5184371769428253, -0.2943423017859459, 0.22715413942933083, -17.84433261553447, -18.102881322304412, -20.413067797819778, -93.75761345773935, -95.30292046070099, -97.63423752784729, -103.24164425333342, -115.10978927214941, -103.81784160931906, 1.2659399261077198, 1.0287887652715, 0.6594439645608219, -13.04742480814457, -13.756439045071602, -14.761046051979065, -7.996519401669502, -7.7700021006166935, -7.796991102397442, 9.288415285448224, 8.59981135527292, 9.082633788386971, -6.953037788470596, -6.740866636236518, -6.821958606441825, 6.410897379120186, 6.177314003308609, 7.1936665711303505, 10.313533542056874, 10.322011334200695, 10.166595463951424, -1.406149946153164, -1.3745795637369156, -1.2240183800458908, -16.640729151666164, -16.903945311903954, -17.177130833268166, -14.287672385573387, -14.427190020680428, -14.674587294459343, 0.34119336803753697, 0.10898849864800297, 0.6647188489635738, 3.0374857882658546, 3.5132794554034774, 2.7656959096590583, 4.270693647364766, 3.7855033079783027, 3.480879093209893, -107.76191159586112, -107.41007580856483, -120.31669966379802]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15303690414564483, "mean_inference_ms": 0.6968332622063993, "mean_action_processing_ms": 0.09567035208241391, "mean_env_wait_ms": 0.7992627946200966, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 175000, "timesteps_this_iter": 0, "agent_timesteps_total": 525000, "timers": {"sample_time_ms": 10554.415, "sample_throughput": 473.735, "load_time_ms": 0.118, "load_throughput": 42264248.287, "learn_time_ms": 1908.867, "learn_throughput": 2619.355, "update_time_ms": 9.279}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 56.42336654663086, "policy_loss": -0.0019479526730782127, "vf_loss": 56.48474311828613, "vf_explained_var": -0.25653488636016847, "kl": 0.005921095417581567, "entropy": 5.942859363555908, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 175000, "num_agent_steps_sampled": 525000, "num_steps_trained": 175000, "num_agent_steps_trained": 525000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 994, "training_iteration": 35, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-07-36", "timestamp": 1706231256, "time_this_iter_s": 10.648193359375, "time_total_s": 374.0250732898712, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401AE6040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 374.0250732898712, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 7.38, "ram_util_percent": 50.40666666666666}}
{"episode_reward_max": 46.03141586203125, "episode_reward_min": -624.3609877377748, "episode_reward_mean": -69.00837011683383, "episode_len_mean": 420.94, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -218.82679724693298}, "policy_reward_max": {"shared_policy": 15.562446377860994}, "policy_reward_mean": {"shared_policy": -23.002790038944617}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.656271330080912, -32.41828387975694, -319.3050322234631, -25.355210760608344, -326.94068644195795, -0.8026853725314282, 46.03141586203125, -321.9484675079584, 6.049376033246503, 6.565026193857165, 2.6398298516869403, -25.489062685519457, -299.91381994262343, 22.728961139917345, -307.7800045013428, -4.2643356136977815, -351.60241919755936, 7.571359504014239, 6.533841535449014, -274.9390154853463, 6.161399941891432, -7.535422205925016, -31.3118672668934, -9.433246970176725, -28.357404142618194, -624.3609877377748, -24.76693657785654, 7.6725161038339, 36.01618967950341, -4.226368457078948, 2.9700310118496134, -15.534373108297586, -69.41179972142004, -20.471897579729557, -43.57876391708854, -282.13921190053225, -28.578132927417784, 6.671861515380442, -8.920980580151081, 30.400356233119936, 11.806654442101703, -49.80291794985533, -6.554028265178218, -11.123064134269967, 11.396584019064903, -312.6764124929905, 0.1387624628841735, -10.605055548250675, -13.045635551214218, -10.948785834014444, -318.1351944692433, -315.6618286073208, -13.257405197247891, -15.508916312828674, 0.27386073023079405, 6.888257242739201, -293.7946131676436, 21.849608972668648, 2.685017727315426, -23.857582543045297, -10.530416651628926, -11.654143534600749, 2.3210610318928815, -22.244202695786953, -271.1458948962391, -22.11172080039981, -4.8453938737511635, -265.4664967134595, 13.28053968178574, 17.309480063617215, 3.3046259710099264, -0.5856253392994404, -56.36028173565866, -286.69477144628763, -322.1692751348019, 2.9541726559400416, -41.564909905195236, -23.563512604683638, 26.970860429108114, -20.51586303114894, 19.781877953559146, 30.802140340208993, -4.00474788993597, -50.72180529683828, -43.38944970071316, 1.1149007156491137, 9.31646115332839, 11.537076048552962, -335.48868706822395, 4.8628365043550446, -311.34502086415887, -10.399702984839678, -304.7598356604576, -24.061183478683247, -1.9331884346902513, 6.990563023835406, 4.072020262479754, 10.81431280076501, -17.048698561266065, 11.985563228838146], "episode_lengths": [500, 500, 138, 500, 56, 500, 500, 220, 500, 500, 500, 500, 61, 500, 70, 500, 133, 500, 500, 95, 500, 500, 500, 500, 500, 50, 500, 500, 500, 500, 500, 500, 500, 500, 500, 141, 500, 500, 500, 500, 500, 500, 500, 500, 500, 187, 500, 500, 500, 500, 82, 65, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 175, 500, 500, 129, 500, 500, 500, 500, 500, 62, 65, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 500, 80, 500, 55, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [8.753898938496903, 9.25190399245669, 7.65046839912732, -10.278921718398735, -10.575598026315376, -11.563764135042831, -102.23309959967932, -103.25190942486128, -113.82002319892248, -8.611877237757056, -8.544904564817756, -8.198428958033531, -104.40136748055617, -103.9578918243448, -118.58142713705699, -0.1755402783552853, -0.4707819024721829, -0.15636319170396007, 15.24292706946531, 15.22604241470495, 15.562446377860994, -103.53965503970782, -103.89558693269889, -114.51322553555171, 2.1027515505750927, 2.3115576853354725, 1.6350667973359378, 2.1298253039518897, 2.2345182547966544, 2.2006826351086204, 1.105261159439877, 0.7524950553973468, 0.7820736368497165, -8.250887040048838, -8.245195299386978, -8.992980346083641, -103.99317248662314, -97.74587628369531, -98.17477117230496, 7.754175672928483, 7.492254609862954, 7.482530857125909, -100.70158274968466, -101.89658315976462, -105.18183859189352, -1.7582402626673428, -0.8879092397789208, -1.618186111251518, -113.94336919983229, -124.51506223281226, -113.14398776491484, 2.827767842759684, 2.2516975750525745, 2.491894086201981, 2.31519604971011, 1.9059211661418232, 2.3127243195970806, -88.19145409266154, -98.54725321630637, -88.20030817637841, 2.1291699297726154, 1.8439205959439278, 2.1883094161748886, -2.5309097220500405, -2.5249291410048897, -2.479583342870086, -10.214049304525062, -10.484983260432884, -10.612834701935455, -2.543003549178451, -2.775326659282058, -4.114916761716216, -9.018816689650222, -9.406160379449531, -9.93242707351844, -205.13816916942596, -218.82679724693298, -200.3960213214159, -8.048470497131348, -8.15412975102663, -8.564336329698563, 2.6052560334404262, 3.0866978553434166, 1.9805622150500568, 12.1530125538508, 12.156548003355653, 11.70662912229696, -1.2923700908819882, -1.2654676834742276, -1.6685306827227322, 0.757336224118859, 0.8308832893768852, 1.3818114983538692, -5.36690565943718, -5.258337773382664, -4.909129675477743, -22.866920965413257, -23.116168255607292, -23.428710500399276, -7.1884802132844925, -6.812399640679359, -6.471017725765705, -14.570390512545913, -14.553430085380882, -14.454943319161742, -102.41322163740794, -89.72995862613122, -89.9960316369931, -9.386661765476077, -9.515370768805354, -9.676100393136352, 2.0524875968694687, 2.650051490403712, 1.9693224281072617, -2.94668011367321, -3.151879459619522, -2.822421006858349, 10.089684250454098, 10.145411277810723, 10.165260704855115, 4.41838527595003, 3.7237677027781757, 3.6645014633734974, -16.451056078076363, -16.091113574802876, -17.26074829697609, -1.9776290977994648, -2.0429913649956433, -2.5334078023831097, -3.6691273103157727, -3.604074260840818, -3.8498625631133763, 4.0273158103227615, 4.242019563913345, 3.1272486448287964, -100.37804882725081, -100.85848580797514, -111.43987785776457, 0.030120437343910567, 0.32936810826261365, -0.22072608272235072, -3.380931705236435, -3.4492849335074425, -3.774838909506798, -4.004612699151039, -4.464719206094742, -4.576303645968437, -3.5726697159310277, -3.4159065199395116, -3.960209598143905, -104.15290580689907, -103.42144567146897, -110.56084299087524, -116.74448279539745, -100.47006366650264, -98.44728214542071, -4.651981731255859, -4.589519863327354, -4.015903602664679, -5.150159473220512, -4.7861677749703375, -5.572589064637825, 0.5058169489105495, 0.05657059450943791, -0.2885268131891934, 2.4513993337750435, 2.520517885684967, 1.91634002327919, -92.50130670269331, -92.85480836530527, -108.43849809964499, 7.242542788386345, 7.656079143285751, 6.9509870409965515, 0.7827442735433578, 0.8577123135328293, 1.0445611402392387, -7.404768093178674, -8.160485828916237, -8.292328620950386, -3.6718118215600697, -3.580316568414375, -3.278288261654481, -3.5421003575126377, -3.8941116432348934, -4.217931533853218, 0.6295304050048145, 0.967975682889417, 0.72355494399865, -7.402131326496601, -7.472974389791489, -7.369096979498863, -95.55879779656729, -87.67736824726066, -87.90972885241112, -6.913927366336196, -7.372420450051635, -7.8253729840119775, -1.3766241557896137, -1.3217504806816578, -2.147019237279892, -82.33005095024905, -100.97712393601736, -82.15932182719311, 4.143745183944702, 4.305321976542473, 4.831472521298565, 5.703332429130867, 5.63447207709153, 5.971675557394818, 1.020969706277043, 0.8595424468318527, 1.4241138179010306, -0.5184371769428253, -0.2943423017859459, 0.22715413942933083, -17.84433261553447, -18.102881322304412, -20.413067797819778, -93.75761345773935, -95.30292046070099, -97.63423752784729, -103.24164425333342, -115.10978927214941, -103.81784160931906, 1.2659399261077198, 1.0287887652715, 0.6594439645608219, -13.04742480814457, -13.756439045071602, -14.761046051979065, -7.996519401669502, -7.7700021006166935, -7.796991102397442, 9.288415285448224, 8.59981135527292, 9.082633788386971, -6.953037788470596, -6.740866636236518, -6.821958606441825, 6.410897379120186, 6.177314003308609, 7.1936665711303505, 10.313533542056874, 10.322011334200695, 10.166595463951424, -1.406149946153164, -1.3745795637369156, -1.2240183800458908, -16.640729151666164, -16.903945311903954, -17.177130833268166, -14.287672385573387, -14.427190020680428, -14.674587294459343, 0.34119336803753697, 0.10898849864800297, 0.6647188489635738, 3.0374857882658546, 3.5132794554034774, 2.7656959096590583, 4.270693647364766, 3.7855033079783027, 3.480879093209893, -107.76191159586112, -107.41007580856483, -120.31669966379802, 0.9246331850687568, 1.6977025220791404, 2.2405007972071473, -97.91281190887094, -98.59176474809647, -114.84044420719147, -3.1465258859097958, -3.3775499686598778, -3.8756271302700043, -97.44064909219742, -98.5211246907711, -108.79806187748909, -7.734105287740633, -8.241026456157371, -8.086051734785244, -0.49953967208664096, -0.8190067658821789, -0.6146419967214314, 2.178677280743912, 2.1400815596183094, 2.671804183473185, 1.3396769339839523, 1.3806176880995338, 1.3517256403962676, 3.6037645215789382, 3.4980402986208503, 3.7125079805652206, -5.765480063855648, -5.411215731874108, -5.872002765536308, 4.153030417859554, 4.243310439400375, 3.5892223715782166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524681040573023, "mean_inference_ms": 0.6965634427818236, "mean_action_processing_ms": 0.09564844060083676, "mean_env_wait_ms": 0.7997999607182102, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 180000, "timesteps_this_iter": 0, "agent_timesteps_total": 540000, "timers": {"sample_time_ms": 10605.092, "sample_throughput": 471.472, "load_time_ms": 0.218, "load_throughput": 22917189.378, "learn_time_ms": 1907.326, "learn_throughput": 2621.472, "update_time_ms": 9.298}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 134.20174407958984, "policy_loss": -0.0031190321620553794, "vf_loss": 134.26549377441407, "vf_explained_var": 0.07855666875839233, "kl": 0.007055596116699506, "entropy": 6.06273045539856, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 180000, "num_agent_steps_sampled": 540000, "num_steps_trained": 180000, "num_agent_steps_trained": 540000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1005, "training_iteration": 36, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-07-47", "timestamp": 1706231267, "time_this_iter_s": 10.77865719795227, "time_total_s": 384.8037304878235, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402DE4940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 384.8037304878235, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 8.33125, "ram_util_percent": 50.55}}
{"episode_reward_max": 36.01618967950341, "episode_reward_min": -624.3609877377748, "episode_reward_mean": -61.81709518695832, "episode_len_mean": 427.55, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -218.82679724693298}, "policy_reward_max": {"shared_policy": 12.156548003355653}, "policy_reward_mean": {"shared_policy": -20.60569839565278}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.489062685519457, -299.91381994262343, 22.728961139917345, -307.7800045013428, -4.2643356136977815, -351.60241919755936, 7.571359504014239, 6.533841535449014, -274.9390154853463, 6.161399941891432, -7.535422205925016, -31.3118672668934, -9.433246970176725, -28.357404142618194, -624.3609877377748, -24.76693657785654, 7.6725161038339, 36.01618967950341, -4.226368457078948, 2.9700310118496134, -15.534373108297586, -69.41179972142004, -20.471897579729557, -43.57876391708854, -282.13921190053225, -28.578132927417784, 6.671861515380442, -8.920980580151081, 30.400356233119936, 11.806654442101703, -49.80291794985533, -6.554028265178218, -11.123064134269967, 11.396584019064903, -312.6764124929905, 0.1387624628841735, -10.605055548250675, -13.045635551214218, -10.948785834014444, -318.1351944692433, -315.6618286073208, -13.257405197247891, -15.508916312828674, 0.27386073023079405, 6.888257242739201, -293.7946131676436, 21.849608972668648, 2.685017727315426, -23.857582543045297, -10.530416651628926, -11.654143534600749, 2.3210610318928815, -22.244202695786953, -271.1458948962391, -22.11172080039981, -4.8453938737511635, -265.4664967134595, 13.28053968178574, 17.309480063617215, 3.3046259710099264, -0.5856253392994404, -56.36028173565866, -286.69477144628763, -322.1692751348019, 2.9541726559400416, -41.564909905195236, -23.563512604683638, 26.970860429108114, -20.51586303114894, 19.781877953559146, 30.802140340208993, -4.00474788993597, -50.72180529683828, -43.38944970071316, 1.1149007156491137, 9.31646115332839, 11.537076048552962, -335.48868706822395, 4.8628365043550446, -311.34502086415887, -10.399702984839678, -304.7598356604576, -24.061183478683247, -1.9331884346902513, 6.990563023835406, 4.072020262479754, 10.81431280076501, -17.048698561266065, 11.985563228838146, 6.9913888946175575, 27.30966661497949, 3.412316983565688, 29.105373509228215, 34.42410185933112, -5.033861708827317, 2.385527618229375, -21.682388292625546, 8.294895246624918, -320.9735941514373, 15.065619498491259], "episode_lengths": [500, 61, 500, 70, 500, 133, 500, 500, 95, 500, 500, 500, 500, 500, 50, 500, 500, 500, 500, 500, 500, 500, 500, 500, 141, 500, 500, 500, 500, 500, 500, 500, 500, 500, 187, 500, 500, 500, 500, 82, 65, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 175, 500, 500, 129, 500, 500, 500, 500, 500, 62, 65, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 500, 80, 500, 55, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 75, 500], "policy_shared_policy_reward": [-8.250887040048838, -8.245195299386978, -8.992980346083641, -103.99317248662314, -97.74587628369531, -98.17477117230496, 7.754175672928483, 7.492254609862954, 7.482530857125909, -100.70158274968466, -101.89658315976462, -105.18183859189352, -1.7582402626673428, -0.8879092397789208, -1.618186111251518, -113.94336919983229, -124.51506223281226, -113.14398776491484, 2.827767842759684, 2.2516975750525745, 2.491894086201981, 2.31519604971011, 1.9059211661418232, 2.3127243195970806, -88.19145409266154, -98.54725321630637, -88.20030817637841, 2.1291699297726154, 1.8439205959439278, 2.1883094161748886, -2.5309097220500405, -2.5249291410048897, -2.479583342870086, -10.214049304525062, -10.484983260432884, -10.612834701935455, -2.543003549178451, -2.775326659282058, -4.114916761716216, -9.018816689650222, -9.406160379449531, -9.93242707351844, -205.13816916942596, -218.82679724693298, -200.3960213214159, -8.048470497131348, -8.15412975102663, -8.564336329698563, 2.6052560334404262, 3.0866978553434166, 1.9805622150500568, 12.1530125538508, 12.156548003355653, 11.70662912229696, -1.2923700908819882, -1.2654676834742276, -1.6685306827227322, 0.757336224118859, 0.8308832893768852, 1.3818114983538692, -5.36690565943718, -5.258337773382664, -4.909129675477743, -22.866920965413257, -23.116168255607292, -23.428710500399276, -7.1884802132844925, -6.812399640679359, -6.471017725765705, -14.570390512545913, -14.553430085380882, -14.454943319161742, -102.41322163740794, -89.72995862613122, -89.9960316369931, -9.386661765476077, -9.515370768805354, -9.676100393136352, 2.0524875968694687, 2.650051490403712, 1.9693224281072617, -2.94668011367321, -3.151879459619522, -2.822421006858349, 10.089684250454098, 10.145411277810723, 10.165260704855115, 4.41838527595003, 3.7237677027781757, 3.6645014633734974, -16.451056078076363, -16.091113574802876, -17.26074829697609, -1.9776290977994648, -2.0429913649956433, -2.5334078023831097, -3.6691273103157727, -3.604074260840818, -3.8498625631133763, 4.0273158103227615, 4.242019563913345, 3.1272486448287964, -100.37804882725081, -100.85848580797514, -111.43987785776457, 0.030120437343910567, 0.32936810826261365, -0.22072608272235072, -3.380931705236435, -3.4492849335074425, -3.774838909506798, -4.004612699151039, -4.464719206094742, -4.576303645968437, -3.5726697159310277, -3.4159065199395116, -3.960209598143905, -104.15290580689907, -103.42144567146897, -110.56084299087524, -116.74448279539745, -100.47006366650264, -98.44728214542071, -4.651981731255859, -4.589519863327354, -4.015903602664679, -5.150159473220512, -4.7861677749703375, -5.572589064637825, 0.5058169489105495, 0.05657059450943791, -0.2885268131891934, 2.4513993337750435, 2.520517885684967, 1.91634002327919, -92.50130670269331, -92.85480836530527, -108.43849809964499, 7.242542788386345, 7.656079143285751, 6.9509870409965515, 0.7827442735433578, 0.8577123135328293, 1.0445611402392387, -7.404768093178674, -8.160485828916237, -8.292328620950386, -3.6718118215600697, -3.580316568414375, -3.278288261654481, -3.5421003575126377, -3.8941116432348934, -4.217931533853218, 0.6295304050048145, 0.967975682889417, 0.72355494399865, -7.402131326496601, -7.472974389791489, -7.369096979498863, -95.55879779656729, -87.67736824726066, -87.90972885241112, -6.913927366336196, -7.372420450051635, -7.8253729840119775, -1.3766241557896137, -1.3217504806816578, -2.147019237279892, -82.33005095024905, -100.97712393601736, -82.15932182719311, 4.143745183944702, 4.305321976542473, 4.831472521298565, 5.703332429130867, 5.63447207709153, 5.971675557394818, 1.020969706277043, 0.8595424468318527, 1.4241138179010306, -0.5184371769428253, -0.2943423017859459, 0.22715413942933083, -17.84433261553447, -18.102881322304412, -20.413067797819778, -93.75761345773935, -95.30292046070099, -97.63423752784729, -103.24164425333342, -115.10978927214941, -103.81784160931906, 1.2659399261077198, 1.0287887652715, 0.6594439645608219, -13.04742480814457, -13.756439045071602, -14.761046051979065, -7.996519401669502, -7.7700021006166935, -7.796991102397442, 9.288415285448224, 8.59981135527292, 9.082633788386971, -6.953037788470596, -6.740866636236518, -6.821958606441825, 6.410897379120186, 6.177314003308609, 7.1936665711303505, 10.313533542056874, 10.322011334200695, 10.166595463951424, -1.406149946153164, -1.3745795637369156, -1.2240183800458908, -16.640729151666164, -16.903945311903954, -17.177130833268166, -14.287672385573387, -14.427190020680428, -14.674587294459343, 0.34119336803753697, 0.10898849864800297, 0.6647188489635738, 3.0374857882658546, 3.5132794554034774, 2.7656959096590583, 4.270693647364766, 3.7855033079783027, 3.480879093209893, -107.76191159586112, -107.41007580856483, -120.31669966379802, 0.9246331850687568, 1.6977025220791404, 2.2405007972071473, -97.91281190887094, -98.59176474809647, -114.84044420719147, -3.1465258859097958, -3.3775499686598778, -3.8756271302700043, -97.44064909219742, -98.5211246907711, -108.79806187748909, -7.734105287740633, -8.241026456157371, -8.086051734785244, -0.49953967208664096, -0.8190067658821789, -0.6146419967214314, 2.178677280743912, 2.1400815596183094, 2.671804183473185, 1.3396769339839523, 1.3806176880995338, 1.3517256403962676, 3.6037645215789382, 3.4980402986208503, 3.7125079805652206, -5.765480063855648, -5.411215731874108, -5.872002765536308, 4.153030417859554, 4.243310439400375, 3.5892223715782166, 2.4658857360482216, 1.9461094290018082, 2.5793937295675278, 8.613989522059754, 9.4468372700115, 9.248839822908238, 0.756777286529541, 1.1625825837254524, 1.4929571133106947, 10.113209423919514, 9.728343834479645, 9.263820250829056, 11.512212318678692, 11.670304251213864, 11.24158528943856, -1.6302242651581764, -1.0614615129306912, -2.342175930738449, 0.7357154836257251, 0.9158192252119335, 0.7339929093917164, -7.42168416082859, -7.463288351893425, -6.797415779903531, 2.931504371265561, 3.0292609805862014, 2.334129894773156, -102.92539515842995, -103.52633458872637, -114.52186440428099, 5.2308381224671905, 5.238868581751973, 4.595912794272095]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15190524204622663, "mean_inference_ms": 0.6960284233464131, "mean_action_processing_ms": 0.0955914270360435, "mean_env_wait_ms": 0.8001313163933744, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 185000, "timesteps_this_iter": 0, "agent_timesteps_total": 555000, "timers": {"sample_time_ms": 10582.112, "sample_throughput": 472.495, "load_time_ms": 0.218, "load_throughput": 22917189.378, "learn_time_ms": 1906.474, "learn_throughput": 2622.642, "update_time_ms": 9.348}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 89.55894165039062, "policy_loss": -0.0022324267233535646, "vf_loss": 89.62329330444337, "vf_explained_var": -0.024175620079040526, "kl": 0.010815338077374951, "entropy": 6.2118213176727295, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 185000, "num_agent_steps_sampled": 555000, "num_steps_trained": 185000, "num_agent_steps_trained": 555000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1016, "training_iteration": 37, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-07-57", "timestamp": 1706231277, "time_this_iter_s": 10.305079936981201, "time_total_s": 395.1088104248047, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D0B310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 395.1088104248047, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 5.771428571428571, "ram_util_percent": 50.535714285714285}}
{"episode_reward_max": 36.01618967950341, "episode_reward_min": -624.3609877377748, "episode_reward_mean": -48.949242535805105, "episode_len_mean": 443.96, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -218.82679724693298}, "policy_reward_max": {"shared_policy": 12.156548003355653}, "policy_reward_mean": {"shared_policy": -16.316414178601704}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.535422205925016, -31.3118672668934, -9.433246970176725, -28.357404142618194, -624.3609877377748, -24.76693657785654, 7.6725161038339, 36.01618967950341, -4.226368457078948, 2.9700310118496134, -15.534373108297586, -69.41179972142004, -20.471897579729557, -43.57876391708854, -282.13921190053225, -28.578132927417784, 6.671861515380442, -8.920980580151081, 30.400356233119936, 11.806654442101703, -49.80291794985533, -6.554028265178218, -11.123064134269967, 11.396584019064903, -312.6764124929905, 0.1387624628841735, -10.605055548250675, -13.045635551214218, -10.948785834014444, -318.1351944692433, -315.6618286073208, -13.257405197247891, -15.508916312828674, 0.27386073023079405, 6.888257242739201, -293.7946131676436, 21.849608972668648, 2.685017727315426, -23.857582543045297, -10.530416651628926, -11.654143534600749, 2.3210610318928815, -22.244202695786953, -271.1458948962391, -22.11172080039981, -4.8453938737511635, -265.4664967134595, 13.28053968178574, 17.309480063617215, 3.3046259710099264, -0.5856253392994404, -56.36028173565866, -286.69477144628763, -322.1692751348019, 2.9541726559400416, -41.564909905195236, -23.563512604683638, 26.970860429108114, -20.51586303114894, 19.781877953559146, 30.802140340208993, -4.00474788993597, -50.72180529683828, -43.38944970071316, 1.1149007156491137, 9.31646115332839, 11.537076048552962, -335.48868706822395, 4.8628365043550446, -311.34502086415887, -10.399702984839678, -304.7598356604576, -24.061183478683247, -1.9331884346902513, 6.990563023835406, 4.072020262479754, 10.81431280076501, -17.048698561266065, 11.985563228838146, 6.9913888946175575, 27.30966661497949, 3.412316983565688, 29.105373509228215, 34.42410185933112, -5.033861708827317, 2.385527618229375, -21.682388292625546, 8.294895246624918, -320.9735941514373, 15.065619498491259, 23.507946483790874, -21.908814422786264, -14.085436459630742, 12.764196798205361, 2.999198362231226, -1.4461157694459246, 1.446894414722891, 24.70076446235177, 16.488589574815677, 21.324946366250515], "episode_lengths": [500, 500, 500, 500, 50, 500, 500, 500, 500, 500, 500, 500, 500, 500, 141, 500, 500, 500, 500, 500, 500, 500, 500, 500, 187, 500, 500, 500, 500, 82, 65, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 175, 500, 500, 129, 500, 500, 500, 500, 500, 62, 65, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 500, 80, 500, 55, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-2.5309097220500405, -2.5249291410048897, -2.479583342870086, -10.214049304525062, -10.484983260432884, -10.612834701935455, -2.543003549178451, -2.775326659282058, -4.114916761716216, -9.018816689650222, -9.406160379449531, -9.93242707351844, -205.13816916942596, -218.82679724693298, -200.3960213214159, -8.048470497131348, -8.15412975102663, -8.564336329698563, 2.6052560334404262, 3.0866978553434166, 1.9805622150500568, 12.1530125538508, 12.156548003355653, 11.70662912229696, -1.2923700908819882, -1.2654676834742276, -1.6685306827227322, 0.757336224118859, 0.8308832893768852, 1.3818114983538692, -5.36690565943718, -5.258337773382664, -4.909129675477743, -22.866920965413257, -23.116168255607292, -23.428710500399276, -7.1884802132844925, -6.812399640679359, -6.471017725765705, -14.570390512545913, -14.553430085380882, -14.454943319161742, -102.41322163740794, -89.72995862613122, -89.9960316369931, -9.386661765476077, -9.515370768805354, -9.676100393136352, 2.0524875968694687, 2.650051490403712, 1.9693224281072617, -2.94668011367321, -3.151879459619522, -2.822421006858349, 10.089684250454098, 10.145411277810723, 10.165260704855115, 4.41838527595003, 3.7237677027781757, 3.6645014633734974, -16.451056078076363, -16.091113574802876, -17.26074829697609, -1.9776290977994648, -2.0429913649956433, -2.5334078023831097, -3.6691273103157727, -3.604074260840818, -3.8498625631133763, 4.0273158103227615, 4.242019563913345, 3.1272486448287964, -100.37804882725081, -100.85848580797514, -111.43987785776457, 0.030120437343910567, 0.32936810826261365, -0.22072608272235072, -3.380931705236435, -3.4492849335074425, -3.774838909506798, -4.004612699151039, -4.464719206094742, -4.576303645968437, -3.5726697159310277, -3.4159065199395116, -3.960209598143905, -104.15290580689907, -103.42144567146897, -110.56084299087524, -116.74448279539745, -100.47006366650264, -98.44728214542071, -4.651981731255859, -4.589519863327354, -4.015903602664679, -5.150159473220512, -4.7861677749703375, -5.572589064637825, 0.5058169489105495, 0.05657059450943791, -0.2885268131891934, 2.4513993337750435, 2.520517885684967, 1.91634002327919, -92.50130670269331, -92.85480836530527, -108.43849809964499, 7.242542788386345, 7.656079143285751, 6.9509870409965515, 0.7827442735433578, 0.8577123135328293, 1.0445611402392387, -7.404768093178674, -8.160485828916237, -8.292328620950386, -3.6718118215600697, -3.580316568414375, -3.278288261654481, -3.5421003575126377, -3.8941116432348934, -4.217931533853218, 0.6295304050048145, 0.967975682889417, 0.72355494399865, -7.402131326496601, -7.472974389791489, -7.369096979498863, -95.55879779656729, -87.67736824726066, -87.90972885241112, -6.913927366336196, -7.372420450051635, -7.8253729840119775, -1.3766241557896137, -1.3217504806816578, -2.147019237279892, -82.33005095024905, -100.97712393601736, -82.15932182719311, 4.143745183944702, 4.305321976542473, 4.831472521298565, 5.703332429130867, 5.63447207709153, 5.971675557394818, 1.020969706277043, 0.8595424468318527, 1.4241138179010306, -0.5184371769428253, -0.2943423017859459, 0.22715413942933083, -17.84433261553447, -18.102881322304412, -20.413067797819778, -93.75761345773935, -95.30292046070099, -97.63423752784729, -103.24164425333342, -115.10978927214941, -103.81784160931906, 1.2659399261077198, 1.0287887652715, 0.6594439645608219, -13.04742480814457, -13.756439045071602, -14.761046051979065, -7.996519401669502, -7.7700021006166935, -7.796991102397442, 9.288415285448224, 8.59981135527292, 9.082633788386971, -6.953037788470596, -6.740866636236518, -6.821958606441825, 6.410897379120186, 6.177314003308609, 7.1936665711303505, 10.313533542056874, 10.322011334200695, 10.166595463951424, -1.406149946153164, -1.3745795637369156, -1.2240183800458908, -16.640729151666164, -16.903945311903954, -17.177130833268166, -14.287672385573387, -14.427190020680428, -14.674587294459343, 0.34119336803753697, 0.10898849864800297, 0.6647188489635738, 3.0374857882658546, 3.5132794554034774, 2.7656959096590583, 4.270693647364766, 3.7855033079783027, 3.480879093209893, -107.76191159586112, -107.41007580856483, -120.31669966379802, 0.9246331850687568, 1.6977025220791404, 2.2405007972071473, -97.91281190887094, -98.59176474809647, -114.84044420719147, -3.1465258859097958, -3.3775499686598778, -3.8756271302700043, -97.44064909219742, -98.5211246907711, -108.79806187748909, -7.734105287740633, -8.241026456157371, -8.086051734785244, -0.49953967208664096, -0.8190067658821789, -0.6146419967214314, 2.178677280743912, 2.1400815596183094, 2.671804183473185, 1.3396769339839523, 1.3806176880995338, 1.3517256403962676, 3.6037645215789382, 3.4980402986208503, 3.7125079805652206, -5.765480063855648, -5.411215731874108, -5.872002765536308, 4.153030417859554, 4.243310439400375, 3.5892223715782166, 2.4658857360482216, 1.9461094290018082, 2.5793937295675278, 8.613989522059754, 9.4468372700115, 9.248839822908238, 0.756777286529541, 1.1625825837254524, 1.4929571133106947, 10.113209423919514, 9.728343834479645, 9.263820250829056, 11.512212318678692, 11.670304251213864, 11.24158528943856, -1.6302242651581764, -1.0614615129306912, -2.342175930738449, 0.7357154836257251, 0.9158192252119335, 0.7339929093917164, -7.42168416082859, -7.463288351893425, -6.797415779903531, 2.931504371265561, 3.0292609805862014, 2.334129894773156, -102.92539515842995, -103.52633458872637, -114.52186440428099, 5.2308381224671905, 5.238868581751973, 4.595912794272095, 8.138104222714901, 7.577474072575569, 7.792368188500404, -7.132022542258113, -7.180302118261665, -7.596489762266486, -4.686305428544685, -5.330233107010528, -4.068897924075529, 4.175377671917275, 4.208551382025078, 4.3802677442630085, 0.9833187113205497, 0.9852375338474815, 1.030642117063195, -0.25867385913929297, -0.872275700171798, -0.3151662101348336, 0.15128929416337655, 0.6984604174892013, 0.5971447030703132, 8.432444150249154, 7.916889081398637, 8.35143123070398, 5.64387661839524, 5.865323278975353, 4.979389677445084, 6.632815912365913, 7.197159022092819, 7.494971431791782]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15145993686419326, "mean_inference_ms": 0.6963590813333839, "mean_action_processing_ms": 0.09566469950447534, "mean_env_wait_ms": 0.8009427586461183, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 190000, "timesteps_this_iter": 0, "agent_timesteps_total": 570000, "timers": {"sample_time_ms": 10631.543, "sample_throughput": 470.299, "load_time_ms": 0.318, "load_throughput": 15720779.61, "learn_time_ms": 1915.064, "learn_throughput": 2610.879, "update_time_ms": 9.349}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 17.03150806427002, "policy_loss": -0.002072805856212512, "vf_loss": 17.09743537902832, "vf_explained_var": -1.0, "kl": 0.004608139104678041, "entropy": 6.38543848991394, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 190000, "num_agent_steps_sampled": 570000, "num_steps_trained": 190000, "num_agent_steps_trained": 570000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1026, "training_iteration": 38, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-08-08", "timestamp": 1706231288, "time_this_iter_s": 11.036141157150269, "time_total_s": 406.14495158195496, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214008314C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 406.14495158195496, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 7.518750000000001, "ram_util_percent": 50.75}}
{"episode_reward_max": 34.42410185933112, "episode_reward_min": -335.48868706822395, "episode_reward_mean": -43.22964824878961, "episode_len_mean": 448.46, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -120.31669966379802}, "policy_reward_max": {"shared_policy": 11.670304251213864}, "policy_reward_mean": {"shared_policy": -14.40988274959654}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.534373108297586, -69.41179972142004, -20.471897579729557, -43.57876391708854, -282.13921190053225, -28.578132927417784, 6.671861515380442, -8.920980580151081, 30.400356233119936, 11.806654442101703, -49.80291794985533, -6.554028265178218, -11.123064134269967, 11.396584019064903, -312.6764124929905, 0.1387624628841735, -10.605055548250675, -13.045635551214218, -10.948785834014444, -318.1351944692433, -315.6618286073208, -13.257405197247891, -15.508916312828674, 0.27386073023079405, 6.888257242739201, -293.7946131676436, 21.849608972668648, 2.685017727315426, -23.857582543045297, -10.530416651628926, -11.654143534600749, 2.3210610318928815, -22.244202695786953, -271.1458948962391, -22.11172080039981, -4.8453938737511635, -265.4664967134595, 13.28053968178574, 17.309480063617215, 3.3046259710099264, -0.5856253392994404, -56.36028173565866, -286.69477144628763, -322.1692751348019, 2.9541726559400416, -41.564909905195236, -23.563512604683638, 26.970860429108114, -20.51586303114894, 19.781877953559146, 30.802140340208993, -4.00474788993597, -50.72180529683828, -43.38944970071316, 1.1149007156491137, 9.31646115332839, 11.537076048552962, -335.48868706822395, 4.8628365043550446, -311.34502086415887, -10.399702984839678, -304.7598356604576, -24.061183478683247, -1.9331884346902513, 6.990563023835406, 4.072020262479754, 10.81431280076501, -17.048698561266065, 11.985563228838146, 6.9913888946175575, 27.30966661497949, 3.412316983565688, 29.105373509228215, 34.42410185933112, -5.033861708827317, 2.385527618229375, -21.682388292625546, 8.294895246624918, -320.9735941514373, 15.065619498491259, 23.507946483790874, -21.908814422786264, -14.085436459630742, 12.764196798205361, 2.999198362231226, -1.4461157694459246, 1.446894414722891, 24.70076446235177, 16.488589574815677, 21.324946366250515, 25.919451743364334, 4.871542662382112, -11.074898093938842, -19.70850783586505, -17.614273410290508, -27.459153391420855, -18.678910218179254, -32.184256449341774, -35.67606706917286, 20.23100420087573], "episode_lengths": [500, 500, 500, 500, 141, 500, 500, 500, 500, 500, 500, 500, 500, 500, 187, 500, 500, 500, 500, 82, 65, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 175, 500, 500, 129, 500, 500, 500, 500, 500, 62, 65, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 500, 80, 500, 55, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-5.36690565943718, -5.258337773382664, -4.909129675477743, -22.866920965413257, -23.116168255607292, -23.428710500399276, -7.1884802132844925, -6.812399640679359, -6.471017725765705, -14.570390512545913, -14.553430085380882, -14.454943319161742, -102.41322163740794, -89.72995862613122, -89.9960316369931, -9.386661765476077, -9.515370768805354, -9.676100393136352, 2.0524875968694687, 2.650051490403712, 1.9693224281072617, -2.94668011367321, -3.151879459619522, -2.822421006858349, 10.089684250454098, 10.145411277810723, 10.165260704855115, 4.41838527595003, 3.7237677027781757, 3.6645014633734974, -16.451056078076363, -16.091113574802876, -17.26074829697609, -1.9776290977994648, -2.0429913649956433, -2.5334078023831097, -3.6691273103157727, -3.604074260840818, -3.8498625631133763, 4.0273158103227615, 4.242019563913345, 3.1272486448287964, -100.37804882725081, -100.85848580797514, -111.43987785776457, 0.030120437343910567, 0.32936810826261365, -0.22072608272235072, -3.380931705236435, -3.4492849335074425, -3.774838909506798, -4.004612699151039, -4.464719206094742, -4.576303645968437, -3.5726697159310277, -3.4159065199395116, -3.960209598143905, -104.15290580689907, -103.42144567146897, -110.56084299087524, -116.74448279539745, -100.47006366650264, -98.44728214542071, -4.651981731255859, -4.589519863327354, -4.015903602664679, -5.150159473220512, -4.7861677749703375, -5.572589064637825, 0.5058169489105495, 0.05657059450943791, -0.2885268131891934, 2.4513993337750435, 2.520517885684967, 1.91634002327919, -92.50130670269331, -92.85480836530527, -108.43849809964499, 7.242542788386345, 7.656079143285751, 6.9509870409965515, 0.7827442735433578, 0.8577123135328293, 1.0445611402392387, -7.404768093178674, -8.160485828916237, -8.292328620950386, -3.6718118215600697, -3.580316568414375, -3.278288261654481, -3.5421003575126377, -3.8941116432348934, -4.217931533853218, 0.6295304050048145, 0.967975682889417, 0.72355494399865, -7.402131326496601, -7.472974389791489, -7.369096979498863, -95.55879779656729, -87.67736824726066, -87.90972885241112, -6.913927366336196, -7.372420450051635, -7.8253729840119775, -1.3766241557896137, -1.3217504806816578, -2.147019237279892, -82.33005095024905, -100.97712393601736, -82.15932182719311, 4.143745183944702, 4.305321976542473, 4.831472521298565, 5.703332429130867, 5.63447207709153, 5.971675557394818, 1.020969706277043, 0.8595424468318527, 1.4241138179010306, -0.5184371769428253, -0.2943423017859459, 0.22715413942933083, -17.84433261553447, -18.102881322304412, -20.413067797819778, -93.75761345773935, -95.30292046070099, -97.63423752784729, -103.24164425333342, -115.10978927214941, -103.81784160931906, 1.2659399261077198, 1.0287887652715, 0.6594439645608219, -13.04742480814457, -13.756439045071602, -14.761046051979065, -7.996519401669502, -7.7700021006166935, -7.796991102397442, 9.288415285448224, 8.59981135527292, 9.082633788386971, -6.953037788470596, -6.740866636236518, -6.821958606441825, 6.410897379120186, 6.177314003308609, 7.1936665711303505, 10.313533542056874, 10.322011334200695, 10.166595463951424, -1.406149946153164, -1.3745795637369156, -1.2240183800458908, -16.640729151666164, -16.903945311903954, -17.177130833268166, -14.287672385573387, -14.427190020680428, -14.674587294459343, 0.34119336803753697, 0.10898849864800297, 0.6647188489635738, 3.0374857882658546, 3.5132794554034774, 2.7656959096590583, 4.270693647364766, 3.7855033079783027, 3.480879093209893, -107.76191159586112, -107.41007580856483, -120.31669966379802, 0.9246331850687568, 1.6977025220791404, 2.2405007972071473, -97.91281190887094, -98.59176474809647, -114.84044420719147, -3.1465258859097958, -3.3775499686598778, -3.8756271302700043, -97.44064909219742, -98.5211246907711, -108.79806187748909, -7.734105287740633, -8.241026456157371, -8.086051734785244, -0.49953967208664096, -0.8190067658821789, -0.6146419967214314, 2.178677280743912, 2.1400815596183094, 2.671804183473185, 1.3396769339839523, 1.3806176880995338, 1.3517256403962676, 3.6037645215789382, 3.4980402986208503, 3.7125079805652206, -5.765480063855648, -5.411215731874108, -5.872002765536308, 4.153030417859554, 4.243310439400375, 3.5892223715782166, 2.4658857360482216, 1.9461094290018082, 2.5793937295675278, 8.613989522059754, 9.4468372700115, 9.248839822908238, 0.756777286529541, 1.1625825837254524, 1.4929571133106947, 10.113209423919514, 9.728343834479645, 9.263820250829056, 11.512212318678692, 11.670304251213864, 11.24158528943856, -1.6302242651581764, -1.0614615129306912, -2.342175930738449, 0.7357154836257251, 0.9158192252119335, 0.7339929093917164, -7.42168416082859, -7.463288351893425, -6.797415779903531, 2.931504371265561, 3.0292609805862014, 2.334129894773156, -102.92539515842995, -103.52633458872637, -114.52186440428099, 5.2308381224671905, 5.238868581751973, 4.595912794272095, 8.138104222714901, 7.577474072575569, 7.792368188500404, -7.132022542258113, -7.180302118261665, -7.596489762266486, -4.686305428544685, -5.330233107010528, -4.068897924075529, 4.175377671917275, 4.208551382025078, 4.3802677442630085, 0.9833187113205497, 0.9852375338474815, 1.030642117063195, -0.25867385913929297, -0.872275700171798, -0.3151662101348336, 0.15128929416337655, 0.6984604174892013, 0.5971447030703132, 8.432444150249154, 7.916889081398637, 8.35143123070398, 5.64387661839524, 5.865323278975353, 4.979389677445084, 6.632815912365913, 7.197159022092819, 7.494971431791782, 8.922742739319801, 8.56129264831543, 8.435416355729103, 2.064962779482201, 1.7218622018893512, 1.0847176810105594, -3.5220631460348812, -3.651007364193603, -3.9018275837103573, -6.208575551708549, -6.620310654242843, -6.879621629913657, -5.865269613762706, -5.97740722199282, -5.771596574534982, -8.8511881629626, -8.50908749053876, -10.098877737919494, -6.045896177490562, -6.392976333697646, -6.240037706991046, -10.43450017273426, -10.155980259180069, -11.593776017427444, -11.655515372753143, -12.157916218042374, -11.862635478377342, 6.815766813854367, 6.667585382858903, 6.747652004162461]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15102315965058988, "mean_inference_ms": 0.6961003954133534, "mean_action_processing_ms": 0.0956233621647893, "mean_env_wait_ms": 0.8011446796991507, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 195000, "timesteps_this_iter": 0, "agent_timesteps_total": 585000, "timers": {"sample_time_ms": 10685.084, "sample_throughput": 467.942, "load_time_ms": 0.318, "load_throughput": 15720779.61, "learn_time_ms": 1913.19, "learn_throughput": 2613.436, "update_time_ms": 9.34}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0005000000000000001, "total_loss": 18.724139595031737, "policy_loss": -0.002027309828835211, "vf_loss": 18.7909143447876, "vf_explained_var": -1.0, "kl": 0.0051657742791604505, "entropy": 6.47464919090271, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 195000, "num_agent_steps_sampled": 585000, "num_steps_trained": 195000, "num_agent_steps_trained": 585000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1036, "training_iteration": 39, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-08-19", "timestamp": 1706231299, "time_this_iter_s": 10.914793252944946, "time_total_s": 417.0597448348999, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402DE2C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 417.0597448348999, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 7.746666666666666, "ram_util_percent": 51.180000000000014}}
{"episode_reward_max": 34.42410185933112, "episode_reward_min": -405.225096013397, "episode_reward_mean": -51.89353161597974, "episode_len_mean": 438.16, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {"shared_policy": -147.14078438282013}, "policy_reward_max": {"shared_policy": 11.670304251213864}, "policy_reward_mean": {"shared_policy": -17.297843871993248}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-312.6764124929905, 0.1387624628841735, -10.605055548250675, -13.045635551214218, -10.948785834014444, -318.1351944692433, -315.6618286073208, -13.257405197247891, -15.508916312828674, 0.27386073023079405, 6.888257242739201, -293.7946131676436, 21.849608972668648, 2.685017727315426, -23.857582543045297, -10.530416651628926, -11.654143534600749, 2.3210610318928815, -22.244202695786953, -271.1458948962391, -22.11172080039981, -4.8453938737511635, -265.4664967134595, 13.28053968178574, 17.309480063617215, 3.3046259710099264, -0.5856253392994404, -56.36028173565866, -286.69477144628763, -322.1692751348019, 2.9541726559400416, -41.564909905195236, -23.563512604683638, 26.970860429108114, -20.51586303114894, 19.781877953559146, 30.802140340208993, -4.00474788993597, -50.72180529683828, -43.38944970071316, 1.1149007156491137, 9.31646115332839, 11.537076048552962, -335.48868706822395, 4.8628365043550446, -311.34502086415887, -10.399702984839678, -304.7598356604576, -24.061183478683247, -1.9331884346902513, 6.990563023835406, 4.072020262479754, 10.81431280076501, -17.048698561266065, 11.985563228838146, 6.9913888946175575, 27.30966661497949, 3.412316983565688, 29.105373509228215, 34.42410185933112, -5.033861708827317, 2.385527618229375, -21.682388292625546, 8.294895246624918, -320.9735941514373, 15.065619498491259, 23.507946483790874, -21.908814422786264, -14.085436459630742, 12.764196798205361, 2.999198362231226, -1.4461157694459246, 1.446894414722891, 24.70076446235177, 16.488589574815677, 21.324946366250515, 25.919451743364334, 4.871542662382112, -11.074898093938842, -19.70850783586505, -17.614273410290508, -27.459153391420855, -18.678910218179254, -32.184256449341774, -35.67606706917286, 20.23100420087573, -14.135480895638494, -0.009219657629742528, 7.987687084823818, -301.98660176992416, 10.64686829969287, -1.9363673068583154, 4.810580581426592, 11.603179708123207, -405.225096013397, -18.55900473147632, -322.07879292964935, -13.995264705270557, -0.3998616673052595, -298.95067659020424], "episode_lengths": [187, 500, 500, 500, 500, 82, 65, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 175, 500, 500, 129, 500, 500, 500, 500, 500, 62, 65, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 500, 80, 500, 55, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 54, 500, 500, 500, 500, 427, 500, 52, 500, 500, 78], "policy_shared_policy_reward": [-100.37804882725081, -100.85848580797514, -111.43987785776457, 0.030120437343910567, 0.32936810826261365, -0.22072608272235072, -3.380931705236435, -3.4492849335074425, -3.774838909506798, -4.004612699151039, -4.464719206094742, -4.576303645968437, -3.5726697159310277, -3.4159065199395116, -3.960209598143905, -104.15290580689907, -103.42144567146897, -110.56084299087524, -116.74448279539745, -100.47006366650264, -98.44728214542071, -4.651981731255859, -4.589519863327354, -4.015903602664679, -5.150159473220512, -4.7861677749703375, -5.572589064637825, 0.5058169489105495, 0.05657059450943791, -0.2885268131891934, 2.4513993337750435, 2.520517885684967, 1.91634002327919, -92.50130670269331, -92.85480836530527, -108.43849809964499, 7.242542788386345, 7.656079143285751, 6.9509870409965515, 0.7827442735433578, 0.8577123135328293, 1.0445611402392387, -7.404768093178674, -8.160485828916237, -8.292328620950386, -3.6718118215600697, -3.580316568414375, -3.278288261654481, -3.5421003575126377, -3.8941116432348934, -4.217931533853218, 0.6295304050048145, 0.967975682889417, 0.72355494399865, -7.402131326496601, -7.472974389791489, -7.369096979498863, -95.55879779656729, -87.67736824726066, -87.90972885241112, -6.913927366336196, -7.372420450051635, -7.8253729840119775, -1.3766241557896137, -1.3217504806816578, -2.147019237279892, -82.33005095024905, -100.97712393601736, -82.15932182719311, 4.143745183944702, 4.305321976542473, 4.831472521298565, 5.703332429130867, 5.63447207709153, 5.971675557394818, 1.020969706277043, 0.8595424468318527, 1.4241138179010306, -0.5184371769428253, -0.2943423017859459, 0.22715413942933083, -17.84433261553447, -18.102881322304412, -20.413067797819778, -93.75761345773935, -95.30292046070099, -97.63423752784729, -103.24164425333342, -115.10978927214941, -103.81784160931906, 1.2659399261077198, 1.0287887652715, 0.6594439645608219, -13.04742480814457, -13.756439045071602, -14.761046051979065, -7.996519401669502, -7.7700021006166935, -7.796991102397442, 9.288415285448224, 8.59981135527292, 9.082633788386971, -6.953037788470596, -6.740866636236518, -6.821958606441825, 6.410897379120186, 6.177314003308609, 7.1936665711303505, 10.313533542056874, 10.322011334200695, 10.166595463951424, -1.406149946153164, -1.3745795637369156, -1.2240183800458908, -16.640729151666164, -16.903945311903954, -17.177130833268166, -14.287672385573387, -14.427190020680428, -14.674587294459343, 0.34119336803753697, 0.10898849864800297, 0.6647188489635738, 3.0374857882658546, 3.5132794554034774, 2.7656959096590583, 4.270693647364766, 3.7855033079783027, 3.480879093209893, -107.76191159586112, -107.41007580856483, -120.31669966379802, 0.9246331850687568, 1.6977025220791404, 2.2405007972071473, -97.91281190887094, -98.59176474809647, -114.84044420719147, -3.1465258859097958, -3.3775499686598778, -3.8756271302700043, -97.44064909219742, -98.5211246907711, -108.79806187748909, -7.734105287740633, -8.241026456157371, -8.086051734785244, -0.49953967208664096, -0.8190067658821789, -0.6146419967214314, 2.178677280743912, 2.1400815596183094, 2.671804183473185, 1.3396769339839523, 1.3806176880995338, 1.3517256403962676, 3.6037645215789382, 3.4980402986208503, 3.7125079805652206, -5.765480063855648, -5.411215731874108, -5.872002765536308, 4.153030417859554, 4.243310439400375, 3.5892223715782166, 2.4658857360482216, 1.9461094290018082, 2.5793937295675278, 8.613989522059754, 9.4468372700115, 9.248839822908238, 0.756777286529541, 1.1625825837254524, 1.4929571133106947, 10.113209423919514, 9.728343834479645, 9.263820250829056, 11.512212318678692, 11.670304251213864, 11.24158528943856, -1.6302242651581764, -1.0614615129306912, -2.342175930738449, 0.7357154836257251, 0.9158192252119335, 0.7339929093917164, -7.42168416082859, -7.463288351893425, -6.797415779903531, 2.931504371265561, 3.0292609805862014, 2.334129894773156, -102.92539515842995, -103.52633458872637, -114.52186440428099, 5.2308381224671905, 5.238868581751973, 4.595912794272095, 8.138104222714901, 7.577474072575569, 7.792368188500404, -7.132022542258113, -7.180302118261665, -7.596489762266486, -4.686305428544685, -5.330233107010528, -4.068897924075529, 4.175377671917275, 4.208551382025078, 4.3802677442630085, 0.9833187113205497, 0.9852375338474815, 1.030642117063195, -0.25867385913929297, -0.872275700171798, -0.3151662101348336, 0.15128929416337655, 0.6984604174892013, 0.5971447030703132, 8.432444150249154, 7.916889081398637, 8.35143123070398, 5.64387661839524, 5.865323278975353, 4.979389677445084, 6.632815912365913, 7.197159022092819, 7.494971431791782, 8.922742739319801, 8.56129264831543, 8.435416355729103, 2.064962779482201, 1.7218622018893512, 1.0847176810105594, -3.5220631460348812, -3.651007364193603, -3.9018275837103573, -6.208575551708549, -6.620310654242843, -6.879621629913657, -5.865269613762706, -5.97740722199282, -5.771596574534982, -8.8511881629626, -8.50908749053876, -10.098877737919494, -6.045896177490562, -6.392976333697646, -6.240037706991046, -10.43450017273426, -10.155980259180069, -11.593776017427444, -11.655515372753143, -12.157916218042374, -11.862635478377342, 6.815766813854367, 6.667585382858903, 6.747652004162461, -4.781721731026977, -4.434500907858222, -4.919258256753295, -0.002572620908424028, 0.3185124782224449, -0.3251595149437634, 2.5480227048198287, 2.610682422916085, 2.8289819570879047, -102.4068974852562, -99.1208758354187, -100.45882844924927, 3.432399682700634, 3.566149190068245, 3.6483194269239902, -0.8028288135925976, -0.8538318375746456, -0.2797066556910721, 1.4874162922302787, 1.5442622850338523, 1.778902004162461, 3.8923892080783844, 3.951795816421509, 3.758994683623314, -129.76423037052155, -128.3200812600553, -147.14078438282013, -5.813971879581615, -6.2123949180046765, -6.53263793389003, -103.94486025969188, -103.21316526333491, -114.92076740662257, -4.491985754420369, -4.765716714163631, -4.737562236686557, 0.00869770968952821, -0.36247633894285514, -0.04608303805193259, -97.80424400170645, -97.90295659502348, -103.24347599347433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15051752328854423, "mean_inference_ms": 0.6952587787532484, "mean_action_processing_ms": 0.09557695141893734, "mean_env_wait_ms": 0.8012781586823248, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 200000, "timesteps_this_iter": 0, "agent_timesteps_total": 600000, "timers": {"sample_time_ms": 10671.607, "sample_throughput": 468.533, "load_time_ms": 0.318, "load_throughput": 15720779.61, "learn_time_ms": 1902.108, "learn_throughput": 2628.662, "update_time_ms": 9.142}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0005000000000000001, "total_loss": 288.1697204589844, "policy_loss": -0.002479494282460415, "vf_loss": 288.23744506835936, "vf_explained_var": 0.1708044409751892, "kl": 0.004340747662357367, "entropy": 6.525470018386841, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 200000, "num_agent_steps_sampled": 600000, "num_steps_trained": 200000, "num_agent_steps_trained": 600000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1050, "training_iteration": 40, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-08-30", "timestamp": 1706231310, "time_this_iter_s": 10.735759973526001, "time_total_s": 427.7955048084259, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402E08A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 427.7955048084259, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 5.166666666666667, "ram_util_percent": 50.973333333333336}}
{"episode_reward_max": 34.42410185933112, "episode_reward_min": -405.225096013397, "episode_reward_mean": -45.07949437160394, "episode_len_mean": 446.18, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -147.14078438282013}, "policy_reward_max": {"shared_policy": 11.670304251213864}, "policy_reward_mean": {"shared_policy": -15.026498123867986}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-293.7946131676436, 21.849608972668648, 2.685017727315426, -23.857582543045297, -10.530416651628926, -11.654143534600749, 2.3210610318928815, -22.244202695786953, -271.1458948962391, -22.11172080039981, -4.8453938737511635, -265.4664967134595, 13.28053968178574, 17.309480063617215, 3.3046259710099264, -0.5856253392994404, -56.36028173565866, -286.69477144628763, -322.1692751348019, 2.9541726559400416, -41.564909905195236, -23.563512604683638, 26.970860429108114, -20.51586303114894, 19.781877953559146, 30.802140340208993, -4.00474788993597, -50.72180529683828, -43.38944970071316, 1.1149007156491137, 9.31646115332839, 11.537076048552962, -335.48868706822395, 4.8628365043550446, -311.34502086415887, -10.399702984839678, -304.7598356604576, -24.061183478683247, -1.9331884346902513, 6.990563023835406, 4.072020262479754, 10.81431280076501, -17.048698561266065, 11.985563228838146, 6.9913888946175575, 27.30966661497949, 3.412316983565688, 29.105373509228215, 34.42410185933112, -5.033861708827317, 2.385527618229375, -21.682388292625546, 8.294895246624918, -320.9735941514373, 15.065619498491259, 23.507946483790874, -21.908814422786264, -14.085436459630742, 12.764196798205361, 2.999198362231226, -1.4461157694459246, 1.446894414722891, 24.70076446235177, 16.488589574815677, 21.324946366250515, 25.919451743364334, 4.871542662382112, -11.074898093938842, -19.70850783586505, -17.614273410290508, -27.459153391420855, -18.678910218179254, -32.184256449341774, -35.67606706917286, 20.23100420087573, -14.135480895638494, -0.009219657629742528, 7.987687084823818, -301.98660176992416, 10.64686829969287, -1.9363673068583154, 4.810580581426592, 11.603179708123207, -405.225096013397, -18.55900473147632, -322.07879292964935, -13.995264705270557, -0.3998616673052595, -298.95067659020424, 15.560002513229847, -295.80638441443443, 7.628704363480182, 17.04415088891983, 1.7206353545188904, -5.768832970410585, -3.265569278970375, -16.482952475547805, 5.552848199382424, -53.30280882865192, 5.985577508807168], "episode_lengths": [82, 500, 500, 500, 500, 500, 500, 500, 175, 500, 500, 129, 500, 500, 500, 500, 500, 62, 65, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 500, 80, 500, 55, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 54, 500, 500, 500, 500, 427, 500, 52, 500, 500, 78, 500, 136, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-92.50130670269331, -92.85480836530527, -108.43849809964499, 7.242542788386345, 7.656079143285751, 6.9509870409965515, 0.7827442735433578, 0.8577123135328293, 1.0445611402392387, -7.404768093178674, -8.160485828916237, -8.292328620950386, -3.6718118215600697, -3.580316568414375, -3.278288261654481, -3.5421003575126377, -3.8941116432348934, -4.217931533853218, 0.6295304050048145, 0.967975682889417, 0.72355494399865, -7.402131326496601, -7.472974389791489, -7.369096979498863, -95.55879779656729, -87.67736824726066, -87.90972885241112, -6.913927366336196, -7.372420450051635, -7.8253729840119775, -1.3766241557896137, -1.3217504806816578, -2.147019237279892, -82.33005095024905, -100.97712393601736, -82.15932182719311, 4.143745183944702, 4.305321976542473, 4.831472521298565, 5.703332429130867, 5.63447207709153, 5.971675557394818, 1.020969706277043, 0.8595424468318527, 1.4241138179010306, -0.5184371769428253, -0.2943423017859459, 0.22715413942933083, -17.84433261553447, -18.102881322304412, -20.413067797819778, -93.75761345773935, -95.30292046070099, -97.63423752784729, -103.24164425333342, -115.10978927214941, -103.81784160931906, 1.2659399261077198, 1.0287887652715, 0.6594439645608219, -13.04742480814457, -13.756439045071602, -14.761046051979065, -7.996519401669502, -7.7700021006166935, -7.796991102397442, 9.288415285448224, 8.59981135527292, 9.082633788386971, -6.953037788470596, -6.740866636236518, -6.821958606441825, 6.410897379120186, 6.177314003308609, 7.1936665711303505, 10.313533542056874, 10.322011334200695, 10.166595463951424, -1.406149946153164, -1.3745795637369156, -1.2240183800458908, -16.640729151666164, -16.903945311903954, -17.177130833268166, -14.287672385573387, -14.427190020680428, -14.674587294459343, 0.34119336803753697, 0.10898849864800297, 0.6647188489635738, 3.0374857882658546, 3.5132794554034774, 2.7656959096590583, 4.270693647364766, 3.7855033079783027, 3.480879093209893, -107.76191159586112, -107.41007580856483, -120.31669966379802, 0.9246331850687568, 1.6977025220791404, 2.2405007972071473, -97.91281190887094, -98.59176474809647, -114.84044420719147, -3.1465258859097958, -3.3775499686598778, -3.8756271302700043, -97.44064909219742, -98.5211246907711, -108.79806187748909, -7.734105287740633, -8.241026456157371, -8.086051734785244, -0.49953967208664096, -0.8190067658821789, -0.6146419967214314, 2.178677280743912, 2.1400815596183094, 2.671804183473185, 1.3396769339839523, 1.3806176880995338, 1.3517256403962676, 3.6037645215789382, 3.4980402986208503, 3.7125079805652206, -5.765480063855648, -5.411215731874108, -5.872002765536308, 4.153030417859554, 4.243310439400375, 3.5892223715782166, 2.4658857360482216, 1.9461094290018082, 2.5793937295675278, 8.613989522059754, 9.4468372700115, 9.248839822908238, 0.756777286529541, 1.1625825837254524, 1.4929571133106947, 10.113209423919514, 9.728343834479645, 9.263820250829056, 11.512212318678692, 11.670304251213864, 11.24158528943856, -1.6302242651581764, -1.0614615129306912, -2.342175930738449, 0.7357154836257251, 0.9158192252119335, 0.7339929093917164, -7.42168416082859, -7.463288351893425, -6.797415779903531, 2.931504371265561, 3.0292609805862014, 2.334129894773156, -102.92539515842995, -103.52633458872637, -114.52186440428099, 5.2308381224671905, 5.238868581751973, 4.595912794272095, 8.138104222714901, 7.577474072575569, 7.792368188500404, -7.132022542258113, -7.180302118261665, -7.596489762266486, -4.686305428544685, -5.330233107010528, -4.068897924075529, 4.175377671917275, 4.208551382025078, 4.3802677442630085, 0.9833187113205497, 0.9852375338474815, 1.030642117063195, -0.25867385913929297, -0.872275700171798, -0.3151662101348336, 0.15128929416337655, 0.6984604174892013, 0.5971447030703132, 8.432444150249154, 7.916889081398637, 8.35143123070398, 5.64387661839524, 5.865323278975353, 4.979389677445084, 6.632815912365913, 7.197159022092819, 7.494971431791782, 8.922742739319801, 8.56129264831543, 8.435416355729103, 2.064962779482201, 1.7218622018893512, 1.0847176810105594, -3.5220631460348812, -3.651007364193603, -3.9018275837103573, -6.208575551708549, -6.620310654242843, -6.879621629913657, -5.865269613762706, -5.97740722199282, -5.771596574534982, -8.8511881629626, -8.50908749053876, -10.098877737919494, -6.045896177490562, -6.392976333697646, -6.240037706991046, -10.43450017273426, -10.155980259180069, -11.593776017427444, -11.655515372753143, -12.157916218042374, -11.862635478377342, 6.815766813854367, 6.667585382858903, 6.747652004162461, -4.781721731026977, -4.434500907858222, -4.919258256753295, -0.002572620908424028, 0.3185124782224449, -0.3251595149437634, 2.5480227048198287, 2.610682422916085, 2.8289819570879047, -102.4068974852562, -99.1208758354187, -100.45882844924927, 3.432399682700634, 3.566149190068245, 3.6483194269239902, -0.8028288135925976, -0.8538318375746456, -0.2797066556910721, 1.4874162922302787, 1.5442622850338523, 1.778902004162461, 3.8923892080783844, 3.951795816421509, 3.758994683623314, -129.76423037052155, -128.3200812600553, -147.14078438282013, -5.813971879581615, -6.2123949180046765, -6.53263793389003, -103.94486025969188, -103.21316526333491, -114.92076740662257, -4.491985754420369, -4.765716714163631, -4.737562236686557, 0.00869770968952821, -0.36247633894285514, -0.04608303805193259, -97.80424400170645, -97.90295659502348, -103.24347599347433, 5.294365994632244, 5.1685501635074615, 5.097086355090141, -109.8575828075409, -93.61137932538986, -92.33742228150368, 2.121028641859681, 3.073941816265375, 2.433733905355126, 5.609316423535347, 5.669257573783398, 5.765576891601086, 0.737102560698986, 0.6850534752011299, 0.2984793186187744, -2.0024306625127792, -1.9255132153630257, -1.8408890925347805, -1.2452420542637554, -1.1890432933966366, -0.8312839313099829, -5.42677389333646, -5.456750671068832, -5.599427911142513, 2.2102310117334127, 2.2375186420977116, 1.1050985455513, -17.413543219367668, -17.594439851741, -18.29482575754325, 2.0104487588008197, 2.0437421997388157, 1.9313865502675327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1502789007404392, "mean_inference_ms": 0.6954539941654754, "mean_action_processing_ms": 0.09567815253097646, "mean_env_wait_ms": 0.8017557475678254, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 205000, "timesteps_this_iter": 0, "agent_timesteps_total": 615000, "timers": {"sample_time_ms": 10678.884, "sample_throughput": 468.214, "load_time_ms": 0.318, "load_throughput": 15720779.61, "learn_time_ms": 1903.291, "learn_throughput": 2627.029, "update_time_ms": 9.304}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0005000000000000001, "total_loss": 79.90552062988282, "policy_loss": -0.0019541933526556754, "vf_loss": 79.9735092163086, "vf_explained_var": 0.18802218437194823, "kl": 0.0069484344101542585, "entropy": 6.603930282592773, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 205000, "num_agent_steps_sampled": 615000, "num_steps_trained": 205000, "num_agent_steps_trained": 615000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1061, "training_iteration": 41, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-08-41", "timestamp": 1706231321, "time_this_iter_s": 10.807707071304321, "time_total_s": 438.6032118797302, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402E08820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 438.6032118797302, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 7.913333333333332, "ram_util_percent": 50.91333333333333}}
{"episode_reward_max": 71.35564532130957, "episode_reward_min": -405.225096013397, "episode_reward_mean": -37.07413147941581, "episode_len_mean": 453.61, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -147.14078438282013}, "policy_reward_max": {"shared_policy": 24.023917987942696}, "policy_reward_mean": {"shared_policy": -12.358043826471942}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.8453938737511635, -265.4664967134595, 13.28053968178574, 17.309480063617215, 3.3046259710099264, -0.5856253392994404, -56.36028173565866, -286.69477144628763, -322.1692751348019, 2.9541726559400416, -41.564909905195236, -23.563512604683638, 26.970860429108114, -20.51586303114894, 19.781877953559146, 30.802140340208993, -4.00474788993597, -50.72180529683828, -43.38944970071316, 1.1149007156491137, 9.31646115332839, 11.537076048552962, -335.48868706822395, 4.8628365043550446, -311.34502086415887, -10.399702984839678, -304.7598356604576, -24.061183478683247, -1.9331884346902513, 6.990563023835406, 4.072020262479754, 10.81431280076501, -17.048698561266065, 11.985563228838146, 6.9913888946175575, 27.30966661497949, 3.412316983565688, 29.105373509228215, 34.42410185933112, -5.033861708827317, 2.385527618229375, -21.682388292625546, 8.294895246624918, -320.9735941514373, 15.065619498491259, 23.507946483790874, -21.908814422786264, -14.085436459630742, 12.764196798205361, 2.999198362231226, -1.4461157694459246, 1.446894414722891, 24.70076446235177, 16.488589574815677, 21.324946366250515, 25.919451743364334, 4.871542662382112, -11.074898093938842, -19.70850783586505, -17.614273410290508, -27.459153391420855, -18.678910218179254, -32.184256449341774, -35.67606706917286, 20.23100420087573, -14.135480895638494, -0.009219657629742528, 7.987687084823818, -301.98660176992416, 10.64686829969287, -1.9363673068583154, 4.810580581426592, 11.603179708123207, -405.225096013397, -18.55900473147632, -322.07879292964935, -13.995264705270557, -0.3998616673052595, -298.95067659020424, 15.560002513229847, -295.80638441443443, 7.628704363480182, 17.04415088891983, 1.7206353545188904, -5.768832970410585, -3.265569278970375, -16.482952475547805, 5.552848199382424, -53.30280882865192, 5.985577508807168, 54.495023049414144, -40.3846087642014, 28.7207302143797, 71.35564532130957, -0.32452523708344927, 28.719354383647442, 8.637832242995472, 13.578048489987822, 3.8942756503820135, 3.361627310514436], "episode_lengths": [500, 129, 500, 500, 500, 500, 500, 62, 65, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 500, 80, 500, 55, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 54, 500, 500, 500, 500, 427, 500, 52, 500, 500, 78, 500, 136, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-1.3766241557896137, -1.3217504806816578, -2.147019237279892, -82.33005095024905, -100.97712393601736, -82.15932182719311, 4.143745183944702, 4.305321976542473, 4.831472521298565, 5.703332429130867, 5.63447207709153, 5.971675557394818, 1.020969706277043, 0.8595424468318527, 1.4241138179010306, -0.5184371769428253, -0.2943423017859459, 0.22715413942933083, -17.84433261553447, -18.102881322304412, -20.413067797819778, -93.75761345773935, -95.30292046070099, -97.63423752784729, -103.24164425333342, -115.10978927214941, -103.81784160931906, 1.2659399261077198, 1.0287887652715, 0.6594439645608219, -13.04742480814457, -13.756439045071602, -14.761046051979065, -7.996519401669502, -7.7700021006166935, -7.796991102397442, 9.288415285448224, 8.59981135527292, 9.082633788386971, -6.953037788470596, -6.740866636236518, -6.821958606441825, 6.410897379120186, 6.177314003308609, 7.1936665711303505, 10.313533542056874, 10.322011334200695, 10.166595463951424, -1.406149946153164, -1.3745795637369156, -1.2240183800458908, -16.640729151666164, -16.903945311903954, -17.177130833268166, -14.287672385573387, -14.427190020680428, -14.674587294459343, 0.34119336803753697, 0.10898849864800297, 0.6647188489635738, 3.0374857882658546, 3.5132794554034774, 2.7656959096590583, 4.270693647364766, 3.7855033079783027, 3.480879093209893, -107.76191159586112, -107.41007580856483, -120.31669966379802, 0.9246331850687568, 1.6977025220791404, 2.2405007972071473, -97.91281190887094, -98.59176474809647, -114.84044420719147, -3.1465258859097958, -3.3775499686598778, -3.8756271302700043, -97.44064909219742, -98.5211246907711, -108.79806187748909, -7.734105287740633, -8.241026456157371, -8.086051734785244, -0.49953967208664096, -0.8190067658821789, -0.6146419967214314, 2.178677280743912, 2.1400815596183094, 2.671804183473185, 1.3396769339839523, 1.3806176880995338, 1.3517256403962676, 3.6037645215789382, 3.4980402986208503, 3.7125079805652206, -5.765480063855648, -5.411215731874108, -5.872002765536308, 4.153030417859554, 4.243310439400375, 3.5892223715782166, 2.4658857360482216, 1.9461094290018082, 2.5793937295675278, 8.613989522059754, 9.4468372700115, 9.248839822908238, 0.756777286529541, 1.1625825837254524, 1.4929571133106947, 10.113209423919514, 9.728343834479645, 9.263820250829056, 11.512212318678692, 11.670304251213864, 11.24158528943856, -1.6302242651581764, -1.0614615129306912, -2.342175930738449, 0.7357154836257251, 0.9158192252119335, 0.7339929093917164, -7.42168416082859, -7.463288351893425, -6.797415779903531, 2.931504371265561, 3.0292609805862014, 2.334129894773156, -102.92539515842995, -103.52633458872637, -114.52186440428099, 5.2308381224671905, 5.238868581751973, 4.595912794272095, 8.138104222714901, 7.577474072575569, 7.792368188500404, -7.132022542258113, -7.180302118261665, -7.596489762266486, -4.686305428544685, -5.330233107010528, -4.068897924075529, 4.175377671917275, 4.208551382025078, 4.3802677442630085, 0.9833187113205497, 0.9852375338474815, 1.030642117063195, -0.25867385913929297, -0.872275700171798, -0.3151662101348336, 0.15128929416337655, 0.6984604174892013, 0.5971447030703132, 8.432444150249154, 7.916889081398637, 8.35143123070398, 5.64387661839524, 5.865323278975353, 4.979389677445084, 6.632815912365913, 7.197159022092819, 7.494971431791782, 8.922742739319801, 8.56129264831543, 8.435416355729103, 2.064962779482201, 1.7218622018893512, 1.0847176810105594, -3.5220631460348812, -3.651007364193603, -3.9018275837103573, -6.208575551708549, -6.620310654242843, -6.879621629913657, -5.865269613762706, -5.97740722199282, -5.771596574534982, -8.8511881629626, -8.50908749053876, -10.098877737919494, -6.045896177490562, -6.392976333697646, -6.240037706991046, -10.43450017273426, -10.155980259180069, -11.593776017427444, -11.655515372753143, -12.157916218042374, -11.862635478377342, 6.815766813854367, 6.667585382858903, 6.747652004162461, -4.781721731026977, -4.434500907858222, -4.919258256753295, -0.002572620908424028, 0.3185124782224449, -0.3251595149437634, 2.5480227048198287, 2.610682422916085, 2.8289819570879047, -102.4068974852562, -99.1208758354187, -100.45882844924927, 3.432399682700634, 3.566149190068245, 3.6483194269239902, -0.8028288135925976, -0.8538318375746456, -0.2797066556910721, 1.4874162922302787, 1.5442622850338523, 1.778902004162461, 3.8923892080783844, 3.951795816421509, 3.758994683623314, -129.76423037052155, -128.3200812600553, -147.14078438282013, -5.813971879581615, -6.2123949180046765, -6.53263793389003, -103.94486025969188, -103.21316526333491, -114.92076740662257, -4.491985754420369, -4.765716714163631, -4.737562236686557, 0.00869770968952821, -0.36247633894285514, -0.04608303805193259, -97.80424400170645, -97.90295659502348, -103.24347599347433, 5.294365994632244, 5.1685501635074615, 5.097086355090141, -109.8575828075409, -93.61137932538986, -92.33742228150368, 2.121028641859681, 3.073941816265375, 2.433733905355126, 5.609316423535347, 5.669257573783398, 5.765576891601086, 0.737102560698986, 0.6850534752011299, 0.2984793186187744, -2.0024306625127792, -1.9255132153630257, -1.8408890925347805, -1.2452420542637554, -1.1890432933966366, -0.8312839313099829, -5.42677389333646, -5.456750671068832, -5.599427911142513, 2.2102310117334127, 2.2375186420977116, 1.1050985455513, -17.413543219367668, -17.594439851741, -18.29482575754325, 2.0104487588008197, 2.0437421997388157, 1.9313865502675327, 18.18526192506154, 18.15890985478957, 18.150851269563034, -12.75749310106039, -12.411010202020407, -15.216105461120605, 9.179758737484605, 10.026635663273424, 9.51433581362167, 23.81902437657118, 24.023917987942696, 23.512702956795692, -0.28353142241637386, -0.09645829598109401, 0.0554644813140186, 9.78160034865141, 9.427263960242271, 9.510490074753761, 3.1349742251137798, 2.739050130049378, 2.7638078878323142, 4.871340962747723, 4.620505953828484, 4.086201573411614, 1.539883340398461, 1.4085314671198432, 0.9458608428637092, 0.8544362088044437, 1.424281199773148, 1.0829099019368442]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15002474116315137, "mean_inference_ms": 0.6956576657749202, "mean_action_processing_ms": 0.0957146973681305, "mean_env_wait_ms": 0.802274486110754, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 210000, "timesteps_this_iter": 0, "agent_timesteps_total": 630000, "timers": {"sample_time_ms": 10805.315, "sample_throughput": 462.735, "load_time_ms": 0.418, "load_throughput": 11959124.088, "learn_time_ms": 1903.51, "learn_throughput": 2626.727, "update_time_ms": 9.5}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0005000000000000001, "total_loss": 18.3911093711853, "policy_loss": -0.0019542311324318717, "vf_loss": 18.46044807434082, "vf_explained_var": -1.0, "kl": 0.004817689716586733, "entropy": 6.738473892211914, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 210000, "num_agent_steps_sampled": 630000, "num_steps_trained": 210000, "num_agent_steps_trained": 630000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1071, "training_iteration": 42, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-08-52", "timestamp": 1706231332, "time_this_iter_s": 11.576966524124146, "time_total_s": 450.18017840385437, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402E08700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 450.18017840385437, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 8.441176470588236, "ram_util_percent": 50.123529411764714}}
{"episode_reward_max": 71.35564532130957, "episode_reward_min": -405.225096013397, "episode_reward_mean": -32.7464714801847, "episode_len_mean": 456.95, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -147.14078438282013}, "policy_reward_max": {"shared_policy": 24.023917987942696}, "policy_reward_mean": {"shared_policy": -10.915490493394906}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.970860429108114, -20.51586303114894, 19.781877953559146, 30.802140340208993, -4.00474788993597, -50.72180529683828, -43.38944970071316, 1.1149007156491137, 9.31646115332839, 11.537076048552962, -335.48868706822395, 4.8628365043550446, -311.34502086415887, -10.399702984839678, -304.7598356604576, -24.061183478683247, -1.9331884346902513, 6.990563023835406, 4.072020262479754, 10.81431280076501, -17.048698561266065, 11.985563228838146, 6.9913888946175575, 27.30966661497949, 3.412316983565688, 29.105373509228215, 34.42410185933112, -5.033861708827317, 2.385527618229375, -21.682388292625546, 8.294895246624918, -320.9735941514373, 15.065619498491259, 23.507946483790874, -21.908814422786264, -14.085436459630742, 12.764196798205361, 2.999198362231226, -1.4461157694459246, 1.446894414722891, 24.70076446235177, 16.488589574815677, 21.324946366250515, 25.919451743364334, 4.871542662382112, -11.074898093938842, -19.70850783586505, -17.614273410290508, -27.459153391420855, -18.678910218179254, -32.184256449341774, -35.67606706917286, 20.23100420087573, -14.135480895638494, -0.009219657629742528, 7.987687084823818, -301.98660176992416, 10.64686829969287, -1.9363673068583154, 4.810580581426592, 11.603179708123207, -405.225096013397, -18.55900473147632, -322.07879292964935, -13.995264705270557, -0.3998616673052595, -298.95067659020424, 15.560002513229847, -295.80638441443443, 7.628704363480182, 17.04415088891983, 1.7206353545188904, -5.768832970410585, -3.265569278970375, -16.482952475547805, 5.552848199382424, -53.30280882865192, 5.985577508807168, 54.495023049414144, -40.3846087642014, 28.7207302143797, 71.35564532130957, -0.32452523708344927, 28.719354383647442, 8.637832242995472, 13.578048489987822, 3.8942756503820135, 3.361627310514436, 13.300417378544793, 8.06808191537857, 18.466666830703588, -329.0227310359478, -316.56259389966726, 2.7855092547833777, 3.35133153665808, 20.654572788625927, 20.11280054226515, -28.064494840800762, 26.308657800778718, 28.96633327100423], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 148, 500, 80, 500, 55, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 54, 500, 500, 500, 500, 427, 500, 52, 500, 500, 78, 500, 136, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 54, 36, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [9.288415285448224, 8.59981135527292, 9.082633788386971, -6.953037788470596, -6.740866636236518, -6.821958606441825, 6.410897379120186, 6.177314003308609, 7.1936665711303505, 10.313533542056874, 10.322011334200695, 10.166595463951424, -1.406149946153164, -1.3745795637369156, -1.2240183800458908, -16.640729151666164, -16.903945311903954, -17.177130833268166, -14.287672385573387, -14.427190020680428, -14.674587294459343, 0.34119336803753697, 0.10898849864800297, 0.6647188489635738, 3.0374857882658546, 3.5132794554034774, 2.7656959096590583, 4.270693647364766, 3.7855033079783027, 3.480879093209893, -107.76191159586112, -107.41007580856483, -120.31669966379802, 0.9246331850687568, 1.6977025220791404, 2.2405007972071473, -97.91281190887094, -98.59176474809647, -114.84044420719147, -3.1465258859097958, -3.3775499686598778, -3.8756271302700043, -97.44064909219742, -98.5211246907711, -108.79806187748909, -7.734105287740633, -8.241026456157371, -8.086051734785244, -0.49953967208664096, -0.8190067658821789, -0.6146419967214314, 2.178677280743912, 2.1400815596183094, 2.671804183473185, 1.3396769339839523, 1.3806176880995338, 1.3517256403962676, 3.6037645215789382, 3.4980402986208503, 3.7125079805652206, -5.765480063855648, -5.411215731874108, -5.872002765536308, 4.153030417859554, 4.243310439400375, 3.5892223715782166, 2.4658857360482216, 1.9461094290018082, 2.5793937295675278, 8.613989522059754, 9.4468372700115, 9.248839822908238, 0.756777286529541, 1.1625825837254524, 1.4929571133106947, 10.113209423919514, 9.728343834479645, 9.263820250829056, 11.512212318678692, 11.670304251213864, 11.24158528943856, -1.6302242651581764, -1.0614615129306912, -2.342175930738449, 0.7357154836257251, 0.9158192252119335, 0.7339929093917164, -7.42168416082859, -7.463288351893425, -6.797415779903531, 2.931504371265561, 3.0292609805862014, 2.334129894773156, -102.92539515842995, -103.52633458872637, -114.52186440428099, 5.2308381224671905, 5.238868581751973, 4.595912794272095, 8.138104222714901, 7.577474072575569, 7.792368188500404, -7.132022542258113, -7.180302118261665, -7.596489762266486, -4.686305428544685, -5.330233107010528, -4.068897924075529, 4.175377671917275, 4.208551382025078, 4.3802677442630085, 0.9833187113205497, 0.9852375338474815, 1.030642117063195, -0.25867385913929297, -0.872275700171798, -0.3151662101348336, 0.15128929416337655, 0.6984604174892013, 0.5971447030703132, 8.432444150249154, 7.916889081398637, 8.35143123070398, 5.64387661839524, 5.865323278975353, 4.979389677445084, 6.632815912365913, 7.197159022092819, 7.494971431791782, 8.922742739319801, 8.56129264831543, 8.435416355729103, 2.064962779482201, 1.7218622018893512, 1.0847176810105594, -3.5220631460348812, -3.651007364193603, -3.9018275837103573, -6.208575551708549, -6.620310654242843, -6.879621629913657, -5.865269613762706, -5.97740722199282, -5.771596574534982, -8.8511881629626, -8.50908749053876, -10.098877737919494, -6.045896177490562, -6.392976333697646, -6.240037706991046, -10.43450017273426, -10.155980259180069, -11.593776017427444, -11.655515372753143, -12.157916218042374, -11.862635478377342, 6.815766813854367, 6.667585382858903, 6.747652004162461, -4.781721731026977, -4.434500907858222, -4.919258256753295, -0.002572620908424028, 0.3185124782224449, -0.3251595149437634, 2.5480227048198287, 2.610682422916085, 2.8289819570879047, -102.4068974852562, -99.1208758354187, -100.45882844924927, 3.432399682700634, 3.566149190068245, 3.6483194269239902, -0.8028288135925976, -0.8538318375746456, -0.2797066556910721, 1.4874162922302787, 1.5442622850338523, 1.778902004162461, 3.8923892080783844, 3.951795816421509, 3.758994683623314, -129.76423037052155, -128.3200812600553, -147.14078438282013, -5.813971879581615, -6.2123949180046765, -6.53263793389003, -103.94486025969188, -103.21316526333491, -114.92076740662257, -4.491985754420369, -4.765716714163631, -4.737562236686557, 0.00869770968952821, -0.36247633894285514, -0.04608303805193259, -97.80424400170645, -97.90295659502348, -103.24347599347433, 5.294365994632244, 5.1685501635074615, 5.097086355090141, -109.8575828075409, -93.61137932538986, -92.33742228150368, 2.121028641859681, 3.073941816265375, 2.433733905355126, 5.609316423535347, 5.669257573783398, 5.765576891601086, 0.737102560698986, 0.6850534752011299, 0.2984793186187744, -2.0024306625127792, -1.9255132153630257, -1.8408890925347805, -1.2452420542637554, -1.1890432933966366, -0.8312839313099829, -5.42677389333646, -5.456750671068832, -5.599427911142513, 2.2102310117334127, 2.2375186420977116, 1.1050985455513, -17.413543219367668, -17.594439851741, -18.29482575754325, 2.0104487588008197, 2.0437421997388157, 1.9313865502675327, 18.18526192506154, 18.15890985478957, 18.150851269563034, -12.75749310106039, -12.411010202020407, -15.216105461120605, 9.179758737484605, 10.026635663273424, 9.51433581362167, 23.81902437657118, 24.023917987942696, 23.512702956795692, -0.28353142241637386, -0.09645829598109401, 0.0554644813140186, 9.78160034865141, 9.427263960242271, 9.510490074753761, 3.1349742251137798, 2.739050130049378, 2.7638078878323142, 4.871340962747723, 4.620505953828484, 4.086201573411614, 1.539883340398461, 1.4085314671198432, 0.9458608428637092, 0.8544362088044437, 1.424281199773148, 1.0829099019368442, 4.535370660324887, 4.491852526863411, 4.273194191356495, 2.8885834887623787, 2.668078862130642, 2.51141956448555, 6.387190500895173, 6.64534428032735, 5.4341320494810645, -103.4623516102632, -106.00036521752676, -119.56001420815787, -115.2946381966273, -100.81824432561795, -100.44971137742202, 0.7557530601819309, 0.6856428732474598, 1.344113321353987, 1.116817491749913, 0.774591947595269, 1.459922097312898, 6.873835163811833, 7.018262005100638, 6.762475619713456, 6.5082481006781165, 6.703125859300286, 6.901426582286746, -9.186553377658129, -9.80127826333046, -9.076663199812174, 9.17103233250478, 8.394877682129533, 8.742747786144406, 9.539757351080567, 9.903792071777076, 9.522783848146588]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14978288058471095, "mean_inference_ms": 0.6959014898012603, "mean_action_processing_ms": 0.09585292174771479, "mean_env_wait_ms": 0.8029005610097414, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 215000, "timesteps_this_iter": 0, "agent_timesteps_total": 645000, "timers": {"sample_time_ms": 10791.547, "sample_throughput": 463.326, "load_time_ms": 0.401, "load_throughput": 12462277.157, "learn_time_ms": 1900.528, "learn_throughput": 2630.847, "update_time_ms": 9.576}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0005000000000000001, "total_loss": 109.47246780395508, "policy_loss": -0.003989760598291969, "vf_loss": 109.5438461303711, "vf_explained_var": 0.20877668261528015, "kl": 0.009585168701600035, "entropy": 6.7385673999786375, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 215000, "num_agent_steps_sampled": 645000, "num_steps_trained": 215000, "num_agent_steps_trained": 645000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1083, "training_iteration": 43, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-09-03", "timestamp": 1706231343, "time_this_iter_s": 10.398289203643799, "time_total_s": 460.57846760749817, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140424F550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 460.57846760749817, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 6.621428571428569, "ram_util_percent": 49.542857142857144}}
{"episode_reward_max": 71.35564532130957, "episode_reward_min": -405.225096013397, "episode_reward_mean": -31.115825445966333, "episode_len_mean": 456.95, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -147.14078438282013}, "policy_reward_max": {"shared_policy": 24.023917987942696}, "policy_reward_mean": {"shared_policy": -10.371941815322115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-335.48868706822395, 4.8628365043550446, -311.34502086415887, -10.399702984839678, -304.7598356604576, -24.061183478683247, -1.9331884346902513, 6.990563023835406, 4.072020262479754, 10.81431280076501, -17.048698561266065, 11.985563228838146, 6.9913888946175575, 27.30966661497949, 3.412316983565688, 29.105373509228215, 34.42410185933112, -5.033861708827317, 2.385527618229375, -21.682388292625546, 8.294895246624918, -320.9735941514373, 15.065619498491259, 23.507946483790874, -21.908814422786264, -14.085436459630742, 12.764196798205361, 2.999198362231226, -1.4461157694459246, 1.446894414722891, 24.70076446235177, 16.488589574815677, 21.324946366250515, 25.919451743364334, 4.871542662382112, -11.074898093938842, -19.70850783586505, -17.614273410290508, -27.459153391420855, -18.678910218179254, -32.184256449341774, -35.67606706917286, 20.23100420087573, -14.135480895638494, -0.009219657629742528, 7.987687084823818, -301.98660176992416, 10.64686829969287, -1.9363673068583154, 4.810580581426592, 11.603179708123207, -405.225096013397, -18.55900473147632, -322.07879292964935, -13.995264705270557, -0.3998616673052595, -298.95067659020424, 15.560002513229847, -295.80638441443443, 7.628704363480182, 17.04415088891983, 1.7206353545188904, -5.768832970410585, -3.265569278970375, -16.482952475547805, 5.552848199382424, -53.30280882865192, 5.985577508807168, 54.495023049414144, -40.3846087642014, 28.7207302143797, 71.35564532130957, -0.32452523708344927, 28.719354383647442, 8.637832242995472, 13.578048489987822, 3.8942756503820135, 3.361627310514436, 13.300417378544793, 8.06808191537857, 18.466666830703588, -329.0227310359478, -316.56259389966726, 2.7855092547833777, 3.35133153665808, 20.654572788625927, 20.11280054226515, -28.064494840800762, 26.308657800778718, 28.96633327100423, -9.662008224055185, -9.170993417501464, 31.360654041171045, 2.07967746257782, 21.841673709452152, 26.833672523498507, 22.750431889668107, 39.75187333300707, 13.400493353605242, 4.770579472184181], "episode_lengths": [148, 500, 80, 500, 55, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 54, 500, 500, 500, 500, 427, 500, 52, 500, 500, 78, 500, 136, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 54, 36, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-107.76191159586112, -107.41007580856483, -120.31669966379802, 0.9246331850687568, 1.6977025220791404, 2.2405007972071473, -97.91281190887094, -98.59176474809647, -114.84044420719147, -3.1465258859097958, -3.3775499686598778, -3.8756271302700043, -97.44064909219742, -98.5211246907711, -108.79806187748909, -7.734105287740633, -8.241026456157371, -8.086051734785244, -0.49953967208664096, -0.8190067658821789, -0.6146419967214314, 2.178677280743912, 2.1400815596183094, 2.671804183473185, 1.3396769339839523, 1.3806176880995338, 1.3517256403962676, 3.6037645215789382, 3.4980402986208503, 3.7125079805652206, -5.765480063855648, -5.411215731874108, -5.872002765536308, 4.153030417859554, 4.243310439400375, 3.5892223715782166, 2.4658857360482216, 1.9461094290018082, 2.5793937295675278, 8.613989522059754, 9.4468372700115, 9.248839822908238, 0.756777286529541, 1.1625825837254524, 1.4929571133106947, 10.113209423919514, 9.728343834479645, 9.263820250829056, 11.512212318678692, 11.670304251213864, 11.24158528943856, -1.6302242651581764, -1.0614615129306912, -2.342175930738449, 0.7357154836257251, 0.9158192252119335, 0.7339929093917164, -7.42168416082859, -7.463288351893425, -6.797415779903531, 2.931504371265561, 3.0292609805862014, 2.334129894773156, -102.92539515842995, -103.52633458872637, -114.52186440428099, 5.2308381224671905, 5.238868581751973, 4.595912794272095, 8.138104222714901, 7.577474072575569, 7.792368188500404, -7.132022542258113, -7.180302118261665, -7.596489762266486, -4.686305428544685, -5.330233107010528, -4.068897924075529, 4.175377671917275, 4.208551382025078, 4.3802677442630085, 0.9833187113205497, 0.9852375338474815, 1.030642117063195, -0.25867385913929297, -0.872275700171798, -0.3151662101348336, 0.15128929416337655, 0.6984604174892013, 0.5971447030703132, 8.432444150249154, 7.916889081398637, 8.35143123070398, 5.64387661839524, 5.865323278975353, 4.979389677445084, 6.632815912365913, 7.197159022092819, 7.494971431791782, 8.922742739319801, 8.56129264831543, 8.435416355729103, 2.064962779482201, 1.7218622018893512, 1.0847176810105594, -3.5220631460348812, -3.651007364193603, -3.9018275837103573, -6.208575551708549, -6.620310654242843, -6.879621629913657, -5.865269613762706, -5.97740722199282, -5.771596574534982, -8.8511881629626, -8.50908749053876, -10.098877737919494, -6.045896177490562, -6.392976333697646, -6.240037706991046, -10.43450017273426, -10.155980259180069, -11.593776017427444, -11.655515372753143, -12.157916218042374, -11.862635478377342, 6.815766813854367, 6.667585382858903, 6.747652004162461, -4.781721731026977, -4.434500907858222, -4.919258256753295, -0.002572620908424028, 0.3185124782224449, -0.3251595149437634, 2.5480227048198287, 2.610682422916085, 2.8289819570879047, -102.4068974852562, -99.1208758354187, -100.45882844924927, 3.432399682700634, 3.566149190068245, 3.6483194269239902, -0.8028288135925976, -0.8538318375746456, -0.2797066556910721, 1.4874162922302787, 1.5442622850338523, 1.778902004162461, 3.8923892080783844, 3.951795816421509, 3.758994683623314, -129.76423037052155, -128.3200812600553, -147.14078438282013, -5.813971879581615, -6.2123949180046765, -6.53263793389003, -103.94486025969188, -103.21316526333491, -114.92076740662257, -4.491985754420369, -4.765716714163631, -4.737562236686557, 0.00869770968952821, -0.36247633894285514, -0.04608303805193259, -97.80424400170645, -97.90295659502348, -103.24347599347433, 5.294365994632244, 5.1685501635074615, 5.097086355090141, -109.8575828075409, -93.61137932538986, -92.33742228150368, 2.121028641859681, 3.073941816265375, 2.433733905355126, 5.609316423535347, 5.669257573783398, 5.765576891601086, 0.737102560698986, 0.6850534752011299, 0.2984793186187744, -2.0024306625127792, -1.9255132153630257, -1.8408890925347805, -1.2452420542637554, -1.1890432933966366, -0.8312839313099829, -5.42677389333646, -5.456750671068832, -5.599427911142513, 2.2102310117334127, 2.2375186420977116, 1.1050985455513, -17.413543219367668, -17.594439851741, -18.29482575754325, 2.0104487588008197, 2.0437421997388157, 1.9313865502675327, 18.18526192506154, 18.15890985478957, 18.150851269563034, -12.75749310106039, -12.411010202020407, -15.216105461120605, 9.179758737484605, 10.026635663273424, 9.51433581362167, 23.81902437657118, 24.023917987942696, 23.512702956795692, -0.28353142241637386, -0.09645829598109401, 0.0554644813140186, 9.78160034865141, 9.427263960242271, 9.510490074753761, 3.1349742251137798, 2.739050130049378, 2.7638078878323142, 4.871340962747723, 4.620505953828484, 4.086201573411614, 1.539883340398461, 1.4085314671198432, 0.9458608428637092, 0.8544362088044437, 1.424281199773148, 1.0829099019368442, 4.535370660324887, 4.491852526863411, 4.273194191356495, 2.8885834887623787, 2.668078862130642, 2.51141956448555, 6.387190500895173, 6.64534428032735, 5.4341320494810645, -103.4623516102632, -106.00036521752676, -119.56001420815787, -115.2946381966273, -100.81824432561795, -100.44971137742202, 0.7557530601819309, 0.6856428732474598, 1.344113321353987, 1.116817491749913, 0.774591947595269, 1.459922097312898, 6.873835163811833, 7.018262005100638, 6.762475619713456, 6.5082481006781165, 6.703125859300286, 6.901426582286746, -9.186553377658129, -9.80127826333046, -9.076663199812174, 9.17103233250478, 8.394877682129533, 8.742747786144406, 9.539757351080567, 9.903792071777076, 9.522783848146588, -2.949653439844653, -3.2306522826353756, -3.481702501575157, -2.9544041926662175, -3.344393546382591, -2.8721956784526554, 10.697090896467358, 10.720193731288106, 9.943369413415581, 0.9458692967891693, 0.8200394213199615, 0.31376874446868896, 7.302714005112648, 7.444278798997402, 7.094680905342102, 8.672075296441704, 9.161744664112717, 8.999852562944085, 7.518822818994522, 8.185324126854539, 7.046284943819046, 13.259476261834294, 13.471032163749129, 13.021364907423646, 4.476051012674958, 4.136039222280175, 4.788403118650109, 2.2335944026708603, 1.1067372262477875, 1.4302478432655334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1495560515292011, "mean_inference_ms": 0.6961130995929653, "mean_action_processing_ms": 0.09586333559882759, "mean_env_wait_ms": 0.803486422321222, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 220000, "timesteps_this_iter": 0, "agent_timesteps_total": 660000, "timers": {"sample_time_ms": 10819.418, "sample_throughput": 462.132, "load_time_ms": 0.501, "load_throughput": 9979310.017, "learn_time_ms": 1902.144, "learn_throughput": 2628.613, "update_time_ms": 9.576}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0005000000000000001, "total_loss": 14.654666519165039, "policy_loss": -0.001811156586185092, "vf_loss": 14.724073600769042, "vf_explained_var": -1.0, "kl": 0.004248985854796111, "entropy": 6.75959587097168, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 220000, "num_agent_steps_sampled": 660000, "num_steps_trained": 220000, "num_agent_steps_trained": 660000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1093, "training_iteration": 44, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-09-13", "timestamp": 1706231353, "time_this_iter_s": 10.66965627670288, "time_total_s": 471.24812388420105, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021404232700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 471.24812388420105, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 7.506666666666665, "ram_util_percent": 49.53333333333334}}
{"episode_reward_max": 71.35564532130957, "episode_reward_min": -405.225096013397, "episode_reward_mean": -20.590183511811784, "episode_len_mean": 469.12, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -147.14078438282013}, "policy_reward_max": {"shared_policy": 24.023917987942696}, "policy_reward_mean": {"shared_policy": -6.863394503937264}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.048698561266065, 11.985563228838146, 6.9913888946175575, 27.30966661497949, 3.412316983565688, 29.105373509228215, 34.42410185933112, -5.033861708827317, 2.385527618229375, -21.682388292625546, 8.294895246624918, -320.9735941514373, 15.065619498491259, 23.507946483790874, -21.908814422786264, -14.085436459630742, 12.764196798205361, 2.999198362231226, -1.4461157694459246, 1.446894414722891, 24.70076446235177, 16.488589574815677, 21.324946366250515, 25.919451743364334, 4.871542662382112, -11.074898093938842, -19.70850783586505, -17.614273410290508, -27.459153391420855, -18.678910218179254, -32.184256449341774, -35.67606706917286, 20.23100420087573, -14.135480895638494, -0.009219657629742528, 7.987687084823818, -301.98660176992416, 10.64686829969287, -1.9363673068583154, 4.810580581426592, 11.603179708123207, -405.225096013397, -18.55900473147632, -322.07879292964935, -13.995264705270557, -0.3998616673052595, -298.95067659020424, 15.560002513229847, -295.80638441443443, 7.628704363480182, 17.04415088891983, 1.7206353545188904, -5.768832970410585, -3.265569278970375, -16.482952475547805, 5.552848199382424, -53.30280882865192, 5.985577508807168, 54.495023049414144, -40.3846087642014, 28.7207302143797, 71.35564532130957, -0.32452523708344927, 28.719354383647442, 8.637832242995472, 13.578048489987822, 3.8942756503820135, 3.361627310514436, 13.300417378544793, 8.06808191537857, 18.466666830703588, -329.0227310359478, -316.56259389966726, 2.7855092547833777, 3.35133153665808, 20.654572788625927, 20.11280054226515, -28.064494840800762, 26.308657800778718, 28.96633327100423, -9.662008224055185, -9.170993417501464, 31.360654041171045, 2.07967746257782, 21.841673709452152, 26.833672523498507, 22.750431889668107, 39.75187333300707, 13.400493353605242, 4.770579472184181, -40.17215264588596, 8.094721004366846, 19.437757894396753, 27.050454512238503, 31.30966271832584, 29.111490306444466, -34.23878009244801, 18.531126029789448, 12.822216160595403, 19.36981162801382], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 54, 500, 500, 500, 500, 427, 500, 52, 500, 500, 78, 500, 136, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 54, 36, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-5.765480063855648, -5.411215731874108, -5.872002765536308, 4.153030417859554, 4.243310439400375, 3.5892223715782166, 2.4658857360482216, 1.9461094290018082, 2.5793937295675278, 8.613989522059754, 9.4468372700115, 9.248839822908238, 0.756777286529541, 1.1625825837254524, 1.4929571133106947, 10.113209423919514, 9.728343834479645, 9.263820250829056, 11.512212318678692, 11.670304251213864, 11.24158528943856, -1.6302242651581764, -1.0614615129306912, -2.342175930738449, 0.7357154836257251, 0.9158192252119335, 0.7339929093917164, -7.42168416082859, -7.463288351893425, -6.797415779903531, 2.931504371265561, 3.0292609805862014, 2.334129894773156, -102.92539515842995, -103.52633458872637, -114.52186440428099, 5.2308381224671905, 5.238868581751973, 4.595912794272095, 8.138104222714901, 7.577474072575569, 7.792368188500404, -7.132022542258113, -7.180302118261665, -7.596489762266486, -4.686305428544685, -5.330233107010528, -4.068897924075529, 4.175377671917275, 4.208551382025078, 4.3802677442630085, 0.9833187113205497, 0.9852375338474815, 1.030642117063195, -0.25867385913929297, -0.872275700171798, -0.3151662101348336, 0.15128929416337655, 0.6984604174892013, 0.5971447030703132, 8.432444150249154, 7.916889081398637, 8.35143123070398, 5.64387661839524, 5.865323278975353, 4.979389677445084, 6.632815912365913, 7.197159022092819, 7.494971431791782, 8.922742739319801, 8.56129264831543, 8.435416355729103, 2.064962779482201, 1.7218622018893512, 1.0847176810105594, -3.5220631460348812, -3.651007364193603, -3.9018275837103573, -6.208575551708549, -6.620310654242843, -6.879621629913657, -5.865269613762706, -5.97740722199282, -5.771596574534982, -8.8511881629626, -8.50908749053876, -10.098877737919494, -6.045896177490562, -6.392976333697646, -6.240037706991046, -10.43450017273426, -10.155980259180069, -11.593776017427444, -11.655515372753143, -12.157916218042374, -11.862635478377342, 6.815766813854367, 6.667585382858903, 6.747652004162461, -4.781721731026977, -4.434500907858222, -4.919258256753295, -0.002572620908424028, 0.3185124782224449, -0.3251595149437634, 2.5480227048198287, 2.610682422916085, 2.8289819570879047, -102.4068974852562, -99.1208758354187, -100.45882844924927, 3.432399682700634, 3.566149190068245, 3.6483194269239902, -0.8028288135925976, -0.8538318375746456, -0.2797066556910721, 1.4874162922302787, 1.5442622850338523, 1.778902004162461, 3.8923892080783844, 3.951795816421509, 3.758994683623314, -129.76423037052155, -128.3200812600553, -147.14078438282013, -5.813971879581615, -6.2123949180046765, -6.53263793389003, -103.94486025969188, -103.21316526333491, -114.92076740662257, -4.491985754420369, -4.765716714163631, -4.737562236686557, 0.00869770968952821, -0.36247633894285514, -0.04608303805193259, -97.80424400170645, -97.90295659502348, -103.24347599347433, 5.294365994632244, 5.1685501635074615, 5.097086355090141, -109.8575828075409, -93.61137932538986, -92.33742228150368, 2.121028641859681, 3.073941816265375, 2.433733905355126, 5.609316423535347, 5.669257573783398, 5.765576891601086, 0.737102560698986, 0.6850534752011299, 0.2984793186187744, -2.0024306625127792, -1.9255132153630257, -1.8408890925347805, -1.2452420542637554, -1.1890432933966366, -0.8312839313099829, -5.42677389333646, -5.456750671068832, -5.599427911142513, 2.2102310117334127, 2.2375186420977116, 1.1050985455513, -17.413543219367668, -17.594439851741, -18.29482575754325, 2.0104487588008197, 2.0437421997388157, 1.9313865502675327, 18.18526192506154, 18.15890985478957, 18.150851269563034, -12.75749310106039, -12.411010202020407, -15.216105461120605, 9.179758737484605, 10.026635663273424, 9.51433581362167, 23.81902437657118, 24.023917987942696, 23.512702956795692, -0.28353142241637386, -0.09645829598109401, 0.0554644813140186, 9.78160034865141, 9.427263960242271, 9.510490074753761, 3.1349742251137798, 2.739050130049378, 2.7638078878323142, 4.871340962747723, 4.620505953828484, 4.086201573411614, 1.539883340398461, 1.4085314671198432, 0.9458608428637092, 0.8544362088044437, 1.424281199773148, 1.0829099019368442, 4.535370660324887, 4.491852526863411, 4.273194191356495, 2.8885834887623787, 2.668078862130642, 2.51141956448555, 6.387190500895173, 6.64534428032735, 5.4341320494810645, -103.4623516102632, -106.00036521752676, -119.56001420815787, -115.2946381966273, -100.81824432561795, -100.44971137742202, 0.7557530601819309, 0.6856428732474598, 1.344113321353987, 1.116817491749913, 0.774591947595269, 1.459922097312898, 6.873835163811833, 7.018262005100638, 6.762475619713456, 6.5082481006781165, 6.703125859300286, 6.901426582286746, -9.186553377658129, -9.80127826333046, -9.076663199812174, 9.17103233250478, 8.394877682129533, 8.742747786144406, 9.539757351080567, 9.903792071777076, 9.522783848146588, -2.949653439844653, -3.2306522826353756, -3.481702501575157, -2.9544041926662175, -3.344393546382591, -2.8721956784526554, 10.697090896467358, 10.720193731288106, 9.943369413415581, 0.9458692967891693, 0.8200394213199615, 0.31376874446868896, 7.302714005112648, 7.444278798997402, 7.094680905342102, 8.672075296441704, 9.161744664112717, 8.999852562944085, 7.518822818994522, 8.185324126854539, 7.046284943819046, 13.259476261834294, 13.471032163749129, 13.021364907423646, 4.476051012674958, 4.136039222280175, 4.788403118650109, 2.2335944026708603, 1.1067372262477875, 1.4302478432655334, -11.813911291460201, -12.137001211444542, -16.221240142981216, 2.756734135250241, 2.638565393785626, 2.699421475330979, 6.790363824615866, 5.96679990986982, 6.680594159911067, 9.200490355491638, 8.882437735795975, 8.96752642095089, 10.430440199871853, 10.214198236664132, 10.665024281789854, 9.549904495477676, 10.092441064305604, 9.469144746661186, -10.936340487251684, -11.218941772977516, -12.08349783221881, 6.378893934190273, 6.497262015938759, 5.654970079660416, 4.359684576590851, 4.534553912778691, 3.927977671225861, 6.293421427408845, 6.883811785529048, 6.192578415075928]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14936807877096347, "mean_inference_ms": 0.6962896057944815, "mean_action_processing_ms": 0.09591444331205347, "mean_env_wait_ms": 0.8039679500611605, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 225000, "timesteps_this_iter": 0, "agent_timesteps_total": 675000, "timers": {"sample_time_ms": 10845.209, "sample_throughput": 461.033, "load_time_ms": 0.4, "load_throughput": 12512093.551, "learn_time_ms": 1905.096, "learn_throughput": 2624.54, "update_time_ms": 9.477}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0005000000000000001, "total_loss": 10.586386013031007, "policy_loss": -0.0023180556705811204, "vf_loss": 10.656835079193115, "vf_explained_var": -1.0, "kl": 0.004099553136624657, "entropy": 6.8130850315094, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 225000, "num_agent_steps_sampled": 675000, "num_steps_trained": 225000, "num_agent_steps_trained": 675000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1103, "training_iteration": 45, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-09-24", "timestamp": 1706231364, "time_this_iter_s": 10.91651177406311, "time_total_s": 482.16463565826416, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D29B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 482.16463565826416, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 6.65, "ram_util_percent": 49.53125}}
{"episode_reward_max": 71.35564532130957, "episode_reward_min": -405.225096013397, "episode_reward_mean": -19.841475868062126, "episode_len_mean": 469.12, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -147.14078438282013}, "policy_reward_max": {"shared_policy": 24.023917987942696}, "policy_reward_mean": {"shared_policy": -6.613825289354045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.294895246624918, -320.9735941514373, 15.065619498491259, 23.507946483790874, -21.908814422786264, -14.085436459630742, 12.764196798205361, 2.999198362231226, -1.4461157694459246, 1.446894414722891, 24.70076446235177, 16.488589574815677, 21.324946366250515, 25.919451743364334, 4.871542662382112, -11.074898093938842, -19.70850783586505, -17.614273410290508, -27.459153391420855, -18.678910218179254, -32.184256449341774, -35.67606706917286, 20.23100420087573, -14.135480895638494, -0.009219657629742528, 7.987687084823818, -301.98660176992416, 10.64686829969287, -1.9363673068583154, 4.810580581426592, 11.603179708123207, -405.225096013397, -18.55900473147632, -322.07879292964935, -13.995264705270557, -0.3998616673052595, -298.95067659020424, 15.560002513229847, -295.80638441443443, 7.628704363480182, 17.04415088891983, 1.7206353545188904, -5.768832970410585, -3.265569278970375, -16.482952475547805, 5.552848199382424, -53.30280882865192, 5.985577508807168, 54.495023049414144, -40.3846087642014, 28.7207302143797, 71.35564532130957, -0.32452523708344927, 28.719354383647442, 8.637832242995472, 13.578048489987822, 3.8942756503820135, 3.361627310514436, 13.300417378544793, 8.06808191537857, 18.466666830703588, -329.0227310359478, -316.56259389966726, 2.7855092547833777, 3.35133153665808, 20.654572788625927, 20.11280054226515, -28.064494840800762, 26.308657800778718, 28.96633327100423, -9.662008224055185, -9.170993417501464, 31.360654041171045, 2.07967746257782, 21.841673709452152, 26.833672523498507, 22.750431889668107, 39.75187333300707, 13.400493353605242, 4.770579472184181, -40.17215264588596, 8.094721004366846, 19.437757894396753, 27.050454512238503, 31.30966271832584, 29.111490306444466, -34.23878009244801, 18.531126029789448, 12.822216160595403, 19.36981162801382, 10.310460623353706, 16.121967632323475, 22.75411789864299, 44.67667253315447, 20.0447882413864, 35.24197900295256, -37.38919695094229, 9.809089668327942, 7.729400202631936, 17.42047566920519], "episode_lengths": [500, 75, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 54, 500, 500, 500, 500, 427, 500, 52, 500, 500, 78, 500, 136, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 54, 36, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [2.931504371265561, 3.0292609805862014, 2.334129894773156, -102.92539515842995, -103.52633458872637, -114.52186440428099, 5.2308381224671905, 5.238868581751973, 4.595912794272095, 8.138104222714901, 7.577474072575569, 7.792368188500404, -7.132022542258113, -7.180302118261665, -7.596489762266486, -4.686305428544685, -5.330233107010528, -4.068897924075529, 4.175377671917275, 4.208551382025078, 4.3802677442630085, 0.9833187113205497, 0.9852375338474815, 1.030642117063195, -0.25867385913929297, -0.872275700171798, -0.3151662101348336, 0.15128929416337655, 0.6984604174892013, 0.5971447030703132, 8.432444150249154, 7.916889081398637, 8.35143123070398, 5.64387661839524, 5.865323278975353, 4.979389677445084, 6.632815912365913, 7.197159022092819, 7.494971431791782, 8.922742739319801, 8.56129264831543, 8.435416355729103, 2.064962779482201, 1.7218622018893512, 1.0847176810105594, -3.5220631460348812, -3.651007364193603, -3.9018275837103573, -6.208575551708549, -6.620310654242843, -6.879621629913657, -5.865269613762706, -5.97740722199282, -5.771596574534982, -8.8511881629626, -8.50908749053876, -10.098877737919494, -6.045896177490562, -6.392976333697646, -6.240037706991046, -10.43450017273426, -10.155980259180069, -11.593776017427444, -11.655515372753143, -12.157916218042374, -11.862635478377342, 6.815766813854367, 6.667585382858903, 6.747652004162461, -4.781721731026977, -4.434500907858222, -4.919258256753295, -0.002572620908424028, 0.3185124782224449, -0.3251595149437634, 2.5480227048198287, 2.610682422916085, 2.8289819570879047, -102.4068974852562, -99.1208758354187, -100.45882844924927, 3.432399682700634, 3.566149190068245, 3.6483194269239902, -0.8028288135925976, -0.8538318375746456, -0.2797066556910721, 1.4874162922302787, 1.5442622850338523, 1.778902004162461, 3.8923892080783844, 3.951795816421509, 3.758994683623314, -129.76423037052155, -128.3200812600553, -147.14078438282013, -5.813971879581615, -6.2123949180046765, -6.53263793389003, -103.94486025969188, -103.21316526333491, -114.92076740662257, -4.491985754420369, -4.765716714163631, -4.737562236686557, 0.00869770968952821, -0.36247633894285514, -0.04608303805193259, -97.80424400170645, -97.90295659502348, -103.24347599347433, 5.294365994632244, 5.1685501635074615, 5.097086355090141, -109.8575828075409, -93.61137932538986, -92.33742228150368, 2.121028641859681, 3.073941816265375, 2.433733905355126, 5.609316423535347, 5.669257573783398, 5.765576891601086, 0.737102560698986, 0.6850534752011299, 0.2984793186187744, -2.0024306625127792, -1.9255132153630257, -1.8408890925347805, -1.2452420542637554, -1.1890432933966366, -0.8312839313099829, -5.42677389333646, -5.456750671068832, -5.599427911142513, 2.2102310117334127, 2.2375186420977116, 1.1050985455513, -17.413543219367668, -17.594439851741, -18.29482575754325, 2.0104487588008197, 2.0437421997388157, 1.9313865502675327, 18.18526192506154, 18.15890985478957, 18.150851269563034, -12.75749310106039, -12.411010202020407, -15.216105461120605, 9.179758737484605, 10.026635663273424, 9.51433581362167, 23.81902437657118, 24.023917987942696, 23.512702956795692, -0.28353142241637386, -0.09645829598109401, 0.0554644813140186, 9.78160034865141, 9.427263960242271, 9.510490074753761, 3.1349742251137798, 2.739050130049378, 2.7638078878323142, 4.871340962747723, 4.620505953828484, 4.086201573411614, 1.539883340398461, 1.4085314671198432, 0.9458608428637092, 0.8544362088044437, 1.424281199773148, 1.0829099019368442, 4.535370660324887, 4.491852526863411, 4.273194191356495, 2.8885834887623787, 2.668078862130642, 2.51141956448555, 6.387190500895173, 6.64534428032735, 5.4341320494810645, -103.4623516102632, -106.00036521752676, -119.56001420815787, -115.2946381966273, -100.81824432561795, -100.44971137742202, 0.7557530601819309, 0.6856428732474598, 1.344113321353987, 1.116817491749913, 0.774591947595269, 1.459922097312898, 6.873835163811833, 7.018262005100638, 6.762475619713456, 6.5082481006781165, 6.703125859300286, 6.901426582286746, -9.186553377658129, -9.80127826333046, -9.076663199812174, 9.17103233250478, 8.394877682129533, 8.742747786144406, 9.539757351080567, 9.903792071777076, 9.522783848146588, -2.949653439844653, -3.2306522826353756, -3.481702501575157, -2.9544041926662175, -3.344393546382591, -2.8721956784526554, 10.697090896467358, 10.720193731288106, 9.943369413415581, 0.9458692967891693, 0.8200394213199615, 0.31376874446868896, 7.302714005112648, 7.444278798997402, 7.094680905342102, 8.672075296441704, 9.161744664112717, 8.999852562944085, 7.518822818994522, 8.185324126854539, 7.046284943819046, 13.259476261834294, 13.471032163749129, 13.021364907423646, 4.476051012674958, 4.136039222280175, 4.788403118650109, 2.2335944026708603, 1.1067372262477875, 1.4302478432655334, -11.813911291460201, -12.137001211444542, -16.221240142981216, 2.756734135250241, 2.638565393785626, 2.699421475330979, 6.790363824615866, 5.96679990986982, 6.680594159911067, 9.200490355491638, 8.882437735795975, 8.96752642095089, 10.430440199871853, 10.214198236664132, 10.665024281789854, 9.549904495477676, 10.092441064305604, 9.469144746661186, -10.936340487251684, -11.218941772977516, -12.08349783221881, 6.378893934190273, 6.497262015938759, 5.654970079660416, 4.359684576590851, 4.534553912778691, 3.927977671225861, 6.293421427408845, 6.883811785529048, 6.192578415075928, 3.2866618831952366, 3.7908884746332916, 3.2329102655251774, 5.570200766126305, 5.731211035201937, 4.820555830995232, 7.9000348026553695, 7.36959187189737, 7.484491224090249, 14.483779822786644, 15.143589605887726, 15.049303104480103, 7.00660404687126, 7.131920763601855, 5.906263430913285, 11.835458320875958, 11.699657854934529, 11.706862827142075, -12.729032049576446, -12.377127009133503, -12.283037892232343, 3.9982431458774954, 3.3939127177000046, 2.4169338047504425, 2.454910275836781, 2.3872657095392498, 2.8872242172559055, 5.986448675394058, 6.074517704546452, 5.359509289264679]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14917732169340395, "mean_inference_ms": 0.6965841779500568, "mean_action_processing_ms": 0.09594398481839202, "mean_env_wait_ms": 0.8046183843066911, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 230000, "timesteps_this_iter": 0, "agent_timesteps_total": 690000, "timers": {"sample_time_ms": 10842.334, "sample_throughput": 461.155, "load_time_ms": 0.392, "load_throughput": 12768826.108, "learn_time_ms": 1915.951, "learn_throughput": 2609.67, "update_time_ms": 9.458}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 0.0005000000000000001, "total_loss": 11.62794532775879, "policy_loss": -0.0020054184076717775, "vf_loss": 11.698435401916504, "vf_explained_var": -1.0, "kl": 0.0033423103712307382, "entropy": 6.848554086685181, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 230000, "num_agent_steps_sampled": 690000, "num_steps_trained": 230000, "num_agent_steps_trained": 690000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1113, "training_iteration": 46, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-09-35", "timestamp": 1706231375, "time_this_iter_s": 10.831186771392822, "time_total_s": 492.995822429657, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021404232B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 492.995822429657, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 5.98, "ram_util_percent": 49.55999999999999}}
{"episode_reward_max": 71.35564532130957, "episode_reward_min": -405.225096013397, "episode_reward_mean": -14.495168706835257, "episode_len_mean": 473.37, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -147.14078438282013}, "policy_reward_max": {"shared_policy": 24.023917987942696}, "policy_reward_mean": {"shared_policy": -4.831722902278422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.70076446235177, 16.488589574815677, 21.324946366250515, 25.919451743364334, 4.871542662382112, -11.074898093938842, -19.70850783586505, -17.614273410290508, -27.459153391420855, -18.678910218179254, -32.184256449341774, -35.67606706917286, 20.23100420087573, -14.135480895638494, -0.009219657629742528, 7.987687084823818, -301.98660176992416, 10.64686829969287, -1.9363673068583154, 4.810580581426592, 11.603179708123207, -405.225096013397, -18.55900473147632, -322.07879292964935, -13.995264705270557, -0.3998616673052595, -298.95067659020424, 15.560002513229847, -295.80638441443443, 7.628704363480182, 17.04415088891983, 1.7206353545188904, -5.768832970410585, -3.265569278970375, -16.482952475547805, 5.552848199382424, -53.30280882865192, 5.985577508807168, 54.495023049414144, -40.3846087642014, 28.7207302143797, 71.35564532130957, -0.32452523708344927, 28.719354383647442, 8.637832242995472, 13.578048489987822, 3.8942756503820135, 3.361627310514436, 13.300417378544793, 8.06808191537857, 18.466666830703588, -329.0227310359478, -316.56259389966726, 2.7855092547833777, 3.35133153665808, 20.654572788625927, 20.11280054226515, -28.064494840800762, 26.308657800778718, 28.96633327100423, -9.662008224055185, -9.170993417501464, 31.360654041171045, 2.07967746257782, 21.841673709452152, 26.833672523498507, 22.750431889668107, 39.75187333300707, 13.400493353605242, 4.770579472184181, -40.17215264588596, 8.094721004366846, 19.437757894396753, 27.050454512238503, 31.30966271832584, 29.111490306444466, -34.23878009244801, 18.531126029789448, 12.822216160595403, 19.36981162801382, 10.310460623353706, 16.121967632323475, 22.75411789864299, 44.67667253315447, 20.0447882413864, 35.24197900295256, -37.38919695094229, 9.809089668327942, 7.729400202631936, 17.42047566920519, 33.06348413228986, 21.822656199336024, 33.47078569978474, 21.074124522507176, 28.557907599955797, 43.21461854502557, 27.978601504117222, 34.58218386769293, -28.3701955266297, 24.901339579373598], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 54, 500, 500, 500, 500, 427, 500, 52, 500, 500, 78, 500, 136, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 54, 36, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [8.432444150249154, 7.916889081398637, 8.35143123070398, 5.64387661839524, 5.865323278975353, 4.979389677445084, 6.632815912365913, 7.197159022092819, 7.494971431791782, 8.922742739319801, 8.56129264831543, 8.435416355729103, 2.064962779482201, 1.7218622018893512, 1.0847176810105594, -3.5220631460348812, -3.651007364193603, -3.9018275837103573, -6.208575551708549, -6.620310654242843, -6.879621629913657, -5.865269613762706, -5.97740722199282, -5.771596574534982, -8.8511881629626, -8.50908749053876, -10.098877737919494, -6.045896177490562, -6.392976333697646, -6.240037706991046, -10.43450017273426, -10.155980259180069, -11.593776017427444, -11.655515372753143, -12.157916218042374, -11.862635478377342, 6.815766813854367, 6.667585382858903, 6.747652004162461, -4.781721731026977, -4.434500907858222, -4.919258256753295, -0.002572620908424028, 0.3185124782224449, -0.3251595149437634, 2.5480227048198287, 2.610682422916085, 2.8289819570879047, -102.4068974852562, -99.1208758354187, -100.45882844924927, 3.432399682700634, 3.566149190068245, 3.6483194269239902, -0.8028288135925976, -0.8538318375746456, -0.2797066556910721, 1.4874162922302787, 1.5442622850338523, 1.778902004162461, 3.8923892080783844, 3.951795816421509, 3.758994683623314, -129.76423037052155, -128.3200812600553, -147.14078438282013, -5.813971879581615, -6.2123949180046765, -6.53263793389003, -103.94486025969188, -103.21316526333491, -114.92076740662257, -4.491985754420369, -4.765716714163631, -4.737562236686557, 0.00869770968952821, -0.36247633894285514, -0.04608303805193259, -97.80424400170645, -97.90295659502348, -103.24347599347433, 5.294365994632244, 5.1685501635074615, 5.097086355090141, -109.8575828075409, -93.61137932538986, -92.33742228150368, 2.121028641859681, 3.073941816265375, 2.433733905355126, 5.609316423535347, 5.669257573783398, 5.765576891601086, 0.737102560698986, 0.6850534752011299, 0.2984793186187744, -2.0024306625127792, -1.9255132153630257, -1.8408890925347805, -1.2452420542637554, -1.1890432933966366, -0.8312839313099829, -5.42677389333646, -5.456750671068832, -5.599427911142513, 2.2102310117334127, 2.2375186420977116, 1.1050985455513, -17.413543219367668, -17.594439851741, -18.29482575754325, 2.0104487588008197, 2.0437421997388157, 1.9313865502675327, 18.18526192506154, 18.15890985478957, 18.150851269563034, -12.75749310106039, -12.411010202020407, -15.216105461120605, 9.179758737484605, 10.026635663273424, 9.51433581362167, 23.81902437657118, 24.023917987942696, 23.512702956795692, -0.28353142241637386, -0.09645829598109401, 0.0554644813140186, 9.78160034865141, 9.427263960242271, 9.510490074753761, 3.1349742251137798, 2.739050130049378, 2.7638078878323142, 4.871340962747723, 4.620505953828484, 4.086201573411614, 1.539883340398461, 1.4085314671198432, 0.9458608428637092, 0.8544362088044437, 1.424281199773148, 1.0829099019368442, 4.535370660324887, 4.491852526863411, 4.273194191356495, 2.8885834887623787, 2.668078862130642, 2.51141956448555, 6.387190500895173, 6.64534428032735, 5.4341320494810645, -103.4623516102632, -106.00036521752676, -119.56001420815787, -115.2946381966273, -100.81824432561795, -100.44971137742202, 0.7557530601819309, 0.6856428732474598, 1.344113321353987, 1.116817491749913, 0.774591947595269, 1.459922097312898, 6.873835163811833, 7.018262005100638, 6.762475619713456, 6.5082481006781165, 6.703125859300286, 6.901426582286746, -9.186553377658129, -9.80127826333046, -9.076663199812174, 9.17103233250478, 8.394877682129533, 8.742747786144406, 9.539757351080567, 9.903792071777076, 9.522783848146588, -2.949653439844653, -3.2306522826353756, -3.481702501575157, -2.9544041926662175, -3.344393546382591, -2.8721956784526554, 10.697090896467358, 10.720193731288106, 9.943369413415581, 0.9458692967891693, 0.8200394213199615, 0.31376874446868896, 7.302714005112648, 7.444278798997402, 7.094680905342102, 8.672075296441704, 9.161744664112717, 8.999852562944085, 7.518822818994522, 8.185324126854539, 7.046284943819046, 13.259476261834294, 13.471032163749129, 13.021364907423646, 4.476051012674958, 4.136039222280175, 4.788403118650109, 2.2335944026708603, 1.1067372262477875, 1.4302478432655334, -11.813911291460201, -12.137001211444542, -16.221240142981216, 2.756734135250241, 2.638565393785626, 2.699421475330979, 6.790363824615866, 5.96679990986982, 6.680594159911067, 9.200490355491638, 8.882437735795975, 8.96752642095089, 10.430440199871853, 10.214198236664132, 10.665024281789854, 9.549904495477676, 10.092441064305604, 9.469144746661186, -10.936340487251684, -11.218941772977516, -12.08349783221881, 6.378893934190273, 6.497262015938759, 5.654970079660416, 4.359684576590851, 4.534553912778691, 3.927977671225861, 6.293421427408845, 6.883811785529048, 6.192578415075928, 3.2866618831952366, 3.7908884746332916, 3.2329102655251774, 5.570200766126305, 5.731211035201937, 4.820555830995232, 7.9000348026553695, 7.36959187189737, 7.484491224090249, 14.483779822786644, 15.143589605887726, 15.049303104480103, 7.00660404687126, 7.131920763601855, 5.906263430913285, 11.835458320875958, 11.699657854934529, 11.706862827142075, -12.729032049576446, -12.377127009133503, -12.283037892232343, 3.9982431458774954, 3.3939127177000046, 2.4169338047504425, 2.454910275836781, 2.3872657095392498, 2.8872242172559055, 5.986448675394058, 6.074517704546452, 5.359509289264679, 11.361564422647149, 11.060052315394074, 10.641867394248635, 7.623011852304131, 7.493581632773072, 6.70606271425882, 11.40745448817809, 11.22863246997197, 10.834698741634682, 6.862680633862809, 6.932104547818497, 7.279339340825871, 9.673317141830921, 10.12392209097743, 8.760668367147446, 14.522876547028616, 14.058884729941681, 14.632857268055275, 9.221045571068913, 9.55231352771321, 9.205242405335099, 11.344333608945206, 11.379238759477929, 11.858611499269799, -9.76432376603286, -9.548076326648399, -9.057795433948442, 8.553299307823181, 8.424996677786112, 7.923043593764305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14897899970418216, "mean_inference_ms": 0.6971627407988467, "mean_action_processing_ms": 0.09595441266607367, "mean_env_wait_ms": 0.805583416646032, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 235000, "timesteps_this_iter": 0, "agent_timesteps_total": 705000, "timers": {"sample_time_ms": 11002.568, "sample_throughput": 454.439, "load_time_ms": 0.392, "load_throughput": 12768826.108, "learn_time_ms": 1927.008, "learn_throughput": 2594.696, "update_time_ms": 9.515}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0005000000000000001, "total_loss": 10.012285900115966, "policy_loss": -0.002336605436415429, "vf_loss": 10.084315872192382, "vf_explained_var": -1.0, "kl": 0.005124532805352895, "entropy": 6.96933946609497, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 235000, "num_agent_steps_sampled": 705000, "num_steps_trained": 235000, "num_agent_steps_trained": 705000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1123, "training_iteration": 47, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-09-47", "timestamp": 1706231387, "time_this_iter_s": 11.90699315071106, "time_total_s": 504.90281558036804, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002146EEE2700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 504.90281558036804, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 9.970588235294118, "ram_util_percent": 49.329411764705874}}
{"episode_reward_max": 71.35564532130957, "episode_reward_min": -405.225096013397, "episode_reward_mean": -17.574410980318213, "episode_len_mean": 465.07, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -147.14078438282013}, "policy_reward_max": {"shared_policy": 24.023917987942696}, "policy_reward_mean": {"shared_policy": -5.858136993439407}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.67606706917286, 20.23100420087573, -14.135480895638494, -0.009219657629742528, 7.987687084823818, -301.98660176992416, 10.64686829969287, -1.9363673068583154, 4.810580581426592, 11.603179708123207, -405.225096013397, -18.55900473147632, -322.07879292964935, -13.995264705270557, -0.3998616673052595, -298.95067659020424, 15.560002513229847, -295.80638441443443, 7.628704363480182, 17.04415088891983, 1.7206353545188904, -5.768832970410585, -3.265569278970375, -16.482952475547805, 5.552848199382424, -53.30280882865192, 5.985577508807168, 54.495023049414144, -40.3846087642014, 28.7207302143797, 71.35564532130957, -0.32452523708344927, 28.719354383647442, 8.637832242995472, 13.578048489987822, 3.8942756503820135, 3.361627310514436, 13.300417378544793, 8.06808191537857, 18.466666830703588, -329.0227310359478, -316.56259389966726, 2.7855092547833777, 3.35133153665808, 20.654572788625927, 20.11280054226515, -28.064494840800762, 26.308657800778718, 28.96633327100423, -9.662008224055185, -9.170993417501464, 31.360654041171045, 2.07967746257782, 21.841673709452152, 26.833672523498507, 22.750431889668107, 39.75187333300707, 13.400493353605242, 4.770579472184181, -40.17215264588596, 8.094721004366846, 19.437757894396753, 27.050454512238503, 31.30966271832584, 29.111490306444466, -34.23878009244801, 18.531126029789448, 12.822216160595403, 19.36981162801382, 10.310460623353706, 16.121967632323475, 22.75411789864299, 44.67667253315447, 20.0447882413864, 35.24197900295256, -37.38919695094229, 9.809089668327942, 7.729400202631936, 17.42047566920519, 33.06348413228986, 21.822656199336024, 33.47078569978474, 21.074124522507176, 28.557907599955797, 43.21461854502557, 27.978601504117222, 34.58218386769293, -28.3701955266297, 24.901339579373598, 34.22084225108844, 34.96700763702391, -313.8834817260504, 29.619991376996026, 28.757788027636707, 29.80494318902491, 46.09438382834196, -286.7081131786108, 11.58215529844162, 25.556827530264826, 18.64872382767497], "episode_lengths": [500, 500, 500, 500, 500, 54, 500, 500, 500, 500, 427, 500, 52, 500, 500, 78, 500, 136, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 54, 36, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 100, 500, 500, 500, 500, 70, 500, 500, 500], "policy_shared_policy_reward": [-11.655515372753143, -12.157916218042374, -11.862635478377342, 6.815766813854367, 6.667585382858903, 6.747652004162461, -4.781721731026977, -4.434500907858222, -4.919258256753295, -0.002572620908424028, 0.3185124782224449, -0.3251595149437634, 2.5480227048198287, 2.610682422916085, 2.8289819570879047, -102.4068974852562, -99.1208758354187, -100.45882844924927, 3.432399682700634, 3.566149190068245, 3.6483194269239902, -0.8028288135925976, -0.8538318375746456, -0.2797066556910721, 1.4874162922302787, 1.5442622850338523, 1.778902004162461, 3.8923892080783844, 3.951795816421509, 3.758994683623314, -129.76423037052155, -128.3200812600553, -147.14078438282013, -5.813971879581615, -6.2123949180046765, -6.53263793389003, -103.94486025969188, -103.21316526333491, -114.92076740662257, -4.491985754420369, -4.765716714163631, -4.737562236686557, 0.00869770968952821, -0.36247633894285514, -0.04608303805193259, -97.80424400170645, -97.90295659502348, -103.24347599347433, 5.294365994632244, 5.1685501635074615, 5.097086355090141, -109.8575828075409, -93.61137932538986, -92.33742228150368, 2.121028641859681, 3.073941816265375, 2.433733905355126, 5.609316423535347, 5.669257573783398, 5.765576891601086, 0.737102560698986, 0.6850534752011299, 0.2984793186187744, -2.0024306625127792, -1.9255132153630257, -1.8408890925347805, -1.2452420542637554, -1.1890432933966366, -0.8312839313099829, -5.42677389333646, -5.456750671068832, -5.599427911142513, 2.2102310117334127, 2.2375186420977116, 1.1050985455513, -17.413543219367668, -17.594439851741, -18.29482575754325, 2.0104487588008197, 2.0437421997388157, 1.9313865502675327, 18.18526192506154, 18.15890985478957, 18.150851269563034, -12.75749310106039, -12.411010202020407, -15.216105461120605, 9.179758737484605, 10.026635663273424, 9.51433581362167, 23.81902437657118, 24.023917987942696, 23.512702956795692, -0.28353142241637386, -0.09645829598109401, 0.0554644813140186, 9.78160034865141, 9.427263960242271, 9.510490074753761, 3.1349742251137798, 2.739050130049378, 2.7638078878323142, 4.871340962747723, 4.620505953828484, 4.086201573411614, 1.539883340398461, 1.4085314671198432, 0.9458608428637092, 0.8544362088044437, 1.424281199773148, 1.0829099019368442, 4.535370660324887, 4.491852526863411, 4.273194191356495, 2.8885834887623787, 2.668078862130642, 2.51141956448555, 6.387190500895173, 6.64534428032735, 5.4341320494810645, -103.4623516102632, -106.00036521752676, -119.56001420815787, -115.2946381966273, -100.81824432561795, -100.44971137742202, 0.7557530601819309, 0.6856428732474598, 1.344113321353987, 1.116817491749913, 0.774591947595269, 1.459922097312898, 6.873835163811833, 7.018262005100638, 6.762475619713456, 6.5082481006781165, 6.703125859300286, 6.901426582286746, -9.186553377658129, -9.80127826333046, -9.076663199812174, 9.17103233250478, 8.394877682129533, 8.742747786144406, 9.539757351080567, 9.903792071777076, 9.522783848146588, -2.949653439844653, -3.2306522826353756, -3.481702501575157, -2.9544041926662175, -3.344393546382591, -2.8721956784526554, 10.697090896467358, 10.720193731288106, 9.943369413415581, 0.9458692967891693, 0.8200394213199615, 0.31376874446868896, 7.302714005112648, 7.444278798997402, 7.094680905342102, 8.672075296441704, 9.161744664112717, 8.999852562944085, 7.518822818994522, 8.185324126854539, 7.046284943819046, 13.259476261834294, 13.471032163749129, 13.021364907423646, 4.476051012674958, 4.136039222280175, 4.788403118650109, 2.2335944026708603, 1.1067372262477875, 1.4302478432655334, -11.813911291460201, -12.137001211444542, -16.221240142981216, 2.756734135250241, 2.638565393785626, 2.699421475330979, 6.790363824615866, 5.96679990986982, 6.680594159911067, 9.200490355491638, 8.882437735795975, 8.96752642095089, 10.430440199871853, 10.214198236664132, 10.665024281789854, 9.549904495477676, 10.092441064305604, 9.469144746661186, -10.936340487251684, -11.218941772977516, -12.08349783221881, 6.378893934190273, 6.497262015938759, 5.654970079660416, 4.359684576590851, 4.534553912778691, 3.927977671225861, 6.293421427408845, 6.883811785529048, 6.192578415075928, 3.2866618831952366, 3.7908884746332916, 3.2329102655251774, 5.570200766126305, 5.731211035201937, 4.820555830995232, 7.9000348026553695, 7.36959187189737, 7.484491224090249, 14.483779822786644, 15.143589605887726, 15.049303104480103, 7.00660404687126, 7.131920763601855, 5.906263430913285, 11.835458320875958, 11.699657854934529, 11.706862827142075, -12.729032049576446, -12.377127009133503, -12.283037892232343, 3.9982431458774954, 3.3939127177000046, 2.4169338047504425, 2.454910275836781, 2.3872657095392498, 2.8872242172559055, 5.986448675394058, 6.074517704546452, 5.359509289264679, 11.361564422647149, 11.060052315394074, 10.641867394248635, 7.623011852304131, 7.493581632773072, 6.70606271425882, 11.40745448817809, 11.22863246997197, 10.834698741634682, 6.862680633862809, 6.932104547818497, 7.279339340825871, 9.673317141830921, 10.12392209097743, 8.760668367147446, 14.522876547028616, 14.058884729941681, 14.632857268055275, 9.221045571068913, 9.55231352771321, 9.205242405335099, 11.344333608945206, 11.379238759477929, 11.858611499269799, -9.76432376603286, -9.548076326648399, -9.057795433948442, 8.553299307823181, 8.424996677786112, 7.923043593764305, 11.430724683838577, 11.330913330117852, 11.459204237132013, 11.940006067355469, 11.424427827199295, 11.602573742469147, -100.91218770543735, -112.40364761153857, -100.56764640907447, 9.314950322111443, 10.053283525009945, 10.251757529874638, 9.761795389465988, 9.617269963026047, 9.378722675144672, 9.896505830188588, 10.151159447928265, 9.757277910908059, 15.151026487350464, 15.18572548031807, 15.757631860673428, -103.88502577940623, -91.41837089012067, -91.40471650908391, 3.440194408098847, 3.954498673478753, 4.18746221686402, 8.687537054220826, 8.399617562691361, 8.469672913352639, 6.341222253938511, 5.69079740842183, 6.61670416531463]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14883322946165614, "mean_inference_ms": 0.6978426440572183, "mean_action_processing_ms": 0.09606035819832959, "mean_env_wait_ms": 0.8065278554870342, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 240000, "timesteps_this_iter": 0, "agent_timesteps_total": 720000, "timers": {"sample_time_ms": 11013.791, "sample_throughput": 453.976, "load_time_ms": 0.292, "load_throughput": 17140596.649, "learn_time_ms": 1917.466, "learn_throughput": 2607.608, "update_time_ms": 9.437}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0005000000000000001, "total_loss": 120.79806900024414, "policy_loss": -0.0016514129950633838, "vf_loss": 120.87028503417969, "vf_explained_var": 0.1233739972114563, "kl": 0.0074754124099903575, "entropy": 7.056473064422607, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 240000, "num_agent_steps_sampled": 720000, "num_steps_trained": 240000, "num_agent_steps_trained": 720000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1134, "training_iteration": 48, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-09-58", "timestamp": 1706231398, "time_this_iter_s": 10.935764789581299, "time_total_s": 515.8385803699493, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140424F9D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 515.8385803699493, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 8.493333333333334, "ram_util_percent": 49.39333333333333}}
{"episode_reward_max": 71.35564532130957, "episode_reward_min": -405.225096013397, "episode_reward_mean": -12.837003307596321, "episode_len_mean": 469.53, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -147.14078438282013}, "policy_reward_max": {"shared_policy": 24.023917987942696}, "policy_reward_mean": {"shared_policy": -4.27900110253211}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-405.225096013397, -18.55900473147632, -322.07879292964935, -13.995264705270557, -0.3998616673052595, -298.95067659020424, 15.560002513229847, -295.80638441443443, 7.628704363480182, 17.04415088891983, 1.7206353545188904, -5.768832970410585, -3.265569278970375, -16.482952475547805, 5.552848199382424, -53.30280882865192, 5.985577508807168, 54.495023049414144, -40.3846087642014, 28.7207302143797, 71.35564532130957, -0.32452523708344927, 28.719354383647442, 8.637832242995472, 13.578048489987822, 3.8942756503820135, 3.361627310514436, 13.300417378544793, 8.06808191537857, 18.466666830703588, -329.0227310359478, -316.56259389966726, 2.7855092547833777, 3.35133153665808, 20.654572788625927, 20.11280054226515, -28.064494840800762, 26.308657800778718, 28.96633327100423, -9.662008224055185, -9.170993417501464, 31.360654041171045, 2.07967746257782, 21.841673709452152, 26.833672523498507, 22.750431889668107, 39.75187333300707, 13.400493353605242, 4.770579472184181, -40.17215264588596, 8.094721004366846, 19.437757894396753, 27.050454512238503, 31.30966271832584, 29.111490306444466, -34.23878009244801, 18.531126029789448, 12.822216160595403, 19.36981162801382, 10.310460623353706, 16.121967632323475, 22.75411789864299, 44.67667253315447, 20.0447882413864, 35.24197900295256, -37.38919695094229, 9.809089668327942, 7.729400202631936, 17.42047566920519, 33.06348413228986, 21.822656199336024, 33.47078569978474, 21.074124522507176, 28.557907599955797, 43.21461854502557, 27.978601504117222, 34.58218386769293, -28.3701955266297, 24.901339579373598, 34.22084225108844, 34.96700763702391, -313.8834817260504, 29.619991376996026, 28.757788027636707, 29.80494318902491, 46.09438382834196, -286.7081131786108, 11.58215529844162, 25.556827530264826, 18.64872382767497, -0.6029975563287877, 10.654488861560793, 33.47997570410371, 31.227564696222544, 15.411462932825074, 22.995946928858757, 13.274537317454786, 44.62368327751756, -21.692081272602096, 25.903769558295608], "episode_lengths": [427, 500, 52, 500, 500, 78, 500, 136, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 54, 36, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 100, 500, 500, 500, 500, 70, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-129.76423037052155, -128.3200812600553, -147.14078438282013, -5.813971879581615, -6.2123949180046765, -6.53263793389003, -103.94486025969188, -103.21316526333491, -114.92076740662257, -4.491985754420369, -4.765716714163631, -4.737562236686557, 0.00869770968952821, -0.36247633894285514, -0.04608303805193259, -97.80424400170645, -97.90295659502348, -103.24347599347433, 5.294365994632244, 5.1685501635074615, 5.097086355090141, -109.8575828075409, -93.61137932538986, -92.33742228150368, 2.121028641859681, 3.073941816265375, 2.433733905355126, 5.609316423535347, 5.669257573783398, 5.765576891601086, 0.737102560698986, 0.6850534752011299, 0.2984793186187744, -2.0024306625127792, -1.9255132153630257, -1.8408890925347805, -1.2452420542637554, -1.1890432933966366, -0.8312839313099829, -5.42677389333646, -5.456750671068832, -5.599427911142513, 2.2102310117334127, 2.2375186420977116, 1.1050985455513, -17.413543219367668, -17.594439851741, -18.29482575754325, 2.0104487588008197, 2.0437421997388157, 1.9313865502675327, 18.18526192506154, 18.15890985478957, 18.150851269563034, -12.75749310106039, -12.411010202020407, -15.216105461120605, 9.179758737484605, 10.026635663273424, 9.51433581362167, 23.81902437657118, 24.023917987942696, 23.512702956795692, -0.28353142241637386, -0.09645829598109401, 0.0554644813140186, 9.78160034865141, 9.427263960242271, 9.510490074753761, 3.1349742251137798, 2.739050130049378, 2.7638078878323142, 4.871340962747723, 4.620505953828484, 4.086201573411614, 1.539883340398461, 1.4085314671198432, 0.9458608428637092, 0.8544362088044437, 1.424281199773148, 1.0829099019368442, 4.535370660324887, 4.491852526863411, 4.273194191356495, 2.8885834887623787, 2.668078862130642, 2.51141956448555, 6.387190500895173, 6.64534428032735, 5.4341320494810645, -103.4623516102632, -106.00036521752676, -119.56001420815787, -115.2946381966273, -100.81824432561795, -100.44971137742202, 0.7557530601819309, 0.6856428732474598, 1.344113321353987, 1.116817491749913, 0.774591947595269, 1.459922097312898, 6.873835163811833, 7.018262005100638, 6.762475619713456, 6.5082481006781165, 6.703125859300286, 6.901426582286746, -9.186553377658129, -9.80127826333046, -9.076663199812174, 9.17103233250478, 8.394877682129533, 8.742747786144406, 9.539757351080567, 9.903792071777076, 9.522783848146588, -2.949653439844653, -3.2306522826353756, -3.481702501575157, -2.9544041926662175, -3.344393546382591, -2.8721956784526554, 10.697090896467358, 10.720193731288106, 9.943369413415581, 0.9458692967891693, 0.8200394213199615, 0.31376874446868896, 7.302714005112648, 7.444278798997402, 7.094680905342102, 8.672075296441704, 9.161744664112717, 8.999852562944085, 7.518822818994522, 8.185324126854539, 7.046284943819046, 13.259476261834294, 13.471032163749129, 13.021364907423646, 4.476051012674958, 4.136039222280175, 4.788403118650109, 2.2335944026708603, 1.1067372262477875, 1.4302478432655334, -11.813911291460201, -12.137001211444542, -16.221240142981216, 2.756734135250241, 2.638565393785626, 2.699421475330979, 6.790363824615866, 5.96679990986982, 6.680594159911067, 9.200490355491638, 8.882437735795975, 8.96752642095089, 10.430440199871853, 10.214198236664132, 10.665024281789854, 9.549904495477676, 10.092441064305604, 9.469144746661186, -10.936340487251684, -11.218941772977516, -12.08349783221881, 6.378893934190273, 6.497262015938759, 5.654970079660416, 4.359684576590851, 4.534553912778691, 3.927977671225861, 6.293421427408845, 6.883811785529048, 6.192578415075928, 3.2866618831952366, 3.7908884746332916, 3.2329102655251774, 5.570200766126305, 5.731211035201937, 4.820555830995232, 7.9000348026553695, 7.36959187189737, 7.484491224090249, 14.483779822786644, 15.143589605887726, 15.049303104480103, 7.00660404687126, 7.131920763601855, 5.906263430913285, 11.835458320875958, 11.699657854934529, 11.706862827142075, -12.729032049576446, -12.377127009133503, -12.283037892232343, 3.9982431458774954, 3.3939127177000046, 2.4169338047504425, 2.454910275836781, 2.3872657095392498, 2.8872242172559055, 5.986448675394058, 6.074517704546452, 5.359509289264679, 11.361564422647149, 11.060052315394074, 10.641867394248635, 7.623011852304131, 7.493581632773072, 6.70606271425882, 11.40745448817809, 11.22863246997197, 10.834698741634682, 6.862680633862809, 6.932104547818497, 7.279339340825871, 9.673317141830921, 10.12392209097743, 8.760668367147446, 14.522876547028616, 14.058884729941681, 14.632857268055275, 9.221045571068913, 9.55231352771321, 9.205242405335099, 11.344333608945206, 11.379238759477929, 11.858611499269799, -9.76432376603286, -9.548076326648399, -9.057795433948442, 8.553299307823181, 8.424996677786112, 7.923043593764305, 11.430724683838577, 11.330913330117852, 11.459204237132013, 11.940006067355469, 11.424427827199295, 11.602573742469147, -100.91218770543735, -112.40364761153857, -100.56764640907447, 9.314950322111443, 10.053283525009945, 10.251757529874638, 9.761795389465988, 9.617269963026047, 9.378722675144672, 9.896505830188588, 10.151159447928265, 9.757277910908059, 15.151026487350464, 15.18572548031807, 15.757631860673428, -103.88502577940623, -91.41837089012067, -91.40471650908391, 3.440194408098847, 3.954498673478753, 4.18746221686402, 8.687537054220826, 8.399617562691361, 8.469672913352639, 6.341222253938511, 5.69079740842183, 6.61670416531463, -0.26287099222342647, -0.2952435413996426, -0.044883022705718645, 3.449725727240235, 3.796015972892434, 3.408747161428124, 11.367261055856943, 11.046428941190243, 11.066285707056522, 10.380956523120403, 10.742229755967855, 10.104378417134285, 4.908229013284043, 5.270271872480706, 5.232962047060326, 7.437395825982094, 7.788037247955799, 7.770513854920864, 4.532642337183148, 4.4013892213503425, 4.340505758921296, 14.644759699702263, 14.805092617869377, 15.173830959945917, -5.88314973811309, -6.150506223241493, -9.658425311247512, 8.385637633502483, 8.663932763040066, 8.854199161753058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1486577905574934, "mean_inference_ms": 0.6983084433925717, "mean_action_processing_ms": 0.09608024306778122, "mean_env_wait_ms": 0.8073583932176619, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 245000, "timesteps_this_iter": 0, "agent_timesteps_total": 735000, "timers": {"sample_time_ms": 11023.16, "sample_throughput": 453.59, "load_time_ms": 0.292, "load_throughput": 17140596.649, "learn_time_ms": 1930.146, "learn_throughput": 2590.478, "update_time_ms": 9.755}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0005000000000000001, "total_loss": 11.202209949493408, "policy_loss": -0.0021525229751008013, "vf_loss": 11.27505807876587, "vf_explained_var": -1.0, "kl": 0.002950977801816175, "entropy": 7.069553422927856, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 245000, "num_agent_steps_sampled": 735000, "num_steps_trained": 245000, "num_agent_steps_trained": 735000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1144, "training_iteration": 49, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-10-09", "timestamp": 1706231409, "time_this_iter_s": 11.24010157585144, "time_total_s": 527.0786819458008, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401A74550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 527.0786819458008, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 10.700000000000001, "ram_util_percent": 49.73125}}
{"episode_reward_max": 71.35564532130957, "episode_reward_min": -329.0227310359478, "episode_reward_mean": 3.0239709701645086, "episode_len_mean": 482.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -119.56001420815787}, "policy_reward_max": {"shared_policy": 24.023917987942696}, "policy_reward_mean": {"shared_policy": 1.0079903233881682}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.7206353545188904, -5.768832970410585, -3.265569278970375, -16.482952475547805, 5.552848199382424, -53.30280882865192, 5.985577508807168, 54.495023049414144, -40.3846087642014, 28.7207302143797, 71.35564532130957, -0.32452523708344927, 28.719354383647442, 8.637832242995472, 13.578048489987822, 3.8942756503820135, 3.361627310514436, 13.300417378544793, 8.06808191537857, 18.466666830703588, -329.0227310359478, -316.56259389966726, 2.7855092547833777, 3.35133153665808, 20.654572788625927, 20.11280054226515, -28.064494840800762, 26.308657800778718, 28.96633327100423, -9.662008224055185, -9.170993417501464, 31.360654041171045, 2.07967746257782, 21.841673709452152, 26.833672523498507, 22.750431889668107, 39.75187333300707, 13.400493353605242, 4.770579472184181, -40.17215264588596, 8.094721004366846, 19.437757894396753, 27.050454512238503, 31.30966271832584, 29.111490306444466, -34.23878009244801, 18.531126029789448, 12.822216160595403, 19.36981162801382, 10.310460623353706, 16.121967632323475, 22.75411789864299, 44.67667253315447, 20.0447882413864, 35.24197900295256, -37.38919695094229, 9.809089668327942, 7.729400202631936, 17.42047566920519, 33.06348413228986, 21.822656199336024, 33.47078569978474, 21.074124522507176, 28.557907599955797, 43.21461854502557, 27.978601504117222, 34.58218386769293, -28.3701955266297, 24.901339579373598, 34.22084225108844, 34.96700763702391, -313.8834817260504, 29.619991376996026, 28.757788027636707, 29.80494318902491, 46.09438382834196, -286.7081131786108, 11.58215529844162, 25.556827530264826, 18.64872382767497, -0.6029975563287877, 10.654488861560793, 33.47997570410371, 31.227564696222544, 15.411462932825074, 22.995946928858757, 13.274537317454786, 44.62368327751756, -21.692081272602096, 25.903769558295608, 16.856818299740553, 46.52182020992039, 23.10202360898255, 23.81006213277577, 27.16195527836679, 25.918529428541646, 27.44350691139698, 23.194529943168135, 26.142134837806225, 31.16382383927703], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 54, 36, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 100, 500, 500, 500, 500, 70, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [0.737102560698986, 0.6850534752011299, 0.2984793186187744, -2.0024306625127792, -1.9255132153630257, -1.8408890925347805, -1.2452420542637554, -1.1890432933966366, -0.8312839313099829, -5.42677389333646, -5.456750671068832, -5.599427911142513, 2.2102310117334127, 2.2375186420977116, 1.1050985455513, -17.413543219367668, -17.594439851741, -18.29482575754325, 2.0104487588008197, 2.0437421997388157, 1.9313865502675327, 18.18526192506154, 18.15890985478957, 18.150851269563034, -12.75749310106039, -12.411010202020407, -15.216105461120605, 9.179758737484605, 10.026635663273424, 9.51433581362167, 23.81902437657118, 24.023917987942696, 23.512702956795692, -0.28353142241637386, -0.09645829598109401, 0.0554644813140186, 9.78160034865141, 9.427263960242271, 9.510490074753761, 3.1349742251137798, 2.739050130049378, 2.7638078878323142, 4.871340962747723, 4.620505953828484, 4.086201573411614, 1.539883340398461, 1.4085314671198432, 0.9458608428637092, 0.8544362088044437, 1.424281199773148, 1.0829099019368442, 4.535370660324887, 4.491852526863411, 4.273194191356495, 2.8885834887623787, 2.668078862130642, 2.51141956448555, 6.387190500895173, 6.64534428032735, 5.4341320494810645, -103.4623516102632, -106.00036521752676, -119.56001420815787, -115.2946381966273, -100.81824432561795, -100.44971137742202, 0.7557530601819309, 0.6856428732474598, 1.344113321353987, 1.116817491749913, 0.774591947595269, 1.459922097312898, 6.873835163811833, 7.018262005100638, 6.762475619713456, 6.5082481006781165, 6.703125859300286, 6.901426582286746, -9.186553377658129, -9.80127826333046, -9.076663199812174, 9.17103233250478, 8.394877682129533, 8.742747786144406, 9.539757351080567, 9.903792071777076, 9.522783848146588, -2.949653439844653, -3.2306522826353756, -3.481702501575157, -2.9544041926662175, -3.344393546382591, -2.8721956784526554, 10.697090896467358, 10.720193731288106, 9.943369413415581, 0.9458692967891693, 0.8200394213199615, 0.31376874446868896, 7.302714005112648, 7.444278798997402, 7.094680905342102, 8.672075296441704, 9.161744664112717, 8.999852562944085, 7.518822818994522, 8.185324126854539, 7.046284943819046, 13.259476261834294, 13.471032163749129, 13.021364907423646, 4.476051012674958, 4.136039222280175, 4.788403118650109, 2.2335944026708603, 1.1067372262477875, 1.4302478432655334, -11.813911291460201, -12.137001211444542, -16.221240142981216, 2.756734135250241, 2.638565393785626, 2.699421475330979, 6.790363824615866, 5.96679990986982, 6.680594159911067, 9.200490355491638, 8.882437735795975, 8.96752642095089, 10.430440199871853, 10.214198236664132, 10.665024281789854, 9.549904495477676, 10.092441064305604, 9.469144746661186, -10.936340487251684, -11.218941772977516, -12.08349783221881, 6.378893934190273, 6.497262015938759, 5.654970079660416, 4.359684576590851, 4.534553912778691, 3.927977671225861, 6.293421427408845, 6.883811785529048, 6.192578415075928, 3.2866618831952366, 3.7908884746332916, 3.2329102655251774, 5.570200766126305, 5.731211035201937, 4.820555830995232, 7.9000348026553695, 7.36959187189737, 7.484491224090249, 14.483779822786644, 15.143589605887726, 15.049303104480103, 7.00660404687126, 7.131920763601855, 5.906263430913285, 11.835458320875958, 11.699657854934529, 11.706862827142075, -12.729032049576446, -12.377127009133503, -12.283037892232343, 3.9982431458774954, 3.3939127177000046, 2.4169338047504425, 2.454910275836781, 2.3872657095392498, 2.8872242172559055, 5.986448675394058, 6.074517704546452, 5.359509289264679, 11.361564422647149, 11.060052315394074, 10.641867394248635, 7.623011852304131, 7.493581632773072, 6.70606271425882, 11.40745448817809, 11.22863246997197, 10.834698741634682, 6.862680633862809, 6.932104547818497, 7.279339340825871, 9.673317141830921, 10.12392209097743, 8.760668367147446, 14.522876547028616, 14.058884729941681, 14.632857268055275, 9.221045571068913, 9.55231352771321, 9.205242405335099, 11.344333608945206, 11.379238759477929, 11.858611499269799, -9.76432376603286, -9.548076326648399, -9.057795433948442, 8.553299307823181, 8.424996677786112, 7.923043593764305, 11.430724683838577, 11.330913330117852, 11.459204237132013, 11.940006067355469, 11.424427827199295, 11.602573742469147, -100.91218770543735, -112.40364761153857, -100.56764640907447, 9.314950322111443, 10.053283525009945, 10.251757529874638, 9.761795389465988, 9.617269963026047, 9.378722675144672, 9.896505830188588, 10.151159447928265, 9.757277910908059, 15.151026487350464, 15.18572548031807, 15.757631860673428, -103.88502577940623, -91.41837089012067, -91.40471650908391, 3.440194408098847, 3.954498673478753, 4.18746221686402, 8.687537054220826, 8.399617562691361, 8.469672913352639, 6.341222253938511, 5.69079740842183, 6.61670416531463, -0.26287099222342647, -0.2952435413996426, -0.044883022705718645, 3.449725727240235, 3.796015972892434, 3.408747161428124, 11.367261055856943, 11.046428941190243, 11.066285707056522, 10.380956523120403, 10.742229755967855, 10.104378417134285, 4.908229013284043, 5.270271872480706, 5.232962047060326, 7.437395825982094, 7.788037247955799, 7.770513854920864, 4.532642337183148, 4.4013892213503425, 4.340505758921296, 14.644759699702263, 14.805092617869377, 15.173830959945917, -5.88314973811309, -6.150506223241493, -9.658425311247512, 8.385637633502483, 8.663932763040066, 8.854199161753058, 5.386982500553131, 5.982125919312239, 5.487709879875183, 15.127037604649857, 16.00087995578845, 15.393902649482087, 8.304810998340443, 6.948221911986664, 7.848990698655442, 8.20491375525792, 7.896145117779568, 7.709003259738282, 8.901855220397309, 8.846800496180848, 9.413299561788634, 8.530041148265198, 8.672946674128369, 8.71554160614808, 9.03495179116726, 9.061030387878418, 9.347524732351303, 7.864688004056603, 7.40366745988527, 7.926174479226262, 8.75100214779377, 8.584536954760551, 8.806595735251904, 10.201197996735573, 10.092944115400314, 10.869681727141142]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14859784473407012, "mean_inference_ms": 0.6988680149005908, "mean_action_processing_ms": 0.09615140525563927, "mean_env_wait_ms": 0.8083928288213268, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 250000, "timesteps_this_iter": 0, "agent_timesteps_total": 750000, "timers": {"sample_time_ms": 11130.038, "sample_throughput": 449.235, "load_time_ms": 0.392, "load_throughput": 12764163.116, "learn_time_ms": 1966.43, "learn_throughput": 2542.679, "update_time_ms": 9.662}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 0.0005000000000000001, "total_loss": 10.672381114959716, "policy_loss": -0.0020753337450387654, "vf_loss": 10.745353317260742, "vf_explained_var": -1.0, "kl": 0.0026573622417399726, "entropy": 7.089682340621948, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 250000, "num_agent_steps_sampled": 750000, "num_steps_trained": 250000, "num_agent_steps_trained": 750000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 46.47422039904632, "episode_reward_min": 20.963549114763723, "episode_reward_mean": 34.81539428835676, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 6.760130917032555}, "policy_reward_max": {"shared_policy": 16.06476062373258}, "policy_reward_mean": {"shared_policy": 11.605131429452252}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.939448133111, 28.1931624263525, 44.02715245680881, 38.16001762263474, 20.963549114763723, 33.39561614394185, 46.47422039904632, 37.63042997824958, 41.13669053380727, 30.23365607485175], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [9.364413879811764, 9.430163688957691, 9.144870564341545, 9.342895463109016, 9.362714976072311, 9.487551987171173, 14.789298372964055, 13.970826129118592, 15.26702795472616, 13.077679228658468, 13.02806708837548, 12.054271305600793, 6.760130917032555, 6.922280882795647, 7.2811373149355205, 11.047677444914967, 11.129857497910649, 11.218081201116235, 14.463159710168839, 15.946300065144897, 16.06476062373258, 12.777568921524406, 12.418737356861428, 12.434123699863747, 13.613299943506718, 14.235637842764845, 13.287752747535706, 10.413295160979033, 10.233741253614426, 9.586619660258293]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12837803571182738, "mean_inference_ms": 0.7380608724751632, "mean_action_processing_ms": 0.0979644826497347, "mean_env_wait_ms": 0.8559237001324099, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 1154, "training_iteration": 50, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-10-31", "timestamp": 1706231431, "time_this_iter_s": 21.152317762374878, "time_total_s": 548.2309997081757, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401AAAD30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 548.2309997081757, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 12.323333333333334, "ram_util_percent": 55.99333333333333}}
{"episode_reward_max": 71.35564532130957, "episode_reward_min": -329.0227310359478, "episode_reward_mean": 5.924054415842973, "episode_len_mean": 482.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -119.56001420815787}, "policy_reward_max": {"shared_policy": 24.023917987942696}, "policy_reward_mean": {"shared_policy": 1.9746848052809909}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.35564532130957, -0.32452523708344927, 28.719354383647442, 8.637832242995472, 13.578048489987822, 3.8942756503820135, 3.361627310514436, 13.300417378544793, 8.06808191537857, 18.466666830703588, -329.0227310359478, -316.56259389966726, 2.7855092547833777, 3.35133153665808, 20.654572788625927, 20.11280054226515, -28.064494840800762, 26.308657800778718, 28.96633327100423, -9.662008224055185, -9.170993417501464, 31.360654041171045, 2.07967746257782, 21.841673709452152, 26.833672523498507, 22.750431889668107, 39.75187333300707, 13.400493353605242, 4.770579472184181, -40.17215264588596, 8.094721004366846, 19.437757894396753, 27.050454512238503, 31.30966271832584, 29.111490306444466, -34.23878009244801, 18.531126029789448, 12.822216160595403, 19.36981162801382, 10.310460623353706, 16.121967632323475, 22.75411789864299, 44.67667253315447, 20.0447882413864, 35.24197900295256, -37.38919695094229, 9.809089668327942, 7.729400202631936, 17.42047566920519, 33.06348413228986, 21.822656199336024, 33.47078569978474, 21.074124522507176, 28.557907599955797, 43.21461854502557, 27.978601504117222, 34.58218386769293, -28.3701955266297, 24.901339579373598, 34.22084225108844, 34.96700763702391, -313.8834817260504, 29.619991376996026, 28.757788027636707, 29.80494318902491, 46.09438382834196, -286.7081131786108, 11.58215529844162, 25.556827530264826, 18.64872382767497, -0.6029975563287877, 10.654488861560793, 33.47997570410371, 31.227564696222544, 15.411462932825074, 22.995946928858757, 13.274537317454786, 44.62368327751756, -21.692081272602096, 25.903769558295608, 16.856818299740553, 46.52182020992039, 23.10202360898255, 23.81006213277577, 27.16195527836679, 25.918529428541646, 27.44350691139698, 23.194529943168135, 26.142134837806225, 31.16382383927703, 38.907153338193865, -0.7576121329329908, -5.13676093891263, 19.233609147369847, 54.07259236648679, 26.542115308344364, 40.49066262319684, 30.12207615002987, 28.180939015001044, 35.62361169978976], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 54, 36, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 100, 500, 500, 500, 500, 70, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [23.81902437657118, 24.023917987942696, 23.512702956795692, -0.28353142241637386, -0.09645829598109401, 0.0554644813140186, 9.78160034865141, 9.427263960242271, 9.510490074753761, 3.1349742251137798, 2.739050130049378, 2.7638078878323142, 4.871340962747723, 4.620505953828484, 4.086201573411614, 1.539883340398461, 1.4085314671198432, 0.9458608428637092, 0.8544362088044437, 1.424281199773148, 1.0829099019368442, 4.535370660324887, 4.491852526863411, 4.273194191356495, 2.8885834887623787, 2.668078862130642, 2.51141956448555, 6.387190500895173, 6.64534428032735, 5.4341320494810645, -103.4623516102632, -106.00036521752676, -119.56001420815787, -115.2946381966273, -100.81824432561795, -100.44971137742202, 0.7557530601819309, 0.6856428732474598, 1.344113321353987, 1.116817491749913, 0.774591947595269, 1.459922097312898, 6.873835163811833, 7.018262005100638, 6.762475619713456, 6.5082481006781165, 6.703125859300286, 6.901426582286746, -9.186553377658129, -9.80127826333046, -9.076663199812174, 9.17103233250478, 8.394877682129533, 8.742747786144406, 9.539757351080567, 9.903792071777076, 9.522783848146588, -2.949653439844653, -3.2306522826353756, -3.481702501575157, -2.9544041926662175, -3.344393546382591, -2.8721956784526554, 10.697090896467358, 10.720193731288106, 9.943369413415581, 0.9458692967891693, 0.8200394213199615, 0.31376874446868896, 7.302714005112648, 7.444278798997402, 7.094680905342102, 8.672075296441704, 9.161744664112717, 8.999852562944085, 7.518822818994522, 8.185324126854539, 7.046284943819046, 13.259476261834294, 13.471032163749129, 13.021364907423646, 4.476051012674958, 4.136039222280175, 4.788403118650109, 2.2335944026708603, 1.1067372262477875, 1.4302478432655334, -11.813911291460201, -12.137001211444542, -16.221240142981216, 2.756734135250241, 2.638565393785626, 2.699421475330979, 6.790363824615866, 5.96679990986982, 6.680594159911067, 9.200490355491638, 8.882437735795975, 8.96752642095089, 10.430440199871853, 10.214198236664132, 10.665024281789854, 9.549904495477676, 10.092441064305604, 9.469144746661186, -10.936340487251684, -11.218941772977516, -12.08349783221881, 6.378893934190273, 6.497262015938759, 5.654970079660416, 4.359684576590851, 4.534553912778691, 3.927977671225861, 6.293421427408845, 6.883811785529048, 6.192578415075928, 3.2866618831952366, 3.7908884746332916, 3.2329102655251774, 5.570200766126305, 5.731211035201937, 4.820555830995232, 7.9000348026553695, 7.36959187189737, 7.484491224090249, 14.483779822786644, 15.143589605887726, 15.049303104480103, 7.00660404687126, 7.131920763601855, 5.906263430913285, 11.835458320875958, 11.699657854934529, 11.706862827142075, -12.729032049576446, -12.377127009133503, -12.283037892232343, 3.9982431458774954, 3.3939127177000046, 2.4169338047504425, 2.454910275836781, 2.3872657095392498, 2.8872242172559055, 5.986448675394058, 6.074517704546452, 5.359509289264679, 11.361564422647149, 11.060052315394074, 10.641867394248635, 7.623011852304131, 7.493581632773072, 6.70606271425882, 11.40745448817809, 11.22863246997197, 10.834698741634682, 6.862680633862809, 6.932104547818497, 7.279339340825871, 9.673317141830921, 10.12392209097743, 8.760668367147446, 14.522876547028616, 14.058884729941681, 14.632857268055275, 9.221045571068913, 9.55231352771321, 9.205242405335099, 11.344333608945206, 11.379238759477929, 11.858611499269799, -9.76432376603286, -9.548076326648399, -9.057795433948442, 8.553299307823181, 8.424996677786112, 7.923043593764305, 11.430724683838577, 11.330913330117852, 11.459204237132013, 11.940006067355469, 11.424427827199295, 11.602573742469147, -100.91218770543735, -112.40364761153857, -100.56764640907447, 9.314950322111443, 10.053283525009945, 10.251757529874638, 9.761795389465988, 9.617269963026047, 9.378722675144672, 9.896505830188588, 10.151159447928265, 9.757277910908059, 15.151026487350464, 15.18572548031807, 15.757631860673428, -103.88502577940623, -91.41837089012067, -91.40471650908391, 3.440194408098847, 3.954498673478753, 4.18746221686402, 8.687537054220826, 8.399617562691361, 8.469672913352639, 6.341222253938511, 5.69079740842183, 6.61670416531463, -0.26287099222342647, -0.2952435413996426, -0.044883022705718645, 3.449725727240235, 3.796015972892434, 3.408747161428124, 11.367261055856943, 11.046428941190243, 11.066285707056522, 10.380956523120403, 10.742229755967855, 10.104378417134285, 4.908229013284043, 5.270271872480706, 5.232962047060326, 7.437395825982094, 7.788037247955799, 7.770513854920864, 4.532642337183148, 4.4013892213503425, 4.340505758921296, 14.644759699702263, 14.805092617869377, 15.173830959945917, -5.88314973811309, -6.150506223241493, -9.658425311247512, 8.385637633502483, 8.663932763040066, 8.854199161753058, 5.386982500553131, 5.982125919312239, 5.487709879875183, 15.127037604649857, 16.00087995578845, 15.393902649482087, 8.304810998340443, 6.948221911986664, 7.848990698655442, 8.20491375525792, 7.896145117779568, 7.709003259738282, 8.901855220397309, 8.846800496180848, 9.413299561788634, 8.530041148265198, 8.672946674128369, 8.71554160614808, 9.03495179116726, 9.061030387878418, 9.347524732351303, 7.864688004056603, 7.40366745988527, 7.926174479226262, 8.75100214779377, 8.584536954760551, 8.806595735251904, 10.201197996735573, 10.092944115400314, 10.869681727141142, 13.3932389418284, 12.443448389569909, 13.070466006795556, 0.18487957352772355, -0.867797389626503, -0.07469431683421135, -1.0711957700550556, -2.132381498813629, -1.9331836700439453, 6.437817541261509, 6.839073513944939, 5.956718092163399, 18.26429396122694, 17.570612385869026, 18.23768601939082, 8.88541654497385, 8.500515788793564, 9.15618297457695, 13.878522384911776, 12.884301245212555, 13.72783899307251, 10.118873829642922, 10.540686419854552, 9.462515900532395, 9.359084044893578, 9.193948109944657, 9.62790686016281, 11.997771754860878, 11.5697533339262, 12.056086611002684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14850847069041206, "mean_inference_ms": 0.6995492719472688, "mean_action_processing_ms": 0.09619568457220967, "mean_env_wait_ms": 0.8093993176086071, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 255000, "timesteps_this_iter": 0, "agent_timesteps_total": 765000, "timers": {"sample_time_ms": 12099.793, "sample_throughput": 413.23, "load_time_ms": 0.392, "load_throughput": 12764163.116, "learn_time_ms": 1970.934, "learn_throughput": 2536.868, "update_time_ms": 9.748}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 0.0005000000000000001, "total_loss": 10.472784042358398, "policy_loss": -0.0021029501462479063, "vf_loss": 10.545867919921875, "vf_explained_var": -1.0, "kl": 0.0038252781087119965, "entropy": 7.098118638992309, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 255000, "num_agent_steps_sampled": 765000, "num_steps_trained": 255000, "num_agent_steps_trained": 765000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1164, "training_iteration": 51, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-10-42", "timestamp": 1706231442, "time_this_iter_s": 11.072162389755249, "time_total_s": 559.3031620979309, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401AAACA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 559.3031620979309, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 7.025, "ram_util_percent": 59.1625}}
{"episode_reward_max": 57.30805618315934, "episode_reward_min": -329.0227310359478, "episode_reward_mean": 7.547293843470971, "episode_len_mean": 482.6, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -119.56001420815787}, "policy_reward_max": {"shared_policy": 19.368657288451985}, "policy_reward_mean": {"shared_policy": 2.5157646144903225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-329.0227310359478, -316.56259389966726, 2.7855092547833777, 3.35133153665808, 20.654572788625927, 20.11280054226515, -28.064494840800762, 26.308657800778718, 28.96633327100423, -9.662008224055185, -9.170993417501464, 31.360654041171045, 2.07967746257782, 21.841673709452152, 26.833672523498507, 22.750431889668107, 39.75187333300707, 13.400493353605242, 4.770579472184181, -40.17215264588596, 8.094721004366846, 19.437757894396753, 27.050454512238503, 31.30966271832584, 29.111490306444466, -34.23878009244801, 18.531126029789448, 12.822216160595403, 19.36981162801382, 10.310460623353706, 16.121967632323475, 22.75411789864299, 44.67667253315447, 20.0447882413864, 35.24197900295256, -37.38919695094229, 9.809089668327942, 7.729400202631936, 17.42047566920519, 33.06348413228986, 21.822656199336024, 33.47078569978474, 21.074124522507176, 28.557907599955797, 43.21461854502557, 27.978601504117222, 34.58218386769293, -28.3701955266297, 24.901339579373598, 34.22084225108844, 34.96700763702391, -313.8834817260504, 29.619991376996026, 28.757788027636707, 29.80494318902491, 46.09438382834196, -286.7081131786108, 11.58215529844162, 25.556827530264826, 18.64872382767497, -0.6029975563287877, 10.654488861560793, 33.47997570410371, 31.227564696222544, 15.411462932825074, 22.995946928858757, 13.274537317454786, 44.62368327751756, -21.692081272602096, 25.903769558295608, 16.856818299740553, 46.52182020992039, 23.10202360898255, 23.81006213277577, 27.16195527836679, 25.918529428541646, 27.44350691139698, 23.194529943168135, 26.142134837806225, 31.16382383927703, 38.907153338193865, -0.7576121329329908, -5.13676093891263, 19.233609147369847, 54.07259236648679, 26.542115308344364, 40.49066262319684, 30.12207615002987, 28.180939015001044, 35.62361169978976, 19.13772495836018, 23.284264959394918, 15.890732295811162, 50.66159513406453, 45.70121515542269, 30.321186840534182, 21.79183027893305, 31.362268626689897, 35.92249261680989, 57.30805618315934], "episode_lengths": [54, 36, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 100, 500, 500, 500, 500, 70, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-103.4623516102632, -106.00036521752676, -119.56001420815787, -115.2946381966273, -100.81824432561795, -100.44971137742202, 0.7557530601819309, 0.6856428732474598, 1.344113321353987, 1.116817491749913, 0.774591947595269, 1.459922097312898, 6.873835163811833, 7.018262005100638, 6.762475619713456, 6.5082481006781165, 6.703125859300286, 6.901426582286746, -9.186553377658129, -9.80127826333046, -9.076663199812174, 9.17103233250478, 8.394877682129533, 8.742747786144406, 9.539757351080567, 9.903792071777076, 9.522783848146588, -2.949653439844653, -3.2306522826353756, -3.481702501575157, -2.9544041926662175, -3.344393546382591, -2.8721956784526554, 10.697090896467358, 10.720193731288106, 9.943369413415581, 0.9458692967891693, 0.8200394213199615, 0.31376874446868896, 7.302714005112648, 7.444278798997402, 7.094680905342102, 8.672075296441704, 9.161744664112717, 8.999852562944085, 7.518822818994522, 8.185324126854539, 7.046284943819046, 13.259476261834294, 13.471032163749129, 13.021364907423646, 4.476051012674958, 4.136039222280175, 4.788403118650109, 2.2335944026708603, 1.1067372262477875, 1.4302478432655334, -11.813911291460201, -12.137001211444542, -16.221240142981216, 2.756734135250241, 2.638565393785626, 2.699421475330979, 6.790363824615866, 5.96679990986982, 6.680594159911067, 9.200490355491638, 8.882437735795975, 8.96752642095089, 10.430440199871853, 10.214198236664132, 10.665024281789854, 9.549904495477676, 10.092441064305604, 9.469144746661186, -10.936340487251684, -11.218941772977516, -12.08349783221881, 6.378893934190273, 6.497262015938759, 5.654970079660416, 4.359684576590851, 4.534553912778691, 3.927977671225861, 6.293421427408845, 6.883811785529048, 6.192578415075928, 3.2866618831952366, 3.7908884746332916, 3.2329102655251774, 5.570200766126305, 5.731211035201937, 4.820555830995232, 7.9000348026553695, 7.36959187189737, 7.484491224090249, 14.483779822786644, 15.143589605887726, 15.049303104480103, 7.00660404687126, 7.131920763601855, 5.906263430913285, 11.835458320875958, 11.699657854934529, 11.706862827142075, -12.729032049576446, -12.377127009133503, -12.283037892232343, 3.9982431458774954, 3.3939127177000046, 2.4169338047504425, 2.454910275836781, 2.3872657095392498, 2.8872242172559055, 5.986448675394058, 6.074517704546452, 5.359509289264679, 11.361564422647149, 11.060052315394074, 10.641867394248635, 7.623011852304131, 7.493581632773072, 6.70606271425882, 11.40745448817809, 11.22863246997197, 10.834698741634682, 6.862680633862809, 6.932104547818497, 7.279339340825871, 9.673317141830921, 10.12392209097743, 8.760668367147446, 14.522876547028616, 14.058884729941681, 14.632857268055275, 9.221045571068913, 9.55231352771321, 9.205242405335099, 11.344333608945206, 11.379238759477929, 11.858611499269799, -9.76432376603286, -9.548076326648399, -9.057795433948442, 8.553299307823181, 8.424996677786112, 7.923043593764305, 11.430724683838577, 11.330913330117852, 11.459204237132013, 11.940006067355469, 11.424427827199295, 11.602573742469147, -100.91218770543735, -112.40364761153857, -100.56764640907447, 9.314950322111443, 10.053283525009945, 10.251757529874638, 9.761795389465988, 9.617269963026047, 9.378722675144672, 9.896505830188588, 10.151159447928265, 9.757277910908059, 15.151026487350464, 15.18572548031807, 15.757631860673428, -103.88502577940623, -91.41837089012067, -91.40471650908391, 3.440194408098847, 3.954498673478753, 4.18746221686402, 8.687537054220826, 8.399617562691361, 8.469672913352639, 6.341222253938511, 5.69079740842183, 6.61670416531463, -0.26287099222342647, -0.2952435413996426, -0.044883022705718645, 3.449725727240235, 3.796015972892434, 3.408747161428124, 11.367261055856943, 11.046428941190243, 11.066285707056522, 10.380956523120403, 10.742229755967855, 10.104378417134285, 4.908229013284043, 5.270271872480706, 5.232962047060326, 7.437395825982094, 7.788037247955799, 7.770513854920864, 4.532642337183148, 4.4013892213503425, 4.340505758921296, 14.644759699702263, 14.805092617869377, 15.173830959945917, -5.88314973811309, -6.150506223241493, -9.658425311247512, 8.385637633502483, 8.663932763040066, 8.854199161753058, 5.386982500553131, 5.982125919312239, 5.487709879875183, 15.127037604649857, 16.00087995578845, 15.393902649482087, 8.304810998340443, 6.948221911986664, 7.848990698655442, 8.20491375525792, 7.896145117779568, 7.709003259738282, 8.901855220397309, 8.846800496180848, 9.413299561788634, 8.530041148265198, 8.672946674128369, 8.71554160614808, 9.03495179116726, 9.061030387878418, 9.347524732351303, 7.864688004056603, 7.40366745988527, 7.926174479226262, 8.75100214779377, 8.584536954760551, 8.806595735251904, 10.201197996735573, 10.092944115400314, 10.869681727141142, 13.3932389418284, 12.443448389569909, 13.070466006795556, 0.18487957352772355, -0.867797389626503, -0.07469431683421135, -1.0711957700550556, -2.132381498813629, -1.9331836700439453, 6.437817541261509, 6.839073513944939, 5.956718092163399, 18.26429396122694, 17.570612385869026, 18.23768601939082, 8.88541654497385, 8.500515788793564, 9.15618297457695, 13.878522384911776, 12.884301245212555, 13.72783899307251, 10.118873829642922, 10.540686419854552, 9.462515900532395, 9.359084044893578, 9.193948109944657, 9.62790686016281, 11.997771754860878, 11.5697533339262, 12.056086611002684, 6.362145115931824, 6.500244048734501, 6.275335793693856, 7.670125318070248, 7.920219925542668, 7.693919715782002, 5.380618174870804, 5.048988362153366, 5.4611257587869915, 16.67550081262985, 16.9096973525981, 17.076396968836576, 15.418083295226097, 15.102929882705212, 15.180201977491379, 9.9178229967753, 10.188597715149314, 10.214766128609568, 7.908044554293156, 6.561638921499252, 7.32214680314064, 10.274848875900105, 10.519978155692414, 10.567441595097378, 12.47434500449647, 11.472296242912606, 11.975851369400814, 19.368657288451985, 19.033285235365227, 18.906113659342125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14840655672813316, "mean_inference_ms": 0.7000627286146779, "mean_action_processing_ms": 0.09624388499760793, "mean_env_wait_ms": 0.8102370543392476, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 260000, "timesteps_this_iter": 0, "agent_timesteps_total": 780000, "timers": {"sample_time_ms": 12031.822, "sample_throughput": 415.565, "load_time_ms": 0.292, "load_throughput": 17141997.711, "learn_time_ms": 1976.456, "learn_throughput": 2529.78, "update_time_ms": 9.445}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0005000000000000001, "total_loss": 8.322349643707275, "policy_loss": -0.0020433526101459876, "vf_loss": 8.396020126342773, "vf_explained_var": -1.0, "kl": 0.0038342956439068572, "entropy": 7.162722396850586, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 260000, "num_agent_steps_sampled": 780000, "num_steps_trained": 260000, "num_agent_steps_trained": 780000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1174, "training_iteration": 52, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-10-53", "timestamp": 1706231453, "time_this_iter_s": 10.926128387451172, "time_total_s": 570.2292904853821, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401AAA310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 570.2292904853821, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 8.32, "ram_util_percent": 59.21333333333334}}
{"episode_reward_max": 62.60111553966999, "episode_reward_min": -313.8834817260504, "episode_reward_mean": 16.793079704369873, "episode_len_mean": 491.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -112.40364761153857}, "policy_reward_max": {"shared_policy": 21.140563309192657}, "policy_reward_mean": {"shared_policy": 5.597693234789958}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.170993417501464, 31.360654041171045, 2.07967746257782, 21.841673709452152, 26.833672523498507, 22.750431889668107, 39.75187333300707, 13.400493353605242, 4.770579472184181, -40.17215264588596, 8.094721004366846, 19.437757894396753, 27.050454512238503, 31.30966271832584, 29.111490306444466, -34.23878009244801, 18.531126029789448, 12.822216160595403, 19.36981162801382, 10.310460623353706, 16.121967632323475, 22.75411789864299, 44.67667253315447, 20.0447882413864, 35.24197900295256, -37.38919695094229, 9.809089668327942, 7.729400202631936, 17.42047566920519, 33.06348413228986, 21.822656199336024, 33.47078569978474, 21.074124522507176, 28.557907599955797, 43.21461854502557, 27.978601504117222, 34.58218386769293, -28.3701955266297, 24.901339579373598, 34.22084225108844, 34.96700763702391, -313.8834817260504, 29.619991376996026, 28.757788027636707, 29.80494318902491, 46.09438382834196, -286.7081131786108, 11.58215529844162, 25.556827530264826, 18.64872382767497, -0.6029975563287877, 10.654488861560793, 33.47997570410371, 31.227564696222544, 15.411462932825074, 22.995946928858757, 13.274537317454786, 44.62368327751756, -21.692081272602096, 25.903769558295608, 16.856818299740553, 46.52182020992039, 23.10202360898255, 23.81006213277577, 27.16195527836679, 25.918529428541646, 27.44350691139698, 23.194529943168135, 26.142134837806225, 31.16382383927703, 38.907153338193865, -0.7576121329329908, -5.13676093891263, 19.233609147369847, 54.07259236648679, 26.542115308344364, 40.49066262319684, 30.12207615002987, 28.180939015001044, 35.62361169978976, 19.13772495836018, 23.284264959394918, 15.890732295811162, 50.66159513406453, 45.70121515542269, 30.321186840534182, 21.79183027893305, 31.362268626689897, 35.92249261680989, 57.30805618315934, 25.54170759022236, 27.88522817566991, 62.60111553966999, 36.70574809610844, 58.18703739345074, 29.46541965007782, 32.82917375862597, 32.62120768800378, 24.57848901441318, 13.030836377292857], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 100, 500, 500, 500, 500, 70, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-2.9544041926662175, -3.344393546382591, -2.8721956784526554, 10.697090896467358, 10.720193731288106, 9.943369413415581, 0.9458692967891693, 0.8200394213199615, 0.31376874446868896, 7.302714005112648, 7.444278798997402, 7.094680905342102, 8.672075296441704, 9.161744664112717, 8.999852562944085, 7.518822818994522, 8.185324126854539, 7.046284943819046, 13.259476261834294, 13.471032163749129, 13.021364907423646, 4.476051012674958, 4.136039222280175, 4.788403118650109, 2.2335944026708603, 1.1067372262477875, 1.4302478432655334, -11.813911291460201, -12.137001211444542, -16.221240142981216, 2.756734135250241, 2.638565393785626, 2.699421475330979, 6.790363824615866, 5.96679990986982, 6.680594159911067, 9.200490355491638, 8.882437735795975, 8.96752642095089, 10.430440199871853, 10.214198236664132, 10.665024281789854, 9.549904495477676, 10.092441064305604, 9.469144746661186, -10.936340487251684, -11.218941772977516, -12.08349783221881, 6.378893934190273, 6.497262015938759, 5.654970079660416, 4.359684576590851, 4.534553912778691, 3.927977671225861, 6.293421427408845, 6.883811785529048, 6.192578415075928, 3.2866618831952366, 3.7908884746332916, 3.2329102655251774, 5.570200766126305, 5.731211035201937, 4.820555830995232, 7.9000348026553695, 7.36959187189737, 7.484491224090249, 14.483779822786644, 15.143589605887726, 15.049303104480103, 7.00660404687126, 7.131920763601855, 5.906263430913285, 11.835458320875958, 11.699657854934529, 11.706862827142075, -12.729032049576446, -12.377127009133503, -12.283037892232343, 3.9982431458774954, 3.3939127177000046, 2.4169338047504425, 2.454910275836781, 2.3872657095392498, 2.8872242172559055, 5.986448675394058, 6.074517704546452, 5.359509289264679, 11.361564422647149, 11.060052315394074, 10.641867394248635, 7.623011852304131, 7.493581632773072, 6.70606271425882, 11.40745448817809, 11.22863246997197, 10.834698741634682, 6.862680633862809, 6.932104547818497, 7.279339340825871, 9.673317141830921, 10.12392209097743, 8.760668367147446, 14.522876547028616, 14.058884729941681, 14.632857268055275, 9.221045571068913, 9.55231352771321, 9.205242405335099, 11.344333608945206, 11.379238759477929, 11.858611499269799, -9.76432376603286, -9.548076326648399, -9.057795433948442, 8.553299307823181, 8.424996677786112, 7.923043593764305, 11.430724683838577, 11.330913330117852, 11.459204237132013, 11.940006067355469, 11.424427827199295, 11.602573742469147, -100.91218770543735, -112.40364761153857, -100.56764640907447, 9.314950322111443, 10.053283525009945, 10.251757529874638, 9.761795389465988, 9.617269963026047, 9.378722675144672, 9.896505830188588, 10.151159447928265, 9.757277910908059, 15.151026487350464, 15.18572548031807, 15.757631860673428, -103.88502577940623, -91.41837089012067, -91.40471650908391, 3.440194408098847, 3.954498673478753, 4.18746221686402, 8.687537054220826, 8.399617562691361, 8.469672913352639, 6.341222253938511, 5.69079740842183, 6.61670416531463, -0.26287099222342647, -0.2952435413996426, -0.044883022705718645, 3.449725727240235, 3.796015972892434, 3.408747161428124, 11.367261055856943, 11.046428941190243, 11.066285707056522, 10.380956523120403, 10.742229755967855, 10.104378417134285, 4.908229013284043, 5.270271872480706, 5.232962047060326, 7.437395825982094, 7.788037247955799, 7.770513854920864, 4.532642337183148, 4.4013892213503425, 4.340505758921296, 14.644759699702263, 14.805092617869377, 15.173830959945917, -5.88314973811309, -6.150506223241493, -9.658425311247512, 8.385637633502483, 8.663932763040066, 8.854199161753058, 5.386982500553131, 5.982125919312239, 5.487709879875183, 15.127037604649857, 16.00087995578845, 15.393902649482087, 8.304810998340443, 6.948221911986664, 7.848990698655442, 8.20491375525792, 7.896145117779568, 7.709003259738282, 8.901855220397309, 8.846800496180848, 9.413299561788634, 8.530041148265198, 8.672946674128369, 8.71554160614808, 9.03495179116726, 9.061030387878418, 9.347524732351303, 7.864688004056603, 7.40366745988527, 7.926174479226262, 8.75100214779377, 8.584536954760551, 8.806595735251904, 10.201197996735573, 10.092944115400314, 10.869681727141142, 13.3932389418284, 12.443448389569909, 13.070466006795556, 0.18487957352772355, -0.867797389626503, -0.07469431683421135, -1.0711957700550556, -2.132381498813629, -1.9331836700439453, 6.437817541261509, 6.839073513944939, 5.956718092163399, 18.26429396122694, 17.570612385869026, 18.23768601939082, 8.88541654497385, 8.500515788793564, 9.15618297457695, 13.878522384911776, 12.884301245212555, 13.72783899307251, 10.118873829642922, 10.540686419854552, 9.462515900532395, 9.359084044893578, 9.193948109944657, 9.62790686016281, 11.997771754860878, 11.5697533339262, 12.056086611002684, 6.362145115931824, 6.500244048734501, 6.275335793693856, 7.670125318070248, 7.920219925542668, 7.693919715782002, 5.380618174870804, 5.048988362153366, 5.4611257587869915, 16.67550081262985, 16.9096973525981, 17.076396968836576, 15.418083295226097, 15.102929882705212, 15.180201977491379, 9.9178229967753, 10.188597715149314, 10.214766128609568, 7.908044554293156, 6.561638921499252, 7.32214680314064, 10.274848875900105, 10.519978155692414, 10.567441595097378, 12.47434500449647, 11.472296242912606, 11.975851369400814, 19.368657288451985, 19.033285235365227, 18.906113659342125, 8.714441314339638, 8.407148525118828, 8.420117750763893, 9.451557330787182, 9.442023027688265, 8.991647817194462, 20.891365230083466, 21.140563309192657, 20.569187000393867, 11.948709920048714, 12.719054877758026, 12.037983298301697, 19.50749032944441, 19.16123651713133, 19.518310546875, 9.934854954481125, 9.5045854896307, 10.025979205965996, 11.292738017936543, 10.345631202061966, 11.19080453862746, 10.810893222689629, 11.275140259414911, 10.535174205899239, 7.826282831529767, 8.410316575473786, 8.341889607409627, 4.307148096462086, 4.625543834020689, 4.098144446810082]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14832229943188707, "mean_inference_ms": 0.7007940821031258, "mean_action_processing_ms": 0.09628938406903444, "mean_env_wait_ms": 0.8112231356110623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 265000, "timesteps_this_iter": 0, "agent_timesteps_total": 795000, "timers": {"sample_time_ms": 12059.179, "sample_throughput": 414.622, "load_time_ms": 0.392, "load_throughput": 12764163.116, "learn_time_ms": 1990.003, "learn_throughput": 2512.559, "update_time_ms": 9.445}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 0.0005000000000000001, "total_loss": 9.772346687316894, "policy_loss": -0.0021511755427725877, "vf_loss": 9.846718788146973, "vf_explained_var": -1.0, "kl": 0.0034741864830783093, "entropy": 7.222048234939575, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 265000, "num_agent_steps_sampled": 795000, "num_steps_trained": 265000, "num_agent_steps_trained": 795000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1184, "training_iteration": 53, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-11-03", "timestamp": 1706231463, "time_this_iter_s": 10.755805730819702, "time_total_s": 580.9850962162018, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402554790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 580.9850962162018, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 7.84, "ram_util_percent": 59.16666666666667}}
{"episode_reward_max": 90.93818938359618, "episode_reward_min": -313.8834817260504, "episode_reward_mean": 19.80475673501146, "episode_len_mean": 491.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -112.40364761153857}, "policy_reward_max": {"shared_policy": 30.41683292016387}, "policy_reward_mean": {"shared_policy": 6.6015855783371515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.094721004366846, 19.437757894396753, 27.050454512238503, 31.30966271832584, 29.111490306444466, -34.23878009244801, 18.531126029789448, 12.822216160595403, 19.36981162801382, 10.310460623353706, 16.121967632323475, 22.75411789864299, 44.67667253315447, 20.0447882413864, 35.24197900295256, -37.38919695094229, 9.809089668327942, 7.729400202631936, 17.42047566920519, 33.06348413228986, 21.822656199336024, 33.47078569978474, 21.074124522507176, 28.557907599955797, 43.21461854502557, 27.978601504117222, 34.58218386769293, -28.3701955266297, 24.901339579373598, 34.22084225108844, 34.96700763702391, -313.8834817260504, 29.619991376996026, 28.757788027636707, 29.80494318902491, 46.09438382834196, -286.7081131786108, 11.58215529844162, 25.556827530264826, 18.64872382767497, -0.6029975563287877, 10.654488861560793, 33.47997570410371, 31.227564696222544, 15.411462932825074, 22.995946928858757, 13.274537317454786, 44.62368327751756, -21.692081272602096, 25.903769558295608, 16.856818299740553, 46.52182020992039, 23.10202360898255, 23.81006213277577, 27.16195527836679, 25.918529428541646, 27.44350691139698, 23.194529943168135, 26.142134837806225, 31.16382383927703, 38.907153338193865, -0.7576121329329908, -5.13676093891263, 19.233609147369847, 54.07259236648679, 26.542115308344364, 40.49066262319684, 30.12207615002987, 28.180939015001044, 35.62361169978976, 19.13772495836018, 23.284264959394918, 15.890732295811162, 50.66159513406453, 45.70121515542269, 30.321186840534182, 21.79183027893305, 31.362268626689897, 35.92249261680989, 57.30805618315934, 25.54170759022236, 27.88522817566991, 62.60111553966999, 36.70574809610844, 58.18703739345074, 29.46541965007782, 32.82917375862597, 32.62120768800378, 24.57848901441318, 13.030836377292857, 48.28468845039603, 44.32420994481069, 27.218458950519548, 36.07304511219262, 28.54843500256537, 32.970869809389086, 32.5391169548966, 47.21409599110483, 26.50250318646431, 90.93818938359618], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 100, 500, 500, 500, 500, 70, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [2.756734135250241, 2.638565393785626, 2.699421475330979, 6.790363824615866, 5.96679990986982, 6.680594159911067, 9.200490355491638, 8.882437735795975, 8.96752642095089, 10.430440199871853, 10.214198236664132, 10.665024281789854, 9.549904495477676, 10.092441064305604, 9.469144746661186, -10.936340487251684, -11.218941772977516, -12.08349783221881, 6.378893934190273, 6.497262015938759, 5.654970079660416, 4.359684576590851, 4.534553912778691, 3.927977671225861, 6.293421427408845, 6.883811785529048, 6.192578415075928, 3.2866618831952366, 3.7908884746332916, 3.2329102655251774, 5.570200766126305, 5.731211035201937, 4.820555830995232, 7.9000348026553695, 7.36959187189737, 7.484491224090249, 14.483779822786644, 15.143589605887726, 15.049303104480103, 7.00660404687126, 7.131920763601855, 5.906263430913285, 11.835458320875958, 11.699657854934529, 11.706862827142075, -12.729032049576446, -12.377127009133503, -12.283037892232343, 3.9982431458774954, 3.3939127177000046, 2.4169338047504425, 2.454910275836781, 2.3872657095392498, 2.8872242172559055, 5.986448675394058, 6.074517704546452, 5.359509289264679, 11.361564422647149, 11.060052315394074, 10.641867394248635, 7.623011852304131, 7.493581632773072, 6.70606271425882, 11.40745448817809, 11.22863246997197, 10.834698741634682, 6.862680633862809, 6.932104547818497, 7.279339340825871, 9.673317141830921, 10.12392209097743, 8.760668367147446, 14.522876547028616, 14.058884729941681, 14.632857268055275, 9.221045571068913, 9.55231352771321, 9.205242405335099, 11.344333608945206, 11.379238759477929, 11.858611499269799, -9.76432376603286, -9.548076326648399, -9.057795433948442, 8.553299307823181, 8.424996677786112, 7.923043593764305, 11.430724683838577, 11.330913330117852, 11.459204237132013, 11.940006067355469, 11.424427827199295, 11.602573742469147, -100.91218770543735, -112.40364761153857, -100.56764640907447, 9.314950322111443, 10.053283525009945, 10.251757529874638, 9.761795389465988, 9.617269963026047, 9.378722675144672, 9.896505830188588, 10.151159447928265, 9.757277910908059, 15.151026487350464, 15.18572548031807, 15.757631860673428, -103.88502577940623, -91.41837089012067, -91.40471650908391, 3.440194408098847, 3.954498673478753, 4.18746221686402, 8.687537054220826, 8.399617562691361, 8.469672913352639, 6.341222253938511, 5.69079740842183, 6.61670416531463, -0.26287099222342647, -0.2952435413996426, -0.044883022705718645, 3.449725727240235, 3.796015972892434, 3.408747161428124, 11.367261055856943, 11.046428941190243, 11.066285707056522, 10.380956523120403, 10.742229755967855, 10.104378417134285, 4.908229013284043, 5.270271872480706, 5.232962047060326, 7.437395825982094, 7.788037247955799, 7.770513854920864, 4.532642337183148, 4.4013892213503425, 4.340505758921296, 14.644759699702263, 14.805092617869377, 15.173830959945917, -5.88314973811309, -6.150506223241493, -9.658425311247512, 8.385637633502483, 8.663932763040066, 8.854199161753058, 5.386982500553131, 5.982125919312239, 5.487709879875183, 15.127037604649857, 16.00087995578845, 15.393902649482087, 8.304810998340443, 6.948221911986664, 7.848990698655442, 8.20491375525792, 7.896145117779568, 7.709003259738282, 8.901855220397309, 8.846800496180848, 9.413299561788634, 8.530041148265198, 8.672946674128369, 8.71554160614808, 9.03495179116726, 9.061030387878418, 9.347524732351303, 7.864688004056603, 7.40366745988527, 7.926174479226262, 8.75100214779377, 8.584536954760551, 8.806595735251904, 10.201197996735573, 10.092944115400314, 10.869681727141142, 13.3932389418284, 12.443448389569909, 13.070466006795556, 0.18487957352772355, -0.867797389626503, -0.07469431683421135, -1.0711957700550556, -2.132381498813629, -1.9331836700439453, 6.437817541261509, 6.839073513944939, 5.956718092163399, 18.26429396122694, 17.570612385869026, 18.23768601939082, 8.88541654497385, 8.500515788793564, 9.15618297457695, 13.878522384911776, 12.884301245212555, 13.72783899307251, 10.118873829642922, 10.540686419854552, 9.462515900532395, 9.359084044893578, 9.193948109944657, 9.62790686016281, 11.997771754860878, 11.5697533339262, 12.056086611002684, 6.362145115931824, 6.500244048734501, 6.275335793693856, 7.670125318070248, 7.920219925542668, 7.693919715782002, 5.380618174870804, 5.048988362153366, 5.4611257587869915, 16.67550081262985, 16.9096973525981, 17.076396968836576, 15.418083295226097, 15.102929882705212, 15.180201977491379, 9.9178229967753, 10.188597715149314, 10.214766128609568, 7.908044554293156, 6.561638921499252, 7.32214680314064, 10.274848875900105, 10.519978155692414, 10.567441595097378, 12.47434500449647, 11.472296242912606, 11.975851369400814, 19.368657288451985, 19.033285235365227, 18.906113659342125, 8.714441314339638, 8.407148525118828, 8.420117750763893, 9.451557330787182, 9.442023027688265, 8.991647817194462, 20.891365230083466, 21.140563309192657, 20.569187000393867, 11.948709920048714, 12.719054877758026, 12.037983298301697, 19.50749032944441, 19.16123651713133, 19.518310546875, 9.934854954481125, 9.5045854896307, 10.025979205965996, 11.292738017936543, 10.345631202061966, 11.19080453862746, 10.810893222689629, 11.275140259414911, 10.535174205899239, 7.826282831529767, 8.410316575473786, 8.341889607409627, 4.307148096462086, 4.625543834020689, 4.098144446810082, 15.630795846382767, 16.336410420636327, 16.31748218337694, 14.285364429155976, 14.694641808668763, 15.344203706985951, 8.977296402057007, 9.324127634366349, 8.917034914096192, 12.476007496317223, 11.322732796271637, 12.274304819603756, 9.685986970861748, 9.642393176754311, 9.22005485494931, 11.180296058456094, 10.768683368961007, 11.021890381971986, 11.186523268464953, 10.956134717911482, 10.396458968520164, 14.40089165170987, 16.579602816452578, 16.23360152294238, 9.454960584640503, 8.88073942065239, 8.166803181171417, 30.315146632492542, 30.41683292016387, 30.20620983093977]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1482278420860171, "mean_inference_ms": 0.7013371804310006, "mean_action_processing_ms": 0.09634168906641244, "mean_env_wait_ms": 0.8120812749751909, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 270000, "timesteps_this_iter": 0, "agent_timesteps_total": 810000, "timers": {"sample_time_ms": 12089.194, "sample_throughput": 413.593, "load_time_ms": 0.292, "load_throughput": 17129396.39, "learn_time_ms": 2004.178, "learn_throughput": 2494.788, "update_time_ms": 9.344}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 0.0005000000000000001, "total_loss": 7.8715879917144775, "policy_loss": -0.0032410089294922172, "vf_loss": 7.947271633148193, "vf_explained_var": -1.0, "kl": 0.004610849825264297, "entropy": 7.244256210327149, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 270000, "num_agent_steps_sampled": 810000, "num_steps_trained": 270000, "num_agent_steps_trained": 810000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1194, "training_iteration": 54, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-11-14", "timestamp": 1706231474, "time_this_iter_s": 10.97019648551941, "time_total_s": 591.9552927017212, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402DF05E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 591.9552927017212, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 7.84375, "ram_util_percent": 59.1375}}
{"episode_reward_max": 90.93818938359618, "episode_reward_min": -313.8834817260504, "episode_reward_mean": 23.366945767358402, "episode_len_mean": 491.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -112.40364761153857}, "policy_reward_max": {"shared_policy": 30.41683292016387}, "policy_reward_mean": {"shared_policy": 7.788981922452799}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.121967632323475, 22.75411789864299, 44.67667253315447, 20.0447882413864, 35.24197900295256, -37.38919695094229, 9.809089668327942, 7.729400202631936, 17.42047566920519, 33.06348413228986, 21.822656199336024, 33.47078569978474, 21.074124522507176, 28.557907599955797, 43.21461854502557, 27.978601504117222, 34.58218386769293, -28.3701955266297, 24.901339579373598, 34.22084225108844, 34.96700763702391, -313.8834817260504, 29.619991376996026, 28.757788027636707, 29.80494318902491, 46.09438382834196, -286.7081131786108, 11.58215529844162, 25.556827530264826, 18.64872382767497, -0.6029975563287877, 10.654488861560793, 33.47997570410371, 31.227564696222544, 15.411462932825074, 22.995946928858757, 13.274537317454786, 44.62368327751756, -21.692081272602096, 25.903769558295608, 16.856818299740553, 46.52182020992039, 23.10202360898255, 23.81006213277577, 27.16195527836679, 25.918529428541646, 27.44350691139698, 23.194529943168135, 26.142134837806225, 31.16382383927703, 38.907153338193865, -0.7576121329329908, -5.13676093891263, 19.233609147369847, 54.07259236648679, 26.542115308344364, 40.49066262319684, 30.12207615002987, 28.180939015001044, 35.62361169978976, 19.13772495836018, 23.284264959394918, 15.890732295811162, 50.66159513406453, 45.70121515542269, 30.321186840534182, 21.79183027893305, 31.362268626689897, 35.92249261680989, 57.30805618315934, 25.54170759022236, 27.88522817566991, 62.60111553966999, 36.70574809610844, 58.18703739345074, 29.46541965007782, 32.82917375862597, 32.62120768800378, 24.57848901441318, 13.030836377292857, 48.28468845039603, 44.32420994481069, 27.218458950519548, 36.07304511219262, 28.54843500256537, 32.970869809389086, 32.5391169548966, 47.21409599110483, 26.50250318646431, 90.93818938359618, 60.34719015657902, 48.508982382714734, 42.668158089742064, 52.448363803327055, 70.99437446147203, 54.73636619001627, 31.53168243728578, 45.406591367907794, 64.36176821589467, 27.014346914831535], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 100, 500, 500, 500, 500, 70, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [5.570200766126305, 5.731211035201937, 4.820555830995232, 7.9000348026553695, 7.36959187189737, 7.484491224090249, 14.483779822786644, 15.143589605887726, 15.049303104480103, 7.00660404687126, 7.131920763601855, 5.906263430913285, 11.835458320875958, 11.699657854934529, 11.706862827142075, -12.729032049576446, -12.377127009133503, -12.283037892232343, 3.9982431458774954, 3.3939127177000046, 2.4169338047504425, 2.454910275836781, 2.3872657095392498, 2.8872242172559055, 5.986448675394058, 6.074517704546452, 5.359509289264679, 11.361564422647149, 11.060052315394074, 10.641867394248635, 7.623011852304131, 7.493581632773072, 6.70606271425882, 11.40745448817809, 11.22863246997197, 10.834698741634682, 6.862680633862809, 6.932104547818497, 7.279339340825871, 9.673317141830921, 10.12392209097743, 8.760668367147446, 14.522876547028616, 14.058884729941681, 14.632857268055275, 9.221045571068913, 9.55231352771321, 9.205242405335099, 11.344333608945206, 11.379238759477929, 11.858611499269799, -9.76432376603286, -9.548076326648399, -9.057795433948442, 8.553299307823181, 8.424996677786112, 7.923043593764305, 11.430724683838577, 11.330913330117852, 11.459204237132013, 11.940006067355469, 11.424427827199295, 11.602573742469147, -100.91218770543735, -112.40364761153857, -100.56764640907447, 9.314950322111443, 10.053283525009945, 10.251757529874638, 9.761795389465988, 9.617269963026047, 9.378722675144672, 9.896505830188588, 10.151159447928265, 9.757277910908059, 15.151026487350464, 15.18572548031807, 15.757631860673428, -103.88502577940623, -91.41837089012067, -91.40471650908391, 3.440194408098847, 3.954498673478753, 4.18746221686402, 8.687537054220826, 8.399617562691361, 8.469672913352639, 6.341222253938511, 5.69079740842183, 6.61670416531463, -0.26287099222342647, -0.2952435413996426, -0.044883022705718645, 3.449725727240235, 3.796015972892434, 3.408747161428124, 11.367261055856943, 11.046428941190243, 11.066285707056522, 10.380956523120403, 10.742229755967855, 10.104378417134285, 4.908229013284043, 5.270271872480706, 5.232962047060326, 7.437395825982094, 7.788037247955799, 7.770513854920864, 4.532642337183148, 4.4013892213503425, 4.340505758921296, 14.644759699702263, 14.805092617869377, 15.173830959945917, -5.88314973811309, -6.150506223241493, -9.658425311247512, 8.385637633502483, 8.663932763040066, 8.854199161753058, 5.386982500553131, 5.982125919312239, 5.487709879875183, 15.127037604649857, 16.00087995578845, 15.393902649482087, 8.304810998340443, 6.948221911986664, 7.848990698655442, 8.20491375525792, 7.896145117779568, 7.709003259738282, 8.901855220397309, 8.846800496180848, 9.413299561788634, 8.530041148265198, 8.672946674128369, 8.71554160614808, 9.03495179116726, 9.061030387878418, 9.347524732351303, 7.864688004056603, 7.40366745988527, 7.926174479226262, 8.75100214779377, 8.584536954760551, 8.806595735251904, 10.201197996735573, 10.092944115400314, 10.869681727141142, 13.3932389418284, 12.443448389569909, 13.070466006795556, 0.18487957352772355, -0.867797389626503, -0.07469431683421135, -1.0711957700550556, -2.132381498813629, -1.9331836700439453, 6.437817541261509, 6.839073513944939, 5.956718092163399, 18.26429396122694, 17.570612385869026, 18.23768601939082, 8.88541654497385, 8.500515788793564, 9.15618297457695, 13.878522384911776, 12.884301245212555, 13.72783899307251, 10.118873829642922, 10.540686419854552, 9.462515900532395, 9.359084044893578, 9.193948109944657, 9.62790686016281, 11.997771754860878, 11.5697533339262, 12.056086611002684, 6.362145115931824, 6.500244048734501, 6.275335793693856, 7.670125318070248, 7.920219925542668, 7.693919715782002, 5.380618174870804, 5.048988362153366, 5.4611257587869915, 16.67550081262985, 16.9096973525981, 17.076396968836576, 15.418083295226097, 15.102929882705212, 15.180201977491379, 9.9178229967753, 10.188597715149314, 10.214766128609568, 7.908044554293156, 6.561638921499252, 7.32214680314064, 10.274848875900105, 10.519978155692414, 10.567441595097378, 12.47434500449647, 11.472296242912606, 11.975851369400814, 19.368657288451985, 19.033285235365227, 18.906113659342125, 8.714441314339638, 8.407148525118828, 8.420117750763893, 9.451557330787182, 9.442023027688265, 8.991647817194462, 20.891365230083466, 21.140563309192657, 20.569187000393867, 11.948709920048714, 12.719054877758026, 12.037983298301697, 19.50749032944441, 19.16123651713133, 19.518310546875, 9.934854954481125, 9.5045854896307, 10.025979205965996, 11.292738017936543, 10.345631202061966, 11.19080453862746, 10.810893222689629, 11.275140259414911, 10.535174205899239, 7.826282831529767, 8.410316575473786, 8.341889607409627, 4.307148096462086, 4.625543834020689, 4.098144446810082, 15.630795846382767, 16.336410420636327, 16.31748218337694, 14.285364429155976, 14.694641808668763, 15.344203706985951, 8.977296402057007, 9.324127634366349, 8.917034914096192, 12.476007496317223, 11.322732796271637, 12.274304819603756, 9.685986970861748, 9.642393176754311, 9.22005485494931, 11.180296058456094, 10.768683368961007, 11.021890381971986, 11.186523268464953, 10.956134717911482, 10.396458968520164, 14.40089165170987, 16.579602816452578, 16.23360152294238, 9.454960584640503, 8.88073942065239, 8.166803181171417, 30.315146632492542, 30.41683292016387, 30.20620983093977, 20.22721605747938, 20.018744081258774, 20.101230017840862, 16.40816668172677, 15.927324538429573, 16.173491162558392, 14.34921507537365, 14.554621836170554, 13.76432117819786, 17.86846989641586, 16.59766001502672, 17.982233891884476, 23.45343527942896, 23.750718530267477, 23.7902206517756, 18.28182002902031, 17.968430280685425, 18.486115880310535, 10.701842222362757, 9.982237339019775, 10.847602875903249, 15.073935622970254, 14.92502589772144, 15.4076298472161, 21.423478635648877, 21.526893849174172, 21.41139573107162, 9.074435298641518, 8.367480923732117, 9.5724306924579]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14814982439988134, "mean_inference_ms": 0.7019072932499241, "mean_action_processing_ms": 0.09641252623040841, "mean_env_wait_ms": 0.8128739605259185, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 275000, "timesteps_this_iter": 0, "agent_timesteps_total": 825000, "timers": {"sample_time_ms": 12109.827, "sample_throughput": 412.888, "load_time_ms": 0.292, "load_throughput": 17129396.39, "learn_time_ms": 2005.214, "learn_throughput": 2493.499, "update_time_ms": 9.368}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 0.0005000000000000001, "total_loss": 9.298506450653075, "policy_loss": -0.00277324100402494, "vf_loss": 9.373936367034911, "vf_explained_var": -1.0, "kl": 0.004799734818522852, "entropy": 7.265667390823364, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 275000, "num_agent_steps_sampled": 825000, "num_steps_trained": 275000, "num_agent_steps_trained": 825000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1204, "training_iteration": 55, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-11-25", "timestamp": 1706231485, "time_this_iter_s": 10.996074438095093, "time_total_s": 602.9513671398163, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402DF0430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 602.9513671398163, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 7.74, "ram_util_percent": 59.2}}
{"episode_reward_max": 90.93818938359618, "episode_reward_min": -313.8834817260504, "episode_reward_mean": 23.324527164775635, "episode_len_mean": 487.33, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -112.40364761153857}, "policy_reward_max": {"shared_policy": 30.41683292016387}, "policy_reward_mean": {"shared_policy": 7.774842388258546}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.822656199336024, 33.47078569978474, 21.074124522507176, 28.557907599955797, 43.21461854502557, 27.978601504117222, 34.58218386769293, -28.3701955266297, 24.901339579373598, 34.22084225108844, 34.96700763702391, -313.8834817260504, 29.619991376996026, 28.757788027636707, 29.80494318902491, 46.09438382834196, -286.7081131786108, 11.58215529844162, 25.556827530264826, 18.64872382767497, -0.6029975563287877, 10.654488861560793, 33.47997570410371, 31.227564696222544, 15.411462932825074, 22.995946928858757, 13.274537317454786, 44.62368327751756, -21.692081272602096, 25.903769558295608, 16.856818299740553, 46.52182020992039, 23.10202360898255, 23.81006213277577, 27.16195527836679, 25.918529428541646, 27.44350691139698, 23.194529943168135, 26.142134837806225, 31.16382383927703, 38.907153338193865, -0.7576121329329908, -5.13676093891263, 19.233609147369847, 54.07259236648679, 26.542115308344364, 40.49066262319684, 30.12207615002987, 28.180939015001044, 35.62361169978976, 19.13772495836018, 23.284264959394918, 15.890732295811162, 50.66159513406453, 45.70121515542269, 30.321186840534182, 21.79183027893305, 31.362268626689897, 35.92249261680989, 57.30805618315934, 25.54170759022236, 27.88522817566991, 62.60111553966999, 36.70574809610844, 58.18703739345074, 29.46541965007782, 32.82917375862597, 32.62120768800378, 24.57848901441318, 13.030836377292857, 48.28468845039603, 44.32420994481069, 27.218458950519548, 36.07304511219262, 28.54843500256537, 32.970869809389086, 32.5391169548966, 47.21409599110483, 26.50250318646431, 90.93818938359618, 60.34719015657902, 48.508982382714734, 42.668158089742064, 52.448363803327055, 70.99437446147203, 54.73636619001627, 31.53168243728578, 45.406591367907794, 64.36176821589467, 27.014346914831535, 43.937718632398145, 53.14657471794632, -304.93026185035706, 56.13054616935548, 80.1141823964426, 60.8945565689355, 31.354853783734143, 67.49265340529381, 52.72145024687049, 24.368643701076493], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 100, 500, 500, 500, 500, 70, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [7.623011852304131, 7.493581632773072, 6.70606271425882, 11.40745448817809, 11.22863246997197, 10.834698741634682, 6.862680633862809, 6.932104547818497, 7.279339340825871, 9.673317141830921, 10.12392209097743, 8.760668367147446, 14.522876547028616, 14.058884729941681, 14.632857268055275, 9.221045571068913, 9.55231352771321, 9.205242405335099, 11.344333608945206, 11.379238759477929, 11.858611499269799, -9.76432376603286, -9.548076326648399, -9.057795433948442, 8.553299307823181, 8.424996677786112, 7.923043593764305, 11.430724683838577, 11.330913330117852, 11.459204237132013, 11.940006067355469, 11.424427827199295, 11.602573742469147, -100.91218770543735, -112.40364761153857, -100.56764640907447, 9.314950322111443, 10.053283525009945, 10.251757529874638, 9.761795389465988, 9.617269963026047, 9.378722675144672, 9.896505830188588, 10.151159447928265, 9.757277910908059, 15.151026487350464, 15.18572548031807, 15.757631860673428, -103.88502577940623, -91.41837089012067, -91.40471650908391, 3.440194408098847, 3.954498673478753, 4.18746221686402, 8.687537054220826, 8.399617562691361, 8.469672913352639, 6.341222253938511, 5.69079740842183, 6.61670416531463, -0.26287099222342647, -0.2952435413996426, -0.044883022705718645, 3.449725727240235, 3.796015972892434, 3.408747161428124, 11.367261055856943, 11.046428941190243, 11.066285707056522, 10.380956523120403, 10.742229755967855, 10.104378417134285, 4.908229013284043, 5.270271872480706, 5.232962047060326, 7.437395825982094, 7.788037247955799, 7.770513854920864, 4.532642337183148, 4.4013892213503425, 4.340505758921296, 14.644759699702263, 14.805092617869377, 15.173830959945917, -5.88314973811309, -6.150506223241493, -9.658425311247512, 8.385637633502483, 8.663932763040066, 8.854199161753058, 5.386982500553131, 5.982125919312239, 5.487709879875183, 15.127037604649857, 16.00087995578845, 15.393902649482087, 8.304810998340443, 6.948221911986664, 7.848990698655442, 8.20491375525792, 7.896145117779568, 7.709003259738282, 8.901855220397309, 8.846800496180848, 9.413299561788634, 8.530041148265198, 8.672946674128369, 8.71554160614808, 9.03495179116726, 9.061030387878418, 9.347524732351303, 7.864688004056603, 7.40366745988527, 7.926174479226262, 8.75100214779377, 8.584536954760551, 8.806595735251904, 10.201197996735573, 10.092944115400314, 10.869681727141142, 13.3932389418284, 12.443448389569909, 13.070466006795556, 0.18487957352772355, -0.867797389626503, -0.07469431683421135, -1.0711957700550556, -2.132381498813629, -1.9331836700439453, 6.437817541261509, 6.839073513944939, 5.956718092163399, 18.26429396122694, 17.570612385869026, 18.23768601939082, 8.88541654497385, 8.500515788793564, 9.15618297457695, 13.878522384911776, 12.884301245212555, 13.72783899307251, 10.118873829642922, 10.540686419854552, 9.462515900532395, 9.359084044893578, 9.193948109944657, 9.62790686016281, 11.997771754860878, 11.5697533339262, 12.056086611002684, 6.362145115931824, 6.500244048734501, 6.275335793693856, 7.670125318070248, 7.920219925542668, 7.693919715782002, 5.380618174870804, 5.048988362153366, 5.4611257587869915, 16.67550081262985, 16.9096973525981, 17.076396968836576, 15.418083295226097, 15.102929882705212, 15.180201977491379, 9.9178229967753, 10.188597715149314, 10.214766128609568, 7.908044554293156, 6.561638921499252, 7.32214680314064, 10.274848875900105, 10.519978155692414, 10.567441595097378, 12.47434500449647, 11.472296242912606, 11.975851369400814, 19.368657288451985, 19.033285235365227, 18.906113659342125, 8.714441314339638, 8.407148525118828, 8.420117750763893, 9.451557330787182, 9.442023027688265, 8.991647817194462, 20.891365230083466, 21.140563309192657, 20.569187000393867, 11.948709920048714, 12.719054877758026, 12.037983298301697, 19.50749032944441, 19.16123651713133, 19.518310546875, 9.934854954481125, 9.5045854896307, 10.025979205965996, 11.292738017936543, 10.345631202061966, 11.19080453862746, 10.810893222689629, 11.275140259414911, 10.535174205899239, 7.826282831529767, 8.410316575473786, 8.341889607409627, 4.307148096462086, 4.625543834020689, 4.098144446810082, 15.630795846382767, 16.336410420636327, 16.31748218337694, 14.285364429155976, 14.694641808668763, 15.344203706985951, 8.977296402057007, 9.324127634366349, 8.917034914096192, 12.476007496317223, 11.322732796271637, 12.274304819603756, 9.685986970861748, 9.642393176754311, 9.22005485494931, 11.180296058456094, 10.768683368961007, 11.021890381971986, 11.186523268464953, 10.956134717911482, 10.396458968520164, 14.40089165170987, 16.579602816452578, 16.23360152294238, 9.454960584640503, 8.88073942065239, 8.166803181171417, 30.315146632492542, 30.41683292016387, 30.20620983093977, 20.22721605747938, 20.018744081258774, 20.101230017840862, 16.40816668172677, 15.927324538429573, 16.173491162558392, 14.34921507537365, 14.554621836170554, 13.76432117819786, 17.86846989641586, 16.59766001502672, 17.982233891884476, 23.45343527942896, 23.750718530267477, 23.7902206517756, 18.28182002902031, 17.968430280685425, 18.486115880310535, 10.701842222362757, 9.982237339019775, 10.847602875903249, 15.073935622970254, 14.92502589772144, 15.4076298472161, 21.423478635648877, 21.526893849174172, 21.41139573107162, 9.074435298641518, 8.367480923732117, 9.5724306924579, 14.523493538300187, 14.100856150190026, 15.313368943907932, 17.472275132934243, 17.770170570040733, 17.904129014971346, -97.53991660724084, -97.744567292432, -109.64577795068423, 18.82084637756148, 18.385996873180062, 18.92370291861394, 26.88660358513394, 26.175066749254853, 27.052512062053808, 20.38558863786359, 20.284619515140847, 20.22434841593106, 9.862585827708244, 10.714190104976296, 10.778077851049602, 22.34363081057866, 22.751734341805175, 22.397288252909973, 17.895707647005707, 17.06040048102537, 17.765342118839413, 8.455218863983944, 7.491046418746308, 8.422378418346241]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1480503152061166, "mean_inference_ms": 0.7023970535956725, "mean_action_processing_ms": 0.09646683117544028, "mean_env_wait_ms": 0.8135924134220293, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 280000, "timesteps_this_iter": 0, "agent_timesteps_total": 840000, "timers": {"sample_time_ms": 12069.056, "sample_throughput": 414.283, "load_time_ms": 0.2, "load_throughput": 24992873.317, "learn_time_ms": 1995.91, "learn_throughput": 2505.123, "update_time_ms": 9.621}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0005000000000000001, "total_loss": 68.99588088989258, "policy_loss": -0.001704353977952433, "vf_loss": 69.07103958129883, "vf_explained_var": -0.025583457946777344, "kl": 0.007479532793520519, "entropy": 7.345296001434326, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 280000, "num_agent_steps_sampled": 840000, "num_steps_trained": 280000, "num_agent_steps_trained": 840000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1214, "training_iteration": 56, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-11-36", "timestamp": 1706231496, "time_this_iter_s": 10.321819543838501, "time_total_s": 613.2731866836548, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214018EEF70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 613.2731866836548, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 7.5, "ram_util_percent": 59.226666666666674}}
{"episode_reward_max": 90.93818938359618, "episode_reward_min": -313.8834817260504, "episode_reward_mean": 25.843300514287538, "episode_len_mean": 487.33, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -112.40364761153857}, "policy_reward_max": {"shared_policy": 30.41683292016387}, "policy_reward_mean": {"shared_policy": 8.614433504762511}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.96700763702391, -313.8834817260504, 29.619991376996026, 28.757788027636707, 29.80494318902491, 46.09438382834196, -286.7081131786108, 11.58215529844162, 25.556827530264826, 18.64872382767497, -0.6029975563287877, 10.654488861560793, 33.47997570410371, 31.227564696222544, 15.411462932825074, 22.995946928858757, 13.274537317454786, 44.62368327751756, -21.692081272602096, 25.903769558295608, 16.856818299740553, 46.52182020992039, 23.10202360898255, 23.81006213277577, 27.16195527836679, 25.918529428541646, 27.44350691139698, 23.194529943168135, 26.142134837806225, 31.16382383927703, 38.907153338193865, -0.7576121329329908, -5.13676093891263, 19.233609147369847, 54.07259236648679, 26.542115308344364, 40.49066262319684, 30.12207615002987, 28.180939015001044, 35.62361169978976, 19.13772495836018, 23.284264959394918, 15.890732295811162, 50.66159513406453, 45.70121515542269, 30.321186840534182, 21.79183027893305, 31.362268626689897, 35.92249261680989, 57.30805618315934, 25.54170759022236, 27.88522817566991, 62.60111553966999, 36.70574809610844, 58.18703739345074, 29.46541965007782, 32.82917375862597, 32.62120768800378, 24.57848901441318, 13.030836377292857, 48.28468845039603, 44.32420994481069, 27.218458950519548, 36.07304511219262, 28.54843500256537, 32.970869809389086, 32.5391169548966, 47.21409599110483, 26.50250318646431, 90.93818938359618, 60.34719015657902, 48.508982382714734, 42.668158089742064, 52.448363803327055, 70.99437446147203, 54.73636619001627, 31.53168243728578, 45.406591367907794, 64.36176821589467, 27.014346914831535, 43.937718632398145, 53.14657471794632, -304.93026185035706, 56.13054616935548, 80.1141823964426, 60.8945565689355, 31.354853783734143, 67.49265340529381, 52.72145024687049, 24.368643701076493, 52.0478059053421, 46.24744105711579, 51.951661214465275, 35.263675421476336, 66.05168801546095, 70.0546344220638, 45.60610181838271, 32.54667981341481, 51.14765107259154, 42.412860453128786], "episode_lengths": [500, 100, 500, 500, 500, 500, 70, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [11.940006067355469, 11.424427827199295, 11.602573742469147, -100.91218770543735, -112.40364761153857, -100.56764640907447, 9.314950322111443, 10.053283525009945, 10.251757529874638, 9.761795389465988, 9.617269963026047, 9.378722675144672, 9.896505830188588, 10.151159447928265, 9.757277910908059, 15.151026487350464, 15.18572548031807, 15.757631860673428, -103.88502577940623, -91.41837089012067, -91.40471650908391, 3.440194408098847, 3.954498673478753, 4.18746221686402, 8.687537054220826, 8.399617562691361, 8.469672913352639, 6.341222253938511, 5.69079740842183, 6.61670416531463, -0.26287099222342647, -0.2952435413996426, -0.044883022705718645, 3.449725727240235, 3.796015972892434, 3.408747161428124, 11.367261055856943, 11.046428941190243, 11.066285707056522, 10.380956523120403, 10.742229755967855, 10.104378417134285, 4.908229013284043, 5.270271872480706, 5.232962047060326, 7.437395825982094, 7.788037247955799, 7.770513854920864, 4.532642337183148, 4.4013892213503425, 4.340505758921296, 14.644759699702263, 14.805092617869377, 15.173830959945917, -5.88314973811309, -6.150506223241493, -9.658425311247512, 8.385637633502483, 8.663932763040066, 8.854199161753058, 5.386982500553131, 5.982125919312239, 5.487709879875183, 15.127037604649857, 16.00087995578845, 15.393902649482087, 8.304810998340443, 6.948221911986664, 7.848990698655442, 8.20491375525792, 7.896145117779568, 7.709003259738282, 8.901855220397309, 8.846800496180848, 9.413299561788634, 8.530041148265198, 8.672946674128369, 8.71554160614808, 9.03495179116726, 9.061030387878418, 9.347524732351303, 7.864688004056603, 7.40366745988527, 7.926174479226262, 8.75100214779377, 8.584536954760551, 8.806595735251904, 10.201197996735573, 10.092944115400314, 10.869681727141142, 13.3932389418284, 12.443448389569909, 13.070466006795556, 0.18487957352772355, -0.867797389626503, -0.07469431683421135, -1.0711957700550556, -2.132381498813629, -1.9331836700439453, 6.437817541261509, 6.839073513944939, 5.956718092163399, 18.26429396122694, 17.570612385869026, 18.23768601939082, 8.88541654497385, 8.500515788793564, 9.15618297457695, 13.878522384911776, 12.884301245212555, 13.72783899307251, 10.118873829642922, 10.540686419854552, 9.462515900532395, 9.359084044893578, 9.193948109944657, 9.62790686016281, 11.997771754860878, 11.5697533339262, 12.056086611002684, 6.362145115931824, 6.500244048734501, 6.275335793693856, 7.670125318070248, 7.920219925542668, 7.693919715782002, 5.380618174870804, 5.048988362153366, 5.4611257587869915, 16.67550081262985, 16.9096973525981, 17.076396968836576, 15.418083295226097, 15.102929882705212, 15.180201977491379, 9.9178229967753, 10.188597715149314, 10.214766128609568, 7.908044554293156, 6.561638921499252, 7.32214680314064, 10.274848875900105, 10.519978155692414, 10.567441595097378, 12.47434500449647, 11.472296242912606, 11.975851369400814, 19.368657288451985, 19.033285235365227, 18.906113659342125, 8.714441314339638, 8.407148525118828, 8.420117750763893, 9.451557330787182, 9.442023027688265, 8.991647817194462, 20.891365230083466, 21.140563309192657, 20.569187000393867, 11.948709920048714, 12.719054877758026, 12.037983298301697, 19.50749032944441, 19.16123651713133, 19.518310546875, 9.934854954481125, 9.5045854896307, 10.025979205965996, 11.292738017936543, 10.345631202061966, 11.19080453862746, 10.810893222689629, 11.275140259414911, 10.535174205899239, 7.826282831529767, 8.410316575473786, 8.341889607409627, 4.307148096462086, 4.625543834020689, 4.098144446810082, 15.630795846382767, 16.336410420636327, 16.31748218337694, 14.285364429155976, 14.694641808668763, 15.344203706985951, 8.977296402057007, 9.324127634366349, 8.917034914096192, 12.476007496317223, 11.322732796271637, 12.274304819603756, 9.685986970861748, 9.642393176754311, 9.22005485494931, 11.180296058456094, 10.768683368961007, 11.021890381971986, 11.186523268464953, 10.956134717911482, 10.396458968520164, 14.40089165170987, 16.579602816452578, 16.23360152294238, 9.454960584640503, 8.88073942065239, 8.166803181171417, 30.315146632492542, 30.41683292016387, 30.20620983093977, 20.22721605747938, 20.018744081258774, 20.101230017840862, 16.40816668172677, 15.927324538429573, 16.173491162558392, 14.34921507537365, 14.554621836170554, 13.76432117819786, 17.86846989641586, 16.59766001502672, 17.982233891884476, 23.45343527942896, 23.750718530267477, 23.7902206517756, 18.28182002902031, 17.968430280685425, 18.486115880310535, 10.701842222362757, 9.982237339019775, 10.847602875903249, 15.073935622970254, 14.92502589772144, 15.4076298472161, 21.423478635648877, 21.526893849174172, 21.41139573107162, 9.074435298641518, 8.367480923732117, 9.5724306924579, 14.523493538300187, 14.100856150190026, 15.313368943907932, 17.472275132934243, 17.770170570040733, 17.904129014971346, -97.53991660724084, -97.744567292432, -109.64577795068423, 18.82084637756148, 18.385996873180062, 18.92370291861394, 26.88660358513394, 26.175066749254853, 27.052512062053808, 20.38558863786359, 20.284619515140847, 20.22434841593106, 9.862585827708244, 10.714190104976296, 10.778077851049602, 22.34363081057866, 22.751734341805175, 22.397288252909973, 17.895707647005707, 17.06040048102537, 17.765342118839413, 8.455218863983944, 7.491046418746308, 8.422378418346241, 17.168172761797905, 17.604708090424538, 17.27492505311966, 15.323962263762951, 15.635963577777147, 15.287515215575695, 17.03417445719242, 17.17834997177124, 17.739136785501614, 11.829141343633324, 11.566489751140267, 11.868044326702744, 22.00847043593724, 21.83861470719178, 22.204602872331932, 23.58599408964315, 22.95182480911413, 23.51681552330652, 15.139091620842606, 15.083838785688073, 15.383171411852032, 10.643474996089935, 11.364389691501856, 10.538815125823021, 17.58011645823717, 17.550566244870424, 16.016968369483948, 14.444466712574155, 13.916897098223359, 14.051496642331273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14791368205720437, "mean_inference_ms": 0.7026361428725656, "mean_action_processing_ms": 0.09648418784189515, "mean_env_wait_ms": 0.8140875779743432, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 285000, "timesteps_this_iter": 0, "agent_timesteps_total": 855000, "timers": {"sample_time_ms": 11927.515, "sample_throughput": 419.199, "load_time_ms": 0.2, "load_throughput": 24992873.317, "learn_time_ms": 1986.348, "learn_throughput": 2517.183, "update_time_ms": 9.496}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0005000000000000001, "total_loss": 6.604916381835937, "policy_loss": -0.002329942394328155, "vf_loss": 6.682180500030517, "vf_explained_var": -1.0, "kl": 0.004079139966059912, "entropy": 7.493403100967408, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 285000, "num_agent_steps_sampled": 855000, "num_steps_trained": 285000, "num_agent_steps_trained": 855000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1224, "training_iteration": 57, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-11-46", "timestamp": 1706231506, "time_this_iter_s": 10.485074043273926, "time_total_s": 623.7582607269287, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214008448B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 623.7582607269287, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 5.8533333333333335, "ram_util_percent": 59.213333333333345}}
{"episode_reward_max": 90.93818938359618, "episode_reward_min": -304.93026185035706, "episode_reward_mean": 34.333757293961234, "episode_len_mean": 495.63, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -109.64577795068423}, "policy_reward_max": {"shared_policy": 30.41683292016387}, "policy_reward_mean": {"shared_policy": 11.444585764653743}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6029975563287877, 10.654488861560793, 33.47997570410371, 31.227564696222544, 15.411462932825074, 22.995946928858757, 13.274537317454786, 44.62368327751756, -21.692081272602096, 25.903769558295608, 16.856818299740553, 46.52182020992039, 23.10202360898255, 23.81006213277577, 27.16195527836679, 25.918529428541646, 27.44350691139698, 23.194529943168135, 26.142134837806225, 31.16382383927703, 38.907153338193865, -0.7576121329329908, -5.13676093891263, 19.233609147369847, 54.07259236648679, 26.542115308344364, 40.49066262319684, 30.12207615002987, 28.180939015001044, 35.62361169978976, 19.13772495836018, 23.284264959394918, 15.890732295811162, 50.66159513406453, 45.70121515542269, 30.321186840534182, 21.79183027893305, 31.362268626689897, 35.92249261680989, 57.30805618315934, 25.54170759022236, 27.88522817566991, 62.60111553966999, 36.70574809610844, 58.18703739345074, 29.46541965007782, 32.82917375862597, 32.62120768800378, 24.57848901441318, 13.030836377292857, 48.28468845039603, 44.32420994481069, 27.218458950519548, 36.07304511219262, 28.54843500256537, 32.970869809389086, 32.5391169548966, 47.21409599110483, 26.50250318646431, 90.93818938359618, 60.34719015657902, 48.508982382714734, 42.668158089742064, 52.448363803327055, 70.99437446147203, 54.73636619001627, 31.53168243728578, 45.406591367907794, 64.36176821589467, 27.014346914831535, 43.937718632398145, 53.14657471794632, -304.93026185035706, 56.13054616935548, 80.1141823964426, 60.8945565689355, 31.354853783734143, 67.49265340529381, 52.72145024687049, 24.368643701076493, 52.0478059053421, 46.24744105711579, 51.951661214465275, 35.263675421476336, 66.05168801546095, 70.0546344220638, 45.60610181838271, 32.54667981341481, 51.14765107259154, 42.412860453128786, 46.08869217336178, 57.00817253999412, 39.45073692500591, 32.258935685269506, 56.667673713061944, 44.45982350409028, 31.207437917590127, 32.78165329247713, 50.398168047424406, 83.16460997983812], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-0.26287099222342647, -0.2952435413996426, -0.044883022705718645, 3.449725727240235, 3.796015972892434, 3.408747161428124, 11.367261055856943, 11.046428941190243, 11.066285707056522, 10.380956523120403, 10.742229755967855, 10.104378417134285, 4.908229013284043, 5.270271872480706, 5.232962047060326, 7.437395825982094, 7.788037247955799, 7.770513854920864, 4.532642337183148, 4.4013892213503425, 4.340505758921296, 14.644759699702263, 14.805092617869377, 15.173830959945917, -5.88314973811309, -6.150506223241493, -9.658425311247512, 8.385637633502483, 8.663932763040066, 8.854199161753058, 5.386982500553131, 5.982125919312239, 5.487709879875183, 15.127037604649857, 16.00087995578845, 15.393902649482087, 8.304810998340443, 6.948221911986664, 7.848990698655442, 8.20491375525792, 7.896145117779568, 7.709003259738282, 8.901855220397309, 8.846800496180848, 9.413299561788634, 8.530041148265198, 8.672946674128369, 8.71554160614808, 9.03495179116726, 9.061030387878418, 9.347524732351303, 7.864688004056603, 7.40366745988527, 7.926174479226262, 8.75100214779377, 8.584536954760551, 8.806595735251904, 10.201197996735573, 10.092944115400314, 10.869681727141142, 13.3932389418284, 12.443448389569909, 13.070466006795556, 0.18487957352772355, -0.867797389626503, -0.07469431683421135, -1.0711957700550556, -2.132381498813629, -1.9331836700439453, 6.437817541261509, 6.839073513944939, 5.956718092163399, 18.26429396122694, 17.570612385869026, 18.23768601939082, 8.88541654497385, 8.500515788793564, 9.15618297457695, 13.878522384911776, 12.884301245212555, 13.72783899307251, 10.118873829642922, 10.540686419854552, 9.462515900532395, 9.359084044893578, 9.193948109944657, 9.62790686016281, 11.997771754860878, 11.5697533339262, 12.056086611002684, 6.362145115931824, 6.500244048734501, 6.275335793693856, 7.670125318070248, 7.920219925542668, 7.693919715782002, 5.380618174870804, 5.048988362153366, 5.4611257587869915, 16.67550081262985, 16.9096973525981, 17.076396968836576, 15.418083295226097, 15.102929882705212, 15.180201977491379, 9.9178229967753, 10.188597715149314, 10.214766128609568, 7.908044554293156, 6.561638921499252, 7.32214680314064, 10.274848875900105, 10.519978155692414, 10.567441595097378, 12.47434500449647, 11.472296242912606, 11.975851369400814, 19.368657288451985, 19.033285235365227, 18.906113659342125, 8.714441314339638, 8.407148525118828, 8.420117750763893, 9.451557330787182, 9.442023027688265, 8.991647817194462, 20.891365230083466, 21.140563309192657, 20.569187000393867, 11.948709920048714, 12.719054877758026, 12.037983298301697, 19.50749032944441, 19.16123651713133, 19.518310546875, 9.934854954481125, 9.5045854896307, 10.025979205965996, 11.292738017936543, 10.345631202061966, 11.19080453862746, 10.810893222689629, 11.275140259414911, 10.535174205899239, 7.826282831529767, 8.410316575473786, 8.341889607409627, 4.307148096462086, 4.625543834020689, 4.098144446810082, 15.630795846382767, 16.336410420636327, 16.31748218337694, 14.285364429155976, 14.694641808668763, 15.344203706985951, 8.977296402057007, 9.324127634366349, 8.917034914096192, 12.476007496317223, 11.322732796271637, 12.274304819603756, 9.685986970861748, 9.642393176754311, 9.22005485494931, 11.180296058456094, 10.768683368961007, 11.021890381971986, 11.186523268464953, 10.956134717911482, 10.396458968520164, 14.40089165170987, 16.579602816452578, 16.23360152294238, 9.454960584640503, 8.88073942065239, 8.166803181171417, 30.315146632492542, 30.41683292016387, 30.20620983093977, 20.22721605747938, 20.018744081258774, 20.101230017840862, 16.40816668172677, 15.927324538429573, 16.173491162558392, 14.34921507537365, 14.554621836170554, 13.76432117819786, 17.86846989641586, 16.59766001502672, 17.982233891884476, 23.45343527942896, 23.750718530267477, 23.7902206517756, 18.28182002902031, 17.968430280685425, 18.486115880310535, 10.701842222362757, 9.982237339019775, 10.847602875903249, 15.073935622970254, 14.92502589772144, 15.4076298472161, 21.423478635648877, 21.526893849174172, 21.41139573107162, 9.074435298641518, 8.367480923732117, 9.5724306924579, 14.523493538300187, 14.100856150190026, 15.313368943907932, 17.472275132934243, 17.770170570040733, 17.904129014971346, -97.53991660724084, -97.744567292432, -109.64577795068423, 18.82084637756148, 18.385996873180062, 18.92370291861394, 26.88660358513394, 26.175066749254853, 27.052512062053808, 20.38558863786359, 20.284619515140847, 20.22434841593106, 9.862585827708244, 10.714190104976296, 10.778077851049602, 22.34363081057866, 22.751734341805175, 22.397288252909973, 17.895707647005707, 17.06040048102537, 17.765342118839413, 8.455218863983944, 7.491046418746308, 8.422378418346241, 17.168172761797905, 17.604708090424538, 17.27492505311966, 15.323962263762951, 15.635963577777147, 15.287515215575695, 17.03417445719242, 17.17834997177124, 17.739136785501614, 11.829141343633324, 11.566489751140267, 11.868044326702744, 22.00847043593724, 21.83861470719178, 22.204602872331932, 23.58599408964315, 22.95182480911413, 23.51681552330652, 15.139091620842606, 15.083838785688073, 15.383171411852032, 10.643474996089935, 11.364389691501856, 10.538815125823021, 17.58011645823717, 17.550566244870424, 16.016968369483948, 14.444466712574155, 13.916897098223359, 14.051496642331273, 15.556232705712318, 15.550078302621841, 14.982381165027618, 19.085171476006508, 18.51195189356804, 19.411049170419574, 13.382986754179, 12.900180637836456, 13.167569532990456, 10.953646188291401, 10.804706218341977, 10.500583278636128, 18.821574633320168, 19.38725827246283, 18.458840807278946, 14.944881270329148, 14.389195064703614, 15.125747169057519, 10.417347510655716, 10.393665244181946, 10.396425162752465, 10.791161060333252, 10.77293798327446, 11.217554248869419, 17.24434529757127, 16.523033544421196, 16.630789205431938, 27.391344269116715, 28.00208808605869, 27.771177624662712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14779239144562167, "mean_inference_ms": 0.7027793432689923, "mean_action_processing_ms": 0.0964950653089821, "mean_env_wait_ms": 0.8144623063467037, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 290000, "timesteps_this_iter": 0, "agent_timesteps_total": 870000, "timers": {"sample_time_ms": 11893.461, "sample_throughput": 420.399, "load_time_ms": 0.3, "load_throughput": 16663901.47, "learn_time_ms": 1993.707, "learn_throughput": 2507.891, "update_time_ms": 9.675}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0005000000000000001, "total_loss": 5.406206321716309, "policy_loss": -0.0021384620106996268, "vf_loss": 5.483086442947387, "vf_explained_var": -0.9724510192871094, "kl": 0.0023809155172865135, "entropy": 7.474162435531616, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 290000, "num_agent_steps_sampled": 870000, "num_steps_trained": 290000, "num_agent_steps_trained": 870000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1234, "training_iteration": 58, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-11-57", "timestamp": 1706231517, "time_this_iter_s": 10.770444631576538, "time_total_s": 634.5287053585052, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402DF04C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 634.5287053585052, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 7.773333333333334, "ram_util_percent": 59.22666666666667}}
{"episode_reward_max": 90.93818938359618, "episode_reward_min": -304.93026185035706, "episode_reward_mean": 37.85766694794991, "episode_len_mean": 495.63, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -109.64577795068423}, "policy_reward_max": {"shared_policy": 30.41683292016387}, "policy_reward_mean": {"shared_policy": 12.619222315983299}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.856818299740553, 46.52182020992039, 23.10202360898255, 23.81006213277577, 27.16195527836679, 25.918529428541646, 27.44350691139698, 23.194529943168135, 26.142134837806225, 31.16382383927703, 38.907153338193865, -0.7576121329329908, -5.13676093891263, 19.233609147369847, 54.07259236648679, 26.542115308344364, 40.49066262319684, 30.12207615002987, 28.180939015001044, 35.62361169978976, 19.13772495836018, 23.284264959394918, 15.890732295811162, 50.66159513406453, 45.70121515542269, 30.321186840534182, 21.79183027893305, 31.362268626689897, 35.92249261680989, 57.30805618315934, 25.54170759022236, 27.88522817566991, 62.60111553966999, 36.70574809610844, 58.18703739345074, 29.46541965007782, 32.82917375862597, 32.62120768800378, 24.57848901441318, 13.030836377292857, 48.28468845039603, 44.32420994481069, 27.218458950519548, 36.07304511219262, 28.54843500256537, 32.970869809389086, 32.5391169548966, 47.21409599110483, 26.50250318646431, 90.93818938359618, 60.34719015657902, 48.508982382714734, 42.668158089742064, 52.448363803327055, 70.99437446147203, 54.73636619001627, 31.53168243728578, 45.406591367907794, 64.36176821589467, 27.014346914831535, 43.937718632398145, 53.14657471794632, -304.93026185035706, 56.13054616935548, 80.1141823964426, 60.8945565689355, 31.354853783734143, 67.49265340529381, 52.72145024687049, 24.368643701076493, 52.0478059053421, 46.24744105711579, 51.951661214465275, 35.263675421476336, 66.05168801546095, 70.0546344220638, 45.60610181838271, 32.54667981341481, 51.14765107259154, 42.412860453128786, 46.08869217336178, 57.00817253999412, 39.45073692500591, 32.258935685269506, 56.667673713061944, 44.45982350409028, 31.207437917590127, 32.78165329247713, 50.398168047424406, 83.16460997983812, 49.22822230798191, 34.37968518096021, 81.34284279868005, 72.9766405839473, 42.25436252355574, 58.81982256472108, 75.26728419959545, 37.24537482485172, 45.34704485908151, 30.806036003399626], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [5.386982500553131, 5.982125919312239, 5.487709879875183, 15.127037604649857, 16.00087995578845, 15.393902649482087, 8.304810998340443, 6.948221911986664, 7.848990698655442, 8.20491375525792, 7.896145117779568, 7.709003259738282, 8.901855220397309, 8.846800496180848, 9.413299561788634, 8.530041148265198, 8.672946674128369, 8.71554160614808, 9.03495179116726, 9.061030387878418, 9.347524732351303, 7.864688004056603, 7.40366745988527, 7.926174479226262, 8.75100214779377, 8.584536954760551, 8.806595735251904, 10.201197996735573, 10.092944115400314, 10.869681727141142, 13.3932389418284, 12.443448389569909, 13.070466006795556, 0.18487957352772355, -0.867797389626503, -0.07469431683421135, -1.0711957700550556, -2.132381498813629, -1.9331836700439453, 6.437817541261509, 6.839073513944939, 5.956718092163399, 18.26429396122694, 17.570612385869026, 18.23768601939082, 8.88541654497385, 8.500515788793564, 9.15618297457695, 13.878522384911776, 12.884301245212555, 13.72783899307251, 10.118873829642922, 10.540686419854552, 9.462515900532395, 9.359084044893578, 9.193948109944657, 9.62790686016281, 11.997771754860878, 11.5697533339262, 12.056086611002684, 6.362145115931824, 6.500244048734501, 6.275335793693856, 7.670125318070248, 7.920219925542668, 7.693919715782002, 5.380618174870804, 5.048988362153366, 5.4611257587869915, 16.67550081262985, 16.9096973525981, 17.076396968836576, 15.418083295226097, 15.102929882705212, 15.180201977491379, 9.9178229967753, 10.188597715149314, 10.214766128609568, 7.908044554293156, 6.561638921499252, 7.32214680314064, 10.274848875900105, 10.519978155692414, 10.567441595097378, 12.47434500449647, 11.472296242912606, 11.975851369400814, 19.368657288451985, 19.033285235365227, 18.906113659342125, 8.714441314339638, 8.407148525118828, 8.420117750763893, 9.451557330787182, 9.442023027688265, 8.991647817194462, 20.891365230083466, 21.140563309192657, 20.569187000393867, 11.948709920048714, 12.719054877758026, 12.037983298301697, 19.50749032944441, 19.16123651713133, 19.518310546875, 9.934854954481125, 9.5045854896307, 10.025979205965996, 11.292738017936543, 10.345631202061966, 11.19080453862746, 10.810893222689629, 11.275140259414911, 10.535174205899239, 7.826282831529767, 8.410316575473786, 8.341889607409627, 4.307148096462086, 4.625543834020689, 4.098144446810082, 15.630795846382767, 16.336410420636327, 16.31748218337694, 14.285364429155976, 14.694641808668763, 15.344203706985951, 8.977296402057007, 9.324127634366349, 8.917034914096192, 12.476007496317223, 11.322732796271637, 12.274304819603756, 9.685986970861748, 9.642393176754311, 9.22005485494931, 11.180296058456094, 10.768683368961007, 11.021890381971986, 11.186523268464953, 10.956134717911482, 10.396458968520164, 14.40089165170987, 16.579602816452578, 16.23360152294238, 9.454960584640503, 8.88073942065239, 8.166803181171417, 30.315146632492542, 30.41683292016387, 30.20620983093977, 20.22721605747938, 20.018744081258774, 20.101230017840862, 16.40816668172677, 15.927324538429573, 16.173491162558392, 14.34921507537365, 14.554621836170554, 13.76432117819786, 17.86846989641586, 16.59766001502672, 17.982233891884476, 23.45343527942896, 23.750718530267477, 23.7902206517756, 18.28182002902031, 17.968430280685425, 18.486115880310535, 10.701842222362757, 9.982237339019775, 10.847602875903249, 15.073935622970254, 14.92502589772144, 15.4076298472161, 21.423478635648877, 21.526893849174172, 21.41139573107162, 9.074435298641518, 8.367480923732117, 9.5724306924579, 14.523493538300187, 14.100856150190026, 15.313368943907932, 17.472275132934243, 17.770170570040733, 17.904129014971346, -97.53991660724084, -97.744567292432, -109.64577795068423, 18.82084637756148, 18.385996873180062, 18.92370291861394, 26.88660358513394, 26.175066749254853, 27.052512062053808, 20.38558863786359, 20.284619515140847, 20.22434841593106, 9.862585827708244, 10.714190104976296, 10.778077851049602, 22.34363081057866, 22.751734341805175, 22.397288252909973, 17.895707647005707, 17.06040048102537, 17.765342118839413, 8.455218863983944, 7.491046418746308, 8.422378418346241, 17.168172761797905, 17.604708090424538, 17.27492505311966, 15.323962263762951, 15.635963577777147, 15.287515215575695, 17.03417445719242, 17.17834997177124, 17.739136785501614, 11.829141343633324, 11.566489751140267, 11.868044326702744, 22.00847043593724, 21.83861470719178, 22.204602872331932, 23.58599408964315, 22.95182480911413, 23.51681552330652, 15.139091620842606, 15.083838785688073, 15.383171411852032, 10.643474996089935, 11.364389691501856, 10.538815125823021, 17.58011645823717, 17.550566244870424, 16.016968369483948, 14.444466712574155, 13.916897098223359, 14.051496642331273, 15.556232705712318, 15.550078302621841, 14.982381165027618, 19.085171476006508, 18.51195189356804, 19.411049170419574, 13.382986754179, 12.900180637836456, 13.167569532990456, 10.953646188291401, 10.804706218341977, 10.500583278636128, 18.821574633320168, 19.38725827246283, 18.458840807278946, 14.944881270329148, 14.389195064703614, 15.125747169057519, 10.417347510655716, 10.393665244181946, 10.396425162752465, 10.791161060333252, 10.77293798327446, 11.217554248869419, 17.24434529757127, 16.523033544421196, 16.630789205431938, 27.391344269116715, 28.00208808605869, 27.771177624662712, 16.263461855550602, 16.09868723650773, 16.866073215923578, 11.57643801098068, 11.72521192960751, 11.078035240372017, 27.018500813593462, 27.086250656594828, 27.238091328491763, 24.179662317037582, 24.489325741305947, 24.30765252560377, 13.696696524818734, 14.288345714410141, 14.269320284326866, 19.707265908519418, 19.935475553075463, 19.1770811031262, 25.114888966083527, 25.279273882508278, 24.873121351003647, 12.569406038771064, 12.495063717166573, 12.180905068914086, 14.989132583141327, 15.383897293359041, 14.974014982581139, 10.481059726172433, 10.383100002383188, 9.941876274844006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14762898380856418, "mean_inference_ms": 0.7029113814166759, "mean_action_processing_ms": 0.096517503245297, "mean_env_wait_ms": 0.8147820678817028, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 295000, "timesteps_this_iter": 0, "agent_timesteps_total": 885000, "timers": {"sample_time_ms": 11857.198, "sample_throughput": 421.685, "load_time_ms": 0.3, "load_throughput": 16663901.47, "learn_time_ms": 1982.029, "learn_throughput": 2522.667, "update_time_ms": 9.286}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0005000000000000001, "total_loss": 5.448772716522217, "policy_loss": -0.002425676151178813, "vf_loss": 5.525293207168579, "vf_explained_var": -0.9034719705581665, "kl": 0.0024595757044234166, "entropy": 7.409465599060058, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 295000, "num_agent_steps_sampled": 885000, "num_steps_trained": 295000, "num_agent_steps_trained": 885000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1244, "training_iteration": 59, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-12-08", "timestamp": 1706231528, "time_this_iter_s": 10.680280685424805, "time_total_s": 645.20898604393, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D10550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 645.20898604393, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 7.213333333333334, "ram_util_percent": 59.220000000000006}}
{"episode_reward_max": 90.93818938359618, "episode_reward_min": -304.93026185035706, "episode_reward_mean": 37.66808098276727, "episode_len_mean": 491.96, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -109.64577795068423}, "policy_reward_max": {"shared_policy": 30.41683292016387}, "policy_reward_mean": {"shared_policy": 12.556026994255756}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.7576121329329908, -5.13676093891263, 19.233609147369847, 54.07259236648679, 26.542115308344364, 40.49066262319684, 30.12207615002987, 28.180939015001044, 35.62361169978976, 19.13772495836018, 23.284264959394918, 15.890732295811162, 50.66159513406453, 45.70121515542269, 30.321186840534182, 21.79183027893305, 31.362268626689897, 35.92249261680989, 57.30805618315934, 25.54170759022236, 27.88522817566991, 62.60111553966999, 36.70574809610844, 58.18703739345074, 29.46541965007782, 32.82917375862597, 32.62120768800378, 24.57848901441318, 13.030836377292857, 48.28468845039603, 44.32420994481069, 27.218458950519548, 36.07304511219262, 28.54843500256537, 32.970869809389086, 32.5391169548966, 47.21409599110483, 26.50250318646431, 90.93818938359618, 60.34719015657902, 48.508982382714734, 42.668158089742064, 52.448363803327055, 70.99437446147203, 54.73636619001627, 31.53168243728578, 45.406591367907794, 64.36176821589467, 27.014346914831535, 43.937718632398145, 53.14657471794632, -304.93026185035706, 56.13054616935548, 80.1141823964426, 60.8945565689355, 31.354853783734143, 67.49265340529381, 52.72145024687049, 24.368643701076493, 52.0478059053421, 46.24744105711579, 51.951661214465275, 35.263675421476336, 66.05168801546095, 70.0546344220638, 45.60610181838271, 32.54667981341481, 51.14765107259154, 42.412860453128786, 46.08869217336178, 57.00817253999412, 39.45073692500591, 32.258935685269506, 56.667673713061944, 44.45982350409028, 31.207437917590127, 32.78165329247713, 50.398168047424406, 83.16460997983812, 49.22822230798191, 34.37968518096021, 81.34284279868005, 72.9766405839473, 42.25436252355574, 58.81982256472108, 75.26728419959545, 37.24537482485172, 45.34704485908151, 30.806036003399626, 64.15156577900052, 47.440538888797164, 41.40946382377297, -292.93980776518583, 46.35661777108905, 60.707394786179066, 45.515494925901294, 52.1763831153512, 62.40507268998769, 75.5040462501347, 88.53699104487893], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 133, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [0.18487957352772355, -0.867797389626503, -0.07469431683421135, -1.0711957700550556, -2.132381498813629, -1.9331836700439453, 6.437817541261509, 6.839073513944939, 5.956718092163399, 18.26429396122694, 17.570612385869026, 18.23768601939082, 8.88541654497385, 8.500515788793564, 9.15618297457695, 13.878522384911776, 12.884301245212555, 13.72783899307251, 10.118873829642922, 10.540686419854552, 9.462515900532395, 9.359084044893578, 9.193948109944657, 9.62790686016281, 11.997771754860878, 11.5697533339262, 12.056086611002684, 6.362145115931824, 6.500244048734501, 6.275335793693856, 7.670125318070248, 7.920219925542668, 7.693919715782002, 5.380618174870804, 5.048988362153366, 5.4611257587869915, 16.67550081262985, 16.9096973525981, 17.076396968836576, 15.418083295226097, 15.102929882705212, 15.180201977491379, 9.9178229967753, 10.188597715149314, 10.214766128609568, 7.908044554293156, 6.561638921499252, 7.32214680314064, 10.274848875900105, 10.519978155692414, 10.567441595097378, 12.47434500449647, 11.472296242912606, 11.975851369400814, 19.368657288451985, 19.033285235365227, 18.906113659342125, 8.714441314339638, 8.407148525118828, 8.420117750763893, 9.451557330787182, 9.442023027688265, 8.991647817194462, 20.891365230083466, 21.140563309192657, 20.569187000393867, 11.948709920048714, 12.719054877758026, 12.037983298301697, 19.50749032944441, 19.16123651713133, 19.518310546875, 9.934854954481125, 9.5045854896307, 10.025979205965996, 11.292738017936543, 10.345631202061966, 11.19080453862746, 10.810893222689629, 11.275140259414911, 10.535174205899239, 7.826282831529767, 8.410316575473786, 8.341889607409627, 4.307148096462086, 4.625543834020689, 4.098144446810082, 15.630795846382767, 16.336410420636327, 16.31748218337694, 14.285364429155976, 14.694641808668763, 15.344203706985951, 8.977296402057007, 9.324127634366349, 8.917034914096192, 12.476007496317223, 11.322732796271637, 12.274304819603756, 9.685986970861748, 9.642393176754311, 9.22005485494931, 11.180296058456094, 10.768683368961007, 11.021890381971986, 11.186523268464953, 10.956134717911482, 10.396458968520164, 14.40089165170987, 16.579602816452578, 16.23360152294238, 9.454960584640503, 8.88073942065239, 8.166803181171417, 30.315146632492542, 30.41683292016387, 30.20620983093977, 20.22721605747938, 20.018744081258774, 20.101230017840862, 16.40816668172677, 15.927324538429573, 16.173491162558392, 14.34921507537365, 14.554621836170554, 13.76432117819786, 17.86846989641586, 16.59766001502672, 17.982233891884476, 23.45343527942896, 23.750718530267477, 23.7902206517756, 18.28182002902031, 17.968430280685425, 18.486115880310535, 10.701842222362757, 9.982237339019775, 10.847602875903249, 15.073935622970254, 14.92502589772144, 15.4076298472161, 21.423478635648877, 21.526893849174172, 21.41139573107162, 9.074435298641518, 8.367480923732117, 9.5724306924579, 14.523493538300187, 14.100856150190026, 15.313368943907932, 17.472275132934243, 17.770170570040733, 17.904129014971346, -97.53991660724084, -97.744567292432, -109.64577795068423, 18.82084637756148, 18.385996873180062, 18.92370291861394, 26.88660358513394, 26.175066749254853, 27.052512062053808, 20.38558863786359, 20.284619515140847, 20.22434841593106, 9.862585827708244, 10.714190104976296, 10.778077851049602, 22.34363081057866, 22.751734341805175, 22.397288252909973, 17.895707647005707, 17.06040048102537, 17.765342118839413, 8.455218863983944, 7.491046418746308, 8.422378418346241, 17.168172761797905, 17.604708090424538, 17.27492505311966, 15.323962263762951, 15.635963577777147, 15.287515215575695, 17.03417445719242, 17.17834997177124, 17.739136785501614, 11.829141343633324, 11.566489751140267, 11.868044326702744, 22.00847043593724, 21.83861470719178, 22.204602872331932, 23.58599408964315, 22.95182480911413, 23.51681552330652, 15.139091620842606, 15.083838785688073, 15.383171411852032, 10.643474996089935, 11.364389691501856, 10.538815125823021, 17.58011645823717, 17.550566244870424, 16.016968369483948, 14.444466712574155, 13.916897098223359, 14.051496642331273, 15.556232705712318, 15.550078302621841, 14.982381165027618, 19.085171476006508, 18.51195189356804, 19.411049170419574, 13.382986754179, 12.900180637836456, 13.167569532990456, 10.953646188291401, 10.804706218341977, 10.500583278636128, 18.821574633320168, 19.38725827246283, 18.458840807278946, 14.944881270329148, 14.389195064703614, 15.125747169057519, 10.417347510655716, 10.393665244181946, 10.396425162752465, 10.791161060333252, 10.77293798327446, 11.217554248869419, 17.24434529757127, 16.523033544421196, 16.630789205431938, 27.391344269116715, 28.00208808605869, 27.771177624662712, 16.263461855550602, 16.09868723650773, 16.866073215923578, 11.57643801098068, 11.72521192960751, 11.078035240372017, 27.018500813593462, 27.086250656594828, 27.238091328491763, 24.179662317037582, 24.489325741305947, 24.30765252560377, 13.696696524818734, 14.288345714410141, 14.269320284326866, 19.707265908519418, 19.935475553075463, 19.1770811031262, 25.114888966083527, 25.279273882508278, 24.873121351003647, 12.569406038771064, 12.495063717166573, 12.180905068914086, 14.989132583141327, 15.383897293359041, 14.974014982581139, 10.481059726172433, 10.383100002383188, 9.941876274844006, 21.51462072879076, 21.530622210353613, 21.106322839856148, 15.634215898811817, 15.933766501024365, 15.872556488960981, 14.117527631111443, 13.858429420739412, 13.433506771922112, -93.7608327443401, -94.40776341656844, -104.7712116042773, 15.562250937024743, 15.35607377688089, 15.438293057183415, 20.36786114424467, 20.287295818328857, 20.052237823605537, 15.1991026699543, 15.447642369195819, 14.868749886751175, 17.45653324946761, 17.23178356140852, 17.48806630447507, 21.039039781937987, 21.21684329180667, 20.149189616243035, 25.227085035294294, 25.368832498788834, 24.90812871605158, 29.71965035299459, 29.4283767218391, 29.38896397004524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14738053802132256, "mean_inference_ms": 0.702744634988442, "mean_action_processing_ms": 0.096505894891106, "mean_env_wait_ms": 0.814863485252889, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 300000, "timesteps_this_iter": 0, "agent_timesteps_total": 900000, "timers": {"sample_time_ms": 11719.156, "sample_throughput": 426.652, "load_time_ms": 0.2, "load_throughput": 24995852.205, "learn_time_ms": 1944.489, "learn_throughput": 2571.37, "update_time_ms": 9.334}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0005000000000000001, "total_loss": 110.1752082824707, "policy_loss": -0.0020404520067572205, "vf_loss": 110.25208282470703, "vf_explained_var": -0.013320624828338623, "kl": 0.007091669517111728, "entropy": 7.4833619594573975, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 300000, "num_agent_steps_sampled": 900000, "num_steps_trained": 300000, "num_agent_steps_trained": 900000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1255, "training_iteration": 60, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-12-18", "timestamp": 1706231538, "time_this_iter_s": 10.400676965713501, "time_total_s": 655.6096630096436, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002146F757550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 655.6096630096436, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 7.200000000000001, "ram_util_percent": 59.12666666666667}}
{"episode_reward_max": 127.58705449150875, "episode_reward_min": -304.93026185035706, "episode_reward_mean": 42.20682281150599, "episode_len_mean": 491.96, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -109.64577795068423}, "policy_reward_max": {"shared_policy": 42.75542270811275}, "policy_reward_mean": {"shared_policy": 14.068940937168657}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.284264959394918, 15.890732295811162, 50.66159513406453, 45.70121515542269, 30.321186840534182, 21.79183027893305, 31.362268626689897, 35.92249261680989, 57.30805618315934, 25.54170759022236, 27.88522817566991, 62.60111553966999, 36.70574809610844, 58.18703739345074, 29.46541965007782, 32.82917375862597, 32.62120768800378, 24.57848901441318, 13.030836377292857, 48.28468845039603, 44.32420994481069, 27.218458950519548, 36.07304511219262, 28.54843500256537, 32.970869809389086, 32.5391169548966, 47.21409599110483, 26.50250318646431, 90.93818938359618, 60.34719015657902, 48.508982382714734, 42.668158089742064, 52.448363803327055, 70.99437446147203, 54.73636619001627, 31.53168243728578, 45.406591367907794, 64.36176821589467, 27.014346914831535, 43.937718632398145, 53.14657471794632, -304.93026185035706, 56.13054616935548, 80.1141823964426, 60.8945565689355, 31.354853783734143, 67.49265340529381, 52.72145024687049, 24.368643701076493, 52.0478059053421, 46.24744105711579, 51.951661214465275, 35.263675421476336, 66.05168801546095, 70.0546344220638, 45.60610181838271, 32.54667981341481, 51.14765107259154, 42.412860453128786, 46.08869217336178, 57.00817253999412, 39.45073692500591, 32.258935685269506, 56.667673713061944, 44.45982350409028, 31.207437917590127, 32.78165329247713, 50.398168047424406, 83.16460997983812, 49.22822230798191, 34.37968518096021, 81.34284279868005, 72.9766405839473, 42.25436252355574, 58.81982256472108, 75.26728419959545, 37.24537482485172, 45.34704485908151, 30.806036003399626, 64.15156577900052, 47.440538888797164, 41.40946382377297, -292.93980776518583, 46.35661777108905, 60.707394786179066, 45.515494925901294, 52.1763831153512, 62.40507268998769, 75.5040462501347, 88.53699104487893, 49.88894618116318, 60.07970173470673, 86.718182221055, 39.288098238408566, 75.62424014788118, 76.05722202174366, 62.12374275876209, 66.70446521788836, 57.311488057486685, 127.58705449150875], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 133, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [7.670125318070248, 7.920219925542668, 7.693919715782002, 5.380618174870804, 5.048988362153366, 5.4611257587869915, 16.67550081262985, 16.9096973525981, 17.076396968836576, 15.418083295226097, 15.102929882705212, 15.180201977491379, 9.9178229967753, 10.188597715149314, 10.214766128609568, 7.908044554293156, 6.561638921499252, 7.32214680314064, 10.274848875900105, 10.519978155692414, 10.567441595097378, 12.47434500449647, 11.472296242912606, 11.975851369400814, 19.368657288451985, 19.033285235365227, 18.906113659342125, 8.714441314339638, 8.407148525118828, 8.420117750763893, 9.451557330787182, 9.442023027688265, 8.991647817194462, 20.891365230083466, 21.140563309192657, 20.569187000393867, 11.948709920048714, 12.719054877758026, 12.037983298301697, 19.50749032944441, 19.16123651713133, 19.518310546875, 9.934854954481125, 9.5045854896307, 10.025979205965996, 11.292738017936543, 10.345631202061966, 11.19080453862746, 10.810893222689629, 11.275140259414911, 10.535174205899239, 7.826282831529767, 8.410316575473786, 8.341889607409627, 4.307148096462086, 4.625543834020689, 4.098144446810082, 15.630795846382767, 16.336410420636327, 16.31748218337694, 14.285364429155976, 14.694641808668763, 15.344203706985951, 8.977296402057007, 9.324127634366349, 8.917034914096192, 12.476007496317223, 11.322732796271637, 12.274304819603756, 9.685986970861748, 9.642393176754311, 9.22005485494931, 11.180296058456094, 10.768683368961007, 11.021890381971986, 11.186523268464953, 10.956134717911482, 10.396458968520164, 14.40089165170987, 16.579602816452578, 16.23360152294238, 9.454960584640503, 8.88073942065239, 8.166803181171417, 30.315146632492542, 30.41683292016387, 30.20620983093977, 20.22721605747938, 20.018744081258774, 20.101230017840862, 16.40816668172677, 15.927324538429573, 16.173491162558392, 14.34921507537365, 14.554621836170554, 13.76432117819786, 17.86846989641586, 16.59766001502672, 17.982233891884476, 23.45343527942896, 23.750718530267477, 23.7902206517756, 18.28182002902031, 17.968430280685425, 18.486115880310535, 10.701842222362757, 9.982237339019775, 10.847602875903249, 15.073935622970254, 14.92502589772144, 15.4076298472161, 21.423478635648877, 21.526893849174172, 21.41139573107162, 9.074435298641518, 8.367480923732117, 9.5724306924579, 14.523493538300187, 14.100856150190026, 15.313368943907932, 17.472275132934243, 17.770170570040733, 17.904129014971346, -97.53991660724084, -97.744567292432, -109.64577795068423, 18.82084637756148, 18.385996873180062, 18.92370291861394, 26.88660358513394, 26.175066749254853, 27.052512062053808, 20.38558863786359, 20.284619515140847, 20.22434841593106, 9.862585827708244, 10.714190104976296, 10.778077851049602, 22.34363081057866, 22.751734341805175, 22.397288252909973, 17.895707647005707, 17.06040048102537, 17.765342118839413, 8.455218863983944, 7.491046418746308, 8.422378418346241, 17.168172761797905, 17.604708090424538, 17.27492505311966, 15.323962263762951, 15.635963577777147, 15.287515215575695, 17.03417445719242, 17.17834997177124, 17.739136785501614, 11.829141343633324, 11.566489751140267, 11.868044326702744, 22.00847043593724, 21.83861470719178, 22.204602872331932, 23.58599408964315, 22.95182480911413, 23.51681552330652, 15.139091620842606, 15.083838785688073, 15.383171411852032, 10.643474996089935, 11.364389691501856, 10.538815125823021, 17.58011645823717, 17.550566244870424, 16.016968369483948, 14.444466712574155, 13.916897098223359, 14.051496642331273, 15.556232705712318, 15.550078302621841, 14.982381165027618, 19.085171476006508, 18.51195189356804, 19.411049170419574, 13.382986754179, 12.900180637836456, 13.167569532990456, 10.953646188291401, 10.804706218341977, 10.500583278636128, 18.821574633320168, 19.38725827246283, 18.458840807278946, 14.944881270329148, 14.389195064703614, 15.125747169057519, 10.417347510655716, 10.393665244181946, 10.396425162752465, 10.791161060333252, 10.77293798327446, 11.217554248869419, 17.24434529757127, 16.523033544421196, 16.630789205431938, 27.391344269116715, 28.00208808605869, 27.771177624662712, 16.263461855550602, 16.09868723650773, 16.866073215923578, 11.57643801098068, 11.72521192960751, 11.078035240372017, 27.018500813593462, 27.086250656594828, 27.238091328491763, 24.179662317037582, 24.489325741305947, 24.30765252560377, 13.696696524818734, 14.288345714410141, 14.269320284326866, 19.707265908519418, 19.935475553075463, 19.1770811031262, 25.114888966083527, 25.279273882508278, 24.873121351003647, 12.569406038771064, 12.495063717166573, 12.180905068914086, 14.989132583141327, 15.383897293359041, 14.974014982581139, 10.481059726172433, 10.383100002383188, 9.941876274844006, 21.51462072879076, 21.530622210353613, 21.106322839856148, 15.634215898811817, 15.933766501024365, 15.872556488960981, 14.117527631111443, 13.858429420739412, 13.433506771922112, -93.7608327443401, -94.40776341656844, -104.7712116042773, 15.562250937024743, 15.35607377688089, 15.438293057183415, 20.36786114424467, 20.287295818328857, 20.052237823605537, 15.1991026699543, 15.447642369195819, 14.868749886751175, 17.45653324946761, 17.23178356140852, 17.48806630447507, 21.039039781937987, 21.21684329180667, 20.149189616243035, 25.227085035294294, 25.368832498788834, 24.90812871605158, 29.71965035299459, 29.4283767218391, 29.38896397004524, 16.333342989285782, 16.339531665047005, 17.21607152683039, 19.97011950115362, 20.425158598149807, 19.684423635403306, 29.066303233305604, 28.854521746436745, 28.797357241312653, 12.798176229000092, 13.273842453956604, 13.21607955545187, 25.460246747049183, 25.241429309050233, 24.922564091781766, 25.522905005142093, 25.253474585711956, 25.280842430889606, 21.006999499630183, 20.59804628789425, 20.51869697123766, 22.37243153527379, 22.30356566980481, 22.028468012809753, 19.08484088505307, 19.24767372912416, 18.978973443309457, 42.53240009024739, 42.75542270811275, 42.29923169314861]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1471735049044375, "mean_inference_ms": 0.7026217624883592, "mean_action_processing_ms": 0.09652212335683404, "mean_env_wait_ms": 0.8148287940716895, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 305000, "timesteps_this_iter": 0, "agent_timesteps_total": 915000, "timers": {"sample_time_ms": 10718.743, "sample_throughput": 466.473, "load_time_ms": 0.2, "load_throughput": 24995852.205, "learn_time_ms": 1940.639, "learn_throughput": 2576.471, "update_time_ms": 9.25}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0005000000000000001, "total_loss": 5.0859119415283205, "policy_loss": -0.002170143474477015, "vf_loss": 5.163303327560425, "vf_explained_var": -0.3311434626579285, "kl": 0.0031381725682962562, "entropy": 7.522136306762695, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 305000, "num_agent_steps_sampled": 915000, "num_steps_trained": 305000, "num_agent_steps_trained": 915000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1265, "training_iteration": 61, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-12-29", "timestamp": 1706231549, "time_this_iter_s": 10.524059772491455, "time_total_s": 666.133722782135, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021404232940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 666.133722782135, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 5.492857142857142, "ram_util_percent": 59.10714285714287}}
{"episode_reward_max": 127.58705449150875, "episode_reward_min": -304.93026185035706, "episode_reward_mean": 45.30847729168018, "episode_len_mean": 491.96, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -109.64577795068423}, "policy_reward_max": {"shared_policy": 42.75542270811275}, "policy_reward_mean": {"shared_policy": 15.102825763893385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.88522817566991, 62.60111553966999, 36.70574809610844, 58.18703739345074, 29.46541965007782, 32.82917375862597, 32.62120768800378, 24.57848901441318, 13.030836377292857, 48.28468845039603, 44.32420994481069, 27.218458950519548, 36.07304511219262, 28.54843500256537, 32.970869809389086, 32.5391169548966, 47.21409599110483, 26.50250318646431, 90.93818938359618, 60.34719015657902, 48.508982382714734, 42.668158089742064, 52.448363803327055, 70.99437446147203, 54.73636619001627, 31.53168243728578, 45.406591367907794, 64.36176821589467, 27.014346914831535, 43.937718632398145, 53.14657471794632, -304.93026185035706, 56.13054616935548, 80.1141823964426, 60.8945565689355, 31.354853783734143, 67.49265340529381, 52.72145024687049, 24.368643701076493, 52.0478059053421, 46.24744105711579, 51.951661214465275, 35.263675421476336, 66.05168801546095, 70.0546344220638, 45.60610181838271, 32.54667981341481, 51.14765107259154, 42.412860453128786, 46.08869217336178, 57.00817253999412, 39.45073692500591, 32.258935685269506, 56.667673713061944, 44.45982350409028, 31.207437917590127, 32.78165329247713, 50.398168047424406, 83.16460997983812, 49.22822230798191, 34.37968518096021, 81.34284279868005, 72.9766405839473, 42.25436252355574, 58.81982256472108, 75.26728419959545, 37.24537482485172, 45.34704485908151, 30.806036003399626, 64.15156577900052, 47.440538888797164, 41.40946382377297, -292.93980776518583, 46.35661777108905, 60.707394786179066, 45.515494925901294, 52.1763831153512, 62.40507268998769, 75.5040462501347, 88.53699104487893, 49.88894618116318, 60.07970173470673, 86.718182221055, 39.288098238408566, 75.62424014788118, 76.05722202174366, 62.12374275876209, 66.70446521788836, 57.311488057486685, 127.58705449150875, 67.68387200683354, 47.83811668679117, 76.6060167159885, 56.410822942852974, 56.508616939187036, 75.75221336632966, 76.23602240905166, 62.90883161500095, 64.85097013041374, 63.15531488601117], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 133, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [9.451557330787182, 9.442023027688265, 8.991647817194462, 20.891365230083466, 21.140563309192657, 20.569187000393867, 11.948709920048714, 12.719054877758026, 12.037983298301697, 19.50749032944441, 19.16123651713133, 19.518310546875, 9.934854954481125, 9.5045854896307, 10.025979205965996, 11.292738017936543, 10.345631202061966, 11.19080453862746, 10.810893222689629, 11.275140259414911, 10.535174205899239, 7.826282831529767, 8.410316575473786, 8.341889607409627, 4.307148096462086, 4.625543834020689, 4.098144446810082, 15.630795846382767, 16.336410420636327, 16.31748218337694, 14.285364429155976, 14.694641808668763, 15.344203706985951, 8.977296402057007, 9.324127634366349, 8.917034914096192, 12.476007496317223, 11.322732796271637, 12.274304819603756, 9.685986970861748, 9.642393176754311, 9.22005485494931, 11.180296058456094, 10.768683368961007, 11.021890381971986, 11.186523268464953, 10.956134717911482, 10.396458968520164, 14.40089165170987, 16.579602816452578, 16.23360152294238, 9.454960584640503, 8.88073942065239, 8.166803181171417, 30.315146632492542, 30.41683292016387, 30.20620983093977, 20.22721605747938, 20.018744081258774, 20.101230017840862, 16.40816668172677, 15.927324538429573, 16.173491162558392, 14.34921507537365, 14.554621836170554, 13.76432117819786, 17.86846989641586, 16.59766001502672, 17.982233891884476, 23.45343527942896, 23.750718530267477, 23.7902206517756, 18.28182002902031, 17.968430280685425, 18.486115880310535, 10.701842222362757, 9.982237339019775, 10.847602875903249, 15.073935622970254, 14.92502589772144, 15.4076298472161, 21.423478635648877, 21.526893849174172, 21.41139573107162, 9.074435298641518, 8.367480923732117, 9.5724306924579, 14.523493538300187, 14.100856150190026, 15.313368943907932, 17.472275132934243, 17.770170570040733, 17.904129014971346, -97.53991660724084, -97.744567292432, -109.64577795068423, 18.82084637756148, 18.385996873180062, 18.92370291861394, 26.88660358513394, 26.175066749254853, 27.052512062053808, 20.38558863786359, 20.284619515140847, 20.22434841593106, 9.862585827708244, 10.714190104976296, 10.778077851049602, 22.34363081057866, 22.751734341805175, 22.397288252909973, 17.895707647005707, 17.06040048102537, 17.765342118839413, 8.455218863983944, 7.491046418746308, 8.422378418346241, 17.168172761797905, 17.604708090424538, 17.27492505311966, 15.323962263762951, 15.635963577777147, 15.287515215575695, 17.03417445719242, 17.17834997177124, 17.739136785501614, 11.829141343633324, 11.566489751140267, 11.868044326702744, 22.00847043593724, 21.83861470719178, 22.204602872331932, 23.58599408964315, 22.95182480911413, 23.51681552330652, 15.139091620842606, 15.083838785688073, 15.383171411852032, 10.643474996089935, 11.364389691501856, 10.538815125823021, 17.58011645823717, 17.550566244870424, 16.016968369483948, 14.444466712574155, 13.916897098223359, 14.051496642331273, 15.556232705712318, 15.550078302621841, 14.982381165027618, 19.085171476006508, 18.51195189356804, 19.411049170419574, 13.382986754179, 12.900180637836456, 13.167569532990456, 10.953646188291401, 10.804706218341977, 10.500583278636128, 18.821574633320168, 19.38725827246283, 18.458840807278946, 14.944881270329148, 14.389195064703614, 15.125747169057519, 10.417347510655716, 10.393665244181946, 10.396425162752465, 10.791161060333252, 10.77293798327446, 11.217554248869419, 17.24434529757127, 16.523033544421196, 16.630789205431938, 27.391344269116715, 28.00208808605869, 27.771177624662712, 16.263461855550602, 16.09868723650773, 16.866073215923578, 11.57643801098068, 11.72521192960751, 11.078035240372017, 27.018500813593462, 27.086250656594828, 27.238091328491763, 24.179662317037582, 24.489325741305947, 24.30765252560377, 13.696696524818734, 14.288345714410141, 14.269320284326866, 19.707265908519418, 19.935475553075463, 19.1770811031262, 25.114888966083527, 25.279273882508278, 24.873121351003647, 12.569406038771064, 12.495063717166573, 12.180905068914086, 14.989132583141327, 15.383897293359041, 14.974014982581139, 10.481059726172433, 10.383100002383188, 9.941876274844006, 21.51462072879076, 21.530622210353613, 21.106322839856148, 15.634215898811817, 15.933766501024365, 15.872556488960981, 14.117527631111443, 13.858429420739412, 13.433506771922112, -93.7608327443401, -94.40776341656844, -104.7712116042773, 15.562250937024743, 15.35607377688089, 15.438293057183415, 20.36786114424467, 20.287295818328857, 20.052237823605537, 15.1991026699543, 15.447642369195819, 14.868749886751175, 17.45653324946761, 17.23178356140852, 17.48806630447507, 21.039039781937987, 21.21684329180667, 20.149189616243035, 25.227085035294294, 25.368832498788834, 24.90812871605158, 29.71965035299459, 29.4283767218391, 29.38896397004524, 16.333342989285782, 16.339531665047005, 17.21607152683039, 19.97011950115362, 20.425158598149807, 19.684423635403306, 29.066303233305604, 28.854521746436745, 28.797357241312653, 12.798176229000092, 13.273842453956604, 13.21607955545187, 25.460246747049183, 25.241429309050233, 24.922564091781766, 25.522905005142093, 25.253474585711956, 25.280842430889606, 21.006999499630183, 20.59804628789425, 20.51869697123766, 22.37243153527379, 22.30356566980481, 22.028468012809753, 19.08484088505307, 19.24767372912416, 18.978973443309457, 42.53240009024739, 42.75542270811275, 42.29923169314861, 22.839227394511298, 22.048230712612465, 22.796413899709776, 15.927961868544415, 16.212081917872027, 15.698072900374726, 25.539155313124255, 25.59941461247702, 25.46744679038723, 18.91281172633171, 18.384413570165634, 19.11359764635563, 18.837761004765824, 18.928324823578194, 18.742531110843018, 24.874083658059433, 25.44176462789376, 25.43636508037646, 25.73488199338317, 24.840725466609, 25.660414949059486, 20.869711359341935, 20.860804600020245, 21.17831565563877, 21.75349684773633, 21.35093884418407, 21.74653443849334, 21.25670827956249, 20.76154377808173, 21.13706282836695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1469748868478873, "mean_inference_ms": 0.7024938007764544, "mean_action_processing_ms": 0.09653079165445085, "mean_env_wait_ms": 0.8147364927684133, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 310000, "timesteps_this_iter": 0, "agent_timesteps_total": 930000, "timers": {"sample_time_ms": 10696.146, "sample_throughput": 467.458, "load_time_ms": 0.2, "load_throughput": 24995852.205, "learn_time_ms": 1937.878, "learn_throughput": 2580.141, "update_time_ms": 9.167}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0005000000000000001, "total_loss": 4.693469667434693, "policy_loss": -0.002111674819574727, "vf_loss": 4.770578765869141, "vf_explained_var": -0.40290404558181764, "kl": 0.002516820718310129, "entropy": 7.499755430221557, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 310000, "num_agent_steps_sampled": 930000, "num_steps_trained": 310000, "num_agent_steps_trained": 930000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1275, "training_iteration": 62, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-12-40", "timestamp": 1706231560, "time_this_iter_s": 10.686427354812622, "time_total_s": 676.8201501369476, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D10670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 676.8201501369476, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 7.2125, "ram_util_percent": 59.45625}}
{"episode_reward_max": 127.58705449150875, "episode_reward_min": -304.93026185035706, "episode_reward_mean": 49.277797473963574, "episode_len_mean": 491.96, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -109.64577795068423}, "policy_reward_max": {"shared_policy": 42.75542270811275}, "policy_reward_mean": {"shared_policy": 16.425932491321188}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.32420994481069, 27.218458950519548, 36.07304511219262, 28.54843500256537, 32.970869809389086, 32.5391169548966, 47.21409599110483, 26.50250318646431, 90.93818938359618, 60.34719015657902, 48.508982382714734, 42.668158089742064, 52.448363803327055, 70.99437446147203, 54.73636619001627, 31.53168243728578, 45.406591367907794, 64.36176821589467, 27.014346914831535, 43.937718632398145, 53.14657471794632, -304.93026185035706, 56.13054616935548, 80.1141823964426, 60.8945565689355, 31.354853783734143, 67.49265340529381, 52.72145024687049, 24.368643701076493, 52.0478059053421, 46.24744105711579, 51.951661214465275, 35.263675421476336, 66.05168801546095, 70.0546344220638, 45.60610181838271, 32.54667981341481, 51.14765107259154, 42.412860453128786, 46.08869217336178, 57.00817253999412, 39.45073692500591, 32.258935685269506, 56.667673713061944, 44.45982350409028, 31.207437917590127, 32.78165329247713, 50.398168047424406, 83.16460997983812, 49.22822230798191, 34.37968518096021, 81.34284279868005, 72.9766405839473, 42.25436252355574, 58.81982256472108, 75.26728419959545, 37.24537482485172, 45.34704485908151, 30.806036003399626, 64.15156577900052, 47.440538888797164, 41.40946382377297, -292.93980776518583, 46.35661777108905, 60.707394786179066, 45.515494925901294, 52.1763831153512, 62.40507268998769, 75.5040462501347, 88.53699104487893, 49.88894618116318, 60.07970173470673, 86.718182221055, 39.288098238408566, 75.62424014788118, 76.05722202174366, 62.12374275876209, 66.70446521788836, 57.311488057486685, 127.58705449150875, 67.68387200683354, 47.83811668679117, 76.6060167159885, 56.410822942852974, 56.508616939187036, 75.75221336632966, 76.23602240905166, 62.90883161500095, 64.85097013041374, 63.15531488601117, 77.79576033726335, 83.72954642772675, 83.95147305727002, 78.42671695351599, 48.795795453712344, 84.62615496292709, 69.63081831112503, 71.10898739844558, 80.56085765734312, 84.49485181272028], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 133, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [14.285364429155976, 14.694641808668763, 15.344203706985951, 8.977296402057007, 9.324127634366349, 8.917034914096192, 12.476007496317223, 11.322732796271637, 12.274304819603756, 9.685986970861748, 9.642393176754311, 9.22005485494931, 11.180296058456094, 10.768683368961007, 11.021890381971986, 11.186523268464953, 10.956134717911482, 10.396458968520164, 14.40089165170987, 16.579602816452578, 16.23360152294238, 9.454960584640503, 8.88073942065239, 8.166803181171417, 30.315146632492542, 30.41683292016387, 30.20620983093977, 20.22721605747938, 20.018744081258774, 20.101230017840862, 16.40816668172677, 15.927324538429573, 16.173491162558392, 14.34921507537365, 14.554621836170554, 13.76432117819786, 17.86846989641586, 16.59766001502672, 17.982233891884476, 23.45343527942896, 23.750718530267477, 23.7902206517756, 18.28182002902031, 17.968430280685425, 18.486115880310535, 10.701842222362757, 9.982237339019775, 10.847602875903249, 15.073935622970254, 14.92502589772144, 15.4076298472161, 21.423478635648877, 21.526893849174172, 21.41139573107162, 9.074435298641518, 8.367480923732117, 9.5724306924579, 14.523493538300187, 14.100856150190026, 15.313368943907932, 17.472275132934243, 17.770170570040733, 17.904129014971346, -97.53991660724084, -97.744567292432, -109.64577795068423, 18.82084637756148, 18.385996873180062, 18.92370291861394, 26.88660358513394, 26.175066749254853, 27.052512062053808, 20.38558863786359, 20.284619515140847, 20.22434841593106, 9.862585827708244, 10.714190104976296, 10.778077851049602, 22.34363081057866, 22.751734341805175, 22.397288252909973, 17.895707647005707, 17.06040048102537, 17.765342118839413, 8.455218863983944, 7.491046418746308, 8.422378418346241, 17.168172761797905, 17.604708090424538, 17.27492505311966, 15.323962263762951, 15.635963577777147, 15.287515215575695, 17.03417445719242, 17.17834997177124, 17.739136785501614, 11.829141343633324, 11.566489751140267, 11.868044326702744, 22.00847043593724, 21.83861470719178, 22.204602872331932, 23.58599408964315, 22.95182480911413, 23.51681552330652, 15.139091620842606, 15.083838785688073, 15.383171411852032, 10.643474996089935, 11.364389691501856, 10.538815125823021, 17.58011645823717, 17.550566244870424, 16.016968369483948, 14.444466712574155, 13.916897098223359, 14.051496642331273, 15.556232705712318, 15.550078302621841, 14.982381165027618, 19.085171476006508, 18.51195189356804, 19.411049170419574, 13.382986754179, 12.900180637836456, 13.167569532990456, 10.953646188291401, 10.804706218341977, 10.500583278636128, 18.821574633320168, 19.38725827246283, 18.458840807278946, 14.944881270329148, 14.389195064703614, 15.125747169057519, 10.417347510655716, 10.393665244181946, 10.396425162752465, 10.791161060333252, 10.77293798327446, 11.217554248869419, 17.24434529757127, 16.523033544421196, 16.630789205431938, 27.391344269116715, 28.00208808605869, 27.771177624662712, 16.263461855550602, 16.09868723650773, 16.866073215923578, 11.57643801098068, 11.72521192960751, 11.078035240372017, 27.018500813593462, 27.086250656594828, 27.238091328491763, 24.179662317037582, 24.489325741305947, 24.30765252560377, 13.696696524818734, 14.288345714410141, 14.269320284326866, 19.707265908519418, 19.935475553075463, 19.1770811031262, 25.114888966083527, 25.279273882508278, 24.873121351003647, 12.569406038771064, 12.495063717166573, 12.180905068914086, 14.989132583141327, 15.383897293359041, 14.974014982581139, 10.481059726172433, 10.383100002383188, 9.941876274844006, 21.51462072879076, 21.530622210353613, 21.106322839856148, 15.634215898811817, 15.933766501024365, 15.872556488960981, 14.117527631111443, 13.858429420739412, 13.433506771922112, -93.7608327443401, -94.40776341656844, -104.7712116042773, 15.562250937024743, 15.35607377688089, 15.438293057183415, 20.36786114424467, 20.287295818328857, 20.052237823605537, 15.1991026699543, 15.447642369195819, 14.868749886751175, 17.45653324946761, 17.23178356140852, 17.48806630447507, 21.039039781937987, 21.21684329180667, 20.149189616243035, 25.227085035294294, 25.368832498788834, 24.90812871605158, 29.71965035299459, 29.4283767218391, 29.38896397004524, 16.333342989285782, 16.339531665047005, 17.21607152683039, 19.97011950115362, 20.425158598149807, 19.684423635403306, 29.066303233305604, 28.854521746436745, 28.797357241312653, 12.798176229000092, 13.273842453956604, 13.21607955545187, 25.460246747049183, 25.241429309050233, 24.922564091781766, 25.522905005142093, 25.253474585711956, 25.280842430889606, 21.006999499630183, 20.59804628789425, 20.51869697123766, 22.37243153527379, 22.30356566980481, 22.028468012809753, 19.08484088505307, 19.24767372912416, 18.978973443309457, 42.53240009024739, 42.75542270811275, 42.29923169314861, 22.839227394511298, 22.048230712612465, 22.796413899709776, 15.927961868544415, 16.212081917872027, 15.698072900374726, 25.539155313124255, 25.59941461247702, 25.46744679038723, 18.91281172633171, 18.384413570165634, 19.11359764635563, 18.837761004765824, 18.928324823578194, 18.742531110843018, 24.874083658059433, 25.44176462789376, 25.43636508037646, 25.73488199338317, 24.840725466609, 25.660414949059486, 20.869711359341935, 20.860804600020245, 21.17831565563877, 21.75349684773633, 21.35093884418407, 21.74653443849334, 21.25670827956249, 20.76154377808173, 21.13706282836695, 26.25344979390502, 25.503684103488922, 26.038626439869404, 28.403060108423233, 26.99473750591278, 28.331748813390732, 28.187944183746964, 27.89092634121576, 27.872602532307297, 26.209192869563893, 26.02770324548085, 26.18982083847125, 16.55819512717426, 16.04929120093584, 16.188309125602245, 28.265852620204285, 27.75296180446942, 28.607340538253382, 23.56713957463701, 22.754706492026642, 23.308972244461373, 23.729686523477227, 23.370013172427804, 24.009287702540547, 27.2494577007989, 27.031098301211983, 26.280301655332238, 28.49068323274453, 28.12099116047223, 27.883177419503525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1467879319037404, "mean_inference_ms": 0.702341165136547, "mean_action_processing_ms": 0.09654641381310615, "mean_env_wait_ms": 0.8145547507370007, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 315000, "timesteps_this_iter": 0, "agent_timesteps_total": 945000, "timers": {"sample_time_ms": 10659.932, "sample_throughput": 469.046, "load_time_ms": 0.1, "load_throughput": 50003624.225, "learn_time_ms": 1928.75, "learn_throughput": 2592.352, "update_time_ms": 9.178}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 0.0005000000000000001, "total_loss": 4.92375078201294, "policy_loss": -0.002339606954857487, "vf_loss": 5.000396347045898, "vf_explained_var": -0.4506566047668457, "kl": 0.002665991260445918, "entropy": 7.430600976943969, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 315000, "num_agent_steps_sampled": 945000, "num_steps_trained": 315000, "num_agent_steps_trained": 945000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1285, "training_iteration": 63, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-12-50", "timestamp": 1706231570, "time_this_iter_s": 10.331488847732544, "time_total_s": 687.1516389846802, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214024E8280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 687.1516389846802, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 5.1571428571428575, "ram_util_percent": 59.39999999999999}}
{"episode_reward_max": 127.58705449150875, "episode_reward_min": -304.93026185035706, "episode_reward_mean": 50.9846594772057, "episode_len_mean": 491.96, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -109.64577795068423}, "policy_reward_max": {"shared_policy": 42.75542270811275}, "policy_reward_mean": {"shared_policy": 16.9948864924019}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.508982382714734, 42.668158089742064, 52.448363803327055, 70.99437446147203, 54.73636619001627, 31.53168243728578, 45.406591367907794, 64.36176821589467, 27.014346914831535, 43.937718632398145, 53.14657471794632, -304.93026185035706, 56.13054616935548, 80.1141823964426, 60.8945565689355, 31.354853783734143, 67.49265340529381, 52.72145024687049, 24.368643701076493, 52.0478059053421, 46.24744105711579, 51.951661214465275, 35.263675421476336, 66.05168801546095, 70.0546344220638, 45.60610181838271, 32.54667981341481, 51.14765107259154, 42.412860453128786, 46.08869217336178, 57.00817253999412, 39.45073692500591, 32.258935685269506, 56.667673713061944, 44.45982350409028, 31.207437917590127, 32.78165329247713, 50.398168047424406, 83.16460997983812, 49.22822230798191, 34.37968518096021, 81.34284279868005, 72.9766405839473, 42.25436252355574, 58.81982256472108, 75.26728419959545, 37.24537482485172, 45.34704485908151, 30.806036003399626, 64.15156577900052, 47.440538888797164, 41.40946382377297, -292.93980776518583, 46.35661777108905, 60.707394786179066, 45.515494925901294, 52.1763831153512, 62.40507268998769, 75.5040462501347, 88.53699104487893, 49.88894618116318, 60.07970173470673, 86.718182221055, 39.288098238408566, 75.62424014788118, 76.05722202174366, 62.12374275876209, 66.70446521788836, 57.311488057486685, 127.58705449150875, 67.68387200683354, 47.83811668679117, 76.6060167159885, 56.410822942852974, 56.508616939187036, 75.75221336632966, 76.23602240905166, 62.90883161500095, 64.85097013041374, 63.15531488601117, 77.79576033726335, 83.72954642772675, 83.95147305727002, 78.42671695351599, 48.795795453712344, 84.62615496292709, 69.63081831112503, 71.10898739844558, 80.56085765734312, 84.49485181272028, 85.86921275779603, 91.96152812615034, 29.089690114371464, 63.18359397817403, 79.82451562210917, 74.71648566797376, 72.13044527545568, -15.719161249697237, 41.9352146682795, 74.37078985571858], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 133, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [16.40816668172677, 15.927324538429573, 16.173491162558392, 14.34921507537365, 14.554621836170554, 13.76432117819786, 17.86846989641586, 16.59766001502672, 17.982233891884476, 23.45343527942896, 23.750718530267477, 23.7902206517756, 18.28182002902031, 17.968430280685425, 18.486115880310535, 10.701842222362757, 9.982237339019775, 10.847602875903249, 15.073935622970254, 14.92502589772144, 15.4076298472161, 21.423478635648877, 21.526893849174172, 21.41139573107162, 9.074435298641518, 8.367480923732117, 9.5724306924579, 14.523493538300187, 14.100856150190026, 15.313368943907932, 17.472275132934243, 17.770170570040733, 17.904129014971346, -97.53991660724084, -97.744567292432, -109.64577795068423, 18.82084637756148, 18.385996873180062, 18.92370291861394, 26.88660358513394, 26.175066749254853, 27.052512062053808, 20.38558863786359, 20.284619515140847, 20.22434841593106, 9.862585827708244, 10.714190104976296, 10.778077851049602, 22.34363081057866, 22.751734341805175, 22.397288252909973, 17.895707647005707, 17.06040048102537, 17.765342118839413, 8.455218863983944, 7.491046418746308, 8.422378418346241, 17.168172761797905, 17.604708090424538, 17.27492505311966, 15.323962263762951, 15.635963577777147, 15.287515215575695, 17.03417445719242, 17.17834997177124, 17.739136785501614, 11.829141343633324, 11.566489751140267, 11.868044326702744, 22.00847043593724, 21.83861470719178, 22.204602872331932, 23.58599408964315, 22.95182480911413, 23.51681552330652, 15.139091620842606, 15.083838785688073, 15.383171411852032, 10.643474996089935, 11.364389691501856, 10.538815125823021, 17.58011645823717, 17.550566244870424, 16.016968369483948, 14.444466712574155, 13.916897098223359, 14.051496642331273, 15.556232705712318, 15.550078302621841, 14.982381165027618, 19.085171476006508, 18.51195189356804, 19.411049170419574, 13.382986754179, 12.900180637836456, 13.167569532990456, 10.953646188291401, 10.804706218341977, 10.500583278636128, 18.821574633320168, 19.38725827246283, 18.458840807278946, 14.944881270329148, 14.389195064703614, 15.125747169057519, 10.417347510655716, 10.393665244181946, 10.396425162752465, 10.791161060333252, 10.77293798327446, 11.217554248869419, 17.24434529757127, 16.523033544421196, 16.630789205431938, 27.391344269116715, 28.00208808605869, 27.771177624662712, 16.263461855550602, 16.09868723650773, 16.866073215923578, 11.57643801098068, 11.72521192960751, 11.078035240372017, 27.018500813593462, 27.086250656594828, 27.238091328491763, 24.179662317037582, 24.489325741305947, 24.30765252560377, 13.696696524818734, 14.288345714410141, 14.269320284326866, 19.707265908519418, 19.935475553075463, 19.1770811031262, 25.114888966083527, 25.279273882508278, 24.873121351003647, 12.569406038771064, 12.495063717166573, 12.180905068914086, 14.989132583141327, 15.383897293359041, 14.974014982581139, 10.481059726172433, 10.383100002383188, 9.941876274844006, 21.51462072879076, 21.530622210353613, 21.106322839856148, 15.634215898811817, 15.933766501024365, 15.872556488960981, 14.117527631111443, 13.858429420739412, 13.433506771922112, -93.7608327443401, -94.40776341656844, -104.7712116042773, 15.562250937024743, 15.35607377688089, 15.438293057183415, 20.36786114424467, 20.287295818328857, 20.052237823605537, 15.1991026699543, 15.447642369195819, 14.868749886751175, 17.45653324946761, 17.23178356140852, 17.48806630447507, 21.039039781937987, 21.21684329180667, 20.149189616243035, 25.227085035294294, 25.368832498788834, 24.90812871605158, 29.71965035299459, 29.4283767218391, 29.38896397004524, 16.333342989285782, 16.339531665047005, 17.21607152683039, 19.97011950115362, 20.425158598149807, 19.684423635403306, 29.066303233305604, 28.854521746436745, 28.797357241312653, 12.798176229000092, 13.273842453956604, 13.21607955545187, 25.460246747049183, 25.241429309050233, 24.922564091781766, 25.522905005142093, 25.253474585711956, 25.280842430889606, 21.006999499630183, 20.59804628789425, 20.51869697123766, 22.37243153527379, 22.30356566980481, 22.028468012809753, 19.08484088505307, 19.24767372912416, 18.978973443309457, 42.53240009024739, 42.75542270811275, 42.29923169314861, 22.839227394511298, 22.048230712612465, 22.796413899709776, 15.927961868544415, 16.212081917872027, 15.698072900374726, 25.539155313124255, 25.59941461247702, 25.46744679038723, 18.91281172633171, 18.384413570165634, 19.11359764635563, 18.837761004765824, 18.928324823578194, 18.742531110843018, 24.874083658059433, 25.44176462789376, 25.43636508037646, 25.73488199338317, 24.840725466609, 25.660414949059486, 20.869711359341935, 20.860804600020245, 21.17831565563877, 21.75349684773633, 21.35093884418407, 21.74653443849334, 21.25670827956249, 20.76154377808173, 21.13706282836695, 26.25344979390502, 25.503684103488922, 26.038626439869404, 28.403060108423233, 26.99473750591278, 28.331748813390732, 28.187944183746964, 27.89092634121576, 27.872602532307297, 26.209192869563893, 26.02770324548085, 26.18982083847125, 16.55819512717426, 16.04929120093584, 16.188309125602245, 28.265852620204285, 27.75296180446942, 28.607340538253382, 23.56713957463701, 22.754706492026642, 23.308972244461373, 23.729686523477227, 23.370013172427804, 24.009287702540547, 27.2494577007989, 27.031098301211983, 26.280301655332238, 28.49068323274453, 28.12099116047223, 27.883177419503525, 28.78831931141515, 28.301838782926396, 28.779054663454488, 31.183144620309264, 30.67067280660072, 30.107710699240357, 10.474768638921276, 9.447268908222512, 9.167652567227677, 21.289947517216206, 20.55657133460045, 21.337075126357377, 26.973734449595213, 25.968590795993805, 26.882190376520157, 24.576196417212486, 25.157063461840153, 24.983225788921118, 23.949764164785535, 24.08835770438114, 24.09232340628901, -5.138515007992595, -5.459744145472854, -5.120902096231788, 14.126806884383157, 13.58118439217408, 14.227223391722262, 25.03500278169909, 24.938089242825896, 24.397697831193597]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1465919663912577, "mean_inference_ms": 0.7021278385807369, "mean_action_processing_ms": 0.09654886823387514, "mean_env_wait_ms": 0.8142943001642137, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 320000, "timesteps_this_iter": 0, "agent_timesteps_total": 960000, "timers": {"sample_time_ms": 10597.431, "sample_throughput": 471.812, "load_time_ms": 0.1, "load_throughput": 50003624.225, "learn_time_ms": 1917.687, "learn_throughput": 2607.308, "update_time_ms": 9.179}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 0.0005000000000000001, "total_loss": 6.741007328033447, "policy_loss": -0.0021725164956444276, "vf_loss": 6.816960144042969, "vf_explained_var": -0.057859945297241214, "kl": 0.002705300998067326, "entropy": 7.377991771697998, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 320000, "num_agent_steps_sampled": 960000, "num_steps_trained": 320000, "num_agent_steps_trained": 960000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1295, "training_iteration": 64, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-13-00", "timestamp": 1706231580, "time_this_iter_s": 10.328837871551514, "time_total_s": 697.4804768562317, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D10700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 697.4804768562317, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 7.933333333333333, "ram_util_percent": 59.41333333333333}}
{"episode_reward_max": 127.58705449150875, "episode_reward_min": -325.0253613963723, "episode_reward_mean": 49.622806134029524, "episode_len_mean": 487.78, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -115.11709178239107}, "policy_reward_max": {"shared_policy": 42.75542270811275}, "policy_reward_mean": {"shared_policy": 16.540935378009834}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-304.93026185035706, 56.13054616935548, 80.1141823964426, 60.8945565689355, 31.354853783734143, 67.49265340529381, 52.72145024687049, 24.368643701076493, 52.0478059053421, 46.24744105711579, 51.951661214465275, 35.263675421476336, 66.05168801546095, 70.0546344220638, 45.60610181838271, 32.54667981341481, 51.14765107259154, 42.412860453128786, 46.08869217336178, 57.00817253999412, 39.45073692500591, 32.258935685269506, 56.667673713061944, 44.45982350409028, 31.207437917590127, 32.78165329247713, 50.398168047424406, 83.16460997983812, 49.22822230798191, 34.37968518096021, 81.34284279868005, 72.9766405839473, 42.25436252355574, 58.81982256472108, 75.26728419959545, 37.24537482485172, 45.34704485908151, 30.806036003399626, 64.15156577900052, 47.440538888797164, 41.40946382377297, -292.93980776518583, 46.35661777108905, 60.707394786179066, 45.515494925901294, 52.1763831153512, 62.40507268998769, 75.5040462501347, 88.53699104487893, 49.88894618116318, 60.07970173470673, 86.718182221055, 39.288098238408566, 75.62424014788118, 76.05722202174366, 62.12374275876209, 66.70446521788836, 57.311488057486685, 127.58705449150875, 67.68387200683354, 47.83811668679117, 76.6060167159885, 56.410822942852974, 56.508616939187036, 75.75221336632966, 76.23602240905166, 62.90883161500095, 64.85097013041374, 63.15531488601117, 77.79576033726335, 83.72954642772675, 83.95147305727002, 78.42671695351599, 48.795795453712344, 84.62615496292709, 69.63081831112503, 71.10898739844558, 80.56085765734312, 84.49485181272028, 85.86921275779603, 91.96152812615034, 29.089690114371464, 63.18359397817403, 79.82451562210917, 74.71648566797376, 72.13044527545568, -15.719161249697237, 41.9352146682795, 74.37078985571858, 79.17684424668548, 91.64266718551514, -325.0253613963723, 82.42115525808184, 72.31504999753086, 72.08296935260293, 85.84163487050681, 83.92157416045663, 95.47463209182023, 50.24651142209768, 10.47191570699215], "episode_lengths": [63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 133, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-97.53991660724084, -97.744567292432, -109.64577795068423, 18.82084637756148, 18.385996873180062, 18.92370291861394, 26.88660358513394, 26.175066749254853, 27.052512062053808, 20.38558863786359, 20.284619515140847, 20.22434841593106, 9.862585827708244, 10.714190104976296, 10.778077851049602, 22.34363081057866, 22.751734341805175, 22.397288252909973, 17.895707647005707, 17.06040048102537, 17.765342118839413, 8.455218863983944, 7.491046418746308, 8.422378418346241, 17.168172761797905, 17.604708090424538, 17.27492505311966, 15.323962263762951, 15.635963577777147, 15.287515215575695, 17.03417445719242, 17.17834997177124, 17.739136785501614, 11.829141343633324, 11.566489751140267, 11.868044326702744, 22.00847043593724, 21.83861470719178, 22.204602872331932, 23.58599408964315, 22.95182480911413, 23.51681552330652, 15.139091620842606, 15.083838785688073, 15.383171411852032, 10.643474996089935, 11.364389691501856, 10.538815125823021, 17.58011645823717, 17.550566244870424, 16.016968369483948, 14.444466712574155, 13.916897098223359, 14.051496642331273, 15.556232705712318, 15.550078302621841, 14.982381165027618, 19.085171476006508, 18.51195189356804, 19.411049170419574, 13.382986754179, 12.900180637836456, 13.167569532990456, 10.953646188291401, 10.804706218341977, 10.500583278636128, 18.821574633320168, 19.38725827246283, 18.458840807278946, 14.944881270329148, 14.389195064703614, 15.125747169057519, 10.417347510655716, 10.393665244181946, 10.396425162752465, 10.791161060333252, 10.77293798327446, 11.217554248869419, 17.24434529757127, 16.523033544421196, 16.630789205431938, 27.391344269116715, 28.00208808605869, 27.771177624662712, 16.263461855550602, 16.09868723650773, 16.866073215923578, 11.57643801098068, 11.72521192960751, 11.078035240372017, 27.018500813593462, 27.086250656594828, 27.238091328491763, 24.179662317037582, 24.489325741305947, 24.30765252560377, 13.696696524818734, 14.288345714410141, 14.269320284326866, 19.707265908519418, 19.935475553075463, 19.1770811031262, 25.114888966083527, 25.279273882508278, 24.873121351003647, 12.569406038771064, 12.495063717166573, 12.180905068914086, 14.989132583141327, 15.383897293359041, 14.974014982581139, 10.481059726172433, 10.383100002383188, 9.941876274844006, 21.51462072879076, 21.530622210353613, 21.106322839856148, 15.634215898811817, 15.933766501024365, 15.872556488960981, 14.117527631111443, 13.858429420739412, 13.433506771922112, -93.7608327443401, -94.40776341656844, -104.7712116042773, 15.562250937024743, 15.35607377688089, 15.438293057183415, 20.36786114424467, 20.287295818328857, 20.052237823605537, 15.1991026699543, 15.447642369195819, 14.868749886751175, 17.45653324946761, 17.23178356140852, 17.48806630447507, 21.039039781937987, 21.21684329180667, 20.149189616243035, 25.227085035294294, 25.368832498788834, 24.90812871605158, 29.71965035299459, 29.4283767218391, 29.38896397004524, 16.333342989285782, 16.339531665047005, 17.21607152683039, 19.97011950115362, 20.425158598149807, 19.684423635403306, 29.066303233305604, 28.854521746436745, 28.797357241312653, 12.798176229000092, 13.273842453956604, 13.21607955545187, 25.460246747049183, 25.241429309050233, 24.922564091781766, 25.522905005142093, 25.253474585711956, 25.280842430889606, 21.006999499630183, 20.59804628789425, 20.51869697123766, 22.37243153527379, 22.30356566980481, 22.028468012809753, 19.08484088505307, 19.24767372912416, 18.978973443309457, 42.53240009024739, 42.75542270811275, 42.29923169314861, 22.839227394511298, 22.048230712612465, 22.796413899709776, 15.927961868544415, 16.212081917872027, 15.698072900374726, 25.539155313124255, 25.59941461247702, 25.46744679038723, 18.91281172633171, 18.384413570165634, 19.11359764635563, 18.837761004765824, 18.928324823578194, 18.742531110843018, 24.874083658059433, 25.44176462789376, 25.43636508037646, 25.73488199338317, 24.840725466609, 25.660414949059486, 20.869711359341935, 20.860804600020245, 21.17831565563877, 21.75349684773633, 21.35093884418407, 21.74653443849334, 21.25670827956249, 20.76154377808173, 21.13706282836695, 26.25344979390502, 25.503684103488922, 26.038626439869404, 28.403060108423233, 26.99473750591278, 28.331748813390732, 28.187944183746964, 27.89092634121576, 27.872602532307297, 26.209192869563893, 26.02770324548085, 26.18982083847125, 16.55819512717426, 16.04929120093584, 16.188309125602245, 28.265852620204285, 27.75296180446942, 28.607340538253382, 23.56713957463701, 22.754706492026642, 23.308972244461373, 23.729686523477227, 23.370013172427804, 24.009287702540547, 27.2494577007989, 27.031098301211983, 26.280301655332238, 28.49068323274453, 28.12099116047223, 27.883177419503525, 28.78831931141515, 28.301838782926396, 28.779054663454488, 31.183144620309264, 30.67067280660072, 30.107710699240357, 10.474768638921276, 9.447268908222512, 9.167652567227677, 21.289947517216206, 20.55657133460045, 21.337075126357377, 26.973734449595213, 25.968590795993805, 26.882190376520157, 24.576196417212486, 25.157063461840153, 24.983225788921118, 23.949764164785535, 24.08835770438114, 24.09232340628901, -5.138515007992595, -5.459744145472854, -5.120902096231788, 14.126806884383157, 13.58118439217408, 14.227223391722262, 25.03500278169909, 24.938089242825896, 24.397697831193597, 26.321557487050683, 26.441305881987006, 26.413980877647788, 30.750053400794656, 30.839471301684767, 30.053142483035714, -104.91910141333938, -115.11709178239107, -104.98916820064187, 27.468094135945037, 27.533269090888396, 27.419792031248406, 23.86194023986657, 23.822918867071465, 24.63019089059283, 24.13074218730131, 24.14289833108583, 23.80932883421579, 28.75216568851222, 28.513466795285538, 28.57600238670905, 27.472674484054238, 28.28182631234327, 28.16707336405912, 31.474879970153168, 32.20837655415137, 31.791375567515686, 17.03674566745758, 16.966268949210644, 16.24349680542946, 3.669140547513962, 3.4307622015476227, 3.372012957930565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14638117516090693, "mean_inference_ms": 0.7018566560546818, "mean_action_processing_ms": 0.09652690411165049, "mean_env_wait_ms": 0.8139070552626363, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 325000, "timesteps_this_iter": 0, "agent_timesteps_total": 975000, "timers": {"sample_time_ms": 10523.185, "sample_throughput": 475.141, "load_time_ms": 0.1, "load_throughput": 50003624.225, "learn_time_ms": 1912.681, "learn_throughput": 2614.131, "update_time_ms": 9.309}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0005000000000000001, "total_loss": 102.88553619384766, "policy_loss": -0.0019534343418820656, "vf_loss": 102.96136169433593, "vf_explained_var": 0.024383300542831422, "kl": 0.00674171142164505, "entropy": 7.387293481826783, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 325000, "num_agent_steps_sampled": 975000, "num_steps_trained": 325000, "num_agent_steps_trained": 975000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1306, "training_iteration": 65, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-13-11", "timestamp": 1706231591, "time_this_iter_s": 10.312617540359497, "time_total_s": 707.7930943965912, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401945EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 707.7930943965912, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 8.021428571428572, "ram_util_percent": 59.38571428571428}}
{"episode_reward_max": 127.58705449150875, "episode_reward_min": -328.18724614102393, "episode_reward_mean": 52.63148081769934, "episode_len_mean": 487.96, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -125.79439838727316}, "policy_reward_max": {"shared_policy": 42.75542270811275}, "policy_reward_mean": {"shared_policy": 17.543826939233107}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.263675421476336, 66.05168801546095, 70.0546344220638, 45.60610181838271, 32.54667981341481, 51.14765107259154, 42.412860453128786, 46.08869217336178, 57.00817253999412, 39.45073692500591, 32.258935685269506, 56.667673713061944, 44.45982350409028, 31.207437917590127, 32.78165329247713, 50.398168047424406, 83.16460997983812, 49.22822230798191, 34.37968518096021, 81.34284279868005, 72.9766405839473, 42.25436252355574, 58.81982256472108, 75.26728419959545, 37.24537482485172, 45.34704485908151, 30.806036003399626, 64.15156577900052, 47.440538888797164, 41.40946382377297, -292.93980776518583, 46.35661777108905, 60.707394786179066, 45.515494925901294, 52.1763831153512, 62.40507268998769, 75.5040462501347, 88.53699104487893, 49.88894618116318, 60.07970173470673, 86.718182221055, 39.288098238408566, 75.62424014788118, 76.05722202174366, 62.12374275876209, 66.70446521788836, 57.311488057486685, 127.58705449150875, 67.68387200683354, 47.83811668679117, 76.6060167159885, 56.410822942852974, 56.508616939187036, 75.75221336632966, 76.23602240905166, 62.90883161500095, 64.85097013041374, 63.15531488601117, 77.79576033726335, 83.72954642772675, 83.95147305727002, 78.42671695351599, 48.795795453712344, 84.62615496292709, 69.63081831112503, 71.10898739844558, 80.56085765734312, 84.49485181272028, 85.86921275779603, 91.96152812615034, 29.089690114371464, 63.18359397817403, 79.82451562210917, 74.71648566797376, 72.13044527545568, -15.719161249697237, 41.9352146682795, 74.37078985571858, 79.17684424668548, 91.64266718551514, -325.0253613963723, 82.42115525808184, 72.31504999753086, 72.08296935260293, 85.84163487050681, 83.92157416045663, 95.47463209182023, 50.24651142209768, 10.47191570699215, 120.01008537784219, 107.09087535738942, 76.06210266053675, 79.8427950143814, 86.22026307228951, 82.5568866729736, 38.558629950042786, -328.18724614102393, 68.00015636812893, 101.19050341844557, 87.91594921424984], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 133, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 81, 500, 500, 500], "policy_shared_policy_reward": [11.829141343633324, 11.566489751140267, 11.868044326702744, 22.00847043593724, 21.83861470719178, 22.204602872331932, 23.58599408964315, 22.95182480911413, 23.51681552330652, 15.139091620842606, 15.083838785688073, 15.383171411852032, 10.643474996089935, 11.364389691501856, 10.538815125823021, 17.58011645823717, 17.550566244870424, 16.016968369483948, 14.444466712574155, 13.916897098223359, 14.051496642331273, 15.556232705712318, 15.550078302621841, 14.982381165027618, 19.085171476006508, 18.51195189356804, 19.411049170419574, 13.382986754179, 12.900180637836456, 13.167569532990456, 10.953646188291401, 10.804706218341977, 10.500583278636128, 18.821574633320168, 19.38725827246283, 18.458840807278946, 14.944881270329148, 14.389195064703614, 15.125747169057519, 10.417347510655716, 10.393665244181946, 10.396425162752465, 10.791161060333252, 10.77293798327446, 11.217554248869419, 17.24434529757127, 16.523033544421196, 16.630789205431938, 27.391344269116715, 28.00208808605869, 27.771177624662712, 16.263461855550602, 16.09868723650773, 16.866073215923578, 11.57643801098068, 11.72521192960751, 11.078035240372017, 27.018500813593462, 27.086250656594828, 27.238091328491763, 24.179662317037582, 24.489325741305947, 24.30765252560377, 13.696696524818734, 14.288345714410141, 14.269320284326866, 19.707265908519418, 19.935475553075463, 19.1770811031262, 25.114888966083527, 25.279273882508278, 24.873121351003647, 12.569406038771064, 12.495063717166573, 12.180905068914086, 14.989132583141327, 15.383897293359041, 14.974014982581139, 10.481059726172433, 10.383100002383188, 9.941876274844006, 21.51462072879076, 21.530622210353613, 21.106322839856148, 15.634215898811817, 15.933766501024365, 15.872556488960981, 14.117527631111443, 13.858429420739412, 13.433506771922112, -93.7608327443401, -94.40776341656844, -104.7712116042773, 15.562250937024743, 15.35607377688089, 15.438293057183415, 20.36786114424467, 20.287295818328857, 20.052237823605537, 15.1991026699543, 15.447642369195819, 14.868749886751175, 17.45653324946761, 17.23178356140852, 17.48806630447507, 21.039039781937987, 21.21684329180667, 20.149189616243035, 25.227085035294294, 25.368832498788834, 24.90812871605158, 29.71965035299459, 29.4283767218391, 29.38896397004524, 16.333342989285782, 16.339531665047005, 17.21607152683039, 19.97011950115362, 20.425158598149807, 19.684423635403306, 29.066303233305604, 28.854521746436745, 28.797357241312653, 12.798176229000092, 13.273842453956604, 13.21607955545187, 25.460246747049183, 25.241429309050233, 24.922564091781766, 25.522905005142093, 25.253474585711956, 25.280842430889606, 21.006999499630183, 20.59804628789425, 20.51869697123766, 22.37243153527379, 22.30356566980481, 22.028468012809753, 19.08484088505307, 19.24767372912416, 18.978973443309457, 42.53240009024739, 42.75542270811275, 42.29923169314861, 22.839227394511298, 22.048230712612465, 22.796413899709776, 15.927961868544415, 16.212081917872027, 15.698072900374726, 25.539155313124255, 25.59941461247702, 25.46744679038723, 18.91281172633171, 18.384413570165634, 19.11359764635563, 18.837761004765824, 18.928324823578194, 18.742531110843018, 24.874083658059433, 25.44176462789376, 25.43636508037646, 25.73488199338317, 24.840725466609, 25.660414949059486, 20.869711359341935, 20.860804600020245, 21.17831565563877, 21.75349684773633, 21.35093884418407, 21.74653443849334, 21.25670827956249, 20.76154377808173, 21.13706282836695, 26.25344979390502, 25.503684103488922, 26.038626439869404, 28.403060108423233, 26.99473750591278, 28.331748813390732, 28.187944183746964, 27.89092634121576, 27.872602532307297, 26.209192869563893, 26.02770324548085, 26.18982083847125, 16.55819512717426, 16.04929120093584, 16.188309125602245, 28.265852620204285, 27.75296180446942, 28.607340538253382, 23.56713957463701, 22.754706492026642, 23.308972244461373, 23.729686523477227, 23.370013172427804, 24.009287702540547, 27.2494577007989, 27.031098301211983, 26.280301655332238, 28.49068323274453, 28.12099116047223, 27.883177419503525, 28.78831931141515, 28.301838782926396, 28.779054663454488, 31.183144620309264, 30.67067280660072, 30.107710699240357, 10.474768638921276, 9.447268908222512, 9.167652567227677, 21.289947517216206, 20.55657133460045, 21.337075126357377, 26.973734449595213, 25.968590795993805, 26.882190376520157, 24.576196417212486, 25.157063461840153, 24.983225788921118, 23.949764164785535, 24.08835770438114, 24.09232340628901, -5.138515007992595, -5.459744145472854, -5.120902096231788, 14.126806884383157, 13.58118439217408, 14.227223391722262, 25.03500278169909, 24.938089242825896, 24.397697831193597, 26.321557487050683, 26.441305881987006, 26.413980877647788, 30.750053400794656, 30.839471301684767, 30.053142483035714, -104.91910141333938, -115.11709178239107, -104.98916820064187, 27.468094135945037, 27.533269090888396, 27.419792031248406, 23.86194023986657, 23.822918867071465, 24.63019089059283, 24.13074218730131, 24.14289833108583, 23.80932883421579, 28.75216568851222, 28.513466795285538, 28.57600238670905, 27.472674484054238, 28.28182631234327, 28.16707336405912, 31.474879970153168, 32.20837655415137, 31.791375567515686, 17.03674566745758, 16.966268949210644, 16.24349680542946, 3.669140547513962, 3.4307622015476227, 3.372012957930565, 39.64458613097668, 40.39673280343413, 39.96876644343138, 35.780967275301606, 35.724834265808255, 35.58507381627956, 25.159630355735615, 25.30509903033574, 25.597373274465397, 26.685104702909783, 26.528502588470772, 26.62918772300084, 29.082093124588326, 29.239518625972167, 27.89865132172902, 27.526544022063405, 27.707374605039746, 27.322968045870454, 12.787917683521897, 13.570520818388701, 12.200191448132188, -101.7217713346084, -100.6710764191424, -125.79439838727316, 22.916556651393563, 23.200912674578518, 21.882687042156846, 33.951461405803755, 33.44517346223195, 33.79386855040987, 29.273603995641068, 29.37993201365073, 29.262413204958037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14623524398706225, "mean_inference_ms": 0.7015957645458228, "mean_action_processing_ms": 0.09651868644230982, "mean_env_wait_ms": 0.8134644173381064, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 330000, "timesteps_this_iter": 0, "agent_timesteps_total": 990000, "timers": {"sample_time_ms": 10529.688, "sample_throughput": 474.848, "load_time_ms": 0.1, "load_throughput": 50003624.225, "learn_time_ms": 1916.822, "learn_throughput": 2608.484, "update_time_ms": 9.063}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0005000000000000001, "total_loss": 99.87175674438477, "policy_loss": -0.003907470670447988, "vf_loss": 99.95098342895508, "vf_explained_var": 0.06371531486511231, "kl": 0.00560905139428549, "entropy": 7.53204984664917, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 330000, "num_agent_steps_sampled": 990000, "num_steps_trained": 330000, "num_agent_steps_trained": 990000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1317, "training_iteration": 66, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-13-21", "timestamp": 1706231601, "time_this_iter_s": 10.4716796875, "time_total_s": 718.2647740840912, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402E08D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 718.2647740840912, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 5.9, "ram_util_percent": 59.33333333333332}}
{"episode_reward_max": 127.58705449150875, "episode_reward_min": -328.18724614102393, "episode_reward_mean": 56.920451163135006, "episode_len_mean": 487.96, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -125.79439838727316}, "policy_reward_max": {"shared_policy": 42.75542270811275}, "policy_reward_mean": {"shared_policy": 18.973483721044996}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.258935685269506, 56.667673713061944, 44.45982350409028, 31.207437917590127, 32.78165329247713, 50.398168047424406, 83.16460997983812, 49.22822230798191, 34.37968518096021, 81.34284279868005, 72.9766405839473, 42.25436252355574, 58.81982256472108, 75.26728419959545, 37.24537482485172, 45.34704485908151, 30.806036003399626, 64.15156577900052, 47.440538888797164, 41.40946382377297, -292.93980776518583, 46.35661777108905, 60.707394786179066, 45.515494925901294, 52.1763831153512, 62.40507268998769, 75.5040462501347, 88.53699104487893, 49.88894618116318, 60.07970173470673, 86.718182221055, 39.288098238408566, 75.62424014788118, 76.05722202174366, 62.12374275876209, 66.70446521788836, 57.311488057486685, 127.58705449150875, 67.68387200683354, 47.83811668679117, 76.6060167159885, 56.410822942852974, 56.508616939187036, 75.75221336632966, 76.23602240905166, 62.90883161500095, 64.85097013041374, 63.15531488601117, 77.79576033726335, 83.72954642772675, 83.95147305727002, 78.42671695351599, 48.795795453712344, 84.62615496292709, 69.63081831112503, 71.10898739844558, 80.56085765734312, 84.49485181272028, 85.86921275779603, 91.96152812615034, 29.089690114371464, 63.18359397817403, 79.82451562210917, 74.71648566797376, 72.13044527545568, -15.719161249697237, 41.9352146682795, 74.37078985571858, 79.17684424668548, 91.64266718551514, -325.0253613963723, 82.42115525808184, 72.31504999753086, 72.08296935260293, 85.84163487050681, 83.92157416045663, 95.47463209182023, 50.24651142209768, 10.47191570699215, 120.01008537784219, 107.09087535738942, 76.06210266053675, 79.8427950143814, 86.22026307228951, 82.5568866729736, 38.558629950042786, -328.18724614102393, 68.00015636812893, 101.19050341844557, 87.91594921424984, 121.9888647198677, 37.90231716260311, 114.16233916208147, 74.80545751936731, 88.81085337325929, 79.31800272781399, 106.4926713872701, 121.83642380684614, 82.47343695163727, 86.73756038770078], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 133, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 81, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [10.953646188291401, 10.804706218341977, 10.500583278636128, 18.821574633320168, 19.38725827246283, 18.458840807278946, 14.944881270329148, 14.389195064703614, 15.125747169057519, 10.417347510655716, 10.393665244181946, 10.396425162752465, 10.791161060333252, 10.77293798327446, 11.217554248869419, 17.24434529757127, 16.523033544421196, 16.630789205431938, 27.391344269116715, 28.00208808605869, 27.771177624662712, 16.263461855550602, 16.09868723650773, 16.866073215923578, 11.57643801098068, 11.72521192960751, 11.078035240372017, 27.018500813593462, 27.086250656594828, 27.238091328491763, 24.179662317037582, 24.489325741305947, 24.30765252560377, 13.696696524818734, 14.288345714410141, 14.269320284326866, 19.707265908519418, 19.935475553075463, 19.1770811031262, 25.114888966083527, 25.279273882508278, 24.873121351003647, 12.569406038771064, 12.495063717166573, 12.180905068914086, 14.989132583141327, 15.383897293359041, 14.974014982581139, 10.481059726172433, 10.383100002383188, 9.941876274844006, 21.51462072879076, 21.530622210353613, 21.106322839856148, 15.634215898811817, 15.933766501024365, 15.872556488960981, 14.117527631111443, 13.858429420739412, 13.433506771922112, -93.7608327443401, -94.40776341656844, -104.7712116042773, 15.562250937024743, 15.35607377688089, 15.438293057183415, 20.36786114424467, 20.287295818328857, 20.052237823605537, 15.1991026699543, 15.447642369195819, 14.868749886751175, 17.45653324946761, 17.23178356140852, 17.48806630447507, 21.039039781937987, 21.21684329180667, 20.149189616243035, 25.227085035294294, 25.368832498788834, 24.90812871605158, 29.71965035299459, 29.4283767218391, 29.38896397004524, 16.333342989285782, 16.339531665047005, 17.21607152683039, 19.97011950115362, 20.425158598149807, 19.684423635403306, 29.066303233305604, 28.854521746436745, 28.797357241312653, 12.798176229000092, 13.273842453956604, 13.21607955545187, 25.460246747049183, 25.241429309050233, 24.922564091781766, 25.522905005142093, 25.253474585711956, 25.280842430889606, 21.006999499630183, 20.59804628789425, 20.51869697123766, 22.37243153527379, 22.30356566980481, 22.028468012809753, 19.08484088505307, 19.24767372912416, 18.978973443309457, 42.53240009024739, 42.75542270811275, 42.29923169314861, 22.839227394511298, 22.048230712612465, 22.796413899709776, 15.927961868544415, 16.212081917872027, 15.698072900374726, 25.539155313124255, 25.59941461247702, 25.46744679038723, 18.91281172633171, 18.384413570165634, 19.11359764635563, 18.837761004765824, 18.928324823578194, 18.742531110843018, 24.874083658059433, 25.44176462789376, 25.43636508037646, 25.73488199338317, 24.840725466609, 25.660414949059486, 20.869711359341935, 20.860804600020245, 21.17831565563877, 21.75349684773633, 21.35093884418407, 21.74653443849334, 21.25670827956249, 20.76154377808173, 21.13706282836695, 26.25344979390502, 25.503684103488922, 26.038626439869404, 28.403060108423233, 26.99473750591278, 28.331748813390732, 28.187944183746964, 27.89092634121576, 27.872602532307297, 26.209192869563893, 26.02770324548085, 26.18982083847125, 16.55819512717426, 16.04929120093584, 16.188309125602245, 28.265852620204285, 27.75296180446942, 28.607340538253382, 23.56713957463701, 22.754706492026642, 23.308972244461373, 23.729686523477227, 23.370013172427804, 24.009287702540547, 27.2494577007989, 27.031098301211983, 26.280301655332238, 28.49068323274453, 28.12099116047223, 27.883177419503525, 28.78831931141515, 28.301838782926396, 28.779054663454488, 31.183144620309264, 30.67067280660072, 30.107710699240357, 10.474768638921276, 9.447268908222512, 9.167652567227677, 21.289947517216206, 20.55657133460045, 21.337075126357377, 26.973734449595213, 25.968590795993805, 26.882190376520157, 24.576196417212486, 25.157063461840153, 24.983225788921118, 23.949764164785535, 24.08835770438114, 24.09232340628901, -5.138515007992595, -5.459744145472854, -5.120902096231788, 14.126806884383157, 13.58118439217408, 14.227223391722262, 25.03500278169909, 24.938089242825896, 24.397697831193597, 26.321557487050683, 26.441305881987006, 26.413980877647788, 30.750053400794656, 30.839471301684767, 30.053142483035714, -104.91910141333938, -115.11709178239107, -104.98916820064187, 27.468094135945037, 27.533269090888396, 27.419792031248406, 23.86194023986657, 23.822918867071465, 24.63019089059283, 24.13074218730131, 24.14289833108583, 23.80932883421579, 28.75216568851222, 28.513466795285538, 28.57600238670905, 27.472674484054238, 28.28182631234327, 28.16707336405912, 31.474879970153168, 32.20837655415137, 31.791375567515686, 17.03674566745758, 16.966268949210644, 16.24349680542946, 3.669140547513962, 3.4307622015476227, 3.372012957930565, 39.64458613097668, 40.39673280343413, 39.96876644343138, 35.780967275301606, 35.724834265808255, 35.58507381627956, 25.159630355735615, 25.30509903033574, 25.597373274465397, 26.685104702909783, 26.528502588470772, 26.62918772300084, 29.082093124588326, 29.239518625972167, 27.89865132172902, 27.526544022063405, 27.707374605039746, 27.322968045870454, 12.787917683521897, 13.570520818388701, 12.200191448132188, -101.7217713346084, -100.6710764191424, -125.79439838727316, 22.916556651393563, 23.200912674578518, 21.882687042156846, 33.951461405803755, 33.44517346223195, 33.79386855040987, 29.273603995641068, 29.37993201365073, 29.262413204958037, 41.037309750914574, 40.935595616698265, 40.01595935225487, 12.883312063912541, 12.762068672726542, 12.256936425964028, 37.965551671882466, 38.25559005265434, 37.94119743754466, 24.609667892257363, 25.001209835211426, 25.19457979189852, 29.560529475410775, 29.90338684742649, 29.346937050422028, 26.45621151352921, 26.619308229225368, 26.24248298505941, 35.453511491417885, 35.73568991012871, 35.303469985723495, 40.64560165256262, 40.51054438203573, 40.68027777224779, 27.429247934371233, 27.61311861500144, 27.431070402264595, 29.03455504526694, 28.371845607956246, 29.331159734477595]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14606245365701293, "mean_inference_ms": 0.7013562076338483, "mean_action_processing_ms": 0.09651908119144893, "mean_env_wait_ms": 0.8130662996453495, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 335000, "timesteps_this_iter": 0, "agent_timesteps_total": 1005000, "timers": {"sample_time_ms": 10506.404, "sample_throughput": 475.9, "load_time_ms": 0.1, "load_throughput": 50003624.225, "learn_time_ms": 1918.437, "learn_throughput": 2606.289, "update_time_ms": 9.088}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0005000000000000001, "total_loss": 7.73870587348938, "policy_loss": -0.002104017355783494, "vf_loss": 7.816156005859375, "vf_explained_var": -0.29608469009399413, "kl": 0.002662373118810005, "entropy": 7.534612369537354, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 335000, "num_agent_steps_sampled": 1005000, "num_steps_trained": 335000, "num_agent_steps_trained": 1005000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1327, "training_iteration": 67, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-13-31", "timestamp": 1706231611, "time_this_iter_s": 10.230576992034912, "time_total_s": 728.4953510761261, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D21F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 728.4953510761261, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 5.473333333333334, "ram_util_percent": 59.42666666666666}}
{"episode_reward_max": 127.58705449150875, "episode_reward_min": -328.18724614102393, "episode_reward_mean": 53.55394281917717, "episode_len_mean": 483.65, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -125.79439838727316}, "policy_reward_max": {"shared_policy": 42.75542270811275}, "policy_reward_mean": {"shared_policy": 17.851314273059053}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.25436252355574, 58.81982256472108, 75.26728419959545, 37.24537482485172, 45.34704485908151, 30.806036003399626, 64.15156577900052, 47.440538888797164, 41.40946382377297, -292.93980776518583, 46.35661777108905, 60.707394786179066, 45.515494925901294, 52.1763831153512, 62.40507268998769, 75.5040462501347, 88.53699104487893, 49.88894618116318, 60.07970173470673, 86.718182221055, 39.288098238408566, 75.62424014788118, 76.05722202174366, 62.12374275876209, 66.70446521788836, 57.311488057486685, 127.58705449150875, 67.68387200683354, 47.83811668679117, 76.6060167159885, 56.410822942852974, 56.508616939187036, 75.75221336632966, 76.23602240905166, 62.90883161500095, 64.85097013041374, 63.15531488601117, 77.79576033726335, 83.72954642772675, 83.95147305727002, 78.42671695351599, 48.795795453712344, 84.62615496292709, 69.63081831112503, 71.10898739844558, 80.56085765734312, 84.49485181272028, 85.86921275779603, 91.96152812615034, 29.089690114371464, 63.18359397817403, 79.82451562210917, 74.71648566797376, 72.13044527545568, -15.719161249697237, 41.9352146682795, 74.37078985571858, 79.17684424668548, 91.64266718551514, -325.0253613963723, 82.42115525808184, 72.31504999753086, 72.08296935260293, 85.84163487050681, 83.92157416045663, 95.47463209182023, 50.24651142209768, 10.47191570699215, 120.01008537784219, 107.09087535738942, 76.06210266053675, 79.8427950143814, 86.22026307228951, 82.5568866729736, 38.558629950042786, -328.18724614102393, 68.00015636812893, 101.19050341844557, 87.91594921424984, 121.9888647198677, 37.90231716260311, 114.16233916208147, 74.80545751936731, 88.81085337325929, 79.31800272781399, 106.4926713872701, 121.83642380684614, 82.47343695163727, 86.73756038770078, 89.39434002921914, 87.25337513908742, 94.96309541165829, 110.6892161145806, -311.99859607964754, 28.156465814914554, 112.72392108291386, 99.55849140509962, 77.21328805573282, 73.77827632054685, -229.51701467856765], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 133, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 81, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 494], "policy_shared_policy_reward": [13.696696524818734, 14.288345714410141, 14.269320284326866, 19.707265908519418, 19.935475553075463, 19.1770811031262, 25.114888966083527, 25.279273882508278, 24.873121351003647, 12.569406038771064, 12.495063717166573, 12.180905068914086, 14.989132583141327, 15.383897293359041, 14.974014982581139, 10.481059726172433, 10.383100002383188, 9.941876274844006, 21.51462072879076, 21.530622210353613, 21.106322839856148, 15.634215898811817, 15.933766501024365, 15.872556488960981, 14.117527631111443, 13.858429420739412, 13.433506771922112, -93.7608327443401, -94.40776341656844, -104.7712116042773, 15.562250937024743, 15.35607377688089, 15.438293057183415, 20.36786114424467, 20.287295818328857, 20.052237823605537, 15.1991026699543, 15.447642369195819, 14.868749886751175, 17.45653324946761, 17.23178356140852, 17.48806630447507, 21.039039781937987, 21.21684329180667, 20.149189616243035, 25.227085035294294, 25.368832498788834, 24.90812871605158, 29.71965035299459, 29.4283767218391, 29.38896397004524, 16.333342989285782, 16.339531665047005, 17.21607152683039, 19.97011950115362, 20.425158598149807, 19.684423635403306, 29.066303233305604, 28.854521746436745, 28.797357241312653, 12.798176229000092, 13.273842453956604, 13.21607955545187, 25.460246747049183, 25.241429309050233, 24.922564091781766, 25.522905005142093, 25.253474585711956, 25.280842430889606, 21.006999499630183, 20.59804628789425, 20.51869697123766, 22.37243153527379, 22.30356566980481, 22.028468012809753, 19.08484088505307, 19.24767372912416, 18.978973443309457, 42.53240009024739, 42.75542270811275, 42.29923169314861, 22.839227394511298, 22.048230712612465, 22.796413899709776, 15.927961868544415, 16.212081917872027, 15.698072900374726, 25.539155313124255, 25.59941461247702, 25.46744679038723, 18.91281172633171, 18.384413570165634, 19.11359764635563, 18.837761004765824, 18.928324823578194, 18.742531110843018, 24.874083658059433, 25.44176462789376, 25.43636508037646, 25.73488199338317, 24.840725466609, 25.660414949059486, 20.869711359341935, 20.860804600020245, 21.17831565563877, 21.75349684773633, 21.35093884418407, 21.74653443849334, 21.25670827956249, 20.76154377808173, 21.13706282836695, 26.25344979390502, 25.503684103488922, 26.038626439869404, 28.403060108423233, 26.99473750591278, 28.331748813390732, 28.187944183746964, 27.89092634121576, 27.872602532307297, 26.209192869563893, 26.02770324548085, 26.18982083847125, 16.55819512717426, 16.04929120093584, 16.188309125602245, 28.265852620204285, 27.75296180446942, 28.607340538253382, 23.56713957463701, 22.754706492026642, 23.308972244461373, 23.729686523477227, 23.370013172427804, 24.009287702540547, 27.2494577007989, 27.031098301211983, 26.280301655332238, 28.49068323274453, 28.12099116047223, 27.883177419503525, 28.78831931141515, 28.301838782926396, 28.779054663454488, 31.183144620309264, 30.67067280660072, 30.107710699240357, 10.474768638921276, 9.447268908222512, 9.167652567227677, 21.289947517216206, 20.55657133460045, 21.337075126357377, 26.973734449595213, 25.968590795993805, 26.882190376520157, 24.576196417212486, 25.157063461840153, 24.983225788921118, 23.949764164785535, 24.08835770438114, 24.09232340628901, -5.138515007992595, -5.459744145472854, -5.120902096231788, 14.126806884383157, 13.58118439217408, 14.227223391722262, 25.03500278169909, 24.938089242825896, 24.397697831193597, 26.321557487050683, 26.441305881987006, 26.413980877647788, 30.750053400794656, 30.839471301684767, 30.053142483035714, -104.91910141333938, -115.11709178239107, -104.98916820064187, 27.468094135945037, 27.533269090888396, 27.419792031248406, 23.86194023986657, 23.822918867071465, 24.63019089059283, 24.13074218730131, 24.14289833108583, 23.80932883421579, 28.75216568851222, 28.513466795285538, 28.57600238670905, 27.472674484054238, 28.28182631234327, 28.16707336405912, 31.474879970153168, 32.20837655415137, 31.791375567515686, 17.03674566745758, 16.966268949210644, 16.24349680542946, 3.669140547513962, 3.4307622015476227, 3.372012957930565, 39.64458613097668, 40.39673280343413, 39.96876644343138, 35.780967275301606, 35.724834265808255, 35.58507381627956, 25.159630355735615, 25.30509903033574, 25.597373274465397, 26.685104702909783, 26.528502588470772, 26.62918772300084, 29.082093124588326, 29.239518625972167, 27.89865132172902, 27.526544022063405, 27.707374605039746, 27.322968045870454, 12.787917683521897, 13.570520818388701, 12.200191448132188, -101.7217713346084, -100.6710764191424, -125.79439838727316, 22.916556651393563, 23.200912674578518, 21.882687042156846, 33.951461405803755, 33.44517346223195, 33.79386855040987, 29.273603995641068, 29.37993201365073, 29.262413204958037, 41.037309750914574, 40.935595616698265, 40.01595935225487, 12.883312063912541, 12.762068672726542, 12.256936425964028, 37.965551671882466, 38.25559005265434, 37.94119743754466, 24.609667892257363, 25.001209835211426, 25.19457979189852, 29.560529475410775, 29.90338684742649, 29.346937050422028, 26.45621151352921, 26.619308229225368, 26.24248298505941, 35.453511491417885, 35.73568991012871, 35.303469985723495, 40.64560165256262, 40.51054438203573, 40.68027777224779, 27.429247934371233, 27.61311861500144, 27.431070402264595, 29.03455504526694, 28.371845607956246, 29.331159734477595, 30.043092478920386, 29.83733783538142, 29.513909714917332, 29.005597678323582, 29.328409412254885, 28.919368048508957, 31.193661838769913, 32.060554176568985, 31.70887939631939, 37.08658537144461, 36.763551163176686, 36.839079579959304, -99.36829576889674, -99.00137482831876, -113.62892548243205, 9.731482421513647, 9.666311915963888, 8.75867147743702, 37.87780230616529, 37.80931366359194, 37.03680511315663, 33.3070108157893, 32.85510257383187, 33.39637801547845, 25.785806770126015, 25.91719385671118, 25.510287428895623, 24.66995234539111, 24.640209348251418, 24.468114626904324, -72.38801611587405, -73.64135399460793, -83.48764456808567]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14587702986262194, "mean_inference_ms": 0.7010766025106598, "mean_action_processing_ms": 0.09649372417531418, "mean_env_wait_ms": 0.8125380659981183, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 340000, "timesteps_this_iter": 0, "agent_timesteps_total": 1020000, "timers": {"sample_time_ms": 10473.741, "sample_throughput": 477.384, "load_time_ms": 0.101, "load_throughput": 49414514.609, "learn_time_ms": 1915.278, "learn_throughput": 2610.587, "update_time_ms": 9.009}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.552713678800501e-16, "cur_lr": 0.0005000000000000001, "total_loss": 199.09348754882814, "policy_loss": -0.002325659578995154, "vf_loss": 199.17107849121095, "vf_explained_var": 0.00814352035522461, "kl": 0.0038262680289426663, "entropy": 7.526930475234986, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 340000, "num_agent_steps_sampled": 1020000, "num_steps_trained": 340000, "num_agent_steps_trained": 1020000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1338, "training_iteration": 68, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-13-42", "timestamp": 1706231622, "time_this_iter_s": 10.393683671951294, "time_total_s": 738.8890347480774, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D21DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 738.8890347480774, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 7.542857142857143, "ram_util_percent": 59.42142857142857}}
{"episode_reward_max": 127.58705449150875, "episode_reward_min": -328.18724614102393, "episode_reward_mean": 56.79262822680641, "episode_len_mean": 483.14, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -125.79439838727316}, "policy_reward_max": {"shared_policy": 42.75542270811275}, "policy_reward_mean": {"shared_policy": 18.930876075602132}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.707394786179066, 45.515494925901294, 52.1763831153512, 62.40507268998769, 75.5040462501347, 88.53699104487893, 49.88894618116318, 60.07970173470673, 86.718182221055, 39.288098238408566, 75.62424014788118, 76.05722202174366, 62.12374275876209, 66.70446521788836, 57.311488057486685, 127.58705449150875, 67.68387200683354, 47.83811668679117, 76.6060167159885, 56.410822942852974, 56.508616939187036, 75.75221336632966, 76.23602240905166, 62.90883161500095, 64.85097013041374, 63.15531488601117, 77.79576033726335, 83.72954642772675, 83.95147305727002, 78.42671695351599, 48.795795453712344, 84.62615496292709, 69.63081831112503, 71.10898739844558, 80.56085765734312, 84.49485181272028, 85.86921275779603, 91.96152812615034, 29.089690114371464, 63.18359397817403, 79.82451562210917, 74.71648566797376, 72.13044527545568, -15.719161249697237, 41.9352146682795, 74.37078985571858, 79.17684424668548, 91.64266718551514, -325.0253613963723, 82.42115525808184, 72.31504999753086, 72.08296935260293, 85.84163487050681, 83.92157416045663, 95.47463209182023, 50.24651142209768, 10.47191570699215, 120.01008537784219, 107.09087535738942, 76.06210266053675, 79.8427950143814, 86.22026307228951, 82.5568866729736, 38.558629950042786, -328.18724614102393, 68.00015636812893, 101.19050341844557, 87.91594921424984, 121.9888647198677, 37.90231716260311, 114.16233916208147, 74.80545751936731, 88.81085337325929, 79.31800272781399, 106.4926713872701, 121.83642380684614, 82.47343695163727, 86.73756038770078, 89.39434002921914, 87.25337513908742, 94.96309541165829, 110.6892161145806, -311.99859607964754, 28.156465814914554, 112.72392108291386, 99.55849140509962, 77.21328805573282, 73.77827632054685, -229.51701467856765, 100.26890219002962, 82.0266520641744, -317.43289336562157, 79.00248498097059, 72.27623457834122, 36.2718045124784, 115.09688869863749, 85.1404290399514, 74.47884937003253, 86.0216050259769, 106.87588714063168], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 81, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 494, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [20.36786114424467, 20.287295818328857, 20.052237823605537, 15.1991026699543, 15.447642369195819, 14.868749886751175, 17.45653324946761, 17.23178356140852, 17.48806630447507, 21.039039781937987, 21.21684329180667, 20.149189616243035, 25.227085035294294, 25.368832498788834, 24.90812871605158, 29.71965035299459, 29.4283767218391, 29.38896397004524, 16.333342989285782, 16.339531665047005, 17.21607152683039, 19.97011950115362, 20.425158598149807, 19.684423635403306, 29.066303233305604, 28.854521746436745, 28.797357241312653, 12.798176229000092, 13.273842453956604, 13.21607955545187, 25.460246747049183, 25.241429309050233, 24.922564091781766, 25.522905005142093, 25.253474585711956, 25.280842430889606, 21.006999499630183, 20.59804628789425, 20.51869697123766, 22.37243153527379, 22.30356566980481, 22.028468012809753, 19.08484088505307, 19.24767372912416, 18.978973443309457, 42.53240009024739, 42.75542270811275, 42.29923169314861, 22.839227394511298, 22.048230712612465, 22.796413899709776, 15.927961868544415, 16.212081917872027, 15.698072900374726, 25.539155313124255, 25.59941461247702, 25.46744679038723, 18.91281172633171, 18.384413570165634, 19.11359764635563, 18.837761004765824, 18.928324823578194, 18.742531110843018, 24.874083658059433, 25.44176462789376, 25.43636508037646, 25.73488199338317, 24.840725466609, 25.660414949059486, 20.869711359341935, 20.860804600020245, 21.17831565563877, 21.75349684773633, 21.35093884418407, 21.74653443849334, 21.25670827956249, 20.76154377808173, 21.13706282836695, 26.25344979390502, 25.503684103488922, 26.038626439869404, 28.403060108423233, 26.99473750591278, 28.331748813390732, 28.187944183746964, 27.89092634121576, 27.872602532307297, 26.209192869563893, 26.02770324548085, 26.18982083847125, 16.55819512717426, 16.04929120093584, 16.188309125602245, 28.265852620204285, 27.75296180446942, 28.607340538253382, 23.56713957463701, 22.754706492026642, 23.308972244461373, 23.729686523477227, 23.370013172427804, 24.009287702540547, 27.2494577007989, 27.031098301211983, 26.280301655332238, 28.49068323274453, 28.12099116047223, 27.883177419503525, 28.78831931141515, 28.301838782926396, 28.779054663454488, 31.183144620309264, 30.67067280660072, 30.107710699240357, 10.474768638921276, 9.447268908222512, 9.167652567227677, 21.289947517216206, 20.55657133460045, 21.337075126357377, 26.973734449595213, 25.968590795993805, 26.882190376520157, 24.576196417212486, 25.157063461840153, 24.983225788921118, 23.949764164785535, 24.08835770438114, 24.09232340628901, -5.138515007992595, -5.459744145472854, -5.120902096231788, 14.126806884383157, 13.58118439217408, 14.227223391722262, 25.03500278169909, 24.938089242825896, 24.397697831193597, 26.321557487050683, 26.441305881987006, 26.413980877647788, 30.750053400794656, 30.839471301684767, 30.053142483035714, -104.91910141333938, -115.11709178239107, -104.98916820064187, 27.468094135945037, 27.533269090888396, 27.419792031248406, 23.86194023986657, 23.822918867071465, 24.63019089059283, 24.13074218730131, 24.14289833108583, 23.80932883421579, 28.75216568851222, 28.513466795285538, 28.57600238670905, 27.472674484054238, 28.28182631234327, 28.16707336405912, 31.474879970153168, 32.20837655415137, 31.791375567515686, 17.03674566745758, 16.966268949210644, 16.24349680542946, 3.669140547513962, 3.4307622015476227, 3.372012957930565, 39.64458613097668, 40.39673280343413, 39.96876644343138, 35.780967275301606, 35.724834265808255, 35.58507381627956, 25.159630355735615, 25.30509903033574, 25.597373274465397, 26.685104702909783, 26.528502588470772, 26.62918772300084, 29.082093124588326, 29.239518625972167, 27.89865132172902, 27.526544022063405, 27.707374605039746, 27.322968045870454, 12.787917683521897, 13.570520818388701, 12.200191448132188, -101.7217713346084, -100.6710764191424, -125.79439838727316, 22.916556651393563, 23.200912674578518, 21.882687042156846, 33.951461405803755, 33.44517346223195, 33.79386855040987, 29.273603995641068, 29.37993201365073, 29.262413204958037, 41.037309750914574, 40.935595616698265, 40.01595935225487, 12.883312063912541, 12.762068672726542, 12.256936425964028, 37.965551671882466, 38.25559005265434, 37.94119743754466, 24.609667892257363, 25.001209835211426, 25.19457979189852, 29.560529475410775, 29.90338684742649, 29.346937050422028, 26.45621151352921, 26.619308229225368, 26.24248298505941, 35.453511491417885, 35.73568991012871, 35.303469985723495, 40.64560165256262, 40.51054438203573, 40.68027777224779, 27.429247934371233, 27.61311861500144, 27.431070402264595, 29.03455504526694, 28.371845607956246, 29.331159734477595, 30.043092478920386, 29.83733783538142, 29.513909714917332, 29.005597678323582, 29.328409412254885, 28.919368048508957, 31.193661838769913, 32.060554176568985, 31.70887939631939, 37.08658537144461, 36.763551163176686, 36.839079579959304, -99.36829576889674, -99.00137482831876, -113.62892548243205, 9.731482421513647, 9.666311915963888, 8.75867147743702, 37.87780230616529, 37.80931366359194, 37.03680511315663, 33.3070108157893, 32.85510257383187, 33.39637801547845, 25.785806770126015, 25.91719385671118, 25.510287428895623, 24.66995234539111, 24.640209348251418, 24.468114626904324, -72.38801611587405, -73.64135399460793, -83.48764456808567, 33.10611689090729, 33.662081114947796, 33.50070418417454, 27.559826766451195, 26.635787059863404, 27.8310382378598, -99.0638324742516, -98.96543198575577, -119.40362890561423, 26.602925820897013, 25.683284918467194, 26.716274241606385, 24.05098259697357, 24.163832052300364, 24.061419929067284, 12.161031470013157, 12.128809362029031, 11.981963680436209, 38.57750702276826, 37.944085985422134, 38.57529569044709, 28.530448361144707, 28.3449175444742, 28.265063134332493, 24.136361141999558, 24.98055115093787, 25.361937077095106, 28.75955567508936, 28.54299359768629, 28.719055753201246, 35.67530207335949, 35.3567610681057, 35.84382399916649]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1456784322605238, "mean_inference_ms": 0.7009282656276392, "mean_action_processing_ms": 0.0964882331609507, "mean_env_wait_ms": 0.8120758364992738, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 345000, "timesteps_this_iter": 0, "agent_timesteps_total": 1035000, "timers": {"sample_time_ms": 10461.677, "sample_throughput": 477.935, "load_time_ms": 0.101, "load_throughput": 49414514.609, "learn_time_ms": 1918.412, "learn_throughput": 2606.322, "update_time_ms": 9.003}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 0.0005000000000000001, "total_loss": 93.04164047241211, "policy_loss": -0.003913663547306001, "vf_loss": 93.12126312255859, "vf_explained_var": 0.0859708845615387, "kl": 0.005901570821888764, "entropy": 7.571042203903199, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 345000, "num_agent_steps_sampled": 1035000, "num_steps_trained": 345000, "num_agent_steps_trained": 1035000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1349, "training_iteration": 69, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-13-52", "timestamp": 1706231632, "time_this_iter_s": 10.618957757949829, "time_total_s": 749.5079925060272, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402417160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 749.5079925060272, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 8.006666666666668, "ram_util_percent": 59.53333333333333}}
{"episode_reward_max": 127.58705449150875, "episode_reward_min": -328.18724614102393, "episode_reward_mean": 58.472790879878445, "episode_len_mean": 483.14, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -125.79439838727316}, "policy_reward_max": {"shared_policy": 42.75542270811275}, "policy_reward_mean": {"shared_policy": 19.49093029329281}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.62424014788118, 76.05722202174366, 62.12374275876209, 66.70446521788836, 57.311488057486685, 127.58705449150875, 67.68387200683354, 47.83811668679117, 76.6060167159885, 56.410822942852974, 56.508616939187036, 75.75221336632966, 76.23602240905166, 62.90883161500095, 64.85097013041374, 63.15531488601117, 77.79576033726335, 83.72954642772675, 83.95147305727002, 78.42671695351599, 48.795795453712344, 84.62615496292709, 69.63081831112503, 71.10898739844558, 80.56085765734312, 84.49485181272028, 85.86921275779603, 91.96152812615034, 29.089690114371464, 63.18359397817403, 79.82451562210917, 74.71648566797376, 72.13044527545568, -15.719161249697237, 41.9352146682795, 74.37078985571858, 79.17684424668548, 91.64266718551514, -325.0253613963723, 82.42115525808184, 72.31504999753086, 72.08296935260293, 85.84163487050681, 83.92157416045663, 95.47463209182023, 50.24651142209768, 10.47191570699215, 120.01008537784219, 107.09087535738942, 76.06210266053675, 79.8427950143814, 86.22026307228951, 82.5568866729736, 38.558629950042786, -328.18724614102393, 68.00015636812893, 101.19050341844557, 87.91594921424984, 121.9888647198677, 37.90231716260311, 114.16233916208147, 74.80545751936731, 88.81085337325929, 79.31800272781399, 106.4926713872701, 121.83642380684614, 82.47343695163727, 86.73756038770078, 89.39434002921914, 87.25337513908742, 94.96309541165829, 110.6892161145806, -311.99859607964754, 28.156465814914554, 112.72392108291386, 99.55849140509962, 77.21328805573282, 73.77827632054685, -229.51701467856765, 100.26890219002962, 82.0266520641744, -317.43289336562157, 79.00248498097059, 72.27623457834122, 36.2718045124784, 115.09688869863749, 85.1404290399514, 74.47884937003253, 86.0216050259769, 106.87588714063168, 77.8176616616547, 49.708325214683995, 92.7182572353631, 70.24567451048642, 101.91626900061962, 80.99006369709966, 103.47153462283313, 88.10558322817087, 40.748050105758, 83.11515721830074], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 81, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 494, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [25.460246747049183, 25.241429309050233, 24.922564091781766, 25.522905005142093, 25.253474585711956, 25.280842430889606, 21.006999499630183, 20.59804628789425, 20.51869697123766, 22.37243153527379, 22.30356566980481, 22.028468012809753, 19.08484088505307, 19.24767372912416, 18.978973443309457, 42.53240009024739, 42.75542270811275, 42.29923169314861, 22.839227394511298, 22.048230712612465, 22.796413899709776, 15.927961868544415, 16.212081917872027, 15.698072900374726, 25.539155313124255, 25.59941461247702, 25.46744679038723, 18.91281172633171, 18.384413570165634, 19.11359764635563, 18.837761004765824, 18.928324823578194, 18.742531110843018, 24.874083658059433, 25.44176462789376, 25.43636508037646, 25.73488199338317, 24.840725466609, 25.660414949059486, 20.869711359341935, 20.860804600020245, 21.17831565563877, 21.75349684773633, 21.35093884418407, 21.74653443849334, 21.25670827956249, 20.76154377808173, 21.13706282836695, 26.25344979390502, 25.503684103488922, 26.038626439869404, 28.403060108423233, 26.99473750591278, 28.331748813390732, 28.187944183746964, 27.89092634121576, 27.872602532307297, 26.209192869563893, 26.02770324548085, 26.18982083847125, 16.55819512717426, 16.04929120093584, 16.188309125602245, 28.265852620204285, 27.75296180446942, 28.607340538253382, 23.56713957463701, 22.754706492026642, 23.308972244461373, 23.729686523477227, 23.370013172427804, 24.009287702540547, 27.2494577007989, 27.031098301211983, 26.280301655332238, 28.49068323274453, 28.12099116047223, 27.883177419503525, 28.78831931141515, 28.301838782926396, 28.779054663454488, 31.183144620309264, 30.67067280660072, 30.107710699240357, 10.474768638921276, 9.447268908222512, 9.167652567227677, 21.289947517216206, 20.55657133460045, 21.337075126357377, 26.973734449595213, 25.968590795993805, 26.882190376520157, 24.576196417212486, 25.157063461840153, 24.983225788921118, 23.949764164785535, 24.08835770438114, 24.09232340628901, -5.138515007992595, -5.459744145472854, -5.120902096231788, 14.126806884383157, 13.58118439217408, 14.227223391722262, 25.03500278169909, 24.938089242825896, 24.397697831193597, 26.321557487050683, 26.441305881987006, 26.413980877647788, 30.750053400794656, 30.839471301684767, 30.053142483035714, -104.91910141333938, -115.11709178239107, -104.98916820064187, 27.468094135945037, 27.533269090888396, 27.419792031248406, 23.86194023986657, 23.822918867071465, 24.63019089059283, 24.13074218730131, 24.14289833108583, 23.80932883421579, 28.75216568851222, 28.513466795285538, 28.57600238670905, 27.472674484054238, 28.28182631234327, 28.16707336405912, 31.474879970153168, 32.20837655415137, 31.791375567515686, 17.03674566745758, 16.966268949210644, 16.24349680542946, 3.669140547513962, 3.4307622015476227, 3.372012957930565, 39.64458613097668, 40.39673280343413, 39.96876644343138, 35.780967275301606, 35.724834265808255, 35.58507381627956, 25.159630355735615, 25.30509903033574, 25.597373274465397, 26.685104702909783, 26.528502588470772, 26.62918772300084, 29.082093124588326, 29.239518625972167, 27.89865132172902, 27.526544022063405, 27.707374605039746, 27.322968045870454, 12.787917683521897, 13.570520818388701, 12.200191448132188, -101.7217713346084, -100.6710764191424, -125.79439838727316, 22.916556651393563, 23.200912674578518, 21.882687042156846, 33.951461405803755, 33.44517346223195, 33.79386855040987, 29.273603995641068, 29.37993201365073, 29.262413204958037, 41.037309750914574, 40.935595616698265, 40.01595935225487, 12.883312063912541, 12.762068672726542, 12.256936425964028, 37.965551671882466, 38.25559005265434, 37.94119743754466, 24.609667892257363, 25.001209835211426, 25.19457979189852, 29.560529475410775, 29.90338684742649, 29.346937050422028, 26.45621151352921, 26.619308229225368, 26.24248298505941, 35.453511491417885, 35.73568991012871, 35.303469985723495, 40.64560165256262, 40.51054438203573, 40.68027777224779, 27.429247934371233, 27.61311861500144, 27.431070402264595, 29.03455504526694, 28.371845607956246, 29.331159734477595, 30.043092478920386, 29.83733783538142, 29.513909714917332, 29.005597678323582, 29.328409412254885, 28.919368048508957, 31.193661838769913, 32.060554176568985, 31.70887939631939, 37.08658537144461, 36.763551163176686, 36.839079579959304, -99.36829576889674, -99.00137482831876, -113.62892548243205, 9.731482421513647, 9.666311915963888, 8.75867147743702, 37.87780230616529, 37.80931366359194, 37.03680511315663, 33.3070108157893, 32.85510257383187, 33.39637801547845, 25.785806770126015, 25.91719385671118, 25.510287428895623, 24.66995234539111, 24.640209348251418, 24.468114626904324, -72.38801611587405, -73.64135399460793, -83.48764456808567, 33.10611689090729, 33.662081114947796, 33.50070418417454, 27.559826766451195, 26.635787059863404, 27.8310382378598, -99.0638324742516, -98.96543198575577, -119.40362890561423, 26.602925820897013, 25.683284918467194, 26.716274241606385, 24.05098259697357, 24.163832052300364, 24.061419929067284, 12.161031470013157, 12.128809362029031, 11.981963680436209, 38.57750702276826, 37.944085985422134, 38.57529569044709, 28.530448361144707, 28.3449175444742, 28.265063134332493, 24.136361141999558, 24.98055115093787, 25.361937077095106, 28.75955567508936, 28.54299359768629, 28.719055753201246, 35.67530207335949, 35.3567610681057, 35.84382399916649, 25.193277855714157, 26.325178115939096, 26.299205690001443, 16.523369645078972, 16.753416304786995, 16.431539264818028, 30.762097808221966, 31.02231936591366, 30.93384006122747, 22.855066791176796, 23.67322893254459, 23.71737878676504, 34.152867710838706, 34.236484850446374, 33.52691643933454, 27.162839310864598, 26.912421161929757, 26.914803224305302, 34.943371606990695, 34.784967094659805, 33.74319592118263, 29.432124607264996, 29.32510606944561, 29.348352551460266, 13.774288220641509, 13.547438116123274, 13.426323768993214, 27.65584689192474, 27.776517906808294, 27.682792419567704]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14552975825253398, "mean_inference_ms": 0.7006312230137038, "mean_action_processing_ms": 0.0964682343629277, "mean_env_wait_ms": 0.8115892519951078, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 350000, "timesteps_this_iter": 0, "agent_timesteps_total": 1050000, "timers": {"sample_time_ms": 10449.338, "sample_throughput": 478.499, "load_time_ms": 0.101, "load_throughput": 49414514.609, "learn_time_ms": 1930.846, "learn_throughput": 2589.538, "update_time_ms": 8.95}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 0.0005000000000000001, "total_loss": 8.040611791610718, "policy_loss": -0.0022421241943813897, "vf_loss": 8.119441890716553, "vf_explained_var": -0.20457085371017455, "kl": 0.00269543440664246, "entropy": 7.658799076080323, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 350000, "num_agent_steps_sampled": 1050000, "num_steps_trained": 350000, "num_agent_steps_trained": 1050000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1359, "training_iteration": 70, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-14-03", "timestamp": 1706231643, "time_this_iter_s": 10.370915651321411, "time_total_s": 759.8789081573486, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402E085E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 759.8789081573486, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 5.76, "ram_util_percent": 59.64666666666668}}
{"episode_reward_max": 121.9888647198677, "episode_reward_min": -328.18724614102393, "episode_reward_mean": 56.7668109200547, "episode_len_mean": 478.75, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -125.79439838727316}, "policy_reward_max": {"shared_policy": 41.037309750914574}, "policy_reward_mean": {"shared_policy": 18.922270306684894}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.508616939187036, 75.75221336632966, 76.23602240905166, 62.90883161500095, 64.85097013041374, 63.15531488601117, 77.79576033726335, 83.72954642772675, 83.95147305727002, 78.42671695351599, 48.795795453712344, 84.62615496292709, 69.63081831112503, 71.10898739844558, 80.56085765734312, 84.49485181272028, 85.86921275779603, 91.96152812615034, 29.089690114371464, 63.18359397817403, 79.82451562210917, 74.71648566797376, 72.13044527545568, -15.719161249697237, 41.9352146682795, 74.37078985571858, 79.17684424668548, 91.64266718551514, -325.0253613963723, 82.42115525808184, 72.31504999753086, 72.08296935260293, 85.84163487050681, 83.92157416045663, 95.47463209182023, 50.24651142209768, 10.47191570699215, 120.01008537784219, 107.09087535738942, 76.06210266053675, 79.8427950143814, 86.22026307228951, 82.5568866729736, 38.558629950042786, -328.18724614102393, 68.00015636812893, 101.19050341844557, 87.91594921424984, 121.9888647198677, 37.90231716260311, 114.16233916208147, 74.80545751936731, 88.81085337325929, 79.31800272781399, 106.4926713872701, 121.83642380684614, 82.47343695163727, 86.73756038770078, 89.39434002921914, 87.25337513908742, 94.96309541165829, 110.6892161145806, -311.99859607964754, 28.156465814914554, 112.72392108291386, 99.55849140509962, 77.21328805573282, 73.77827632054685, -229.51701467856765, 100.26890219002962, 82.0266520641744, -317.43289336562157, 79.00248498097059, 72.27623457834122, 36.2718045124784, 115.09688869863749, 85.1404290399514, 74.47884937003253, 86.0216050259769, 106.87588714063168, 77.8176616616547, 49.708325214683995, 92.7182572353631, 70.24567451048642, 101.91626900061962, 80.99006369709966, 103.47153462283313, 88.10558322817087, 40.748050105758, 83.11515721830074, 93.49321932019663, 69.70300386473534, 107.95480398088691, -301.8653837442398, 92.12605812586841, 97.62664442835373, 101.23546719923615, 101.56525055132803, 83.35264302557331, 98.15733831342368], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 81, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 494, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 61, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [18.837761004765824, 18.928324823578194, 18.742531110843018, 24.874083658059433, 25.44176462789376, 25.43636508037646, 25.73488199338317, 24.840725466609, 25.660414949059486, 20.869711359341935, 20.860804600020245, 21.17831565563877, 21.75349684773633, 21.35093884418407, 21.74653443849334, 21.25670827956249, 20.76154377808173, 21.13706282836695, 26.25344979390502, 25.503684103488922, 26.038626439869404, 28.403060108423233, 26.99473750591278, 28.331748813390732, 28.187944183746964, 27.89092634121576, 27.872602532307297, 26.209192869563893, 26.02770324548085, 26.18982083847125, 16.55819512717426, 16.04929120093584, 16.188309125602245, 28.265852620204285, 27.75296180446942, 28.607340538253382, 23.56713957463701, 22.754706492026642, 23.308972244461373, 23.729686523477227, 23.370013172427804, 24.009287702540547, 27.2494577007989, 27.031098301211983, 26.280301655332238, 28.49068323274453, 28.12099116047223, 27.883177419503525, 28.78831931141515, 28.301838782926396, 28.779054663454488, 31.183144620309264, 30.67067280660072, 30.107710699240357, 10.474768638921276, 9.447268908222512, 9.167652567227677, 21.289947517216206, 20.55657133460045, 21.337075126357377, 26.973734449595213, 25.968590795993805, 26.882190376520157, 24.576196417212486, 25.157063461840153, 24.983225788921118, 23.949764164785535, 24.08835770438114, 24.09232340628901, -5.138515007992595, -5.459744145472854, -5.120902096231788, 14.126806884383157, 13.58118439217408, 14.227223391722262, 25.03500278169909, 24.938089242825896, 24.397697831193597, 26.321557487050683, 26.441305881987006, 26.413980877647788, 30.750053400794656, 30.839471301684767, 30.053142483035714, -104.91910141333938, -115.11709178239107, -104.98916820064187, 27.468094135945037, 27.533269090888396, 27.419792031248406, 23.86194023986657, 23.822918867071465, 24.63019089059283, 24.13074218730131, 24.14289833108583, 23.80932883421579, 28.75216568851222, 28.513466795285538, 28.57600238670905, 27.472674484054238, 28.28182631234327, 28.16707336405912, 31.474879970153168, 32.20837655415137, 31.791375567515686, 17.03674566745758, 16.966268949210644, 16.24349680542946, 3.669140547513962, 3.4307622015476227, 3.372012957930565, 39.64458613097668, 40.39673280343413, 39.96876644343138, 35.780967275301606, 35.724834265808255, 35.58507381627956, 25.159630355735615, 25.30509903033574, 25.597373274465397, 26.685104702909783, 26.528502588470772, 26.62918772300084, 29.082093124588326, 29.239518625972167, 27.89865132172902, 27.526544022063405, 27.707374605039746, 27.322968045870454, 12.787917683521897, 13.570520818388701, 12.200191448132188, -101.7217713346084, -100.6710764191424, -125.79439838727316, 22.916556651393563, 23.200912674578518, 21.882687042156846, 33.951461405803755, 33.44517346223195, 33.79386855040987, 29.273603995641068, 29.37993201365073, 29.262413204958037, 41.037309750914574, 40.935595616698265, 40.01595935225487, 12.883312063912541, 12.762068672726542, 12.256936425964028, 37.965551671882466, 38.25559005265434, 37.94119743754466, 24.609667892257363, 25.001209835211426, 25.19457979189852, 29.560529475410775, 29.90338684742649, 29.346937050422028, 26.45621151352921, 26.619308229225368, 26.24248298505941, 35.453511491417885, 35.73568991012871, 35.303469985723495, 40.64560165256262, 40.51054438203573, 40.68027777224779, 27.429247934371233, 27.61311861500144, 27.431070402264595, 29.03455504526694, 28.371845607956246, 29.331159734477595, 30.043092478920386, 29.83733783538142, 29.513909714917332, 29.005597678323582, 29.328409412254885, 28.919368048508957, 31.193661838769913, 32.060554176568985, 31.70887939631939, 37.08658537144461, 36.763551163176686, 36.839079579959304, -99.36829576889674, -99.00137482831876, -113.62892548243205, 9.731482421513647, 9.666311915963888, 8.75867147743702, 37.87780230616529, 37.80931366359194, 37.03680511315663, 33.3070108157893, 32.85510257383187, 33.39637801547845, 25.785806770126015, 25.91719385671118, 25.510287428895623, 24.66995234539111, 24.640209348251418, 24.468114626904324, -72.38801611587405, -73.64135399460793, -83.48764456808567, 33.10611689090729, 33.662081114947796, 33.50070418417454, 27.559826766451195, 26.635787059863404, 27.8310382378598, -99.0638324742516, -98.96543198575577, -119.40362890561423, 26.602925820897013, 25.683284918467194, 26.716274241606385, 24.05098259697357, 24.163832052300364, 24.061419929067284, 12.161031470013157, 12.128809362029031, 11.981963680436209, 38.57750702276826, 37.944085985422134, 38.57529569044709, 28.530448361144707, 28.3449175444742, 28.265063134332493, 24.136361141999558, 24.98055115093787, 25.361937077095106, 28.75955567508936, 28.54299359768629, 28.719055753201246, 35.67530207335949, 35.3567610681057, 35.84382399916649, 25.193277855714157, 26.325178115939096, 26.299205690001443, 16.523369645078972, 16.753416304786995, 16.431539264818028, 30.762097808221966, 31.02231936591366, 30.93384006122747, 22.855066791176796, 23.67322893254459, 23.71737878676504, 34.152867710838706, 34.236484850446374, 33.52691643933454, 27.162839310864598, 26.912421161929757, 26.914803224305302, 34.943371606990695, 34.784967094659805, 33.74319592118263, 29.432124607264996, 29.32510606944561, 29.348352551460266, 13.774288220641509, 13.547438116123274, 13.426323768993214, 27.65584689192474, 27.776517906808294, 27.682792419567704, 31.543239209024847, 30.646907846132905, 31.303072265038878, 23.535821086416632, 22.697997132937104, 23.4691856453816, 36.110474968949944, 36.17315867791572, 35.67117033402124, -97.82429029047489, -107.1578637957573, -96.88322965800762, 30.91585883560279, 30.322559947768838, 30.887639342496783, 32.8349355404886, 32.56161025787392, 32.230098629991204, 33.622034795582294, 33.66597168892622, 33.94746071472764, 33.851182526598365, 33.83191799807051, 33.88215002665916, 27.73789847890535, 27.913330778634787, 27.701413768033177, 32.621066585183144, 32.4230762720108, 33.11319545622973]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14538133205634454, "mean_inference_ms": 0.70032411600561, "mean_action_processing_ms": 0.09644721594282844, "mean_env_wait_ms": 0.8110745108087012, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 355000, "timesteps_this_iter": 0, "agent_timesteps_total": 1065000, "timers": {"sample_time_ms": 10457.334, "sample_throughput": 478.133, "load_time_ms": 0.101, "load_throughput": 49414514.609, "learn_time_ms": 1940.751, "learn_throughput": 2576.323, "update_time_ms": 8.935}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.881784197001253e-17, "cur_lr": 0.0005000000000000001, "total_loss": 55.31152076721192, "policy_loss": -0.0017785857983193543, "vf_loss": 55.390010070800784, "vf_explained_var": -0.01146247386932373, "kl": 0.004921110591395307, "entropy": 7.671101045608521, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 355000, "num_agent_steps_sampled": 1065000, "num_steps_trained": 355000, "num_agent_steps_trained": 1065000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1369, "training_iteration": 71, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-14-13", "timestamp": 1706231653, "time_this_iter_s": 10.584677457809448, "time_total_s": 770.4635856151581, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D78550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 770.4635856151581, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 7.513333333333333, "ram_util_percent": 59.66}}
{"episode_reward_max": 121.9888647198677, "episode_reward_min": -328.18724614102393, "episode_reward_mean": 57.78271915271805, "episode_len_mean": 478.75, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -125.79439838727316}, "policy_reward_max": {"shared_policy": 41.037309750914574}, "policy_reward_mean": {"shared_policy": 19.260906384239345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.795795453712344, 84.62615496292709, 69.63081831112503, 71.10898739844558, 80.56085765734312, 84.49485181272028, 85.86921275779603, 91.96152812615034, 29.089690114371464, 63.18359397817403, 79.82451562210917, 74.71648566797376, 72.13044527545568, -15.719161249697237, 41.9352146682795, 74.37078985571858, 79.17684424668548, 91.64266718551514, -325.0253613963723, 82.42115525808184, 72.31504999753086, 72.08296935260293, 85.84163487050681, 83.92157416045663, 95.47463209182023, 50.24651142209768, 10.47191570699215, 120.01008537784219, 107.09087535738942, 76.06210266053675, 79.8427950143814, 86.22026307228951, 82.5568866729736, 38.558629950042786, -328.18724614102393, 68.00015636812893, 101.19050341844557, 87.91594921424984, 121.9888647198677, 37.90231716260311, 114.16233916208147, 74.80545751936731, 88.81085337325929, 79.31800272781399, 106.4926713872701, 121.83642380684614, 82.47343695163727, 86.73756038770078, 89.39434002921914, 87.25337513908742, 94.96309541165829, 110.6892161145806, -311.99859607964754, 28.156465814914554, 112.72392108291386, 99.55849140509962, 77.21328805573282, 73.77827632054685, -229.51701467856765, 100.26890219002962, 82.0266520641744, -317.43289336562157, 79.00248498097059, 72.27623457834122, 36.2718045124784, 115.09688869863749, 85.1404290399514, 74.47884937003253, 86.0216050259769, 106.87588714063168, 77.8176616616547, 49.708325214683995, 92.7182572353631, 70.24567451048642, 101.91626900061962, 80.99006369709966, 103.47153462283313, 88.10558322817087, 40.748050105758, 83.11515721830074, 93.49321932019663, 69.70300386473534, 107.95480398088691, -301.8653837442398, 92.12605812586841, 97.62664442835373, 101.23546719923615, 101.56525055132803, 83.35264302557331, 98.15733831342368, 60.7432289943099, 71.92860092408952, 70.62614475004372, 103.29286750848404, 108.00615117364211, 69.98538745939729, 80.38083742186427, 89.616314727813, 81.67361507564782, 88.65314135281368], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 81, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 494, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 61, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [16.55819512717426, 16.04929120093584, 16.188309125602245, 28.265852620204285, 27.75296180446942, 28.607340538253382, 23.56713957463701, 22.754706492026642, 23.308972244461373, 23.729686523477227, 23.370013172427804, 24.009287702540547, 27.2494577007989, 27.031098301211983, 26.280301655332238, 28.49068323274453, 28.12099116047223, 27.883177419503525, 28.78831931141515, 28.301838782926396, 28.779054663454488, 31.183144620309264, 30.67067280660072, 30.107710699240357, 10.474768638921276, 9.447268908222512, 9.167652567227677, 21.289947517216206, 20.55657133460045, 21.337075126357377, 26.973734449595213, 25.968590795993805, 26.882190376520157, 24.576196417212486, 25.157063461840153, 24.983225788921118, 23.949764164785535, 24.08835770438114, 24.09232340628901, -5.138515007992595, -5.459744145472854, -5.120902096231788, 14.126806884383157, 13.58118439217408, 14.227223391722262, 25.03500278169909, 24.938089242825896, 24.397697831193597, 26.321557487050683, 26.441305881987006, 26.413980877647788, 30.750053400794656, 30.839471301684767, 30.053142483035714, -104.91910141333938, -115.11709178239107, -104.98916820064187, 27.468094135945037, 27.533269090888396, 27.419792031248406, 23.86194023986657, 23.822918867071465, 24.63019089059283, 24.13074218730131, 24.14289833108583, 23.80932883421579, 28.75216568851222, 28.513466795285538, 28.57600238670905, 27.472674484054238, 28.28182631234327, 28.16707336405912, 31.474879970153168, 32.20837655415137, 31.791375567515686, 17.03674566745758, 16.966268949210644, 16.24349680542946, 3.669140547513962, 3.4307622015476227, 3.372012957930565, 39.64458613097668, 40.39673280343413, 39.96876644343138, 35.780967275301606, 35.724834265808255, 35.58507381627956, 25.159630355735615, 25.30509903033574, 25.597373274465397, 26.685104702909783, 26.528502588470772, 26.62918772300084, 29.082093124588326, 29.239518625972167, 27.89865132172902, 27.526544022063405, 27.707374605039746, 27.322968045870454, 12.787917683521897, 13.570520818388701, 12.200191448132188, -101.7217713346084, -100.6710764191424, -125.79439838727316, 22.916556651393563, 23.200912674578518, 21.882687042156846, 33.951461405803755, 33.44517346223195, 33.79386855040987, 29.273603995641068, 29.37993201365073, 29.262413204958037, 41.037309750914574, 40.935595616698265, 40.01595935225487, 12.883312063912541, 12.762068672726542, 12.256936425964028, 37.965551671882466, 38.25559005265434, 37.94119743754466, 24.609667892257363, 25.001209835211426, 25.19457979189852, 29.560529475410775, 29.90338684742649, 29.346937050422028, 26.45621151352921, 26.619308229225368, 26.24248298505941, 35.453511491417885, 35.73568991012871, 35.303469985723495, 40.64560165256262, 40.51054438203573, 40.68027777224779, 27.429247934371233, 27.61311861500144, 27.431070402264595, 29.03455504526694, 28.371845607956246, 29.331159734477595, 30.043092478920386, 29.83733783538142, 29.513909714917332, 29.005597678323582, 29.328409412254885, 28.919368048508957, 31.193661838769913, 32.060554176568985, 31.70887939631939, 37.08658537144461, 36.763551163176686, 36.839079579959304, -99.36829576889674, -99.00137482831876, -113.62892548243205, 9.731482421513647, 9.666311915963888, 8.75867147743702, 37.87780230616529, 37.80931366359194, 37.03680511315663, 33.3070108157893, 32.85510257383187, 33.39637801547845, 25.785806770126015, 25.91719385671118, 25.510287428895623, 24.66995234539111, 24.640209348251418, 24.468114626904324, -72.38801611587405, -73.64135399460793, -83.48764456808567, 33.10611689090729, 33.662081114947796, 33.50070418417454, 27.559826766451195, 26.635787059863404, 27.8310382378598, -99.0638324742516, -98.96543198575577, -119.40362890561423, 26.602925820897013, 25.683284918467194, 26.716274241606385, 24.05098259697357, 24.163832052300364, 24.061419929067284, 12.161031470013157, 12.128809362029031, 11.981963680436209, 38.57750702276826, 37.944085985422134, 38.57529569044709, 28.530448361144707, 28.3449175444742, 28.265063134332493, 24.136361141999558, 24.98055115093787, 25.361937077095106, 28.75955567508936, 28.54299359768629, 28.719055753201246, 35.67530207335949, 35.3567610681057, 35.84382399916649, 25.193277855714157, 26.325178115939096, 26.299205690001443, 16.523369645078972, 16.753416304786995, 16.431539264818028, 30.762097808221966, 31.02231936591366, 30.93384006122747, 22.855066791176796, 23.67322893254459, 23.71737878676504, 34.152867710838706, 34.236484850446374, 33.52691643933454, 27.162839310864598, 26.912421161929757, 26.914803224305302, 34.943371606990695, 34.784967094659805, 33.74319592118263, 29.432124607264996, 29.32510606944561, 29.348352551460266, 13.774288220641509, 13.547438116123274, 13.426323768993214, 27.65584689192474, 27.776517906808294, 27.682792419567704, 31.543239209024847, 30.646907846132905, 31.303072265038878, 23.535821086416632, 22.697997132937104, 23.4691856453816, 36.110474968949944, 36.17315867791572, 35.67117033402124, -97.82429029047489, -107.1578637957573, -96.88322965800762, 30.91585883560279, 30.322559947768838, 30.887639342496783, 32.8349355404886, 32.56161025787392, 32.230098629991204, 33.622034795582294, 33.66597168892622, 33.94746071472764, 33.851182526598365, 33.83191799807051, 33.88215002665916, 27.73789847890535, 27.913330778634787, 27.701413768033177, 32.621066585183144, 32.4230762720108, 33.11319545622973, 20.56167784333229, 20.715067826211452, 19.46648332476616, 24.071857719371707, 23.628721977273614, 24.228021227444202, 23.07096546391645, 24.12429065319398, 23.43088863293329, 34.73953887269211, 34.50129908074935, 34.05202955504258, 36.30747720512832, 35.549915621678025, 36.14875834683576, 23.372172261277825, 23.301295931140572, 23.31191926697889, 26.681818157434464, 26.68596552312374, 27.013053741306067, 29.952842976897955, 29.599723026156425, 30.063748724758625, 26.800701340039566, 27.394187731047467, 27.478726004560784, 29.3628383030494, 29.61164930587013, 29.678653743894145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14523705873211057, "mean_inference_ms": 0.7000468373330552, "mean_action_processing_ms": 0.09644124637344913, "mean_env_wait_ms": 0.8105686492540468, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 360000, "timesteps_this_iter": 0, "agent_timesteps_total": 1080000, "timers": {"sample_time_ms": 10446.532, "sample_throughput": 478.628, "load_time_ms": 0.203, "load_throughput": 24652074.762, "learn_time_ms": 1944.669, "learn_throughput": 2571.131, "update_time_ms": 9.026}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.4408920985006264e-17, "cur_lr": 0.0005000000000000001, "total_loss": 5.362585592269897, "policy_loss": -0.0028602969967139293, "vf_loss": 5.443321466445923, "vf_explained_var": -0.5331023335456848, "kl": 0.004270311596348197, "entropy": 7.787565279006958, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 360000, "num_agent_steps_sampled": 1080000, "num_steps_trained": 360000, "num_agent_steps_trained": 1080000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1379, "training_iteration": 72, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-14-24", "timestamp": 1706231664, "time_this_iter_s": 10.545085668563843, "time_total_s": 781.0086712837219, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402DE5160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 781.0086712837219, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 7.046666666666665, "ram_util_percent": 59.71333333333334}}
{"episode_reward_max": 121.9888647198677, "episode_reward_min": -328.18724614102393, "episode_reward_mean": 59.61928225558177, "episode_len_mean": 478.75, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -125.79439838727316}, "policy_reward_max": {"shared_policy": 41.037309750914574}, "policy_reward_mean": {"shared_policy": 19.873094085193923}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.82451562210917, 74.71648566797376, 72.13044527545568, -15.719161249697237, 41.9352146682795, 74.37078985571858, 79.17684424668548, 91.64266718551514, -325.0253613963723, 82.42115525808184, 72.31504999753086, 72.08296935260293, 85.84163487050681, 83.92157416045663, 95.47463209182023, 50.24651142209768, 10.47191570699215, 120.01008537784219, 107.09087535738942, 76.06210266053675, 79.8427950143814, 86.22026307228951, 82.5568866729736, 38.558629950042786, -328.18724614102393, 68.00015636812893, 101.19050341844557, 87.91594921424984, 121.9888647198677, 37.90231716260311, 114.16233916208147, 74.80545751936731, 88.81085337325929, 79.31800272781399, 106.4926713872701, 121.83642380684614, 82.47343695163727, 86.73756038770078, 89.39434002921914, 87.25337513908742, 94.96309541165829, 110.6892161145806, -311.99859607964754, 28.156465814914554, 112.72392108291386, 99.55849140509962, 77.21328805573282, 73.77827632054685, -229.51701467856765, 100.26890219002962, 82.0266520641744, -317.43289336562157, 79.00248498097059, 72.27623457834122, 36.2718045124784, 115.09688869863749, 85.1404290399514, 74.47884937003253, 86.0216050259769, 106.87588714063168, 77.8176616616547, 49.708325214683995, 92.7182572353631, 70.24567451048642, 101.91626900061962, 80.99006369709966, 103.47153462283313, 88.10558322817087, 40.748050105758, 83.11515721830074, 93.49321932019663, 69.70300386473534, 107.95480398088691, -301.8653837442398, 92.12605812586841, 97.62664442835373, 101.23546719923615, 101.56525055132803, 83.35264302557331, 98.15733831342368, 60.7432289943099, 71.92860092408952, 70.62614475004372, 103.29286750848404, 108.00615117364211, 69.98538745939729, 80.38083742186427, 89.616314727813, 81.67361507564782, 88.65314135281368, 100.7233831696212, 88.67417717352508, 80.68447407335043, 76.41491432860494, 93.40923753380774, 79.7070502452552, 84.03261094167827, 111.53961457870898, 87.92313183471559, 89.86920697987077], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 81, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 494, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 61, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [26.973734449595213, 25.968590795993805, 26.882190376520157, 24.576196417212486, 25.157063461840153, 24.983225788921118, 23.949764164785535, 24.08835770438114, 24.09232340628901, -5.138515007992595, -5.459744145472854, -5.120902096231788, 14.126806884383157, 13.58118439217408, 14.227223391722262, 25.03500278169909, 24.938089242825896, 24.397697831193597, 26.321557487050683, 26.441305881987006, 26.413980877647788, 30.750053400794656, 30.839471301684767, 30.053142483035714, -104.91910141333938, -115.11709178239107, -104.98916820064187, 27.468094135945037, 27.533269090888396, 27.419792031248406, 23.86194023986657, 23.822918867071465, 24.63019089059283, 24.13074218730131, 24.14289833108583, 23.80932883421579, 28.75216568851222, 28.513466795285538, 28.57600238670905, 27.472674484054238, 28.28182631234327, 28.16707336405912, 31.474879970153168, 32.20837655415137, 31.791375567515686, 17.03674566745758, 16.966268949210644, 16.24349680542946, 3.669140547513962, 3.4307622015476227, 3.372012957930565, 39.64458613097668, 40.39673280343413, 39.96876644343138, 35.780967275301606, 35.724834265808255, 35.58507381627956, 25.159630355735615, 25.30509903033574, 25.597373274465397, 26.685104702909783, 26.528502588470772, 26.62918772300084, 29.082093124588326, 29.239518625972167, 27.89865132172902, 27.526544022063405, 27.707374605039746, 27.322968045870454, 12.787917683521897, 13.570520818388701, 12.200191448132188, -101.7217713346084, -100.6710764191424, -125.79439838727316, 22.916556651393563, 23.200912674578518, 21.882687042156846, 33.951461405803755, 33.44517346223195, 33.79386855040987, 29.273603995641068, 29.37993201365073, 29.262413204958037, 41.037309750914574, 40.935595616698265, 40.01595935225487, 12.883312063912541, 12.762068672726542, 12.256936425964028, 37.965551671882466, 38.25559005265434, 37.94119743754466, 24.609667892257363, 25.001209835211426, 25.19457979189852, 29.560529475410775, 29.90338684742649, 29.346937050422028, 26.45621151352921, 26.619308229225368, 26.24248298505941, 35.453511491417885, 35.73568991012871, 35.303469985723495, 40.64560165256262, 40.51054438203573, 40.68027777224779, 27.429247934371233, 27.61311861500144, 27.431070402264595, 29.03455504526694, 28.371845607956246, 29.331159734477595, 30.043092478920386, 29.83733783538142, 29.513909714917332, 29.005597678323582, 29.328409412254885, 28.919368048508957, 31.193661838769913, 32.060554176568985, 31.70887939631939, 37.08658537144461, 36.763551163176686, 36.839079579959304, -99.36829576889674, -99.00137482831876, -113.62892548243205, 9.731482421513647, 9.666311915963888, 8.75867147743702, 37.87780230616529, 37.80931366359194, 37.03680511315663, 33.3070108157893, 32.85510257383187, 33.39637801547845, 25.785806770126015, 25.91719385671118, 25.510287428895623, 24.66995234539111, 24.640209348251418, 24.468114626904324, -72.38801611587405, -73.64135399460793, -83.48764456808567, 33.10611689090729, 33.662081114947796, 33.50070418417454, 27.559826766451195, 26.635787059863404, 27.8310382378598, -99.0638324742516, -98.96543198575577, -119.40362890561423, 26.602925820897013, 25.683284918467194, 26.716274241606385, 24.05098259697357, 24.163832052300364, 24.061419929067284, 12.161031470013157, 12.128809362029031, 11.981963680436209, 38.57750702276826, 37.944085985422134, 38.57529569044709, 28.530448361144707, 28.3449175444742, 28.265063134332493, 24.136361141999558, 24.98055115093787, 25.361937077095106, 28.75955567508936, 28.54299359768629, 28.719055753201246, 35.67530207335949, 35.3567610681057, 35.84382399916649, 25.193277855714157, 26.325178115939096, 26.299205690001443, 16.523369645078972, 16.753416304786995, 16.431539264818028, 30.762097808221966, 31.02231936591366, 30.93384006122747, 22.855066791176796, 23.67322893254459, 23.71737878676504, 34.152867710838706, 34.236484850446374, 33.52691643933454, 27.162839310864598, 26.912421161929757, 26.914803224305302, 34.943371606990695, 34.784967094659805, 33.74319592118263, 29.432124607264996, 29.32510606944561, 29.348352551460266, 13.774288220641509, 13.547438116123274, 13.426323768993214, 27.65584689192474, 27.776517906808294, 27.682792419567704, 31.543239209024847, 30.646907846132905, 31.303072265038878, 23.535821086416632, 22.697997132937104, 23.4691856453816, 36.110474968949944, 36.17315867791572, 35.67117033402124, -97.82429029047489, -107.1578637957573, -96.88322965800762, 30.91585883560279, 30.322559947768838, 30.887639342496783, 32.8349355404886, 32.56161025787392, 32.230098629991204, 33.622034795582294, 33.66597168892622, 33.94746071472764, 33.851182526598365, 33.83191799807051, 33.88215002665916, 27.73789847890535, 27.913330778634787, 27.701413768033177, 32.621066585183144, 32.4230762720108, 33.11319545622973, 20.56167784333229, 20.715067826211452, 19.46648332476616, 24.071857719371707, 23.628721977273614, 24.228021227444202, 23.07096546391645, 24.12429065319398, 23.43088863293329, 34.73953887269211, 34.50129908074935, 34.05202955504258, 36.30747720512832, 35.549915621678025, 36.14875834683576, 23.372172261277825, 23.301295931140572, 23.31191926697889, 26.681818157434464, 26.68596552312374, 27.013053741306067, 29.952842976897955, 29.599723026156425, 30.063748724758625, 26.800701340039566, 27.394187731047467, 27.478726004560784, 29.3628383030494, 29.61164930587013, 29.678653743894145, 33.78577803696194, 33.40884334842363, 33.52876178423563, 29.44387001295884, 29.526714620490864, 29.703592540075377, 26.93553876131773, 26.709630340337753, 27.039304971694946, 25.654904529452324, 25.123161286115646, 25.636848513036966, 31.062910621364907, 31.183312897880867, 31.163014014561966, 26.62798128897944, 26.49493737022081, 26.58413158605495, 28.217767411222056, 27.976779778798416, 27.8380637516578, 37.523390211785824, 36.685972715417535, 37.33025165150562, 29.23639989395936, 29.439002768446997, 29.247729172309235, 29.678028667966515, 30.09998186926046, 30.091196442643792]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14510576006521106, "mean_inference_ms": 0.6997851311059651, "mean_action_processing_ms": 0.09643228911155526, "mean_env_wait_ms": 0.8100396726017096, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 365000, "timesteps_this_iter": 0, "agent_timesteps_total": 1095000, "timers": {"sample_time_ms": 10438.409, "sample_throughput": 479.0, "load_time_ms": 0.203, "load_throughput": 24652074.762, "learn_time_ms": 1949.721, "learn_throughput": 2564.47, "update_time_ms": 9.015}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2204460492503132e-17, "cur_lr": 0.0005000000000000001, "total_loss": 5.188291025161743, "policy_loss": -0.0017750845886014056, "vf_loss": 5.267913293838501, "vf_explained_var": -0.1872378945350647, "kl": 0.0018103180860741578, "entropy": 7.7847260475158695, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 365000, "num_agent_steps_sampled": 1095000, "num_steps_trained": 365000, "num_agent_steps_trained": 1095000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1389, "training_iteration": 73, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-14-34", "timestamp": 1706231674, "time_this_iter_s": 10.25458574295044, "time_total_s": 791.2632570266724, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D298B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 791.2632570266724, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 6.578571428571428, "ram_util_percent": 59.714285714285715}}
{"episode_reward_max": 121.9888647198677, "episode_reward_min": -336.9723215997219, "episode_reward_mean": 61.19831647252125, "episode_len_mean": 478.59, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -127.11464023590088}, "policy_reward_max": {"shared_policy": 41.037309750914574}, "policy_reward_mean": {"shared_policy": 20.399438824173746}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.31504999753086, 72.08296935260293, 85.84163487050681, 83.92157416045663, 95.47463209182023, 50.24651142209768, 10.47191570699215, 120.01008537784219, 107.09087535738942, 76.06210266053675, 79.8427950143814, 86.22026307228951, 82.5568866729736, 38.558629950042786, -328.18724614102393, 68.00015636812893, 101.19050341844557, 87.91594921424984, 121.9888647198677, 37.90231716260311, 114.16233916208147, 74.80545751936731, 88.81085337325929, 79.31800272781399, 106.4926713872701, 121.83642380684614, 82.47343695163727, 86.73756038770078, 89.39434002921914, 87.25337513908742, 94.96309541165829, 110.6892161145806, -311.99859607964754, 28.156465814914554, 112.72392108291386, 99.55849140509962, 77.21328805573282, 73.77827632054685, -229.51701467856765, 100.26890219002962, 82.0266520641744, -317.43289336562157, 79.00248498097059, 72.27623457834122, 36.2718045124784, 115.09688869863749, 85.1404290399514, 74.47884937003253, 86.0216050259769, 106.87588714063168, 77.8176616616547, 49.708325214683995, 92.7182572353631, 70.24567451048642, 101.91626900061962, 80.99006369709966, 103.47153462283313, 88.10558322817087, 40.748050105758, 83.11515721830074, 93.49321932019663, 69.70300386473534, 107.95480398088691, -301.8653837442398, 92.12605812586841, 97.62664442835373, 101.23546719923615, 101.56525055132803, 83.35264302557331, 98.15733831342368, 60.7432289943099, 71.92860092408952, 70.62614475004372, 103.29286750848404, 108.00615117364211, 69.98538745939729, 80.38083742186427, 89.616314727813, 81.67361507564782, 88.65314135281368, 100.7233831696212, 88.67417717352508, 80.68447407335043, 76.41491432860494, 93.40923753380774, 79.7070502452552, 84.03261094167827, 111.53961457870898, 87.92313183471559, 89.86920697987077, 93.76374493353066, 92.81117045879364, 105.25347655196671, 47.784670952707515, 86.51932916603981, 70.54703204426914, 113.62607694044709, 67.18684372678396, -336.9723215997219, 72.85699365288019], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 81, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 494, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 61, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 66, 500], "policy_shared_policy_reward": [23.86194023986657, 23.822918867071465, 24.63019089059283, 24.13074218730131, 24.14289833108583, 23.80932883421579, 28.75216568851222, 28.513466795285538, 28.57600238670905, 27.472674484054238, 28.28182631234327, 28.16707336405912, 31.474879970153168, 32.20837655415137, 31.791375567515686, 17.03674566745758, 16.966268949210644, 16.24349680542946, 3.669140547513962, 3.4307622015476227, 3.372012957930565, 39.64458613097668, 40.39673280343413, 39.96876644343138, 35.780967275301606, 35.724834265808255, 35.58507381627956, 25.159630355735615, 25.30509903033574, 25.597373274465397, 26.685104702909783, 26.528502588470772, 26.62918772300084, 29.082093124588326, 29.239518625972167, 27.89865132172902, 27.526544022063405, 27.707374605039746, 27.322968045870454, 12.787917683521897, 13.570520818388701, 12.200191448132188, -101.7217713346084, -100.6710764191424, -125.79439838727316, 22.916556651393563, 23.200912674578518, 21.882687042156846, 33.951461405803755, 33.44517346223195, 33.79386855040987, 29.273603995641068, 29.37993201365073, 29.262413204958037, 41.037309750914574, 40.935595616698265, 40.01595935225487, 12.883312063912541, 12.762068672726542, 12.256936425964028, 37.965551671882466, 38.25559005265434, 37.94119743754466, 24.609667892257363, 25.001209835211426, 25.19457979189852, 29.560529475410775, 29.90338684742649, 29.346937050422028, 26.45621151352921, 26.619308229225368, 26.24248298505941, 35.453511491417885, 35.73568991012871, 35.303469985723495, 40.64560165256262, 40.51054438203573, 40.68027777224779, 27.429247934371233, 27.61311861500144, 27.431070402264595, 29.03455504526694, 28.371845607956246, 29.331159734477595, 30.043092478920386, 29.83733783538142, 29.513909714917332, 29.005597678323582, 29.328409412254885, 28.919368048508957, 31.193661838769913, 32.060554176568985, 31.70887939631939, 37.08658537144461, 36.763551163176686, 36.839079579959304, -99.36829576889674, -99.00137482831876, -113.62892548243205, 9.731482421513647, 9.666311915963888, 8.75867147743702, 37.87780230616529, 37.80931366359194, 37.03680511315663, 33.3070108157893, 32.85510257383187, 33.39637801547845, 25.785806770126015, 25.91719385671118, 25.510287428895623, 24.66995234539111, 24.640209348251418, 24.468114626904324, -72.38801611587405, -73.64135399460793, -83.48764456808567, 33.10611689090729, 33.662081114947796, 33.50070418417454, 27.559826766451195, 26.635787059863404, 27.8310382378598, -99.0638324742516, -98.96543198575577, -119.40362890561423, 26.602925820897013, 25.683284918467194, 26.716274241606385, 24.05098259697357, 24.163832052300364, 24.061419929067284, 12.161031470013157, 12.128809362029031, 11.981963680436209, 38.57750702276826, 37.944085985422134, 38.57529569044709, 28.530448361144707, 28.3449175444742, 28.265063134332493, 24.136361141999558, 24.98055115093787, 25.361937077095106, 28.75955567508936, 28.54299359768629, 28.719055753201246, 35.67530207335949, 35.3567610681057, 35.84382399916649, 25.193277855714157, 26.325178115939096, 26.299205690001443, 16.523369645078972, 16.753416304786995, 16.431539264818028, 30.762097808221966, 31.02231936591366, 30.93384006122747, 22.855066791176796, 23.67322893254459, 23.71737878676504, 34.152867710838706, 34.236484850446374, 33.52691643933454, 27.162839310864598, 26.912421161929757, 26.914803224305302, 34.943371606990695, 34.784967094659805, 33.74319592118263, 29.432124607264996, 29.32510606944561, 29.348352551460266, 13.774288220641509, 13.547438116123274, 13.426323768993214, 27.65584689192474, 27.776517906808294, 27.682792419567704, 31.543239209024847, 30.646907846132905, 31.303072265038878, 23.535821086416632, 22.697997132937104, 23.4691856453816, 36.110474968949944, 36.17315867791572, 35.67117033402124, -97.82429029047489, -107.1578637957573, -96.88322965800762, 30.91585883560279, 30.322559947768838, 30.887639342496783, 32.8349355404886, 32.56161025787392, 32.230098629991204, 33.622034795582294, 33.66597168892622, 33.94746071472764, 33.851182526598365, 33.83191799807051, 33.88215002665916, 27.73789847890535, 27.913330778634787, 27.701413768033177, 32.621066585183144, 32.4230762720108, 33.11319545622973, 20.56167784333229, 20.715067826211452, 19.46648332476616, 24.071857719371707, 23.628721977273614, 24.228021227444202, 23.07096546391645, 24.12429065319398, 23.43088863293329, 34.73953887269211, 34.50129908074935, 34.05202955504258, 36.30747720512832, 35.549915621678025, 36.14875834683576, 23.372172261277825, 23.301295931140572, 23.31191926697889, 26.681818157434464, 26.68596552312374, 27.013053741306067, 29.952842976897955, 29.599723026156425, 30.063748724758625, 26.800701340039566, 27.394187731047467, 27.478726004560784, 29.3628383030494, 29.61164930587013, 29.678653743894145, 33.78577803696194, 33.40884334842363, 33.52876178423563, 29.44387001295884, 29.526714620490864, 29.703592540075377, 26.93553876131773, 26.709630340337753, 27.039304971694946, 25.654904529452324, 25.123161286115646, 25.636848513036966, 31.062910621364907, 31.183312897880867, 31.163014014561966, 26.62798128897944, 26.49493737022081, 26.58413158605495, 28.217767411222056, 27.976779778798416, 27.8380637516578, 37.523390211785824, 36.685972715417535, 37.33025165150562, 29.23639989395936, 29.439002768446997, 29.247729172309235, 29.678028667966515, 30.09998186926046, 30.091196442643792, 30.951348679761082, 31.354129730413348, 31.45826652335623, 30.964632119983435, 30.98707166686654, 30.859466671943665, 35.20581694870876, 34.96944812561074, 35.078211477647216, 15.755915520091847, 16.04981218402584, 15.978943248589829, 29.033548108030416, 29.035021433567934, 28.45075962444146, 23.5285447537899, 22.850128561258316, 24.168358729220927, 37.962977044284344, 37.485037833452225, 38.178062062710524, 22.454702752331883, 22.23664068679014, 22.49550028766194, -105.00720231235027, -104.85047905147076, -127.11464023590088, 24.293048970401287, 24.44868180155754, 24.115262880921364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1449875483200432, "mean_inference_ms": 0.6994383246523097, "mean_action_processing_ms": 0.09643113409210229, "mean_env_wait_ms": 0.8094774156289722, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 370000, "timesteps_this_iter": 0, "agent_timesteps_total": 1110000, "timers": {"sample_time_ms": 10464.65, "sample_throughput": 477.799, "load_time_ms": 0.354, "load_throughput": 14132704.36, "learn_time_ms": 1956.95, "learn_throughput": 2554.996, "update_time_ms": 9.015}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1102230246251566e-17, "cur_lr": 0.0005000000000000001, "total_loss": 91.22104568481446, "policy_loss": -0.0024631280283132994, "vf_loss": 91.30117721557617, "vf_explained_var": 0.03839905261993408, "kl": 0.004535181238326696, "entropy": 7.766681432723999, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 370000, "num_agent_steps_sampled": 1110000, "num_steps_trained": 370000, "num_agent_steps_trained": 1110000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1399, "training_iteration": 74, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-14-45", "timestamp": 1706231685, "time_this_iter_s": 10.614477396011353, "time_total_s": 801.8777344226837, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D10160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 801.8777344226837, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 8.580000000000002, "ram_util_percent": 59.89999999999999}}
{"episode_reward_max": 128.77330202050513, "episode_reward_min": -336.9723215997219, "episode_reward_mean": 63.41992147949393, "episode_len_mean": 478.59, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -127.11464023590088}, "policy_reward_max": {"shared_policy": 43.21926064587508}, "policy_reward_mean": {"shared_policy": 21.13997382649797}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.8427950143814, 86.22026307228951, 82.5568866729736, 38.558629950042786, -328.18724614102393, 68.00015636812893, 101.19050341844557, 87.91594921424984, 121.9888647198677, 37.90231716260311, 114.16233916208147, 74.80545751936731, 88.81085337325929, 79.31800272781399, 106.4926713872701, 121.83642380684614, 82.47343695163727, 86.73756038770078, 89.39434002921914, 87.25337513908742, 94.96309541165829, 110.6892161145806, -311.99859607964754, 28.156465814914554, 112.72392108291386, 99.55849140509962, 77.21328805573282, 73.77827632054685, -229.51701467856765, 100.26890219002962, 82.0266520641744, -317.43289336562157, 79.00248498097059, 72.27623457834122, 36.2718045124784, 115.09688869863749, 85.1404290399514, 74.47884937003253, 86.0216050259769, 106.87588714063168, 77.8176616616547, 49.708325214683995, 92.7182572353631, 70.24567451048642, 101.91626900061962, 80.99006369709966, 103.47153462283313, 88.10558322817087, 40.748050105758, 83.11515721830074, 93.49321932019663, 69.70300386473534, 107.95480398088691, -301.8653837442398, 92.12605812586841, 97.62664442835373, 101.23546719923615, 101.56525055132803, 83.35264302557331, 98.15733831342368, 60.7432289943099, 71.92860092408952, 70.62614475004372, 103.29286750848404, 108.00615117364211, 69.98538745939729, 80.38083742186427, 89.616314727813, 81.67361507564782, 88.65314135281368, 100.7233831696212, 88.67417717352508, 80.68447407335043, 76.41491432860494, 93.40923753380774, 79.7070502452552, 84.03261094167827, 111.53961457870898, 87.92313183471559, 89.86920697987077, 93.76374493353066, 92.81117045879364, 105.25347655196671, 47.784670952707515, 86.51932916603981, 70.54703204426914, 113.62607694044709, 67.18684372678396, -336.9723215997219, 72.85699365288019, 105.33702733181416, 106.43657712911951, 90.65251857787368, 95.1980167943984, 74.389405220747, 95.95718907937406, 74.72209343127905, 128.77330202050513, 128.16168100433424, 96.0500411055982], "episode_lengths": [500, 500, 500, 500, 81, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 494, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 61, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [26.685104702909783, 26.528502588470772, 26.62918772300084, 29.082093124588326, 29.239518625972167, 27.89865132172902, 27.526544022063405, 27.707374605039746, 27.322968045870454, 12.787917683521897, 13.570520818388701, 12.200191448132188, -101.7217713346084, -100.6710764191424, -125.79439838727316, 22.916556651393563, 23.200912674578518, 21.882687042156846, 33.951461405803755, 33.44517346223195, 33.79386855040987, 29.273603995641068, 29.37993201365073, 29.262413204958037, 41.037309750914574, 40.935595616698265, 40.01595935225487, 12.883312063912541, 12.762068672726542, 12.256936425964028, 37.965551671882466, 38.25559005265434, 37.94119743754466, 24.609667892257363, 25.001209835211426, 25.19457979189852, 29.560529475410775, 29.90338684742649, 29.346937050422028, 26.45621151352921, 26.619308229225368, 26.24248298505941, 35.453511491417885, 35.73568991012871, 35.303469985723495, 40.64560165256262, 40.51054438203573, 40.68027777224779, 27.429247934371233, 27.61311861500144, 27.431070402264595, 29.03455504526694, 28.371845607956246, 29.331159734477595, 30.043092478920386, 29.83733783538142, 29.513909714917332, 29.005597678323582, 29.328409412254885, 28.919368048508957, 31.193661838769913, 32.060554176568985, 31.70887939631939, 37.08658537144461, 36.763551163176686, 36.839079579959304, -99.36829576889674, -99.00137482831876, -113.62892548243205, 9.731482421513647, 9.666311915963888, 8.75867147743702, 37.87780230616529, 37.80931366359194, 37.03680511315663, 33.3070108157893, 32.85510257383187, 33.39637801547845, 25.785806770126015, 25.91719385671118, 25.510287428895623, 24.66995234539111, 24.640209348251418, 24.468114626904324, -72.38801611587405, -73.64135399460793, -83.48764456808567, 33.10611689090729, 33.662081114947796, 33.50070418417454, 27.559826766451195, 26.635787059863404, 27.8310382378598, -99.0638324742516, -98.96543198575577, -119.40362890561423, 26.602925820897013, 25.683284918467194, 26.716274241606385, 24.05098259697357, 24.163832052300364, 24.061419929067284, 12.161031470013157, 12.128809362029031, 11.981963680436209, 38.57750702276826, 37.944085985422134, 38.57529569044709, 28.530448361144707, 28.3449175444742, 28.265063134332493, 24.136361141999558, 24.98055115093787, 25.361937077095106, 28.75955567508936, 28.54299359768629, 28.719055753201246, 35.67530207335949, 35.3567610681057, 35.84382399916649, 25.193277855714157, 26.325178115939096, 26.299205690001443, 16.523369645078972, 16.753416304786995, 16.431539264818028, 30.762097808221966, 31.02231936591366, 30.93384006122747, 22.855066791176796, 23.67322893254459, 23.71737878676504, 34.152867710838706, 34.236484850446374, 33.52691643933454, 27.162839310864598, 26.912421161929757, 26.914803224305302, 34.943371606990695, 34.784967094659805, 33.74319592118263, 29.432124607264996, 29.32510606944561, 29.348352551460266, 13.774288220641509, 13.547438116123274, 13.426323768993214, 27.65584689192474, 27.776517906808294, 27.682792419567704, 31.543239209024847, 30.646907846132905, 31.303072265038878, 23.535821086416632, 22.697997132937104, 23.4691856453816, 36.110474968949944, 36.17315867791572, 35.67117033402124, -97.82429029047489, -107.1578637957573, -96.88322965800762, 30.91585883560279, 30.322559947768838, 30.887639342496783, 32.8349355404886, 32.56161025787392, 32.230098629991204, 33.622034795582294, 33.66597168892622, 33.94746071472764, 33.851182526598365, 33.83191799807051, 33.88215002665916, 27.73789847890535, 27.913330778634787, 27.701413768033177, 32.621066585183144, 32.4230762720108, 33.11319545622973, 20.56167784333229, 20.715067826211452, 19.46648332476616, 24.071857719371707, 23.628721977273614, 24.228021227444202, 23.07096546391645, 24.12429065319398, 23.43088863293329, 34.73953887269211, 34.50129908074935, 34.05202955504258, 36.30747720512832, 35.549915621678025, 36.14875834683576, 23.372172261277825, 23.301295931140572, 23.31191926697889, 26.681818157434464, 26.68596552312374, 27.013053741306067, 29.952842976897955, 29.599723026156425, 30.063748724758625, 26.800701340039566, 27.394187731047467, 27.478726004560784, 29.3628383030494, 29.61164930587013, 29.678653743894145, 33.78577803696194, 33.40884334842363, 33.52876178423563, 29.44387001295884, 29.526714620490864, 29.703592540075377, 26.93553876131773, 26.709630340337753, 27.039304971694946, 25.654904529452324, 25.123161286115646, 25.636848513036966, 31.062910621364907, 31.183312897880867, 31.163014014561966, 26.62798128897944, 26.49493737022081, 26.58413158605495, 28.217767411222056, 27.976779778798416, 27.8380637516578, 37.523390211785824, 36.685972715417535, 37.33025165150562, 29.23639989395936, 29.439002768446997, 29.247729172309235, 29.678028667966515, 30.09998186926046, 30.091196442643792, 30.951348679761082, 31.354129730413348, 31.45826652335623, 30.964632119983435, 30.98707166686654, 30.859466671943665, 35.20581694870876, 34.96944812561074, 35.078211477647216, 15.755915520091847, 16.04981218402584, 15.978943248589829, 29.033548108030416, 29.035021433567934, 28.45075962444146, 23.5285447537899, 22.850128561258316, 24.168358729220927, 37.962977044284344, 37.485037833452225, 38.178062062710524, 22.454702752331883, 22.23664068679014, 22.49550028766194, -105.00720231235027, -104.85047905147076, -127.11464023590088, 24.293048970401287, 24.44868180155754, 24.115262880921364, 35.343862238650516, 35.011284833153084, 34.981880260010556, 35.231299641231686, 35.813738396022615, 35.39153909186521, 30.18863449121514, 30.28079496944943, 30.183089117209107, 31.46487134943405, 31.880881329687924, 31.852264115276427, 25.03295274078846, 24.734640955924988, 24.621811524033546, 32.16319450115164, 31.969806914528206, 31.824187663694218, 24.79610366870959, 24.703004752596215, 25.222985009973243, 43.10043894809981, 42.711140160759285, 42.961722911645964, 42.32416347165902, 42.618256886800125, 43.21926064587508, 32.10077564915021, 32.09333849822481, 31.85592695822318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14487439469788801, "mean_inference_ms": 0.699204882368565, "mean_action_processing_ms": 0.096441994090263, "mean_env_wait_ms": 0.8089748440360082, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 375000, "timesteps_this_iter": 0, "agent_timesteps_total": 1125000, "timers": {"sample_time_ms": 10476.271, "sample_throughput": 477.269, "load_time_ms": 0.354, "load_throughput": 14132704.36, "learn_time_ms": 1975.388, "learn_throughput": 2531.149, "update_time_ms": 9.427}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.551115123125783e-18, "cur_lr": 0.0005000000000000001, "total_loss": 6.462363290786743, "policy_loss": -0.0019900903257436655, "vf_loss": 6.5430398941040036, "vf_explained_var": -0.17233325242996217, "kl": 0.0026626211241934346, "entropy": 7.868659734725952, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 375000, "num_agent_steps_sampled": 1125000, "num_steps_trained": 375000, "num_agent_steps_trained": 1125000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1409, "training_iteration": 75, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-14-56", "timestamp": 1706231696, "time_this_iter_s": 10.542272806167603, "time_total_s": 812.4200072288513, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402417160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 812.4200072288513, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 6.526666666666667, "ram_util_percent": 59.92666666666666}}
{"episode_reward_max": 128.77330202050513, "episode_reward_min": -336.9723215997219, "episode_reward_mean": 68.09039369253311, "episode_len_mean": 482.78, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -127.11464023590088}, "policy_reward_max": {"shared_policy": 43.21926064587508}, "policy_reward_mean": {"shared_policy": 22.696797897511033}, "custom_metrics": {}, "hist_stats": {"episode_reward": [114.16233916208147, 74.80545751936731, 88.81085337325929, 79.31800272781399, 106.4926713872701, 121.83642380684614, 82.47343695163727, 86.73756038770078, 89.39434002921914, 87.25337513908742, 94.96309541165829, 110.6892161145806, -311.99859607964754, 28.156465814914554, 112.72392108291386, 99.55849140509962, 77.21328805573282, 73.77827632054685, -229.51701467856765, 100.26890219002962, 82.0266520641744, -317.43289336562157, 79.00248498097059, 72.27623457834122, 36.2718045124784, 115.09688869863749, 85.1404290399514, 74.47884937003253, 86.0216050259769, 106.87588714063168, 77.8176616616547, 49.708325214683995, 92.7182572353631, 70.24567451048642, 101.91626900061962, 80.99006369709966, 103.47153462283313, 88.10558322817087, 40.748050105758, 83.11515721830074, 93.49321932019663, 69.70300386473534, 107.95480398088691, -301.8653837442398, 92.12605812586841, 97.62664442835373, 101.23546719923615, 101.56525055132803, 83.35264302557331, 98.15733831342368, 60.7432289943099, 71.92860092408952, 70.62614475004372, 103.29286750848404, 108.00615117364211, 69.98538745939729, 80.38083742186427, 89.616314727813, 81.67361507564782, 88.65314135281368, 100.7233831696212, 88.67417717352508, 80.68447407335043, 76.41491432860494, 93.40923753380774, 79.7070502452552, 84.03261094167827, 111.53961457870898, 87.92313183471559, 89.86920697987077, 93.76374493353066, 92.81117045879364, 105.25347655196671, 47.784670952707515, 86.51932916603981, 70.54703204426914, 113.62607694044709, 67.18684372678396, -336.9723215997219, 72.85699365288019, 105.33702733181416, 106.43657712911951, 90.65251857787368, 95.1980167943984, 74.389405220747, 95.95718907937406, 74.72209343127905, 128.77330202050513, 128.16168100433424, 96.0500411055982, 20.848610297776744, 92.90353477373716, 101.80404714494944, 75.42897973116484, 80.80992634780704, 85.12006366765127, 94.17249552346765, 113.25662971660492, 91.60311414673922, 87.0889394059777], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 494, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 61, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [37.965551671882466, 38.25559005265434, 37.94119743754466, 24.609667892257363, 25.001209835211426, 25.19457979189852, 29.560529475410775, 29.90338684742649, 29.346937050422028, 26.45621151352921, 26.619308229225368, 26.24248298505941, 35.453511491417885, 35.73568991012871, 35.303469985723495, 40.64560165256262, 40.51054438203573, 40.68027777224779, 27.429247934371233, 27.61311861500144, 27.431070402264595, 29.03455504526694, 28.371845607956246, 29.331159734477595, 30.043092478920386, 29.83733783538142, 29.513909714917332, 29.005597678323582, 29.328409412254885, 28.919368048508957, 31.193661838769913, 32.060554176568985, 31.70887939631939, 37.08658537144461, 36.763551163176686, 36.839079579959304, -99.36829576889674, -99.00137482831876, -113.62892548243205, 9.731482421513647, 9.666311915963888, 8.75867147743702, 37.87780230616529, 37.80931366359194, 37.03680511315663, 33.3070108157893, 32.85510257383187, 33.39637801547845, 25.785806770126015, 25.91719385671118, 25.510287428895623, 24.66995234539111, 24.640209348251418, 24.468114626904324, -72.38801611587405, -73.64135399460793, -83.48764456808567, 33.10611689090729, 33.662081114947796, 33.50070418417454, 27.559826766451195, 26.635787059863404, 27.8310382378598, -99.0638324742516, -98.96543198575577, -119.40362890561423, 26.602925820897013, 25.683284918467194, 26.716274241606385, 24.05098259697357, 24.163832052300364, 24.061419929067284, 12.161031470013157, 12.128809362029031, 11.981963680436209, 38.57750702276826, 37.944085985422134, 38.57529569044709, 28.530448361144707, 28.3449175444742, 28.265063134332493, 24.136361141999558, 24.98055115093787, 25.361937077095106, 28.75955567508936, 28.54299359768629, 28.719055753201246, 35.67530207335949, 35.3567610681057, 35.84382399916649, 25.193277855714157, 26.325178115939096, 26.299205690001443, 16.523369645078972, 16.753416304786995, 16.431539264818028, 30.762097808221966, 31.02231936591366, 30.93384006122747, 22.855066791176796, 23.67322893254459, 23.71737878676504, 34.152867710838706, 34.236484850446374, 33.52691643933454, 27.162839310864598, 26.912421161929757, 26.914803224305302, 34.943371606990695, 34.784967094659805, 33.74319592118263, 29.432124607264996, 29.32510606944561, 29.348352551460266, 13.774288220641509, 13.547438116123274, 13.426323768993214, 27.65584689192474, 27.776517906808294, 27.682792419567704, 31.543239209024847, 30.646907846132905, 31.303072265038878, 23.535821086416632, 22.697997132937104, 23.4691856453816, 36.110474968949944, 36.17315867791572, 35.67117033402124, -97.82429029047489, -107.1578637957573, -96.88322965800762, 30.91585883560279, 30.322559947768838, 30.887639342496783, 32.8349355404886, 32.56161025787392, 32.230098629991204, 33.622034795582294, 33.66597168892622, 33.94746071472764, 33.851182526598365, 33.83191799807051, 33.88215002665916, 27.73789847890535, 27.913330778634787, 27.701413768033177, 32.621066585183144, 32.4230762720108, 33.11319545622973, 20.56167784333229, 20.715067826211452, 19.46648332476616, 24.071857719371707, 23.628721977273614, 24.228021227444202, 23.07096546391645, 24.12429065319398, 23.43088863293329, 34.73953887269211, 34.50129908074935, 34.05202955504258, 36.30747720512832, 35.549915621678025, 36.14875834683576, 23.372172261277825, 23.301295931140572, 23.31191926697889, 26.681818157434464, 26.68596552312374, 27.013053741306067, 29.952842976897955, 29.599723026156425, 30.063748724758625, 26.800701340039566, 27.394187731047467, 27.478726004560784, 29.3628383030494, 29.61164930587013, 29.678653743894145, 33.78577803696194, 33.40884334842363, 33.52876178423563, 29.44387001295884, 29.526714620490864, 29.703592540075377, 26.93553876131773, 26.709630340337753, 27.039304971694946, 25.654904529452324, 25.123161286115646, 25.636848513036966, 31.062910621364907, 31.183312897880867, 31.163014014561966, 26.62798128897944, 26.49493737022081, 26.58413158605495, 28.217767411222056, 27.976779778798416, 27.8380637516578, 37.523390211785824, 36.685972715417535, 37.33025165150562, 29.23639989395936, 29.439002768446997, 29.247729172309235, 29.678028667966515, 30.09998186926046, 30.091196442643792, 30.951348679761082, 31.354129730413348, 31.45826652335623, 30.964632119983435, 30.98707166686654, 30.859466671943665, 35.20581694870876, 34.96944812561074, 35.078211477647216, 15.755915520091847, 16.04981218402584, 15.978943248589829, 29.033548108030416, 29.035021433567934, 28.45075962444146, 23.5285447537899, 22.850128561258316, 24.168358729220927, 37.962977044284344, 37.485037833452225, 38.178062062710524, 22.454702752331883, 22.23664068679014, 22.49550028766194, -105.00720231235027, -104.85047905147076, -127.11464023590088, 24.293048970401287, 24.44868180155754, 24.115262880921364, 35.343862238650516, 35.011284833153084, 34.981880260010556, 35.231299641231686, 35.813738396022615, 35.39153909186521, 30.18863449121514, 30.28079496944943, 30.183089117209107, 31.46487134943405, 31.880881329687924, 31.852264115276427, 25.03295274078846, 24.734640955924988, 24.621811524033546, 32.16319450115164, 31.969806914528206, 31.824187663694218, 24.79610366870959, 24.703004752596215, 25.222985009973243, 43.10043894809981, 42.711140160759285, 42.961722911645964, 42.32416347165902, 42.618256886800125, 43.21926064587508, 32.10077564915021, 32.09333849822481, 31.85592695822318, 7.157396805783108, 6.296698768933609, 7.394514723060027, 31.3437558847169, 30.9170833180348, 30.642695570985467, 34.05795960128307, 34.29324070364237, 33.452846840023994, 25.254730814757437, 25.233586984376103, 24.940661932031304, 27.186762887363628, 27.005314269413546, 26.617849191029862, 28.11491233110428, 28.215150840580463, 28.790000495966524, 31.144949850936726, 31.463384853055075, 31.564160819475845, 37.67121785382429, 37.81469517449537, 37.77071668828526, 30.361492710808903, 30.605564492444188, 30.636056943486125, 29.37994338820377, 28.709537799159676, 28.99945821861425]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1446971580373828, "mean_inference_ms": 0.6989703306609631, "mean_action_processing_ms": 0.09643205101793438, "mean_env_wait_ms": 0.8084850727456159, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 380000, "timesteps_this_iter": 0, "agent_timesteps_total": 1140000, "timers": {"sample_time_ms": 10470.767, "sample_throughput": 477.52, "load_time_ms": 0.354, "load_throughput": 14132704.36, "learn_time_ms": 1981.618, "learn_throughput": 2523.191, "update_time_ms": 9.42}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7755575615628915e-18, "cur_lr": 0.0005000000000000001, "total_loss": 6.456712341308593, "policy_loss": -0.0019240291406357635, "vf_loss": 6.537385272979736, "vf_explained_var": -0.23191261291503906, "kl": 0.0017437843489579157, "entropy": 7.874875926971436, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 380000, "num_agent_steps_sampled": 1140000, "num_steps_trained": 380000, "num_agent_steps_trained": 1140000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1419, "training_iteration": 76, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-15-06", "timestamp": 1706231706, "time_this_iter_s": 10.293082475662231, "time_total_s": 822.7130897045135, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402DF0C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 822.7130897045135, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 5.5928571428571425, "ram_util_percent": 59.60714285714287}}
{"episode_reward_max": 128.77330202050513, "episode_reward_min": -336.9723215997219, "episode_reward_mean": 68.18479324962114, "episode_len_mean": 482.78, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -127.11464023590088}, "policy_reward_max": {"shared_policy": 43.21926064587508}, "policy_reward_mean": {"shared_policy": 22.728264416540377}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.96309541165829, 110.6892161145806, -311.99859607964754, 28.156465814914554, 112.72392108291386, 99.55849140509962, 77.21328805573282, 73.77827632054685, -229.51701467856765, 100.26890219002962, 82.0266520641744, -317.43289336562157, 79.00248498097059, 72.27623457834122, 36.2718045124784, 115.09688869863749, 85.1404290399514, 74.47884937003253, 86.0216050259769, 106.87588714063168, 77.8176616616547, 49.708325214683995, 92.7182572353631, 70.24567451048642, 101.91626900061962, 80.99006369709966, 103.47153462283313, 88.10558322817087, 40.748050105758, 83.11515721830074, 93.49321932019663, 69.70300386473534, 107.95480398088691, -301.8653837442398, 92.12605812586841, 97.62664442835373, 101.23546719923615, 101.56525055132803, 83.35264302557331, 98.15733831342368, 60.7432289943099, 71.92860092408952, 70.62614475004372, 103.29286750848404, 108.00615117364211, 69.98538745939729, 80.38083742186427, 89.616314727813, 81.67361507564782, 88.65314135281368, 100.7233831696212, 88.67417717352508, 80.68447407335043, 76.41491432860494, 93.40923753380774, 79.7070502452552, 84.03261094167827, 111.53961457870898, 87.92313183471559, 89.86920697987077, 93.76374493353066, 92.81117045879364, 105.25347655196671, 47.784670952707515, 86.51932916603981, 70.54703204426914, 113.62607694044709, 67.18684372678396, -336.9723215997219, 72.85699365288019, 105.33702733181416, 106.43657712911951, 90.65251857787368, 95.1980167943984, 74.389405220747, 95.95718907937406, 74.72209343127905, 128.77330202050513, 128.16168100433424, 96.0500411055982, 20.848610297776744, 92.90353477373716, 101.80404714494944, 75.42897973116484, 80.80992634780704, 85.12006366765127, 94.17249552346765, 113.25662971660492, 91.60311414673922, 87.0889394059777, 101.33169085904954, 93.17999089369548, 88.41182655282317, 116.0198758933693, 84.44369395077226, 77.15403719991444, 78.52615157701074, 114.3504902757704, 77.08324576169251, 110.22341322898865], "episode_lengths": [500, 500, 75, 500, 500, 500, 500, 500, 494, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 61, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [31.193661838769913, 32.060554176568985, 31.70887939631939, 37.08658537144461, 36.763551163176686, 36.839079579959304, -99.36829576889674, -99.00137482831876, -113.62892548243205, 9.731482421513647, 9.666311915963888, 8.75867147743702, 37.87780230616529, 37.80931366359194, 37.03680511315663, 33.3070108157893, 32.85510257383187, 33.39637801547845, 25.785806770126015, 25.91719385671118, 25.510287428895623, 24.66995234539111, 24.640209348251418, 24.468114626904324, -72.38801611587405, -73.64135399460793, -83.48764456808567, 33.10611689090729, 33.662081114947796, 33.50070418417454, 27.559826766451195, 26.635787059863404, 27.8310382378598, -99.0638324742516, -98.96543198575577, -119.40362890561423, 26.602925820897013, 25.683284918467194, 26.716274241606385, 24.05098259697357, 24.163832052300364, 24.061419929067284, 12.161031470013157, 12.128809362029031, 11.981963680436209, 38.57750702276826, 37.944085985422134, 38.57529569044709, 28.530448361144707, 28.3449175444742, 28.265063134332493, 24.136361141999558, 24.98055115093787, 25.361937077095106, 28.75955567508936, 28.54299359768629, 28.719055753201246, 35.67530207335949, 35.3567610681057, 35.84382399916649, 25.193277855714157, 26.325178115939096, 26.299205690001443, 16.523369645078972, 16.753416304786995, 16.431539264818028, 30.762097808221966, 31.02231936591366, 30.93384006122747, 22.855066791176796, 23.67322893254459, 23.71737878676504, 34.152867710838706, 34.236484850446374, 33.52691643933454, 27.162839310864598, 26.912421161929757, 26.914803224305302, 34.943371606990695, 34.784967094659805, 33.74319592118263, 29.432124607264996, 29.32510606944561, 29.348352551460266, 13.774288220641509, 13.547438116123274, 13.426323768993214, 27.65584689192474, 27.776517906808294, 27.682792419567704, 31.543239209024847, 30.646907846132905, 31.303072265038878, 23.535821086416632, 22.697997132937104, 23.4691856453816, 36.110474968949944, 36.17315867791572, 35.67117033402124, -97.82429029047489, -107.1578637957573, -96.88322965800762, 30.91585883560279, 30.322559947768838, 30.887639342496783, 32.8349355404886, 32.56161025787392, 32.230098629991204, 33.622034795582294, 33.66597168892622, 33.94746071472764, 33.851182526598365, 33.83191799807051, 33.88215002665916, 27.73789847890535, 27.913330778634787, 27.701413768033177, 32.621066585183144, 32.4230762720108, 33.11319545622973, 20.56167784333229, 20.715067826211452, 19.46648332476616, 24.071857719371707, 23.628721977273614, 24.228021227444202, 23.07096546391645, 24.12429065319398, 23.43088863293329, 34.73953887269211, 34.50129908074935, 34.05202955504258, 36.30747720512832, 35.549915621678025, 36.14875834683576, 23.372172261277825, 23.301295931140572, 23.31191926697889, 26.681818157434464, 26.68596552312374, 27.013053741306067, 29.952842976897955, 29.599723026156425, 30.063748724758625, 26.800701340039566, 27.394187731047467, 27.478726004560784, 29.3628383030494, 29.61164930587013, 29.678653743894145, 33.78577803696194, 33.40884334842363, 33.52876178423563, 29.44387001295884, 29.526714620490864, 29.703592540075377, 26.93553876131773, 26.709630340337753, 27.039304971694946, 25.654904529452324, 25.123161286115646, 25.636848513036966, 31.062910621364907, 31.183312897880867, 31.163014014561966, 26.62798128897944, 26.49493737022081, 26.58413158605495, 28.217767411222056, 27.976779778798416, 27.8380637516578, 37.523390211785824, 36.685972715417535, 37.33025165150562, 29.23639989395936, 29.439002768446997, 29.247729172309235, 29.678028667966515, 30.09998186926046, 30.091196442643792, 30.951348679761082, 31.354129730413348, 31.45826652335623, 30.964632119983435, 30.98707166686654, 30.859466671943665, 35.20581694870876, 34.96944812561074, 35.078211477647216, 15.755915520091847, 16.04981218402584, 15.978943248589829, 29.033548108030416, 29.035021433567934, 28.45075962444146, 23.5285447537899, 22.850128561258316, 24.168358729220927, 37.962977044284344, 37.485037833452225, 38.178062062710524, 22.454702752331883, 22.23664068679014, 22.49550028766194, -105.00720231235027, -104.85047905147076, -127.11464023590088, 24.293048970401287, 24.44868180155754, 24.115262880921364, 35.343862238650516, 35.011284833153084, 34.981880260010556, 35.231299641231686, 35.813738396022615, 35.39153909186521, 30.18863449121514, 30.28079496944943, 30.183089117209107, 31.46487134943405, 31.880881329687924, 31.852264115276427, 25.03295274078846, 24.734640955924988, 24.621811524033546, 32.16319450115164, 31.969806914528206, 31.824187663694218, 24.79610366870959, 24.703004752596215, 25.222985009973243, 43.10043894809981, 42.711140160759285, 42.961722911645964, 42.32416347165902, 42.618256886800125, 43.21926064587508, 32.10077564915021, 32.09333849822481, 31.85592695822318, 7.157396805783108, 6.296698768933609, 7.394514723060027, 31.3437558847169, 30.9170833180348, 30.642695570985467, 34.05795960128307, 34.29324070364237, 33.452846840023994, 25.254730814757437, 25.233586984376103, 24.940661932031304, 27.186762887363628, 27.005314269413546, 26.617849191029862, 28.11491233110428, 28.215150840580463, 28.790000495966524, 31.144949850936726, 31.463384853055075, 31.564160819475845, 37.67121785382429, 37.81469517449537, 37.77071668828526, 30.361492710808903, 30.605564492444188, 30.636056943486125, 29.37994338820377, 28.709537799159676, 28.99945821861425, 33.705786054333046, 33.667010736962155, 33.95889406775434, 30.95417898769179, 31.071514651800186, 31.1542972542035, 29.235524800916508, 29.526480478545025, 29.64982127336164, 38.73119325128694, 38.602971506615475, 38.68571113546689, 28.16724270830551, 28.10452644030252, 28.171924802164227, 25.880994980533913, 25.80619156112273, 25.466850658257798, 25.863628168900803, 26.33271270928283, 26.329810698827103, 37.847238103548676, 38.19785344849029, 38.30539872373143, 25.46624632676442, 25.5246476282676, 26.09235180666049, 36.78215050697327, 36.62659206986427, 36.81467065215111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14457565975263345, "mean_inference_ms": 0.6987740748862283, "mean_action_processing_ms": 0.09641986168177294, "mean_env_wait_ms": 0.8079930469251697, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 385000, "timesteps_this_iter": 0, "agent_timesteps_total": 1155000, "timers": {"sample_time_ms": 10487.94, "sample_throughput": 476.738, "load_time_ms": 0.354, "load_throughput": 14132704.36, "learn_time_ms": 1993.266, "learn_throughput": 2508.445, "update_time_ms": 9.443}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3877787807814458e-18, "cur_lr": 0.0005000000000000001, "total_loss": 5.750036191940308, "policy_loss": -0.0019310046451290418, "vf_loss": 5.8305257797241214, "vf_explained_var": -0.23891725540161132, "kl": 0.0025152374117286273, "entropy": 7.855875396728516, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 385000, "num_agent_steps_sampled": 1155000, "num_steps_trained": 385000, "num_agent_steps_trained": 1155000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1429, "training_iteration": 77, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-15-16", "timestamp": 1706231716, "time_this_iter_s": 10.457703113555908, "time_total_s": 833.1707928180695, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401A96DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 833.1707928180695, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 7.133333333333334, "ram_util_percent": 59.62000000000001}}
{"episode_reward_max": 128.77330202050513, "episode_reward_min": -336.9723215997219, "episode_reward_mean": 75.7569743689346, "episode_len_mean": 487.09, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -127.11464023590088}, "policy_reward_max": {"shared_policy": 43.21926064587508}, "policy_reward_mean": {"shared_policy": 25.252324789644863}, "custom_metrics": {}, "hist_stats": {"episode_reward": [82.0266520641744, -317.43289336562157, 79.00248498097059, 72.27623457834122, 36.2718045124784, 115.09688869863749, 85.1404290399514, 74.47884937003253, 86.0216050259769, 106.87588714063168, 77.8176616616547, 49.708325214683995, 92.7182572353631, 70.24567451048642, 101.91626900061962, 80.99006369709966, 103.47153462283313, 88.10558322817087, 40.748050105758, 83.11515721830074, 93.49321932019663, 69.70300386473534, 107.95480398088691, -301.8653837442398, 92.12605812586841, 97.62664442835373, 101.23546719923615, 101.56525055132803, 83.35264302557331, 98.15733831342368, 60.7432289943099, 71.92860092408952, 70.62614475004372, 103.29286750848404, 108.00615117364211, 69.98538745939729, 80.38083742186427, 89.616314727813, 81.67361507564782, 88.65314135281368, 100.7233831696212, 88.67417717352508, 80.68447407335043, 76.41491432860494, 93.40923753380774, 79.7070502452552, 84.03261094167827, 111.53961457870898, 87.92313183471559, 89.86920697987077, 93.76374493353066, 92.81117045879364, 105.25347655196671, 47.784670952707515, 86.51932916603981, 70.54703204426914, 113.62607694044709, 67.18684372678396, -336.9723215997219, 72.85699365288019, 105.33702733181416, 106.43657712911951, 90.65251857787368, 95.1980167943984, 74.389405220747, 95.95718907937406, 74.72209343127905, 128.77330202050513, 128.16168100433424, 96.0500411055982, 20.848610297776744, 92.90353477373716, 101.80404714494944, 75.42897973116484, 80.80992634780704, 85.12006366765127, 94.17249552346765, 113.25662971660492, 91.60311414673922, 87.0889394059777, 101.33169085904954, 93.17999089369548, 88.41182655282317, 116.0198758933693, 84.44369395077226, 77.15403719991444, 78.52615157701074, 114.3504902757704, 77.08324576169251, 110.22341322898865, 76.45885950978844, 112.90813978761432, 93.98134231520814, 101.06606115913016, 97.14420233294368, 92.51422455906867, 103.83515056967732, 54.98028155975041, 97.64387846365571, 82.52201731177047], "episode_lengths": [500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 61, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [27.559826766451195, 26.635787059863404, 27.8310382378598, -99.0638324742516, -98.96543198575577, -119.40362890561423, 26.602925820897013, 25.683284918467194, 26.716274241606385, 24.05098259697357, 24.163832052300364, 24.061419929067284, 12.161031470013157, 12.128809362029031, 11.981963680436209, 38.57750702276826, 37.944085985422134, 38.57529569044709, 28.530448361144707, 28.3449175444742, 28.265063134332493, 24.136361141999558, 24.98055115093787, 25.361937077095106, 28.75955567508936, 28.54299359768629, 28.719055753201246, 35.67530207335949, 35.3567610681057, 35.84382399916649, 25.193277855714157, 26.325178115939096, 26.299205690001443, 16.523369645078972, 16.753416304786995, 16.431539264818028, 30.762097808221966, 31.02231936591366, 30.93384006122747, 22.855066791176796, 23.67322893254459, 23.71737878676504, 34.152867710838706, 34.236484850446374, 33.52691643933454, 27.162839310864598, 26.912421161929757, 26.914803224305302, 34.943371606990695, 34.784967094659805, 33.74319592118263, 29.432124607264996, 29.32510606944561, 29.348352551460266, 13.774288220641509, 13.547438116123274, 13.426323768993214, 27.65584689192474, 27.776517906808294, 27.682792419567704, 31.543239209024847, 30.646907846132905, 31.303072265038878, 23.535821086416632, 22.697997132937104, 23.4691856453816, 36.110474968949944, 36.17315867791572, 35.67117033402124, -97.82429029047489, -107.1578637957573, -96.88322965800762, 30.91585883560279, 30.322559947768838, 30.887639342496783, 32.8349355404886, 32.56161025787392, 32.230098629991204, 33.622034795582294, 33.66597168892622, 33.94746071472764, 33.851182526598365, 33.83191799807051, 33.88215002665916, 27.73789847890535, 27.913330778634787, 27.701413768033177, 32.621066585183144, 32.4230762720108, 33.11319545622973, 20.56167784333229, 20.715067826211452, 19.46648332476616, 24.071857719371707, 23.628721977273614, 24.228021227444202, 23.07096546391645, 24.12429065319398, 23.43088863293329, 34.73953887269211, 34.50129908074935, 34.05202955504258, 36.30747720512832, 35.549915621678025, 36.14875834683576, 23.372172261277825, 23.301295931140572, 23.31191926697889, 26.681818157434464, 26.68596552312374, 27.013053741306067, 29.952842976897955, 29.599723026156425, 30.063748724758625, 26.800701340039566, 27.394187731047467, 27.478726004560784, 29.3628383030494, 29.61164930587013, 29.678653743894145, 33.78577803696194, 33.40884334842363, 33.52876178423563, 29.44387001295884, 29.526714620490864, 29.703592540075377, 26.93553876131773, 26.709630340337753, 27.039304971694946, 25.654904529452324, 25.123161286115646, 25.636848513036966, 31.062910621364907, 31.183312897880867, 31.163014014561966, 26.62798128897944, 26.49493737022081, 26.58413158605495, 28.217767411222056, 27.976779778798416, 27.8380637516578, 37.523390211785824, 36.685972715417535, 37.33025165150562, 29.23639989395936, 29.439002768446997, 29.247729172309235, 29.678028667966515, 30.09998186926046, 30.091196442643792, 30.951348679761082, 31.354129730413348, 31.45826652335623, 30.964632119983435, 30.98707166686654, 30.859466671943665, 35.20581694870876, 34.96944812561074, 35.078211477647216, 15.755915520091847, 16.04981218402584, 15.978943248589829, 29.033548108030416, 29.035021433567934, 28.45075962444146, 23.5285447537899, 22.850128561258316, 24.168358729220927, 37.962977044284344, 37.485037833452225, 38.178062062710524, 22.454702752331883, 22.23664068679014, 22.49550028766194, -105.00720231235027, -104.85047905147076, -127.11464023590088, 24.293048970401287, 24.44868180155754, 24.115262880921364, 35.343862238650516, 35.011284833153084, 34.981880260010556, 35.231299641231686, 35.813738396022615, 35.39153909186521, 30.18863449121514, 30.28079496944943, 30.183089117209107, 31.46487134943405, 31.880881329687924, 31.852264115276427, 25.03295274078846, 24.734640955924988, 24.621811524033546, 32.16319450115164, 31.969806914528206, 31.824187663694218, 24.79610366870959, 24.703004752596215, 25.222985009973243, 43.10043894809981, 42.711140160759285, 42.961722911645964, 42.32416347165902, 42.618256886800125, 43.21926064587508, 32.10077564915021, 32.09333849822481, 31.85592695822318, 7.157396805783108, 6.296698768933609, 7.394514723060027, 31.3437558847169, 30.9170833180348, 30.642695570985467, 34.05795960128307, 34.29324070364237, 33.452846840023994, 25.254730814757437, 25.233586984376103, 24.940661932031304, 27.186762887363628, 27.005314269413546, 26.617849191029862, 28.11491233110428, 28.215150840580463, 28.790000495966524, 31.144949850936726, 31.463384853055075, 31.564160819475845, 37.67121785382429, 37.81469517449537, 37.77071668828526, 30.361492710808903, 30.605564492444188, 30.636056943486125, 29.37994338820377, 28.709537799159676, 28.99945821861425, 33.705786054333046, 33.667010736962155, 33.95889406775434, 30.95417898769179, 31.071514651800186, 31.1542972542035, 29.235524800916508, 29.526480478545025, 29.64982127336164, 38.73119325128694, 38.602971506615475, 38.68571113546689, 28.16724270830551, 28.10452644030252, 28.171924802164227, 25.880994980533913, 25.80619156112273, 25.466850658257798, 25.863628168900803, 26.33271270928283, 26.329810698827103, 37.847238103548676, 38.19785344849029, 38.30539872373143, 25.46624632676442, 25.5246476282676, 26.09235180666049, 36.78215050697327, 36.62659206986427, 36.81467065215111, 25.200504032274083, 25.74033463404824, 25.518020843466118, 37.484317670265824, 37.73672217192748, 37.68709994542101, 31.455751574287802, 31.59580804236853, 30.929782698551804, 33.95442904547477, 33.62112546215454, 33.49050665150085, 32.319436341524124, 32.5284926854074, 32.296273306012154, 30.7730594476064, 30.703217556079224, 31.03794755538304, 34.560661802689225, 34.46201954285303, 34.81246922413507, 18.02589190999666, 18.336461837093026, 18.617927812660724, 32.53501471877098, 32.54585186764598, 32.56301187723875, 27.280027113854885, 27.711623054463416, 27.530367143452168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1444382382808345, "mean_inference_ms": 0.6987008778583216, "mean_action_processing_ms": 0.09643409628082544, "mean_env_wait_ms": 0.8075579718502327, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 390000, "timesteps_this_iter": 0, "agent_timesteps_total": 1170000, "timers": {"sample_time_ms": 10506.497, "sample_throughput": 475.896, "load_time_ms": 0.253, "load_throughput": 19793789.523, "learn_time_ms": 2004.856, "learn_throughput": 2493.945, "update_time_ms": 9.521}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.938893903907229e-19, "cur_lr": 0.0005000000000000001, "total_loss": 4.383189964294433, "policy_loss": -0.0023976006818182682, "vf_loss": 4.464734601974487, "vf_explained_var": -0.22884054183959962, "kl": 0.0031917527783784233, "entropy": 7.9146936416625975, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 390000, "num_agent_steps_sampled": 1170000, "num_steps_trained": 390000, "num_agent_steps_trained": 1170000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1439, "training_iteration": 78, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-15-27", "timestamp": 1706231727, "time_this_iter_s": 10.577615022659302, "time_total_s": 843.7484078407288, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401AAAEE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 843.7484078407288, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 6.9399999999999995, "ram_util_percent": 59.66000000000001}}
{"episode_reward_max": 128.77330202050513, "episode_reward_min": -336.9723215997219, "episode_reward_mean": 79.8483335700781, "episode_len_mean": 491.27, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -127.11464023590088}, "policy_reward_max": {"shared_policy": 43.21926064587508}, "policy_reward_mean": {"shared_policy": 26.61611119002603}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.8176616616547, 49.708325214683995, 92.7182572353631, 70.24567451048642, 101.91626900061962, 80.99006369709966, 103.47153462283313, 88.10558322817087, 40.748050105758, 83.11515721830074, 93.49321932019663, 69.70300386473534, 107.95480398088691, -301.8653837442398, 92.12605812586841, 97.62664442835373, 101.23546719923615, 101.56525055132803, 83.35264302557331, 98.15733831342368, 60.7432289943099, 71.92860092408952, 70.62614475004372, 103.29286750848404, 108.00615117364211, 69.98538745939729, 80.38083742186427, 89.616314727813, 81.67361507564782, 88.65314135281368, 100.7233831696212, 88.67417717352508, 80.68447407335043, 76.41491432860494, 93.40923753380774, 79.7070502452552, 84.03261094167827, 111.53961457870898, 87.92313183471559, 89.86920697987077, 93.76374493353066, 92.81117045879364, 105.25347655196671, 47.784670952707515, 86.51932916603981, 70.54703204426914, 113.62607694044709, 67.18684372678396, -336.9723215997219, 72.85699365288019, 105.33702733181416, 106.43657712911951, 90.65251857787368, 95.1980167943984, 74.389405220747, 95.95718907937406, 74.72209343127905, 128.77330202050513, 128.16168100433424, 96.0500411055982, 20.848610297776744, 92.90353477373716, 101.80404714494944, 75.42897973116484, 80.80992634780704, 85.12006366765127, 94.17249552346765, 113.25662971660492, 91.60311414673922, 87.0889394059777, 101.33169085904954, 93.17999089369548, 88.41182655282317, 116.0198758933693, 84.44369395077226, 77.15403719991444, 78.52615157701074, 114.3504902757704, 77.08324576169251, 110.22341322898865, 76.45885950978844, 112.90813978761432, 93.98134231520814, 101.06606115913016, 97.14420233294368, 92.51422455906867, 103.83515056967732, 54.98028155975041, 97.64387846365571, 82.52201731177047, 79.23634686693549, 74.35823146998882, 82.33621002174911, 77.07159350439905, 37.057294853031635, 103.28521435707805, 91.5042290240526, 91.06894367933272, 102.57367361336945, 90.40212476998568], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 61, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [25.193277855714157, 26.325178115939096, 26.299205690001443, 16.523369645078972, 16.753416304786995, 16.431539264818028, 30.762097808221966, 31.02231936591366, 30.93384006122747, 22.855066791176796, 23.67322893254459, 23.71737878676504, 34.152867710838706, 34.236484850446374, 33.52691643933454, 27.162839310864598, 26.912421161929757, 26.914803224305302, 34.943371606990695, 34.784967094659805, 33.74319592118263, 29.432124607264996, 29.32510606944561, 29.348352551460266, 13.774288220641509, 13.547438116123274, 13.426323768993214, 27.65584689192474, 27.776517906808294, 27.682792419567704, 31.543239209024847, 30.646907846132905, 31.303072265038878, 23.535821086416632, 22.697997132937104, 23.4691856453816, 36.110474968949944, 36.17315867791572, 35.67117033402124, -97.82429029047489, -107.1578637957573, -96.88322965800762, 30.91585883560279, 30.322559947768838, 30.887639342496783, 32.8349355404886, 32.56161025787392, 32.230098629991204, 33.622034795582294, 33.66597168892622, 33.94746071472764, 33.851182526598365, 33.83191799807051, 33.88215002665916, 27.73789847890535, 27.913330778634787, 27.701413768033177, 32.621066585183144, 32.4230762720108, 33.11319545622973, 20.56167784333229, 20.715067826211452, 19.46648332476616, 24.071857719371707, 23.628721977273614, 24.228021227444202, 23.07096546391645, 24.12429065319398, 23.43088863293329, 34.73953887269211, 34.50129908074935, 34.05202955504258, 36.30747720512832, 35.549915621678025, 36.14875834683576, 23.372172261277825, 23.301295931140572, 23.31191926697889, 26.681818157434464, 26.68596552312374, 27.013053741306067, 29.952842976897955, 29.599723026156425, 30.063748724758625, 26.800701340039566, 27.394187731047467, 27.478726004560784, 29.3628383030494, 29.61164930587013, 29.678653743894145, 33.78577803696194, 33.40884334842363, 33.52876178423563, 29.44387001295884, 29.526714620490864, 29.703592540075377, 26.93553876131773, 26.709630340337753, 27.039304971694946, 25.654904529452324, 25.123161286115646, 25.636848513036966, 31.062910621364907, 31.183312897880867, 31.163014014561966, 26.62798128897944, 26.49493737022081, 26.58413158605495, 28.217767411222056, 27.976779778798416, 27.8380637516578, 37.523390211785824, 36.685972715417535, 37.33025165150562, 29.23639989395936, 29.439002768446997, 29.247729172309235, 29.678028667966515, 30.09998186926046, 30.091196442643792, 30.951348679761082, 31.354129730413348, 31.45826652335623, 30.964632119983435, 30.98707166686654, 30.859466671943665, 35.20581694870876, 34.96944812561074, 35.078211477647216, 15.755915520091847, 16.04981218402584, 15.978943248589829, 29.033548108030416, 29.035021433567934, 28.45075962444146, 23.5285447537899, 22.850128561258316, 24.168358729220927, 37.962977044284344, 37.485037833452225, 38.178062062710524, 22.454702752331883, 22.23664068679014, 22.49550028766194, -105.00720231235027, -104.85047905147076, -127.11464023590088, 24.293048970401287, 24.44868180155754, 24.115262880921364, 35.343862238650516, 35.011284833153084, 34.981880260010556, 35.231299641231686, 35.813738396022615, 35.39153909186521, 30.18863449121514, 30.28079496944943, 30.183089117209107, 31.46487134943405, 31.880881329687924, 31.852264115276427, 25.03295274078846, 24.734640955924988, 24.621811524033546, 32.16319450115164, 31.969806914528206, 31.824187663694218, 24.79610366870959, 24.703004752596215, 25.222985009973243, 43.10043894809981, 42.711140160759285, 42.961722911645964, 42.32416347165902, 42.618256886800125, 43.21926064587508, 32.10077564915021, 32.09333849822481, 31.85592695822318, 7.157396805783108, 6.296698768933609, 7.394514723060027, 31.3437558847169, 30.9170833180348, 30.642695570985467, 34.05795960128307, 34.29324070364237, 33.452846840023994, 25.254730814757437, 25.233586984376103, 24.940661932031304, 27.186762887363628, 27.005314269413546, 26.617849191029862, 28.11491233110428, 28.215150840580463, 28.790000495966524, 31.144949850936726, 31.463384853055075, 31.564160819475845, 37.67121785382429, 37.81469517449537, 37.77071668828526, 30.361492710808903, 30.605564492444188, 30.636056943486125, 29.37994338820377, 28.709537799159676, 28.99945821861425, 33.705786054333046, 33.667010736962155, 33.95889406775434, 30.95417898769179, 31.071514651800186, 31.1542972542035, 29.235524800916508, 29.526480478545025, 29.64982127336164, 38.73119325128694, 38.602971506615475, 38.68571113546689, 28.16724270830551, 28.10452644030252, 28.171924802164227, 25.880994980533913, 25.80619156112273, 25.466850658257798, 25.863628168900803, 26.33271270928283, 26.329810698827103, 37.847238103548676, 38.19785344849029, 38.30539872373143, 25.46624632676442, 25.5246476282676, 26.09235180666049, 36.78215050697327, 36.62659206986427, 36.81467065215111, 25.200504032274083, 25.74033463404824, 25.518020843466118, 37.484317670265824, 37.73672217192748, 37.68709994542101, 31.455751574287802, 31.59580804236853, 30.929782698551804, 33.95442904547477, 33.62112546215454, 33.49050665150085, 32.319436341524124, 32.5284926854074, 32.296273306012154, 30.7730594476064, 30.703217556079224, 31.03794755538304, 34.560661802689225, 34.46201954285303, 34.81246922413507, 18.02589190999666, 18.336461837093026, 18.617927812660724, 32.53501471877098, 32.54585186764598, 32.56301187723875, 27.280027113854885, 27.711623054463416, 27.530367143452168, 26.463384222239256, 26.382066927850246, 26.39089571684599, 24.60232039541006, 24.814895555377007, 24.941015519201756, 27.154102275768906, 27.4193717415134, 27.762736004466802, 25.52355560412009, 25.733320609976843, 25.814717290302113, 11.971985787153244, 12.490462265908718, 12.594846799969673, 34.43165203432241, 34.49171157429615, 34.36185074845949, 30.069211428364113, 30.797612336774662, 30.63740525891383, 30.27934209009011, 30.572052230437592, 30.217549358805016, 34.140456219514206, 34.41284993042548, 34.020367463429764, 30.05840641260147, 30.290316686034203, 30.053401671350002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14436968895991276, "mean_inference_ms": 0.6984653171545603, "mean_action_processing_ms": 0.09643461052748259, "mean_env_wait_ms": 0.8069617362377444, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 395000, "timesteps_this_iter": 0, "agent_timesteps_total": 1185000, "timers": {"sample_time_ms": 10501.601, "sample_throughput": 476.118, "load_time_ms": 0.253, "load_throughput": 19793789.523, "learn_time_ms": 2005.666, "learn_throughput": 2492.938, "update_time_ms": 9.698}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4694469519536144e-19, "cur_lr": 0.0005000000000000001, "total_loss": 6.097181940078736, "policy_loss": -0.0016750426742682123, "vf_loss": 6.178181743621826, "vf_explained_var": -0.1385098099708557, "kl": 0.002393046824739737, "entropy": 7.932469701766967, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 395000, "num_agent_steps_sampled": 1185000, "num_steps_trained": 395000, "num_agent_steps_trained": 1185000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1449, "training_iteration": 79, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-15-37", "timestamp": 1706231737, "time_this_iter_s": 10.467042684555054, "time_total_s": 854.2154505252838, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402DF08B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 854.2154505252838, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 6.6933333333333325, "ram_util_percent": 59.85333333333334}}
{"episode_reward_max": 136.8385066818446, "episode_reward_min": -336.9723215997219, "episode_reward_mean": 79.06961882463175, "episode_len_mean": 487.93, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -127.11464023590088}, "policy_reward_max": {"shared_policy": 45.774896544714764}, "policy_reward_mean": {"shared_policy": 26.356539608210586}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.70300386473534, 107.95480398088691, -301.8653837442398, 92.12605812586841, 97.62664442835373, 101.23546719923615, 101.56525055132803, 83.35264302557331, 98.15733831342368, 60.7432289943099, 71.92860092408952, 70.62614475004372, 103.29286750848404, 108.00615117364211, 69.98538745939729, 80.38083742186427, 89.616314727813, 81.67361507564782, 88.65314135281368, 100.7233831696212, 88.67417717352508, 80.68447407335043, 76.41491432860494, 93.40923753380774, 79.7070502452552, 84.03261094167827, 111.53961457870898, 87.92313183471559, 89.86920697987077, 93.76374493353066, 92.81117045879364, 105.25347655196671, 47.784670952707515, 86.51932916603981, 70.54703204426914, 113.62607694044709, 67.18684372678396, -336.9723215997219, 72.85699365288019, 105.33702733181416, 106.43657712911951, 90.65251857787368, 95.1980167943984, 74.389405220747, 95.95718907937406, 74.72209343127905, 128.77330202050513, 128.16168100433424, 96.0500411055982, 20.848610297776744, 92.90353477373716, 101.80404714494944, 75.42897973116484, 80.80992634780704, 85.12006366765127, 94.17249552346765, 113.25662971660492, 91.60311414673922, 87.0889394059777, 101.33169085904954, 93.17999089369548, 88.41182655282317, 116.0198758933693, 84.44369395077226, 77.15403719991444, 78.52615157701074, 114.3504902757704, 77.08324576169251, 110.22341322898865, 76.45885950978844, 112.90813978761432, 93.98134231520814, 101.06606115913016, 97.14420233294368, 92.51422455906867, 103.83515056967732, 54.98028155975041, 97.64387846365571, 82.52201731177047, 79.23634686693549, 74.35823146998882, 82.33621002174911, 77.07159350439905, 37.057294853031635, 103.28521435707805, 91.5042290240526, 91.06894367933272, 102.57367361336945, 90.40212476998568, 121.3785421475768, 136.8385066818446, 84.536744505167, 119.91574973613022, 94.70087829977274, 93.41256055980921, 117.43440020130947, -254.91352781746536, 107.1769738695584, 89.89679387584327, 94.08069921098648], "episode_lengths": [500, 500, 61, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 166, 500, 500, 500], "policy_shared_policy_reward": [23.535821086416632, 22.697997132937104, 23.4691856453816, 36.110474968949944, 36.17315867791572, 35.67117033402124, -97.82429029047489, -107.1578637957573, -96.88322965800762, 30.91585883560279, 30.322559947768838, 30.887639342496783, 32.8349355404886, 32.56161025787392, 32.230098629991204, 33.622034795582294, 33.66597168892622, 33.94746071472764, 33.851182526598365, 33.83191799807051, 33.88215002665916, 27.73789847890535, 27.913330778634787, 27.701413768033177, 32.621066585183144, 32.4230762720108, 33.11319545622973, 20.56167784333229, 20.715067826211452, 19.46648332476616, 24.071857719371707, 23.628721977273614, 24.228021227444202, 23.07096546391645, 24.12429065319398, 23.43088863293329, 34.73953887269211, 34.50129908074935, 34.05202955504258, 36.30747720512832, 35.549915621678025, 36.14875834683576, 23.372172261277825, 23.301295931140572, 23.31191926697889, 26.681818157434464, 26.68596552312374, 27.013053741306067, 29.952842976897955, 29.599723026156425, 30.063748724758625, 26.800701340039566, 27.394187731047467, 27.478726004560784, 29.3628383030494, 29.61164930587013, 29.678653743894145, 33.78577803696194, 33.40884334842363, 33.52876178423563, 29.44387001295884, 29.526714620490864, 29.703592540075377, 26.93553876131773, 26.709630340337753, 27.039304971694946, 25.654904529452324, 25.123161286115646, 25.636848513036966, 31.062910621364907, 31.183312897880867, 31.163014014561966, 26.62798128897944, 26.49493737022081, 26.58413158605495, 28.217767411222056, 27.976779778798416, 27.8380637516578, 37.523390211785824, 36.685972715417535, 37.33025165150562, 29.23639989395936, 29.439002768446997, 29.247729172309235, 29.678028667966515, 30.09998186926046, 30.091196442643792, 30.951348679761082, 31.354129730413348, 31.45826652335623, 30.964632119983435, 30.98707166686654, 30.859466671943665, 35.20581694870876, 34.96944812561074, 35.078211477647216, 15.755915520091847, 16.04981218402584, 15.978943248589829, 29.033548108030416, 29.035021433567934, 28.45075962444146, 23.5285447537899, 22.850128561258316, 24.168358729220927, 37.962977044284344, 37.485037833452225, 38.178062062710524, 22.454702752331883, 22.23664068679014, 22.49550028766194, -105.00720231235027, -104.85047905147076, -127.11464023590088, 24.293048970401287, 24.44868180155754, 24.115262880921364, 35.343862238650516, 35.011284833153084, 34.981880260010556, 35.231299641231686, 35.813738396022615, 35.39153909186521, 30.18863449121514, 30.28079496944943, 30.183089117209107, 31.46487134943405, 31.880881329687924, 31.852264115276427, 25.03295274078846, 24.734640955924988, 24.621811524033546, 32.16319450115164, 31.969806914528206, 31.824187663694218, 24.79610366870959, 24.703004752596215, 25.222985009973243, 43.10043894809981, 42.711140160759285, 42.961722911645964, 42.32416347165902, 42.618256886800125, 43.21926064587508, 32.10077564915021, 32.09333849822481, 31.85592695822318, 7.157396805783108, 6.296698768933609, 7.394514723060027, 31.3437558847169, 30.9170833180348, 30.642695570985467, 34.05795960128307, 34.29324070364237, 33.452846840023994, 25.254730814757437, 25.233586984376103, 24.940661932031304, 27.186762887363628, 27.005314269413546, 26.617849191029862, 28.11491233110428, 28.215150840580463, 28.790000495966524, 31.144949850936726, 31.463384853055075, 31.564160819475845, 37.67121785382429, 37.81469517449537, 37.77071668828526, 30.361492710808903, 30.605564492444188, 30.636056943486125, 29.37994338820377, 28.709537799159676, 28.99945821861425, 33.705786054333046, 33.667010736962155, 33.95889406775434, 30.95417898769179, 31.071514651800186, 31.1542972542035, 29.235524800916508, 29.526480478545025, 29.64982127336164, 38.73119325128694, 38.602971506615475, 38.68571113546689, 28.16724270830551, 28.10452644030252, 28.171924802164227, 25.880994980533913, 25.80619156112273, 25.466850658257798, 25.863628168900803, 26.33271270928283, 26.329810698827103, 37.847238103548676, 38.19785344849029, 38.30539872373143, 25.46624632676442, 25.5246476282676, 26.09235180666049, 36.78215050697327, 36.62659206986427, 36.81467065215111, 25.200504032274083, 25.74033463404824, 25.518020843466118, 37.484317670265824, 37.73672217192748, 37.68709994542101, 31.455751574287802, 31.59580804236853, 30.929782698551804, 33.95442904547477, 33.62112546215454, 33.49050665150085, 32.319436341524124, 32.5284926854074, 32.296273306012154, 30.7730594476064, 30.703217556079224, 31.03794755538304, 34.560661802689225, 34.46201954285303, 34.81246922413507, 18.02589190999666, 18.336461837093026, 18.617927812660724, 32.53501471877098, 32.54585186764598, 32.56301187723875, 27.280027113854885, 27.711623054463416, 27.530367143452168, 26.463384222239256, 26.382066927850246, 26.39089571684599, 24.60232039541006, 24.814895555377007, 24.941015519201756, 27.154102275768906, 27.4193717415134, 27.762736004466802, 25.52355560412009, 25.733320609976843, 25.814717290302113, 11.971985787153244, 12.490462265908718, 12.594846799969673, 34.43165203432241, 34.49171157429615, 34.36185074845949, 30.069211428364113, 30.797612336774662, 30.63740525891383, 30.27934209009011, 30.572052230437592, 30.217549358805016, 34.140456219514206, 34.41284993042548, 34.020367463429764, 30.05840641260147, 30.290316686034203, 30.053401671350002, 40.398226504524544, 40.383663562436894, 40.59665208061536, 45.76337763977547, 45.774896544714764, 45.300232497354344, 28.242758971949414, 28.22189727177222, 28.07208826144536, 39.98124978442986, 39.82305942972501, 40.111440521975354, 31.460718624293804, 31.587851606309414, 31.65230806916952, 30.88706523180008, 31.365118324756622, 31.160377003252506, 38.8463182374835, 39.24074072390795, 39.34734123991802, -95.87659168243408, -79.75827194005251, -79.27866419497877, 35.79405017072955, 35.312470326821, 36.07045337200785, 30.071682808299855, 29.736455631752804, 30.088655435790614, 31.395956819256142, 31.178136450548962, 31.506605941181377]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14426854754866109, "mean_inference_ms": 0.6981746411341851, "mean_action_processing_ms": 0.0964184241582464, "mean_env_wait_ms": 0.8064198700144299, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 400000, "timesteps_this_iter": 0, "agent_timesteps_total": 1200000, "timers": {"sample_time_ms": 10502.887, "sample_throughput": 476.06, "load_time_ms": 0.253, "load_throughput": 19793789.523, "learn_time_ms": 1997.416, "learn_throughput": 2503.234, "update_time_ms": 9.7}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7347234759768072e-19, "cur_lr": 0.0005000000000000001, "total_loss": 101.05789337158203, "policy_loss": -0.0019245663356977083, "vf_loss": 101.13992156982422, "vf_explained_var": 0.038419657945632936, "kl": 0.004955204448210441, "entropy": 8.010152530670165, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 400000, "num_agent_steps_sampled": 1200000, "num_steps_trained": 400000, "num_agent_steps_trained": 1200000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1460, "training_iteration": 80, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-15-48", "timestamp": 1706231748, "time_this_iter_s": 10.290465354919434, "time_total_s": 864.5059158802032, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140251F820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 864.5059158802032, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 7.65, "ram_util_percent": 59.98571428571428}}
{"episode_reward_max": 136.8385066818446, "episode_reward_min": -336.9723215997219, "episode_reward_mean": 76.6329837124422, "episode_len_mean": 483.85, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -127.11464023590088}, "policy_reward_max": {"shared_policy": 45.774896544714764}, "policy_reward_mean": {"shared_policy": 25.5443279041474}, "custom_metrics": {}, "hist_stats": {"episode_reward": [103.29286750848404, 108.00615117364211, 69.98538745939729, 80.38083742186427, 89.616314727813, 81.67361507564782, 88.65314135281368, 100.7233831696212, 88.67417717352508, 80.68447407335043, 76.41491432860494, 93.40923753380774, 79.7070502452552, 84.03261094167827, 111.53961457870898, 87.92313183471559, 89.86920697987077, 93.76374493353066, 92.81117045879364, 105.25347655196671, 47.784670952707515, 86.51932916603981, 70.54703204426914, 113.62607694044709, 67.18684372678396, -336.9723215997219, 72.85699365288019, 105.33702733181416, 106.43657712911951, 90.65251857787368, 95.1980167943984, 74.389405220747, 95.95718907937406, 74.72209343127905, 128.77330202050513, 128.16168100433424, 96.0500411055982, 20.848610297776744, 92.90353477373716, 101.80404714494944, 75.42897973116484, 80.80992634780704, 85.12006366765127, 94.17249552346765, 113.25662971660492, 91.60311414673922, 87.0889394059777, 101.33169085904954, 93.17999089369548, 88.41182655282317, 116.0198758933693, 84.44369395077226, 77.15403719991444, 78.52615157701074, 114.3504902757704, 77.08324576169251, 110.22341322898865, 76.45885950978844, 112.90813978761432, 93.98134231520814, 101.06606115913016, 97.14420233294368, 92.51422455906867, 103.83515056967732, 54.98028155975041, 97.64387846365571, 82.52201731177047, 79.23634686693549, 74.35823146998882, 82.33621002174911, 77.07159350439905, 37.057294853031635, 103.28521435707805, 91.5042290240526, 91.06894367933272, 102.57367361336945, 90.40212476998568, 121.3785421475768, 136.8385066818446, 84.536744505167, 119.91574973613022, 94.70087829977274, 93.41256055980921, 117.43440020130947, -254.91352781746536, 107.1769738695584, 89.89679387584327, 94.08069921098648, 75.08737424015996, 77.43231832608578, 63.13714415021238, 89.91009387373924, 127.77532775327562, -271.07004067476373, 109.24839528463781, 109.43277923762797, 124.08036515861748, -303.61364056915045, 110.57198399305342, 97.49818842115928], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 166, 500, 500, 500, 500, 500, 500, 500, 500, 90, 500, 500, 500, 63, 500, 500], "policy_shared_policy_reward": [34.73953887269211, 34.50129908074935, 34.05202955504258, 36.30747720512832, 35.549915621678025, 36.14875834683576, 23.372172261277825, 23.301295931140572, 23.31191926697889, 26.681818157434464, 26.68596552312374, 27.013053741306067, 29.952842976897955, 29.599723026156425, 30.063748724758625, 26.800701340039566, 27.394187731047467, 27.478726004560784, 29.3628383030494, 29.61164930587013, 29.678653743894145, 33.78577803696194, 33.40884334842363, 33.52876178423563, 29.44387001295884, 29.526714620490864, 29.703592540075377, 26.93553876131773, 26.709630340337753, 27.039304971694946, 25.654904529452324, 25.123161286115646, 25.636848513036966, 31.062910621364907, 31.183312897880867, 31.163014014561966, 26.62798128897944, 26.49493737022081, 26.58413158605495, 28.217767411222056, 27.976779778798416, 27.8380637516578, 37.523390211785824, 36.685972715417535, 37.33025165150562, 29.23639989395936, 29.439002768446997, 29.247729172309235, 29.678028667966515, 30.09998186926046, 30.091196442643792, 30.951348679761082, 31.354129730413348, 31.45826652335623, 30.964632119983435, 30.98707166686654, 30.859466671943665, 35.20581694870876, 34.96944812561074, 35.078211477647216, 15.755915520091847, 16.04981218402584, 15.978943248589829, 29.033548108030416, 29.035021433567934, 28.45075962444146, 23.5285447537899, 22.850128561258316, 24.168358729220927, 37.962977044284344, 37.485037833452225, 38.178062062710524, 22.454702752331883, 22.23664068679014, 22.49550028766194, -105.00720231235027, -104.85047905147076, -127.11464023590088, 24.293048970401287, 24.44868180155754, 24.115262880921364, 35.343862238650516, 35.011284833153084, 34.981880260010556, 35.231299641231686, 35.813738396022615, 35.39153909186521, 30.18863449121514, 30.28079496944943, 30.183089117209107, 31.46487134943405, 31.880881329687924, 31.852264115276427, 25.03295274078846, 24.734640955924988, 24.621811524033546, 32.16319450115164, 31.969806914528206, 31.824187663694218, 24.79610366870959, 24.703004752596215, 25.222985009973243, 43.10043894809981, 42.711140160759285, 42.961722911645964, 42.32416347165902, 42.618256886800125, 43.21926064587508, 32.10077564915021, 32.09333849822481, 31.85592695822318, 7.157396805783108, 6.296698768933609, 7.394514723060027, 31.3437558847169, 30.9170833180348, 30.642695570985467, 34.05795960128307, 34.29324070364237, 33.452846840023994, 25.254730814757437, 25.233586984376103, 24.940661932031304, 27.186762887363628, 27.005314269413546, 26.617849191029862, 28.11491233110428, 28.215150840580463, 28.790000495966524, 31.144949850936726, 31.463384853055075, 31.564160819475845, 37.67121785382429, 37.81469517449537, 37.77071668828526, 30.361492710808903, 30.605564492444188, 30.636056943486125, 29.37994338820377, 28.709537799159676, 28.99945821861425, 33.705786054333046, 33.667010736962155, 33.95889406775434, 30.95417898769179, 31.071514651800186, 31.1542972542035, 29.235524800916508, 29.526480478545025, 29.64982127336164, 38.73119325128694, 38.602971506615475, 38.68571113546689, 28.16724270830551, 28.10452644030252, 28.171924802164227, 25.880994980533913, 25.80619156112273, 25.466850658257798, 25.863628168900803, 26.33271270928283, 26.329810698827103, 37.847238103548676, 38.19785344849029, 38.30539872373143, 25.46624632676442, 25.5246476282676, 26.09235180666049, 36.78215050697327, 36.62659206986427, 36.81467065215111, 25.200504032274083, 25.74033463404824, 25.518020843466118, 37.484317670265824, 37.73672217192748, 37.68709994542101, 31.455751574287802, 31.59580804236853, 30.929782698551804, 33.95442904547477, 33.62112546215454, 33.49050665150085, 32.319436341524124, 32.5284926854074, 32.296273306012154, 30.7730594476064, 30.703217556079224, 31.03794755538304, 34.560661802689225, 34.46201954285303, 34.81246922413507, 18.02589190999666, 18.336461837093026, 18.617927812660724, 32.53501471877098, 32.54585186764598, 32.56301187723875, 27.280027113854885, 27.711623054463416, 27.530367143452168, 26.463384222239256, 26.382066927850246, 26.39089571684599, 24.60232039541006, 24.814895555377007, 24.941015519201756, 27.154102275768906, 27.4193717415134, 27.762736004466802, 25.52355560412009, 25.733320609976843, 25.814717290302113, 11.971985787153244, 12.490462265908718, 12.594846799969673, 34.43165203432241, 34.49171157429615, 34.36185074845949, 30.069211428364113, 30.797612336774662, 30.63740525891383, 30.27934209009011, 30.572052230437592, 30.217549358805016, 34.140456219514206, 34.41284993042548, 34.020367463429764, 30.05840641260147, 30.290316686034203, 30.053401671350002, 40.398226504524544, 40.383663562436894, 40.59665208061536, 45.76337763977547, 45.774896544714764, 45.300232497354344, 28.242758971949414, 28.22189727177222, 28.07208826144536, 39.98124978442986, 39.82305942972501, 40.111440521975354, 31.460718624293804, 31.587851606309414, 31.65230806916952, 30.88706523180008, 31.365118324756622, 31.160377003252506, 38.8463182374835, 39.24074072390795, 39.34734123991802, -95.87659168243408, -79.75827194005251, -79.27866419497877, 35.79405017072955, 35.312470326821, 36.07045337200785, 30.071682808299855, 29.736455631752804, 30.088655435790614, 31.395956819256142, 31.178136450548962, 31.506605941181377, 25.164229514698178, 25.02883197615543, 24.89431274930635, 25.496543700496346, 25.89915223295489, 26.03662239263454, 21.29110286074379, 20.949399108688027, 20.89664218078056, 29.837817758321762, 30.078966714441776, 29.993309400975704, 42.72480761756499, 42.337692250808075, 42.71282788490255, -85.32463882106822, -100.33702147006989, -85.40838038362563, 36.22791113704443, 36.30307400971651, 36.71741013787687, 36.4795294975241, 36.46537182976802, 36.487877910335854, 41.671054167052105, 41.02247714002927, 41.38683385153611, -98.8624873061975, -98.13978810360035, -106.61136515935263, 36.5927848269542, 36.979474653800324, 36.9997245122989, 32.39910162985325, 32.39450288936496, 32.70458390194108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14413888724293875, "mean_inference_ms": 0.6978847999516988, "mean_action_processing_ms": 0.09641442493413958, "mean_env_wait_ms": 0.8057372499450065, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 405000, "timesteps_this_iter": 0, "agent_timesteps_total": 1215000, "timers": {"sample_time_ms": 10468.459, "sample_throughput": 477.625, "load_time_ms": 0.253, "load_throughput": 19793789.523, "learn_time_ms": 1984.852, "learn_throughput": 2519.079, "update_time_ms": 9.77}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.673617379884036e-20, "cur_lr": 0.0005000000000000001, "total_loss": 160.4046432495117, "policy_loss": -0.003727425548695029, "vf_loss": 160.48762054443358, "vf_explained_var": 0.07074488401412964, "kl": 0.004689508536844187, "entropy": 7.924942874908448, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 405000, "num_agent_steps_sampled": 1215000, "num_steps_trained": 405000, "num_agent_steps_trained": 1215000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1472, "training_iteration": 81, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-15-58", "timestamp": 1706231758, "time_this_iter_s": 10.188934564590454, "time_total_s": 874.6948504447937, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402417DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 874.6948504447937, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 5.453333333333333, "ram_util_percent": 59.980000000000004}}
{"episode_reward_max": 142.27761249616748, "episode_reward_min": -336.9723215997219, "episode_reward_mean": 74.33404726738895, "episode_len_mean": 479.47, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -127.11464023590088}, "policy_reward_max": {"shared_policy": 47.51561456546186}, "policy_reward_mean": {"shared_policy": 24.778015755796314}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.40923753380774, 79.7070502452552, 84.03261094167827, 111.53961457870898, 87.92313183471559, 89.86920697987077, 93.76374493353066, 92.81117045879364, 105.25347655196671, 47.784670952707515, 86.51932916603981, 70.54703204426914, 113.62607694044709, 67.18684372678396, -336.9723215997219, 72.85699365288019, 105.33702733181416, 106.43657712911951, 90.65251857787368, 95.1980167943984, 74.389405220747, 95.95718907937406, 74.72209343127905, 128.77330202050513, 128.16168100433424, 96.0500411055982, 20.848610297776744, 92.90353477373716, 101.80404714494944, 75.42897973116484, 80.80992634780704, 85.12006366765127, 94.17249552346765, 113.25662971660492, 91.60311414673922, 87.0889394059777, 101.33169085904954, 93.17999089369548, 88.41182655282317, 116.0198758933693, 84.44369395077226, 77.15403719991444, 78.52615157701074, 114.3504902757704, 77.08324576169251, 110.22341322898865, 76.45885950978844, 112.90813978761432, 93.98134231520814, 101.06606115913016, 97.14420233294368, 92.51422455906867, 103.83515056967732, 54.98028155975041, 97.64387846365571, 82.52201731177047, 79.23634686693549, 74.35823146998882, 82.33621002174911, 77.07159350439905, 37.057294853031635, 103.28521435707805, 91.5042290240526, 91.06894367933272, 102.57367361336945, 90.40212476998568, 121.3785421475768, 136.8385066818446, 84.536744505167, 119.91574973613022, 94.70087829977274, 93.41256055980921, 117.43440020130947, -254.91352781746536, 107.1769738695584, 89.89679387584327, 94.08069921098648, 75.08737424015996, 77.43231832608578, 63.13714415021238, 89.91009387373924, 127.77532775327562, -271.07004067476373, 109.24839528463781, 109.43277923762797, 124.08036515861748, -303.61364056915045, 110.57198399305342, 97.49818842115928, 111.89264606311916, 110.10965425893664, 142.27761249616748, -302.56297191232443, 76.42212012223898, 102.5090076178312, 82.58310768753289, 114.99531225115061, 80.18631748855114, 114.33596741547808, 105.46284547075629], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 166, 500, 500, 500, 500, 500, 500, 500, 500, 90, 500, 500, 500, 63, 500, 500, 500, 500, 500, 62, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [31.062910621364907, 31.183312897880867, 31.163014014561966, 26.62798128897944, 26.49493737022081, 26.58413158605495, 28.217767411222056, 27.976779778798416, 27.8380637516578, 37.523390211785824, 36.685972715417535, 37.33025165150562, 29.23639989395936, 29.439002768446997, 29.247729172309235, 29.678028667966515, 30.09998186926046, 30.091196442643792, 30.951348679761082, 31.354129730413348, 31.45826652335623, 30.964632119983435, 30.98707166686654, 30.859466671943665, 35.20581694870876, 34.96944812561074, 35.078211477647216, 15.755915520091847, 16.04981218402584, 15.978943248589829, 29.033548108030416, 29.035021433567934, 28.45075962444146, 23.5285447537899, 22.850128561258316, 24.168358729220927, 37.962977044284344, 37.485037833452225, 38.178062062710524, 22.454702752331883, 22.23664068679014, 22.49550028766194, -105.00720231235027, -104.85047905147076, -127.11464023590088, 24.293048970401287, 24.44868180155754, 24.115262880921364, 35.343862238650516, 35.011284833153084, 34.981880260010556, 35.231299641231686, 35.813738396022615, 35.39153909186521, 30.18863449121514, 30.28079496944943, 30.183089117209107, 31.46487134943405, 31.880881329687924, 31.852264115276427, 25.03295274078846, 24.734640955924988, 24.621811524033546, 32.16319450115164, 31.969806914528206, 31.824187663694218, 24.79610366870959, 24.703004752596215, 25.222985009973243, 43.10043894809981, 42.711140160759285, 42.961722911645964, 42.32416347165902, 42.618256886800125, 43.21926064587508, 32.10077564915021, 32.09333849822481, 31.85592695822318, 7.157396805783108, 6.296698768933609, 7.394514723060027, 31.3437558847169, 30.9170833180348, 30.642695570985467, 34.05795960128307, 34.29324070364237, 33.452846840023994, 25.254730814757437, 25.233586984376103, 24.940661932031304, 27.186762887363628, 27.005314269413546, 26.617849191029862, 28.11491233110428, 28.215150840580463, 28.790000495966524, 31.144949850936726, 31.463384853055075, 31.564160819475845, 37.67121785382429, 37.81469517449537, 37.77071668828526, 30.361492710808903, 30.605564492444188, 30.636056943486125, 29.37994338820377, 28.709537799159676, 28.99945821861425, 33.705786054333046, 33.667010736962155, 33.95889406775434, 30.95417898769179, 31.071514651800186, 31.1542972542035, 29.235524800916508, 29.526480478545025, 29.64982127336164, 38.73119325128694, 38.602971506615475, 38.68571113546689, 28.16724270830551, 28.10452644030252, 28.171924802164227, 25.880994980533913, 25.80619156112273, 25.466850658257798, 25.863628168900803, 26.33271270928283, 26.329810698827103, 37.847238103548676, 38.19785344849029, 38.30539872373143, 25.46624632676442, 25.5246476282676, 26.09235180666049, 36.78215050697327, 36.62659206986427, 36.81467065215111, 25.200504032274083, 25.74033463404824, 25.518020843466118, 37.484317670265824, 37.73672217192748, 37.68709994542101, 31.455751574287802, 31.59580804236853, 30.929782698551804, 33.95442904547477, 33.62112546215454, 33.49050665150085, 32.319436341524124, 32.5284926854074, 32.296273306012154, 30.7730594476064, 30.703217556079224, 31.03794755538304, 34.560661802689225, 34.46201954285303, 34.81246922413507, 18.02589190999666, 18.336461837093026, 18.617927812660724, 32.53501471877098, 32.54585186764598, 32.56301187723875, 27.280027113854885, 27.711623054463416, 27.530367143452168, 26.463384222239256, 26.382066927850246, 26.39089571684599, 24.60232039541006, 24.814895555377007, 24.941015519201756, 27.154102275768906, 27.4193717415134, 27.762736004466802, 25.52355560412009, 25.733320609976843, 25.814717290302113, 11.971985787153244, 12.490462265908718, 12.594846799969673, 34.43165203432241, 34.49171157429615, 34.36185074845949, 30.069211428364113, 30.797612336774662, 30.63740525891383, 30.27934209009011, 30.572052230437592, 30.217549358805016, 34.140456219514206, 34.41284993042548, 34.020367463429764, 30.05840641260147, 30.290316686034203, 30.053401671350002, 40.398226504524544, 40.383663562436894, 40.59665208061536, 45.76337763977547, 45.774896544714764, 45.300232497354344, 28.242758971949414, 28.22189727177222, 28.07208826144536, 39.98124978442986, 39.82305942972501, 40.111440521975354, 31.460718624293804, 31.587851606309414, 31.65230806916952, 30.88706523180008, 31.365118324756622, 31.160377003252506, 38.8463182374835, 39.24074072390795, 39.34734123991802, -95.87659168243408, -79.75827194005251, -79.27866419497877, 35.79405017072955, 35.312470326821, 36.07045337200785, 30.071682808299855, 29.736455631752804, 30.088655435790614, 31.395956819256142, 31.178136450548962, 31.506605941181377, 25.164229514698178, 25.02883197615543, 24.89431274930635, 25.496543700496346, 25.89915223295489, 26.03662239263454, 21.29110286074379, 20.949399108688027, 20.89664218078056, 29.837817758321762, 30.078966714441776, 29.993309400975704, 42.72480761756499, 42.337692250808075, 42.71282788490255, -85.32463882106822, -100.33702147006989, -85.40838038362563, 36.22791113704443, 36.30307400971651, 36.71741013787687, 36.4795294975241, 36.46537182976802, 36.487877910335854, 41.671054167052105, 41.02247714002927, 41.38683385153611, -98.8624873061975, -98.13978810360035, -106.61136515935263, 36.5927848269542, 36.979474653800324, 36.9997245122989, 32.39910162985325, 32.39450288936496, 32.70458390194108, 37.16947928567727, 37.44273627673586, 37.28043050070603, 36.90076785907149, 36.5779599994421, 36.63092640042305, 47.27468679845332, 47.51561456546186, 47.4873111322522, -97.02774296700954, -107.11943901330233, -98.41578993201256, 25.50847256680329, 25.33179821570714, 25.58184933972855, 34.144187475244195, 34.09110927830139, 34.27371086428562, 27.633832332988575, 27.47571063538392, 27.473564719160393, 38.348056614398956, 38.4577956572175, 38.18945997953415, 26.654115170240402, 26.822502985596657, 26.70969933271408, 38.47655749460682, 37.96954222768545, 37.889867693185806, 35.21345363929868, 34.96340721845627, 35.28598461300135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1440239446582776, "mean_inference_ms": 0.6976584012400942, "mean_action_processing_ms": 0.09638958340468678, "mean_env_wait_ms": 0.8051649273541535, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 410000, "timesteps_this_iter": 0, "agent_timesteps_total": 1230000, "timers": {"sample_time_ms": 10438.308, "sample_throughput": 479.005, "load_time_ms": 0.151, "load_throughput": 33119898.926, "learn_time_ms": 1978.647, "learn_throughput": 2526.979, "update_time_ms": 9.781}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.336808689942018e-20, "cur_lr": 0.0005000000000000001, "total_loss": 78.07111740112305, "policy_loss": -0.002773957548110434, "vf_loss": 78.15375137329102, "vf_explained_var": 0.09418808221817017, "kl": 0.005757068831021028, "entropy": 7.985936307907105, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 410000, "num_agent_steps_sampled": 1230000, "num_steps_trained": 410000, "num_agent_steps_trained": 1230000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1483, "training_iteration": 82, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-16-08", "timestamp": 1706231768, "time_this_iter_s": 10.281383037567139, "time_total_s": 884.9762334823608, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021404232D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 884.9762334823608, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 5.821428571428571, "ram_util_percent": 59.978571428571435}}
{"episode_reward_max": 142.27761249616748, "episode_reward_min": -336.9723215997219, "episode_reward_mean": 74.56134431139654, "episode_len_mean": 479.47, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -127.11464023590088}, "policy_reward_max": {"shared_policy": 47.51561456546186}, "policy_reward_mean": {"shared_policy": 24.85378143713217}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.51932916603981, 70.54703204426914, 113.62607694044709, 67.18684372678396, -336.9723215997219, 72.85699365288019, 105.33702733181416, 106.43657712911951, 90.65251857787368, 95.1980167943984, 74.389405220747, 95.95718907937406, 74.72209343127905, 128.77330202050513, 128.16168100433424, 96.0500411055982, 20.848610297776744, 92.90353477373716, 101.80404714494944, 75.42897973116484, 80.80992634780704, 85.12006366765127, 94.17249552346765, 113.25662971660492, 91.60311414673922, 87.0889394059777, 101.33169085904954, 93.17999089369548, 88.41182655282317, 116.0198758933693, 84.44369395077226, 77.15403719991444, 78.52615157701074, 114.3504902757704, 77.08324576169251, 110.22341322898865, 76.45885950978844, 112.90813978761432, 93.98134231520814, 101.06606115913016, 97.14420233294368, 92.51422455906867, 103.83515056967732, 54.98028155975041, 97.64387846365571, 82.52201731177047, 79.23634686693549, 74.35823146998882, 82.33621002174911, 77.07159350439905, 37.057294853031635, 103.28521435707805, 91.5042290240526, 91.06894367933272, 102.57367361336945, 90.40212476998568, 121.3785421475768, 136.8385066818446, 84.536744505167, 119.91574973613022, 94.70087829977274, 93.41256055980921, 117.43440020130947, -254.91352781746536, 107.1769738695584, 89.89679387584327, 94.08069921098648, 75.08737424015996, 77.43231832608578, 63.13714415021238, 89.91009387373924, 127.77532775327562, -271.07004067476373, 109.24839528463781, 109.43277923762797, 124.08036515861748, -303.61364056915045, 110.57198399305342, 97.49818842115928, 111.89264606311916, 110.10965425893664, 142.27761249616748, -302.56297191232443, 76.42212012223898, 102.5090076178312, 82.58310768753289, 114.99531225115061, 80.18631748855114, 114.33596741547808, 105.46284547075629, 97.71480644121763, 71.18771148147059, 80.4629828222096, 91.12261090707032, 115.86906661838292, 70.53434547781941, 115.56505184248088, 87.8063565008342, 80.4506935290992, 98.10999379120766], "episode_lengths": [500, 500, 500, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 166, 500, 500, 500, 500, 500, 500, 500, 500, 90, 500, 500, 500, 63, 500, 500, 500, 500, 500, 62, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [29.033548108030416, 29.035021433567934, 28.45075962444146, 23.5285447537899, 22.850128561258316, 24.168358729220927, 37.962977044284344, 37.485037833452225, 38.178062062710524, 22.454702752331883, 22.23664068679014, 22.49550028766194, -105.00720231235027, -104.85047905147076, -127.11464023590088, 24.293048970401287, 24.44868180155754, 24.115262880921364, 35.343862238650516, 35.011284833153084, 34.981880260010556, 35.231299641231686, 35.813738396022615, 35.39153909186521, 30.18863449121514, 30.28079496944943, 30.183089117209107, 31.46487134943405, 31.880881329687924, 31.852264115276427, 25.03295274078846, 24.734640955924988, 24.621811524033546, 32.16319450115164, 31.969806914528206, 31.824187663694218, 24.79610366870959, 24.703004752596215, 25.222985009973243, 43.10043894809981, 42.711140160759285, 42.961722911645964, 42.32416347165902, 42.618256886800125, 43.21926064587508, 32.10077564915021, 32.09333849822481, 31.85592695822318, 7.157396805783108, 6.296698768933609, 7.394514723060027, 31.3437558847169, 30.9170833180348, 30.642695570985467, 34.05795960128307, 34.29324070364237, 33.452846840023994, 25.254730814757437, 25.233586984376103, 24.940661932031304, 27.186762887363628, 27.005314269413546, 26.617849191029862, 28.11491233110428, 28.215150840580463, 28.790000495966524, 31.144949850936726, 31.463384853055075, 31.564160819475845, 37.67121785382429, 37.81469517449537, 37.77071668828526, 30.361492710808903, 30.605564492444188, 30.636056943486125, 29.37994338820377, 28.709537799159676, 28.99945821861425, 33.705786054333046, 33.667010736962155, 33.95889406775434, 30.95417898769179, 31.071514651800186, 31.1542972542035, 29.235524800916508, 29.526480478545025, 29.64982127336164, 38.73119325128694, 38.602971506615475, 38.68571113546689, 28.16724270830551, 28.10452644030252, 28.171924802164227, 25.880994980533913, 25.80619156112273, 25.466850658257798, 25.863628168900803, 26.33271270928283, 26.329810698827103, 37.847238103548676, 38.19785344849029, 38.30539872373143, 25.46624632676442, 25.5246476282676, 26.09235180666049, 36.78215050697327, 36.62659206986427, 36.81467065215111, 25.200504032274083, 25.74033463404824, 25.518020843466118, 37.484317670265824, 37.73672217192748, 37.68709994542101, 31.455751574287802, 31.59580804236853, 30.929782698551804, 33.95442904547477, 33.62112546215454, 33.49050665150085, 32.319436341524124, 32.5284926854074, 32.296273306012154, 30.7730594476064, 30.703217556079224, 31.03794755538304, 34.560661802689225, 34.46201954285303, 34.81246922413507, 18.02589190999666, 18.336461837093026, 18.617927812660724, 32.53501471877098, 32.54585186764598, 32.56301187723875, 27.280027113854885, 27.711623054463416, 27.530367143452168, 26.463384222239256, 26.382066927850246, 26.39089571684599, 24.60232039541006, 24.814895555377007, 24.941015519201756, 27.154102275768906, 27.4193717415134, 27.762736004466802, 25.52355560412009, 25.733320609976843, 25.814717290302113, 11.971985787153244, 12.490462265908718, 12.594846799969673, 34.43165203432241, 34.49171157429615, 34.36185074845949, 30.069211428364113, 30.797612336774662, 30.63740525891383, 30.27934209009011, 30.572052230437592, 30.217549358805016, 34.140456219514206, 34.41284993042548, 34.020367463429764, 30.05840641260147, 30.290316686034203, 30.053401671350002, 40.398226504524544, 40.383663562436894, 40.59665208061536, 45.76337763977547, 45.774896544714764, 45.300232497354344, 28.242758971949414, 28.22189727177222, 28.07208826144536, 39.98124978442986, 39.82305942972501, 40.111440521975354, 31.460718624293804, 31.587851606309414, 31.65230806916952, 30.88706523180008, 31.365118324756622, 31.160377003252506, 38.8463182374835, 39.24074072390795, 39.34734123991802, -95.87659168243408, -79.75827194005251, -79.27866419497877, 35.79405017072955, 35.312470326821, 36.07045337200785, 30.071682808299855, 29.736455631752804, 30.088655435790614, 31.395956819256142, 31.178136450548962, 31.506605941181377, 25.164229514698178, 25.02883197615543, 24.89431274930635, 25.496543700496346, 25.89915223295489, 26.03662239263454, 21.29110286074379, 20.949399108688027, 20.89664218078056, 29.837817758321762, 30.078966714441776, 29.993309400975704, 42.72480761756499, 42.337692250808075, 42.71282788490255, -85.32463882106822, -100.33702147006989, -85.40838038362563, 36.22791113704443, 36.30307400971651, 36.71741013787687, 36.4795294975241, 36.46537182976802, 36.487877910335854, 41.671054167052105, 41.02247714002927, 41.38683385153611, -98.8624873061975, -98.13978810360035, -106.61136515935263, 36.5927848269542, 36.979474653800324, 36.9997245122989, 32.39910162985325, 32.39450288936496, 32.70458390194108, 37.16947928567727, 37.44273627673586, 37.28043050070603, 36.90076785907149, 36.5779599994421, 36.63092640042305, 47.27468679845332, 47.51561456546186, 47.4873111322522, -97.02774296700954, -107.11943901330233, -98.41578993201256, 25.50847256680329, 25.33179821570714, 25.58184933972855, 34.144187475244195, 34.09110927830139, 34.27371086428562, 27.633832332988575, 27.47571063538392, 27.473564719160393, 38.348056614398956, 38.4577956572175, 38.18945997953415, 26.654115170240402, 26.822502985596657, 26.70969933271408, 38.47655749460682, 37.96954222768545, 37.889867693185806, 35.21345363929868, 34.96340721845627, 35.28598461300135, 32.37214798728624, 32.61593571553627, 32.726722738395125, 23.9133492965872, 23.350281218687684, 23.924080966195703, 26.812518388032913, 26.48378498852253, 27.166679445654154, 30.568034997520343, 30.490442215775445, 30.064133693774536, 38.551735175152615, 38.58918294807275, 38.728148495157555, 22.990384588638932, 23.845588977138192, 23.69837191204229, 38.427080908169344, 38.59032167618473, 38.54764925812681, 29.22126584003368, 29.135598840812833, 29.449491819987685, 27.0599533903102, 26.799150156478078, 26.59158998231092, 32.566812490423516, 32.33843923111756, 33.20474206966658]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14393847261195256, "mean_inference_ms": 0.6974811263287475, "mean_action_processing_ms": 0.09637721296135843, "mean_env_wait_ms": 0.8046420788687069, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 415000, "timesteps_this_iter": 0, "agent_timesteps_total": 1245000, "timers": {"sample_time_ms": 10449.741, "sample_throughput": 478.481, "load_time_ms": 0.151, "load_throughput": 33119898.926, "learn_time_ms": 1973.937, "learn_throughput": 2533.009, "update_time_ms": 9.781}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.336808689942018e-20, "cur_lr": 0.0005000000000000001, "total_loss": 7.9792969703674315, "policy_loss": -0.0018582942458428065, "vf_loss": 8.06220498085022, "vf_explained_var": -0.34565807580947877, "kl": 0.0028734773979665366, "entropy": 8.104984664916993, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 415000, "num_agent_steps_sampled": 1245000, "num_steps_trained": 415000, "num_agent_steps_trained": 1245000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1493, "training_iteration": 83, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-16-19", "timestamp": 1706231779, "time_this_iter_s": 10.389689922332764, "time_total_s": 895.3659234046936, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402417F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 895.3659234046936, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 7.826666666666666, "ram_util_percent": 60.08000000000001}}
{"episode_reward_max": 142.27761249616748, "episode_reward_min": -303.61364056915045, "episode_reward_mean": 78.67649583341466, "episode_len_mean": 483.81, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -107.11943901330233}, "policy_reward_max": {"shared_policy": 47.51561456546186}, "policy_reward_mean": {"shared_policy": 26.225498611138214}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.389405220747, 95.95718907937406, 74.72209343127905, 128.77330202050513, 128.16168100433424, 96.0500411055982, 20.848610297776744, 92.90353477373716, 101.80404714494944, 75.42897973116484, 80.80992634780704, 85.12006366765127, 94.17249552346765, 113.25662971660492, 91.60311414673922, 87.0889394059777, 101.33169085904954, 93.17999089369548, 88.41182655282317, 116.0198758933693, 84.44369395077226, 77.15403719991444, 78.52615157701074, 114.3504902757704, 77.08324576169251, 110.22341322898865, 76.45885950978844, 112.90813978761432, 93.98134231520814, 101.06606115913016, 97.14420233294368, 92.51422455906867, 103.83515056967732, 54.98028155975041, 97.64387846365571, 82.52201731177047, 79.23634686693549, 74.35823146998882, 82.33621002174911, 77.07159350439905, 37.057294853031635, 103.28521435707805, 91.5042290240526, 91.06894367933272, 102.57367361336945, 90.40212476998568, 121.3785421475768, 136.8385066818446, 84.536744505167, 119.91574973613022, 94.70087829977274, 93.41256055980921, 117.43440020130947, -254.91352781746536, 107.1769738695584, 89.89679387584327, 94.08069921098648, 75.08737424015996, 77.43231832608578, 63.13714415021238, 89.91009387373924, 127.77532775327562, -271.07004067476373, 109.24839528463781, 109.43277923762797, 124.08036515861748, -303.61364056915045, 110.57198399305342, 97.49818842115928, 111.89264606311916, 110.10965425893664, 142.27761249616748, -302.56297191232443, 76.42212012223898, 102.5090076178312, 82.58310768753289, 114.99531225115061, 80.18631748855114, 114.33596741547808, 105.46284547075629, 97.71480644121763, 71.18771148147059, 80.4629828222096, 91.12261090707032, 115.86906661838292, 70.53434547781941, 115.56505184248088, 87.8063565008342, 80.4506935290992, 98.10999379120766, 87.66169406194237, 96.96513341553508, 81.67421351745723, 123.17847246304154, 101.14233145210892, 33.30630826437846, 82.45331529062241, 74.17609300464392, 116.91233664751053, 85.43334784847684], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 166, 500, 500, 500, 500, 500, 500, 500, 500, 90, 500, 500, 500, 63, 500, 500, 500, 500, 500, 62, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [25.03295274078846, 24.734640955924988, 24.621811524033546, 32.16319450115164, 31.969806914528206, 31.824187663694218, 24.79610366870959, 24.703004752596215, 25.222985009973243, 43.10043894809981, 42.711140160759285, 42.961722911645964, 42.32416347165902, 42.618256886800125, 43.21926064587508, 32.10077564915021, 32.09333849822481, 31.85592695822318, 7.157396805783108, 6.296698768933609, 7.394514723060027, 31.3437558847169, 30.9170833180348, 30.642695570985467, 34.05795960128307, 34.29324070364237, 33.452846840023994, 25.254730814757437, 25.233586984376103, 24.940661932031304, 27.186762887363628, 27.005314269413546, 26.617849191029862, 28.11491233110428, 28.215150840580463, 28.790000495966524, 31.144949850936726, 31.463384853055075, 31.564160819475845, 37.67121785382429, 37.81469517449537, 37.77071668828526, 30.361492710808903, 30.605564492444188, 30.636056943486125, 29.37994338820377, 28.709537799159676, 28.99945821861425, 33.705786054333046, 33.667010736962155, 33.95889406775434, 30.95417898769179, 31.071514651800186, 31.1542972542035, 29.235524800916508, 29.526480478545025, 29.64982127336164, 38.73119325128694, 38.602971506615475, 38.68571113546689, 28.16724270830551, 28.10452644030252, 28.171924802164227, 25.880994980533913, 25.80619156112273, 25.466850658257798, 25.863628168900803, 26.33271270928283, 26.329810698827103, 37.847238103548676, 38.19785344849029, 38.30539872373143, 25.46624632676442, 25.5246476282676, 26.09235180666049, 36.78215050697327, 36.62659206986427, 36.81467065215111, 25.200504032274083, 25.74033463404824, 25.518020843466118, 37.484317670265824, 37.73672217192748, 37.68709994542101, 31.455751574287802, 31.59580804236853, 30.929782698551804, 33.95442904547477, 33.62112546215454, 33.49050665150085, 32.319436341524124, 32.5284926854074, 32.296273306012154, 30.7730594476064, 30.703217556079224, 31.03794755538304, 34.560661802689225, 34.46201954285303, 34.81246922413507, 18.02589190999666, 18.336461837093026, 18.617927812660724, 32.53501471877098, 32.54585186764598, 32.56301187723875, 27.280027113854885, 27.711623054463416, 27.530367143452168, 26.463384222239256, 26.382066927850246, 26.39089571684599, 24.60232039541006, 24.814895555377007, 24.941015519201756, 27.154102275768906, 27.4193717415134, 27.762736004466802, 25.52355560412009, 25.733320609976843, 25.814717290302113, 11.971985787153244, 12.490462265908718, 12.594846799969673, 34.43165203432241, 34.49171157429615, 34.36185074845949, 30.069211428364113, 30.797612336774662, 30.63740525891383, 30.27934209009011, 30.572052230437592, 30.217549358805016, 34.140456219514206, 34.41284993042548, 34.020367463429764, 30.05840641260147, 30.290316686034203, 30.053401671350002, 40.398226504524544, 40.383663562436894, 40.59665208061536, 45.76337763977547, 45.774896544714764, 45.300232497354344, 28.242758971949414, 28.22189727177222, 28.07208826144536, 39.98124978442986, 39.82305942972501, 40.111440521975354, 31.460718624293804, 31.587851606309414, 31.65230806916952, 30.88706523180008, 31.365118324756622, 31.160377003252506, 38.8463182374835, 39.24074072390795, 39.34734123991802, -95.87659168243408, -79.75827194005251, -79.27866419497877, 35.79405017072955, 35.312470326821, 36.07045337200785, 30.071682808299855, 29.736455631752804, 30.088655435790614, 31.395956819256142, 31.178136450548962, 31.506605941181377, 25.164229514698178, 25.02883197615543, 24.89431274930635, 25.496543700496346, 25.89915223295489, 26.03662239263454, 21.29110286074379, 20.949399108688027, 20.89664218078056, 29.837817758321762, 30.078966714441776, 29.993309400975704, 42.72480761756499, 42.337692250808075, 42.71282788490255, -85.32463882106822, -100.33702147006989, -85.40838038362563, 36.22791113704443, 36.30307400971651, 36.71741013787687, 36.4795294975241, 36.46537182976802, 36.487877910335854, 41.671054167052105, 41.02247714002927, 41.38683385153611, -98.8624873061975, -98.13978810360035, -106.61136515935263, 36.5927848269542, 36.979474653800324, 36.9997245122989, 32.39910162985325, 32.39450288936496, 32.70458390194108, 37.16947928567727, 37.44273627673586, 37.28043050070603, 36.90076785907149, 36.5779599994421, 36.63092640042305, 47.27468679845332, 47.51561456546186, 47.4873111322522, -97.02774296700954, -107.11943901330233, -98.41578993201256, 25.50847256680329, 25.33179821570714, 25.58184933972855, 34.144187475244195, 34.09110927830139, 34.27371086428562, 27.633832332988575, 27.47571063538392, 27.473564719160393, 38.348056614398956, 38.4577956572175, 38.18945997953415, 26.654115170240402, 26.822502985596657, 26.70969933271408, 38.47655749460682, 37.96954222768545, 37.889867693185806, 35.21345363929868, 34.96340721845627, 35.28598461300135, 32.37214798728624, 32.61593571553627, 32.726722738395125, 23.9133492965872, 23.350281218687684, 23.924080966195703, 26.812518388032913, 26.48378498852253, 27.166679445654154, 30.568034997520343, 30.490442215775445, 30.064133693774536, 38.551735175152615, 38.58918294807275, 38.728148495157555, 22.990384588638932, 23.845588977138192, 23.69837191204229, 38.427080908169344, 38.59032167618473, 38.54764925812681, 29.22126584003368, 29.135598840812833, 29.449491819987685, 27.0599533903102, 26.799150156478078, 26.59158998231092, 32.566812490423516, 32.33843923111756, 33.20474206966658, 28.961545834938676, 29.332143706890434, 29.36800452011326, 32.13877945144971, 32.15311250587304, 32.67324145821233, 27.51096686845024, 27.140834895273045, 27.022411753733948, 41.26552553847432, 41.14513240754604, 40.76781451702118, 33.61133350431919, 34.04037167225033, 33.4906262755394, 11.128231892827898, 11.069348396733403, 11.108727974817157, 27.392102722078562, 27.483858782798052, 27.5773537857458, 24.957106970250607, 24.62146259844303, 24.59752343595028, 39.0025025466457, 38.900541346520185, 39.00929275434464, 28.438714757561684, 28.924287331523374, 28.070345759391785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14385004490171663, "mean_inference_ms": 0.6972746759169242, "mean_action_processing_ms": 0.09635977975205275, "mean_env_wait_ms": 0.8041080281151859, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 420000, "timesteps_this_iter": 0, "agent_timesteps_total": 1260000, "timers": {"sample_time_ms": 10424.32, "sample_throughput": 479.648, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1963.652, "learn_throughput": 2546.276, "update_time_ms": 9.807}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.168404344971009e-20, "cur_lr": 0.0005000000000000001, "total_loss": 6.150747203826905, "policy_loss": -0.002161793521466571, "vf_loss": 6.234795951843262, "vf_explained_var": -0.3013827919960022, "kl": 0.0019624499196805815, "entropy": 8.188688850402832, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 420000, "num_agent_steps_sampled": 1260000, "num_steps_trained": 420000, "num_agent_steps_trained": 1260000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1503, "training_iteration": 84, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-16-29", "timestamp": 1706231789, "time_this_iter_s": 10.300225734710693, "time_total_s": 905.6661491394043, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214018EEF70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 905.6661491394043, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 8.035714285714286, "ram_util_percent": 60.092857142857156}}
{"episode_reward_max": 142.27761249616748, "episode_reward_min": -303.61364056915045, "episode_reward_mean": 78.33674990564963, "episode_len_mean": 483.81, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -107.11943901330233}, "policy_reward_max": {"shared_policy": 47.51561456546186}, "policy_reward_mean": {"shared_policy": 26.11224996854987}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.80992634780704, 85.12006366765127, 94.17249552346765, 113.25662971660492, 91.60311414673922, 87.0889394059777, 101.33169085904954, 93.17999089369548, 88.41182655282317, 116.0198758933693, 84.44369395077226, 77.15403719991444, 78.52615157701074, 114.3504902757704, 77.08324576169251, 110.22341322898865, 76.45885950978844, 112.90813978761432, 93.98134231520814, 101.06606115913016, 97.14420233294368, 92.51422455906867, 103.83515056967732, 54.98028155975041, 97.64387846365571, 82.52201731177047, 79.23634686693549, 74.35823146998882, 82.33621002174911, 77.07159350439905, 37.057294853031635, 103.28521435707805, 91.5042290240526, 91.06894367933272, 102.57367361336945, 90.40212476998568, 121.3785421475768, 136.8385066818446, 84.536744505167, 119.91574973613022, 94.70087829977274, 93.41256055980921, 117.43440020130947, -254.91352781746536, 107.1769738695584, 89.89679387584327, 94.08069921098648, 75.08737424015996, 77.43231832608578, 63.13714415021238, 89.91009387373924, 127.77532775327562, -271.07004067476373, 109.24839528463781, 109.43277923762797, 124.08036515861748, -303.61364056915045, 110.57198399305342, 97.49818842115928, 111.89264606311916, 110.10965425893664, 142.27761249616748, -302.56297191232443, 76.42212012223898, 102.5090076178312, 82.58310768753289, 114.99531225115061, 80.18631748855114, 114.33596741547808, 105.46284547075629, 97.71480644121763, 71.18771148147059, 80.4629828222096, 91.12261090707032, 115.86906661838292, 70.53434547781941, 115.56505184248088, 87.8063565008342, 80.4506935290992, 98.10999379120766, 87.66169406194237, 96.96513341553508, 81.67421351745723, 123.17847246304154, 101.14233145210892, 33.30630826437846, 82.45331529062241, 74.17609300464392, 116.91233664751053, 85.43334784847684, 67.88583164755254, 97.65899042412639, 94.60938843712209, 84.3833603784442, 74.06223936192688, 64.81639426294711, 81.70351854432371, 82.86446484178302, 104.18902479112147, 102.89107834361491], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 166, 500, 500, 500, 500, 500, 500, 500, 500, 90, 500, 500, 500, 63, 500, 500, 500, 500, 500, 62, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [27.186762887363628, 27.005314269413546, 26.617849191029862, 28.11491233110428, 28.215150840580463, 28.790000495966524, 31.144949850936726, 31.463384853055075, 31.564160819475845, 37.67121785382429, 37.81469517449537, 37.77071668828526, 30.361492710808903, 30.605564492444188, 30.636056943486125, 29.37994338820377, 28.709537799159676, 28.99945821861425, 33.705786054333046, 33.667010736962155, 33.95889406775434, 30.95417898769179, 31.071514651800186, 31.1542972542035, 29.235524800916508, 29.526480478545025, 29.64982127336164, 38.73119325128694, 38.602971506615475, 38.68571113546689, 28.16724270830551, 28.10452644030252, 28.171924802164227, 25.880994980533913, 25.80619156112273, 25.466850658257798, 25.863628168900803, 26.33271270928283, 26.329810698827103, 37.847238103548676, 38.19785344849029, 38.30539872373143, 25.46624632676442, 25.5246476282676, 26.09235180666049, 36.78215050697327, 36.62659206986427, 36.81467065215111, 25.200504032274083, 25.74033463404824, 25.518020843466118, 37.484317670265824, 37.73672217192748, 37.68709994542101, 31.455751574287802, 31.59580804236853, 30.929782698551804, 33.95442904547477, 33.62112546215454, 33.49050665150085, 32.319436341524124, 32.5284926854074, 32.296273306012154, 30.7730594476064, 30.703217556079224, 31.03794755538304, 34.560661802689225, 34.46201954285303, 34.81246922413507, 18.02589190999666, 18.336461837093026, 18.617927812660724, 32.53501471877098, 32.54585186764598, 32.56301187723875, 27.280027113854885, 27.711623054463416, 27.530367143452168, 26.463384222239256, 26.382066927850246, 26.39089571684599, 24.60232039541006, 24.814895555377007, 24.941015519201756, 27.154102275768906, 27.4193717415134, 27.762736004466802, 25.52355560412009, 25.733320609976843, 25.814717290302113, 11.971985787153244, 12.490462265908718, 12.594846799969673, 34.43165203432241, 34.49171157429615, 34.36185074845949, 30.069211428364113, 30.797612336774662, 30.63740525891383, 30.27934209009011, 30.572052230437592, 30.217549358805016, 34.140456219514206, 34.41284993042548, 34.020367463429764, 30.05840641260147, 30.290316686034203, 30.053401671350002, 40.398226504524544, 40.383663562436894, 40.59665208061536, 45.76337763977547, 45.774896544714764, 45.300232497354344, 28.242758971949414, 28.22189727177222, 28.07208826144536, 39.98124978442986, 39.82305942972501, 40.111440521975354, 31.460718624293804, 31.587851606309414, 31.65230806916952, 30.88706523180008, 31.365118324756622, 31.160377003252506, 38.8463182374835, 39.24074072390795, 39.34734123991802, -95.87659168243408, -79.75827194005251, -79.27866419497877, 35.79405017072955, 35.312470326821, 36.07045337200785, 30.071682808299855, 29.736455631752804, 30.088655435790614, 31.395956819256142, 31.178136450548962, 31.506605941181377, 25.164229514698178, 25.02883197615543, 24.89431274930635, 25.496543700496346, 25.89915223295489, 26.03662239263454, 21.29110286074379, 20.949399108688027, 20.89664218078056, 29.837817758321762, 30.078966714441776, 29.993309400975704, 42.72480761756499, 42.337692250808075, 42.71282788490255, -85.32463882106822, -100.33702147006989, -85.40838038362563, 36.22791113704443, 36.30307400971651, 36.71741013787687, 36.4795294975241, 36.46537182976802, 36.487877910335854, 41.671054167052105, 41.02247714002927, 41.38683385153611, -98.8624873061975, -98.13978810360035, -106.61136515935263, 36.5927848269542, 36.979474653800324, 36.9997245122989, 32.39910162985325, 32.39450288936496, 32.70458390194108, 37.16947928567727, 37.44273627673586, 37.28043050070603, 36.90076785907149, 36.5779599994421, 36.63092640042305, 47.27468679845332, 47.51561456546186, 47.4873111322522, -97.02774296700954, -107.11943901330233, -98.41578993201256, 25.50847256680329, 25.33179821570714, 25.58184933972855, 34.144187475244195, 34.09110927830139, 34.27371086428562, 27.633832332988575, 27.47571063538392, 27.473564719160393, 38.348056614398956, 38.4577956572175, 38.18945997953415, 26.654115170240402, 26.822502985596657, 26.70969933271408, 38.47655749460682, 37.96954222768545, 37.889867693185806, 35.21345363929868, 34.96340721845627, 35.28598461300135, 32.37214798728624, 32.61593571553627, 32.726722738395125, 23.9133492965872, 23.350281218687684, 23.924080966195703, 26.812518388032913, 26.48378498852253, 27.166679445654154, 30.568034997520343, 30.490442215775445, 30.064133693774536, 38.551735175152615, 38.58918294807275, 38.728148495157555, 22.990384588638932, 23.845588977138192, 23.69837191204229, 38.427080908169344, 38.59032167618473, 38.54764925812681, 29.22126584003368, 29.135598840812833, 29.449491819987685, 27.0599533903102, 26.799150156478078, 26.59158998231092, 32.566812490423516, 32.33843923111756, 33.20474206966658, 28.961545834938676, 29.332143706890434, 29.36800452011326, 32.13877945144971, 32.15311250587304, 32.67324145821233, 27.51096686845024, 27.140834895273045, 27.022411753733948, 41.26552553847432, 41.14513240754604, 40.76781451702118, 33.61133350431919, 34.04037167225033, 33.4906262755394, 11.128231892827898, 11.069348396733403, 11.108727974817157, 27.392102722078562, 27.483858782798052, 27.5773537857458, 24.957106970250607, 24.62146259844303, 24.59752343595028, 39.0025025466457, 38.900541346520185, 39.00929275434464, 28.438714757561684, 28.924287331523374, 28.070345759391785, 22.88858572238435, 22.35410101463397, 22.643144910534218, 32.48107486963272, 32.59821401536465, 32.57970153912902, 31.880787042280033, 31.934487977375582, 30.794113417466477, 27.930146023631096, 28.16660562157631, 28.28660873323679, 24.316027919451386, 25.106663145745785, 24.639548296729714, 21.5457486907641, 21.63659014614919, 21.634055426033825, 27.031719195346028, 27.126744310061127, 27.54505503891656, 27.345305303732545, 27.717621228347213, 27.80153830970326, 34.99473964174588, 34.638095920284584, 34.556189229091004, 34.48437780576447, 34.1038685987393, 34.302831939111144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1437719601256062, "mean_inference_ms": 0.6970939317007934, "mean_action_processing_ms": 0.09633366032148082, "mean_env_wait_ms": 0.8035954609228587, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 425000, "timesteps_this_iter": 0, "agent_timesteps_total": 1275000, "timers": {"sample_time_ms": 10408.511, "sample_throughput": 480.376, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1946.927, "learn_throughput": 2568.15, "update_time_ms": 9.341}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0842021724855045e-20, "cur_lr": 0.0005000000000000001, "total_loss": 6.220691204071045, "policy_loss": -0.0024414254834983495, "vf_loss": 6.305091047286988, "vf_explained_var": -0.29181002378463744, "kl": 0.003385833255030446, "entropy": 8.195846843719483, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 425000, "num_agent_steps_sampled": 1275000, "num_steps_trained": 425000, "num_agent_steps_trained": 1275000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1513, "training_iteration": 85, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-16-39", "timestamp": 1706231799, "time_this_iter_s": 10.317180871963501, "time_total_s": 915.9833300113678, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D2CDC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 915.9833300113678, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 7.6800000000000015, "ram_util_percent": 60.18666666666666}}
{"episode_reward_max": 142.27761249616748, "episode_reward_min": -303.61364056915045, "episode_reward_mean": 78.19487321647028, "episode_len_mean": 483.81, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -107.11943901330233}, "policy_reward_max": {"shared_policy": 47.51561456546186}, "policy_reward_mean": {"shared_policy": 26.064957738823427}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.44369395077226, 77.15403719991444, 78.52615157701074, 114.3504902757704, 77.08324576169251, 110.22341322898865, 76.45885950978844, 112.90813978761432, 93.98134231520814, 101.06606115913016, 97.14420233294368, 92.51422455906867, 103.83515056967732, 54.98028155975041, 97.64387846365571, 82.52201731177047, 79.23634686693549, 74.35823146998882, 82.33621002174911, 77.07159350439905, 37.057294853031635, 103.28521435707805, 91.5042290240526, 91.06894367933272, 102.57367361336945, 90.40212476998568, 121.3785421475768, 136.8385066818446, 84.536744505167, 119.91574973613022, 94.70087829977274, 93.41256055980921, 117.43440020130947, -254.91352781746536, 107.1769738695584, 89.89679387584327, 94.08069921098648, 75.08737424015996, 77.43231832608578, 63.13714415021238, 89.91009387373924, 127.77532775327562, -271.07004067476373, 109.24839528463781, 109.43277923762797, 124.08036515861748, -303.61364056915045, 110.57198399305342, 97.49818842115928, 111.89264606311916, 110.10965425893664, 142.27761249616748, -302.56297191232443, 76.42212012223898, 102.5090076178312, 82.58310768753289, 114.99531225115061, 80.18631748855114, 114.33596741547808, 105.46284547075629, 97.71480644121763, 71.18771148147059, 80.4629828222096, 91.12261090707032, 115.86906661838292, 70.53434547781941, 115.56505184248088, 87.8063565008342, 80.4506935290992, 98.10999379120766, 87.66169406194237, 96.96513341553508, 81.67421351745723, 123.17847246304154, 101.14233145210892, 33.30630826437846, 82.45331529062241, 74.17609300464392, 116.91233664751053, 85.43334784847684, 67.88583164755254, 97.65899042412639, 94.60938843712209, 84.3833603784442, 74.06223936192688, 64.81639426294711, 81.70351854432371, 82.86446484178302, 104.18902479112147, 102.89107834361491, 110.62462688540107, 115.35805238783358, 100.66686354577541, 80.7212713868357, 97.90625781007108, 84.58118292316793, 116.47796450555322, 73.77046054974197, 76.50411186181007, 80.19609223306176], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 166, 500, 500, 500, 500, 500, 500, 500, 500, 90, 500, 500, 500, 63, 500, 500, 500, 500, 500, 62, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [28.16724270830551, 28.10452644030252, 28.171924802164227, 25.880994980533913, 25.80619156112273, 25.466850658257798, 25.863628168900803, 26.33271270928283, 26.329810698827103, 37.847238103548676, 38.19785344849029, 38.30539872373143, 25.46624632676442, 25.5246476282676, 26.09235180666049, 36.78215050697327, 36.62659206986427, 36.81467065215111, 25.200504032274083, 25.74033463404824, 25.518020843466118, 37.484317670265824, 37.73672217192748, 37.68709994542101, 31.455751574287802, 31.59580804236853, 30.929782698551804, 33.95442904547477, 33.62112546215454, 33.49050665150085, 32.319436341524124, 32.5284926854074, 32.296273306012154, 30.7730594476064, 30.703217556079224, 31.03794755538304, 34.560661802689225, 34.46201954285303, 34.81246922413507, 18.02589190999666, 18.336461837093026, 18.617927812660724, 32.53501471877098, 32.54585186764598, 32.56301187723875, 27.280027113854885, 27.711623054463416, 27.530367143452168, 26.463384222239256, 26.382066927850246, 26.39089571684599, 24.60232039541006, 24.814895555377007, 24.941015519201756, 27.154102275768906, 27.4193717415134, 27.762736004466802, 25.52355560412009, 25.733320609976843, 25.814717290302113, 11.971985787153244, 12.490462265908718, 12.594846799969673, 34.43165203432241, 34.49171157429615, 34.36185074845949, 30.069211428364113, 30.797612336774662, 30.63740525891383, 30.27934209009011, 30.572052230437592, 30.217549358805016, 34.140456219514206, 34.41284993042548, 34.020367463429764, 30.05840641260147, 30.290316686034203, 30.053401671350002, 40.398226504524544, 40.383663562436894, 40.59665208061536, 45.76337763977547, 45.774896544714764, 45.300232497354344, 28.242758971949414, 28.22189727177222, 28.07208826144536, 39.98124978442986, 39.82305942972501, 40.111440521975354, 31.460718624293804, 31.587851606309414, 31.65230806916952, 30.88706523180008, 31.365118324756622, 31.160377003252506, 38.8463182374835, 39.24074072390795, 39.34734123991802, -95.87659168243408, -79.75827194005251, -79.27866419497877, 35.79405017072955, 35.312470326821, 36.07045337200785, 30.071682808299855, 29.736455631752804, 30.088655435790614, 31.395956819256142, 31.178136450548962, 31.506605941181377, 25.164229514698178, 25.02883197615543, 24.89431274930635, 25.496543700496346, 25.89915223295489, 26.03662239263454, 21.29110286074379, 20.949399108688027, 20.89664218078056, 29.837817758321762, 30.078966714441776, 29.993309400975704, 42.72480761756499, 42.337692250808075, 42.71282788490255, -85.32463882106822, -100.33702147006989, -85.40838038362563, 36.22791113704443, 36.30307400971651, 36.71741013787687, 36.4795294975241, 36.46537182976802, 36.487877910335854, 41.671054167052105, 41.02247714002927, 41.38683385153611, -98.8624873061975, -98.13978810360035, -106.61136515935263, 36.5927848269542, 36.979474653800324, 36.9997245122989, 32.39910162985325, 32.39450288936496, 32.70458390194108, 37.16947928567727, 37.44273627673586, 37.28043050070603, 36.90076785907149, 36.5779599994421, 36.63092640042305, 47.27468679845332, 47.51561456546186, 47.4873111322522, -97.02774296700954, -107.11943901330233, -98.41578993201256, 25.50847256680329, 25.33179821570714, 25.58184933972855, 34.144187475244195, 34.09110927830139, 34.27371086428562, 27.633832332988575, 27.47571063538392, 27.473564719160393, 38.348056614398956, 38.4577956572175, 38.18945997953415, 26.654115170240402, 26.822502985596657, 26.70969933271408, 38.47655749460682, 37.96954222768545, 37.889867693185806, 35.21345363929868, 34.96340721845627, 35.28598461300135, 32.37214798728624, 32.61593571553627, 32.726722738395125, 23.9133492965872, 23.350281218687684, 23.924080966195703, 26.812518388032913, 26.48378498852253, 27.166679445654154, 30.568034997520343, 30.490442215775445, 30.064133693774536, 38.551735175152615, 38.58918294807275, 38.728148495157555, 22.990384588638932, 23.845588977138192, 23.69837191204229, 38.427080908169344, 38.59032167618473, 38.54764925812681, 29.22126584003368, 29.135598840812833, 29.449491819987685, 27.0599533903102, 26.799150156478078, 26.59158998231092, 32.566812490423516, 32.33843923111756, 33.20474206966658, 28.961545834938676, 29.332143706890434, 29.36800452011326, 32.13877945144971, 32.15311250587304, 32.67324145821233, 27.51096686845024, 27.140834895273045, 27.022411753733948, 41.26552553847432, 41.14513240754604, 40.76781451702118, 33.61133350431919, 34.04037167225033, 33.4906262755394, 11.128231892827898, 11.069348396733403, 11.108727974817157, 27.392102722078562, 27.483858782798052, 27.5773537857458, 24.957106970250607, 24.62146259844303, 24.59752343595028, 39.0025025466457, 38.900541346520185, 39.00929275434464, 28.438714757561684, 28.924287331523374, 28.070345759391785, 22.88858572238435, 22.35410101463397, 22.643144910534218, 32.48107486963272, 32.59821401536465, 32.57970153912902, 31.880787042280033, 31.934487977375582, 30.794113417466477, 27.930146023631096, 28.16660562157631, 28.28660873323679, 24.316027919451386, 25.106663145745785, 24.639548296729714, 21.5457486907641, 21.63659014614919, 21.634055426033825, 27.031719195346028, 27.126744310061127, 27.54505503891656, 27.345305303732545, 27.717621228347213, 27.80153830970326, 34.99473964174588, 34.638095920284584, 34.556189229091004, 34.48437780576447, 34.1038685987393, 34.302831939111144, 37.00097176091124, 37.027606935783595, 36.596048188706234, 38.61073566724856, 38.57793403913577, 38.16938268144925, 33.658218532800674, 33.80603529512882, 33.20260971784592, 26.70097769300142, 26.764324131111294, 27.25596956272298, 32.69388480174044, 32.640834777305514, 32.57153823102513, 28.214097264533237, 28.20717537713547, 28.159910281499222, 38.73381290088096, 38.69054927925268, 39.053602325419575, 24.18268910547097, 24.73806092453499, 24.849710519736007, 25.7372118824472, 25.10967807968457, 25.657221899678305, 26.637255559364945, 26.822096231083066, 26.73674044261375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14370374934864152, "mean_inference_ms": 0.6969221867959269, "mean_action_processing_ms": 0.09631270335142197, "mean_env_wait_ms": 0.803094404259307, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 430000, "timesteps_this_iter": 0, "agent_timesteps_total": 1290000, "timers": {"sample_time_ms": 10397.166, "sample_throughput": 480.9, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1937.921, "learn_throughput": 2580.084, "update_time_ms": 9.243}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.4210108624275225e-21, "cur_lr": 0.0005000000000000001, "total_loss": 6.171178674697876, "policy_loss": -0.0017686092466232318, "vf_loss": 6.255173635482788, "vf_explained_var": -0.06018154621124268, "kl": 0.0029141037608654274, "entropy": 8.222612857818604, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 430000, "num_agent_steps_sampled": 1290000, "num_steps_trained": 430000, "num_agent_steps_trained": 1290000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1523, "training_iteration": 86, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-16-50", "timestamp": 1706231810, "time_this_iter_s": 10.256340265274048, "time_total_s": 926.2396702766418, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402DE5790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 926.2396702766418, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 7.6800000000000015, "ram_util_percent": 60.20000000000002}}
{"episode_reward_max": 147.11785411834697, "episode_reward_min": -303.61364056915045, "episode_reward_mean": 78.73285215164913, "episode_len_mean": 483.81, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -107.11943901330233}, "policy_reward_max": {"shared_policy": 49.243504623572036}, "policy_reward_mean": {"shared_policy": 26.24428405054971}, "custom_metrics": {}, "hist_stats": {"episode_reward": [97.14420233294368, 92.51422455906867, 103.83515056967732, 54.98028155975041, 97.64387846365571, 82.52201731177047, 79.23634686693549, 74.35823146998882, 82.33621002174911, 77.07159350439905, 37.057294853031635, 103.28521435707805, 91.5042290240526, 91.06894367933272, 102.57367361336945, 90.40212476998568, 121.3785421475768, 136.8385066818446, 84.536744505167, 119.91574973613022, 94.70087829977274, 93.41256055980921, 117.43440020130947, -254.91352781746536, 107.1769738695584, 89.89679387584327, 94.08069921098648, 75.08737424015996, 77.43231832608578, 63.13714415021238, 89.91009387373924, 127.77532775327562, -271.07004067476373, 109.24839528463781, 109.43277923762797, 124.08036515861748, -303.61364056915045, 110.57198399305342, 97.49818842115928, 111.89264606311916, 110.10965425893664, 142.27761249616748, -302.56297191232443, 76.42212012223898, 102.5090076178312, 82.58310768753289, 114.99531225115061, 80.18631748855114, 114.33596741547808, 105.46284547075629, 97.71480644121763, 71.18771148147059, 80.4629828222096, 91.12261090707032, 115.86906661838292, 70.53434547781941, 115.56505184248088, 87.8063565008342, 80.4506935290992, 98.10999379120766, 87.66169406194237, 96.96513341553508, 81.67421351745723, 123.17847246304154, 101.14233145210892, 33.30630826437846, 82.45331529062241, 74.17609300464392, 116.91233664751053, 85.43334784847684, 67.88583164755254, 97.65899042412639, 94.60938843712209, 84.3833603784442, 74.06223936192688, 64.81639426294711, 81.70351854432371, 82.86446484178302, 104.18902479112147, 102.89107834361491, 110.62462688540107, 115.35805238783358, 100.66686354577541, 80.7212713868357, 97.90625781007108, 84.58118292316793, 116.47796450555322, 73.77046054974197, 76.50411186181007, 80.19609223306176, 93.20274864998645, 61.10504546388984, 68.46108963154255, 87.00458501651883, 77.58462580665946, 120.22409273684022, 147.11785411834697, 116.05411050096151, 96.01985111460087, 113.21932524442671], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 166, 500, 500, 500, 500, 500, 500, 500, 500, 90, 500, 500, 500, 63, 500, 500, 500, 500, 500, 62, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [32.319436341524124, 32.5284926854074, 32.296273306012154, 30.7730594476064, 30.703217556079224, 31.03794755538304, 34.560661802689225, 34.46201954285303, 34.81246922413507, 18.02589190999666, 18.336461837093026, 18.617927812660724, 32.53501471877098, 32.54585186764598, 32.56301187723875, 27.280027113854885, 27.711623054463416, 27.530367143452168, 26.463384222239256, 26.382066927850246, 26.39089571684599, 24.60232039541006, 24.814895555377007, 24.941015519201756, 27.154102275768906, 27.4193717415134, 27.762736004466802, 25.52355560412009, 25.733320609976843, 25.814717290302113, 11.971985787153244, 12.490462265908718, 12.594846799969673, 34.43165203432241, 34.49171157429615, 34.36185074845949, 30.069211428364113, 30.797612336774662, 30.63740525891383, 30.27934209009011, 30.572052230437592, 30.217549358805016, 34.140456219514206, 34.41284993042548, 34.020367463429764, 30.05840641260147, 30.290316686034203, 30.053401671350002, 40.398226504524544, 40.383663562436894, 40.59665208061536, 45.76337763977547, 45.774896544714764, 45.300232497354344, 28.242758971949414, 28.22189727177222, 28.07208826144536, 39.98124978442986, 39.82305942972501, 40.111440521975354, 31.460718624293804, 31.587851606309414, 31.65230806916952, 30.88706523180008, 31.365118324756622, 31.160377003252506, 38.8463182374835, 39.24074072390795, 39.34734123991802, -95.87659168243408, -79.75827194005251, -79.27866419497877, 35.79405017072955, 35.312470326821, 36.07045337200785, 30.071682808299855, 29.736455631752804, 30.088655435790614, 31.395956819256142, 31.178136450548962, 31.506605941181377, 25.164229514698178, 25.02883197615543, 24.89431274930635, 25.496543700496346, 25.89915223295489, 26.03662239263454, 21.29110286074379, 20.949399108688027, 20.89664218078056, 29.837817758321762, 30.078966714441776, 29.993309400975704, 42.72480761756499, 42.337692250808075, 42.71282788490255, -85.32463882106822, -100.33702147006989, -85.40838038362563, 36.22791113704443, 36.30307400971651, 36.71741013787687, 36.4795294975241, 36.46537182976802, 36.487877910335854, 41.671054167052105, 41.02247714002927, 41.38683385153611, -98.8624873061975, -98.13978810360035, -106.61136515935263, 36.5927848269542, 36.979474653800324, 36.9997245122989, 32.39910162985325, 32.39450288936496, 32.70458390194108, 37.16947928567727, 37.44273627673586, 37.28043050070603, 36.90076785907149, 36.5779599994421, 36.63092640042305, 47.27468679845332, 47.51561456546186, 47.4873111322522, -97.02774296700954, -107.11943901330233, -98.41578993201256, 25.50847256680329, 25.33179821570714, 25.58184933972855, 34.144187475244195, 34.09110927830139, 34.27371086428562, 27.633832332988575, 27.47571063538392, 27.473564719160393, 38.348056614398956, 38.4577956572175, 38.18945997953415, 26.654115170240402, 26.822502985596657, 26.70969933271408, 38.47655749460682, 37.96954222768545, 37.889867693185806, 35.21345363929868, 34.96340721845627, 35.28598461300135, 32.37214798728624, 32.61593571553627, 32.726722738395125, 23.9133492965872, 23.350281218687684, 23.924080966195703, 26.812518388032913, 26.48378498852253, 27.166679445654154, 30.568034997520343, 30.490442215775445, 30.064133693774536, 38.551735175152615, 38.58918294807275, 38.728148495157555, 22.990384588638932, 23.845588977138192, 23.69837191204229, 38.427080908169344, 38.59032167618473, 38.54764925812681, 29.22126584003368, 29.135598840812833, 29.449491819987685, 27.0599533903102, 26.799150156478078, 26.59158998231092, 32.566812490423516, 32.33843923111756, 33.20474206966658, 28.961545834938676, 29.332143706890434, 29.36800452011326, 32.13877945144971, 32.15311250587304, 32.67324145821233, 27.51096686845024, 27.140834895273045, 27.022411753733948, 41.26552553847432, 41.14513240754604, 40.76781451702118, 33.61133350431919, 34.04037167225033, 33.4906262755394, 11.128231892827898, 11.069348396733403, 11.108727974817157, 27.392102722078562, 27.483858782798052, 27.5773537857458, 24.957106970250607, 24.62146259844303, 24.59752343595028, 39.0025025466457, 38.900541346520185, 39.00929275434464, 28.438714757561684, 28.924287331523374, 28.070345759391785, 22.88858572238435, 22.35410101463397, 22.643144910534218, 32.48107486963272, 32.59821401536465, 32.57970153912902, 31.880787042280033, 31.934487977375582, 30.794113417466477, 27.930146023631096, 28.16660562157631, 28.28660873323679, 24.316027919451386, 25.106663145745785, 24.639548296729714, 21.5457486907641, 21.63659014614919, 21.634055426033825, 27.031719195346028, 27.126744310061127, 27.54505503891656, 27.345305303732545, 27.717621228347213, 27.80153830970326, 34.99473964174588, 34.638095920284584, 34.556189229091004, 34.48437780576447, 34.1038685987393, 34.302831939111144, 37.00097176091124, 37.027606935783595, 36.596048188706234, 38.61073566724856, 38.57793403913577, 38.16938268144925, 33.658218532800674, 33.80603529512882, 33.20260971784592, 26.70097769300142, 26.764324131111294, 27.25596956272298, 32.69388480174044, 32.640834777305514, 32.57153823102513, 28.214097264533237, 28.20717537713547, 28.159910281499222, 38.73381290088096, 38.69054927925268, 39.053602325419575, 24.18268910547097, 24.73806092453499, 24.849710519736007, 25.7372118824472, 25.10967807968457, 25.657221899678305, 26.637255559364945, 26.822096231083066, 26.73674044261375, 31.52200010286954, 31.26661345859368, 30.414135088523224, 20.250491969287395, 20.296124652028084, 20.558428842574358, 23.025058546413973, 23.075996554767087, 22.36003453036149, 28.90571991354227, 28.66507774591446, 29.4337873570621, 25.39574721455574, 26.236971501260996, 25.951907090842724, 40.17594456175962, 39.84052337209383, 40.20762480298677, 49.243504623572036, 48.752628932396576, 49.12172056237857, 38.577803942064435, 38.627314689258725, 38.848991869638354, 31.804225499431283, 32.06757822881141, 32.14804738635817, 37.95472876479228, 37.60406204809745, 37.66053443153699]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14364205190228505, "mean_inference_ms": 0.696775728197505, "mean_action_processing_ms": 0.09629196515912102, "mean_env_wait_ms": 0.8026306781359296, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 435000, "timesteps_this_iter": 0, "agent_timesteps_total": 1305000, "timers": {"sample_time_ms": 10422.472, "sample_throughput": 479.733, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1938.689, "learn_throughput": 2579.062, "update_time_ms": 9.22}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7105054312137612e-21, "cur_lr": 0.0005000000000000001, "total_loss": 7.070091342926025, "policy_loss": -0.0018325839834520963, "vf_loss": 7.154708433151245, "vf_explained_var": -0.4243037223815918, "kl": 0.003243734501318707, "entropy": 8.27845869064331, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 435000, "num_agent_steps_sampled": 1305000, "num_steps_trained": 435000, "num_agent_steps_trained": 1305000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1533, "training_iteration": 87, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-17-01", "timestamp": 1706231821, "time_this_iter_s": 10.811890125274658, "time_total_s": 937.0515604019165, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401AAA160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 937.0515604019165, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 6.333333333333334, "ram_util_percent": 60.59333333333334}}
{"episode_reward_max": 147.11785411834697, "episode_reward_min": -303.61364056915045, "episode_reward_mean": 78.5694242276941, "episode_len_mean": 483.81, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -107.11943901330233}, "policy_reward_max": {"shared_policy": 49.243504623572036}, "policy_reward_mean": {"shared_policy": 26.189808075898032}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.057294853031635, 103.28521435707805, 91.5042290240526, 91.06894367933272, 102.57367361336945, 90.40212476998568, 121.3785421475768, 136.8385066818446, 84.536744505167, 119.91574973613022, 94.70087829977274, 93.41256055980921, 117.43440020130947, -254.91352781746536, 107.1769738695584, 89.89679387584327, 94.08069921098648, 75.08737424015996, 77.43231832608578, 63.13714415021238, 89.91009387373924, 127.77532775327562, -271.07004067476373, 109.24839528463781, 109.43277923762797, 124.08036515861748, -303.61364056915045, 110.57198399305342, 97.49818842115928, 111.89264606311916, 110.10965425893664, 142.27761249616748, -302.56297191232443, 76.42212012223898, 102.5090076178312, 82.58310768753289, 114.99531225115061, 80.18631748855114, 114.33596741547808, 105.46284547075629, 97.71480644121763, 71.18771148147059, 80.4629828222096, 91.12261090707032, 115.86906661838292, 70.53434547781941, 115.56505184248088, 87.8063565008342, 80.4506935290992, 98.10999379120766, 87.66169406194237, 96.96513341553508, 81.67421351745723, 123.17847246304154, 101.14233145210892, 33.30630826437846, 82.45331529062241, 74.17609300464392, 116.91233664751053, 85.43334784847684, 67.88583164755254, 97.65899042412639, 94.60938843712209, 84.3833603784442, 74.06223936192688, 64.81639426294711, 81.70351854432371, 82.86446484178302, 104.18902479112147, 102.89107834361491, 110.62462688540107, 115.35805238783358, 100.66686354577541, 80.7212713868357, 97.90625781007108, 84.58118292316793, 116.47796450555322, 73.77046054974197, 76.50411186181007, 80.19609223306176, 93.20274864998645, 61.10504546388984, 68.46108963154255, 87.00458501651883, 77.58462580665946, 120.22409273684022, 147.11785411834697, 116.05411050096151, 96.01985111460087, 113.21932524442671, 94.43346708267924, 52.650813788175554, 121.60828514536843, 89.9275504136458, 77.61815264914185, 79.99411564692852, 52.271170534193516, 67.87829358782616, 93.3786176536232, 95.53887776285409], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 166, 500, 500, 500, 500, 500, 500, 500, 500, 90, 500, 500, 500, 63, 500, 500, 500, 500, 500, 62, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [11.971985787153244, 12.490462265908718, 12.594846799969673, 34.43165203432241, 34.49171157429615, 34.36185074845949, 30.069211428364113, 30.797612336774662, 30.63740525891383, 30.27934209009011, 30.572052230437592, 30.217549358805016, 34.140456219514206, 34.41284993042548, 34.020367463429764, 30.05840641260147, 30.290316686034203, 30.053401671350002, 40.398226504524544, 40.383663562436894, 40.59665208061536, 45.76337763977547, 45.774896544714764, 45.300232497354344, 28.242758971949414, 28.22189727177222, 28.07208826144536, 39.98124978442986, 39.82305942972501, 40.111440521975354, 31.460718624293804, 31.587851606309414, 31.65230806916952, 30.88706523180008, 31.365118324756622, 31.160377003252506, 38.8463182374835, 39.24074072390795, 39.34734123991802, -95.87659168243408, -79.75827194005251, -79.27866419497877, 35.79405017072955, 35.312470326821, 36.07045337200785, 30.071682808299855, 29.736455631752804, 30.088655435790614, 31.395956819256142, 31.178136450548962, 31.506605941181377, 25.164229514698178, 25.02883197615543, 24.89431274930635, 25.496543700496346, 25.89915223295489, 26.03662239263454, 21.29110286074379, 20.949399108688027, 20.89664218078056, 29.837817758321762, 30.078966714441776, 29.993309400975704, 42.72480761756499, 42.337692250808075, 42.71282788490255, -85.32463882106822, -100.33702147006989, -85.40838038362563, 36.22791113704443, 36.30307400971651, 36.71741013787687, 36.4795294975241, 36.46537182976802, 36.487877910335854, 41.671054167052105, 41.02247714002927, 41.38683385153611, -98.8624873061975, -98.13978810360035, -106.61136515935263, 36.5927848269542, 36.979474653800324, 36.9997245122989, 32.39910162985325, 32.39450288936496, 32.70458390194108, 37.16947928567727, 37.44273627673586, 37.28043050070603, 36.90076785907149, 36.5779599994421, 36.63092640042305, 47.27468679845332, 47.51561456546186, 47.4873111322522, -97.02774296700954, -107.11943901330233, -98.41578993201256, 25.50847256680329, 25.33179821570714, 25.58184933972855, 34.144187475244195, 34.09110927830139, 34.27371086428562, 27.633832332988575, 27.47571063538392, 27.473564719160393, 38.348056614398956, 38.4577956572175, 38.18945997953415, 26.654115170240402, 26.822502985596657, 26.70969933271408, 38.47655749460682, 37.96954222768545, 37.889867693185806, 35.21345363929868, 34.96340721845627, 35.28598461300135, 32.37214798728624, 32.61593571553627, 32.726722738395125, 23.9133492965872, 23.350281218687684, 23.924080966195703, 26.812518388032913, 26.48378498852253, 27.166679445654154, 30.568034997520343, 30.490442215775445, 30.064133693774536, 38.551735175152615, 38.58918294807275, 38.728148495157555, 22.990384588638932, 23.845588977138192, 23.69837191204229, 38.427080908169344, 38.59032167618473, 38.54764925812681, 29.22126584003368, 29.135598840812833, 29.449491819987685, 27.0599533903102, 26.799150156478078, 26.59158998231092, 32.566812490423516, 32.33843923111756, 33.20474206966658, 28.961545834938676, 29.332143706890434, 29.36800452011326, 32.13877945144971, 32.15311250587304, 32.67324145821233, 27.51096686845024, 27.140834895273045, 27.022411753733948, 41.26552553847432, 41.14513240754604, 40.76781451702118, 33.61133350431919, 34.04037167225033, 33.4906262755394, 11.128231892827898, 11.069348396733403, 11.108727974817157, 27.392102722078562, 27.483858782798052, 27.5773537857458, 24.957106970250607, 24.62146259844303, 24.59752343595028, 39.0025025466457, 38.900541346520185, 39.00929275434464, 28.438714757561684, 28.924287331523374, 28.070345759391785, 22.88858572238435, 22.35410101463397, 22.643144910534218, 32.48107486963272, 32.59821401536465, 32.57970153912902, 31.880787042280033, 31.934487977375582, 30.794113417466477, 27.930146023631096, 28.16660562157631, 28.28660873323679, 24.316027919451386, 25.106663145745785, 24.639548296729714, 21.5457486907641, 21.63659014614919, 21.634055426033825, 27.031719195346028, 27.126744310061127, 27.54505503891656, 27.345305303732545, 27.717621228347213, 27.80153830970326, 34.99473964174588, 34.638095920284584, 34.556189229091004, 34.48437780576447, 34.1038685987393, 34.302831939111144, 37.00097176091124, 37.027606935783595, 36.596048188706234, 38.61073566724856, 38.57793403913577, 38.16938268144925, 33.658218532800674, 33.80603529512882, 33.20260971784592, 26.70097769300142, 26.764324131111294, 27.25596956272298, 32.69388480174044, 32.640834777305514, 32.57153823102513, 28.214097264533237, 28.20717537713547, 28.159910281499222, 38.73381290088096, 38.69054927925268, 39.053602325419575, 24.18268910547097, 24.73806092453499, 24.849710519736007, 25.7372118824472, 25.10967807968457, 25.657221899678305, 26.637255559364945, 26.822096231083066, 26.73674044261375, 31.52200010286954, 31.26661345859368, 30.414135088523224, 20.250491969287395, 20.296124652028084, 20.558428842574358, 23.025058546413973, 23.075996554767087, 22.36003453036149, 28.90571991354227, 28.66507774591446, 29.4337873570621, 25.39574721455574, 26.236971501260996, 25.951907090842724, 40.17594456175962, 39.84052337209383, 40.20762480298677, 49.243504623572036, 48.752628932396576, 49.12172056237857, 38.577803942064435, 38.627314689258725, 38.848991869638354, 31.804225499431283, 32.06757822881141, 32.14804738635817, 37.95472876479228, 37.60406204809745, 37.66053443153699, 31.5449745679895, 31.517503942052514, 31.37098857263723, 17.336574504772813, 17.45203987757364, 17.862199405829102, 40.64626531070098, 40.4922721683979, 40.46974766626954, 30.326296103186905, 30.102722074836493, 29.498532235622406, 25.750438004732132, 25.916098246350884, 25.95161639805883, 26.783770541350037, 26.895534372578055, 26.314810733000428, 17.734409146010876, 17.500994116067886, 17.035767272114754, 22.674896689752728, 22.526817219952733, 22.676579678120703, 30.86061083773771, 31.33646955775717, 31.181537258128316, 31.75130795439084, 31.870403995116547, 31.9171658133467]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14357000260357491, "mean_inference_ms": 0.6966152221482694, "mean_action_processing_ms": 0.09625279175049944, "mean_env_wait_ms": 0.8021681046291984, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 440000, "timesteps_this_iter": 0, "agent_timesteps_total": 1320000, "timers": {"sample_time_ms": 10391.415, "sample_throughput": 481.166, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1923.179, "learn_throughput": 2599.863, "update_time_ms": 9.021}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3552527156068806e-21, "cur_lr": 0.0005000000000000001, "total_loss": 6.325393438339233, "policy_loss": -0.0017063453967683273, "vf_loss": 6.411311864852905, "vf_explained_var": -0.17773606777191162, "kl": 0.002639619621931115, "entropy": 8.421202564239502, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 440000, "num_agent_steps_sampled": 1320000, "num_steps_trained": 440000, "num_agent_steps_trained": 1320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1543, "training_iteration": 88, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-17-11", "timestamp": 1706231831, "time_this_iter_s": 10.103100776672363, "time_total_s": 947.1546611785889, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140239EDC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 947.1546611785889, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 5.557142857142856, "ram_util_percent": 60.67857142857144}}
{"episode_reward_max": 147.11785411834697, "episode_reward_min": -303.61364056915045, "episode_reward_mean": 77.99127543644629, "episode_len_mean": 483.81, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -107.11943901330233}, "policy_reward_max": {"shared_policy": 49.243504623572036}, "policy_reward_mean": {"shared_policy": 25.997091812148764}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.70087829977274, 93.41256055980921, 117.43440020130947, -254.91352781746536, 107.1769738695584, 89.89679387584327, 94.08069921098648, 75.08737424015996, 77.43231832608578, 63.13714415021238, 89.91009387373924, 127.77532775327562, -271.07004067476373, 109.24839528463781, 109.43277923762797, 124.08036515861748, -303.61364056915045, 110.57198399305342, 97.49818842115928, 111.89264606311916, 110.10965425893664, 142.27761249616748, -302.56297191232443, 76.42212012223898, 102.5090076178312, 82.58310768753289, 114.99531225115061, 80.18631748855114, 114.33596741547808, 105.46284547075629, 97.71480644121763, 71.18771148147059, 80.4629828222096, 91.12261090707032, 115.86906661838292, 70.53434547781941, 115.56505184248088, 87.8063565008342, 80.4506935290992, 98.10999379120766, 87.66169406194237, 96.96513341553508, 81.67421351745723, 123.17847246304154, 101.14233145210892, 33.30630826437846, 82.45331529062241, 74.17609300464392, 116.91233664751053, 85.43334784847684, 67.88583164755254, 97.65899042412639, 94.60938843712209, 84.3833603784442, 74.06223936192688, 64.81639426294711, 81.70351854432371, 82.86446484178302, 104.18902479112147, 102.89107834361491, 110.62462688540107, 115.35805238783358, 100.66686354577541, 80.7212713868357, 97.90625781007108, 84.58118292316793, 116.47796450555322, 73.77046054974197, 76.50411186181007, 80.19609223306176, 93.20274864998645, 61.10504546388984, 68.46108963154255, 87.00458501651883, 77.58462580665946, 120.22409273684022, 147.11785411834697, 116.05411050096151, 96.01985111460087, 113.21932524442671, 94.43346708267924, 52.650813788175554, 121.60828514536843, 89.9275504136458, 77.61815264914185, 79.99411564692852, 52.271170534193516, 67.87829358782616, 93.3786176536232, 95.53887776285409, 102.24301656521854, 106.70458242669702, 93.40956348180771, 113.57471618801355, 102.41981333121655, 100.05315684527156, 99.98722018674016, 54.116400092840195, 68.41639053076504, 79.82128459421801], "episode_lengths": [500, 500, 500, 166, 500, 500, 500, 500, 500, 500, 500, 500, 90, 500, 500, 500, 63, 500, 500, 500, 500, 500, 62, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [31.460718624293804, 31.587851606309414, 31.65230806916952, 30.88706523180008, 31.365118324756622, 31.160377003252506, 38.8463182374835, 39.24074072390795, 39.34734123991802, -95.87659168243408, -79.75827194005251, -79.27866419497877, 35.79405017072955, 35.312470326821, 36.07045337200785, 30.071682808299855, 29.736455631752804, 30.088655435790614, 31.395956819256142, 31.178136450548962, 31.506605941181377, 25.164229514698178, 25.02883197615543, 24.89431274930635, 25.496543700496346, 25.89915223295489, 26.03662239263454, 21.29110286074379, 20.949399108688027, 20.89664218078056, 29.837817758321762, 30.078966714441776, 29.993309400975704, 42.72480761756499, 42.337692250808075, 42.71282788490255, -85.32463882106822, -100.33702147006989, -85.40838038362563, 36.22791113704443, 36.30307400971651, 36.71741013787687, 36.4795294975241, 36.46537182976802, 36.487877910335854, 41.671054167052105, 41.02247714002927, 41.38683385153611, -98.8624873061975, -98.13978810360035, -106.61136515935263, 36.5927848269542, 36.979474653800324, 36.9997245122989, 32.39910162985325, 32.39450288936496, 32.70458390194108, 37.16947928567727, 37.44273627673586, 37.28043050070603, 36.90076785907149, 36.5779599994421, 36.63092640042305, 47.27468679845332, 47.51561456546186, 47.4873111322522, -97.02774296700954, -107.11943901330233, -98.41578993201256, 25.50847256680329, 25.33179821570714, 25.58184933972855, 34.144187475244195, 34.09110927830139, 34.27371086428562, 27.633832332988575, 27.47571063538392, 27.473564719160393, 38.348056614398956, 38.4577956572175, 38.18945997953415, 26.654115170240402, 26.822502985596657, 26.70969933271408, 38.47655749460682, 37.96954222768545, 37.889867693185806, 35.21345363929868, 34.96340721845627, 35.28598461300135, 32.37214798728624, 32.61593571553627, 32.726722738395125, 23.9133492965872, 23.350281218687684, 23.924080966195703, 26.812518388032913, 26.48378498852253, 27.166679445654154, 30.568034997520343, 30.490442215775445, 30.064133693774536, 38.551735175152615, 38.58918294807275, 38.728148495157555, 22.990384588638932, 23.845588977138192, 23.69837191204229, 38.427080908169344, 38.59032167618473, 38.54764925812681, 29.22126584003368, 29.135598840812833, 29.449491819987685, 27.0599533903102, 26.799150156478078, 26.59158998231092, 32.566812490423516, 32.33843923111756, 33.20474206966658, 28.961545834938676, 29.332143706890434, 29.36800452011326, 32.13877945144971, 32.15311250587304, 32.67324145821233, 27.51096686845024, 27.140834895273045, 27.022411753733948, 41.26552553847432, 41.14513240754604, 40.76781451702118, 33.61133350431919, 34.04037167225033, 33.4906262755394, 11.128231892827898, 11.069348396733403, 11.108727974817157, 27.392102722078562, 27.483858782798052, 27.5773537857458, 24.957106970250607, 24.62146259844303, 24.59752343595028, 39.0025025466457, 38.900541346520185, 39.00929275434464, 28.438714757561684, 28.924287331523374, 28.070345759391785, 22.88858572238435, 22.35410101463397, 22.643144910534218, 32.48107486963272, 32.59821401536465, 32.57970153912902, 31.880787042280033, 31.934487977375582, 30.794113417466477, 27.930146023631096, 28.16660562157631, 28.28660873323679, 24.316027919451386, 25.106663145745785, 24.639548296729714, 21.5457486907641, 21.63659014614919, 21.634055426033825, 27.031719195346028, 27.126744310061127, 27.54505503891656, 27.345305303732545, 27.717621228347213, 27.80153830970326, 34.99473964174588, 34.638095920284584, 34.556189229091004, 34.48437780576447, 34.1038685987393, 34.302831939111144, 37.00097176091124, 37.027606935783595, 36.596048188706234, 38.61073566724856, 38.57793403913577, 38.16938268144925, 33.658218532800674, 33.80603529512882, 33.20260971784592, 26.70097769300142, 26.764324131111294, 27.25596956272298, 32.69388480174044, 32.640834777305514, 32.57153823102513, 28.214097264533237, 28.20717537713547, 28.159910281499222, 38.73381290088096, 38.69054927925268, 39.053602325419575, 24.18268910547097, 24.73806092453499, 24.849710519736007, 25.7372118824472, 25.10967807968457, 25.657221899678305, 26.637255559364945, 26.822096231083066, 26.73674044261375, 31.52200010286954, 31.26661345859368, 30.414135088523224, 20.250491969287395, 20.296124652028084, 20.558428842574358, 23.025058546413973, 23.075996554767087, 22.36003453036149, 28.90571991354227, 28.66507774591446, 29.4337873570621, 25.39574721455574, 26.236971501260996, 25.951907090842724, 40.17594456175962, 39.84052337209383, 40.20762480298677, 49.243504623572036, 48.752628932396576, 49.12172056237857, 38.577803942064435, 38.627314689258725, 38.848991869638354, 31.804225499431283, 32.06757822881141, 32.14804738635817, 37.95472876479228, 37.60406204809745, 37.66053443153699, 31.5449745679895, 31.517503942052514, 31.37098857263723, 17.336574504772813, 17.45203987757364, 17.862199405829102, 40.64626531070098, 40.4922721683979, 40.46974766626954, 30.326296103186905, 30.102722074836493, 29.498532235622406, 25.750438004732132, 25.916098246350884, 25.95161639805883, 26.783770541350037, 26.895534372578055, 26.314810733000428, 17.734409146010876, 17.500994116067886, 17.035767272114754, 22.674896689752728, 22.526817219952733, 22.676579678120703, 30.86061083773771, 31.33646955775717, 31.181537258128316, 31.75130795439084, 31.870403995116547, 31.9171658133467, 33.99226650844017, 34.046245275686175, 34.2045047810922, 34.958809062838554, 35.83034843951464, 35.915424924343824, 31.0826408714056, 30.95276238769293, 31.37416022270918, 38.150651417672634, 37.63593204319477, 37.78813272714615, 34.256574927518756, 34.031045014659554, 34.132193389038235, 33.41686953107515, 33.950646373132855, 32.685640941063554, 33.33616062998772, 33.1880297139287, 33.463029842823744, 18.113031022250652, 17.936708450317383, 18.06666062027216, 23.349306744833783, 22.478330110510186, 22.588753675421074, 26.722678281366825, 26.370358616113663, 26.728247696737526]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1435006558495455, "mean_inference_ms": 0.6964694333286002, "mean_action_processing_ms": 0.09621035385820358, "mean_env_wait_ms": 0.8017066295092121, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 445000, "timesteps_this_iter": 0, "agent_timesteps_total": 1335000, "timers": {"sample_time_ms": 10374.365, "sample_throughput": 481.957, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1926.156, "learn_throughput": 2595.844, "update_time_ms": 8.922}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.776263578034403e-22, "cur_lr": 0.0005000000000000001, "total_loss": 5.166756439208984, "policy_loss": -0.0018761965291271832, "vf_loss": 5.253305244445801, "vf_explained_var": -0.23578507900238038, "kl": 0.0030966943828571207, "entropy": 8.467258262634278, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 445000, "num_agent_steps_sampled": 1335000, "num_steps_trained": 445000, "num_agent_steps_trained": 1335000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1553, "training_iteration": 89, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-17-21", "timestamp": 1706231841, "time_this_iter_s": 10.478025674819946, "time_total_s": 957.6326868534088, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401A96430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 957.6326868534088, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 7.953333333333334, "ram_util_percent": 60.60000000000001}}
{"episode_reward_max": 147.11785411834697, "episode_reward_min": -303.61364056915045, "episode_reward_mean": 79.53760752451956, "episode_len_mean": 486.33, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -107.11943901330233}, "policy_reward_max": {"shared_policy": 49.243504623572036}, "policy_reward_mean": {"shared_policy": 26.512535841506516}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.91009387373924, 127.77532775327562, -271.07004067476373, 109.24839528463781, 109.43277923762797, 124.08036515861748, -303.61364056915045, 110.57198399305342, 97.49818842115928, 111.89264606311916, 110.10965425893664, 142.27761249616748, -302.56297191232443, 76.42212012223898, 102.5090076178312, 82.58310768753289, 114.99531225115061, 80.18631748855114, 114.33596741547808, 105.46284547075629, 97.71480644121763, 71.18771148147059, 80.4629828222096, 91.12261090707032, 115.86906661838292, 70.53434547781941, 115.56505184248088, 87.8063565008342, 80.4506935290992, 98.10999379120766, 87.66169406194237, 96.96513341553508, 81.67421351745723, 123.17847246304154, 101.14233145210892, 33.30630826437846, 82.45331529062241, 74.17609300464392, 116.91233664751053, 85.43334784847684, 67.88583164755254, 97.65899042412639, 94.60938843712209, 84.3833603784442, 74.06223936192688, 64.81639426294711, 81.70351854432371, 82.86446484178302, 104.18902479112147, 102.89107834361491, 110.62462688540107, 115.35805238783358, 100.66686354577541, 80.7212713868357, 97.90625781007108, 84.58118292316793, 116.47796450555322, 73.77046054974197, 76.50411186181007, 80.19609223306176, 93.20274864998645, 61.10504546388984, 68.46108963154255, 87.00458501651883, 77.58462580665946, 120.22409273684022, 147.11785411834697, 116.05411050096151, 96.01985111460087, 113.21932524442671, 94.43346708267924, 52.650813788175554, 121.60828514536843, 89.9275504136458, 77.61815264914185, 79.99411564692852, 52.271170534193516, 67.87829358782616, 93.3786176536232, 95.53887776285409, 102.24301656521854, 106.70458242669702, 93.40956348180771, 113.57471618801355, 102.41981333121655, 100.05315684527156, 99.98722018674016, 54.116400092840195, 68.41639053076504, 79.82128459421801, 80.80390191823241, 87.58545440807939, 90.52445392683146, 112.85197986569256, 126.44080376997589, 99.87515728524886, -231.13877548277384, 140.2865833276881, 101.89444019459185, 102.95482451003043], "episode_lengths": [500, 500, 90, 500, 500, 500, 63, 500, 500, 500, 500, 500, 62, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 418, 500, 500, 500], "policy_shared_policy_reward": [29.837817758321762, 30.078966714441776, 29.993309400975704, 42.72480761756499, 42.337692250808075, 42.71282788490255, -85.32463882106822, -100.33702147006989, -85.40838038362563, 36.22791113704443, 36.30307400971651, 36.71741013787687, 36.4795294975241, 36.46537182976802, 36.487877910335854, 41.671054167052105, 41.02247714002927, 41.38683385153611, -98.8624873061975, -98.13978810360035, -106.61136515935263, 36.5927848269542, 36.979474653800324, 36.9997245122989, 32.39910162985325, 32.39450288936496, 32.70458390194108, 37.16947928567727, 37.44273627673586, 37.28043050070603, 36.90076785907149, 36.5779599994421, 36.63092640042305, 47.27468679845332, 47.51561456546186, 47.4873111322522, -97.02774296700954, -107.11943901330233, -98.41578993201256, 25.50847256680329, 25.33179821570714, 25.58184933972855, 34.144187475244195, 34.09110927830139, 34.27371086428562, 27.633832332988575, 27.47571063538392, 27.473564719160393, 38.348056614398956, 38.4577956572175, 38.18945997953415, 26.654115170240402, 26.822502985596657, 26.70969933271408, 38.47655749460682, 37.96954222768545, 37.889867693185806, 35.21345363929868, 34.96340721845627, 35.28598461300135, 32.37214798728624, 32.61593571553627, 32.726722738395125, 23.9133492965872, 23.350281218687684, 23.924080966195703, 26.812518388032913, 26.48378498852253, 27.166679445654154, 30.568034997520343, 30.490442215775445, 30.064133693774536, 38.551735175152615, 38.58918294807275, 38.728148495157555, 22.990384588638932, 23.845588977138192, 23.69837191204229, 38.427080908169344, 38.59032167618473, 38.54764925812681, 29.22126584003368, 29.135598840812833, 29.449491819987685, 27.0599533903102, 26.799150156478078, 26.59158998231092, 32.566812490423516, 32.33843923111756, 33.20474206966658, 28.961545834938676, 29.332143706890434, 29.36800452011326, 32.13877945144971, 32.15311250587304, 32.67324145821233, 27.51096686845024, 27.140834895273045, 27.022411753733948, 41.26552553847432, 41.14513240754604, 40.76781451702118, 33.61133350431919, 34.04037167225033, 33.4906262755394, 11.128231892827898, 11.069348396733403, 11.108727974817157, 27.392102722078562, 27.483858782798052, 27.5773537857458, 24.957106970250607, 24.62146259844303, 24.59752343595028, 39.0025025466457, 38.900541346520185, 39.00929275434464, 28.438714757561684, 28.924287331523374, 28.070345759391785, 22.88858572238435, 22.35410101463397, 22.643144910534218, 32.48107486963272, 32.59821401536465, 32.57970153912902, 31.880787042280033, 31.934487977375582, 30.794113417466477, 27.930146023631096, 28.16660562157631, 28.28660873323679, 24.316027919451386, 25.106663145745785, 24.639548296729714, 21.5457486907641, 21.63659014614919, 21.634055426033825, 27.031719195346028, 27.126744310061127, 27.54505503891656, 27.345305303732545, 27.717621228347213, 27.80153830970326, 34.99473964174588, 34.638095920284584, 34.556189229091004, 34.48437780576447, 34.1038685987393, 34.302831939111144, 37.00097176091124, 37.027606935783595, 36.596048188706234, 38.61073566724856, 38.57793403913577, 38.16938268144925, 33.658218532800674, 33.80603529512882, 33.20260971784592, 26.70097769300142, 26.764324131111294, 27.25596956272298, 32.69388480174044, 32.640834777305514, 32.57153823102513, 28.214097264533237, 28.20717537713547, 28.159910281499222, 38.73381290088096, 38.69054927925268, 39.053602325419575, 24.18268910547097, 24.73806092453499, 24.849710519736007, 25.7372118824472, 25.10967807968457, 25.657221899678305, 26.637255559364945, 26.822096231083066, 26.73674044261375, 31.52200010286954, 31.26661345859368, 30.414135088523224, 20.250491969287395, 20.296124652028084, 20.558428842574358, 23.025058546413973, 23.075996554767087, 22.36003453036149, 28.90571991354227, 28.66507774591446, 29.4337873570621, 25.39574721455574, 26.236971501260996, 25.951907090842724, 40.17594456175962, 39.84052337209383, 40.20762480298677, 49.243504623572036, 48.752628932396576, 49.12172056237857, 38.577803942064435, 38.627314689258725, 38.848991869638354, 31.804225499431283, 32.06757822881141, 32.14804738635817, 37.95472876479228, 37.60406204809745, 37.66053443153699, 31.5449745679895, 31.517503942052514, 31.37098857263723, 17.336574504772813, 17.45203987757364, 17.862199405829102, 40.64626531070098, 40.4922721683979, 40.46974766626954, 30.326296103186905, 30.102722074836493, 29.498532235622406, 25.750438004732132, 25.916098246350884, 25.95161639805883, 26.783770541350037, 26.895534372578055, 26.314810733000428, 17.734409146010876, 17.500994116067886, 17.035767272114754, 22.674896689752728, 22.526817219952733, 22.676579678120703, 30.86061083773771, 31.33646955775717, 31.181537258128316, 31.75130795439084, 31.870403995116547, 31.9171658133467, 33.99226650844017, 34.046245275686175, 34.2045047810922, 34.958809062838554, 35.83034843951464, 35.915424924343824, 31.0826408714056, 30.95276238769293, 31.37416022270918, 38.150651417672634, 37.63593204319477, 37.78813272714615, 34.256574927518756, 34.031045014659554, 34.132193389038235, 33.41686953107515, 33.950646373132855, 32.685640941063554, 33.33616062998772, 33.1880297139287, 33.463029842823744, 18.113031022250652, 17.936708450317383, 18.06666062027216, 23.349306744833783, 22.478330110510186, 22.588753675421074, 26.722678281366825, 26.370358616113663, 26.728247696737526, 27.0885325881342, 27.151457807670027, 26.563911522428185, 28.64108568429947, 29.483489863574505, 29.460878860205412, 30.307858082155377, 30.63860650981465, 29.577989334861428, 37.800486414693296, 37.51711543276906, 37.5343780182302, 42.16189569731553, 42.26218522464235, 42.016722848018006, 33.238928228616714, 33.22816038876772, 33.40806866786443, -77.10370415945849, -77.1358619083961, -76.89920941491923, 46.808347126158566, 46.7303584391872, 46.74787776234248, 33.663476581374795, 33.97839921216169, 34.252564401055366, 34.56917913289119, 34.21934263904889, 34.16630273809035]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14341026039079974, "mean_inference_ms": 0.6963592275051255, "mean_action_processing_ms": 0.09618738631272283, "mean_env_wait_ms": 0.8012927935818815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 450000, "timesteps_this_iter": 0, "agent_timesteps_total": 1350000, "timers": {"sample_time_ms": 10409.275, "sample_throughput": 480.341, "load_time_ms": 0.1, "load_throughput": 49991704.41, "learn_time_ms": 1930.164, "learn_throughput": 2590.454, "update_time_ms": 9.019}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.3881317890172015e-22, "cur_lr": 0.0005000000000000001, "total_loss": 114.04668197631835, "policy_loss": -0.0010265562390520343, "vf_loss": 114.13333587646484, "vf_explained_var": -0.0016284823417663575, "kl": 0.004930225666631064, "entropy": 8.563153648376465, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 450000, "num_agent_steps_sampled": 1350000, "num_steps_trained": 450000, "num_agent_steps_trained": 1350000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1563, "training_iteration": 90, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-17-32", "timestamp": 1706231852, "time_this_iter_s": 10.65081262588501, "time_total_s": 968.2834994792938, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002146F7AC5E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 968.2834994792938, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 8.526666666666667, "ram_util_percent": 60.640000000000015}}
{"episode_reward_max": 147.11785411834697, "episode_reward_min": -302.56297191232443, "episode_reward_mean": 86.06479286415319, "episode_len_mean": 494.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -107.11943901330233}, "policy_reward_max": {"shared_policy": 49.243504623572036}, "policy_reward_mean": {"shared_policy": 28.688264288051055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [110.10965425893664, 142.27761249616748, -302.56297191232443, 76.42212012223898, 102.5090076178312, 82.58310768753289, 114.99531225115061, 80.18631748855114, 114.33596741547808, 105.46284547075629, 97.71480644121763, 71.18771148147059, 80.4629828222096, 91.12261090707032, 115.86906661838292, 70.53434547781941, 115.56505184248088, 87.8063565008342, 80.4506935290992, 98.10999379120766, 87.66169406194237, 96.96513341553508, 81.67421351745723, 123.17847246304154, 101.14233145210892, 33.30630826437846, 82.45331529062241, 74.17609300464392, 116.91233664751053, 85.43334784847684, 67.88583164755254, 97.65899042412639, 94.60938843712209, 84.3833603784442, 74.06223936192688, 64.81639426294711, 81.70351854432371, 82.86446484178302, 104.18902479112147, 102.89107834361491, 110.62462688540107, 115.35805238783358, 100.66686354577541, 80.7212713868357, 97.90625781007108, 84.58118292316793, 116.47796450555322, 73.77046054974197, 76.50411186181007, 80.19609223306176, 93.20274864998645, 61.10504546388984, 68.46108963154255, 87.00458501651883, 77.58462580665946, 120.22409273684022, 147.11785411834697, 116.05411050096151, 96.01985111460087, 113.21932524442671, 94.43346708267924, 52.650813788175554, 121.60828514536843, 89.9275504136458, 77.61815264914185, 79.99411564692852, 52.271170534193516, 67.87829358782616, 93.3786176536232, 95.53887776285409, 102.24301656521854, 106.70458242669702, 93.40956348180771, 113.57471618801355, 102.41981333121655, 100.05315684527156, 99.98722018674016, 54.116400092840195, 68.41639053076504, 79.82128459421801, 80.80390191823241, 87.58545440807939, 90.52445392683146, 112.85197986569256, 126.44080376997589, 99.87515728524886, -231.13877548277384, 140.2865833276881, 101.89444019459185, 102.95482451003043, 73.72105290787295, 107.37231701146808, 26.018120426684618, 126.02395740151402, 100.53048962727186, 102.9906993843615, 105.22501569800076, 93.40884126722811, 118.0896152603309, 105.06452351994812], "episode_lengths": [500, 500, 62, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 418, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [36.90076785907149, 36.5779599994421, 36.63092640042305, 47.27468679845332, 47.51561456546186, 47.4873111322522, -97.02774296700954, -107.11943901330233, -98.41578993201256, 25.50847256680329, 25.33179821570714, 25.58184933972855, 34.144187475244195, 34.09110927830139, 34.27371086428562, 27.633832332988575, 27.47571063538392, 27.473564719160393, 38.348056614398956, 38.4577956572175, 38.18945997953415, 26.654115170240402, 26.822502985596657, 26.70969933271408, 38.47655749460682, 37.96954222768545, 37.889867693185806, 35.21345363929868, 34.96340721845627, 35.28598461300135, 32.37214798728624, 32.61593571553627, 32.726722738395125, 23.9133492965872, 23.350281218687684, 23.924080966195703, 26.812518388032913, 26.48378498852253, 27.166679445654154, 30.568034997520343, 30.490442215775445, 30.064133693774536, 38.551735175152615, 38.58918294807275, 38.728148495157555, 22.990384588638932, 23.845588977138192, 23.69837191204229, 38.427080908169344, 38.59032167618473, 38.54764925812681, 29.22126584003368, 29.135598840812833, 29.449491819987685, 27.0599533903102, 26.799150156478078, 26.59158998231092, 32.566812490423516, 32.33843923111756, 33.20474206966658, 28.961545834938676, 29.332143706890434, 29.36800452011326, 32.13877945144971, 32.15311250587304, 32.67324145821233, 27.51096686845024, 27.140834895273045, 27.022411753733948, 41.26552553847432, 41.14513240754604, 40.76781451702118, 33.61133350431919, 34.04037167225033, 33.4906262755394, 11.128231892827898, 11.069348396733403, 11.108727974817157, 27.392102722078562, 27.483858782798052, 27.5773537857458, 24.957106970250607, 24.62146259844303, 24.59752343595028, 39.0025025466457, 38.900541346520185, 39.00929275434464, 28.438714757561684, 28.924287331523374, 28.070345759391785, 22.88858572238435, 22.35410101463397, 22.643144910534218, 32.48107486963272, 32.59821401536465, 32.57970153912902, 31.880787042280033, 31.934487977375582, 30.794113417466477, 27.930146023631096, 28.16660562157631, 28.28660873323679, 24.316027919451386, 25.106663145745785, 24.639548296729714, 21.5457486907641, 21.63659014614919, 21.634055426033825, 27.031719195346028, 27.126744310061127, 27.54505503891656, 27.345305303732545, 27.717621228347213, 27.80153830970326, 34.99473964174588, 34.638095920284584, 34.556189229091004, 34.48437780576447, 34.1038685987393, 34.302831939111144, 37.00097176091124, 37.027606935783595, 36.596048188706234, 38.61073566724856, 38.57793403913577, 38.16938268144925, 33.658218532800674, 33.80603529512882, 33.20260971784592, 26.70097769300142, 26.764324131111294, 27.25596956272298, 32.69388480174044, 32.640834777305514, 32.57153823102513, 28.214097264533237, 28.20717537713547, 28.159910281499222, 38.73381290088096, 38.69054927925268, 39.053602325419575, 24.18268910547097, 24.73806092453499, 24.849710519736007, 25.7372118824472, 25.10967807968457, 25.657221899678305, 26.637255559364945, 26.822096231083066, 26.73674044261375, 31.52200010286954, 31.26661345859368, 30.414135088523224, 20.250491969287395, 20.296124652028084, 20.558428842574358, 23.025058546413973, 23.075996554767087, 22.36003453036149, 28.90571991354227, 28.66507774591446, 29.4337873570621, 25.39574721455574, 26.236971501260996, 25.951907090842724, 40.17594456175962, 39.84052337209383, 40.20762480298677, 49.243504623572036, 48.752628932396576, 49.12172056237857, 38.577803942064435, 38.627314689258725, 38.848991869638354, 31.804225499431283, 32.06757822881141, 32.14804738635817, 37.95472876479228, 37.60406204809745, 37.66053443153699, 31.5449745679895, 31.517503942052514, 31.37098857263723, 17.336574504772813, 17.45203987757364, 17.862199405829102, 40.64626531070098, 40.4922721683979, 40.46974766626954, 30.326296103186905, 30.102722074836493, 29.498532235622406, 25.750438004732132, 25.916098246350884, 25.95161639805883, 26.783770541350037, 26.895534372578055, 26.314810733000428, 17.734409146010876, 17.500994116067886, 17.035767272114754, 22.674896689752728, 22.526817219952733, 22.676579678120703, 30.86061083773771, 31.33646955775717, 31.181537258128316, 31.75130795439084, 31.870403995116547, 31.9171658133467, 33.99226650844017, 34.046245275686175, 34.2045047810922, 34.958809062838554, 35.83034843951464, 35.915424924343824, 31.0826408714056, 30.95276238769293, 31.37416022270918, 38.150651417672634, 37.63593204319477, 37.78813272714615, 34.256574927518756, 34.031045014659554, 34.132193389038235, 33.41686953107515, 33.950646373132855, 32.685640941063554, 33.33616062998772, 33.1880297139287, 33.463029842823744, 18.113031022250652, 17.936708450317383, 18.06666062027216, 23.349306744833783, 22.478330110510186, 22.588753675421074, 26.722678281366825, 26.370358616113663, 26.728247696737526, 27.0885325881342, 27.151457807670027, 26.563911522428185, 28.64108568429947, 29.483489863574505, 29.460878860205412, 30.307858082155377, 30.63860650981465, 29.577989334861428, 37.800486414693296, 37.51711543276906, 37.5343780182302, 42.16189569731553, 42.26218522464235, 42.016722848018006, 33.238928228616714, 33.22816038876772, 33.40806866786443, -77.10370415945849, -77.1358619083961, -76.89920941491923, 46.808347126158566, 46.7303584391872, 46.74787776234248, 33.663476581374795, 33.97839921216169, 34.252564401055366, 34.56917913289119, 34.21934263904889, 34.16630273809035, 24.25479856133461, 24.513576447963715, 24.95267789857462, 35.95651879130551, 35.88818108352521, 35.52761713663736, 8.382735967636108, 8.576024740934372, 9.059359718114138, 41.702067519227654, 42.052837314705044, 42.269052567581326, 33.28857573370138, 33.56752737114826, 33.674386522422225, 34.13621375709772, 34.42137706466019, 34.43310856260359, 35.05917144815126, 35.24807565721372, 34.91776859263578, 31.213311453660324, 31.06680653368433, 31.12872327988346, 39.50044901482761, 38.99145694822073, 39.59770929728256, 35.05185788869858, 35.28275083191693, 34.72991479933262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1433521707702871, "mean_inference_ms": 0.6962946520388456, "mean_action_processing_ms": 0.09614611579380263, "mean_env_wait_ms": 0.8009800018399759, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 455000, "timesteps_this_iter": 0, "agent_timesteps_total": 1365000, "timers": {"sample_time_ms": 10446.041, "sample_throughput": 478.65, "load_time_ms": 0.1, "load_throughput": 49991704.41, "learn_time_ms": 1932.835, "learn_throughput": 2586.874, "update_time_ms": 8.97}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6940658945086008e-22, "cur_lr": 0.0005000000000000001, "total_loss": 8.19380578994751, "policy_loss": -0.0019530198281257683, "vf_loss": 8.281380367279052, "vf_explained_var": -0.17748059034347535, "kl": 0.0028869958390905968, "entropy": 8.562148666381836, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 455000, "num_agent_steps_sampled": 1365000, "num_steps_trained": 455000, "num_agent_steps_trained": 1365000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1573, "training_iteration": 91, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-17-42", "timestamp": 1706231862, "time_this_iter_s": 10.55036473274231, "time_total_s": 978.8338642120361, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021400844040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 978.8338642120361, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 7.680000000000001, "ram_util_percent": 60.61333333333334}}
{"episode_reward_max": 147.11785411834697, "episode_reward_min": -231.13877548277384, "episode_reward_mean": 90.09765561931584, "episode_len_mean": 499.18, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -77.1358619083961}, "policy_reward_max": {"shared_policy": 49.243504623572036}, "policy_reward_mean": {"shared_policy": 30.032551873105284}, "custom_metrics": {}, "hist_stats": {"episode_reward": [97.71480644121763, 71.18771148147059, 80.4629828222096, 91.12261090707032, 115.86906661838292, 70.53434547781941, 115.56505184248088, 87.8063565008342, 80.4506935290992, 98.10999379120766, 87.66169406194237, 96.96513341553508, 81.67421351745723, 123.17847246304154, 101.14233145210892, 33.30630826437846, 82.45331529062241, 74.17609300464392, 116.91233664751053, 85.43334784847684, 67.88583164755254, 97.65899042412639, 94.60938843712209, 84.3833603784442, 74.06223936192688, 64.81639426294711, 81.70351854432371, 82.86446484178302, 104.18902479112147, 102.89107834361491, 110.62462688540107, 115.35805238783358, 100.66686354577541, 80.7212713868357, 97.90625781007108, 84.58118292316793, 116.47796450555322, 73.77046054974197, 76.50411186181007, 80.19609223306176, 93.20274864998645, 61.10504546388984, 68.46108963154255, 87.00458501651883, 77.58462580665946, 120.22409273684022, 147.11785411834697, 116.05411050096151, 96.01985111460087, 113.21932524442671, 94.43346708267924, 52.650813788175554, 121.60828514536843, 89.9275504136458, 77.61815264914185, 79.99411564692852, 52.271170534193516, 67.87829358782616, 93.3786176536232, 95.53887776285409, 102.24301656521854, 106.70458242669702, 93.40956348180771, 113.57471618801355, 102.41981333121655, 100.05315684527156, 99.98722018674016, 54.116400092840195, 68.41639053076504, 79.82128459421801, 80.80390191823241, 87.58545440807939, 90.52445392683146, 112.85197986569256, 126.44080376997589, 99.87515728524886, -231.13877548277384, 140.2865833276881, 101.89444019459185, 102.95482451003043, 73.72105290787295, 107.37231701146808, 26.018120426684618, 126.02395740151402, 100.53048962727186, 102.9906993843615, 105.22501569800076, 93.40884126722811, 118.0896152603309, 105.06452351994812, 127.84277726337311, 108.12551390193401, 75.57028701156378, 92.24191854149102, 136.88055400596943, 97.47671470046043, 111.77178870141506, 70.094525385648, 98.54662103950976, 111.05454786121844], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 418, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [32.37214798728624, 32.61593571553627, 32.726722738395125, 23.9133492965872, 23.350281218687684, 23.924080966195703, 26.812518388032913, 26.48378498852253, 27.166679445654154, 30.568034997520343, 30.490442215775445, 30.064133693774536, 38.551735175152615, 38.58918294807275, 38.728148495157555, 22.990384588638932, 23.845588977138192, 23.69837191204229, 38.427080908169344, 38.59032167618473, 38.54764925812681, 29.22126584003368, 29.135598840812833, 29.449491819987685, 27.0599533903102, 26.799150156478078, 26.59158998231092, 32.566812490423516, 32.33843923111756, 33.20474206966658, 28.961545834938676, 29.332143706890434, 29.36800452011326, 32.13877945144971, 32.15311250587304, 32.67324145821233, 27.51096686845024, 27.140834895273045, 27.022411753733948, 41.26552553847432, 41.14513240754604, 40.76781451702118, 33.61133350431919, 34.04037167225033, 33.4906262755394, 11.128231892827898, 11.069348396733403, 11.108727974817157, 27.392102722078562, 27.483858782798052, 27.5773537857458, 24.957106970250607, 24.62146259844303, 24.59752343595028, 39.0025025466457, 38.900541346520185, 39.00929275434464, 28.438714757561684, 28.924287331523374, 28.070345759391785, 22.88858572238435, 22.35410101463397, 22.643144910534218, 32.48107486963272, 32.59821401536465, 32.57970153912902, 31.880787042280033, 31.934487977375582, 30.794113417466477, 27.930146023631096, 28.16660562157631, 28.28660873323679, 24.316027919451386, 25.106663145745785, 24.639548296729714, 21.5457486907641, 21.63659014614919, 21.634055426033825, 27.031719195346028, 27.126744310061127, 27.54505503891656, 27.345305303732545, 27.717621228347213, 27.80153830970326, 34.99473964174588, 34.638095920284584, 34.556189229091004, 34.48437780576447, 34.1038685987393, 34.302831939111144, 37.00097176091124, 37.027606935783595, 36.596048188706234, 38.61073566724856, 38.57793403913577, 38.16938268144925, 33.658218532800674, 33.80603529512882, 33.20260971784592, 26.70097769300142, 26.764324131111294, 27.25596956272298, 32.69388480174044, 32.640834777305514, 32.57153823102513, 28.214097264533237, 28.20717537713547, 28.159910281499222, 38.73381290088096, 38.69054927925268, 39.053602325419575, 24.18268910547097, 24.73806092453499, 24.849710519736007, 25.7372118824472, 25.10967807968457, 25.657221899678305, 26.637255559364945, 26.822096231083066, 26.73674044261375, 31.52200010286954, 31.26661345859368, 30.414135088523224, 20.250491969287395, 20.296124652028084, 20.558428842574358, 23.025058546413973, 23.075996554767087, 22.36003453036149, 28.90571991354227, 28.66507774591446, 29.4337873570621, 25.39574721455574, 26.236971501260996, 25.951907090842724, 40.17594456175962, 39.84052337209383, 40.20762480298677, 49.243504623572036, 48.752628932396576, 49.12172056237857, 38.577803942064435, 38.627314689258725, 38.848991869638354, 31.804225499431283, 32.06757822881141, 32.14804738635817, 37.95472876479228, 37.60406204809745, 37.66053443153699, 31.5449745679895, 31.517503942052514, 31.37098857263723, 17.336574504772813, 17.45203987757364, 17.862199405829102, 40.64626531070098, 40.4922721683979, 40.46974766626954, 30.326296103186905, 30.102722074836493, 29.498532235622406, 25.750438004732132, 25.916098246350884, 25.95161639805883, 26.783770541350037, 26.895534372578055, 26.314810733000428, 17.734409146010876, 17.500994116067886, 17.035767272114754, 22.674896689752728, 22.526817219952733, 22.676579678120703, 30.86061083773771, 31.33646955775717, 31.181537258128316, 31.75130795439084, 31.870403995116547, 31.9171658133467, 33.99226650844017, 34.046245275686175, 34.2045047810922, 34.958809062838554, 35.83034843951464, 35.915424924343824, 31.0826408714056, 30.95276238769293, 31.37416022270918, 38.150651417672634, 37.63593204319477, 37.78813272714615, 34.256574927518756, 34.031045014659554, 34.132193389038235, 33.41686953107515, 33.950646373132855, 32.685640941063554, 33.33616062998772, 33.1880297139287, 33.463029842823744, 18.113031022250652, 17.936708450317383, 18.06666062027216, 23.349306744833783, 22.478330110510186, 22.588753675421074, 26.722678281366825, 26.370358616113663, 26.728247696737526, 27.0885325881342, 27.151457807670027, 26.563911522428185, 28.64108568429947, 29.483489863574505, 29.460878860205412, 30.307858082155377, 30.63860650981465, 29.577989334861428, 37.800486414693296, 37.51711543276906, 37.5343780182302, 42.16189569731553, 42.26218522464235, 42.016722848018006, 33.238928228616714, 33.22816038876772, 33.40806866786443, -77.10370415945849, -77.1358619083961, -76.89920941491923, 46.808347126158566, 46.7303584391872, 46.74787776234248, 33.663476581374795, 33.97839921216169, 34.252564401055366, 34.56917913289119, 34.21934263904889, 34.16630273809035, 24.25479856133461, 24.513576447963715, 24.95267789857462, 35.95651879130551, 35.88818108352521, 35.52761713663736, 8.382735967636108, 8.576024740934372, 9.059359718114138, 41.702067519227654, 42.052837314705044, 42.269052567581326, 33.28857573370138, 33.56752737114826, 33.674386522422225, 34.13621375709772, 34.42137706466019, 34.43310856260359, 35.05917144815126, 35.24807565721372, 34.91776859263578, 31.213311453660324, 31.06680653368433, 31.12872327988346, 39.50044901482761, 38.99145694822073, 39.59770929728256, 35.05185788869858, 35.28275083191693, 34.72991479933262, 42.49109900991121, 42.770379460106284, 42.581298793355614, 36.06463086729248, 36.16969630060096, 35.89118673404057, 25.30425799265504, 25.06451039761305, 25.20151862129569, 30.49119958778222, 30.700548497339085, 31.050170456369713, 45.78968359654148, 45.83485858313118, 45.25601182629664, 31.962845996022224, 32.66248442232609, 32.85138428211212, 36.79873584210873, 37.57178796827793, 37.401264891028404, 23.612108466525868, 22.76330416401227, 23.71911275510986, 32.90140429635842, 32.87795314689477, 32.76726359625657, 36.99335755904515, 36.97092430790265, 37.09026599427064]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14329896372078735, "mean_inference_ms": 0.6962904842582462, "mean_action_processing_ms": 0.09612293432617218, "mean_env_wait_ms": 0.800584708379865, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 460000, "timesteps_this_iter": 0, "agent_timesteps_total": 1380000, "timers": {"sample_time_ms": 10428.166, "sample_throughput": 479.471, "load_time_ms": 0.1, "load_throughput": 49991704.41, "learn_time_ms": 1939.896, "learn_throughput": 2577.458, "update_time_ms": 9.049}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.470329472543004e-23, "cur_lr": 0.0005000000000000001, "total_loss": 5.187828540802002, "policy_loss": -0.0023357797295352257, "vf_loss": 5.276207542419433, "vf_explained_var": -0.12332762479782104, "kl": 0.0032370345667202148, "entropy": 8.604317569732666, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 460000, "num_agent_steps_sampled": 1380000, "num_steps_trained": 460000, "num_agent_steps_trained": 1380000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1583, "training_iteration": 92, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-17-53", "timestamp": 1706231873, "time_this_iter_s": 10.172640085220337, "time_total_s": 989.0065042972565, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D10D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 989.0065042972565, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 5.5, "ram_util_percent": 60.628571428571426}}
{"episode_reward_max": 147.11785411834697, "episode_reward_min": -231.13877548277384, "episode_reward_mean": 91.35621447864506, "episode_len_mean": 499.18, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -77.1358619083961}, "policy_reward_max": {"shared_policy": 49.243504623572036}, "policy_reward_mean": {"shared_policy": 30.45207149288168}, "custom_metrics": {}, "hist_stats": {"episode_reward": [87.66169406194237, 96.96513341553508, 81.67421351745723, 123.17847246304154, 101.14233145210892, 33.30630826437846, 82.45331529062241, 74.17609300464392, 116.91233664751053, 85.43334784847684, 67.88583164755254, 97.65899042412639, 94.60938843712209, 84.3833603784442, 74.06223936192688, 64.81639426294711, 81.70351854432371, 82.86446484178302, 104.18902479112147, 102.89107834361491, 110.62462688540107, 115.35805238783358, 100.66686354577541, 80.7212713868357, 97.90625781007108, 84.58118292316793, 116.47796450555322, 73.77046054974197, 76.50411186181007, 80.19609223306176, 93.20274864998645, 61.10504546388984, 68.46108963154255, 87.00458501651883, 77.58462580665946, 120.22409273684022, 147.11785411834697, 116.05411050096151, 96.01985111460087, 113.21932524442671, 94.43346708267924, 52.650813788175554, 121.60828514536843, 89.9275504136458, 77.61815264914185, 79.99411564692852, 52.271170534193516, 67.87829358782616, 93.3786176536232, 95.53887776285409, 102.24301656521854, 106.70458242669702, 93.40956348180771, 113.57471618801355, 102.41981333121655, 100.05315684527156, 99.98722018674016, 54.116400092840195, 68.41639053076504, 79.82128459421801, 80.80390191823241, 87.58545440807939, 90.52445392683146, 112.85197986569256, 126.44080376997589, 99.87515728524886, -231.13877548277384, 140.2865833276881, 101.89444019459185, 102.95482451003043, 73.72105290787295, 107.37231701146808, 26.018120426684618, 126.02395740151402, 100.53048962727186, 102.9906993843615, 105.22501569800076, 93.40884126722811, 118.0896152603309, 105.06452351994812, 127.84277726337311, 108.12551390193401, 75.57028701156378, 92.24191854149102, 136.88055400596943, 97.47671470046043, 111.77178870141506, 70.094525385648, 98.54662103950976, 111.05454786121844, 110.91609586589036, 114.39148020092398, 102.47069609351455, 98.42637932673094, 86.90079868957397, 109.62030689418313, 104.52157445996998, 78.09776641614735, 114.17205324210224, 115.16235415567644], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 418, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [28.961545834938676, 29.332143706890434, 29.36800452011326, 32.13877945144971, 32.15311250587304, 32.67324145821233, 27.51096686845024, 27.140834895273045, 27.022411753733948, 41.26552553847432, 41.14513240754604, 40.76781451702118, 33.61133350431919, 34.04037167225033, 33.4906262755394, 11.128231892827898, 11.069348396733403, 11.108727974817157, 27.392102722078562, 27.483858782798052, 27.5773537857458, 24.957106970250607, 24.62146259844303, 24.59752343595028, 39.0025025466457, 38.900541346520185, 39.00929275434464, 28.438714757561684, 28.924287331523374, 28.070345759391785, 22.88858572238435, 22.35410101463397, 22.643144910534218, 32.48107486963272, 32.59821401536465, 32.57970153912902, 31.880787042280033, 31.934487977375582, 30.794113417466477, 27.930146023631096, 28.16660562157631, 28.28660873323679, 24.316027919451386, 25.106663145745785, 24.639548296729714, 21.5457486907641, 21.63659014614919, 21.634055426033825, 27.031719195346028, 27.126744310061127, 27.54505503891656, 27.345305303732545, 27.717621228347213, 27.80153830970326, 34.99473964174588, 34.638095920284584, 34.556189229091004, 34.48437780576447, 34.1038685987393, 34.302831939111144, 37.00097176091124, 37.027606935783595, 36.596048188706234, 38.61073566724856, 38.57793403913577, 38.16938268144925, 33.658218532800674, 33.80603529512882, 33.20260971784592, 26.70097769300142, 26.764324131111294, 27.25596956272298, 32.69388480174044, 32.640834777305514, 32.57153823102513, 28.214097264533237, 28.20717537713547, 28.159910281499222, 38.73381290088096, 38.69054927925268, 39.053602325419575, 24.18268910547097, 24.73806092453499, 24.849710519736007, 25.7372118824472, 25.10967807968457, 25.657221899678305, 26.637255559364945, 26.822096231083066, 26.73674044261375, 31.52200010286954, 31.26661345859368, 30.414135088523224, 20.250491969287395, 20.296124652028084, 20.558428842574358, 23.025058546413973, 23.075996554767087, 22.36003453036149, 28.90571991354227, 28.66507774591446, 29.4337873570621, 25.39574721455574, 26.236971501260996, 25.951907090842724, 40.17594456175962, 39.84052337209383, 40.20762480298677, 49.243504623572036, 48.752628932396576, 49.12172056237857, 38.577803942064435, 38.627314689258725, 38.848991869638354, 31.804225499431283, 32.06757822881141, 32.14804738635817, 37.95472876479228, 37.60406204809745, 37.66053443153699, 31.5449745679895, 31.517503942052514, 31.37098857263723, 17.336574504772813, 17.45203987757364, 17.862199405829102, 40.64626531070098, 40.4922721683979, 40.46974766626954, 30.326296103186905, 30.102722074836493, 29.498532235622406, 25.750438004732132, 25.916098246350884, 25.95161639805883, 26.783770541350037, 26.895534372578055, 26.314810733000428, 17.734409146010876, 17.500994116067886, 17.035767272114754, 22.674896689752728, 22.526817219952733, 22.676579678120703, 30.86061083773771, 31.33646955775717, 31.181537258128316, 31.75130795439084, 31.870403995116547, 31.9171658133467, 33.99226650844017, 34.046245275686175, 34.2045047810922, 34.958809062838554, 35.83034843951464, 35.915424924343824, 31.0826408714056, 30.95276238769293, 31.37416022270918, 38.150651417672634, 37.63593204319477, 37.78813272714615, 34.256574927518756, 34.031045014659554, 34.132193389038235, 33.41686953107515, 33.950646373132855, 32.685640941063554, 33.33616062998772, 33.1880297139287, 33.463029842823744, 18.113031022250652, 17.936708450317383, 18.06666062027216, 23.349306744833783, 22.478330110510186, 22.588753675421074, 26.722678281366825, 26.370358616113663, 26.728247696737526, 27.0885325881342, 27.151457807670027, 26.563911522428185, 28.64108568429947, 29.483489863574505, 29.460878860205412, 30.307858082155377, 30.63860650981465, 29.577989334861428, 37.800486414693296, 37.51711543276906, 37.5343780182302, 42.16189569731553, 42.26218522464235, 42.016722848018006, 33.238928228616714, 33.22816038876772, 33.40806866786443, -77.10370415945849, -77.1358619083961, -76.89920941491923, 46.808347126158566, 46.7303584391872, 46.74787776234248, 33.663476581374795, 33.97839921216169, 34.252564401055366, 34.56917913289119, 34.21934263904889, 34.16630273809035, 24.25479856133461, 24.513576447963715, 24.95267789857462, 35.95651879130551, 35.88818108352521, 35.52761713663736, 8.382735967636108, 8.576024740934372, 9.059359718114138, 41.702067519227654, 42.052837314705044, 42.269052567581326, 33.28857573370138, 33.56752737114826, 33.674386522422225, 34.13621375709772, 34.42137706466019, 34.43310856260359, 35.05917144815126, 35.24807565721372, 34.91776859263578, 31.213311453660324, 31.06680653368433, 31.12872327988346, 39.50044901482761, 38.99145694822073, 39.59770929728256, 35.05185788869858, 35.28275083191693, 34.72991479933262, 42.49109900991121, 42.770379460106284, 42.581298793355614, 36.06463086729248, 36.16969630060096, 35.89118673404057, 25.30425799265504, 25.06451039761305, 25.20151862129569, 30.49119958778222, 30.700548497339085, 31.050170456369713, 45.78968359654148, 45.83485858313118, 45.25601182629664, 31.962845996022224, 32.66248442232609, 32.85138428211212, 36.79873584210873, 37.57178796827793, 37.401264891028404, 23.612108466525868, 22.76330416401227, 23.71911275510986, 32.90140429635842, 32.87795314689477, 32.76726359625657, 36.99335755904515, 36.97092430790265, 37.09026599427064, 37.15765417429307, 36.66087558368841, 37.097566107908875, 38.26234802324325, 38.16818905249238, 37.96094312518835, 33.859526117642716, 34.390513564770416, 34.220656411101416, 32.89694134394327, 32.1022726992766, 33.42716528351107, 29.182218285898358, 28.75056968132654, 28.968010722349078, 36.53901730726162, 36.55301599825421, 36.528273588667304, 34.13007042308648, 35.13722051804264, 35.254283518840865, 25.89971812814474, 26.245198206976056, 25.952850081026554, 38.11219949057946, 38.14122015393028, 37.9186335975925, 38.484844661550596, 38.41898399591446, 38.258525498211384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1432244752062641, "mean_inference_ms": 0.6961488306974621, "mean_action_processing_ms": 0.09608044111813568, "mean_env_wait_ms": 0.8002292525888473, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 465000, "timesteps_this_iter": 0, "agent_timesteps_total": 1395000, "timers": {"sample_time_ms": 10420.726, "sample_throughput": 479.813, "load_time_ms": 0.1, "load_throughput": 49991704.41, "learn_time_ms": 1944.334, "learn_throughput": 2571.574, "update_time_ms": 9.15}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.235164736271502e-23, "cur_lr": 0.0005000000000000001, "total_loss": 6.704452037811279, "policy_loss": -0.00187038764264153, "vf_loss": 6.7929786205291744, "vf_explained_var": -0.134689998626709, "kl": 0.001914775959469275, "entropy": 8.665591812133789, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 465000, "num_agent_steps_sampled": 1395000, "num_steps_trained": 465000, "num_agent_steps_trained": 1395000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1593, "training_iteration": 93, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-18-03", "timestamp": 1706231883, "time_this_iter_s": 10.287535905838013, "time_total_s": 999.2940402030945, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140423C310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 999.2940402030945, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 7.179999999999999, "ram_util_percent": 60.646666666666675}}
{"episode_reward_max": 147.11785411834697, "episode_reward_min": -231.13877548277384, "episode_reward_mean": 93.64695814782571, "episode_len_mean": 499.18, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -77.1358619083961}, "policy_reward_max": {"shared_policy": 49.243504623572036}, "policy_reward_mean": {"shared_policy": 31.215652715941893}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.88583164755254, 97.65899042412639, 94.60938843712209, 84.3833603784442, 74.06223936192688, 64.81639426294711, 81.70351854432371, 82.86446484178302, 104.18902479112147, 102.89107834361491, 110.62462688540107, 115.35805238783358, 100.66686354577541, 80.7212713868357, 97.90625781007108, 84.58118292316793, 116.47796450555322, 73.77046054974197, 76.50411186181007, 80.19609223306176, 93.20274864998645, 61.10504546388984, 68.46108963154255, 87.00458501651883, 77.58462580665946, 120.22409273684022, 147.11785411834697, 116.05411050096151, 96.01985111460087, 113.21932524442671, 94.43346708267924, 52.650813788175554, 121.60828514536843, 89.9275504136458, 77.61815264914185, 79.99411564692852, 52.271170534193516, 67.87829358782616, 93.3786176536232, 95.53887776285409, 102.24301656521854, 106.70458242669702, 93.40956348180771, 113.57471618801355, 102.41981333121655, 100.05315684527156, 99.98722018674016, 54.116400092840195, 68.41639053076504, 79.82128459421801, 80.80390191823241, 87.58545440807939, 90.52445392683146, 112.85197986569256, 126.44080376997589, 99.87515728524886, -231.13877548277384, 140.2865833276881, 101.89444019459185, 102.95482451003043, 73.72105290787295, 107.37231701146808, 26.018120426684618, 126.02395740151402, 100.53048962727186, 102.9906993843615, 105.22501569800076, 93.40884126722811, 118.0896152603309, 105.06452351994812, 127.84277726337311, 108.12551390193401, 75.57028701156378, 92.24191854149102, 136.88055400596943, 97.47671470046043, 111.77178870141506, 70.094525385648, 98.54662103950976, 111.05454786121844, 110.91609586589036, 114.39148020092398, 102.47069609351455, 98.42637932673094, 86.90079868957397, 109.62030689418313, 104.52157445996998, 78.09776641614735, 114.17205324210224, 115.16235415567644, 99.4799759276211, 104.24974867329, 113.44874222949146, 117.55758431553838, 138.5394292734565, 112.40542024211027, 89.98520539328453, 138.94905738532555, 67.56256507127546, 129.79988437239084], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 418, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [22.88858572238435, 22.35410101463397, 22.643144910534218, 32.48107486963272, 32.59821401536465, 32.57970153912902, 31.880787042280033, 31.934487977375582, 30.794113417466477, 27.930146023631096, 28.16660562157631, 28.28660873323679, 24.316027919451386, 25.106663145745785, 24.639548296729714, 21.5457486907641, 21.63659014614919, 21.634055426033825, 27.031719195346028, 27.126744310061127, 27.54505503891656, 27.345305303732545, 27.717621228347213, 27.80153830970326, 34.99473964174588, 34.638095920284584, 34.556189229091004, 34.48437780576447, 34.1038685987393, 34.302831939111144, 37.00097176091124, 37.027606935783595, 36.596048188706234, 38.61073566724856, 38.57793403913577, 38.16938268144925, 33.658218532800674, 33.80603529512882, 33.20260971784592, 26.70097769300142, 26.764324131111294, 27.25596956272298, 32.69388480174044, 32.640834777305514, 32.57153823102513, 28.214097264533237, 28.20717537713547, 28.159910281499222, 38.73381290088096, 38.69054927925268, 39.053602325419575, 24.18268910547097, 24.73806092453499, 24.849710519736007, 25.7372118824472, 25.10967807968457, 25.657221899678305, 26.637255559364945, 26.822096231083066, 26.73674044261375, 31.52200010286954, 31.26661345859368, 30.414135088523224, 20.250491969287395, 20.296124652028084, 20.558428842574358, 23.025058546413973, 23.075996554767087, 22.36003453036149, 28.90571991354227, 28.66507774591446, 29.4337873570621, 25.39574721455574, 26.236971501260996, 25.951907090842724, 40.17594456175962, 39.84052337209383, 40.20762480298677, 49.243504623572036, 48.752628932396576, 49.12172056237857, 38.577803942064435, 38.627314689258725, 38.848991869638354, 31.804225499431283, 32.06757822881141, 32.14804738635817, 37.95472876479228, 37.60406204809745, 37.66053443153699, 31.5449745679895, 31.517503942052514, 31.37098857263723, 17.336574504772813, 17.45203987757364, 17.862199405829102, 40.64626531070098, 40.4922721683979, 40.46974766626954, 30.326296103186905, 30.102722074836493, 29.498532235622406, 25.750438004732132, 25.916098246350884, 25.95161639805883, 26.783770541350037, 26.895534372578055, 26.314810733000428, 17.734409146010876, 17.500994116067886, 17.035767272114754, 22.674896689752728, 22.526817219952733, 22.676579678120703, 30.86061083773771, 31.33646955775717, 31.181537258128316, 31.75130795439084, 31.870403995116547, 31.9171658133467, 33.99226650844017, 34.046245275686175, 34.2045047810922, 34.958809062838554, 35.83034843951464, 35.915424924343824, 31.0826408714056, 30.95276238769293, 31.37416022270918, 38.150651417672634, 37.63593204319477, 37.78813272714615, 34.256574927518756, 34.031045014659554, 34.132193389038235, 33.41686953107515, 33.950646373132855, 32.685640941063554, 33.33616062998772, 33.1880297139287, 33.463029842823744, 18.113031022250652, 17.936708450317383, 18.06666062027216, 23.349306744833783, 22.478330110510186, 22.588753675421074, 26.722678281366825, 26.370358616113663, 26.728247696737526, 27.0885325881342, 27.151457807670027, 26.563911522428185, 28.64108568429947, 29.483489863574505, 29.460878860205412, 30.307858082155377, 30.63860650981465, 29.577989334861428, 37.800486414693296, 37.51711543276906, 37.5343780182302, 42.16189569731553, 42.26218522464235, 42.016722848018006, 33.238928228616714, 33.22816038876772, 33.40806866786443, -77.10370415945849, -77.1358619083961, -76.89920941491923, 46.808347126158566, 46.7303584391872, 46.74787776234248, 33.663476581374795, 33.97839921216169, 34.252564401055366, 34.56917913289119, 34.21934263904889, 34.16630273809035, 24.25479856133461, 24.513576447963715, 24.95267789857462, 35.95651879130551, 35.88818108352521, 35.52761713663736, 8.382735967636108, 8.576024740934372, 9.059359718114138, 41.702067519227654, 42.052837314705044, 42.269052567581326, 33.28857573370138, 33.56752737114826, 33.674386522422225, 34.13621375709772, 34.42137706466019, 34.43310856260359, 35.05917144815126, 35.24807565721372, 34.91776859263578, 31.213311453660324, 31.06680653368433, 31.12872327988346, 39.50044901482761, 38.99145694822073, 39.59770929728256, 35.05185788869858, 35.28275083191693, 34.72991479933262, 42.49109900991121, 42.770379460106284, 42.581298793355614, 36.06463086729248, 36.16969630060096, 35.89118673404057, 25.30425799265504, 25.06451039761305, 25.20151862129569, 30.49119958778222, 30.700548497339085, 31.050170456369713, 45.78968359654148, 45.83485858313118, 45.25601182629664, 31.962845996022224, 32.66248442232609, 32.85138428211212, 36.79873584210873, 37.57178796827793, 37.401264891028404, 23.612108466525868, 22.76330416401227, 23.71911275510986, 32.90140429635842, 32.87795314689477, 32.76726359625657, 36.99335755904515, 36.97092430790265, 37.09026599427064, 37.15765417429307, 36.66087558368841, 37.097566107908875, 38.26234802324325, 38.16818905249238, 37.96094312518835, 33.859526117642716, 34.390513564770416, 34.220656411101416, 32.89694134394327, 32.1022726992766, 33.42716528351107, 29.182218285898358, 28.75056968132654, 28.968010722349078, 36.53901730726162, 36.55301599825421, 36.528273588667304, 34.13007042308648, 35.13722051804264, 35.254283518840865, 25.89971812814474, 26.245198206976056, 25.952850081026554, 38.11219949057946, 38.14122015393028, 37.9186335975925, 38.484844661550596, 38.41898399591446, 38.258525498211384, 32.76799916724363, 33.42678397397199, 33.285192786405474, 34.74575180311997, 34.92510637020071, 34.57889049996932, 37.6723517080148, 37.909851760913924, 37.86653876056273, 39.463022167483956, 38.593003342549, 39.501558805505425, 45.62706780433655, 46.215302765369415, 46.69705870375037, 37.449365550652146, 37.53832409181632, 37.4177305996418, 29.671124229828507, 30.186566850791365, 30.12751431266466, 46.25496819615364, 46.5719498693943, 46.12213931977749, 22.833418449154124, 22.392182126641273, 22.33696449548006, 43.046087863544614, 43.37755113715926, 43.376245371686906]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14314994876019768, "mean_inference_ms": 0.6960170962635686, "mean_action_processing_ms": 0.09603493020738353, "mean_env_wait_ms": 0.7998565420819126, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 470000, "timesteps_this_iter": 0, "agent_timesteps_total": 1410000, "timers": {"sample_time_ms": 10414.595, "sample_throughput": 480.095, "load_time_ms": 0.116, "load_throughput": 43080361.545, "learn_time_ms": 1942.002, "learn_throughput": 2574.663, "update_time_ms": 9.146}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.117582368135751e-23, "cur_lr": 0.0005000000000000001, "total_loss": 5.529396820068359, "policy_loss": -0.0022212841712931698, "vf_loss": 5.617954158782959, "vf_explained_var": -0.018120884895324707, "kl": 0.0033301801420949134, "entropy": 8.633629608154298, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 470000, "num_agent_steps_sampled": 1410000, "num_steps_trained": 470000, "num_agent_steps_trained": 1410000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1603, "training_iteration": 94, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-18-13", "timestamp": 1706231893, "time_this_iter_s": 10.171159029006958, "time_total_s": 1009.4651992321014, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401AE6670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1009.4651992321014, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 60.60714285714287}}
{"episode_reward_max": 147.11785411834697, "episode_reward_min": -231.13877548277384, "episode_reward_mean": 94.65848804781963, "episode_len_mean": 499.18, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -77.1358619083961}, "policy_reward_max": {"shared_policy": 49.243504623572036}, "policy_reward_mean": {"shared_policy": 31.552829349273203}, "custom_metrics": {}, "hist_stats": {"episode_reward": [110.62462688540107, 115.35805238783358, 100.66686354577541, 80.7212713868357, 97.90625781007108, 84.58118292316793, 116.47796450555322, 73.77046054974197, 76.50411186181007, 80.19609223306176, 93.20274864998645, 61.10504546388984, 68.46108963154255, 87.00458501651883, 77.58462580665946, 120.22409273684022, 147.11785411834697, 116.05411050096151, 96.01985111460087, 113.21932524442671, 94.43346708267924, 52.650813788175554, 121.60828514536843, 89.9275504136458, 77.61815264914185, 79.99411564692852, 52.271170534193516, 67.87829358782616, 93.3786176536232, 95.53887776285409, 102.24301656521854, 106.70458242669702, 93.40956348180771, 113.57471618801355, 102.41981333121655, 100.05315684527156, 99.98722018674016, 54.116400092840195, 68.41639053076504, 79.82128459421801, 80.80390191823241, 87.58545440807939, 90.52445392683146, 112.85197986569256, 126.44080376997589, 99.87515728524886, -231.13877548277384, 140.2865833276881, 101.89444019459185, 102.95482451003043, 73.72105290787295, 107.37231701146808, 26.018120426684618, 126.02395740151402, 100.53048962727186, 102.9906993843615, 105.22501569800076, 93.40884126722811, 118.0896152603309, 105.06452351994812, 127.84277726337311, 108.12551390193401, 75.57028701156378, 92.24191854149102, 136.88055400596943, 97.47671470046043, 111.77178870141506, 70.094525385648, 98.54662103950976, 111.05454786121844, 110.91609586589036, 114.39148020092398, 102.47069609351455, 98.42637932673094, 86.90079868957397, 109.62030689418313, 104.52157445996998, 78.09776641614735, 114.17205324210224, 115.16235415567644, 99.4799759276211, 104.24974867329, 113.44874222949146, 117.55758431553838, 138.5394292734565, 112.40542024211027, 89.98520539328453, 138.94905738532555, 67.56256507127546, 129.79988437239084, 54.45388766378164, 100.35119411349295, 126.29308914020655, 82.52781672682613, 98.52946651540697, 121.66643320862201, 97.78021225053814, 85.35461777728048, 91.95652903243898, 97.30403460375962], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 418, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [37.00097176091124, 37.027606935783595, 36.596048188706234, 38.61073566724856, 38.57793403913577, 38.16938268144925, 33.658218532800674, 33.80603529512882, 33.20260971784592, 26.70097769300142, 26.764324131111294, 27.25596956272298, 32.69388480174044, 32.640834777305514, 32.57153823102513, 28.214097264533237, 28.20717537713547, 28.159910281499222, 38.73381290088096, 38.69054927925268, 39.053602325419575, 24.18268910547097, 24.73806092453499, 24.849710519736007, 25.7372118824472, 25.10967807968457, 25.657221899678305, 26.637255559364945, 26.822096231083066, 26.73674044261375, 31.52200010286954, 31.26661345859368, 30.414135088523224, 20.250491969287395, 20.296124652028084, 20.558428842574358, 23.025058546413973, 23.075996554767087, 22.36003453036149, 28.90571991354227, 28.66507774591446, 29.4337873570621, 25.39574721455574, 26.236971501260996, 25.951907090842724, 40.17594456175962, 39.84052337209383, 40.20762480298677, 49.243504623572036, 48.752628932396576, 49.12172056237857, 38.577803942064435, 38.627314689258725, 38.848991869638354, 31.804225499431283, 32.06757822881141, 32.14804738635817, 37.95472876479228, 37.60406204809745, 37.66053443153699, 31.5449745679895, 31.517503942052514, 31.37098857263723, 17.336574504772813, 17.45203987757364, 17.862199405829102, 40.64626531070098, 40.4922721683979, 40.46974766626954, 30.326296103186905, 30.102722074836493, 29.498532235622406, 25.750438004732132, 25.916098246350884, 25.95161639805883, 26.783770541350037, 26.895534372578055, 26.314810733000428, 17.734409146010876, 17.500994116067886, 17.035767272114754, 22.674896689752728, 22.526817219952733, 22.676579678120703, 30.86061083773771, 31.33646955775717, 31.181537258128316, 31.75130795439084, 31.870403995116547, 31.9171658133467, 33.99226650844017, 34.046245275686175, 34.2045047810922, 34.958809062838554, 35.83034843951464, 35.915424924343824, 31.0826408714056, 30.95276238769293, 31.37416022270918, 38.150651417672634, 37.63593204319477, 37.78813272714615, 34.256574927518756, 34.031045014659554, 34.132193389038235, 33.41686953107515, 33.950646373132855, 32.685640941063554, 33.33616062998772, 33.1880297139287, 33.463029842823744, 18.113031022250652, 17.936708450317383, 18.06666062027216, 23.349306744833783, 22.478330110510186, 22.588753675421074, 26.722678281366825, 26.370358616113663, 26.728247696737526, 27.0885325881342, 27.151457807670027, 26.563911522428185, 28.64108568429947, 29.483489863574505, 29.460878860205412, 30.307858082155377, 30.63860650981465, 29.577989334861428, 37.800486414693296, 37.51711543276906, 37.5343780182302, 42.16189569731553, 42.26218522464235, 42.016722848018006, 33.238928228616714, 33.22816038876772, 33.40806866786443, -77.10370415945849, -77.1358619083961, -76.89920941491923, 46.808347126158566, 46.7303584391872, 46.74787776234248, 33.663476581374795, 33.97839921216169, 34.252564401055366, 34.56917913289119, 34.21934263904889, 34.16630273809035, 24.25479856133461, 24.513576447963715, 24.95267789857462, 35.95651879130551, 35.88818108352521, 35.52761713663736, 8.382735967636108, 8.576024740934372, 9.059359718114138, 41.702067519227654, 42.052837314705044, 42.269052567581326, 33.28857573370138, 33.56752737114826, 33.674386522422225, 34.13621375709772, 34.42137706466019, 34.43310856260359, 35.05917144815126, 35.24807565721372, 34.91776859263578, 31.213311453660324, 31.06680653368433, 31.12872327988346, 39.50044901482761, 38.99145694822073, 39.59770929728256, 35.05185788869858, 35.28275083191693, 34.72991479933262, 42.49109900991121, 42.770379460106284, 42.581298793355614, 36.06463086729248, 36.16969630060096, 35.89118673404057, 25.30425799265504, 25.06451039761305, 25.20151862129569, 30.49119958778222, 30.700548497339085, 31.050170456369713, 45.78968359654148, 45.83485858313118, 45.25601182629664, 31.962845996022224, 32.66248442232609, 32.85138428211212, 36.79873584210873, 37.57178796827793, 37.401264891028404, 23.612108466525868, 22.76330416401227, 23.71911275510986, 32.90140429635842, 32.87795314689477, 32.76726359625657, 36.99335755904515, 36.97092430790265, 37.09026599427064, 37.15765417429307, 36.66087558368841, 37.097566107908875, 38.26234802324325, 38.16818905249238, 37.96094312518835, 33.859526117642716, 34.390513564770416, 34.220656411101416, 32.89694134394327, 32.1022726992766, 33.42716528351107, 29.182218285898358, 28.75056968132654, 28.968010722349078, 36.53901730726162, 36.55301599825421, 36.528273588667304, 34.13007042308648, 35.13722051804264, 35.254283518840865, 25.89971812814474, 26.245198206976056, 25.952850081026554, 38.11219949057946, 38.14122015393028, 37.9186335975925, 38.484844661550596, 38.41898399591446, 38.258525498211384, 32.76799916724363, 33.42678397397199, 33.285192786405474, 34.74575180311997, 34.92510637020071, 34.57889049996932, 37.6723517080148, 37.909851760913924, 37.86653876056273, 39.463022167483956, 38.593003342549, 39.501558805505425, 45.62706780433655, 46.215302765369415, 46.69705870375037, 37.449365550652146, 37.53832409181632, 37.4177305996418, 29.671124229828507, 30.186566850791365, 30.12751431266466, 46.25496819615364, 46.5719498693943, 46.12213931977749, 22.833418449154124, 22.392182126641273, 22.33696449548006, 43.046087863544614, 43.37755113715926, 43.376245371686906, 18.422267742455006, 17.999063327908516, 18.03255659341812, 33.32324969520171, 33.551855263610676, 33.476089154680565, 42.34837538624802, 41.66941278676191, 42.275300967196614, 27.497140211984515, 27.528870209120214, 27.501806305721402, 32.77775690704584, 32.81346422433853, 32.93824538402259, 40.14641892413297, 41.023487250941486, 40.49652703354755, 32.86009416698167, 32.38454651335874, 32.53557157019773, 28.617356633457035, 28.358719343940407, 28.37854179988304, 30.41037693371375, 30.711550561090306, 30.834601537634924, 32.38477403546372, 32.60402680623034, 32.31523376206556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14307082337114535, "mean_inference_ms": 0.6958725621855615, "mean_action_processing_ms": 0.09599214551882591, "mean_env_wait_ms": 0.7994629529855243, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 475000, "timesteps_this_iter": 0, "agent_timesteps_total": 1425000, "timers": {"sample_time_ms": 10388.254, "sample_throughput": 481.313, "load_time_ms": 0.216, "load_throughput": 23132053.827, "learn_time_ms": 1951.826, "learn_throughput": 2561.704, "update_time_ms": 9.347}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0587911840678755e-23, "cur_lr": 0.0005000000000000001, "total_loss": 5.352816343307495, "policy_loss": -0.0018806007385471224, "vf_loss": 5.441201877593994, "vf_explained_var": -0.016180455684661865, "kl": 0.002567941445179355, "entropy": 8.650506496429443, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 475000, "num_agent_steps_sampled": 1425000, "num_steps_trained": 475000, "num_agent_steps_trained": 1425000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1613, "training_iteration": 95, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-18-23", "timestamp": 1706231903, "time_this_iter_s": 10.178919792175293, "time_total_s": 1019.6441190242767, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402417040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1019.6441190242767, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 6.739999999999999, "ram_util_percent": 60.56666666666667}}
{"episode_reward_max": 147.11785411834697, "episode_reward_min": -304.5475348830223, "episode_reward_mean": 91.46539176396378, "episode_len_mean": 494.8, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -107.96654301385085}, "policy_reward_max": {"shared_policy": 49.243504623572036}, "policy_reward_mean": {"shared_policy": 30.48846392132126}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.10504546388984, 68.46108963154255, 87.00458501651883, 77.58462580665946, 120.22409273684022, 147.11785411834697, 116.05411050096151, 96.01985111460087, 113.21932524442671, 94.43346708267924, 52.650813788175554, 121.60828514536843, 89.9275504136458, 77.61815264914185, 79.99411564692852, 52.271170534193516, 67.87829358782616, 93.3786176536232, 95.53887776285409, 102.24301656521854, 106.70458242669702, 93.40956348180771, 113.57471618801355, 102.41981333121655, 100.05315684527156, 99.98722018674016, 54.116400092840195, 68.41639053076504, 79.82128459421801, 80.80390191823241, 87.58545440807939, 90.52445392683146, 112.85197986569256, 126.44080376997589, 99.87515728524886, -231.13877548277384, 140.2865833276881, 101.89444019459185, 102.95482451003043, 73.72105290787295, 107.37231701146808, 26.018120426684618, 126.02395740151402, 100.53048962727186, 102.9906993843615, 105.22501569800076, 93.40884126722811, 118.0896152603309, 105.06452351994812, 127.84277726337311, 108.12551390193401, 75.57028701156378, 92.24191854149102, 136.88055400596943, 97.47671470046043, 111.77178870141506, 70.094525385648, 98.54662103950976, 111.05454786121844, 110.91609586589036, 114.39148020092398, 102.47069609351455, 98.42637932673094, 86.90079868957397, 109.62030689418313, 104.52157445996998, 78.09776641614735, 114.17205324210224, 115.16235415567644, 99.4799759276211, 104.24974867329, 113.44874222949146, 117.55758431553838, 138.5394292734565, 112.40542024211027, 89.98520539328453, 138.94905738532555, 67.56256507127546, 129.79988437239084, 54.45388766378164, 100.35119411349295, 126.29308914020655, 82.52781672682613, 98.52946651540697, 121.66643320862201, 97.78021225053814, 85.35461777728048, 91.95652903243898, 97.30403460375962, 111.5683522671461, 92.73105284199116, 126.47524957032871, 90.28002841770649, 83.86686263419686, 118.52020236849783, 95.5653587458655, 129.2420795559884, 79.56541659496725, 87.4329362399876, -304.5475348830223], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 418, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 62], "policy_shared_policy_reward": [20.250491969287395, 20.296124652028084, 20.558428842574358, 23.025058546413973, 23.075996554767087, 22.36003453036149, 28.90571991354227, 28.66507774591446, 29.4337873570621, 25.39574721455574, 26.236971501260996, 25.951907090842724, 40.17594456175962, 39.84052337209383, 40.20762480298677, 49.243504623572036, 48.752628932396576, 49.12172056237857, 38.577803942064435, 38.627314689258725, 38.848991869638354, 31.804225499431283, 32.06757822881141, 32.14804738635817, 37.95472876479228, 37.60406204809745, 37.66053443153699, 31.5449745679895, 31.517503942052514, 31.37098857263723, 17.336574504772813, 17.45203987757364, 17.862199405829102, 40.64626531070098, 40.4922721683979, 40.46974766626954, 30.326296103186905, 30.102722074836493, 29.498532235622406, 25.750438004732132, 25.916098246350884, 25.95161639805883, 26.783770541350037, 26.895534372578055, 26.314810733000428, 17.734409146010876, 17.500994116067886, 17.035767272114754, 22.674896689752728, 22.526817219952733, 22.676579678120703, 30.86061083773771, 31.33646955775717, 31.181537258128316, 31.75130795439084, 31.870403995116547, 31.9171658133467, 33.99226650844017, 34.046245275686175, 34.2045047810922, 34.958809062838554, 35.83034843951464, 35.915424924343824, 31.0826408714056, 30.95276238769293, 31.37416022270918, 38.150651417672634, 37.63593204319477, 37.78813272714615, 34.256574927518756, 34.031045014659554, 34.132193389038235, 33.41686953107515, 33.950646373132855, 32.685640941063554, 33.33616062998772, 33.1880297139287, 33.463029842823744, 18.113031022250652, 17.936708450317383, 18.06666062027216, 23.349306744833783, 22.478330110510186, 22.588753675421074, 26.722678281366825, 26.370358616113663, 26.728247696737526, 27.0885325881342, 27.151457807670027, 26.563911522428185, 28.64108568429947, 29.483489863574505, 29.460878860205412, 30.307858082155377, 30.63860650981465, 29.577989334861428, 37.800486414693296, 37.51711543276906, 37.5343780182302, 42.16189569731553, 42.26218522464235, 42.016722848018006, 33.238928228616714, 33.22816038876772, 33.40806866786443, -77.10370415945849, -77.1358619083961, -76.89920941491923, 46.808347126158566, 46.7303584391872, 46.74787776234248, 33.663476581374795, 33.97839921216169, 34.252564401055366, 34.56917913289119, 34.21934263904889, 34.16630273809035, 24.25479856133461, 24.513576447963715, 24.95267789857462, 35.95651879130551, 35.88818108352521, 35.52761713663736, 8.382735967636108, 8.576024740934372, 9.059359718114138, 41.702067519227654, 42.052837314705044, 42.269052567581326, 33.28857573370138, 33.56752737114826, 33.674386522422225, 34.13621375709772, 34.42137706466019, 34.43310856260359, 35.05917144815126, 35.24807565721372, 34.91776859263578, 31.213311453660324, 31.06680653368433, 31.12872327988346, 39.50044901482761, 38.99145694822073, 39.59770929728256, 35.05185788869858, 35.28275083191693, 34.72991479933262, 42.49109900991121, 42.770379460106284, 42.581298793355614, 36.06463086729248, 36.16969630060096, 35.89118673404057, 25.30425799265504, 25.06451039761305, 25.20151862129569, 30.49119958778222, 30.700548497339085, 31.050170456369713, 45.78968359654148, 45.83485858313118, 45.25601182629664, 31.962845996022224, 32.66248442232609, 32.85138428211212, 36.79873584210873, 37.57178796827793, 37.401264891028404, 23.612108466525868, 22.76330416401227, 23.71911275510986, 32.90140429635842, 32.87795314689477, 32.76726359625657, 36.99335755904515, 36.97092430790265, 37.09026599427064, 37.15765417429307, 36.66087558368841, 37.097566107908875, 38.26234802324325, 38.16818905249238, 37.96094312518835, 33.859526117642716, 34.390513564770416, 34.220656411101416, 32.89694134394327, 32.1022726992766, 33.42716528351107, 29.182218285898358, 28.75056968132654, 28.968010722349078, 36.53901730726162, 36.55301599825421, 36.528273588667304, 34.13007042308648, 35.13722051804264, 35.254283518840865, 25.89971812814474, 26.245198206976056, 25.952850081026554, 38.11219949057946, 38.14122015393028, 37.9186335975925, 38.484844661550596, 38.41898399591446, 38.258525498211384, 32.76799916724363, 33.42678397397199, 33.285192786405474, 34.74575180311997, 34.92510637020071, 34.57889049996932, 37.6723517080148, 37.909851760913924, 37.86653876056273, 39.463022167483956, 38.593003342549, 39.501558805505425, 45.62706780433655, 46.215302765369415, 46.69705870375037, 37.449365550652146, 37.53832409181632, 37.4177305996418, 29.671124229828507, 30.186566850791365, 30.12751431266466, 46.25496819615364, 46.5719498693943, 46.12213931977749, 22.833418449154124, 22.392182126641273, 22.33696449548006, 43.046087863544614, 43.37755113715926, 43.376245371686906, 18.422267742455006, 17.999063327908516, 18.03255659341812, 33.32324969520171, 33.551855263610676, 33.476089154680565, 42.34837538624802, 41.66941278676191, 42.275300967196614, 27.497140211984515, 27.528870209120214, 27.501806305721402, 32.77775690704584, 32.81346422433853, 32.93824538402259, 40.14641892413297, 41.023487250941486, 40.49652703354755, 32.86009416698167, 32.38454651335874, 32.53557157019773, 28.617356633457035, 28.358719343940407, 28.37854179988304, 30.41037693371375, 30.711550561090306, 30.834601537634924, 32.38477403546372, 32.60402680623034, 32.31523376206556, 36.86675923069318, 37.43065482129653, 37.27093821515639, 30.79792561630407, 31.166202171395213, 30.766925054291875, 41.82212636868158, 42.35726548653716, 42.295857715109975, 30.07597655802965, 30.112265281379223, 30.091786578297615, 28.057007230197385, 28.016112511356667, 27.79374289264281, 39.44457750519116, 39.54007092614968, 39.53555393715699, 31.981740136320383, 31.5069095964233, 32.076709013121814, 43.36831400791803, 43.22574215630689, 42.64802339176336, 26.44009167701006, 26.630987836048007, 26.49433708190918, 29.245466650774077, 29.098225203653172, 29.08924438556035, -98.27647874752681, -98.30451312164466, -107.96654301385085]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.142961656583413, "mean_inference_ms": 0.6956787821598925, "mean_action_processing_ms": 0.09596074498625684, "mean_env_wait_ms": 0.7991173886831693, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 480000, "timesteps_this_iter": 0, "agent_timesteps_total": 1440000, "timers": {"sample_time_ms": 10460.04, "sample_throughput": 478.01, "load_time_ms": 0.216, "load_throughput": 23132053.827, "learn_time_ms": 1958.708, "learn_throughput": 2552.703, "update_time_ms": 9.45}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.2939559203393774e-24, "cur_lr": 0.0005000000000000001, "total_loss": 91.9354118347168, "policy_loss": -0.002522328037113564, "vf_loss": 92.02564926147461, "vf_explained_var": 0.000868910551071167, "kl": 0.0050947603187742815, "entropy": 8.77172212600708, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 480000, "num_agent_steps_sampled": 1440000, "num_steps_trained": 480000, "num_agent_steps_trained": 1440000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1624, "training_iteration": 96, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-18-34", "timestamp": 1706231914, "time_this_iter_s": 10.92273235321045, "time_total_s": 1030.5668513774872, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002146F7DD0D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1030.5668513774872, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 8.606666666666666, "ram_util_percent": 61.13333333333335}}
{"episode_reward_max": 148.25369549915206, "episode_reward_min": -309.2508905529976, "episode_reward_mean": 90.2024858870246, "episode_len_mean": 490.57, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -108.00657002131145}, "policy_reward_max": {"shared_policy": 49.67916353916128}, "policy_reward_mean": {"shared_policy": 30.067495295674863}, "custom_metrics": {}, "hist_stats": {"episode_reward": [121.60828514536843, 89.9275504136458, 77.61815264914185, 79.99411564692852, 52.271170534193516, 67.87829358782616, 93.3786176536232, 95.53887776285409, 102.24301656521854, 106.70458242669702, 93.40956348180771, 113.57471618801355, 102.41981333121655, 100.05315684527156, 99.98722018674016, 54.116400092840195, 68.41639053076504, 79.82128459421801, 80.80390191823241, 87.58545440807939, 90.52445392683146, 112.85197986569256, 126.44080376997589, 99.87515728524886, -231.13877548277384, 140.2865833276881, 101.89444019459185, 102.95482451003043, 73.72105290787295, 107.37231701146808, 26.018120426684618, 126.02395740151402, 100.53048962727186, 102.9906993843615, 105.22501569800076, 93.40884126722811, 118.0896152603309, 105.06452351994812, 127.84277726337311, 108.12551390193401, 75.57028701156378, 92.24191854149102, 136.88055400596943, 97.47671470046043, 111.77178870141506, 70.094525385648, 98.54662103950976, 111.05454786121844, 110.91609586589036, 114.39148020092398, 102.47069609351455, 98.42637932673094, 86.90079868957397, 109.62030689418313, 104.52157445996998, 78.09776641614735, 114.17205324210224, 115.16235415567644, 99.4799759276211, 104.24974867329, 113.44874222949146, 117.55758431553838, 138.5394292734565, 112.40542024211027, 89.98520539328453, 138.94905738532555, 67.56256507127546, 129.79988437239084, 54.45388766378164, 100.35119411349295, 126.29308914020655, 82.52781672682613, 98.52946651540697, 121.66643320862201, 97.78021225053814, 85.35461777728048, 91.95652903243898, 97.30403460375962, 111.5683522671461, 92.73105284199116, 126.47524957032871, 90.28002841770649, 83.86686263419686, 118.52020236849783, 95.5653587458655, 129.2420795559884, 79.56541659496725, 87.4329362399876, -304.5475348830223, 119.45796001213601, 130.93514127284288, -309.2508905529976, 119.37222600542007, 113.06079946830869, 107.72759024798869, 99.54309203475711, 139.60211797803635, 125.64739840105175, 148.25369549915206, 113.23514244402757], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 418, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 62, 500, 500, 77, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [40.64626531070098, 40.4922721683979, 40.46974766626954, 30.326296103186905, 30.102722074836493, 29.498532235622406, 25.750438004732132, 25.916098246350884, 25.95161639805883, 26.783770541350037, 26.895534372578055, 26.314810733000428, 17.734409146010876, 17.500994116067886, 17.035767272114754, 22.674896689752728, 22.526817219952733, 22.676579678120703, 30.86061083773771, 31.33646955775717, 31.181537258128316, 31.75130795439084, 31.870403995116547, 31.9171658133467, 33.99226650844017, 34.046245275686175, 34.2045047810922, 34.958809062838554, 35.83034843951464, 35.915424924343824, 31.0826408714056, 30.95276238769293, 31.37416022270918, 38.150651417672634, 37.63593204319477, 37.78813272714615, 34.256574927518756, 34.031045014659554, 34.132193389038235, 33.41686953107515, 33.950646373132855, 32.685640941063554, 33.33616062998772, 33.1880297139287, 33.463029842823744, 18.113031022250652, 17.936708450317383, 18.06666062027216, 23.349306744833783, 22.478330110510186, 22.588753675421074, 26.722678281366825, 26.370358616113663, 26.728247696737526, 27.0885325881342, 27.151457807670027, 26.563911522428185, 28.64108568429947, 29.483489863574505, 29.460878860205412, 30.307858082155377, 30.63860650981465, 29.577989334861428, 37.800486414693296, 37.51711543276906, 37.5343780182302, 42.16189569731553, 42.26218522464235, 42.016722848018006, 33.238928228616714, 33.22816038876772, 33.40806866786443, -77.10370415945849, -77.1358619083961, -76.89920941491923, 46.808347126158566, 46.7303584391872, 46.74787776234248, 33.663476581374795, 33.97839921216169, 34.252564401055366, 34.56917913289119, 34.21934263904889, 34.16630273809035, 24.25479856133461, 24.513576447963715, 24.95267789857462, 35.95651879130551, 35.88818108352521, 35.52761713663736, 8.382735967636108, 8.576024740934372, 9.059359718114138, 41.702067519227654, 42.052837314705044, 42.269052567581326, 33.28857573370138, 33.56752737114826, 33.674386522422225, 34.13621375709772, 34.42137706466019, 34.43310856260359, 35.05917144815126, 35.24807565721372, 34.91776859263578, 31.213311453660324, 31.06680653368433, 31.12872327988346, 39.50044901482761, 38.99145694822073, 39.59770929728256, 35.05185788869858, 35.28275083191693, 34.72991479933262, 42.49109900991121, 42.770379460106284, 42.581298793355614, 36.06463086729248, 36.16969630060096, 35.89118673404057, 25.30425799265504, 25.06451039761305, 25.20151862129569, 30.49119958778222, 30.700548497339085, 31.050170456369713, 45.78968359654148, 45.83485858313118, 45.25601182629664, 31.962845996022224, 32.66248442232609, 32.85138428211212, 36.79873584210873, 37.57178796827793, 37.401264891028404, 23.612108466525868, 22.76330416401227, 23.71911275510986, 32.90140429635842, 32.87795314689477, 32.76726359625657, 36.99335755904515, 36.97092430790265, 37.09026599427064, 37.15765417429307, 36.66087558368841, 37.097566107908875, 38.26234802324325, 38.16818905249238, 37.96094312518835, 33.859526117642716, 34.390513564770416, 34.220656411101416, 32.89694134394327, 32.1022726992766, 33.42716528351107, 29.182218285898358, 28.75056968132654, 28.968010722349078, 36.53901730726162, 36.55301599825421, 36.528273588667304, 34.13007042308648, 35.13722051804264, 35.254283518840865, 25.89971812814474, 26.245198206976056, 25.952850081026554, 38.11219949057946, 38.14122015393028, 37.9186335975925, 38.484844661550596, 38.41898399591446, 38.258525498211384, 32.76799916724363, 33.42678397397199, 33.285192786405474, 34.74575180311997, 34.92510637020071, 34.57889049996932, 37.6723517080148, 37.909851760913924, 37.86653876056273, 39.463022167483956, 38.593003342549, 39.501558805505425, 45.62706780433655, 46.215302765369415, 46.69705870375037, 37.449365550652146, 37.53832409181632, 37.4177305996418, 29.671124229828507, 30.186566850791365, 30.12751431266466, 46.25496819615364, 46.5719498693943, 46.12213931977749, 22.833418449154124, 22.392182126641273, 22.33696449548006, 43.046087863544614, 43.37755113715926, 43.376245371686906, 18.422267742455006, 17.999063327908516, 18.03255659341812, 33.32324969520171, 33.551855263610676, 33.476089154680565, 42.34837538624802, 41.66941278676191, 42.275300967196614, 27.497140211984515, 27.528870209120214, 27.501806305721402, 32.77775690704584, 32.81346422433853, 32.93824538402259, 40.14641892413297, 41.023487250941486, 40.49652703354755, 32.86009416698167, 32.38454651335874, 32.53557157019773, 28.617356633457035, 28.358719343940407, 28.37854179988304, 30.41037693371375, 30.711550561090306, 30.834601537634924, 32.38477403546372, 32.60402680623034, 32.31523376206556, 36.86675923069318, 37.43065482129653, 37.27093821515639, 30.79792561630407, 31.166202171395213, 30.766925054291875, 41.82212636868158, 42.35726548653716, 42.295857715109975, 30.07597655802965, 30.112265281379223, 30.091786578297615, 28.057007230197385, 28.016112511356667, 27.79374289264281, 39.44457750519116, 39.54007092614968, 39.53555393715699, 31.981740136320383, 31.5069095964233, 32.076709013121814, 43.36831400791803, 43.22574215630689, 42.64802339176336, 26.44009167701006, 26.630987836048007, 26.49433708190918, 29.245466650774077, 29.098225203653172, 29.08924438556035, -98.27647874752681, -98.30451312164466, -107.96654301385085, 39.74896964182456, 39.64219768097003, 40.066792689341426, 43.660173433522374, 43.71443861971298, 43.5605292196075, -108.00657002131145, -100.72514487306277, -100.51917565862338, 39.707099092503384, 39.9935429499795, 39.67158396293719, 37.5877136439085, 37.78408976085484, 37.688996063545346, 35.75925311942895, 35.8561248977979, 36.11221223076184, 33.43940213570991, 33.28267496327558, 32.821014935771615, 46.32291530321041, 46.697512614230305, 46.58169006059566, 41.69905816515286, 42.12619322662552, 41.822147009273365, 49.67916353916128, 49.245755200584725, 49.328776759405926, 37.75577597514105, 37.74062823116158, 37.738738237724945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14286956770556475, "mean_inference_ms": 0.6955396360159414, "mean_action_processing_ms": 0.09591708042380626, "mean_env_wait_ms": 0.7987497923531599, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 485000, "timesteps_this_iter": 0, "agent_timesteps_total": 1455000, "timers": {"sample_time_ms": 10423.469, "sample_throughput": 479.687, "load_time_ms": 0.316, "load_throughput": 15813240.838, "learn_time_ms": 1943.159, "learn_throughput": 2573.129, "update_time_ms": 9.373}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.2939559203393774e-24, "cur_lr": 0.0005000000000000001, "total_loss": 96.5359100341797, "policy_loss": -0.004227801465069269, "vf_loss": 96.62783508300781, "vf_explained_var": 0.016300570964813233, "kl": 0.005501376756022332, "entropy": 8.769630336761475, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 485000, "num_agent_steps_sampled": 1455000, "num_steps_trained": 485000, "num_agent_steps_trained": 1455000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1635, "training_iteration": 97, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-18-45", "timestamp": 1706231925, "time_this_iter_s": 10.219256162643433, "time_total_s": 1040.7861075401306, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140423C040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1040.7861075401306, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 7.6933333333333325, "ram_util_percent": 60.90666666666665}}
{"episode_reward_max": 148.25369549915206, "episode_reward_min": -309.2508905529976, "episode_reward_mean": 91.30076938082283, "episode_len_mean": 490.57, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -108.00657002131145}, "policy_reward_max": {"shared_policy": 49.67916353916128}, "policy_reward_mean": {"shared_policy": 30.433589793607606}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.40956348180771, 113.57471618801355, 102.41981333121655, 100.05315684527156, 99.98722018674016, 54.116400092840195, 68.41639053076504, 79.82128459421801, 80.80390191823241, 87.58545440807939, 90.52445392683146, 112.85197986569256, 126.44080376997589, 99.87515728524886, -231.13877548277384, 140.2865833276881, 101.89444019459185, 102.95482451003043, 73.72105290787295, 107.37231701146808, 26.018120426684618, 126.02395740151402, 100.53048962727186, 102.9906993843615, 105.22501569800076, 93.40884126722811, 118.0896152603309, 105.06452351994812, 127.84277726337311, 108.12551390193401, 75.57028701156378, 92.24191854149102, 136.88055400596943, 97.47671470046043, 111.77178870141506, 70.094525385648, 98.54662103950976, 111.05454786121844, 110.91609586589036, 114.39148020092398, 102.47069609351455, 98.42637932673094, 86.90079868957397, 109.62030689418313, 104.52157445996998, 78.09776641614735, 114.17205324210224, 115.16235415567644, 99.4799759276211, 104.24974867329, 113.44874222949146, 117.55758431553838, 138.5394292734565, 112.40542024211027, 89.98520539328453, 138.94905738532555, 67.56256507127546, 129.79988437239084, 54.45388766378164, 100.35119411349295, 126.29308914020655, 82.52781672682613, 98.52946651540697, 121.66643320862201, 97.78021225053814, 85.35461777728048, 91.95652903243898, 97.30403460375962, 111.5683522671461, 92.73105284199116, 126.47524957032871, 90.28002841770649, 83.86686263419686, 118.52020236849783, 95.5653587458655, 129.2420795559884, 79.56541659496725, 87.4329362399876, -304.5475348830223, 119.45796001213601, 130.93514127284288, -309.2508905529976, 119.37222600542007, 113.06079946830869, 107.72759024798869, 99.54309203475711, 139.60211797803635, 125.64739840105175, 148.25369549915206, 113.23514244402757, 80.86607683077455, 78.649285197258, 86.4208042686805, 100.64306571334598, 100.34823737479745, 111.22384246066211, 107.11687130806966, 119.20149435102938, 121.3669506944716, 91.15438356623052], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 418, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 62, 500, 500, 77, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [31.0826408714056, 30.95276238769293, 31.37416022270918, 38.150651417672634, 37.63593204319477, 37.78813272714615, 34.256574927518756, 34.031045014659554, 34.132193389038235, 33.41686953107515, 33.950646373132855, 32.685640941063554, 33.33616062998772, 33.1880297139287, 33.463029842823744, 18.113031022250652, 17.936708450317383, 18.06666062027216, 23.349306744833783, 22.478330110510186, 22.588753675421074, 26.722678281366825, 26.370358616113663, 26.728247696737526, 27.0885325881342, 27.151457807670027, 26.563911522428185, 28.64108568429947, 29.483489863574505, 29.460878860205412, 30.307858082155377, 30.63860650981465, 29.577989334861428, 37.800486414693296, 37.51711543276906, 37.5343780182302, 42.16189569731553, 42.26218522464235, 42.016722848018006, 33.238928228616714, 33.22816038876772, 33.40806866786443, -77.10370415945849, -77.1358619083961, -76.89920941491923, 46.808347126158566, 46.7303584391872, 46.74787776234248, 33.663476581374795, 33.97839921216169, 34.252564401055366, 34.56917913289119, 34.21934263904889, 34.16630273809035, 24.25479856133461, 24.513576447963715, 24.95267789857462, 35.95651879130551, 35.88818108352521, 35.52761713663736, 8.382735967636108, 8.576024740934372, 9.059359718114138, 41.702067519227654, 42.052837314705044, 42.269052567581326, 33.28857573370138, 33.56752737114826, 33.674386522422225, 34.13621375709772, 34.42137706466019, 34.43310856260359, 35.05917144815126, 35.24807565721372, 34.91776859263578, 31.213311453660324, 31.06680653368433, 31.12872327988346, 39.50044901482761, 38.99145694822073, 39.59770929728256, 35.05185788869858, 35.28275083191693, 34.72991479933262, 42.49109900991121, 42.770379460106284, 42.581298793355614, 36.06463086729248, 36.16969630060096, 35.89118673404057, 25.30425799265504, 25.06451039761305, 25.20151862129569, 30.49119958778222, 30.700548497339085, 31.050170456369713, 45.78968359654148, 45.83485858313118, 45.25601182629664, 31.962845996022224, 32.66248442232609, 32.85138428211212, 36.79873584210873, 37.57178796827793, 37.401264891028404, 23.612108466525868, 22.76330416401227, 23.71911275510986, 32.90140429635842, 32.87795314689477, 32.76726359625657, 36.99335755904515, 36.97092430790265, 37.09026599427064, 37.15765417429307, 36.66087558368841, 37.097566107908875, 38.26234802324325, 38.16818905249238, 37.96094312518835, 33.859526117642716, 34.390513564770416, 34.220656411101416, 32.89694134394327, 32.1022726992766, 33.42716528351107, 29.182218285898358, 28.75056968132654, 28.968010722349078, 36.53901730726162, 36.55301599825421, 36.528273588667304, 34.13007042308648, 35.13722051804264, 35.254283518840865, 25.89971812814474, 26.245198206976056, 25.952850081026554, 38.11219949057946, 38.14122015393028, 37.9186335975925, 38.484844661550596, 38.41898399591446, 38.258525498211384, 32.76799916724363, 33.42678397397199, 33.285192786405474, 34.74575180311997, 34.92510637020071, 34.57889049996932, 37.6723517080148, 37.909851760913924, 37.86653876056273, 39.463022167483956, 38.593003342549, 39.501558805505425, 45.62706780433655, 46.215302765369415, 46.69705870375037, 37.449365550652146, 37.53832409181632, 37.4177305996418, 29.671124229828507, 30.186566850791365, 30.12751431266466, 46.25496819615364, 46.5719498693943, 46.12213931977749, 22.833418449154124, 22.392182126641273, 22.33696449548006, 43.046087863544614, 43.37755113715926, 43.376245371686906, 18.422267742455006, 17.999063327908516, 18.03255659341812, 33.32324969520171, 33.551855263610676, 33.476089154680565, 42.34837538624802, 41.66941278676191, 42.275300967196614, 27.497140211984515, 27.528870209120214, 27.501806305721402, 32.77775690704584, 32.81346422433853, 32.93824538402259, 40.14641892413297, 41.023487250941486, 40.49652703354755, 32.86009416698167, 32.38454651335874, 32.53557157019773, 28.617356633457035, 28.358719343940407, 28.37854179988304, 30.41037693371375, 30.711550561090306, 30.834601537634924, 32.38477403546372, 32.60402680623034, 32.31523376206556, 36.86675923069318, 37.43065482129653, 37.27093821515639, 30.79792561630407, 31.166202171395213, 30.766925054291875, 41.82212636868158, 42.35726548653716, 42.295857715109975, 30.07597655802965, 30.112265281379223, 30.091786578297615, 28.057007230197385, 28.016112511356667, 27.79374289264281, 39.44457750519116, 39.54007092614968, 39.53555393715699, 31.981740136320383, 31.5069095964233, 32.076709013121814, 43.36831400791803, 43.22574215630689, 42.64802339176336, 26.44009167701006, 26.630987836048007, 26.49433708190918, 29.245466650774077, 29.098225203653172, 29.08924438556035, -98.27647874752681, -98.30451312164466, -107.96654301385085, 39.74896964182456, 39.64219768097003, 40.066792689341426, 43.660173433522374, 43.71443861971298, 43.5605292196075, -108.00657002131145, -100.72514487306277, -100.51917565862338, 39.707099092503384, 39.9935429499795, 39.67158396293719, 37.5877136439085, 37.78408976085484, 37.688996063545346, 35.75925311942895, 35.8561248977979, 36.11221223076184, 33.43940213570991, 33.28267496327558, 32.821014935771615, 46.32291530321041, 46.697512614230305, 46.58169006059566, 41.69905816515286, 42.12619322662552, 41.822147009273365, 49.67916353916128, 49.245755200584725, 49.328776759405926, 37.75577597514105, 37.74062823116158, 37.738738237724945, 26.937360011041164, 27.041930455714464, 26.886786364018917, 25.996324613690376, 26.245791919529438, 26.40716866403818, 28.88291941241671, 28.689755142976836, 28.84812971328695, 34.02844145024815, 33.84204491103688, 32.772579352060944, 33.53130034295221, 33.41093098868926, 33.40600604315598, 37.028435846169785, 37.6560503480335, 36.539356266458825, 35.792513624609754, 35.646670504783586, 35.67768717867632, 39.63391984750827, 39.818094958861664, 39.74947954465945, 40.461852218955755, 40.53497190028429, 40.37012657523155, 30.519981668641165, 30.265684021015957, 30.3687178765734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14277180359591524, "mean_inference_ms": 0.6953935493015809, "mean_action_processing_ms": 0.09589459529666566, "mean_env_wait_ms": 0.7984286884425401, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 490000, "timesteps_this_iter": 0, "agent_timesteps_total": 1470000, "timers": {"sample_time_ms": 10414.997, "sample_throughput": 480.077, "load_time_ms": 0.417, "load_throughput": 11987150.614, "learn_time_ms": 1941.172, "learn_throughput": 2575.764, "update_time_ms": 9.566}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.2939559203393774e-24, "cur_lr": 0.0005000000000000001, "total_loss": 7.155533933639527, "policy_loss": -0.0017136940339231189, "vf_loss": 7.245795726776123, "vf_explained_var": -0.012945950031280518, "kl": 0.002582679994542865, "entropy": 8.854766845703125, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 490000, "num_agent_steps_sampled": 1470000, "num_steps_trained": 490000, "num_agent_steps_trained": 1470000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1645, "training_iteration": 98, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-18-55", "timestamp": 1706231935, "time_this_iter_s": 10.156677484512329, "time_total_s": 1050.942785024643, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214025179D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1050.942785024643, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 7.128571428571427, "ram_util_percent": 60.771428571428565}}
{"episode_reward_max": 148.25369549915206, "episode_reward_min": -309.2508905529976, "episode_reward_mean": 93.2943240282902, "episode_len_mean": 490.57, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -108.00657002131145}, "policy_reward_max": {"shared_policy": 49.67916353916128}, "policy_reward_mean": {"shared_policy": 31.098108009430064}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.52445392683146, 112.85197986569256, 126.44080376997589, 99.87515728524886, -231.13877548277384, 140.2865833276881, 101.89444019459185, 102.95482451003043, 73.72105290787295, 107.37231701146808, 26.018120426684618, 126.02395740151402, 100.53048962727186, 102.9906993843615, 105.22501569800076, 93.40884126722811, 118.0896152603309, 105.06452351994812, 127.84277726337311, 108.12551390193401, 75.57028701156378, 92.24191854149102, 136.88055400596943, 97.47671470046043, 111.77178870141506, 70.094525385648, 98.54662103950976, 111.05454786121844, 110.91609586589036, 114.39148020092398, 102.47069609351455, 98.42637932673094, 86.90079868957397, 109.62030689418313, 104.52157445996998, 78.09776641614735, 114.17205324210224, 115.16235415567644, 99.4799759276211, 104.24974867329, 113.44874222949146, 117.55758431553838, 138.5394292734565, 112.40542024211027, 89.98520539328453, 138.94905738532555, 67.56256507127546, 129.79988437239084, 54.45388766378164, 100.35119411349295, 126.29308914020655, 82.52781672682613, 98.52946651540697, 121.66643320862201, 97.78021225053814, 85.35461777728048, 91.95652903243898, 97.30403460375962, 111.5683522671461, 92.73105284199116, 126.47524957032871, 90.28002841770649, 83.86686263419686, 118.52020236849783, 95.5653587458655, 129.2420795559884, 79.56541659496725, 87.4329362399876, -304.5475348830223, 119.45796001213601, 130.93514127284288, -309.2508905529976, 119.37222600542007, 113.06079946830869, 107.72759024798869, 99.54309203475711, 139.60211797803635, 125.64739840105175, 148.25369549915206, 113.23514244402757, 80.86607683077455, 78.649285197258, 86.4208042686805, 100.64306571334598, 100.34823737479745, 111.22384246066211, 107.11687130806966, 119.20149435102938, 121.3669506944716, 91.15438356623052, 92.88497583568096, 131.0428677070886, 54.74524153023957, 116.57935197651383, 115.83922268822788, 101.1746993511915, 123.03371224179861, 123.38845949247477, 118.98567909537812, 101.8691564053297], "episode_lengths": [500, 500, 500, 500, 418, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 62, 500, 500, 77, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [30.307858082155377, 30.63860650981465, 29.577989334861428, 37.800486414693296, 37.51711543276906, 37.5343780182302, 42.16189569731553, 42.26218522464235, 42.016722848018006, 33.238928228616714, 33.22816038876772, 33.40806866786443, -77.10370415945849, -77.1358619083961, -76.89920941491923, 46.808347126158566, 46.7303584391872, 46.74787776234248, 33.663476581374795, 33.97839921216169, 34.252564401055366, 34.56917913289119, 34.21934263904889, 34.16630273809035, 24.25479856133461, 24.513576447963715, 24.95267789857462, 35.95651879130551, 35.88818108352521, 35.52761713663736, 8.382735967636108, 8.576024740934372, 9.059359718114138, 41.702067519227654, 42.052837314705044, 42.269052567581326, 33.28857573370138, 33.56752737114826, 33.674386522422225, 34.13621375709772, 34.42137706466019, 34.43310856260359, 35.05917144815126, 35.24807565721372, 34.91776859263578, 31.213311453660324, 31.06680653368433, 31.12872327988346, 39.50044901482761, 38.99145694822073, 39.59770929728256, 35.05185788869858, 35.28275083191693, 34.72991479933262, 42.49109900991121, 42.770379460106284, 42.581298793355614, 36.06463086729248, 36.16969630060096, 35.89118673404057, 25.30425799265504, 25.06451039761305, 25.20151862129569, 30.49119958778222, 30.700548497339085, 31.050170456369713, 45.78968359654148, 45.83485858313118, 45.25601182629664, 31.962845996022224, 32.66248442232609, 32.85138428211212, 36.79873584210873, 37.57178796827793, 37.401264891028404, 23.612108466525868, 22.76330416401227, 23.71911275510986, 32.90140429635842, 32.87795314689477, 32.76726359625657, 36.99335755904515, 36.97092430790265, 37.09026599427064, 37.15765417429307, 36.66087558368841, 37.097566107908875, 38.26234802324325, 38.16818905249238, 37.96094312518835, 33.859526117642716, 34.390513564770416, 34.220656411101416, 32.89694134394327, 32.1022726992766, 33.42716528351107, 29.182218285898358, 28.75056968132654, 28.968010722349078, 36.53901730726162, 36.55301599825421, 36.528273588667304, 34.13007042308648, 35.13722051804264, 35.254283518840865, 25.89971812814474, 26.245198206976056, 25.952850081026554, 38.11219949057946, 38.14122015393028, 37.9186335975925, 38.484844661550596, 38.41898399591446, 38.258525498211384, 32.76799916724363, 33.42678397397199, 33.285192786405474, 34.74575180311997, 34.92510637020071, 34.57889049996932, 37.6723517080148, 37.909851760913924, 37.86653876056273, 39.463022167483956, 38.593003342549, 39.501558805505425, 45.62706780433655, 46.215302765369415, 46.69705870375037, 37.449365550652146, 37.53832409181632, 37.4177305996418, 29.671124229828507, 30.186566850791365, 30.12751431266466, 46.25496819615364, 46.5719498693943, 46.12213931977749, 22.833418449154124, 22.392182126641273, 22.33696449548006, 43.046087863544614, 43.37755113715926, 43.376245371686906, 18.422267742455006, 17.999063327908516, 18.03255659341812, 33.32324969520171, 33.551855263610676, 33.476089154680565, 42.34837538624802, 41.66941278676191, 42.275300967196614, 27.497140211984515, 27.528870209120214, 27.501806305721402, 32.77775690704584, 32.81346422433853, 32.93824538402259, 40.14641892413297, 41.023487250941486, 40.49652703354755, 32.86009416698167, 32.38454651335874, 32.53557157019773, 28.617356633457035, 28.358719343940407, 28.37854179988304, 30.41037693371375, 30.711550561090306, 30.834601537634924, 32.38477403546372, 32.60402680623034, 32.31523376206556, 36.86675923069318, 37.43065482129653, 37.27093821515639, 30.79792561630407, 31.166202171395213, 30.766925054291875, 41.82212636868158, 42.35726548653716, 42.295857715109975, 30.07597655802965, 30.112265281379223, 30.091786578297615, 28.057007230197385, 28.016112511356667, 27.79374289264281, 39.44457750519116, 39.54007092614968, 39.53555393715699, 31.981740136320383, 31.5069095964233, 32.076709013121814, 43.36831400791803, 43.22574215630689, 42.64802339176336, 26.44009167701006, 26.630987836048007, 26.49433708190918, 29.245466650774077, 29.098225203653172, 29.08924438556035, -98.27647874752681, -98.30451312164466, -107.96654301385085, 39.74896964182456, 39.64219768097003, 40.066792689341426, 43.660173433522374, 43.71443861971298, 43.5605292196075, -108.00657002131145, -100.72514487306277, -100.51917565862338, 39.707099092503384, 39.9935429499795, 39.67158396293719, 37.5877136439085, 37.78408976085484, 37.688996063545346, 35.75925311942895, 35.8561248977979, 36.11221223076184, 33.43940213570991, 33.28267496327558, 32.821014935771615, 46.32291530321041, 46.697512614230305, 46.58169006059566, 41.69905816515286, 42.12619322662552, 41.822147009273365, 49.67916353916128, 49.245755200584725, 49.328776759405926, 37.75577597514105, 37.74062823116158, 37.738738237724945, 26.937360011041164, 27.041930455714464, 26.886786364018917, 25.996324613690376, 26.245791919529438, 26.40716866403818, 28.88291941241671, 28.689755142976836, 28.84812971328695, 34.02844145024815, 33.84204491103688, 32.772579352060944, 33.53130034295221, 33.41093098868926, 33.40600604315598, 37.028435846169785, 37.6560503480335, 36.539356266458825, 35.792513624609754, 35.646670504783586, 35.67768717867632, 39.63391984750827, 39.818094958861664, 39.74947954465945, 40.461852218955755, 40.53497190028429, 40.37012657523155, 30.519981668641165, 30.265684021015957, 30.3687178765734, 31.00455991178751, 30.836901769042015, 31.043514154851437, 43.81597428396344, 43.89004558138549, 43.336847841739655, 18.40240717430909, 18.115521897872284, 18.227312458058194, 38.80883154521385, 38.858719329039246, 38.91180110226074, 38.91624252622326, 38.80437800039847, 38.11860216160615, 33.74251382549603, 33.6472449277838, 33.78494059791167, 40.96660232047239, 40.77767027417818, 41.28943964714804, 41.081112193564564, 41.23735673601428, 41.069990562895924, 39.286776820818574, 39.99965252021016, 39.69924975434938, 34.03245763480663, 33.877619594335556, 33.959079176187515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14267425926562205, "mean_inference_ms": 0.6952321962127592, "mean_action_processing_ms": 0.09586359465072303, "mean_env_wait_ms": 0.798096708101622, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 495000, "timesteps_this_iter": 0, "agent_timesteps_total": 1485000, "timers": {"sample_time_ms": 10389.364, "sample_throughput": 481.261, "load_time_ms": 0.417, "load_throughput": 11987150.614, "learn_time_ms": 1932.019, "learn_throughput": 2587.966, "update_time_ms": 9.564}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.6469779601696887e-24, "cur_lr": 0.0005000000000000001, "total_loss": 6.8719157695770265, "policy_loss": -0.0015985040856230982, "vf_loss": 6.963287734985352, "vf_explained_var": -0.07173928022384643, "kl": 0.0025402729981810123, "entropy": 8.977358627319337, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 495000, "num_agent_steps_sampled": 1485000, "num_steps_trained": 495000, "num_agent_steps_trained": 1485000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1655, "training_iteration": 99, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-19-05", "timestamp": 1706231945, "time_this_iter_s": 10.15171766281128, "time_total_s": 1061.0945026874542, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D1B040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1061.0945026874542, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 7.707142857142857, "ram_util_percent": 60.72142857142858}}
{"episode_reward_max": 148.25369549915206, "episode_reward_min": -309.2508905529976, "episode_reward_mean": 96.73778809233852, "episode_len_mean": 491.39, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -108.00657002131145}, "policy_reward_max": {"shared_policy": 49.67916353916128}, "policy_reward_mean": {"shared_policy": 32.24592936411283}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.018120426684618, 126.02395740151402, 100.53048962727186, 102.9906993843615, 105.22501569800076, 93.40884126722811, 118.0896152603309, 105.06452351994812, 127.84277726337311, 108.12551390193401, 75.57028701156378, 92.24191854149102, 136.88055400596943, 97.47671470046043, 111.77178870141506, 70.094525385648, 98.54662103950976, 111.05454786121844, 110.91609586589036, 114.39148020092398, 102.47069609351455, 98.42637932673094, 86.90079868957397, 109.62030689418313, 104.52157445996998, 78.09776641614735, 114.17205324210224, 115.16235415567644, 99.4799759276211, 104.24974867329, 113.44874222949146, 117.55758431553838, 138.5394292734565, 112.40542024211027, 89.98520539328453, 138.94905738532555, 67.56256507127546, 129.79988437239084, 54.45388766378164, 100.35119411349295, 126.29308914020655, 82.52781672682613, 98.52946651540697, 121.66643320862201, 97.78021225053814, 85.35461777728048, 91.95652903243898, 97.30403460375962, 111.5683522671461, 92.73105284199116, 126.47524957032871, 90.28002841770649, 83.86686263419686, 118.52020236849783, 95.5653587458655, 129.2420795559884, 79.56541659496725, 87.4329362399876, -304.5475348830223, 119.45796001213601, 130.93514127284288, -309.2508905529976, 119.37222600542007, 113.06079946830869, 107.72759024798869, 99.54309203475711, 139.60211797803635, 125.64739840105175, 148.25369549915206, 113.23514244402757, 80.86607683077455, 78.649285197258, 86.4208042686805, 100.64306571334598, 100.34823737479745, 111.22384246066211, 107.11687130806966, 119.20149435102938, 121.3669506944716, 91.15438356623052, 92.88497583568096, 131.0428677070886, 54.74524153023957, 116.57935197651383, 115.83922268822788, 101.1746993511915, 123.03371224179861, 123.38845949247477, 118.98567909537812, 101.8691564053297, 123.25723772868514, 111.87923892063553, 95.40772074181587, 129.80343559756875, 106.78831003606317, 125.01603668634198, 74.81674330402164, 86.65465892106295, 104.10183823481199, 111.40402355045077], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 62, 500, 500, 77, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [8.382735967636108, 8.576024740934372, 9.059359718114138, 41.702067519227654, 42.052837314705044, 42.269052567581326, 33.28857573370138, 33.56752737114826, 33.674386522422225, 34.13621375709772, 34.42137706466019, 34.43310856260359, 35.05917144815126, 35.24807565721372, 34.91776859263578, 31.213311453660324, 31.06680653368433, 31.12872327988346, 39.50044901482761, 38.99145694822073, 39.59770929728256, 35.05185788869858, 35.28275083191693, 34.72991479933262, 42.49109900991121, 42.770379460106284, 42.581298793355614, 36.06463086729248, 36.16969630060096, 35.89118673404057, 25.30425799265504, 25.06451039761305, 25.20151862129569, 30.49119958778222, 30.700548497339085, 31.050170456369713, 45.78968359654148, 45.83485858313118, 45.25601182629664, 31.962845996022224, 32.66248442232609, 32.85138428211212, 36.79873584210873, 37.57178796827793, 37.401264891028404, 23.612108466525868, 22.76330416401227, 23.71911275510986, 32.90140429635842, 32.87795314689477, 32.76726359625657, 36.99335755904515, 36.97092430790265, 37.09026599427064, 37.15765417429307, 36.66087558368841, 37.097566107908875, 38.26234802324325, 38.16818905249238, 37.96094312518835, 33.859526117642716, 34.390513564770416, 34.220656411101416, 32.89694134394327, 32.1022726992766, 33.42716528351107, 29.182218285898358, 28.75056968132654, 28.968010722349078, 36.53901730726162, 36.55301599825421, 36.528273588667304, 34.13007042308648, 35.13722051804264, 35.254283518840865, 25.89971812814474, 26.245198206976056, 25.952850081026554, 38.11219949057946, 38.14122015393028, 37.9186335975925, 38.484844661550596, 38.41898399591446, 38.258525498211384, 32.76799916724363, 33.42678397397199, 33.285192786405474, 34.74575180311997, 34.92510637020071, 34.57889049996932, 37.6723517080148, 37.909851760913924, 37.86653876056273, 39.463022167483956, 38.593003342549, 39.501558805505425, 45.62706780433655, 46.215302765369415, 46.69705870375037, 37.449365550652146, 37.53832409181632, 37.4177305996418, 29.671124229828507, 30.186566850791365, 30.12751431266466, 46.25496819615364, 46.5719498693943, 46.12213931977749, 22.833418449154124, 22.392182126641273, 22.33696449548006, 43.046087863544614, 43.37755113715926, 43.376245371686906, 18.422267742455006, 17.999063327908516, 18.03255659341812, 33.32324969520171, 33.551855263610676, 33.476089154680565, 42.34837538624802, 41.66941278676191, 42.275300967196614, 27.497140211984515, 27.528870209120214, 27.501806305721402, 32.77775690704584, 32.81346422433853, 32.93824538402259, 40.14641892413297, 41.023487250941486, 40.49652703354755, 32.86009416698167, 32.38454651335874, 32.53557157019773, 28.617356633457035, 28.358719343940407, 28.37854179988304, 30.41037693371375, 30.711550561090306, 30.834601537634924, 32.38477403546372, 32.60402680623034, 32.31523376206556, 36.86675923069318, 37.43065482129653, 37.27093821515639, 30.79792561630407, 31.166202171395213, 30.766925054291875, 41.82212636868158, 42.35726548653716, 42.295857715109975, 30.07597655802965, 30.112265281379223, 30.091786578297615, 28.057007230197385, 28.016112511356667, 27.79374289264281, 39.44457750519116, 39.54007092614968, 39.53555393715699, 31.981740136320383, 31.5069095964233, 32.076709013121814, 43.36831400791803, 43.22574215630689, 42.64802339176336, 26.44009167701006, 26.630987836048007, 26.49433708190918, 29.245466650774077, 29.098225203653172, 29.08924438556035, -98.27647874752681, -98.30451312164466, -107.96654301385085, 39.74896964182456, 39.64219768097003, 40.066792689341426, 43.660173433522374, 43.71443861971298, 43.5605292196075, -108.00657002131145, -100.72514487306277, -100.51917565862338, 39.707099092503384, 39.9935429499795, 39.67158396293719, 37.5877136439085, 37.78408976085484, 37.688996063545346, 35.75925311942895, 35.8561248977979, 36.11221223076184, 33.43940213570991, 33.28267496327558, 32.821014935771615, 46.32291530321041, 46.697512614230305, 46.58169006059566, 41.69905816515286, 42.12619322662552, 41.822147009273365, 49.67916353916128, 49.245755200584725, 49.328776759405926, 37.75577597514105, 37.74062823116158, 37.738738237724945, 26.937360011041164, 27.041930455714464, 26.886786364018917, 25.996324613690376, 26.245791919529438, 26.40716866403818, 28.88291941241671, 28.689755142976836, 28.84812971328695, 34.02844145024815, 33.84204491103688, 32.772579352060944, 33.53130034295221, 33.41093098868926, 33.40600604315598, 37.028435846169785, 37.6560503480335, 36.539356266458825, 35.792513624609754, 35.646670504783586, 35.67768717867632, 39.63391984750827, 39.818094958861664, 39.74947954465945, 40.461852218955755, 40.53497190028429, 40.37012657523155, 30.519981668641165, 30.265684021015957, 30.3687178765734, 31.00455991178751, 30.836901769042015, 31.043514154851437, 43.81597428396344, 43.89004558138549, 43.336847841739655, 18.40240717430909, 18.115521897872284, 18.227312458058194, 38.80883154521385, 38.858719329039246, 38.91180110226074, 38.91624252622326, 38.80437800039847, 38.11860216160615, 33.74251382549603, 33.6472449277838, 33.78494059791167, 40.96660232047239, 40.77767027417818, 41.28943964714804, 41.081112193564564, 41.23735673601428, 41.069990562895924, 39.286776820818574, 39.99965252021016, 39.69924975434938, 34.03245763480663, 33.877619594335556, 33.959079176187515, 41.10728280618787, 41.04444485157728, 41.10551007091999, 37.42297125731905, 37.48994582491771, 36.96632183839877, 31.411183267831802, 32.015779950656, 31.980757523328066, 43.1352604428927, 43.512155196319014, 43.15601995835701, 35.67318434516588, 35.76435456673303, 35.350771124164254, 41.2329485565424, 41.884575666161254, 41.898512463638326, 25.372143993464604, 25.20706944664319, 24.23752986391385, 29.01987986266613, 29.18219668418169, 28.452582374215126, 34.302019665638596, 34.869436773161084, 34.93038179601231, 36.87315847973028, 37.23436739544073, 37.29649767527977]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14257891991811908, "mean_inference_ms": 0.6950450329607163, "mean_action_processing_ms": 0.09582893439611334, "mean_env_wait_ms": 0.7977286001766578, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 500000, "timesteps_this_iter": 0, "agent_timesteps_total": 1500000, "timers": {"sample_time_ms": 10336.344, "sample_throughput": 483.73, "load_time_ms": 0.317, "load_throughput": 15768060.15, "learn_time_ms": 1925.4, "learn_throughput": 2596.863, "update_time_ms": 9.564}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3234889800848444e-24, "cur_lr": 0.0005000000000000001, "total_loss": 4.90917329788208, "policy_loss": -0.0016408136625478242, "vf_loss": 5.0013124465942385, "vf_explained_var": -0.034193122386932374, "kl": 0.0030646708095684915, "entropy": 9.04983959197998, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 500000, "num_agent_steps_sampled": 1500000, "num_steps_trained": 500000, "num_agent_steps_trained": 1500000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 138.4599137641489, "episode_reward_min": -253.50663728266954, "episode_reward_mean": 64.35332665812456, "episode_len_mean": 477.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -84.64544302225113}, "policy_reward_max": {"shared_policy": 46.30891752615571}, "policy_reward_mean": {"shared_policy": 21.451108886041524}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-253.50663728266954, 82.77470646891742, 88.53601301088926, 109.50181349739432, 94.04296900518239, 138.4599137641489, 98.74835270456967, 103.88348521164151, 94.99804847314952, 86.0946017280221], "episode_lengths": [275, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-84.37432123720646, -84.64544302225113, -84.48687302321196, 27.698525091012314, 27.92546767586221, 27.150713702042893, 29.242375294367463, 29.74377807850638, 29.54985963801542, 36.55777848511934, 36.218838050961494, 36.725196961313486, 31.195668250322342, 31.486546842381358, 31.360753912478685, 46.30891752615571, 46.07637704536319, 46.07461919263005, 32.82658402497569, 32.99862900438407, 32.92313967520991, 34.51874118422468, 34.63367157739897, 34.73107245001786, 31.63575803985198, 31.69821113472183, 31.664079298575714, 29.06231153011322, 28.884971655905247, 28.14731854200363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13041664555107907, "mean_inference_ms": 0.7222914266508261, "mean_action_processing_ms": 0.1003612716927661, "mean_env_wait_ms": 0.8171916056771911, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 1665, "training_iteration": 100, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-19-23", "timestamp": 1706231963, "time_this_iter_s": 18.369892835617065, "time_total_s": 1079.4643955230713, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214024E81F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1079.4643955230713, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 5.519230769230769, "ram_util_percent": 60.91153846153846}}
{"episode_reward_max": 148.25369549915206, "episode_reward_min": -309.2508905529976, "episode_reward_mean": 95.84856507768127, "episode_len_mean": 491.39, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -108.00657002131145}, "policy_reward_max": {"shared_policy": 49.67916353916128}, "policy_reward_mean": {"shared_policy": 31.949521692560417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.57028701156378, 92.24191854149102, 136.88055400596943, 97.47671470046043, 111.77178870141506, 70.094525385648, 98.54662103950976, 111.05454786121844, 110.91609586589036, 114.39148020092398, 102.47069609351455, 98.42637932673094, 86.90079868957397, 109.62030689418313, 104.52157445996998, 78.09776641614735, 114.17205324210224, 115.16235415567644, 99.4799759276211, 104.24974867329, 113.44874222949146, 117.55758431553838, 138.5394292734565, 112.40542024211027, 89.98520539328453, 138.94905738532555, 67.56256507127546, 129.79988437239084, 54.45388766378164, 100.35119411349295, 126.29308914020655, 82.52781672682613, 98.52946651540697, 121.66643320862201, 97.78021225053814, 85.35461777728048, 91.95652903243898, 97.30403460375962, 111.5683522671461, 92.73105284199116, 126.47524957032871, 90.28002841770649, 83.86686263419686, 118.52020236849783, 95.5653587458655, 129.2420795559884, 79.56541659496725, 87.4329362399876, -304.5475348830223, 119.45796001213601, 130.93514127284288, -309.2508905529976, 119.37222600542007, 113.06079946830869, 107.72759024798869, 99.54309203475711, 139.60211797803635, 125.64739840105175, 148.25369549915206, 113.23514244402757, 80.86607683077455, 78.649285197258, 86.4208042686805, 100.64306571334598, 100.34823737479745, 111.22384246066211, 107.11687130806966, 119.20149435102938, 121.3669506944716, 91.15438356623052, 92.88497583568096, 131.0428677070886, 54.74524153023957, 116.57935197651383, 115.83922268822788, 101.1746993511915, 123.03371224179861, 123.38845949247477, 118.98567909537812, 101.8691564053297, 123.25723772868514, 111.87923892063553, 95.40772074181587, 129.80343559756875, 106.78831003606317, 125.01603668634198, 74.81674330402164, 86.65465892106295, 104.10183823481199, 111.40402355045077, 81.72214992716908, 85.86638982780275, 31.82348692789671, 97.66370653361079, 92.94675292074679, 86.96767242532222, 122.53652790933846, 106.1820021001622, 100.94116247538477, 117.74740123748776], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 62, 500, 500, 77, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [25.30425799265504, 25.06451039761305, 25.20151862129569, 30.49119958778222, 30.700548497339085, 31.050170456369713, 45.78968359654148, 45.83485858313118, 45.25601182629664, 31.962845996022224, 32.66248442232609, 32.85138428211212, 36.79873584210873, 37.57178796827793, 37.401264891028404, 23.612108466525868, 22.76330416401227, 23.71911275510986, 32.90140429635842, 32.87795314689477, 32.76726359625657, 36.99335755904515, 36.97092430790265, 37.09026599427064, 37.15765417429307, 36.66087558368841, 37.097566107908875, 38.26234802324325, 38.16818905249238, 37.96094312518835, 33.859526117642716, 34.390513564770416, 34.220656411101416, 32.89694134394327, 32.1022726992766, 33.42716528351107, 29.182218285898358, 28.75056968132654, 28.968010722349078, 36.53901730726162, 36.55301599825421, 36.528273588667304, 34.13007042308648, 35.13722051804264, 35.254283518840865, 25.89971812814474, 26.245198206976056, 25.952850081026554, 38.11219949057946, 38.14122015393028, 37.9186335975925, 38.484844661550596, 38.41898399591446, 38.258525498211384, 32.76799916724363, 33.42678397397199, 33.285192786405474, 34.74575180311997, 34.92510637020071, 34.57889049996932, 37.6723517080148, 37.909851760913924, 37.86653876056273, 39.463022167483956, 38.593003342549, 39.501558805505425, 45.62706780433655, 46.215302765369415, 46.69705870375037, 37.449365550652146, 37.53832409181632, 37.4177305996418, 29.671124229828507, 30.186566850791365, 30.12751431266466, 46.25496819615364, 46.5719498693943, 46.12213931977749, 22.833418449154124, 22.392182126641273, 22.33696449548006, 43.046087863544614, 43.37755113715926, 43.376245371686906, 18.422267742455006, 17.999063327908516, 18.03255659341812, 33.32324969520171, 33.551855263610676, 33.476089154680565, 42.34837538624802, 41.66941278676191, 42.275300967196614, 27.497140211984515, 27.528870209120214, 27.501806305721402, 32.77775690704584, 32.81346422433853, 32.93824538402259, 40.14641892413297, 41.023487250941486, 40.49652703354755, 32.86009416698167, 32.38454651335874, 32.53557157019773, 28.617356633457035, 28.358719343940407, 28.37854179988304, 30.41037693371375, 30.711550561090306, 30.834601537634924, 32.38477403546372, 32.60402680623034, 32.31523376206556, 36.86675923069318, 37.43065482129653, 37.27093821515639, 30.79792561630407, 31.166202171395213, 30.766925054291875, 41.82212636868158, 42.35726548653716, 42.295857715109975, 30.07597655802965, 30.112265281379223, 30.091786578297615, 28.057007230197385, 28.016112511356667, 27.79374289264281, 39.44457750519116, 39.54007092614968, 39.53555393715699, 31.981740136320383, 31.5069095964233, 32.076709013121814, 43.36831400791803, 43.22574215630689, 42.64802339176336, 26.44009167701006, 26.630987836048007, 26.49433708190918, 29.245466650774077, 29.098225203653172, 29.08924438556035, -98.27647874752681, -98.30451312164466, -107.96654301385085, 39.74896964182456, 39.64219768097003, 40.066792689341426, 43.660173433522374, 43.71443861971298, 43.5605292196075, -108.00657002131145, -100.72514487306277, -100.51917565862338, 39.707099092503384, 39.9935429499795, 39.67158396293719, 37.5877136439085, 37.78408976085484, 37.688996063545346, 35.75925311942895, 35.8561248977979, 36.11221223076184, 33.43940213570991, 33.28267496327558, 32.821014935771615, 46.32291530321041, 46.697512614230305, 46.58169006059566, 41.69905816515286, 42.12619322662552, 41.822147009273365, 49.67916353916128, 49.245755200584725, 49.328776759405926, 37.75577597514105, 37.74062823116158, 37.738738237724945, 26.937360011041164, 27.041930455714464, 26.886786364018917, 25.996324613690376, 26.245791919529438, 26.40716866403818, 28.88291941241671, 28.689755142976836, 28.84812971328695, 34.02844145024815, 33.84204491103688, 32.772579352060944, 33.53130034295221, 33.41093098868926, 33.40600604315598, 37.028435846169785, 37.6560503480335, 36.539356266458825, 35.792513624609754, 35.646670504783586, 35.67768717867632, 39.63391984750827, 39.818094958861664, 39.74947954465945, 40.461852218955755, 40.53497190028429, 40.37012657523155, 30.519981668641165, 30.265684021015957, 30.3687178765734, 31.00455991178751, 30.836901769042015, 31.043514154851437, 43.81597428396344, 43.89004558138549, 43.336847841739655, 18.40240717430909, 18.115521897872284, 18.227312458058194, 38.80883154521385, 38.858719329039246, 38.91180110226074, 38.91624252622326, 38.80437800039847, 38.11860216160615, 33.74251382549603, 33.6472449277838, 33.78494059791167, 40.96660232047239, 40.77767027417818, 41.28943964714804, 41.081112193564564, 41.23735673601428, 41.069990562895924, 39.286776820818574, 39.99965252021016, 39.69924975434938, 34.03245763480663, 33.877619594335556, 33.959079176187515, 41.10728280618787, 41.04444485157728, 41.10551007091999, 37.42297125731905, 37.48994582491771, 36.96632183839877, 31.411183267831802, 32.015779950656, 31.980757523328066, 43.1352604428927, 43.512155196319014, 43.15601995835701, 35.67318434516588, 35.76435456673303, 35.350771124164254, 41.2329485565424, 41.884575666161254, 41.898512463638326, 25.372143993464604, 25.20706944664319, 24.23752986391385, 29.01987986266613, 29.18219668418169, 28.452582374215126, 34.302019665638596, 34.869436773161084, 34.93038179601231, 36.87315847973028, 37.23436739544073, 37.29649767527977, 27.300244390964508, 27.261775963008404, 27.160129573196173, 29.01389912205437, 28.740547778705746, 28.111942927042634, 10.63854171584049, 10.744627161572367, 10.440318050483853, 32.47536291430393, 32.50488110880056, 32.6834625105063, 30.84455684324105, 30.794309755166367, 31.30788632233937, 29.15707356886317, 28.994844892372683, 28.81575396408637, 40.57403767605622, 40.98607350264986, 40.97641673063238, 35.80565575541307, 35.13565943141778, 35.240686913331345, 33.60197031497955, 33.42228186875582, 33.9169102916494, 38.98137299219766, 39.52214678625265, 39.24388145903745]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14247715693032692, "mean_inference_ms": 0.6948530850512339, "mean_action_processing_ms": 0.09579788138512646, "mean_env_wait_ms": 0.7973508885696371, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 505000, "timesteps_this_iter": 0, "agent_timesteps_total": 1515000, "timers": {"sample_time_ms": 11134.376, "sample_throughput": 449.06, "load_time_ms": 0.317, "load_throughput": 15768060.15, "learn_time_ms": 1930.4, "learn_throughput": 2590.137, "update_time_ms": 9.643}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.617444900424222e-25, "cur_lr": 0.0005000000000000001, "total_loss": 5.8086387634277346, "policy_loss": -0.0022784327356734748, "vf_loss": 5.901959228515625, "vf_explained_var": -0.08308370113372802, "kl": 0.0035304265329864763, "entropy": 9.104177474975586, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 505000, "num_agent_steps_sampled": 1515000, "num_steps_trained": 505000, "num_agent_steps_trained": 1515000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1675, "training_iteration": 101, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-19-34", "timestamp": 1706231974, "time_this_iter_s": 10.406894207000732, "time_total_s": 1089.871289730072, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214024175E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1089.871289730072, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 6.44, "ram_util_percent": 60.85333333333333}}
{"episode_reward_max": 148.25369549915206, "episode_reward_min": -309.2508905529976, "episode_reward_mean": 96.01484736562445, "episode_len_mean": 491.39, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -108.00657002131145}, "policy_reward_max": {"shared_policy": 49.67916353916128}, "policy_reward_mean": {"shared_policy": 32.004949121874816}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.47069609351455, 98.42637932673094, 86.90079868957397, 109.62030689418313, 104.52157445996998, 78.09776641614735, 114.17205324210224, 115.16235415567644, 99.4799759276211, 104.24974867329, 113.44874222949146, 117.55758431553838, 138.5394292734565, 112.40542024211027, 89.98520539328453, 138.94905738532555, 67.56256507127546, 129.79988437239084, 54.45388766378164, 100.35119411349295, 126.29308914020655, 82.52781672682613, 98.52946651540697, 121.66643320862201, 97.78021225053814, 85.35461777728048, 91.95652903243898, 97.30403460375962, 111.5683522671461, 92.73105284199116, 126.47524957032871, 90.28002841770649, 83.86686263419686, 118.52020236849783, 95.5653587458655, 129.2420795559884, 79.56541659496725, 87.4329362399876, -304.5475348830223, 119.45796001213601, 130.93514127284288, -309.2508905529976, 119.37222600542007, 113.06079946830869, 107.72759024798869, 99.54309203475711, 139.60211797803635, 125.64739840105175, 148.25369549915206, 113.23514244402757, 80.86607683077455, 78.649285197258, 86.4208042686805, 100.64306571334598, 100.34823737479745, 111.22384246066211, 107.11687130806966, 119.20149435102938, 121.3669506944716, 91.15438356623052, 92.88497583568096, 131.0428677070886, 54.74524153023957, 116.57935197651383, 115.83922268822788, 101.1746993511915, 123.03371224179861, 123.38845949247477, 118.98567909537812, 101.8691564053297, 123.25723772868514, 111.87923892063553, 95.40772074181587, 129.80343559756875, 106.78831003606317, 125.01603668634198, 74.81674330402164, 86.65465892106295, 104.10183823481199, 111.40402355045077, 81.72214992716908, 85.86638982780275, 31.82348692789671, 97.66370653361079, 92.94675292074679, 86.96767242532222, 122.53652790933846, 106.1820021001622, 100.94116247538477, 117.74740123748776, 103.61598575860262, 120.52502629533409, 144.33183007687322, 99.7386921979487, 100.44525986351071, 99.59547172486779, 113.0019856300205, 108.00115147698669, 86.4476985502988, 59.86966053396462], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 62, 500, 500, 77, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [33.859526117642716, 34.390513564770416, 34.220656411101416, 32.89694134394327, 32.1022726992766, 33.42716528351107, 29.182218285898358, 28.75056968132654, 28.968010722349078, 36.53901730726162, 36.55301599825421, 36.528273588667304, 34.13007042308648, 35.13722051804264, 35.254283518840865, 25.89971812814474, 26.245198206976056, 25.952850081026554, 38.11219949057946, 38.14122015393028, 37.9186335975925, 38.484844661550596, 38.41898399591446, 38.258525498211384, 32.76799916724363, 33.42678397397199, 33.285192786405474, 34.74575180311997, 34.92510637020071, 34.57889049996932, 37.6723517080148, 37.909851760913924, 37.86653876056273, 39.463022167483956, 38.593003342549, 39.501558805505425, 45.62706780433655, 46.215302765369415, 46.69705870375037, 37.449365550652146, 37.53832409181632, 37.4177305996418, 29.671124229828507, 30.186566850791365, 30.12751431266466, 46.25496819615364, 46.5719498693943, 46.12213931977749, 22.833418449154124, 22.392182126641273, 22.33696449548006, 43.046087863544614, 43.37755113715926, 43.376245371686906, 18.422267742455006, 17.999063327908516, 18.03255659341812, 33.32324969520171, 33.551855263610676, 33.476089154680565, 42.34837538624802, 41.66941278676191, 42.275300967196614, 27.497140211984515, 27.528870209120214, 27.501806305721402, 32.77775690704584, 32.81346422433853, 32.93824538402259, 40.14641892413297, 41.023487250941486, 40.49652703354755, 32.86009416698167, 32.38454651335874, 32.53557157019773, 28.617356633457035, 28.358719343940407, 28.37854179988304, 30.41037693371375, 30.711550561090306, 30.834601537634924, 32.38477403546372, 32.60402680623034, 32.31523376206556, 36.86675923069318, 37.43065482129653, 37.27093821515639, 30.79792561630407, 31.166202171395213, 30.766925054291875, 41.82212636868158, 42.35726548653716, 42.295857715109975, 30.07597655802965, 30.112265281379223, 30.091786578297615, 28.057007230197385, 28.016112511356667, 27.79374289264281, 39.44457750519116, 39.54007092614968, 39.53555393715699, 31.981740136320383, 31.5069095964233, 32.076709013121814, 43.36831400791803, 43.22574215630689, 42.64802339176336, 26.44009167701006, 26.630987836048007, 26.49433708190918, 29.245466650774077, 29.098225203653172, 29.08924438556035, -98.27647874752681, -98.30451312164466, -107.96654301385085, 39.74896964182456, 39.64219768097003, 40.066792689341426, 43.660173433522374, 43.71443861971298, 43.5605292196075, -108.00657002131145, -100.72514487306277, -100.51917565862338, 39.707099092503384, 39.9935429499795, 39.67158396293719, 37.5877136439085, 37.78408976085484, 37.688996063545346, 35.75925311942895, 35.8561248977979, 36.11221223076184, 33.43940213570991, 33.28267496327558, 32.821014935771615, 46.32291530321041, 46.697512614230305, 46.58169006059566, 41.69905816515286, 42.12619322662552, 41.822147009273365, 49.67916353916128, 49.245755200584725, 49.328776759405926, 37.75577597514105, 37.74062823116158, 37.738738237724945, 26.937360011041164, 27.041930455714464, 26.886786364018917, 25.996324613690376, 26.245791919529438, 26.40716866403818, 28.88291941241671, 28.689755142976836, 28.84812971328695, 34.02844145024815, 33.84204491103688, 32.772579352060944, 33.53130034295221, 33.41093098868926, 33.40600604315598, 37.028435846169785, 37.6560503480335, 36.539356266458825, 35.792513624609754, 35.646670504783586, 35.67768717867632, 39.63391984750827, 39.818094958861664, 39.74947954465945, 40.461852218955755, 40.53497190028429, 40.37012657523155, 30.519981668641165, 30.265684021015957, 30.3687178765734, 31.00455991178751, 30.836901769042015, 31.043514154851437, 43.81597428396344, 43.89004558138549, 43.336847841739655, 18.40240717430909, 18.115521897872284, 18.227312458058194, 38.80883154521385, 38.858719329039246, 38.91180110226074, 38.91624252622326, 38.80437800039847, 38.11860216160615, 33.74251382549603, 33.6472449277838, 33.78494059791167, 40.96660232047239, 40.77767027417818, 41.28943964714804, 41.081112193564564, 41.23735673601428, 41.069990562895924, 39.286776820818574, 39.99965252021016, 39.69924975434938, 34.03245763480663, 33.877619594335556, 33.959079176187515, 41.10728280618787, 41.04444485157728, 41.10551007091999, 37.42297125731905, 37.48994582491771, 36.96632183839877, 31.411183267831802, 32.015779950656, 31.980757523328066, 43.1352604428927, 43.512155196319014, 43.15601995835701, 35.67318434516588, 35.76435456673303, 35.350771124164254, 41.2329485565424, 41.884575666161254, 41.898512463638326, 25.372143993464604, 25.20706944664319, 24.23752986391385, 29.01987986266613, 29.18219668418169, 28.452582374215126, 34.302019665638596, 34.869436773161084, 34.93038179601231, 36.87315847973028, 37.23436739544073, 37.29649767527977, 27.300244390964508, 27.261775963008404, 27.160129573196173, 29.01389912205437, 28.740547778705746, 28.111942927042634, 10.63854171584049, 10.744627161572367, 10.440318050483853, 32.47536291430393, 32.50488110880056, 32.6834625105063, 30.84455684324105, 30.794309755166367, 31.30788632233937, 29.15707356886317, 28.994844892372683, 28.81575396408637, 40.57403767605622, 40.98607350264986, 40.97641673063238, 35.80565575541307, 35.13565943141778, 35.240686913331345, 33.60197031497955, 33.42228186875582, 33.9169102916494, 38.98137299219766, 39.52214678625265, 39.24388145903745, 34.52014331519604, 34.61343494057655, 34.48240750283003, 40.21617607896526, 40.293236074348286, 40.01561414202054, 48.14083402603863, 48.0168873593211, 48.174108691513524, 33.51905806735158, 33.16896249353886, 33.05067163705826, 33.42378581811984, 33.818635232125715, 33.20283881326516, 33.16406042377153, 33.20304856697717, 33.22836273411909, 37.8513834644109, 37.49489664286375, 37.65570552274585, 36.227973467049495, 36.047613756110266, 35.72556425382693, 28.855671544869736, 28.668459465106324, 28.923567540322736, 20.278717448314026, 19.61900258560975, 19.971940500040844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1423938592802738, "mean_inference_ms": 0.6947193878095475, "mean_action_processing_ms": 0.09576590963439578, "mean_env_wait_ms": 0.7970178250953182, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 510000, "timesteps_this_iter": 0, "agent_timesteps_total": 1530000, "timers": {"sample_time_ms": 11200.955, "sample_throughput": 446.391, "load_time_ms": 0.317, "load_throughput": 15768060.15, "learn_time_ms": 1930.752, "learn_throughput": 2589.664, "update_time_ms": 9.545}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.308722450212111e-25, "cur_lr": 0.0005000000000000001, "total_loss": 9.682743358612061, "policy_loss": -0.001607985046704563, "vf_loss": 9.776343154907227, "vf_explained_var": -0.014619433879852295, "kl": 0.0026257006800991423, "entropy": 9.199223518371582, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 510000, "num_agent_steps_sampled": 1530000, "num_steps_trained": 510000, "num_agent_steps_trained": 1530000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1685, "training_iteration": 102, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-19-45", "timestamp": 1706231985, "time_this_iter_s": 10.757487297058105, "time_total_s": 1100.6287770271301, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402417DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1100.6287770271301, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 7.793333333333335, "ram_util_percent": 60.87333333333333}}
{"episode_reward_max": 148.25369549915206, "episode_reward_min": -309.2508905529976, "episode_reward_mean": 96.66551496809319, "episode_len_mean": 491.39, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -108.00657002131145}, "policy_reward_max": {"shared_policy": 49.67916353916128}, "policy_reward_mean": {"shared_policy": 32.22183832269773}, "custom_metrics": {}, "hist_stats": {"episode_reward": [113.44874222949146, 117.55758431553838, 138.5394292734565, 112.40542024211027, 89.98520539328453, 138.94905738532555, 67.56256507127546, 129.79988437239084, 54.45388766378164, 100.35119411349295, 126.29308914020655, 82.52781672682613, 98.52946651540697, 121.66643320862201, 97.78021225053814, 85.35461777728048, 91.95652903243898, 97.30403460375962, 111.5683522671461, 92.73105284199116, 126.47524957032871, 90.28002841770649, 83.86686263419686, 118.52020236849783, 95.5653587458655, 129.2420795559884, 79.56541659496725, 87.4329362399876, -304.5475348830223, 119.45796001213601, 130.93514127284288, -309.2508905529976, 119.37222600542007, 113.06079946830869, 107.72759024798869, 99.54309203475711, 139.60211797803635, 125.64739840105175, 148.25369549915206, 113.23514244402757, 80.86607683077455, 78.649285197258, 86.4208042686805, 100.64306571334598, 100.34823737479745, 111.22384246066211, 107.11687130806966, 119.20149435102938, 121.3669506944716, 91.15438356623052, 92.88497583568096, 131.0428677070886, 54.74524153023957, 116.57935197651383, 115.83922268822788, 101.1746993511915, 123.03371224179861, 123.38845949247477, 118.98567909537812, 101.8691564053297, 123.25723772868514, 111.87923892063553, 95.40772074181587, 129.80343559756875, 106.78831003606317, 125.01603668634198, 74.81674330402164, 86.65465892106295, 104.10183823481199, 111.40402355045077, 81.72214992716908, 85.86638982780275, 31.82348692789671, 97.66370653361079, 92.94675292074679, 86.96767242532222, 122.53652790933846, 106.1820021001622, 100.94116247538477, 117.74740123748776, 103.61598575860262, 120.52502629533409, 144.33183007687322, 99.7386921979487, 100.44525986351071, 99.59547172486779, 113.0019856300205, 108.00115147698669, 86.4476985502988, 59.86966053396462, 143.28918143920595, 110.19766272976995, 110.54132325435056, 127.12956324964759, 120.4077593758702, 132.4619431197643, 15.72759150806813, 116.87038551829755, 104.8107192851603, 96.73228464554994], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 62, 500, 500, 77, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [37.6723517080148, 37.909851760913924, 37.86653876056273, 39.463022167483956, 38.593003342549, 39.501558805505425, 45.62706780433655, 46.215302765369415, 46.69705870375037, 37.449365550652146, 37.53832409181632, 37.4177305996418, 29.671124229828507, 30.186566850791365, 30.12751431266466, 46.25496819615364, 46.5719498693943, 46.12213931977749, 22.833418449154124, 22.392182126641273, 22.33696449548006, 43.046087863544614, 43.37755113715926, 43.376245371686906, 18.422267742455006, 17.999063327908516, 18.03255659341812, 33.32324969520171, 33.551855263610676, 33.476089154680565, 42.34837538624802, 41.66941278676191, 42.275300967196614, 27.497140211984515, 27.528870209120214, 27.501806305721402, 32.77775690704584, 32.81346422433853, 32.93824538402259, 40.14641892413297, 41.023487250941486, 40.49652703354755, 32.86009416698167, 32.38454651335874, 32.53557157019773, 28.617356633457035, 28.358719343940407, 28.37854179988304, 30.41037693371375, 30.711550561090306, 30.834601537634924, 32.38477403546372, 32.60402680623034, 32.31523376206556, 36.86675923069318, 37.43065482129653, 37.27093821515639, 30.79792561630407, 31.166202171395213, 30.766925054291875, 41.82212636868158, 42.35726548653716, 42.295857715109975, 30.07597655802965, 30.112265281379223, 30.091786578297615, 28.057007230197385, 28.016112511356667, 27.79374289264281, 39.44457750519116, 39.54007092614968, 39.53555393715699, 31.981740136320383, 31.5069095964233, 32.076709013121814, 43.36831400791803, 43.22574215630689, 42.64802339176336, 26.44009167701006, 26.630987836048007, 26.49433708190918, 29.245466650774077, 29.098225203653172, 29.08924438556035, -98.27647874752681, -98.30451312164466, -107.96654301385085, 39.74896964182456, 39.64219768097003, 40.066792689341426, 43.660173433522374, 43.71443861971298, 43.5605292196075, -108.00657002131145, -100.72514487306277, -100.51917565862338, 39.707099092503384, 39.9935429499795, 39.67158396293719, 37.5877136439085, 37.78408976085484, 37.688996063545346, 35.75925311942895, 35.8561248977979, 36.11221223076184, 33.43940213570991, 33.28267496327558, 32.821014935771615, 46.32291530321041, 46.697512614230305, 46.58169006059566, 41.69905816515286, 42.12619322662552, 41.822147009273365, 49.67916353916128, 49.245755200584725, 49.328776759405926, 37.75577597514105, 37.74062823116158, 37.738738237724945, 26.937360011041164, 27.041930455714464, 26.886786364018917, 25.996324613690376, 26.245791919529438, 26.40716866403818, 28.88291941241671, 28.689755142976836, 28.84812971328695, 34.02844145024815, 33.84204491103688, 32.772579352060944, 33.53130034295221, 33.41093098868926, 33.40600604315598, 37.028435846169785, 37.6560503480335, 36.539356266458825, 35.792513624609754, 35.646670504783586, 35.67768717867632, 39.63391984750827, 39.818094958861664, 39.74947954465945, 40.461852218955755, 40.53497190028429, 40.37012657523155, 30.519981668641165, 30.265684021015957, 30.3687178765734, 31.00455991178751, 30.836901769042015, 31.043514154851437, 43.81597428396344, 43.89004558138549, 43.336847841739655, 18.40240717430909, 18.115521897872284, 18.227312458058194, 38.80883154521385, 38.858719329039246, 38.91180110226074, 38.91624252622326, 38.80437800039847, 38.11860216160615, 33.74251382549603, 33.6472449277838, 33.78494059791167, 40.96660232047239, 40.77767027417818, 41.28943964714804, 41.081112193564564, 41.23735673601428, 41.069990562895924, 39.286776820818574, 39.99965252021016, 39.69924975434938, 34.03245763480663, 33.877619594335556, 33.959079176187515, 41.10728280618787, 41.04444485157728, 41.10551007091999, 37.42297125731905, 37.48994582491771, 36.96632183839877, 31.411183267831802, 32.015779950656, 31.980757523328066, 43.1352604428927, 43.512155196319014, 43.15601995835701, 35.67318434516588, 35.76435456673303, 35.350771124164254, 41.2329485565424, 41.884575666161254, 41.898512463638326, 25.372143993464604, 25.20706944664319, 24.23752986391385, 29.01987986266613, 29.18219668418169, 28.452582374215126, 34.302019665638596, 34.869436773161084, 34.93038179601231, 36.87315847973028, 37.23436739544073, 37.29649767527977, 27.300244390964508, 27.261775963008404, 27.160129573196173, 29.01389912205437, 28.740547778705746, 28.111942927042634, 10.63854171584049, 10.744627161572367, 10.440318050483853, 32.47536291430393, 32.50488110880056, 32.6834625105063, 30.84455684324105, 30.794309755166367, 31.30788632233937, 29.15707356886317, 28.994844892372683, 28.81575396408637, 40.57403767605622, 40.98607350264986, 40.97641673063238, 35.80565575541307, 35.13565943141778, 35.240686913331345, 33.60197031497955, 33.42228186875582, 33.9169102916494, 38.98137299219766, 39.52214678625265, 39.24388145903745, 34.52014331519604, 34.61343494057655, 34.48240750283003, 40.21617607896526, 40.293236074348286, 40.01561414202054, 48.14083402603863, 48.0168873593211, 48.174108691513524, 33.51905806735158, 33.16896249353886, 33.05067163705826, 33.42378581811984, 33.818635232125715, 33.20283881326516, 33.16406042377153, 33.20304856697717, 33.22836273411909, 37.8513834644109, 37.49489664286375, 37.65570552274585, 36.227973467049495, 36.047613756110266, 35.72556425382693, 28.855671544869736, 28.668459465106324, 28.923567540322736, 20.278717448314026, 19.61900258560975, 19.971940500040844, 47.84499775866668, 47.539326290289566, 47.904857390249774, 36.68817402794957, 36.70969283208251, 36.79979586973786, 37.045957341634974, 36.63723055769999, 36.85813535501559, 42.488597745696694, 42.63197385023037, 42.00899165372053, 40.01990912357965, 40.17333024988571, 40.21452000240484, 44.05249747633934, 44.06456857174635, 44.34487707167864, 5.123891336222485, 5.46911345267047, 5.134586719175175, 39.065610855817795, 39.138243613764644, 38.666531048715115, 35.039569940418005, 34.4490909576416, 35.3220583871007, 32.66871047051002, 32.189567287762955, 31.874006887276963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1423160071555509, "mean_inference_ms": 0.6946281817532691, "mean_action_processing_ms": 0.09573158881734532, "mean_env_wait_ms": 0.796727854399476, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 515000, "timesteps_this_iter": 0, "agent_timesteps_total": 1545000, "timers": {"sample_time_ms": 11240.218, "sample_throughput": 444.831, "load_time_ms": 0.417, "load_throughput": 11986465.478, "learn_time_ms": 1934.082, "learn_throughput": 2585.205, "update_time_ms": 9.545}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6543612251060554e-25, "cur_lr": 0.0005000000000000001, "total_loss": 6.3322137832641605, "policy_loss": -0.0015342553294031003, "vf_loss": 6.425823068618774, "vf_explained_var": -0.08812621831893921, "kl": 0.0016278768366001048, "entropy": 9.207512950897216, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 515000, "num_agent_steps_sampled": 1545000, "num_steps_trained": 515000, "num_agent_steps_trained": 1545000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1695, "training_iteration": 103, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-19-55", "timestamp": 1706231995, "time_this_iter_s": 10.71141266822815, "time_total_s": 1111.3401896953583, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021400813D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1111.3401896953583, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 6.593333333333334, "ram_util_percent": 61.0}}
{"episode_reward_max": 148.25369549915206, "episode_reward_min": -309.2508905529976, "episode_reward_mean": 96.09897314039961, "episode_len_mean": 491.39, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -108.00657002131145}, "policy_reward_max": {"shared_policy": 49.67916353916128}, "policy_reward_mean": {"shared_policy": 32.032991046799864}, "custom_metrics": {}, "hist_stats": {"episode_reward": [126.29308914020655, 82.52781672682613, 98.52946651540697, 121.66643320862201, 97.78021225053814, 85.35461777728048, 91.95652903243898, 97.30403460375962, 111.5683522671461, 92.73105284199116, 126.47524957032871, 90.28002841770649, 83.86686263419686, 118.52020236849783, 95.5653587458655, 129.2420795559884, 79.56541659496725, 87.4329362399876, -304.5475348830223, 119.45796001213601, 130.93514127284288, -309.2508905529976, 119.37222600542007, 113.06079946830869, 107.72759024798869, 99.54309203475711, 139.60211797803635, 125.64739840105175, 148.25369549915206, 113.23514244402757, 80.86607683077455, 78.649285197258, 86.4208042686805, 100.64306571334598, 100.34823737479745, 111.22384246066211, 107.11687130806966, 119.20149435102938, 121.3669506944716, 91.15438356623052, 92.88497583568096, 131.0428677070886, 54.74524153023957, 116.57935197651383, 115.83922268822788, 101.1746993511915, 123.03371224179861, 123.38845949247477, 118.98567909537812, 101.8691564053297, 123.25723772868514, 111.87923892063553, 95.40772074181587, 129.80343559756875, 106.78831003606317, 125.01603668634198, 74.81674330402164, 86.65465892106295, 104.10183823481199, 111.40402355045077, 81.72214992716908, 85.86638982780275, 31.82348692789671, 97.66370653361079, 92.94675292074679, 86.96767242532222, 122.53652790933846, 106.1820021001622, 100.94116247538477, 117.74740123748776, 103.61598575860262, 120.52502629533409, 144.33183007687322, 99.7386921979487, 100.44525986351071, 99.59547172486779, 113.0019856300205, 108.00115147698669, 86.4476985502988, 59.86966053396462, 143.28918143920595, 110.19766272976995, 110.54132325435056, 127.12956324964759, 120.4077593758702, 132.4619431197643, 15.72759150806813, 116.87038551829755, 104.8107192851603, 96.73228464554994, 98.78319065645337, 100.08317201584575, 89.13908489607275, 100.59406171832234, 116.78166082315147, 102.21243063546717, 114.89264739118515, 104.27214036136863, 90.10863341391085, 89.53176537901162], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 62, 500, 500, 77, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [42.34837538624802, 41.66941278676191, 42.275300967196614, 27.497140211984515, 27.528870209120214, 27.501806305721402, 32.77775690704584, 32.81346422433853, 32.93824538402259, 40.14641892413297, 41.023487250941486, 40.49652703354755, 32.86009416698167, 32.38454651335874, 32.53557157019773, 28.617356633457035, 28.358719343940407, 28.37854179988304, 30.41037693371375, 30.711550561090306, 30.834601537634924, 32.38477403546372, 32.60402680623034, 32.31523376206556, 36.86675923069318, 37.43065482129653, 37.27093821515639, 30.79792561630407, 31.166202171395213, 30.766925054291875, 41.82212636868158, 42.35726548653716, 42.295857715109975, 30.07597655802965, 30.112265281379223, 30.091786578297615, 28.057007230197385, 28.016112511356667, 27.79374289264281, 39.44457750519116, 39.54007092614968, 39.53555393715699, 31.981740136320383, 31.5069095964233, 32.076709013121814, 43.36831400791803, 43.22574215630689, 42.64802339176336, 26.44009167701006, 26.630987836048007, 26.49433708190918, 29.245466650774077, 29.098225203653172, 29.08924438556035, -98.27647874752681, -98.30451312164466, -107.96654301385085, 39.74896964182456, 39.64219768097003, 40.066792689341426, 43.660173433522374, 43.71443861971298, 43.5605292196075, -108.00657002131145, -100.72514487306277, -100.51917565862338, 39.707099092503384, 39.9935429499795, 39.67158396293719, 37.5877136439085, 37.78408976085484, 37.688996063545346, 35.75925311942895, 35.8561248977979, 36.11221223076184, 33.43940213570991, 33.28267496327558, 32.821014935771615, 46.32291530321041, 46.697512614230305, 46.58169006059566, 41.69905816515286, 42.12619322662552, 41.822147009273365, 49.67916353916128, 49.245755200584725, 49.328776759405926, 37.75577597514105, 37.74062823116158, 37.738738237724945, 26.937360011041164, 27.041930455714464, 26.886786364018917, 25.996324613690376, 26.245791919529438, 26.40716866403818, 28.88291941241671, 28.689755142976836, 28.84812971328695, 34.02844145024815, 33.84204491103688, 32.772579352060944, 33.53130034295221, 33.41093098868926, 33.40600604315598, 37.028435846169785, 37.6560503480335, 36.539356266458825, 35.792513624609754, 35.646670504783586, 35.67768717867632, 39.63391984750827, 39.818094958861664, 39.74947954465945, 40.461852218955755, 40.53497190028429, 40.37012657523155, 30.519981668641165, 30.265684021015957, 30.3687178765734, 31.00455991178751, 30.836901769042015, 31.043514154851437, 43.81597428396344, 43.89004558138549, 43.336847841739655, 18.40240717430909, 18.115521897872284, 18.227312458058194, 38.80883154521385, 38.858719329039246, 38.91180110226074, 38.91624252622326, 38.80437800039847, 38.11860216160615, 33.74251382549603, 33.6472449277838, 33.78494059791167, 40.96660232047239, 40.77767027417818, 41.28943964714804, 41.081112193564564, 41.23735673601428, 41.069990562895924, 39.286776820818574, 39.99965252021016, 39.69924975434938, 34.03245763480663, 33.877619594335556, 33.959079176187515, 41.10728280618787, 41.04444485157728, 41.10551007091999, 37.42297125731905, 37.48994582491771, 36.96632183839877, 31.411183267831802, 32.015779950656, 31.980757523328066, 43.1352604428927, 43.512155196319014, 43.15601995835701, 35.67318434516588, 35.76435456673303, 35.350771124164254, 41.2329485565424, 41.884575666161254, 41.898512463638326, 25.372143993464604, 25.20706944664319, 24.23752986391385, 29.01987986266613, 29.18219668418169, 28.452582374215126, 34.302019665638596, 34.869436773161084, 34.93038179601231, 36.87315847973028, 37.23436739544073, 37.29649767527977, 27.300244390964508, 27.261775963008404, 27.160129573196173, 29.01389912205437, 28.740547778705746, 28.111942927042634, 10.63854171584049, 10.744627161572367, 10.440318050483853, 32.47536291430393, 32.50488110880056, 32.6834625105063, 30.84455684324105, 30.794309755166367, 31.30788632233937, 29.15707356886317, 28.994844892372683, 28.81575396408637, 40.57403767605622, 40.98607350264986, 40.97641673063238, 35.80565575541307, 35.13565943141778, 35.240686913331345, 33.60197031497955, 33.42228186875582, 33.9169102916494, 38.98137299219766, 39.52214678625265, 39.24388145903745, 34.52014331519604, 34.61343494057655, 34.48240750283003, 40.21617607896526, 40.293236074348286, 40.01561414202054, 48.14083402603863, 48.0168873593211, 48.174108691513524, 33.51905806735158, 33.16896249353886, 33.05067163705826, 33.42378581811984, 33.818635232125715, 33.20283881326516, 33.16406042377153, 33.20304856697717, 33.22836273411909, 37.8513834644109, 37.49489664286375, 37.65570552274585, 36.227973467049495, 36.047613756110266, 35.72556425382693, 28.855671544869736, 28.668459465106324, 28.923567540322736, 20.278717448314026, 19.61900258560975, 19.971940500040844, 47.84499775866668, 47.539326290289566, 47.904857390249774, 36.68817402794957, 36.70969283208251, 36.79979586973786, 37.045957341634974, 36.63723055769999, 36.85813535501559, 42.488597745696694, 42.63197385023037, 42.00899165372053, 40.01990912357965, 40.17333024988571, 40.21452000240484, 44.05249747633934, 44.06456857174635, 44.34487707167864, 5.123891336222485, 5.46911345267047, 5.134586719175175, 39.065610855817795, 39.138243613764644, 38.666531048715115, 35.039569940418005, 34.4490909576416, 35.3220583871007, 32.66871047051002, 32.189567287762955, 31.874006887276963, 33.1939588971436, 32.75384131073952, 32.83539044857025, 33.36253174642721, 33.61463417361179, 33.10600609580675, 29.833983659744263, 29.565422043204308, 29.739679193124175, 33.70861135516316, 33.51800875365734, 33.36744160950184, 39.032213263213634, 39.373643374070525, 38.37580418586731, 34.28376969136298, 33.80789498984814, 34.12076595425606, 38.421020993342, 38.47195065704484, 37.99967574079831, 34.4042315284411, 34.92099547261992, 34.946913360307605, 30.069439982374504, 30.37481156488259, 29.664381866653756, 29.923061860104397, 29.760144149263695, 29.848559369643525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1422509462982393, "mean_inference_ms": 0.6946010125830914, "mean_action_processing_ms": 0.09571332083464207, "mean_env_wait_ms": 0.7965221088766534, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 520000, "timesteps_this_iter": 0, "agent_timesteps_total": 1560000, "timers": {"sample_time_ms": 11322.552, "sample_throughput": 441.597, "load_time_ms": 0.401, "load_throughput": 12465981.097, "learn_time_ms": 1947.526, "learn_throughput": 2567.36, "update_time_ms": 9.523}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.271806125530277e-26, "cur_lr": 0.0005000000000000001, "total_loss": 5.7868448257446286, "policy_loss": -0.001999104598337631, "vf_loss": 5.881404781341553, "vf_explained_var": 0.010087841749191284, "kl": 0.0030918012373417035, "entropy": 9.256102561950684, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 520000, "num_agent_steps_sampled": 1560000, "num_steps_trained": 520000, "num_agent_steps_trained": 1560000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1705, "training_iteration": 104, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-20-07", "timestamp": 1706232007, "time_this_iter_s": 11.096994638442993, "time_total_s": 1122.4371843338013, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214042460D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1122.4371843338013, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 8.0125, "ram_util_percent": 61.19375}}
{"episode_reward_max": 148.25369549915206, "episode_reward_min": -309.2508905529976, "episode_reward_mean": 96.10705891084362, "episode_len_mean": 491.39, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -108.00657002131145}, "policy_reward_max": {"shared_policy": 49.67916353916128}, "policy_reward_mean": {"shared_policy": 32.03568630361453}, "custom_metrics": {}, "hist_stats": {"episode_reward": [126.47524957032871, 90.28002841770649, 83.86686263419686, 118.52020236849783, 95.5653587458655, 129.2420795559884, 79.56541659496725, 87.4329362399876, -304.5475348830223, 119.45796001213601, 130.93514127284288, -309.2508905529976, 119.37222600542007, 113.06079946830869, 107.72759024798869, 99.54309203475711, 139.60211797803635, 125.64739840105175, 148.25369549915206, 113.23514244402757, 80.86607683077455, 78.649285197258, 86.4208042686805, 100.64306571334598, 100.34823737479745, 111.22384246066211, 107.11687130806966, 119.20149435102938, 121.3669506944716, 91.15438356623052, 92.88497583568096, 131.0428677070886, 54.74524153023957, 116.57935197651383, 115.83922268822788, 101.1746993511915, 123.03371224179861, 123.38845949247477, 118.98567909537812, 101.8691564053297, 123.25723772868514, 111.87923892063553, 95.40772074181587, 129.80343559756875, 106.78831003606317, 125.01603668634198, 74.81674330402164, 86.65465892106295, 104.10183823481199, 111.40402355045077, 81.72214992716908, 85.86638982780275, 31.82348692789671, 97.66370653361079, 92.94675292074679, 86.96767242532222, 122.53652790933846, 106.1820021001622, 100.94116247538477, 117.74740123748776, 103.61598575860262, 120.52502629533409, 144.33183007687322, 99.7386921979487, 100.44525986351071, 99.59547172486779, 113.0019856300205, 108.00115147698669, 86.4476985502988, 59.86966053396462, 143.28918143920595, 110.19766272976995, 110.54132325435056, 127.12956324964759, 120.4077593758702, 132.4619431197643, 15.72759150806813, 116.87038551829755, 104.8107192851603, 96.73228464554994, 98.78319065645337, 100.08317201584575, 89.13908489607275, 100.59406171832234, 116.78166082315147, 102.21243063546717, 114.89264739118515, 104.27214036136863, 90.10863341391085, 89.53176537901162, 58.453190267086, 121.97365961968899, 114.22639397531748, 57.96755185863002, 93.02504895627499, 128.1729917582124, 110.47033385187387, 113.99968894198535, 104.26475749537346, 103.96656468417493], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 62, 500, 500, 77, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [41.82212636868158, 42.35726548653716, 42.295857715109975, 30.07597655802965, 30.112265281379223, 30.091786578297615, 28.057007230197385, 28.016112511356667, 27.79374289264281, 39.44457750519116, 39.54007092614968, 39.53555393715699, 31.981740136320383, 31.5069095964233, 32.076709013121814, 43.36831400791803, 43.22574215630689, 42.64802339176336, 26.44009167701006, 26.630987836048007, 26.49433708190918, 29.245466650774077, 29.098225203653172, 29.08924438556035, -98.27647874752681, -98.30451312164466, -107.96654301385085, 39.74896964182456, 39.64219768097003, 40.066792689341426, 43.660173433522374, 43.71443861971298, 43.5605292196075, -108.00657002131145, -100.72514487306277, -100.51917565862338, 39.707099092503384, 39.9935429499795, 39.67158396293719, 37.5877136439085, 37.78408976085484, 37.688996063545346, 35.75925311942895, 35.8561248977979, 36.11221223076184, 33.43940213570991, 33.28267496327558, 32.821014935771615, 46.32291530321041, 46.697512614230305, 46.58169006059566, 41.69905816515286, 42.12619322662552, 41.822147009273365, 49.67916353916128, 49.245755200584725, 49.328776759405926, 37.75577597514105, 37.74062823116158, 37.738738237724945, 26.937360011041164, 27.041930455714464, 26.886786364018917, 25.996324613690376, 26.245791919529438, 26.40716866403818, 28.88291941241671, 28.689755142976836, 28.84812971328695, 34.02844145024815, 33.84204491103688, 32.772579352060944, 33.53130034295221, 33.41093098868926, 33.40600604315598, 37.028435846169785, 37.6560503480335, 36.539356266458825, 35.792513624609754, 35.646670504783586, 35.67768717867632, 39.63391984750827, 39.818094958861664, 39.74947954465945, 40.461852218955755, 40.53497190028429, 40.37012657523155, 30.519981668641165, 30.265684021015957, 30.3687178765734, 31.00455991178751, 30.836901769042015, 31.043514154851437, 43.81597428396344, 43.89004558138549, 43.336847841739655, 18.40240717430909, 18.115521897872284, 18.227312458058194, 38.80883154521385, 38.858719329039246, 38.91180110226074, 38.91624252622326, 38.80437800039847, 38.11860216160615, 33.74251382549603, 33.6472449277838, 33.78494059791167, 40.96660232047239, 40.77767027417818, 41.28943964714804, 41.081112193564564, 41.23735673601428, 41.069990562895924, 39.286776820818574, 39.99965252021016, 39.69924975434938, 34.03245763480663, 33.877619594335556, 33.959079176187515, 41.10728280618787, 41.04444485157728, 41.10551007091999, 37.42297125731905, 37.48994582491771, 36.96632183839877, 31.411183267831802, 32.015779950656, 31.980757523328066, 43.1352604428927, 43.512155196319014, 43.15601995835701, 35.67318434516588, 35.76435456673303, 35.350771124164254, 41.2329485565424, 41.884575666161254, 41.898512463638326, 25.372143993464604, 25.20706944664319, 24.23752986391385, 29.01987986266613, 29.18219668418169, 28.452582374215126, 34.302019665638596, 34.869436773161084, 34.93038179601231, 36.87315847973028, 37.23436739544073, 37.29649767527977, 27.300244390964508, 27.261775963008404, 27.160129573196173, 29.01389912205437, 28.740547778705746, 28.111942927042634, 10.63854171584049, 10.744627161572367, 10.440318050483853, 32.47536291430393, 32.50488110880056, 32.6834625105063, 30.84455684324105, 30.794309755166367, 31.30788632233937, 29.15707356886317, 28.994844892372683, 28.81575396408637, 40.57403767605622, 40.98607350264986, 40.97641673063238, 35.80565575541307, 35.13565943141778, 35.240686913331345, 33.60197031497955, 33.42228186875582, 33.9169102916494, 38.98137299219766, 39.52214678625265, 39.24388145903745, 34.52014331519604, 34.61343494057655, 34.48240750283003, 40.21617607896526, 40.293236074348286, 40.01561414202054, 48.14083402603863, 48.0168873593211, 48.174108691513524, 33.51905806735158, 33.16896249353886, 33.05067163705826, 33.42378581811984, 33.818635232125715, 33.20283881326516, 33.16406042377153, 33.20304856697717, 33.22836273411909, 37.8513834644109, 37.49489664286375, 37.65570552274585, 36.227973467049495, 36.047613756110266, 35.72556425382693, 28.855671544869736, 28.668459465106324, 28.923567540322736, 20.278717448314026, 19.61900258560975, 19.971940500040844, 47.84499775866668, 47.539326290289566, 47.904857390249774, 36.68817402794957, 36.70969283208251, 36.79979586973786, 37.045957341634974, 36.63723055769999, 36.85813535501559, 42.488597745696694, 42.63197385023037, 42.00899165372053, 40.01990912357965, 40.17333024988571, 40.21452000240484, 44.05249747633934, 44.06456857174635, 44.34487707167864, 5.123891336222485, 5.46911345267047, 5.134586719175175, 39.065610855817795, 39.138243613764644, 38.666531048715115, 35.039569940418005, 34.4490909576416, 35.3220583871007, 32.66871047051002, 32.189567287762955, 31.874006887276963, 33.1939588971436, 32.75384131073952, 32.83539044857025, 33.36253174642721, 33.61463417361179, 33.10600609580675, 29.833983659744263, 29.565422043204308, 29.739679193124175, 33.70861135516316, 33.51800875365734, 33.36744160950184, 39.032213263213634, 39.373643374070525, 38.37580418586731, 34.28376969136298, 33.80789498984814, 34.12076595425606, 38.421020993342, 38.47195065704484, 37.99967574079831, 34.4042315284411, 34.92099547261992, 34.946913360307605, 30.069439982374504, 30.37481156488259, 29.664381866653756, 29.923061860104397, 29.760144149263695, 29.848559369643525, 19.41584078470865, 19.51690778012076, 19.52044170225659, 40.88056553155184, 40.76000828295946, 40.33308580517769, 38.28176026418805, 38.2655871398747, 37.67904657125473, 18.87627861400445, 19.564360065230474, 19.526913179395095, 30.697761967778206, 31.231342375278473, 31.095944613218307, 42.6861957485477, 42.53707073877254, 42.94972527089217, 36.52143532037735, 36.86389049142599, 37.085008040070534, 37.8711732973655, 37.74632376929124, 38.382191875328616, 34.91713716710606, 34.70407740275064, 34.643542925516755, 34.316675956050545, 34.63577392945686, 35.01411479866752]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1421937024811909, "mean_inference_ms": 0.6946250773437909, "mean_action_processing_ms": 0.0956973578829008, "mean_env_wait_ms": 0.7963553654555835, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 525000, "timesteps_this_iter": 0, "agent_timesteps_total": 1575000, "timers": {"sample_time_ms": 11400.912, "sample_throughput": 438.561, "load_time_ms": 0.301, "load_throughput": 16611104.95, "learn_time_ms": 1944.031, "learn_throughput": 2571.976, "update_time_ms": 9.36}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.1359030627651386e-26, "cur_lr": 0.0005000000000000001, "total_loss": 6.600034618377686, "policy_loss": -0.001433285195615186, "vf_loss": 6.694514799118042, "vf_explained_var": -0.051282835006713864, "kl": 0.0024242007290290377, "entropy": 9.304675674438476, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 525000, "num_agent_steps_sampled": 1575000, "num_steps_trained": 525000, "num_agent_steps_trained": 1575000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1715, "training_iteration": 105, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-20-17", "timestamp": 1706232017, "time_this_iter_s": 10.78584599494934, "time_total_s": 1133.2230303287506, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D7B310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1133.2230303287506, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 6.379999999999999, "ram_util_percent": 61.040000000000006}}
{"episode_reward_max": 148.25369549915206, "episode_reward_min": -309.2508905529976, "episode_reward_mean": 99.98360579702101, "episode_len_mean": 495.77, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -108.00657002131145}, "policy_reward_max": {"shared_policy": 49.67916353916128}, "policy_reward_mean": {"shared_policy": 33.32786859900699}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.93514127284288, -309.2508905529976, 119.37222600542007, 113.06079946830869, 107.72759024798869, 99.54309203475711, 139.60211797803635, 125.64739840105175, 148.25369549915206, 113.23514244402757, 80.86607683077455, 78.649285197258, 86.4208042686805, 100.64306571334598, 100.34823737479745, 111.22384246066211, 107.11687130806966, 119.20149435102938, 121.3669506944716, 91.15438356623052, 92.88497583568096, 131.0428677070886, 54.74524153023957, 116.57935197651383, 115.83922268822788, 101.1746993511915, 123.03371224179861, 123.38845949247477, 118.98567909537812, 101.8691564053297, 123.25723772868514, 111.87923892063553, 95.40772074181587, 129.80343559756875, 106.78831003606317, 125.01603668634198, 74.81674330402164, 86.65465892106295, 104.10183823481199, 111.40402355045077, 81.72214992716908, 85.86638982780275, 31.82348692789671, 97.66370653361079, 92.94675292074679, 86.96767242532222, 122.53652790933846, 106.1820021001622, 100.94116247538477, 117.74740123748776, 103.61598575860262, 120.52502629533409, 144.33183007687322, 99.7386921979487, 100.44525986351071, 99.59547172486779, 113.0019856300205, 108.00115147698669, 86.4476985502988, 59.86966053396462, 143.28918143920595, 110.19766272976995, 110.54132325435056, 127.12956324964759, 120.4077593758702, 132.4619431197643, 15.72759150806813, 116.87038551829755, 104.8107192851603, 96.73228464554994, 98.78319065645337, 100.08317201584575, 89.13908489607275, 100.59406171832234, 116.78166082315147, 102.21243063546717, 114.89264739118515, 104.27214036136863, 90.10863341391085, 89.53176537901162, 58.453190267086, 121.97365961968899, 114.22639397531748, 57.96755185863002, 93.02504895627499, 128.1729917582124, 110.47033385187387, 113.99968894198535, 104.26475749537346, 103.96656468417493, 104.65206078393382, 93.87068014964458, 139.54353079944832, 90.23132711648938, 81.57169327326119, 118.66068703448397, 126.04548735171556, 77.99771507835247, 66.1452573237475, 114.79480896331367], "episode_lengths": [500, 77, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [43.660173433522374, 43.71443861971298, 43.5605292196075, -108.00657002131145, -100.72514487306277, -100.51917565862338, 39.707099092503384, 39.9935429499795, 39.67158396293719, 37.5877136439085, 37.78408976085484, 37.688996063545346, 35.75925311942895, 35.8561248977979, 36.11221223076184, 33.43940213570991, 33.28267496327558, 32.821014935771615, 46.32291530321041, 46.697512614230305, 46.58169006059566, 41.69905816515286, 42.12619322662552, 41.822147009273365, 49.67916353916128, 49.245755200584725, 49.328776759405926, 37.75577597514105, 37.74062823116158, 37.738738237724945, 26.937360011041164, 27.041930455714464, 26.886786364018917, 25.996324613690376, 26.245791919529438, 26.40716866403818, 28.88291941241671, 28.689755142976836, 28.84812971328695, 34.02844145024815, 33.84204491103688, 32.772579352060944, 33.53130034295221, 33.41093098868926, 33.40600604315598, 37.028435846169785, 37.6560503480335, 36.539356266458825, 35.792513624609754, 35.646670504783586, 35.67768717867632, 39.63391984750827, 39.818094958861664, 39.74947954465945, 40.461852218955755, 40.53497190028429, 40.37012657523155, 30.519981668641165, 30.265684021015957, 30.3687178765734, 31.00455991178751, 30.836901769042015, 31.043514154851437, 43.81597428396344, 43.89004558138549, 43.336847841739655, 18.40240717430909, 18.115521897872284, 18.227312458058194, 38.80883154521385, 38.858719329039246, 38.91180110226074, 38.91624252622326, 38.80437800039847, 38.11860216160615, 33.74251382549603, 33.6472449277838, 33.78494059791167, 40.96660232047239, 40.77767027417818, 41.28943964714804, 41.081112193564564, 41.23735673601428, 41.069990562895924, 39.286776820818574, 39.99965252021016, 39.69924975434938, 34.03245763480663, 33.877619594335556, 33.959079176187515, 41.10728280618787, 41.04444485157728, 41.10551007091999, 37.42297125731905, 37.48994582491771, 36.96632183839877, 31.411183267831802, 32.015779950656, 31.980757523328066, 43.1352604428927, 43.512155196319014, 43.15601995835701, 35.67318434516588, 35.76435456673303, 35.350771124164254, 41.2329485565424, 41.884575666161254, 41.898512463638326, 25.372143993464604, 25.20706944664319, 24.23752986391385, 29.01987986266613, 29.18219668418169, 28.452582374215126, 34.302019665638596, 34.869436773161084, 34.93038179601231, 36.87315847973028, 37.23436739544073, 37.29649767527977, 27.300244390964508, 27.261775963008404, 27.160129573196173, 29.01389912205437, 28.740547778705746, 28.111942927042634, 10.63854171584049, 10.744627161572367, 10.440318050483853, 32.47536291430393, 32.50488110880056, 32.6834625105063, 30.84455684324105, 30.794309755166367, 31.30788632233937, 29.15707356886317, 28.994844892372683, 28.81575396408637, 40.57403767605622, 40.98607350264986, 40.97641673063238, 35.80565575541307, 35.13565943141778, 35.240686913331345, 33.60197031497955, 33.42228186875582, 33.9169102916494, 38.98137299219766, 39.52214678625265, 39.24388145903745, 34.52014331519604, 34.61343494057655, 34.48240750283003, 40.21617607896526, 40.293236074348286, 40.01561414202054, 48.14083402603863, 48.0168873593211, 48.174108691513524, 33.51905806735158, 33.16896249353886, 33.05067163705826, 33.42378581811984, 33.818635232125715, 33.20283881326516, 33.16406042377153, 33.20304856697717, 33.22836273411909, 37.8513834644109, 37.49489664286375, 37.65570552274585, 36.227973467049495, 36.047613756110266, 35.72556425382693, 28.855671544869736, 28.668459465106324, 28.923567540322736, 20.278717448314026, 19.61900258560975, 19.971940500040844, 47.84499775866668, 47.539326290289566, 47.904857390249774, 36.68817402794957, 36.70969283208251, 36.79979586973786, 37.045957341634974, 36.63723055769999, 36.85813535501559, 42.488597745696694, 42.63197385023037, 42.00899165372053, 40.01990912357965, 40.17333024988571, 40.21452000240484, 44.05249747633934, 44.06456857174635, 44.34487707167864, 5.123891336222485, 5.46911345267047, 5.134586719175175, 39.065610855817795, 39.138243613764644, 38.666531048715115, 35.039569940418005, 34.4490909576416, 35.3220583871007, 32.66871047051002, 32.189567287762955, 31.874006887276963, 33.1939588971436, 32.75384131073952, 32.83539044857025, 33.36253174642721, 33.61463417361179, 33.10600609580675, 29.833983659744263, 29.565422043204308, 29.739679193124175, 33.70861135516316, 33.51800875365734, 33.36744160950184, 39.032213263213634, 39.373643374070525, 38.37580418586731, 34.28376969136298, 33.80789498984814, 34.12076595425606, 38.421020993342, 38.47195065704484, 37.99967574079831, 34.4042315284411, 34.92099547261992, 34.946913360307605, 30.069439982374504, 30.37481156488259, 29.664381866653756, 29.923061860104397, 29.760144149263695, 29.848559369643525, 19.41584078470865, 19.51690778012076, 19.52044170225659, 40.88056553155184, 40.76000828295946, 40.33308580517769, 38.28176026418805, 38.2655871398747, 37.67904657125473, 18.87627861400445, 19.564360065230474, 19.526913179395095, 30.697761967778206, 31.231342375278473, 31.095944613218307, 42.6861957485477, 42.53707073877254, 42.94972527089217, 36.52143532037735, 36.86389049142599, 37.085008040070534, 37.8711732973655, 37.74632376929124, 38.382191875328616, 34.91713716710606, 34.70407740275064, 34.643542925516755, 34.316675956050545, 34.63577392945686, 35.01411479866752, 35.11676961059371, 35.36823084779704, 34.167060325543076, 31.3413925046722, 30.940186748901993, 31.58910089607039, 46.552433398862675, 46.492862076809004, 46.4982353237768, 30.139524365464837, 29.940878624717385, 30.15092412630716, 26.81937827169895, 27.48081854917109, 27.271496452391148, 39.523420612017304, 39.82406111077094, 39.313205311695725, 42.232322834432125, 41.48603039979935, 42.32713411748409, 26.154181250739683, 25.859312915553645, 25.984220912059143, 21.974450916051865, 22.116541887400672, 22.054264520294964, 38.38997328716019, 38.17174757892886, 38.23308809722462]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14215315364423323, "mean_inference_ms": 0.6947263789605814, "mean_action_processing_ms": 0.0956780378103914, "mean_env_wait_ms": 0.7962498296292102, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 530000, "timesteps_this_iter": 0, "agent_timesteps_total": 1590000, "timers": {"sample_time_ms": 11385.373, "sample_throughput": 439.16, "load_time_ms": 0.402, "load_throughput": 12435673.624, "learn_time_ms": 1962.968, "learn_throughput": 2547.163, "update_time_ms": 9.454}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.0679515313825693e-26, "cur_lr": 0.0005000000000000001, "total_loss": 4.701585054397583, "policy_loss": -0.0013048410989235453, "vf_loss": 4.7974550247192385, "vf_explained_var": -0.006051099300384522, "kl": 0.0023270542384419557, "entropy": 9.45652208328247, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 530000, "num_agent_steps_sampled": 1590000, "num_steps_trained": 530000, "num_agent_steps_trained": 1590000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1725, "training_iteration": 106, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-20-28", "timestamp": 1706232028, "time_this_iter_s": 11.018990278244019, "time_total_s": 1144.2420206069946, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401AD8040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1144.2420206069946, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 7.36875, "ram_util_percent": 61.337500000000006}}
{"episode_reward_max": 144.33183007687322, "episode_reward_min": 15.72759150806813, "episode_reward_mean": 102.72867175271065, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 5.123891336222485}, "policy_reward_max": {"shared_policy": 48.174108691513524}, "policy_reward_mean": {"shared_policy": 34.242890584236875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.86607683077455, 78.649285197258, 86.4208042686805, 100.64306571334598, 100.34823737479745, 111.22384246066211, 107.11687130806966, 119.20149435102938, 121.3669506944716, 91.15438356623052, 92.88497583568096, 131.0428677070886, 54.74524153023957, 116.57935197651383, 115.83922268822788, 101.1746993511915, 123.03371224179861, 123.38845949247477, 118.98567909537812, 101.8691564053297, 123.25723772868514, 111.87923892063553, 95.40772074181587, 129.80343559756875, 106.78831003606317, 125.01603668634198, 74.81674330402164, 86.65465892106295, 104.10183823481199, 111.40402355045077, 81.72214992716908, 85.86638982780275, 31.82348692789671, 97.66370653361079, 92.94675292074679, 86.96767242532222, 122.53652790933846, 106.1820021001622, 100.94116247538477, 117.74740123748776, 103.61598575860262, 120.52502629533409, 144.33183007687322, 99.7386921979487, 100.44525986351071, 99.59547172486779, 113.0019856300205, 108.00115147698669, 86.4476985502988, 59.86966053396462, 143.28918143920595, 110.19766272976995, 110.54132325435056, 127.12956324964759, 120.4077593758702, 132.4619431197643, 15.72759150806813, 116.87038551829755, 104.8107192851603, 96.73228464554994, 98.78319065645337, 100.08317201584575, 89.13908489607275, 100.59406171832234, 116.78166082315147, 102.21243063546717, 114.89264739118515, 104.27214036136863, 90.10863341391085, 89.53176537901162, 58.453190267086, 121.97365961968899, 114.22639397531748, 57.96755185863002, 93.02504895627499, 128.1729917582124, 110.47033385187387, 113.99968894198535, 104.26475749537346, 103.96656468417493, 104.65206078393382, 93.87068014964458, 139.54353079944832, 90.23132711648938, 81.57169327326119, 118.66068703448397, 126.04548735171556, 77.99771507835247, 66.1452573237475, 114.79480896331367, 121.7045155391097, 136.474382225424, 132.82726107351468, 105.7117582336068, 104.0209114179015, 71.74001174420115, 98.92332440568134, 111.40406043827534, 80.80016220733523, 99.02652108250183], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [26.937360011041164, 27.041930455714464, 26.886786364018917, 25.996324613690376, 26.245791919529438, 26.40716866403818, 28.88291941241671, 28.689755142976836, 28.84812971328695, 34.02844145024815, 33.84204491103688, 32.772579352060944, 33.53130034295221, 33.41093098868926, 33.40600604315598, 37.028435846169785, 37.6560503480335, 36.539356266458825, 35.792513624609754, 35.646670504783586, 35.67768717867632, 39.63391984750827, 39.818094958861664, 39.74947954465945, 40.461852218955755, 40.53497190028429, 40.37012657523155, 30.519981668641165, 30.265684021015957, 30.3687178765734, 31.00455991178751, 30.836901769042015, 31.043514154851437, 43.81597428396344, 43.89004558138549, 43.336847841739655, 18.40240717430909, 18.115521897872284, 18.227312458058194, 38.80883154521385, 38.858719329039246, 38.91180110226074, 38.91624252622326, 38.80437800039847, 38.11860216160615, 33.74251382549603, 33.6472449277838, 33.78494059791167, 40.96660232047239, 40.77767027417818, 41.28943964714804, 41.081112193564564, 41.23735673601428, 41.069990562895924, 39.286776820818574, 39.99965252021016, 39.69924975434938, 34.03245763480663, 33.877619594335556, 33.959079176187515, 41.10728280618787, 41.04444485157728, 41.10551007091999, 37.42297125731905, 37.48994582491771, 36.96632183839877, 31.411183267831802, 32.015779950656, 31.980757523328066, 43.1352604428927, 43.512155196319014, 43.15601995835701, 35.67318434516588, 35.76435456673303, 35.350771124164254, 41.2329485565424, 41.884575666161254, 41.898512463638326, 25.372143993464604, 25.20706944664319, 24.23752986391385, 29.01987986266613, 29.18219668418169, 28.452582374215126, 34.302019665638596, 34.869436773161084, 34.93038179601231, 36.87315847973028, 37.23436739544073, 37.29649767527977, 27.300244390964508, 27.261775963008404, 27.160129573196173, 29.01389912205437, 28.740547778705746, 28.111942927042634, 10.63854171584049, 10.744627161572367, 10.440318050483853, 32.47536291430393, 32.50488110880056, 32.6834625105063, 30.84455684324105, 30.794309755166367, 31.30788632233937, 29.15707356886317, 28.994844892372683, 28.81575396408637, 40.57403767605622, 40.98607350264986, 40.97641673063238, 35.80565575541307, 35.13565943141778, 35.240686913331345, 33.60197031497955, 33.42228186875582, 33.9169102916494, 38.98137299219766, 39.52214678625265, 39.24388145903745, 34.52014331519604, 34.61343494057655, 34.48240750283003, 40.21617607896526, 40.293236074348286, 40.01561414202054, 48.14083402603863, 48.0168873593211, 48.174108691513524, 33.51905806735158, 33.16896249353886, 33.05067163705826, 33.42378581811984, 33.818635232125715, 33.20283881326516, 33.16406042377153, 33.20304856697717, 33.22836273411909, 37.8513834644109, 37.49489664286375, 37.65570552274585, 36.227973467049495, 36.047613756110266, 35.72556425382693, 28.855671544869736, 28.668459465106324, 28.923567540322736, 20.278717448314026, 19.61900258560975, 19.971940500040844, 47.84499775866668, 47.539326290289566, 47.904857390249774, 36.68817402794957, 36.70969283208251, 36.79979586973786, 37.045957341634974, 36.63723055769999, 36.85813535501559, 42.488597745696694, 42.63197385023037, 42.00899165372053, 40.01990912357965, 40.17333024988571, 40.21452000240484, 44.05249747633934, 44.06456857174635, 44.34487707167864, 5.123891336222485, 5.46911345267047, 5.134586719175175, 39.065610855817795, 39.138243613764644, 38.666531048715115, 35.039569940418005, 34.4490909576416, 35.3220583871007, 32.66871047051002, 32.189567287762955, 31.874006887276963, 33.1939588971436, 32.75384131073952, 32.83539044857025, 33.36253174642721, 33.61463417361179, 33.10600609580675, 29.833983659744263, 29.565422043204308, 29.739679193124175, 33.70861135516316, 33.51800875365734, 33.36744160950184, 39.032213263213634, 39.373643374070525, 38.37580418586731, 34.28376969136298, 33.80789498984814, 34.12076595425606, 38.421020993342, 38.47195065704484, 37.99967574079831, 34.4042315284411, 34.92099547261992, 34.946913360307605, 30.069439982374504, 30.37481156488259, 29.664381866653756, 29.923061860104397, 29.760144149263695, 29.848559369643525, 19.41584078470865, 19.51690778012076, 19.52044170225659, 40.88056553155184, 40.76000828295946, 40.33308580517769, 38.28176026418805, 38.2655871398747, 37.67904657125473, 18.87627861400445, 19.564360065230474, 19.526913179395095, 30.697761967778206, 31.231342375278473, 31.095944613218307, 42.6861957485477, 42.53707073877254, 42.94972527089217, 36.52143532037735, 36.86389049142599, 37.085008040070534, 37.8711732973655, 37.74632376929124, 38.382191875328616, 34.91713716710606, 34.70407740275064, 34.643542925516755, 34.316675956050545, 34.63577392945686, 35.01411479866752, 35.11676961059371, 35.36823084779704, 34.167060325543076, 31.3413925046722, 30.940186748901993, 31.58910089607039, 46.552433398862675, 46.492862076809004, 46.4982353237768, 30.139524365464837, 29.940878624717385, 30.15092412630716, 26.81937827169895, 27.48081854917109, 27.271496452391148, 39.523420612017304, 39.82406111077094, 39.313205311695725, 42.232322834432125, 41.48603039979935, 42.32713411748409, 26.154181250739683, 25.859312915553645, 25.984220912059143, 21.974450916051865, 22.116541887400672, 22.054264520294964, 38.38997328716019, 38.17174757892886, 38.23308809722462, 40.18735182285309, 40.70802666991949, 40.80913704633713, 45.314141164223344, 45.51928127805391, 45.64095978314677, 44.25069982558489, 44.28362999483943, 44.2929312530905, 35.32062975813945, 35.13551427175601, 35.255614203711346, 35.25266700734694, 34.00792886813481, 34.76031554241975, 24.140897984306008, 23.56208376089731, 24.037029998997838, 32.89730691537261, 33.1641100901179, 32.86190740019083, 37.284862875938416, 37.114532098174095, 37.00466546416283, 26.970849964767694, 26.697366923093796, 27.131945319473743, 32.86704463387528, 33.019718867416174, 33.139757581210375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14213189441160853, "mean_inference_ms": 0.6948280242924129, "mean_action_processing_ms": 0.09568446042868485, "mean_env_wait_ms": 0.796034498031021, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 535000, "timesteps_this_iter": 0, "agent_timesteps_total": 1605000, "timers": {"sample_time_ms": 11444.209, "sample_throughput": 436.902, "load_time_ms": 0.302, "load_throughput": 16554720.556, "learn_time_ms": 1976.584, "learn_throughput": 2529.617, "update_time_ms": 9.53}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0339757656912847e-26, "cur_lr": 0.0005000000000000001, "total_loss": 6.449943733215332, "policy_loss": -0.001731459789501244, "vf_loss": 6.546233749389648, "vf_explained_var": -0.027834582328796386, "kl": 0.0019750083942493683, "entropy": 9.45586338043213, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 535000, "num_agent_steps_sampled": 1605000, "num_steps_trained": 535000, "num_agent_steps_trained": 1605000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1735, "training_iteration": 107, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-20-39", "timestamp": 1706232039, "time_this_iter_s": 10.747108697891235, "time_total_s": 1154.9891293048859, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D105E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1154.9891293048859, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 8.373333333333333, "ram_util_percent": 61.720000000000006}}
{"episode_reward_max": 144.33183007687322, "episode_reward_min": -250.6191208567471, "episode_reward_mean": 100.4526348329222, "episode_len_mean": 497.83, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -84.08922119935355}, "policy_reward_max": {"shared_policy": 48.174108691513524}, "policy_reward_mean": {"shared_policy": 33.48421161097405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [131.0428677070886, 54.74524153023957, 116.57935197651383, 115.83922268822788, 101.1746993511915, 123.03371224179861, 123.38845949247477, 118.98567909537812, 101.8691564053297, 123.25723772868514, 111.87923892063553, 95.40772074181587, 129.80343559756875, 106.78831003606317, 125.01603668634198, 74.81674330402164, 86.65465892106295, 104.10183823481199, 111.40402355045077, 81.72214992716908, 85.86638982780275, 31.82348692789671, 97.66370653361079, 92.94675292074679, 86.96767242532222, 122.53652790933846, 106.1820021001622, 100.94116247538477, 117.74740123748776, 103.61598575860262, 120.52502629533409, 144.33183007687322, 99.7386921979487, 100.44525986351071, 99.59547172486779, 113.0019856300205, 108.00115147698669, 86.4476985502988, 59.86966053396462, 143.28918143920595, 110.19766272976995, 110.54132325435056, 127.12956324964759, 120.4077593758702, 132.4619431197643, 15.72759150806813, 116.87038551829755, 104.8107192851603, 96.73228464554994, 98.78319065645337, 100.08317201584575, 89.13908489607275, 100.59406171832234, 116.78166082315147, 102.21243063546717, 114.89264739118515, 104.27214036136863, 90.10863341391085, 89.53176537901162, 58.453190267086, 121.97365961968899, 114.22639397531748, 57.96755185863002, 93.02504895627499, 128.1729917582124, 110.47033385187387, 113.99968894198535, 104.26475749537346, 103.96656468417493, 104.65206078393382, 93.87068014964458, 139.54353079944832, 90.23132711648938, 81.57169327326119, 118.66068703448397, 126.04548735171556, 77.99771507835247, 66.1452573237475, 114.79480896331367, 121.7045155391097, 136.474382225424, 132.82726107351468, 105.7117582336068, 104.0209114179015, 71.74001174420115, 98.92332440568134, 111.40406043827534, 80.80016220733523, 99.02652108250183, 115.98571495339274, -250.6191208567471, 115.05467518605289, 131.14792213030154, 107.23972032498567, 112.02901381906119, 114.97778162732719, 89.26317152939735, 107.004030380398, 109.10753984376788, 111.08184668421744], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 283, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [43.81597428396344, 43.89004558138549, 43.336847841739655, 18.40240717430909, 18.115521897872284, 18.227312458058194, 38.80883154521385, 38.858719329039246, 38.91180110226074, 38.91624252622326, 38.80437800039847, 38.11860216160615, 33.74251382549603, 33.6472449277838, 33.78494059791167, 40.96660232047239, 40.77767027417818, 41.28943964714804, 41.081112193564564, 41.23735673601428, 41.069990562895924, 39.286776820818574, 39.99965252021016, 39.69924975434938, 34.03245763480663, 33.877619594335556, 33.959079176187515, 41.10728280618787, 41.04444485157728, 41.10551007091999, 37.42297125731905, 37.48994582491771, 36.96632183839877, 31.411183267831802, 32.015779950656, 31.980757523328066, 43.1352604428927, 43.512155196319014, 43.15601995835701, 35.67318434516588, 35.76435456673303, 35.350771124164254, 41.2329485565424, 41.884575666161254, 41.898512463638326, 25.372143993464604, 25.20706944664319, 24.23752986391385, 29.01987986266613, 29.18219668418169, 28.452582374215126, 34.302019665638596, 34.869436773161084, 34.93038179601231, 36.87315847973028, 37.23436739544073, 37.29649767527977, 27.300244390964508, 27.261775963008404, 27.160129573196173, 29.01389912205437, 28.740547778705746, 28.111942927042634, 10.63854171584049, 10.744627161572367, 10.440318050483853, 32.47536291430393, 32.50488110880056, 32.6834625105063, 30.84455684324105, 30.794309755166367, 31.30788632233937, 29.15707356886317, 28.994844892372683, 28.81575396408637, 40.57403767605622, 40.98607350264986, 40.97641673063238, 35.80565575541307, 35.13565943141778, 35.240686913331345, 33.60197031497955, 33.42228186875582, 33.9169102916494, 38.98137299219766, 39.52214678625265, 39.24388145903745, 34.52014331519604, 34.61343494057655, 34.48240750283003, 40.21617607896526, 40.293236074348286, 40.01561414202054, 48.14083402603863, 48.0168873593211, 48.174108691513524, 33.51905806735158, 33.16896249353886, 33.05067163705826, 33.42378581811984, 33.818635232125715, 33.20283881326516, 33.16406042377153, 33.20304856697717, 33.22836273411909, 37.8513834644109, 37.49489664286375, 37.65570552274585, 36.227973467049495, 36.047613756110266, 35.72556425382693, 28.855671544869736, 28.668459465106324, 28.923567540322736, 20.278717448314026, 19.61900258560975, 19.971940500040844, 47.84499775866668, 47.539326290289566, 47.904857390249774, 36.68817402794957, 36.70969283208251, 36.79979586973786, 37.045957341634974, 36.63723055769999, 36.85813535501559, 42.488597745696694, 42.63197385023037, 42.00899165372053, 40.01990912357965, 40.17333024988571, 40.21452000240484, 44.05249747633934, 44.06456857174635, 44.34487707167864, 5.123891336222485, 5.46911345267047, 5.134586719175175, 39.065610855817795, 39.138243613764644, 38.666531048715115, 35.039569940418005, 34.4490909576416, 35.3220583871007, 32.66871047051002, 32.189567287762955, 31.874006887276963, 33.1939588971436, 32.75384131073952, 32.83539044857025, 33.36253174642721, 33.61463417361179, 33.10600609580675, 29.833983659744263, 29.565422043204308, 29.739679193124175, 33.70861135516316, 33.51800875365734, 33.36744160950184, 39.032213263213634, 39.373643374070525, 38.37580418586731, 34.28376969136298, 33.80789498984814, 34.12076595425606, 38.421020993342, 38.47195065704484, 37.99967574079831, 34.4042315284411, 34.92099547261992, 34.946913360307605, 30.069439982374504, 30.37481156488259, 29.664381866653756, 29.923061860104397, 29.760144149263695, 29.848559369643525, 19.41584078470865, 19.51690778012076, 19.52044170225659, 40.88056553155184, 40.76000828295946, 40.33308580517769, 38.28176026418805, 38.2655871398747, 37.67904657125473, 18.87627861400445, 19.564360065230474, 19.526913179395095, 30.697761967778206, 31.231342375278473, 31.095944613218307, 42.6861957485477, 42.53707073877254, 42.94972527089217, 36.52143532037735, 36.86389049142599, 37.085008040070534, 37.8711732973655, 37.74632376929124, 38.382191875328616, 34.91713716710606, 34.70407740275064, 34.643542925516755, 34.316675956050545, 34.63577392945686, 35.01411479866752, 35.11676961059371, 35.36823084779704, 34.167060325543076, 31.3413925046722, 30.940186748901993, 31.58910089607039, 46.552433398862675, 46.492862076809004, 46.4982353237768, 30.139524365464837, 29.940878624717385, 30.15092412630716, 26.81937827169895, 27.48081854917109, 27.271496452391148, 39.523420612017304, 39.82406111077094, 39.313205311695725, 42.232322834432125, 41.48603039979935, 42.32713411748409, 26.154181250739683, 25.859312915553645, 25.984220912059143, 21.974450916051865, 22.116541887400672, 22.054264520294964, 38.38997328716019, 38.17174757892886, 38.23308809722462, 40.18735182285309, 40.70802666991949, 40.80913704633713, 45.314141164223344, 45.51928127805391, 45.64095978314677, 44.25069982558489, 44.28362999483943, 44.2929312530905, 35.32062975813945, 35.13551427175601, 35.255614203711346, 35.25266700734694, 34.00792886813481, 34.76031554241975, 24.140897984306008, 23.56208376089731, 24.037029998997838, 32.89730691537261, 33.1641100901179, 32.86190740019083, 37.284862875938416, 37.114532098174095, 37.00466546416283, 26.970849964767694, 26.697366923093796, 27.131945319473743, 32.86704463387528, 33.019718867416174, 33.139757581210375, 38.79109409078956, 38.843506187200546, 38.35111467540264, -83.25334126067659, -83.27655839671692, -84.08922119935355, 38.658883277947695, 38.307016039888055, 38.08877586821714, 43.46753379702568, 44.03092968650162, 43.64945864677429, 35.4750473399957, 35.98508308858921, 35.779589896400765, 37.23958758140603, 37.294266926745564, 37.4951593109096, 37.99226174255212, 38.454535865535334, 38.53098401923974, 29.5968408336242, 29.818782425795987, 29.847548269977167, 35.8921801286439, 35.56635958949724, 35.54549066225687, 36.43837652914226, 36.22208119183779, 36.44708212278783, 37.22384515901406, 37.063640390833214, 36.79436113437016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14212015301136202, "mean_inference_ms": 0.6949073900130119, "mean_action_processing_ms": 0.09568358805785417, "mean_env_wait_ms": 0.7958764789252273, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 540000, "timesteps_this_iter": 0, "agent_timesteps_total": 1620000, "timers": {"sample_time_ms": 11493.563, "sample_throughput": 435.026, "load_time_ms": 0.201, "load_throughput": 24862501.482, "learn_time_ms": 1992.13, "learn_throughput": 2509.877, "update_time_ms": 9.536}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.169878828456423e-27, "cur_lr": 0.0005000000000000001, "total_loss": 118.72734375, "policy_loss": -0.001499790385967792, "vf_loss": 118.82296295166016, "vf_explained_var": -0.0009250879287719726, "kl": 0.004727396625123892, "entropy": 9.411937427520751, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 540000, "num_agent_steps_sampled": 1620000, "num_steps_trained": 540000, "num_agent_steps_trained": 1620000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1746, "training_iteration": 108, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-20-50", "timestamp": 1706232050, "time_this_iter_s": 10.671790599822998, "time_total_s": 1165.6609199047089, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140239EEE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1165.6609199047089, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 7.820000000000001, "ram_util_percent": 61.49333333333333}}
{"episode_reward_max": 148.64132218062858, "episode_reward_min": -250.6191208567471, "episode_reward_mean": 99.97663040395622, "episode_len_mean": 497.83, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -84.08922119935355}, "policy_reward_max": {"shared_policy": 49.669866338372216}, "policy_reward_mean": {"shared_policy": 33.3255434679854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [111.87923892063553, 95.40772074181587, 129.80343559756875, 106.78831003606317, 125.01603668634198, 74.81674330402164, 86.65465892106295, 104.10183823481199, 111.40402355045077, 81.72214992716908, 85.86638982780275, 31.82348692789671, 97.66370653361079, 92.94675292074679, 86.96767242532222, 122.53652790933846, 106.1820021001622, 100.94116247538477, 117.74740123748776, 103.61598575860262, 120.52502629533409, 144.33183007687322, 99.7386921979487, 100.44525986351071, 99.59547172486779, 113.0019856300205, 108.00115147698669, 86.4476985502988, 59.86966053396462, 143.28918143920595, 110.19766272976995, 110.54132325435056, 127.12956324964759, 120.4077593758702, 132.4619431197643, 15.72759150806813, 116.87038551829755, 104.8107192851603, 96.73228464554994, 98.78319065645337, 100.08317201584575, 89.13908489607275, 100.59406171832234, 116.78166082315147, 102.21243063546717, 114.89264739118515, 104.27214036136863, 90.10863341391085, 89.53176537901162, 58.453190267086, 121.97365961968899, 114.22639397531748, 57.96755185863002, 93.02504895627499, 128.1729917582124, 110.47033385187387, 113.99968894198535, 104.26475749537346, 103.96656468417493, 104.65206078393382, 93.87068014964458, 139.54353079944832, 90.23132711648938, 81.57169327326119, 118.66068703448397, 126.04548735171556, 77.99771507835247, 66.1452573237475, 114.79480896331367, 121.7045155391097, 136.474382225424, 132.82726107351468, 105.7117582336068, 104.0209114179015, 71.74001174420115, 98.92332440568134, 111.40406043827534, 80.80016220733523, 99.02652108250183, 115.98571495339274, -250.6191208567471, 115.05467518605289, 131.14792213030154, 107.23972032498567, 112.02901381906119, 114.97778162732719, 89.26317152939735, 107.004030380398, 109.10753984376788, 111.08184668421744, 65.233630515635, 106.22938752570187, 93.79522165330125, 108.76141992956397, 110.33588614687322, 123.32730812579393, 89.55198815464973, 98.94832054898143, 117.49070053920147, 148.64132218062858], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 283, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [37.42297125731905, 37.48994582491771, 36.96632183839877, 31.411183267831802, 32.015779950656, 31.980757523328066, 43.1352604428927, 43.512155196319014, 43.15601995835701, 35.67318434516588, 35.76435456673303, 35.350771124164254, 41.2329485565424, 41.884575666161254, 41.898512463638326, 25.372143993464604, 25.20706944664319, 24.23752986391385, 29.01987986266613, 29.18219668418169, 28.452582374215126, 34.302019665638596, 34.869436773161084, 34.93038179601231, 36.87315847973028, 37.23436739544073, 37.29649767527977, 27.300244390964508, 27.261775963008404, 27.160129573196173, 29.01389912205437, 28.740547778705746, 28.111942927042634, 10.63854171584049, 10.744627161572367, 10.440318050483853, 32.47536291430393, 32.50488110880056, 32.6834625105063, 30.84455684324105, 30.794309755166367, 31.30788632233937, 29.15707356886317, 28.994844892372683, 28.81575396408637, 40.57403767605622, 40.98607350264986, 40.97641673063238, 35.80565575541307, 35.13565943141778, 35.240686913331345, 33.60197031497955, 33.42228186875582, 33.9169102916494, 38.98137299219766, 39.52214678625265, 39.24388145903745, 34.52014331519604, 34.61343494057655, 34.48240750283003, 40.21617607896526, 40.293236074348286, 40.01561414202054, 48.14083402603863, 48.0168873593211, 48.174108691513524, 33.51905806735158, 33.16896249353886, 33.05067163705826, 33.42378581811984, 33.818635232125715, 33.20283881326516, 33.16406042377153, 33.20304856697717, 33.22836273411909, 37.8513834644109, 37.49489664286375, 37.65570552274585, 36.227973467049495, 36.047613756110266, 35.72556425382693, 28.855671544869736, 28.668459465106324, 28.923567540322736, 20.278717448314026, 19.61900258560975, 19.971940500040844, 47.84499775866668, 47.539326290289566, 47.904857390249774, 36.68817402794957, 36.70969283208251, 36.79979586973786, 37.045957341634974, 36.63723055769999, 36.85813535501559, 42.488597745696694, 42.63197385023037, 42.00899165372053, 40.01990912357965, 40.17333024988571, 40.21452000240484, 44.05249747633934, 44.06456857174635, 44.34487707167864, 5.123891336222485, 5.46911345267047, 5.134586719175175, 39.065610855817795, 39.138243613764644, 38.666531048715115, 35.039569940418005, 34.4490909576416, 35.3220583871007, 32.66871047051002, 32.189567287762955, 31.874006887276963, 33.1939588971436, 32.75384131073952, 32.83539044857025, 33.36253174642721, 33.61463417361179, 33.10600609580675, 29.833983659744263, 29.565422043204308, 29.739679193124175, 33.70861135516316, 33.51800875365734, 33.36744160950184, 39.032213263213634, 39.373643374070525, 38.37580418586731, 34.28376969136298, 33.80789498984814, 34.12076595425606, 38.421020993342, 38.47195065704484, 37.99967574079831, 34.4042315284411, 34.92099547261992, 34.946913360307605, 30.069439982374504, 30.37481156488259, 29.664381866653756, 29.923061860104397, 29.760144149263695, 29.848559369643525, 19.41584078470865, 19.51690778012076, 19.52044170225659, 40.88056553155184, 40.76000828295946, 40.33308580517769, 38.28176026418805, 38.2655871398747, 37.67904657125473, 18.87627861400445, 19.564360065230474, 19.526913179395095, 30.697761967778206, 31.231342375278473, 31.095944613218307, 42.6861957485477, 42.53707073877254, 42.94972527089217, 36.52143532037735, 36.86389049142599, 37.085008040070534, 37.8711732973655, 37.74632376929124, 38.382191875328616, 34.91713716710606, 34.70407740275064, 34.643542925516755, 34.316675956050545, 34.63577392945686, 35.01411479866752, 35.11676961059371, 35.36823084779704, 34.167060325543076, 31.3413925046722, 30.940186748901993, 31.58910089607039, 46.552433398862675, 46.492862076809004, 46.4982353237768, 30.139524365464837, 29.940878624717385, 30.15092412630716, 26.81937827169895, 27.48081854917109, 27.271496452391148, 39.523420612017304, 39.82406111077094, 39.313205311695725, 42.232322834432125, 41.48603039979935, 42.32713411748409, 26.154181250739683, 25.859312915553645, 25.984220912059143, 21.974450916051865, 22.116541887400672, 22.054264520294964, 38.38997328716019, 38.17174757892886, 38.23308809722462, 40.18735182285309, 40.70802666991949, 40.80913704633713, 45.314141164223344, 45.51928127805391, 45.64095978314677, 44.25069982558489, 44.28362999483943, 44.2929312530905, 35.32062975813945, 35.13551427175601, 35.255614203711346, 35.25266700734694, 34.00792886813481, 34.76031554241975, 24.140897984306008, 23.56208376089731, 24.037029998997838, 32.89730691537261, 33.1641100901179, 32.86190740019083, 37.284862875938416, 37.114532098174095, 37.00466546416283, 26.970849964767694, 26.697366923093796, 27.131945319473743, 32.86704463387528, 33.019718867416174, 33.139757581210375, 38.79109409078956, 38.843506187200546, 38.35111467540264, -83.25334126067659, -83.27655839671692, -84.08922119935355, 38.658883277947695, 38.307016039888055, 38.08877586821714, 43.46753379702568, 44.03092968650162, 43.64945864677429, 35.4750473399957, 35.98508308858921, 35.779589896400765, 37.23958758140603, 37.294266926745564, 37.4951593109096, 37.99226174255212, 38.454535865535334, 38.53098401923974, 29.5968408336242, 29.818782425795987, 29.847548269977167, 35.8921801286439, 35.56635958949724, 35.54549066225687, 36.43837652914226, 36.22208119183779, 36.44708212278783, 37.22384515901406, 37.063640390833214, 36.79436113437016, 21.635524002214268, 21.579784793158368, 22.018321720262364, 35.13350591311851, 35.62796445462541, 35.46791715795794, 31.709487477162227, 30.954168577988938, 31.13156559815009, 36.318037713567406, 36.0709126467506, 36.372469569245965, 36.886302178104714, 36.61197783549626, 36.837606133272246, 41.15881885588169, 41.466107435524464, 40.70238183438778, 30.004794977605343, 29.636351734399796, 29.910841442644596, 33.05286693945527, 32.86921040713787, 33.02624320238829, 39.381255271534116, 38.63116445640722, 39.478280811260134, 49.669866338372216, 49.43063352257012, 49.5408223196864]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14211169306224367, "mean_inference_ms": 0.6950365061350183, "mean_action_processing_ms": 0.09568235471427293, "mean_env_wait_ms": 0.7958047315178183, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 545000, "timesteps_this_iter": 0, "agent_timesteps_total": 1635000, "timers": {"sample_time_ms": 11560.082, "sample_throughput": 432.523, "load_time_ms": 0.301, "load_throughput": 16607158.695, "learn_time_ms": 2008.396, "learn_throughput": 2489.548, "update_time_ms": 9.557}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.5849394142282116e-27, "cur_lr": 0.0005000000000000001, "total_loss": 4.337507963180542, "policy_loss": -0.0017309115262407193, "vf_loss": 4.434475374221802, "vf_explained_var": -0.01572169065475464, "kl": 0.00214953067773771, "entropy": 9.523647689819336, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 545000, "num_agent_steps_sampled": 1635000, "num_steps_trained": 545000, "num_agent_steps_trained": 1635000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1756, "training_iteration": 109, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-21-01", "timestamp": 1706232061, "time_this_iter_s": 10.824122428894043, "time_total_s": 1176.485042333603, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D10820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1176.485042333603, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 7.726666666666668, "ram_util_percent": 61.49999999999999}}
{"episode_reward_max": 148.64132218062858, "episode_reward_min": -264.16883944347506, "episode_reward_mean": 96.00804785309765, "episode_len_mean": 494.68, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -94.30338052039346}, "policy_reward_max": {"shared_policy": 49.669866338372216}, "policy_reward_mean": {"shared_policy": 32.002682617699215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.86638982780275, 31.82348692789671, 97.66370653361079, 92.94675292074679, 86.96767242532222, 122.53652790933846, 106.1820021001622, 100.94116247538477, 117.74740123748776, 103.61598575860262, 120.52502629533409, 144.33183007687322, 99.7386921979487, 100.44525986351071, 99.59547172486779, 113.0019856300205, 108.00115147698669, 86.4476985502988, 59.86966053396462, 143.28918143920595, 110.19766272976995, 110.54132325435056, 127.12956324964759, 120.4077593758702, 132.4619431197643, 15.72759150806813, 116.87038551829755, 104.8107192851603, 96.73228464554994, 98.78319065645337, 100.08317201584575, 89.13908489607275, 100.59406171832234, 116.78166082315147, 102.21243063546717, 114.89264739118515, 104.27214036136863, 90.10863341391085, 89.53176537901162, 58.453190267086, 121.97365961968899, 114.22639397531748, 57.96755185863002, 93.02504895627499, 128.1729917582124, 110.47033385187387, 113.99968894198535, 104.26475749537346, 103.96656468417493, 104.65206078393382, 93.87068014964458, 139.54353079944832, 90.23132711648938, 81.57169327326119, 118.66068703448397, 126.04548735171556, 77.99771507835247, 66.1452573237475, 114.79480896331367, 121.7045155391097, 136.474382225424, 132.82726107351468, 105.7117582336068, 104.0209114179015, 71.74001174420115, 98.92332440568134, 111.40406043827534, 80.80016220733523, 99.02652108250183, 115.98571495339274, -250.6191208567471, 115.05467518605289, 131.14792213030154, 107.23972032498567, 112.02901381906119, 114.97778162732719, 89.26317152939735, 107.004030380398, 109.10753984376788, 111.08184668421744, 65.233630515635, 106.22938752570187, 93.79522165330125, 108.76141992956397, 110.33588614687322, 123.32730812579393, 89.55198815464973, 98.94832054898143, 117.49070053920147, 148.64132218062858, 117.13694065436721, 104.63271148724014, 89.24749314738436, 93.18435022234917, 100.86699252948165, -264.16883944347506, 78.19610586762425, 80.76846347749232, 101.28245244920254, 129.58923044241968], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 283, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 185, 500, 500, 500, 500], "policy_shared_policy_reward": [29.01389912205437, 28.740547778705746, 28.111942927042634, 10.63854171584049, 10.744627161572367, 10.440318050483853, 32.47536291430393, 32.50488110880056, 32.6834625105063, 30.84455684324105, 30.794309755166367, 31.30788632233937, 29.15707356886317, 28.994844892372683, 28.81575396408637, 40.57403767605622, 40.98607350264986, 40.97641673063238, 35.80565575541307, 35.13565943141778, 35.240686913331345, 33.60197031497955, 33.42228186875582, 33.9169102916494, 38.98137299219766, 39.52214678625265, 39.24388145903745, 34.52014331519604, 34.61343494057655, 34.48240750283003, 40.21617607896526, 40.293236074348286, 40.01561414202054, 48.14083402603863, 48.0168873593211, 48.174108691513524, 33.51905806735158, 33.16896249353886, 33.05067163705826, 33.42378581811984, 33.818635232125715, 33.20283881326516, 33.16406042377153, 33.20304856697717, 33.22836273411909, 37.8513834644109, 37.49489664286375, 37.65570552274585, 36.227973467049495, 36.047613756110266, 35.72556425382693, 28.855671544869736, 28.668459465106324, 28.923567540322736, 20.278717448314026, 19.61900258560975, 19.971940500040844, 47.84499775866668, 47.539326290289566, 47.904857390249774, 36.68817402794957, 36.70969283208251, 36.79979586973786, 37.045957341634974, 36.63723055769999, 36.85813535501559, 42.488597745696694, 42.63197385023037, 42.00899165372053, 40.01990912357965, 40.17333024988571, 40.21452000240484, 44.05249747633934, 44.06456857174635, 44.34487707167864, 5.123891336222485, 5.46911345267047, 5.134586719175175, 39.065610855817795, 39.138243613764644, 38.666531048715115, 35.039569940418005, 34.4490909576416, 35.3220583871007, 32.66871047051002, 32.189567287762955, 31.874006887276963, 33.1939588971436, 32.75384131073952, 32.83539044857025, 33.36253174642721, 33.61463417361179, 33.10600609580675, 29.833983659744263, 29.565422043204308, 29.739679193124175, 33.70861135516316, 33.51800875365734, 33.36744160950184, 39.032213263213634, 39.373643374070525, 38.37580418586731, 34.28376969136298, 33.80789498984814, 34.12076595425606, 38.421020993342, 38.47195065704484, 37.99967574079831, 34.4042315284411, 34.92099547261992, 34.946913360307605, 30.069439982374504, 30.37481156488259, 29.664381866653756, 29.923061860104397, 29.760144149263695, 29.848559369643525, 19.41584078470865, 19.51690778012076, 19.52044170225659, 40.88056553155184, 40.76000828295946, 40.33308580517769, 38.28176026418805, 38.2655871398747, 37.67904657125473, 18.87627861400445, 19.564360065230474, 19.526913179395095, 30.697761967778206, 31.231342375278473, 31.095944613218307, 42.6861957485477, 42.53707073877254, 42.94972527089217, 36.52143532037735, 36.86389049142599, 37.085008040070534, 37.8711732973655, 37.74632376929124, 38.382191875328616, 34.91713716710606, 34.70407740275064, 34.643542925516755, 34.316675956050545, 34.63577392945686, 35.01411479866752, 35.11676961059371, 35.36823084779704, 34.167060325543076, 31.3413925046722, 30.940186748901993, 31.58910089607039, 46.552433398862675, 46.492862076809004, 46.4982353237768, 30.139524365464837, 29.940878624717385, 30.15092412630716, 26.81937827169895, 27.48081854917109, 27.271496452391148, 39.523420612017304, 39.82406111077094, 39.313205311695725, 42.232322834432125, 41.48603039979935, 42.32713411748409, 26.154181250739683, 25.859312915553645, 25.984220912059143, 21.974450916051865, 22.116541887400672, 22.054264520294964, 38.38997328716019, 38.17174757892886, 38.23308809722462, 40.18735182285309, 40.70802666991949, 40.80913704633713, 45.314141164223344, 45.51928127805391, 45.64095978314677, 44.25069982558489, 44.28362999483943, 44.2929312530905, 35.32062975813945, 35.13551427175601, 35.255614203711346, 35.25266700734694, 34.00792886813481, 34.76031554241975, 24.140897984306008, 23.56208376089731, 24.037029998997838, 32.89730691537261, 33.1641100901179, 32.86190740019083, 37.284862875938416, 37.114532098174095, 37.00466546416283, 26.970849964767694, 26.697366923093796, 27.131945319473743, 32.86704463387528, 33.019718867416174, 33.139757581210375, 38.79109409078956, 38.843506187200546, 38.35111467540264, -83.25334126067659, -83.27655839671692, -84.08922119935355, 38.658883277947695, 38.307016039888055, 38.08877586821714, 43.46753379702568, 44.03092968650162, 43.64945864677429, 35.4750473399957, 35.98508308858921, 35.779589896400765, 37.23958758140603, 37.294266926745564, 37.4951593109096, 37.99226174255212, 38.454535865535334, 38.53098401923974, 29.5968408336242, 29.818782425795987, 29.847548269977167, 35.8921801286439, 35.56635958949724, 35.54549066225687, 36.43837652914226, 36.22208119183779, 36.44708212278783, 37.22384515901406, 37.063640390833214, 36.79436113437016, 21.635524002214268, 21.579784793158368, 22.018321720262364, 35.13350591311851, 35.62796445462541, 35.46791715795794, 31.709487477162227, 30.954168577988938, 31.13156559815009, 36.318037713567406, 36.0709126467506, 36.372469569245965, 36.886302178104714, 36.61197783549626, 36.837606133272246, 41.15881885588169, 41.466107435524464, 40.70238183438778, 30.004794977605343, 29.636351734399796, 29.910841442644596, 33.05286693945527, 32.86921040713787, 33.02624320238829, 39.381255271534116, 38.63116445640722, 39.478280811260134, 49.669866338372216, 49.43063352257012, 49.5408223196864, 39.18703180924058, 38.90392455458641, 39.04598429054022, 35.03954701470987, 34.739648317297295, 34.85351615523298, 29.48931313802798, 29.91701215024416, 29.84116785911222, 31.34519673138857, 31.317152746021748, 30.52200074493885, 33.85499018244445, 33.90791471116245, 33.10408763587475, -84.17332592358193, -85.69213299949965, -94.30338052039346, 26.075471019993216, 26.123348506788403, 25.997286340842635, 26.652404521902398, 27.010198948283985, 27.105860007305935, 33.982363011687994, 33.38800190389156, 33.91208753362298, 43.30063085878888, 43.49082806023458, 42.797771523396165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14211602753710822, "mean_inference_ms": 0.6951965126310118, "mean_action_processing_ms": 0.09568592238564574, "mean_env_wait_ms": 0.7957777298920806, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 550000, "timesteps_this_iter": 0, "agent_timesteps_total": 1650000, "timers": {"sample_time_ms": 11623.912, "sample_throughput": 430.148, "load_time_ms": 0.301, "load_throughput": 16607158.695, "learn_time_ms": 2015.521, "learn_throughput": 2480.749, "update_time_ms": 9.457}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2924697071141058e-27, "cur_lr": 0.0005000000000000001, "total_loss": 98.20510711669922, "policy_loss": -0.0008454391698069719, "vf_loss": 98.30208435058594, "vf_explained_var": -0.006543302536010742, "kl": 0.007767245243334274, "entropy": 9.613015937805176, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 550000, "num_agent_steps_sampled": 1650000, "num_steps_trained": 550000, "num_agent_steps_trained": 1650000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1766, "training_iteration": 110, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-21-12", "timestamp": 1706232072, "time_this_iter_s": 10.690868854522705, "time_total_s": 1187.1759111881256, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402DE5F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1187.1759111881256, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 7.379999999999999, "ram_util_percent": 61.38666666666665}}
{"episode_reward_max": 148.64132218062858, "episode_reward_min": -264.16883944347506, "episode_reward_mean": 96.47476916988802, "episode_len_mean": 494.68, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -94.30338052039346}, "policy_reward_max": {"shared_policy": 49.669866338372216}, "policy_reward_mean": {"shared_policy": 32.158256389962666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.52502629533409, 144.33183007687322, 99.7386921979487, 100.44525986351071, 99.59547172486779, 113.0019856300205, 108.00115147698669, 86.4476985502988, 59.86966053396462, 143.28918143920595, 110.19766272976995, 110.54132325435056, 127.12956324964759, 120.4077593758702, 132.4619431197643, 15.72759150806813, 116.87038551829755, 104.8107192851603, 96.73228464554994, 98.78319065645337, 100.08317201584575, 89.13908489607275, 100.59406171832234, 116.78166082315147, 102.21243063546717, 114.89264739118515, 104.27214036136863, 90.10863341391085, 89.53176537901162, 58.453190267086, 121.97365961968899, 114.22639397531748, 57.96755185863002, 93.02504895627499, 128.1729917582124, 110.47033385187387, 113.99968894198535, 104.26475749537346, 103.96656468417493, 104.65206078393382, 93.87068014964458, 139.54353079944832, 90.23132711648938, 81.57169327326119, 118.66068703448397, 126.04548735171556, 77.99771507835247, 66.1452573237475, 114.79480896331367, 121.7045155391097, 136.474382225424, 132.82726107351468, 105.7117582336068, 104.0209114179015, 71.74001174420115, 98.92332440568134, 111.40406043827534, 80.80016220733523, 99.02652108250183, 115.98571495339274, -250.6191208567471, 115.05467518605289, 131.14792213030154, 107.23972032498567, 112.02901381906119, 114.97778162732719, 89.26317152939735, 107.004030380398, 109.10753984376788, 111.08184668421744, 65.233630515635, 106.22938752570187, 93.79522165330125, 108.76141992956397, 110.33588614687322, 123.32730812579393, 89.55198815464973, 98.94832054898143, 117.49070053920147, 148.64132218062858, 117.13694065436721, 104.63271148724014, 89.24749314738436, 93.18435022234917, 100.86699252948165, -264.16883944347506, 78.19610586762425, 80.76846347749232, 101.28245244920254, 129.58923044241968, 87.51618611533195, 79.04996551387012, 121.02721900913454, 96.62256348505616, 103.82122686505318, 69.71717143664135, 114.84529135935007, 115.05388746783136, 82.66610598191616, 122.64360256120563], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 283, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 185, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [40.21617607896526, 40.293236074348286, 40.01561414202054, 48.14083402603863, 48.0168873593211, 48.174108691513524, 33.51905806735158, 33.16896249353886, 33.05067163705826, 33.42378581811984, 33.818635232125715, 33.20283881326516, 33.16406042377153, 33.20304856697717, 33.22836273411909, 37.8513834644109, 37.49489664286375, 37.65570552274585, 36.227973467049495, 36.047613756110266, 35.72556425382693, 28.855671544869736, 28.668459465106324, 28.923567540322736, 20.278717448314026, 19.61900258560975, 19.971940500040844, 47.84499775866668, 47.539326290289566, 47.904857390249774, 36.68817402794957, 36.70969283208251, 36.79979586973786, 37.045957341634974, 36.63723055769999, 36.85813535501559, 42.488597745696694, 42.63197385023037, 42.00899165372053, 40.01990912357965, 40.17333024988571, 40.21452000240484, 44.05249747633934, 44.06456857174635, 44.34487707167864, 5.123891336222485, 5.46911345267047, 5.134586719175175, 39.065610855817795, 39.138243613764644, 38.666531048715115, 35.039569940418005, 34.4490909576416, 35.3220583871007, 32.66871047051002, 32.189567287762955, 31.874006887276963, 33.1939588971436, 32.75384131073952, 32.83539044857025, 33.36253174642721, 33.61463417361179, 33.10600609580675, 29.833983659744263, 29.565422043204308, 29.739679193124175, 33.70861135516316, 33.51800875365734, 33.36744160950184, 39.032213263213634, 39.373643374070525, 38.37580418586731, 34.28376969136298, 33.80789498984814, 34.12076595425606, 38.421020993342, 38.47195065704484, 37.99967574079831, 34.4042315284411, 34.92099547261992, 34.946913360307605, 30.069439982374504, 30.37481156488259, 29.664381866653756, 29.923061860104397, 29.760144149263695, 29.848559369643525, 19.41584078470865, 19.51690778012076, 19.52044170225659, 40.88056553155184, 40.76000828295946, 40.33308580517769, 38.28176026418805, 38.2655871398747, 37.67904657125473, 18.87627861400445, 19.564360065230474, 19.526913179395095, 30.697761967778206, 31.231342375278473, 31.095944613218307, 42.6861957485477, 42.53707073877254, 42.94972527089217, 36.52143532037735, 36.86389049142599, 37.085008040070534, 37.8711732973655, 37.74632376929124, 38.382191875328616, 34.91713716710606, 34.70407740275064, 34.643542925516755, 34.316675956050545, 34.63577392945686, 35.01411479866752, 35.11676961059371, 35.36823084779704, 34.167060325543076, 31.3413925046722, 30.940186748901993, 31.58910089607039, 46.552433398862675, 46.492862076809004, 46.4982353237768, 30.139524365464837, 29.940878624717385, 30.15092412630716, 26.81937827169895, 27.48081854917109, 27.271496452391148, 39.523420612017304, 39.82406111077094, 39.313205311695725, 42.232322834432125, 41.48603039979935, 42.32713411748409, 26.154181250739683, 25.859312915553645, 25.984220912059143, 21.974450916051865, 22.116541887400672, 22.054264520294964, 38.38997328716019, 38.17174757892886, 38.23308809722462, 40.18735182285309, 40.70802666991949, 40.80913704633713, 45.314141164223344, 45.51928127805391, 45.64095978314677, 44.25069982558489, 44.28362999483943, 44.2929312530905, 35.32062975813945, 35.13551427175601, 35.255614203711346, 35.25266700734694, 34.00792886813481, 34.76031554241975, 24.140897984306008, 23.56208376089731, 24.037029998997838, 32.89730691537261, 33.1641100901179, 32.86190740019083, 37.284862875938416, 37.114532098174095, 37.00466546416283, 26.970849964767694, 26.697366923093796, 27.131945319473743, 32.86704463387528, 33.019718867416174, 33.139757581210375, 38.79109409078956, 38.843506187200546, 38.35111467540264, -83.25334126067659, -83.27655839671692, -84.08922119935355, 38.658883277947695, 38.307016039888055, 38.08877586821714, 43.46753379702568, 44.03092968650162, 43.64945864677429, 35.4750473399957, 35.98508308858921, 35.779589896400765, 37.23958758140603, 37.294266926745564, 37.4951593109096, 37.99226174255212, 38.454535865535334, 38.53098401923974, 29.5968408336242, 29.818782425795987, 29.847548269977167, 35.8921801286439, 35.56635958949724, 35.54549066225687, 36.43837652914226, 36.22208119183779, 36.44708212278783, 37.22384515901406, 37.063640390833214, 36.79436113437016, 21.635524002214268, 21.579784793158368, 22.018321720262364, 35.13350591311851, 35.62796445462541, 35.46791715795794, 31.709487477162227, 30.954168577988938, 31.13156559815009, 36.318037713567406, 36.0709126467506, 36.372469569245965, 36.886302178104714, 36.61197783549626, 36.837606133272246, 41.15881885588169, 41.466107435524464, 40.70238183438778, 30.004794977605343, 29.636351734399796, 29.910841442644596, 33.05286693945527, 32.86921040713787, 33.02624320238829, 39.381255271534116, 38.63116445640722, 39.478280811260134, 49.669866338372216, 49.43063352257012, 49.5408223196864, 39.18703180924058, 38.90392455458641, 39.04598429054022, 35.03954701470987, 34.739648317297295, 34.85351615523298, 29.48931313802798, 29.91701215024416, 29.84116785911222, 31.34519673138857, 31.317152746021748, 30.52200074493885, 33.85499018244445, 33.90791471116245, 33.10408763587475, -84.17332592358193, -85.69213299949965, -94.30338052039346, 26.075471019993216, 26.123348506788403, 25.997286340842635, 26.652404521902398, 27.010198948283985, 27.105860007305935, 33.982363011687994, 33.38800190389156, 33.91208753362298, 43.30063085878888, 43.49082806023458, 42.797771523396165, 29.31966266874224, 29.052349410951138, 29.14417403563857, 26.61407159268856, 25.775964871048927, 26.659929050132632, 39.59232829014459, 40.808916709555575, 40.62597400943437, 31.80017638206482, 32.91441549733281, 31.90797160565853, 34.12521843612194, 34.92156111449003, 34.774447314441204, 23.103450660904244, 23.20696800326307, 23.406752772474036, 37.92039822538693, 38.445129159217075, 38.479763974746064, 38.39347003897031, 38.44733343397577, 38.21308399488528, 27.191079060236603, 27.97731754059592, 27.497709381083638, 40.861118502914906, 40.919184006750584, 40.863300051540136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14212965821099632, "mean_inference_ms": 0.6953998225389705, "mean_action_processing_ms": 0.09569300550865316, "mean_env_wait_ms": 0.7957648319212893, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 555000, "timesteps_this_iter": 0, "agent_timesteps_total": 1665000, "timers": {"sample_time_ms": 10845.143, "sample_throughput": 461.036, "load_time_ms": 0.301, "load_throughput": 16607158.695, "learn_time_ms": 2008.754, "learn_throughput": 2489.105, "update_time_ms": 9.457}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2924697071141058e-27, "cur_lr": 0.0005000000000000001, "total_loss": 8.819403648376465, "policy_loss": -0.0015893475960412572, "vf_loss": 8.916414070129395, "vf_explained_var": -0.02301265001296997, "kl": 0.0023456026145461275, "entropy": 9.54210901260376, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 555000, "num_agent_steps_sampled": 1665000, "num_steps_trained": 555000, "num_agent_steps_trained": 1665000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1776, "training_iteration": 111, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-21-22", "timestamp": 1706232082, "time_this_iter_s": 10.719752311706543, "time_total_s": 1197.8956634998322, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401A7A940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1197.8956634998322, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 5.862500000000001, "ram_util_percent": 61.4375}}
{"episode_reward_max": 148.64132218062858, "episode_reward_min": -264.16883944347506, "episode_reward_mean": 93.92019239709668, "episode_len_mean": 491.65, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -94.30338052039346}, "policy_reward_max": {"shared_policy": 49.669866338372216}, "policy_reward_mean": {"shared_policy": 31.306730799032216}, "custom_metrics": {}, "hist_stats": {"episode_reward": [110.54132325435056, 127.12956324964759, 120.4077593758702, 132.4619431197643, 15.72759150806813, 116.87038551829755, 104.8107192851603, 96.73228464554994, 98.78319065645337, 100.08317201584575, 89.13908489607275, 100.59406171832234, 116.78166082315147, 102.21243063546717, 114.89264739118515, 104.27214036136863, 90.10863341391085, 89.53176537901162, 58.453190267086, 121.97365961968899, 114.22639397531748, 57.96755185863002, 93.02504895627499, 128.1729917582124, 110.47033385187387, 113.99968894198535, 104.26475749537346, 103.96656468417493, 104.65206078393382, 93.87068014964458, 139.54353079944832, 90.23132711648938, 81.57169327326119, 118.66068703448397, 126.04548735171556, 77.99771507835247, 66.1452573237475, 114.79480896331367, 121.7045155391097, 136.474382225424, 132.82726107351468, 105.7117582336068, 104.0209114179015, 71.74001174420115, 98.92332440568134, 111.40406043827534, 80.80016220733523, 99.02652108250183, 115.98571495339274, -250.6191208567471, 115.05467518605289, 131.14792213030154, 107.23972032498567, 112.02901381906119, 114.97778162732719, 89.26317152939735, 107.004030380398, 109.10753984376788, 111.08184668421744, 65.233630515635, 106.22938752570187, 93.79522165330125, 108.76141992956397, 110.33588614687322, 123.32730812579393, 89.55198815464973, 98.94832054898143, 117.49070053920147, 148.64132218062858, 117.13694065436721, 104.63271148724014, 89.24749314738436, 93.18435022234917, 100.86699252948165, -264.16883944347506, 78.19610586762425, 80.76846347749232, 101.28245244920254, 129.58923044241968, 87.51618611533195, 79.04996551387012, 121.02721900913454, 96.62256348505616, 103.82122686505318, 69.71717143664135, 114.84529135935007, 115.05388746783136, 82.66610598191616, 122.64360256120563, 93.56860461458562, 130.61644740030164, 105.44677679240704, 137.511679583695, 130.89373084530257, -263.4324786812067, 116.46629769727586, 121.88108812645076, 105.22790687531231, 144.50558718759552, 107.30030279792842], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 283, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 185, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 197, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [37.045957341634974, 36.63723055769999, 36.85813535501559, 42.488597745696694, 42.63197385023037, 42.00899165372053, 40.01990912357965, 40.17333024988571, 40.21452000240484, 44.05249747633934, 44.06456857174635, 44.34487707167864, 5.123891336222485, 5.46911345267047, 5.134586719175175, 39.065610855817795, 39.138243613764644, 38.666531048715115, 35.039569940418005, 34.4490909576416, 35.3220583871007, 32.66871047051002, 32.189567287762955, 31.874006887276963, 33.1939588971436, 32.75384131073952, 32.83539044857025, 33.36253174642721, 33.61463417361179, 33.10600609580675, 29.833983659744263, 29.565422043204308, 29.739679193124175, 33.70861135516316, 33.51800875365734, 33.36744160950184, 39.032213263213634, 39.373643374070525, 38.37580418586731, 34.28376969136298, 33.80789498984814, 34.12076595425606, 38.421020993342, 38.47195065704484, 37.99967574079831, 34.4042315284411, 34.92099547261992, 34.946913360307605, 30.069439982374504, 30.37481156488259, 29.664381866653756, 29.923061860104397, 29.760144149263695, 29.848559369643525, 19.41584078470865, 19.51690778012076, 19.52044170225659, 40.88056553155184, 40.76000828295946, 40.33308580517769, 38.28176026418805, 38.2655871398747, 37.67904657125473, 18.87627861400445, 19.564360065230474, 19.526913179395095, 30.697761967778206, 31.231342375278473, 31.095944613218307, 42.6861957485477, 42.53707073877254, 42.94972527089217, 36.52143532037735, 36.86389049142599, 37.085008040070534, 37.8711732973655, 37.74632376929124, 38.382191875328616, 34.91713716710606, 34.70407740275064, 34.643542925516755, 34.316675956050545, 34.63577392945686, 35.01411479866752, 35.11676961059371, 35.36823084779704, 34.167060325543076, 31.3413925046722, 30.940186748901993, 31.58910089607039, 46.552433398862675, 46.492862076809004, 46.4982353237768, 30.139524365464837, 29.940878624717385, 30.15092412630716, 26.81937827169895, 27.48081854917109, 27.271496452391148, 39.523420612017304, 39.82406111077094, 39.313205311695725, 42.232322834432125, 41.48603039979935, 42.32713411748409, 26.154181250739683, 25.859312915553645, 25.984220912059143, 21.974450916051865, 22.116541887400672, 22.054264520294964, 38.38997328716019, 38.17174757892886, 38.23308809722462, 40.18735182285309, 40.70802666991949, 40.80913704633713, 45.314141164223344, 45.51928127805391, 45.64095978314677, 44.25069982558489, 44.28362999483943, 44.2929312530905, 35.32062975813945, 35.13551427175601, 35.255614203711346, 35.25266700734694, 34.00792886813481, 34.76031554241975, 24.140897984306008, 23.56208376089731, 24.037029998997838, 32.89730691537261, 33.1641100901179, 32.86190740019083, 37.284862875938416, 37.114532098174095, 37.00466546416283, 26.970849964767694, 26.697366923093796, 27.131945319473743, 32.86704463387528, 33.019718867416174, 33.139757581210375, 38.79109409078956, 38.843506187200546, 38.35111467540264, -83.25334126067659, -83.27655839671692, -84.08922119935355, 38.658883277947695, 38.307016039888055, 38.08877586821714, 43.46753379702568, 44.03092968650162, 43.64945864677429, 35.4750473399957, 35.98508308858921, 35.779589896400765, 37.23958758140603, 37.294266926745564, 37.4951593109096, 37.99226174255212, 38.454535865535334, 38.53098401923974, 29.5968408336242, 29.818782425795987, 29.847548269977167, 35.8921801286439, 35.56635958949724, 35.54549066225687, 36.43837652914226, 36.22208119183779, 36.44708212278783, 37.22384515901406, 37.063640390833214, 36.79436113437016, 21.635524002214268, 21.579784793158368, 22.018321720262364, 35.13350591311851, 35.62796445462541, 35.46791715795794, 31.709487477162227, 30.954168577988938, 31.13156559815009, 36.318037713567406, 36.0709126467506, 36.372469569245965, 36.886302178104714, 36.61197783549626, 36.837606133272246, 41.15881885588169, 41.466107435524464, 40.70238183438778, 30.004794977605343, 29.636351734399796, 29.910841442644596, 33.05286693945527, 32.86921040713787, 33.02624320238829, 39.381255271534116, 38.63116445640722, 39.478280811260134, 49.669866338372216, 49.43063352257012, 49.5408223196864, 39.18703180924058, 38.90392455458641, 39.04598429054022, 35.03954701470987, 34.739648317297295, 34.85351615523298, 29.48931313802798, 29.91701215024416, 29.84116785911222, 31.34519673138857, 31.317152746021748, 30.52200074493885, 33.85499018244445, 33.90791471116245, 33.10408763587475, -84.17332592358193, -85.69213299949965, -94.30338052039346, 26.075471019993216, 26.123348506788403, 25.997286340842635, 26.652404521902398, 27.010198948283985, 27.105860007305935, 33.982363011687994, 33.38800190389156, 33.91208753362298, 43.30063085878888, 43.49082806023458, 42.797771523396165, 29.31966266874224, 29.052349410951138, 29.14417403563857, 26.61407159268856, 25.775964871048927, 26.659929050132632, 39.59232829014459, 40.808916709555575, 40.62597400943437, 31.80017638206482, 32.91441549733281, 31.90797160565853, 34.12521843612194, 34.92156111449003, 34.774447314441204, 23.103450660904244, 23.20696800326307, 23.406752772474036, 37.92039822538693, 38.445129159217075, 38.479763974746064, 38.39347003897031, 38.44733343397577, 38.21308399488528, 27.191079060236603, 27.97731754059592, 27.497709381083638, 40.861118502914906, 40.919184006750584, 40.863300051540136, 31.47901129846771, 30.929515575369194, 31.16007774074872, 43.441752697030694, 43.79151180262366, 43.38318290064731, 35.24496532604098, 34.96268482506275, 35.2391266413033, 45.955092525885746, 45.80639179175098, 45.75019526605804, 43.333808595935494, 43.90512602652112, 43.654796222845704, -84.52637128531933, -84.945003464818, -93.96110393106937, 39.12296485279997, 38.436166291435555, 38.90716655304034, 40.59494674702485, 40.67966340606411, 40.606477973361805, 35.32644614701469, 34.55535890658696, 35.34610182171066, 48.295124109524, 47.94720395157735, 48.26325912649433, 35.41543276111284, 35.83791052053371, 36.04695951628187]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14213989903335597, "mean_inference_ms": 0.695526740340969, "mean_action_processing_ms": 0.09570027133678231, "mean_env_wait_ms": 0.795657253996745, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 560000, "timesteps_this_iter": 0, "agent_timesteps_total": 1680000, "timers": {"sample_time_ms": 10777.537, "sample_throughput": 463.928, "load_time_ms": 0.301, "load_throughput": 16607158.695, "learn_time_ms": 2002.456, "learn_throughput": 2496.934, "update_time_ms": 9.455}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.462348535570529e-28, "cur_lr": 0.0005000000000000001, "total_loss": 119.59756927490234, "policy_loss": -0.0015896947710587028, "vf_loss": 119.69532470703125, "vf_explained_var": -0.0025320529937744142, "kl": 0.0049118744209725495, "entropy": 9.616593360900879, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 560000, "num_agent_steps_sampled": 1680000, "num_steps_trained": 560000, "num_agent_steps_trained": 1680000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1787, "training_iteration": 112, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-21-32", "timestamp": 1706232092, "time_this_iter_s": 10.11790418624878, "time_total_s": 1208.013567686081, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402530820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1208.013567686081, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 5.742857142857143, "ram_util_percent": 61.47857142857142}}
{"episode_reward_max": 148.64132218062858, "episode_reward_min": -264.16883944347506, "episode_reward_mean": 93.82898689083478, "episode_len_mean": 491.65, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -94.30338052039346}, "policy_reward_max": {"shared_policy": 49.669866338372216}, "policy_reward_mean": {"shared_policy": 31.27632896361159}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.13908489607275, 100.59406171832234, 116.78166082315147, 102.21243063546717, 114.89264739118515, 104.27214036136863, 90.10863341391085, 89.53176537901162, 58.453190267086, 121.97365961968899, 114.22639397531748, 57.96755185863002, 93.02504895627499, 128.1729917582124, 110.47033385187387, 113.99968894198535, 104.26475749537346, 103.96656468417493, 104.65206078393382, 93.87068014964458, 139.54353079944832, 90.23132711648938, 81.57169327326119, 118.66068703448397, 126.04548735171556, 77.99771507835247, 66.1452573237475, 114.79480896331367, 121.7045155391097, 136.474382225424, 132.82726107351468, 105.7117582336068, 104.0209114179015, 71.74001174420115, 98.92332440568134, 111.40406043827534, 80.80016220733523, 99.02652108250183, 115.98571495339274, -250.6191208567471, 115.05467518605289, 131.14792213030154, 107.23972032498567, 112.02901381906119, 114.97778162732719, 89.26317152939735, 107.004030380398, 109.10753984376788, 111.08184668421744, 65.233630515635, 106.22938752570187, 93.79522165330125, 108.76141992956397, 110.33588614687322, 123.32730812579393, 89.55198815464973, 98.94832054898143, 117.49070053920147, 148.64132218062858, 117.13694065436721, 104.63271148724014, 89.24749314738436, 93.18435022234917, 100.86699252948165, -264.16883944347506, 78.19610586762425, 80.76846347749232, 101.28245244920254, 129.58923044241968, 87.51618611533195, 79.04996551387012, 121.02721900913454, 96.62256348505616, 103.82122686505318, 69.71717143664135, 114.84529135935007, 115.05388746783136, 82.66610598191616, 122.64360256120563, 93.56860461458562, 130.61644740030164, 105.44677679240704, 137.511679583695, 130.89373084530257, -263.4324786812067, 116.46629769727586, 121.88108812645076, 105.22790687531231, 144.50558718759552, 107.30030279792842, 110.56790264882144, 120.53252869658169, 75.93256045505403, 99.92087399680166, 126.04779209941623, 98.60766397789119, 108.84065857739186, 95.67496652156115, 88.34877679124475, 89.95365823805331], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 283, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 185, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 197, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [29.833983659744263, 29.565422043204308, 29.739679193124175, 33.70861135516316, 33.51800875365734, 33.36744160950184, 39.032213263213634, 39.373643374070525, 38.37580418586731, 34.28376969136298, 33.80789498984814, 34.12076595425606, 38.421020993342, 38.47195065704484, 37.99967574079831, 34.4042315284411, 34.92099547261992, 34.946913360307605, 30.069439982374504, 30.37481156488259, 29.664381866653756, 29.923061860104397, 29.760144149263695, 29.848559369643525, 19.41584078470865, 19.51690778012076, 19.52044170225659, 40.88056553155184, 40.76000828295946, 40.33308580517769, 38.28176026418805, 38.2655871398747, 37.67904657125473, 18.87627861400445, 19.564360065230474, 19.526913179395095, 30.697761967778206, 31.231342375278473, 31.095944613218307, 42.6861957485477, 42.53707073877254, 42.94972527089217, 36.52143532037735, 36.86389049142599, 37.085008040070534, 37.8711732973655, 37.74632376929124, 38.382191875328616, 34.91713716710606, 34.70407740275064, 34.643542925516755, 34.316675956050545, 34.63577392945686, 35.01411479866752, 35.11676961059371, 35.36823084779704, 34.167060325543076, 31.3413925046722, 30.940186748901993, 31.58910089607039, 46.552433398862675, 46.492862076809004, 46.4982353237768, 30.139524365464837, 29.940878624717385, 30.15092412630716, 26.81937827169895, 27.48081854917109, 27.271496452391148, 39.523420612017304, 39.82406111077094, 39.313205311695725, 42.232322834432125, 41.48603039979935, 42.32713411748409, 26.154181250739683, 25.859312915553645, 25.984220912059143, 21.974450916051865, 22.116541887400672, 22.054264520294964, 38.38997328716019, 38.17174757892886, 38.23308809722462, 40.18735182285309, 40.70802666991949, 40.80913704633713, 45.314141164223344, 45.51928127805391, 45.64095978314677, 44.25069982558489, 44.28362999483943, 44.2929312530905, 35.32062975813945, 35.13551427175601, 35.255614203711346, 35.25266700734694, 34.00792886813481, 34.76031554241975, 24.140897984306008, 23.56208376089731, 24.037029998997838, 32.89730691537261, 33.1641100901179, 32.86190740019083, 37.284862875938416, 37.114532098174095, 37.00466546416283, 26.970849964767694, 26.697366923093796, 27.131945319473743, 32.86704463387528, 33.019718867416174, 33.139757581210375, 38.79109409078956, 38.843506187200546, 38.35111467540264, -83.25334126067659, -83.27655839671692, -84.08922119935355, 38.658883277947695, 38.307016039888055, 38.08877586821714, 43.46753379702568, 44.03092968650162, 43.64945864677429, 35.4750473399957, 35.98508308858921, 35.779589896400765, 37.23958758140603, 37.294266926745564, 37.4951593109096, 37.99226174255212, 38.454535865535334, 38.53098401923974, 29.5968408336242, 29.818782425795987, 29.847548269977167, 35.8921801286439, 35.56635958949724, 35.54549066225687, 36.43837652914226, 36.22208119183779, 36.44708212278783, 37.22384515901406, 37.063640390833214, 36.79436113437016, 21.635524002214268, 21.579784793158368, 22.018321720262364, 35.13350591311851, 35.62796445462541, 35.46791715795794, 31.709487477162227, 30.954168577988938, 31.13156559815009, 36.318037713567406, 36.0709126467506, 36.372469569245965, 36.886302178104714, 36.61197783549626, 36.837606133272246, 41.15881885588169, 41.466107435524464, 40.70238183438778, 30.004794977605343, 29.636351734399796, 29.910841442644596, 33.05286693945527, 32.86921040713787, 33.02624320238829, 39.381255271534116, 38.63116445640722, 39.478280811260134, 49.669866338372216, 49.43063352257012, 49.5408223196864, 39.18703180924058, 38.90392455458641, 39.04598429054022, 35.03954701470987, 34.739648317297295, 34.85351615523298, 29.48931313802798, 29.91701215024416, 29.84116785911222, 31.34519673138857, 31.317152746021748, 30.52200074493885, 33.85499018244445, 33.90791471116245, 33.10408763587475, -84.17332592358193, -85.69213299949965, -94.30338052039346, 26.075471019993216, 26.123348506788403, 25.997286340842635, 26.652404521902398, 27.010198948283985, 27.105860007305935, 33.982363011687994, 33.38800190389156, 33.91208753362298, 43.30063085878888, 43.49082806023458, 42.797771523396165, 29.31966266874224, 29.052349410951138, 29.14417403563857, 26.61407159268856, 25.775964871048927, 26.659929050132632, 39.59232829014459, 40.808916709555575, 40.62597400943437, 31.80017638206482, 32.91441549733281, 31.90797160565853, 34.12521843612194, 34.92156111449003, 34.774447314441204, 23.103450660904244, 23.20696800326307, 23.406752772474036, 37.92039822538693, 38.445129159217075, 38.479763974746064, 38.39347003897031, 38.44733343397577, 38.21308399488528, 27.191079060236603, 27.97731754059592, 27.497709381083638, 40.861118502914906, 40.919184006750584, 40.863300051540136, 31.47901129846771, 30.929515575369194, 31.16007774074872, 43.441752697030694, 43.79151180262366, 43.38318290064731, 35.24496532604098, 34.96268482506275, 35.2391266413033, 45.955092525885746, 45.80639179175098, 45.75019526605804, 43.333808595935494, 43.90512602652112, 43.654796222845704, -84.52637128531933, -84.945003464818, -93.96110393106937, 39.12296485279997, 38.436166291435555, 38.90716655304034, 40.59494674702485, 40.67966340606411, 40.606477973361805, 35.32644614701469, 34.55535890658696, 35.34610182171066, 48.295124109524, 47.94720395157735, 48.26325912649433, 35.41543276111284, 35.83791052053371, 36.04695951628187, 36.86055947902301, 36.85559999073544, 36.85174317906299, 40.33788851896921, 40.47689626427987, 39.71774391333261, 25.692807120581463, 24.432111849387482, 25.807641485085085, 33.24625913550456, 33.35381352373709, 33.32080133756001, 42.11208301285902, 41.58534037570158, 42.35036871085563, 32.66656530400117, 32.618783464034394, 33.32231520985563, 36.13088476782043, 36.41083542218742, 36.29893838738401, 31.047299772500992, 32.453905276954174, 32.17376147210598, 29.56757894717157, 29.571773735806346, 29.20942410826683, 29.848086794217423, 30.217194517453507, 29.888376926382378]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1421350407408756, "mean_inference_ms": 0.6956173172923079, "mean_action_processing_ms": 0.09571269395335459, "mean_env_wait_ms": 0.795551464168232, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 565000, "timesteps_this_iter": 0, "agent_timesteps_total": 1695000, "timers": {"sample_time_ms": 10730.149, "sample_throughput": 465.977, "load_time_ms": 0.201, "load_throughput": 24871347.249, "learn_time_ms": 1992.258, "learn_throughput": 2509.716, "update_time_ms": 9.255}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.2311742677852645e-28, "cur_lr": 0.0005000000000000001, "total_loss": 8.209282684326173, "policy_loss": -0.0018194846979947775, "vf_loss": 8.306672477722168, "vf_explained_var": -0.005579304695129394, "kl": 0.002232736369510019, "entropy": 9.557029056549073, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 565000, "num_agent_steps_sampled": 1695000, "num_steps_trained": 565000, "num_agent_steps_trained": 1695000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1797, "training_iteration": 113, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-21-43", "timestamp": 1706232103, "time_this_iter_s": 10.195212841033936, "time_total_s": 1218.2087805271149, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021400813EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1218.2087805271149, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 4.814285714285714, "ram_util_percent": 61.335714285714275}}
{"episode_reward_max": 148.64132218062858, "episode_reward_min": -264.16883944347506, "episode_reward_mean": 94.4497856891081, "episode_len_mean": 491.65, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -94.30338052039346}, "policy_reward_max": {"shared_policy": 49.669866338372216}, "policy_reward_mean": {"shared_policy": 31.483261896369356}, "custom_metrics": {}, "hist_stats": {"episode_reward": [114.22639397531748, 57.96755185863002, 93.02504895627499, 128.1729917582124, 110.47033385187387, 113.99968894198535, 104.26475749537346, 103.96656468417493, 104.65206078393382, 93.87068014964458, 139.54353079944832, 90.23132711648938, 81.57169327326119, 118.66068703448397, 126.04548735171556, 77.99771507835247, 66.1452573237475, 114.79480896331367, 121.7045155391097, 136.474382225424, 132.82726107351468, 105.7117582336068, 104.0209114179015, 71.74001174420115, 98.92332440568134, 111.40406043827534, 80.80016220733523, 99.02652108250183, 115.98571495339274, -250.6191208567471, 115.05467518605289, 131.14792213030154, 107.23972032498567, 112.02901381906119, 114.97778162732719, 89.26317152939735, 107.004030380398, 109.10753984376788, 111.08184668421744, 65.233630515635, 106.22938752570187, 93.79522165330125, 108.76141992956397, 110.33588614687322, 123.32730812579393, 89.55198815464973, 98.94832054898143, 117.49070053920147, 148.64132218062858, 117.13694065436721, 104.63271148724014, 89.24749314738436, 93.18435022234917, 100.86699252948165, -264.16883944347506, 78.19610586762425, 80.76846347749232, 101.28245244920254, 129.58923044241968, 87.51618611533195, 79.04996551387012, 121.02721900913454, 96.62256348505616, 103.82122686505318, 69.71717143664135, 114.84529135935007, 115.05388746783136, 82.66610598191616, 122.64360256120563, 93.56860461458562, 130.61644740030164, 105.44677679240704, 137.511679583695, 130.89373084530257, -263.4324786812067, 116.46629769727586, 121.88108812645076, 105.22790687531231, 144.50558718759552, 107.30030279792842, 110.56790264882144, 120.53252869658169, 75.93256045505403, 99.92087399680166, 126.04779209941623, 98.60766397789119, 108.84065857739186, 95.67496652156115, 88.34877679124475, 89.95365823805331, 98.99424967728552, 90.75361186079681, 133.41355917975307, 144.98442363739017, 97.79033887060356, 74.63518793880938, 88.45512999407946, 101.74745170678943, 126.91550877224651, 92.34969269484279], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 283, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 185, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 197, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [38.28176026418805, 38.2655871398747, 37.67904657125473, 18.87627861400445, 19.564360065230474, 19.526913179395095, 30.697761967778206, 31.231342375278473, 31.095944613218307, 42.6861957485477, 42.53707073877254, 42.94972527089217, 36.52143532037735, 36.86389049142599, 37.085008040070534, 37.8711732973655, 37.74632376929124, 38.382191875328616, 34.91713716710606, 34.70407740275064, 34.643542925516755, 34.316675956050545, 34.63577392945686, 35.01411479866752, 35.11676961059371, 35.36823084779704, 34.167060325543076, 31.3413925046722, 30.940186748901993, 31.58910089607039, 46.552433398862675, 46.492862076809004, 46.4982353237768, 30.139524365464837, 29.940878624717385, 30.15092412630716, 26.81937827169895, 27.48081854917109, 27.271496452391148, 39.523420612017304, 39.82406111077094, 39.313205311695725, 42.232322834432125, 41.48603039979935, 42.32713411748409, 26.154181250739683, 25.859312915553645, 25.984220912059143, 21.974450916051865, 22.116541887400672, 22.054264520294964, 38.38997328716019, 38.17174757892886, 38.23308809722462, 40.18735182285309, 40.70802666991949, 40.80913704633713, 45.314141164223344, 45.51928127805391, 45.64095978314677, 44.25069982558489, 44.28362999483943, 44.2929312530905, 35.32062975813945, 35.13551427175601, 35.255614203711346, 35.25266700734694, 34.00792886813481, 34.76031554241975, 24.140897984306008, 23.56208376089731, 24.037029998997838, 32.89730691537261, 33.1641100901179, 32.86190740019083, 37.284862875938416, 37.114532098174095, 37.00466546416283, 26.970849964767694, 26.697366923093796, 27.131945319473743, 32.86704463387528, 33.019718867416174, 33.139757581210375, 38.79109409078956, 38.843506187200546, 38.35111467540264, -83.25334126067659, -83.27655839671692, -84.08922119935355, 38.658883277947695, 38.307016039888055, 38.08877586821714, 43.46753379702568, 44.03092968650162, 43.64945864677429, 35.4750473399957, 35.98508308858921, 35.779589896400765, 37.23958758140603, 37.294266926745564, 37.4951593109096, 37.99226174255212, 38.454535865535334, 38.53098401923974, 29.5968408336242, 29.818782425795987, 29.847548269977167, 35.8921801286439, 35.56635958949724, 35.54549066225687, 36.43837652914226, 36.22208119183779, 36.44708212278783, 37.22384515901406, 37.063640390833214, 36.79436113437016, 21.635524002214268, 21.579784793158368, 22.018321720262364, 35.13350591311851, 35.62796445462541, 35.46791715795794, 31.709487477162227, 30.954168577988938, 31.13156559815009, 36.318037713567406, 36.0709126467506, 36.372469569245965, 36.886302178104714, 36.61197783549626, 36.837606133272246, 41.15881885588169, 41.466107435524464, 40.70238183438778, 30.004794977605343, 29.636351734399796, 29.910841442644596, 33.05286693945527, 32.86921040713787, 33.02624320238829, 39.381255271534116, 38.63116445640722, 39.478280811260134, 49.669866338372216, 49.43063352257012, 49.5408223196864, 39.18703180924058, 38.90392455458641, 39.04598429054022, 35.03954701470987, 34.739648317297295, 34.85351615523298, 29.48931313802798, 29.91701215024416, 29.84116785911222, 31.34519673138857, 31.317152746021748, 30.52200074493885, 33.85499018244445, 33.90791471116245, 33.10408763587475, -84.17332592358193, -85.69213299949965, -94.30338052039346, 26.075471019993216, 26.123348506788403, 25.997286340842635, 26.652404521902398, 27.010198948283985, 27.105860007305935, 33.982363011687994, 33.38800190389156, 33.91208753362298, 43.30063085878888, 43.49082806023458, 42.797771523396165, 29.31966266874224, 29.052349410951138, 29.14417403563857, 26.61407159268856, 25.775964871048927, 26.659929050132632, 39.59232829014459, 40.808916709555575, 40.62597400943437, 31.80017638206482, 32.91441549733281, 31.90797160565853, 34.12521843612194, 34.92156111449003, 34.774447314441204, 23.103450660904244, 23.20696800326307, 23.406752772474036, 37.92039822538693, 38.445129159217075, 38.479763974746064, 38.39347003897031, 38.44733343397577, 38.21308399488528, 27.191079060236603, 27.97731754059592, 27.497709381083638, 40.861118502914906, 40.919184006750584, 40.863300051540136, 31.47901129846771, 30.929515575369194, 31.16007774074872, 43.441752697030694, 43.79151180262366, 43.38318290064731, 35.24496532604098, 34.96268482506275, 35.2391266413033, 45.955092525885746, 45.80639179175098, 45.75019526605804, 43.333808595935494, 43.90512602652112, 43.654796222845704, -84.52637128531933, -84.945003464818, -93.96110393106937, 39.12296485279997, 38.436166291435555, 38.90716655304034, 40.59494674702485, 40.67966340606411, 40.606477973361805, 35.32644614701469, 34.55535890658696, 35.34610182171066, 48.295124109524, 47.94720395157735, 48.26325912649433, 35.41543276111284, 35.83791052053371, 36.04695951628187, 36.86055947902301, 36.85559999073544, 36.85174317906299, 40.33788851896921, 40.47689626427987, 39.71774391333261, 25.692807120581463, 24.432111849387482, 25.807641485085085, 33.24625913550456, 33.35381352373709, 33.32080133756001, 42.11208301285902, 41.58534037570158, 42.35036871085563, 32.66656530400117, 32.618783464034394, 33.32231520985563, 36.13088476782043, 36.41083542218742, 36.29893838738401, 31.047299772500992, 32.453905276954174, 32.17376147210598, 29.56757894717157, 29.571773735806346, 29.20942410826683, 29.848086794217423, 30.217194517453507, 29.888376926382378, 33.218154958138854, 33.18006366925934, 32.59603104988733, 30.25930070132017, 30.063120283186436, 30.431190876290202, 44.60011130198836, 44.406769536435604, 44.4066783413291, 47.82255636155604, 48.6260724402964, 48.53579483553766, 33.05171799721816, 33.121612147583306, 31.617008725802094, 25.01458756377299, 25.008366999526814, 24.612233375509575, 28.901138191421822, 29.745377299686268, 29.808614502971366, 33.18625965714455, 34.08219789713621, 34.478994152508676, 42.16083843509355, 42.33689183617631, 42.41777850097665, 30.46688380340734, 30.88581609229246, 30.996992799142987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14213719493593838, "mean_inference_ms": 0.6956869150239282, "mean_action_processing_ms": 0.09571875560890807, "mean_env_wait_ms": 0.7954264980508665, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 570000, "timesteps_this_iter": 0, "agent_timesteps_total": 1710000, "timers": {"sample_time_ms": 10673.97, "sample_throughput": 468.429, "load_time_ms": 0.201, "load_throughput": 24871347.249, "learn_time_ms": 1983.268, "learn_throughput": 2521.091, "update_time_ms": 9.454}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6155871338926323e-28, "cur_lr": 0.0005000000000000001, "total_loss": 6.860673570632935, "policy_loss": -0.001413458208811158, "vf_loss": 6.957991313934326, "vf_explained_var": -0.020377039909362793, "kl": 0.0028038438642714993, "entropy": 9.590446376800537, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 570000, "num_agent_steps_sampled": 1710000, "num_steps_trained": 570000, "num_agent_steps_trained": 1710000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1807, "training_iteration": 114, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-21-53", "timestamp": 1706232113, "time_this_iter_s": 10.553816556930542, "time_total_s": 1228.7625970840454, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002146F7AC700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1228.7625970840454, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 6.346666666666668, "ram_util_percent": 61.46}}
{"episode_reward_max": 149.17220940720284, "episode_reward_min": -264.16883944347506, "episode_reward_mean": 95.77390576627761, "episode_len_mean": 491.65, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -94.30338052039346}, "policy_reward_max": {"shared_policy": 49.94776648438226}, "policy_reward_mean": {"shared_policy": 31.92463525542587}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.54353079944832, 90.23132711648938, 81.57169327326119, 118.66068703448397, 126.04548735171556, 77.99771507835247, 66.1452573237475, 114.79480896331367, 121.7045155391097, 136.474382225424, 132.82726107351468, 105.7117582336068, 104.0209114179015, 71.74001174420115, 98.92332440568134, 111.40406043827534, 80.80016220733523, 99.02652108250183, 115.98571495339274, -250.6191208567471, 115.05467518605289, 131.14792213030154, 107.23972032498567, 112.02901381906119, 114.97778162732719, 89.26317152939735, 107.004030380398, 109.10753984376788, 111.08184668421744, 65.233630515635, 106.22938752570187, 93.79522165330125, 108.76141992956397, 110.33588614687322, 123.32730812579393, 89.55198815464973, 98.94832054898143, 117.49070053920147, 148.64132218062858, 117.13694065436721, 104.63271148724014, 89.24749314738436, 93.18435022234917, 100.86699252948165, -264.16883944347506, 78.19610586762425, 80.76846347749232, 101.28245244920254, 129.58923044241968, 87.51618611533195, 79.04996551387012, 121.02721900913454, 96.62256348505616, 103.82122686505318, 69.71717143664135, 114.84529135935007, 115.05388746783136, 82.66610598191616, 122.64360256120563, 93.56860461458562, 130.61644740030164, 105.44677679240704, 137.511679583695, 130.89373084530257, -263.4324786812067, 116.46629769727586, 121.88108812645076, 105.22790687531231, 144.50558718759552, 107.30030279792842, 110.56790264882144, 120.53252869658169, 75.93256045505403, 99.92087399680166, 126.04779209941623, 98.60766397789119, 108.84065857739186, 95.67496652156115, 88.34877679124475, 89.95365823805331, 98.99424967728552, 90.75361186079681, 133.41355917975307, 144.98442363739017, 97.79033887060356, 74.63518793880938, 88.45512999407946, 101.74745170678943, 126.91550877224651, 92.34969269484279, 122.87996386922896, 119.26281052222475, 149.17220940720284, 87.14092328306288, 93.9843154326081, 113.26110249571502, 123.37716764956711, 126.26712691783902, 117.11249715089797, 104.56996344402431], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 283, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 185, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 197, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [46.552433398862675, 46.492862076809004, 46.4982353237768, 30.139524365464837, 29.940878624717385, 30.15092412630716, 26.81937827169895, 27.48081854917109, 27.271496452391148, 39.523420612017304, 39.82406111077094, 39.313205311695725, 42.232322834432125, 41.48603039979935, 42.32713411748409, 26.154181250739683, 25.859312915553645, 25.984220912059143, 21.974450916051865, 22.116541887400672, 22.054264520294964, 38.38997328716019, 38.17174757892886, 38.23308809722462, 40.18735182285309, 40.70802666991949, 40.80913704633713, 45.314141164223344, 45.51928127805391, 45.64095978314677, 44.25069982558489, 44.28362999483943, 44.2929312530905, 35.32062975813945, 35.13551427175601, 35.255614203711346, 35.25266700734694, 34.00792886813481, 34.76031554241975, 24.140897984306008, 23.56208376089731, 24.037029998997838, 32.89730691537261, 33.1641100901179, 32.86190740019083, 37.284862875938416, 37.114532098174095, 37.00466546416283, 26.970849964767694, 26.697366923093796, 27.131945319473743, 32.86704463387528, 33.019718867416174, 33.139757581210375, 38.79109409078956, 38.843506187200546, 38.35111467540264, -83.25334126067659, -83.27655839671692, -84.08922119935355, 38.658883277947695, 38.307016039888055, 38.08877586821714, 43.46753379702568, 44.03092968650162, 43.64945864677429, 35.4750473399957, 35.98508308858921, 35.779589896400765, 37.23958758140603, 37.294266926745564, 37.4951593109096, 37.99226174255212, 38.454535865535334, 38.53098401923974, 29.5968408336242, 29.818782425795987, 29.847548269977167, 35.8921801286439, 35.56635958949724, 35.54549066225687, 36.43837652914226, 36.22208119183779, 36.44708212278783, 37.22384515901406, 37.063640390833214, 36.79436113437016, 21.635524002214268, 21.579784793158368, 22.018321720262364, 35.13350591311851, 35.62796445462541, 35.46791715795794, 31.709487477162227, 30.954168577988938, 31.13156559815009, 36.318037713567406, 36.0709126467506, 36.372469569245965, 36.886302178104714, 36.61197783549626, 36.837606133272246, 41.15881885588169, 41.466107435524464, 40.70238183438778, 30.004794977605343, 29.636351734399796, 29.910841442644596, 33.05286693945527, 32.86921040713787, 33.02624320238829, 39.381255271534116, 38.63116445640722, 39.478280811260134, 49.669866338372216, 49.43063352257012, 49.5408223196864, 39.18703180924058, 38.90392455458641, 39.04598429054022, 35.03954701470987, 34.739648317297295, 34.85351615523298, 29.48931313802798, 29.91701215024416, 29.84116785911222, 31.34519673138857, 31.317152746021748, 30.52200074493885, 33.85499018244445, 33.90791471116245, 33.10408763587475, -84.17332592358193, -85.69213299949965, -94.30338052039346, 26.075471019993216, 26.123348506788403, 25.997286340842635, 26.652404521902398, 27.010198948283985, 27.105860007305935, 33.982363011687994, 33.38800190389156, 33.91208753362298, 43.30063085878888, 43.49082806023458, 42.797771523396165, 29.31966266874224, 29.052349410951138, 29.14417403563857, 26.61407159268856, 25.775964871048927, 26.659929050132632, 39.59232829014459, 40.808916709555575, 40.62597400943437, 31.80017638206482, 32.91441549733281, 31.90797160565853, 34.12521843612194, 34.92156111449003, 34.774447314441204, 23.103450660904244, 23.20696800326307, 23.406752772474036, 37.92039822538693, 38.445129159217075, 38.479763974746064, 38.39347003897031, 38.44733343397577, 38.21308399488528, 27.191079060236603, 27.97731754059592, 27.497709381083638, 40.861118502914906, 40.919184006750584, 40.863300051540136, 31.47901129846771, 30.929515575369194, 31.16007774074872, 43.441752697030694, 43.79151180262366, 43.38318290064731, 35.24496532604098, 34.96268482506275, 35.2391266413033, 45.955092525885746, 45.80639179175098, 45.75019526605804, 43.333808595935494, 43.90512602652112, 43.654796222845704, -84.52637128531933, -84.945003464818, -93.96110393106937, 39.12296485279997, 38.436166291435555, 38.90716655304034, 40.59494674702485, 40.67966340606411, 40.606477973361805, 35.32644614701469, 34.55535890658696, 35.34610182171066, 48.295124109524, 47.94720395157735, 48.26325912649433, 35.41543276111284, 35.83791052053371, 36.04695951628187, 36.86055947902301, 36.85559999073544, 36.85174317906299, 40.33788851896921, 40.47689626427987, 39.71774391333261, 25.692807120581463, 24.432111849387482, 25.807641485085085, 33.24625913550456, 33.35381352373709, 33.32080133756001, 42.11208301285902, 41.58534037570158, 42.35036871085563, 32.66656530400117, 32.618783464034394, 33.32231520985563, 36.13088476782043, 36.41083542218742, 36.29893838738401, 31.047299772500992, 32.453905276954174, 32.17376147210598, 29.56757894717157, 29.571773735806346, 29.20942410826683, 29.848086794217423, 30.217194517453507, 29.888376926382378, 33.218154958138854, 33.18006366925934, 32.59603104988733, 30.25930070132017, 30.063120283186436, 30.431190876290202, 44.60011130198836, 44.406769536435604, 44.4066783413291, 47.82255636155604, 48.6260724402964, 48.53579483553766, 33.05171799721816, 33.121612147583306, 31.617008725802094, 25.01458756377299, 25.008366999526814, 24.612233375509575, 28.901138191421822, 29.745377299686268, 29.808614502971366, 33.18625965714455, 34.08219789713621, 34.478994152508676, 42.16083843509355, 42.33689183617631, 42.41777850097665, 30.46688380340734, 30.88581609229246, 30.996992799142987, 41.001523077487946, 41.029962008818984, 40.84847878292203, 39.56466028094292, 39.85253250785172, 39.84561773343012, 49.94776648438226, 49.453090834120914, 49.77135208869974, 29.53980442788452, 29.135130263864994, 28.465988591313362, 31.669580877448112, 31.650310304636747, 30.66442425052324, 37.63401123136282, 37.68777659535408, 37.93931466899812, 40.724709292252854, 41.368894947071865, 41.283563410242394, 41.85671162108579, 42.19943892459074, 42.21097637216249, 39.04521217693885, 39.11952158560355, 38.94776338835557, 34.65630756815274, 34.67403562863667, 35.239620247234896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14214357221557422, "mean_inference_ms": 0.6957525575484285, "mean_action_processing_ms": 0.09573418485681766, "mean_env_wait_ms": 0.7953213171471044, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 575000, "timesteps_this_iter": 0, "agent_timesteps_total": 1725000, "timers": {"sample_time_ms": 10685.094, "sample_throughput": 467.942, "load_time_ms": 0.201, "load_throughput": 24871347.249, "learn_time_ms": 1980.494, "learn_throughput": 2524.623, "update_time_ms": 9.639}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.077935669463161e-29, "cur_lr": 0.0005000000000000001, "total_loss": 6.557531499862671, "policy_loss": -0.0016915910927347122, "vf_loss": 6.654955291748047, "vf_explained_var": -0.027340710163116455, "kl": 0.002343923598560136, "entropy": 9.573209190368653, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 575000, "num_agent_steps_sampled": 1725000, "num_steps_trained": 575000, "num_agent_steps_trained": 1725000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1817, "training_iteration": 115, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-22-04", "timestamp": 1706232124, "time_this_iter_s": 10.957602262496948, "time_total_s": 1239.7201993465424, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D7BDC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1239.7201993465424, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 7.737500000000001, "ram_util_percent": 61.96875}}
{"episode_reward_max": 165.9125775732098, "episode_reward_min": -264.16883944347506, "episode_reward_mean": 96.84067567805656, "episode_len_mean": 491.65, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -94.30338052039346}, "policy_reward_max": {"shared_policy": 55.536876751730844}, "policy_reward_mean": {"shared_policy": 32.28022522601886}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.82726107351468, 105.7117582336068, 104.0209114179015, 71.74001174420115, 98.92332440568134, 111.40406043827534, 80.80016220733523, 99.02652108250183, 115.98571495339274, -250.6191208567471, 115.05467518605289, 131.14792213030154, 107.23972032498567, 112.02901381906119, 114.97778162732719, 89.26317152939735, 107.004030380398, 109.10753984376788, 111.08184668421744, 65.233630515635, 106.22938752570187, 93.79522165330125, 108.76141992956397, 110.33588614687322, 123.32730812579393, 89.55198815464973, 98.94832054898143, 117.49070053920147, 148.64132218062858, 117.13694065436721, 104.63271148724014, 89.24749314738436, 93.18435022234917, 100.86699252948165, -264.16883944347506, 78.19610586762425, 80.76846347749232, 101.28245244920254, 129.58923044241968, 87.51618611533195, 79.04996551387012, 121.02721900913454, 96.62256348505616, 103.82122686505318, 69.71717143664135, 114.84529135935007, 115.05388746783136, 82.66610598191616, 122.64360256120563, 93.56860461458562, 130.61644740030164, 105.44677679240704, 137.511679583695, 130.89373084530257, -263.4324786812067, 116.46629769727586, 121.88108812645076, 105.22790687531231, 144.50558718759552, 107.30030279792842, 110.56790264882144, 120.53252869658169, 75.93256045505403, 99.92087399680166, 126.04779209941623, 98.60766397789119, 108.84065857739186, 95.67496652156115, 88.34877679124475, 89.95365823805331, 98.99424967728552, 90.75361186079681, 133.41355917975307, 144.98442363739017, 97.79033887060356, 74.63518793880938, 88.45512999407946, 101.74745170678943, 126.91550877224651, 92.34969269484279, 122.87996386922896, 119.26281052222475, 149.17220940720284, 87.14092328306288, 93.9843154326081, 113.26110249571502, 123.37716764956711, 126.26712691783902, 117.11249715089797, 104.56996344402431, 165.9125775732098, 118.4342697430402, 99.1735882423818, 123.92471907660365, 100.01355635374784, 115.37941997125743, 114.10110600106415, 112.79086792422456, 117.5021630823612, 112.61412791535257], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 283, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 185, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 197, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [44.25069982558489, 44.28362999483943, 44.2929312530905, 35.32062975813945, 35.13551427175601, 35.255614203711346, 35.25266700734694, 34.00792886813481, 34.76031554241975, 24.140897984306008, 23.56208376089731, 24.037029998997838, 32.89730691537261, 33.1641100901179, 32.86190740019083, 37.284862875938416, 37.114532098174095, 37.00466546416283, 26.970849964767694, 26.697366923093796, 27.131945319473743, 32.86704463387528, 33.019718867416174, 33.139757581210375, 38.79109409078956, 38.843506187200546, 38.35111467540264, -83.25334126067659, -83.27655839671692, -84.08922119935355, 38.658883277947695, 38.307016039888055, 38.08877586821714, 43.46753379702568, 44.03092968650162, 43.64945864677429, 35.4750473399957, 35.98508308858921, 35.779589896400765, 37.23958758140603, 37.294266926745564, 37.4951593109096, 37.99226174255212, 38.454535865535334, 38.53098401923974, 29.5968408336242, 29.818782425795987, 29.847548269977167, 35.8921801286439, 35.56635958949724, 35.54549066225687, 36.43837652914226, 36.22208119183779, 36.44708212278783, 37.22384515901406, 37.063640390833214, 36.79436113437016, 21.635524002214268, 21.579784793158368, 22.018321720262364, 35.13350591311851, 35.62796445462541, 35.46791715795794, 31.709487477162227, 30.954168577988938, 31.13156559815009, 36.318037713567406, 36.0709126467506, 36.372469569245965, 36.886302178104714, 36.61197783549626, 36.837606133272246, 41.15881885588169, 41.466107435524464, 40.70238183438778, 30.004794977605343, 29.636351734399796, 29.910841442644596, 33.05286693945527, 32.86921040713787, 33.02624320238829, 39.381255271534116, 38.63116445640722, 39.478280811260134, 49.669866338372216, 49.43063352257012, 49.5408223196864, 39.18703180924058, 38.90392455458641, 39.04598429054022, 35.03954701470987, 34.739648317297295, 34.85351615523298, 29.48931313802798, 29.91701215024416, 29.84116785911222, 31.34519673138857, 31.317152746021748, 30.52200074493885, 33.85499018244445, 33.90791471116245, 33.10408763587475, -84.17332592358193, -85.69213299949965, -94.30338052039346, 26.075471019993216, 26.123348506788403, 25.997286340842635, 26.652404521902398, 27.010198948283985, 27.105860007305935, 33.982363011687994, 33.38800190389156, 33.91208753362298, 43.30063085878888, 43.49082806023458, 42.797771523396165, 29.31966266874224, 29.052349410951138, 29.14417403563857, 26.61407159268856, 25.775964871048927, 26.659929050132632, 39.59232829014459, 40.808916709555575, 40.62597400943437, 31.80017638206482, 32.91441549733281, 31.90797160565853, 34.12521843612194, 34.92156111449003, 34.774447314441204, 23.103450660904244, 23.20696800326307, 23.406752772474036, 37.92039822538693, 38.445129159217075, 38.479763974746064, 38.39347003897031, 38.44733343397577, 38.21308399488528, 27.191079060236603, 27.97731754059592, 27.497709381083638, 40.861118502914906, 40.919184006750584, 40.863300051540136, 31.47901129846771, 30.929515575369194, 31.16007774074872, 43.441752697030694, 43.79151180262366, 43.38318290064731, 35.24496532604098, 34.96268482506275, 35.2391266413033, 45.955092525885746, 45.80639179175098, 45.75019526605804, 43.333808595935494, 43.90512602652112, 43.654796222845704, -84.52637128531933, -84.945003464818, -93.96110393106937, 39.12296485279997, 38.436166291435555, 38.90716655304034, 40.59494674702485, 40.67966340606411, 40.606477973361805, 35.32644614701469, 34.55535890658696, 35.34610182171066, 48.295124109524, 47.94720395157735, 48.26325912649433, 35.41543276111284, 35.83791052053371, 36.04695951628187, 36.86055947902301, 36.85559999073544, 36.85174317906299, 40.33788851896921, 40.47689626427987, 39.71774391333261, 25.692807120581463, 24.432111849387482, 25.807641485085085, 33.24625913550456, 33.35381352373709, 33.32080133756001, 42.11208301285902, 41.58534037570158, 42.35036871085563, 32.66656530400117, 32.618783464034394, 33.32231520985563, 36.13088476782043, 36.41083542218742, 36.29893838738401, 31.047299772500992, 32.453905276954174, 32.17376147210598, 29.56757894717157, 29.571773735806346, 29.20942410826683, 29.848086794217423, 30.217194517453507, 29.888376926382378, 33.218154958138854, 33.18006366925934, 32.59603104988733, 30.25930070132017, 30.063120283186436, 30.431190876290202, 44.60011130198836, 44.406769536435604, 44.4066783413291, 47.82255636155604, 48.6260724402964, 48.53579483553766, 33.05171799721816, 33.121612147583306, 31.617008725802094, 25.01458756377299, 25.008366999526814, 24.612233375509575, 28.901138191421822, 29.745377299686268, 29.808614502971366, 33.18625965714455, 34.08219789713621, 34.478994152508676, 42.16083843509355, 42.33689183617631, 42.41777850097665, 30.46688380340734, 30.88581609229246, 30.996992799142987, 41.001523077487946, 41.029962008818984, 40.84847878292203, 39.56466028094292, 39.85253250785172, 39.84561773343012, 49.94776648438226, 49.453090834120914, 49.77135208869974, 29.53980442788452, 29.135130263864994, 28.465988591313362, 31.669580877448112, 31.650310304636747, 30.66442425052324, 37.63401123136282, 37.68777659535408, 37.93931466899812, 40.724709292252854, 41.368894947071865, 41.283563410242394, 41.85671162108579, 42.19943892459074, 42.21097637216249, 39.04521217693885, 39.11952158560355, 38.94776338835557, 34.65630756815274, 34.67403562863667, 35.239620247234896, 55.01106892029445, 55.36463190118472, 55.536876751730844, 39.773964086547494, 39.336151868104935, 39.324153788387775, 33.05574554701646, 32.91304465134938, 33.20479804401596, 40.986210480332375, 41.286529526114464, 41.65197907015681, 33.53181295841932, 33.64545185863972, 32.836291536688805, 38.52625581187506, 38.45168179584046, 38.401482363541916, 38.11101708809534, 37.77750145892301, 38.2125874540458, 37.56228409955898, 37.21533309916654, 38.013250725499034, 39.104647410412625, 39.275453237195805, 39.12206243475278, 37.75803268452485, 37.110287105043724, 37.745808125783995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14213735804388727, "mean_inference_ms": 0.695793062145784, "mean_action_processing_ms": 0.0957475198684229, "mean_env_wait_ms": 0.7951924700044725, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 580000, "timesteps_this_iter": 0, "agent_timesteps_total": 1740000, "timers": {"sample_time_ms": 10652.506, "sample_throughput": 469.373, "load_time_ms": 0.1, "load_throughput": 50015549.726, "learn_time_ms": 1954.141, "learn_throughput": 2558.67, "update_time_ms": 9.593}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.0389678347315807e-29, "cur_lr": 0.0005000000000000001, "total_loss": 6.078719425201416, "policy_loss": -0.0013165027257769058, "vf_loss": 6.177223491668701, "vf_explained_var": -0.01857740879058838, "kl": 0.0027282152325252863, "entropy": 9.718733978271484, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 580000, "num_agent_steps_sampled": 1740000, "num_steps_trained": 580000, "num_agent_steps_trained": 1740000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1827, "training_iteration": 116, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-22-15", "timestamp": 1706232135, "time_this_iter_s": 10.453618288040161, "time_total_s": 1250.1738176345825, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402DF0A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1250.1738176345825, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 7.9142857142857155, "ram_util_percent": 62.135714285714286}}
{"episode_reward_max": 165.9125775732098, "episode_reward_min": -264.16883944347506, "episode_reward_mean": 100.62972228173065, "episode_len_mean": 493.82, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -94.30338052039346}, "policy_reward_max": {"shared_policy": 55.536876751730844}, "policy_reward_mean": {"shared_policy": 33.54324076057687}, "custom_metrics": {}, "hist_stats": {"episode_reward": [115.05467518605289, 131.14792213030154, 107.23972032498567, 112.02901381906119, 114.97778162732719, 89.26317152939735, 107.004030380398, 109.10753984376788, 111.08184668421744, 65.233630515635, 106.22938752570187, 93.79522165330125, 108.76141992956397, 110.33588614687322, 123.32730812579393, 89.55198815464973, 98.94832054898143, 117.49070053920147, 148.64132218062858, 117.13694065436721, 104.63271148724014, 89.24749314738436, 93.18435022234917, 100.86699252948165, -264.16883944347506, 78.19610586762425, 80.76846347749232, 101.28245244920254, 129.58923044241968, 87.51618611533195, 79.04996551387012, 121.02721900913454, 96.62256348505616, 103.82122686505318, 69.71717143664135, 114.84529135935007, 115.05388746783136, 82.66610598191616, 122.64360256120563, 93.56860461458562, 130.61644740030164, 105.44677679240704, 137.511679583695, 130.89373084530257, -263.4324786812067, 116.46629769727586, 121.88108812645076, 105.22790687531231, 144.50558718759552, 107.30030279792842, 110.56790264882144, 120.53252869658169, 75.93256045505403, 99.92087399680166, 126.04779209941623, 98.60766397789119, 108.84065857739186, 95.67496652156115, 88.34877679124475, 89.95365823805331, 98.99424967728552, 90.75361186079681, 133.41355917975307, 144.98442363739017, 97.79033887060356, 74.63518793880938, 88.45512999407946, 101.74745170678943, 126.91550877224651, 92.34969269484279, 122.87996386922896, 119.26281052222475, 149.17220940720284, 87.14092328306288, 93.9843154326081, 113.26110249571502, 123.37716764956711, 126.26712691783902, 117.11249715089797, 104.56996344402431, 165.9125775732098, 118.4342697430402, 99.1735882423818, 123.92471907660365, 100.01355635374784, 115.37941997125743, 114.10110600106415, 112.79086792422456, 117.5021630823612, 112.61412791535257, 86.42325198510659, 122.48507402231917, 90.56586074642837, 95.03227677196263, 86.96774041652677, 126.37574340589345, 83.51347497478125, 107.21955514699219, 128.05466243997213, 122.08762515708804], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 185, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 197, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [38.658883277947695, 38.307016039888055, 38.08877586821714, 43.46753379702568, 44.03092968650162, 43.64945864677429, 35.4750473399957, 35.98508308858921, 35.779589896400765, 37.23958758140603, 37.294266926745564, 37.4951593109096, 37.99226174255212, 38.454535865535334, 38.53098401923974, 29.5968408336242, 29.818782425795987, 29.847548269977167, 35.8921801286439, 35.56635958949724, 35.54549066225687, 36.43837652914226, 36.22208119183779, 36.44708212278783, 37.22384515901406, 37.063640390833214, 36.79436113437016, 21.635524002214268, 21.579784793158368, 22.018321720262364, 35.13350591311851, 35.62796445462541, 35.46791715795794, 31.709487477162227, 30.954168577988938, 31.13156559815009, 36.318037713567406, 36.0709126467506, 36.372469569245965, 36.886302178104714, 36.61197783549626, 36.837606133272246, 41.15881885588169, 41.466107435524464, 40.70238183438778, 30.004794977605343, 29.636351734399796, 29.910841442644596, 33.05286693945527, 32.86921040713787, 33.02624320238829, 39.381255271534116, 38.63116445640722, 39.478280811260134, 49.669866338372216, 49.43063352257012, 49.5408223196864, 39.18703180924058, 38.90392455458641, 39.04598429054022, 35.03954701470987, 34.739648317297295, 34.85351615523298, 29.48931313802798, 29.91701215024416, 29.84116785911222, 31.34519673138857, 31.317152746021748, 30.52200074493885, 33.85499018244445, 33.90791471116245, 33.10408763587475, -84.17332592358193, -85.69213299949965, -94.30338052039346, 26.075471019993216, 26.123348506788403, 25.997286340842635, 26.652404521902398, 27.010198948283985, 27.105860007305935, 33.982363011687994, 33.38800190389156, 33.91208753362298, 43.30063085878888, 43.49082806023458, 42.797771523396165, 29.31966266874224, 29.052349410951138, 29.14417403563857, 26.61407159268856, 25.775964871048927, 26.659929050132632, 39.59232829014459, 40.808916709555575, 40.62597400943437, 31.80017638206482, 32.91441549733281, 31.90797160565853, 34.12521843612194, 34.92156111449003, 34.774447314441204, 23.103450660904244, 23.20696800326307, 23.406752772474036, 37.92039822538693, 38.445129159217075, 38.479763974746064, 38.39347003897031, 38.44733343397577, 38.21308399488528, 27.191079060236603, 27.97731754059592, 27.497709381083638, 40.861118502914906, 40.919184006750584, 40.863300051540136, 31.47901129846771, 30.929515575369194, 31.16007774074872, 43.441752697030694, 43.79151180262366, 43.38318290064731, 35.24496532604098, 34.96268482506275, 35.2391266413033, 45.955092525885746, 45.80639179175098, 45.75019526605804, 43.333808595935494, 43.90512602652112, 43.654796222845704, -84.52637128531933, -84.945003464818, -93.96110393106937, 39.12296485279997, 38.436166291435555, 38.90716655304034, 40.59494674702485, 40.67966340606411, 40.606477973361805, 35.32644614701469, 34.55535890658696, 35.34610182171066, 48.295124109524, 47.94720395157735, 48.26325912649433, 35.41543276111284, 35.83791052053371, 36.04695951628187, 36.86055947902301, 36.85559999073544, 36.85174317906299, 40.33788851896921, 40.47689626427987, 39.71774391333261, 25.692807120581463, 24.432111849387482, 25.807641485085085, 33.24625913550456, 33.35381352373709, 33.32080133756001, 42.11208301285902, 41.58534037570158, 42.35036871085563, 32.66656530400117, 32.618783464034394, 33.32231520985563, 36.13088476782043, 36.41083542218742, 36.29893838738401, 31.047299772500992, 32.453905276954174, 32.17376147210598, 29.56757894717157, 29.571773735806346, 29.20942410826683, 29.848086794217423, 30.217194517453507, 29.888376926382378, 33.218154958138854, 33.18006366925934, 32.59603104988733, 30.25930070132017, 30.063120283186436, 30.431190876290202, 44.60011130198836, 44.406769536435604, 44.4066783413291, 47.82255636155604, 48.6260724402964, 48.53579483553766, 33.05171799721816, 33.121612147583306, 31.617008725802094, 25.01458756377299, 25.008366999526814, 24.612233375509575, 28.901138191421822, 29.745377299686268, 29.808614502971366, 33.18625965714455, 34.08219789713621, 34.478994152508676, 42.16083843509355, 42.33689183617631, 42.41777850097665, 30.46688380340734, 30.88581609229246, 30.996992799142987, 41.001523077487946, 41.029962008818984, 40.84847878292203, 39.56466028094292, 39.85253250785172, 39.84561773343012, 49.94776648438226, 49.453090834120914, 49.77135208869974, 29.53980442788452, 29.135130263864994, 28.465988591313362, 31.669580877448112, 31.650310304636747, 30.66442425052324, 37.63401123136282, 37.68777659535408, 37.93931466899812, 40.724709292252854, 41.368894947071865, 41.283563410242394, 41.85671162108579, 42.19943892459074, 42.21097637216249, 39.04521217693885, 39.11952158560355, 38.94776338835557, 34.65630756815274, 34.67403562863667, 35.239620247234896, 55.01106892029445, 55.36463190118472, 55.536876751730844, 39.773964086547494, 39.336151868104935, 39.324153788387775, 33.05574554701646, 32.91304465134938, 33.20479804401596, 40.986210480332375, 41.286529526114464, 41.65197907015681, 33.53181295841932, 33.64545185863972, 32.836291536688805, 38.52625581187506, 38.45168179584046, 38.401482363541916, 38.11101708809534, 37.77750145892301, 38.2125874540458, 37.56228409955898, 37.21533309916654, 38.013250725499034, 39.104647410412625, 39.275453237195805, 39.12206243475278, 37.75803268452485, 37.110287105043724, 37.745808125783995, 29.026324273242295, 28.78390523294607, 28.613022478918225, 40.99268787493929, 40.76613274589181, 40.726253401488066, 29.944470487535, 30.405938839539886, 30.215451419353485, 32.03970727821191, 31.99484461297591, 30.99772488077481, 29.3234728972117, 29.487918535868317, 28.156348983446748, 42.22705846466124, 42.221827141940594, 41.92685779929161, 27.820088716844708, 27.561463604370743, 28.131922653565795, 35.300350447495774, 36.01480569442113, 35.90439900507529, 42.8342367025713, 42.56263984988132, 42.65778588751951, 40.53418678045273, 40.728220481425524, 40.82521789520979]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1421113514643495, "mean_inference_ms": 0.6957710804850257, "mean_action_processing_ms": 0.09572979064921772, "mean_env_wait_ms": 0.7951282632654367, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 585000, "timesteps_this_iter": 0, "agent_timesteps_total": 1755000, "timers": {"sample_time_ms": 10587.059, "sample_throughput": 472.275, "load_time_ms": 0.1, "load_throughput": 50015549.726, "learn_time_ms": 1943.038, "learn_throughput": 2573.289, "update_time_ms": 9.595}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.0194839173657903e-29, "cur_lr": 0.0005000000000000001, "total_loss": 5.727640771865845, "policy_loss": -0.0017067976669626005, "vf_loss": 5.826962327957153, "vf_explained_var": -0.03125715255737305, "kl": 0.0025282852555744825, "entropy": 9.761461162567139, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 585000, "num_agent_steps_sampled": 1755000, "num_steps_trained": 585000, "num_agent_steps_trained": 1755000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1837, "training_iteration": 117, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-22-25", "timestamp": 1706232145, "time_this_iter_s": 10.250974655151367, "time_total_s": 1260.424792289734, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021400813E50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1260.424792289734, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 7.1866666666666665, "ram_util_percent": 62.19333333333335}}
{"episode_reward_max": 170.67842895537623, "episode_reward_min": -264.16883944347506, "episode_reward_mean": 101.52807314550053, "episode_len_mean": 493.82, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -94.30338052039346}, "policy_reward_max": {"shared_policy": 57.04860445236166}, "policy_reward_mean": {"shared_policy": 33.84269104850018}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.22938752570187, 93.79522165330125, 108.76141992956397, 110.33588614687322, 123.32730812579393, 89.55198815464973, 98.94832054898143, 117.49070053920147, 148.64132218062858, 117.13694065436721, 104.63271148724014, 89.24749314738436, 93.18435022234917, 100.86699252948165, -264.16883944347506, 78.19610586762425, 80.76846347749232, 101.28245244920254, 129.58923044241968, 87.51618611533195, 79.04996551387012, 121.02721900913454, 96.62256348505616, 103.82122686505318, 69.71717143664135, 114.84529135935007, 115.05388746783136, 82.66610598191616, 122.64360256120563, 93.56860461458562, 130.61644740030164, 105.44677679240704, 137.511679583695, 130.89373084530257, -263.4324786812067, 116.46629769727586, 121.88108812645076, 105.22790687531231, 144.50558718759552, 107.30030279792842, 110.56790264882144, 120.53252869658169, 75.93256045505403, 99.92087399680166, 126.04779209941623, 98.60766397789119, 108.84065857739186, 95.67496652156115, 88.34877679124475, 89.95365823805331, 98.99424967728552, 90.75361186079681, 133.41355917975307, 144.98442363739017, 97.79033887060356, 74.63518793880938, 88.45512999407946, 101.74745170678943, 126.91550877224651, 92.34969269484279, 122.87996386922896, 119.26281052222475, 149.17220940720284, 87.14092328306288, 93.9843154326081, 113.26110249571502, 123.37716764956711, 126.26712691783902, 117.11249715089797, 104.56996344402431, 165.9125775732098, 118.4342697430402, 99.1735882423818, 123.92471907660365, 100.01355635374784, 115.37941997125743, 114.10110600106415, 112.79086792422456, 117.5021630823612, 112.61412791535257, 86.42325198510659, 122.48507402231917, 90.56586074642837, 95.03227677196263, 86.96774041652677, 126.37574340589345, 83.51347497478125, 107.21955514699219, 128.05466243997213, 122.08762515708804, 115.77530775358899, 112.47965482994914, 89.11798971425742, 112.66790197789668, 170.67842895537623, 144.32708508148795, 73.27047828875948, 132.1522795520724, 99.91329950280486, 101.59199276193976], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 185, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 197, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [35.13350591311851, 35.62796445462541, 35.46791715795794, 31.709487477162227, 30.954168577988938, 31.13156559815009, 36.318037713567406, 36.0709126467506, 36.372469569245965, 36.886302178104714, 36.61197783549626, 36.837606133272246, 41.15881885588169, 41.466107435524464, 40.70238183438778, 30.004794977605343, 29.636351734399796, 29.910841442644596, 33.05286693945527, 32.86921040713787, 33.02624320238829, 39.381255271534116, 38.63116445640722, 39.478280811260134, 49.669866338372216, 49.43063352257012, 49.5408223196864, 39.18703180924058, 38.90392455458641, 39.04598429054022, 35.03954701470987, 34.739648317297295, 34.85351615523298, 29.48931313802798, 29.91701215024416, 29.84116785911222, 31.34519673138857, 31.317152746021748, 30.52200074493885, 33.85499018244445, 33.90791471116245, 33.10408763587475, -84.17332592358193, -85.69213299949965, -94.30338052039346, 26.075471019993216, 26.123348506788403, 25.997286340842635, 26.652404521902398, 27.010198948283985, 27.105860007305935, 33.982363011687994, 33.38800190389156, 33.91208753362298, 43.30063085878888, 43.49082806023458, 42.797771523396165, 29.31966266874224, 29.052349410951138, 29.14417403563857, 26.61407159268856, 25.775964871048927, 26.659929050132632, 39.59232829014459, 40.808916709555575, 40.62597400943437, 31.80017638206482, 32.91441549733281, 31.90797160565853, 34.12521843612194, 34.92156111449003, 34.774447314441204, 23.103450660904244, 23.20696800326307, 23.406752772474036, 37.92039822538693, 38.445129159217075, 38.479763974746064, 38.39347003897031, 38.44733343397577, 38.21308399488528, 27.191079060236603, 27.97731754059592, 27.497709381083638, 40.861118502914906, 40.919184006750584, 40.863300051540136, 31.47901129846771, 30.929515575369194, 31.16007774074872, 43.441752697030694, 43.79151180262366, 43.38318290064731, 35.24496532604098, 34.96268482506275, 35.2391266413033, 45.955092525885746, 45.80639179175098, 45.75019526605804, 43.333808595935494, 43.90512602652112, 43.654796222845704, -84.52637128531933, -84.945003464818, -93.96110393106937, 39.12296485279997, 38.436166291435555, 38.90716655304034, 40.59494674702485, 40.67966340606411, 40.606477973361805, 35.32644614701469, 34.55535890658696, 35.34610182171066, 48.295124109524, 47.94720395157735, 48.26325912649433, 35.41543276111284, 35.83791052053371, 36.04695951628187, 36.86055947902301, 36.85559999073544, 36.85174317906299, 40.33788851896921, 40.47689626427987, 39.71774391333261, 25.692807120581463, 24.432111849387482, 25.807641485085085, 33.24625913550456, 33.35381352373709, 33.32080133756001, 42.11208301285902, 41.58534037570158, 42.35036871085563, 32.66656530400117, 32.618783464034394, 33.32231520985563, 36.13088476782043, 36.41083542218742, 36.29893838738401, 31.047299772500992, 32.453905276954174, 32.17376147210598, 29.56757894717157, 29.571773735806346, 29.20942410826683, 29.848086794217423, 30.217194517453507, 29.888376926382378, 33.218154958138854, 33.18006366925934, 32.59603104988733, 30.25930070132017, 30.063120283186436, 30.431190876290202, 44.60011130198836, 44.406769536435604, 44.4066783413291, 47.82255636155604, 48.6260724402964, 48.53579483553766, 33.05171799721816, 33.121612147583306, 31.617008725802094, 25.01458756377299, 25.008366999526814, 24.612233375509575, 28.901138191421822, 29.745377299686268, 29.808614502971366, 33.18625965714455, 34.08219789713621, 34.478994152508676, 42.16083843509355, 42.33689183617631, 42.41777850097665, 30.46688380340734, 30.88581609229246, 30.996992799142987, 41.001523077487946, 41.029962008818984, 40.84847878292203, 39.56466028094292, 39.85253250785172, 39.84561773343012, 49.94776648438226, 49.453090834120914, 49.77135208869974, 29.53980442788452, 29.135130263864994, 28.465988591313362, 31.669580877448112, 31.650310304636747, 30.66442425052324, 37.63401123136282, 37.68777659535408, 37.93931466899812, 40.724709292252854, 41.368894947071865, 41.283563410242394, 41.85671162108579, 42.19943892459074, 42.21097637216249, 39.04521217693885, 39.11952158560355, 38.94776338835557, 34.65630756815274, 34.67403562863667, 35.239620247234896, 55.01106892029445, 55.36463190118472, 55.536876751730844, 39.773964086547494, 39.336151868104935, 39.324153788387775, 33.05574554701646, 32.91304465134938, 33.20479804401596, 40.986210480332375, 41.286529526114464, 41.65197907015681, 33.53181295841932, 33.64545185863972, 32.836291536688805, 38.52625581187506, 38.45168179584046, 38.401482363541916, 38.11101708809534, 37.77750145892301, 38.2125874540458, 37.56228409955898, 37.21533309916654, 38.013250725499034, 39.104647410412625, 39.275453237195805, 39.12206243475278, 37.75803268452485, 37.110287105043724, 37.745808125783995, 29.026324273242295, 28.78390523294607, 28.613022478918225, 40.99268787493929, 40.76613274589181, 40.726253401488066, 29.944470487535, 30.405938839539886, 30.215451419353485, 32.03970727821191, 31.99484461297591, 30.99772488077481, 29.3234728972117, 29.487918535868317, 28.156348983446748, 42.22705846466124, 42.221827141940594, 41.92685779929161, 27.820088716844708, 27.561463604370743, 28.131922653565795, 35.300350447495774, 36.01480569442113, 35.90439900507529, 42.8342367025713, 42.56263984988132, 42.65778588751951, 40.53418678045273, 40.728220481425524, 40.82521789520979, 37.92975695927937, 39.05587181340282, 38.7896789809068, 37.136410623788834, 37.534263394773006, 37.8089808113873, 29.816222185268998, 29.86288116220385, 29.438886366784573, 37.81209137787421, 37.55541272958119, 37.30039787044127, 57.04860445236166, 56.67878048618634, 56.951044016828135, 47.8799140850703, 48.25614655638735, 48.19102444003026, 23.916541561484337, 24.549064692109823, 24.804872035165317, 44.17079544067383, 43.734522968530655, 44.246961142867804, 33.74411607471605, 33.184511115153626, 32.98467231293519, 33.726144567131996, 34.18077592179179, 33.685072273015976]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14209315001909395, "mean_inference_ms": 0.695773402163447, "mean_action_processing_ms": 0.09572919371764664, "mean_env_wait_ms": 0.7949524097454392, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 590000, "timesteps_this_iter": 0, "agent_timesteps_total": 1770000, "timers": {"sample_time_ms": 10550.161, "sample_throughput": 473.926, "load_time_ms": 0.1, "load_throughput": 50015549.726, "learn_time_ms": 1934.608, "learn_throughput": 2584.502, "update_time_ms": 9.594}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0097419586828952e-29, "cur_lr": 0.0005000000000000001, "total_loss": 7.4915135383605955, "policy_loss": -0.0012879222733030993, "vf_loss": 7.589588451385498, "vf_explained_var": -0.003945088386535645, "kl": 0.0022339501884171688, "entropy": 9.678671932220459, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 590000, "num_agent_steps_sampled": 1770000, "num_steps_trained": 590000, "num_agent_steps_trained": 1770000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1847, "training_iteration": 118, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-22-35", "timestamp": 1706232155, "time_this_iter_s": 10.326149702072144, "time_total_s": 1270.750941991806, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402417F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1270.750941991806, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 7.485714285714285, "ram_util_percent": 61.957142857142856}}
{"episode_reward_max": 170.67842895537623, "episode_reward_min": -264.16883944347506, "episode_reward_mean": 102.51073491010364, "episode_len_mean": 493.82, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -94.30338052039346}, "policy_reward_max": {"shared_policy": 57.04860445236166}, "policy_reward_mean": {"shared_policy": 34.170244970034545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [104.63271148724014, 89.24749314738436, 93.18435022234917, 100.86699252948165, -264.16883944347506, 78.19610586762425, 80.76846347749232, 101.28245244920254, 129.58923044241968, 87.51618611533195, 79.04996551387012, 121.02721900913454, 96.62256348505616, 103.82122686505318, 69.71717143664135, 114.84529135935007, 115.05388746783136, 82.66610598191616, 122.64360256120563, 93.56860461458562, 130.61644740030164, 105.44677679240704, 137.511679583695, 130.89373084530257, -263.4324786812067, 116.46629769727586, 121.88108812645076, 105.22790687531231, 144.50558718759552, 107.30030279792842, 110.56790264882144, 120.53252869658169, 75.93256045505403, 99.92087399680166, 126.04779209941623, 98.60766397789119, 108.84065857739186, 95.67496652156115, 88.34877679124475, 89.95365823805331, 98.99424967728552, 90.75361186079681, 133.41355917975307, 144.98442363739017, 97.79033887060356, 74.63518793880938, 88.45512999407946, 101.74745170678943, 126.91550877224651, 92.34969269484279, 122.87996386922896, 119.26281052222475, 149.17220940720284, 87.14092328306288, 93.9843154326081, 113.26110249571502, 123.37716764956711, 126.26712691783902, 117.11249715089797, 104.56996344402431, 165.9125775732098, 118.4342697430402, 99.1735882423818, 123.92471907660365, 100.01355635374784, 115.37941997125743, 114.10110600106415, 112.79086792422456, 117.5021630823612, 112.61412791535257, 86.42325198510659, 122.48507402231917, 90.56586074642837, 95.03227677196263, 86.96774041652677, 126.37574340589345, 83.51347497478125, 107.21955514699219, 128.05466243997213, 122.08762515708804, 115.77530775358899, 112.47965482994914, 89.11798971425742, 112.66790197789668, 170.67842895537623, 144.32708508148795, 73.27047828875948, 132.1522795520724, 99.91329950280486, 101.59199276193976, 116.79179644375108, 130.8780870046467, 131.9606794267891, 132.25329755246628, 131.22323370911198, 118.30614811927079, 75.39022989571095, 170.1207499541343, 113.19346872437744, 92.36698108911514], "episode_lengths": [500, 500, 500, 500, 185, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 197, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [35.03954701470987, 34.739648317297295, 34.85351615523298, 29.48931313802798, 29.91701215024416, 29.84116785911222, 31.34519673138857, 31.317152746021748, 30.52200074493885, 33.85499018244445, 33.90791471116245, 33.10408763587475, -84.17332592358193, -85.69213299949965, -94.30338052039346, 26.075471019993216, 26.123348506788403, 25.997286340842635, 26.652404521902398, 27.010198948283985, 27.105860007305935, 33.982363011687994, 33.38800190389156, 33.91208753362298, 43.30063085878888, 43.49082806023458, 42.797771523396165, 29.31966266874224, 29.052349410951138, 29.14417403563857, 26.61407159268856, 25.775964871048927, 26.659929050132632, 39.59232829014459, 40.808916709555575, 40.62597400943437, 31.80017638206482, 32.91441549733281, 31.90797160565853, 34.12521843612194, 34.92156111449003, 34.774447314441204, 23.103450660904244, 23.20696800326307, 23.406752772474036, 37.92039822538693, 38.445129159217075, 38.479763974746064, 38.39347003897031, 38.44733343397577, 38.21308399488528, 27.191079060236603, 27.97731754059592, 27.497709381083638, 40.861118502914906, 40.919184006750584, 40.863300051540136, 31.47901129846771, 30.929515575369194, 31.16007774074872, 43.441752697030694, 43.79151180262366, 43.38318290064731, 35.24496532604098, 34.96268482506275, 35.2391266413033, 45.955092525885746, 45.80639179175098, 45.75019526605804, 43.333808595935494, 43.90512602652112, 43.654796222845704, -84.52637128531933, -84.945003464818, -93.96110393106937, 39.12296485279997, 38.436166291435555, 38.90716655304034, 40.59494674702485, 40.67966340606411, 40.606477973361805, 35.32644614701469, 34.55535890658696, 35.34610182171066, 48.295124109524, 47.94720395157735, 48.26325912649433, 35.41543276111284, 35.83791052053371, 36.04695951628187, 36.86055947902301, 36.85559999073544, 36.85174317906299, 40.33788851896921, 40.47689626427987, 39.71774391333261, 25.692807120581463, 24.432111849387482, 25.807641485085085, 33.24625913550456, 33.35381352373709, 33.32080133756001, 42.11208301285902, 41.58534037570158, 42.35036871085563, 32.66656530400117, 32.618783464034394, 33.32231520985563, 36.13088476782043, 36.41083542218742, 36.29893838738401, 31.047299772500992, 32.453905276954174, 32.17376147210598, 29.56757894717157, 29.571773735806346, 29.20942410826683, 29.848086794217423, 30.217194517453507, 29.888376926382378, 33.218154958138854, 33.18006366925934, 32.59603104988733, 30.25930070132017, 30.063120283186436, 30.431190876290202, 44.60011130198836, 44.406769536435604, 44.4066783413291, 47.82255636155604, 48.6260724402964, 48.53579483553766, 33.05171799721816, 33.121612147583306, 31.617008725802094, 25.01458756377299, 25.008366999526814, 24.612233375509575, 28.901138191421822, 29.745377299686268, 29.808614502971366, 33.18625965714455, 34.08219789713621, 34.478994152508676, 42.16083843509355, 42.33689183617631, 42.41777850097665, 30.46688380340734, 30.88581609229246, 30.996992799142987, 41.001523077487946, 41.029962008818984, 40.84847878292203, 39.56466028094292, 39.85253250785172, 39.84561773343012, 49.94776648438226, 49.453090834120914, 49.77135208869974, 29.53980442788452, 29.135130263864994, 28.465988591313362, 31.669580877448112, 31.650310304636747, 30.66442425052324, 37.63401123136282, 37.68777659535408, 37.93931466899812, 40.724709292252854, 41.368894947071865, 41.283563410242394, 41.85671162108579, 42.19943892459074, 42.21097637216249, 39.04521217693885, 39.11952158560355, 38.94776338835557, 34.65630756815274, 34.67403562863667, 35.239620247234896, 55.01106892029445, 55.36463190118472, 55.536876751730844, 39.773964086547494, 39.336151868104935, 39.324153788387775, 33.05574554701646, 32.91304465134938, 33.20479804401596, 40.986210480332375, 41.286529526114464, 41.65197907015681, 33.53181295841932, 33.64545185863972, 32.836291536688805, 38.52625581187506, 38.45168179584046, 38.401482363541916, 38.11101708809534, 37.77750145892301, 38.2125874540458, 37.56228409955898, 37.21533309916654, 38.013250725499034, 39.104647410412625, 39.275453237195805, 39.12206243475278, 37.75803268452485, 37.110287105043724, 37.745808125783995, 29.026324273242295, 28.78390523294607, 28.613022478918225, 40.99268787493929, 40.76613274589181, 40.726253401488066, 29.944470487535, 30.405938839539886, 30.215451419353485, 32.03970727821191, 31.99484461297591, 30.99772488077481, 29.3234728972117, 29.487918535868317, 28.156348983446748, 42.22705846466124, 42.221827141940594, 41.92685779929161, 27.820088716844708, 27.561463604370743, 28.131922653565795, 35.300350447495774, 36.01480569442113, 35.90439900507529, 42.8342367025713, 42.56263984988132, 42.65778588751951, 40.53418678045273, 40.728220481425524, 40.82521789520979, 37.92975695927937, 39.05587181340282, 38.7896789809068, 37.136410623788834, 37.534263394773006, 37.8089808113873, 29.816222185268998, 29.86288116220385, 29.438886366784573, 37.81209137787421, 37.55541272958119, 37.30039787044127, 57.04860445236166, 56.67878048618634, 56.951044016828135, 47.8799140850703, 48.25614655638735, 48.19102444003026, 23.916541561484337, 24.549064692109823, 24.804872035165317, 44.17079544067383, 43.734522968530655, 44.246961142867804, 33.74411607471605, 33.184511115153626, 32.98467231293519, 33.726144567131996, 34.18077592179179, 33.685072273015976, 39.264157181372866, 39.07556650787592, 38.4520727545023, 43.43248230467239, 43.70428877944747, 43.74131592052677, 44.189218054215104, 43.877202714482934, 43.89425865809122, 43.58300307889779, 44.08685917158921, 44.58343530197938, 44.09096420556307, 44.23512095399201, 42.89714854955673, 39.42942205568154, 39.348971394201115, 39.52775466938813, 25.065872110426426, 25.174113288521767, 25.150244496762753, 56.68901805331309, 56.669387505700186, 56.762344395120934, 37.44498758514722, 38.05315989473213, 37.69532124449809, 30.906278885900974, 30.872522428631783, 30.588179774582386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1420773013255594, "mean_inference_ms": 0.6957468000464425, "mean_action_processing_ms": 0.09573308305454509, "mean_env_wait_ms": 0.7947566143172338, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 595000, "timesteps_this_iter": 0, "agent_timesteps_total": 1785000, "timers": {"sample_time_ms": 10517.259, "sample_throughput": 475.409, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1927.328, "learn_throughput": 2594.265, "update_time_ms": 9.594}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.048709793414476e-30, "cur_lr": 0.0005000000000000001, "total_loss": 6.651995277404785, "policy_loss": -0.0018030933950106132, "vf_loss": 6.752618837356567, "vf_explained_var": -0.020964574813842774, "kl": 0.0021126194217139954, "entropy": 9.8820556640625, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 595000, "num_agent_steps_sampled": 1785000, "num_steps_trained": 595000, "num_agent_steps_trained": 1785000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1857, "training_iteration": 119, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-22-46", "timestamp": 1706232166, "time_this_iter_s": 10.505738019943237, "time_total_s": 1281.2566800117493, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021400886EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1281.2566800117493, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 6.040000000000001, "ram_util_percent": 61.62000000000001}}
{"episode_reward_max": 170.67842895537623, "episode_reward_min": -263.4324786812067, "episode_reward_mean": 107.95960637714059, "episode_len_mean": 496.97, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -93.96110393106937}, "policy_reward_max": {"shared_policy": 57.04860445236166}, "policy_reward_mean": {"shared_policy": 35.986535459046856}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.04996551387012, 121.02721900913454, 96.62256348505616, 103.82122686505318, 69.71717143664135, 114.84529135935007, 115.05388746783136, 82.66610598191616, 122.64360256120563, 93.56860461458562, 130.61644740030164, 105.44677679240704, 137.511679583695, 130.89373084530257, -263.4324786812067, 116.46629769727586, 121.88108812645076, 105.22790687531231, 144.50558718759552, 107.30030279792842, 110.56790264882144, 120.53252869658169, 75.93256045505403, 99.92087399680166, 126.04779209941623, 98.60766397789119, 108.84065857739186, 95.67496652156115, 88.34877679124475, 89.95365823805331, 98.99424967728552, 90.75361186079681, 133.41355917975307, 144.98442363739017, 97.79033887060356, 74.63518793880938, 88.45512999407946, 101.74745170678943, 126.91550877224651, 92.34969269484279, 122.87996386922896, 119.26281052222475, 149.17220940720284, 87.14092328306288, 93.9843154326081, 113.26110249571502, 123.37716764956711, 126.26712691783902, 117.11249715089797, 104.56996344402431, 165.9125775732098, 118.4342697430402, 99.1735882423818, 123.92471907660365, 100.01355635374784, 115.37941997125743, 114.10110600106415, 112.79086792422456, 117.5021630823612, 112.61412791535257, 86.42325198510659, 122.48507402231917, 90.56586074642837, 95.03227677196263, 86.96774041652677, 126.37574340589345, 83.51347497478125, 107.21955514699219, 128.05466243997213, 122.08762515708804, 115.77530775358899, 112.47965482994914, 89.11798971425742, 112.66790197789668, 170.67842895537623, 144.32708508148795, 73.27047828875948, 132.1522795520724, 99.91329950280486, 101.59199276193976, 116.79179644375108, 130.8780870046467, 131.9606794267891, 132.25329755246628, 131.22323370911198, 118.30614811927079, 75.39022989571095, 170.1207499541343, 113.19346872437744, 92.36698108911514, 119.68093552812931, 128.06352934241295, 81.97465119510886, 125.34432841092348, 125.62002419680357, 134.31149846687896, 116.86246445719732, 118.98893000185488, 86.51248329225928, 108.64344810717739], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 197, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [26.61407159268856, 25.775964871048927, 26.659929050132632, 39.59232829014459, 40.808916709555575, 40.62597400943437, 31.80017638206482, 32.91441549733281, 31.90797160565853, 34.12521843612194, 34.92156111449003, 34.774447314441204, 23.103450660904244, 23.20696800326307, 23.406752772474036, 37.92039822538693, 38.445129159217075, 38.479763974746064, 38.39347003897031, 38.44733343397577, 38.21308399488528, 27.191079060236603, 27.97731754059592, 27.497709381083638, 40.861118502914906, 40.919184006750584, 40.863300051540136, 31.47901129846771, 30.929515575369194, 31.16007774074872, 43.441752697030694, 43.79151180262366, 43.38318290064731, 35.24496532604098, 34.96268482506275, 35.2391266413033, 45.955092525885746, 45.80639179175098, 45.75019526605804, 43.333808595935494, 43.90512602652112, 43.654796222845704, -84.52637128531933, -84.945003464818, -93.96110393106937, 39.12296485279997, 38.436166291435555, 38.90716655304034, 40.59494674702485, 40.67966340606411, 40.606477973361805, 35.32644614701469, 34.55535890658696, 35.34610182171066, 48.295124109524, 47.94720395157735, 48.26325912649433, 35.41543276111284, 35.83791052053371, 36.04695951628187, 36.86055947902301, 36.85559999073544, 36.85174317906299, 40.33788851896921, 40.47689626427987, 39.71774391333261, 25.692807120581463, 24.432111849387482, 25.807641485085085, 33.24625913550456, 33.35381352373709, 33.32080133756001, 42.11208301285902, 41.58534037570158, 42.35036871085563, 32.66656530400117, 32.618783464034394, 33.32231520985563, 36.13088476782043, 36.41083542218742, 36.29893838738401, 31.047299772500992, 32.453905276954174, 32.17376147210598, 29.56757894717157, 29.571773735806346, 29.20942410826683, 29.848086794217423, 30.217194517453507, 29.888376926382378, 33.218154958138854, 33.18006366925934, 32.59603104988733, 30.25930070132017, 30.063120283186436, 30.431190876290202, 44.60011130198836, 44.406769536435604, 44.4066783413291, 47.82255636155604, 48.6260724402964, 48.53579483553766, 33.05171799721816, 33.121612147583306, 31.617008725802094, 25.01458756377299, 25.008366999526814, 24.612233375509575, 28.901138191421822, 29.745377299686268, 29.808614502971366, 33.18625965714455, 34.08219789713621, 34.478994152508676, 42.16083843509355, 42.33689183617631, 42.41777850097665, 30.46688380340734, 30.88581609229246, 30.996992799142987, 41.001523077487946, 41.029962008818984, 40.84847878292203, 39.56466028094292, 39.85253250785172, 39.84561773343012, 49.94776648438226, 49.453090834120914, 49.77135208869974, 29.53980442788452, 29.135130263864994, 28.465988591313362, 31.669580877448112, 31.650310304636747, 30.66442425052324, 37.63401123136282, 37.68777659535408, 37.93931466899812, 40.724709292252854, 41.368894947071865, 41.283563410242394, 41.85671162108579, 42.19943892459074, 42.21097637216249, 39.04521217693885, 39.11952158560355, 38.94776338835557, 34.65630756815274, 34.67403562863667, 35.239620247234896, 55.01106892029445, 55.36463190118472, 55.536876751730844, 39.773964086547494, 39.336151868104935, 39.324153788387775, 33.05574554701646, 32.91304465134938, 33.20479804401596, 40.986210480332375, 41.286529526114464, 41.65197907015681, 33.53181295841932, 33.64545185863972, 32.836291536688805, 38.52625581187506, 38.45168179584046, 38.401482363541916, 38.11101708809534, 37.77750145892301, 38.2125874540458, 37.56228409955898, 37.21533309916654, 38.013250725499034, 39.104647410412625, 39.275453237195805, 39.12206243475278, 37.75803268452485, 37.110287105043724, 37.745808125783995, 29.026324273242295, 28.78390523294607, 28.613022478918225, 40.99268787493929, 40.76613274589181, 40.726253401488066, 29.944470487535, 30.405938839539886, 30.215451419353485, 32.03970727821191, 31.99484461297591, 30.99772488077481, 29.3234728972117, 29.487918535868317, 28.156348983446748, 42.22705846466124, 42.221827141940594, 41.92685779929161, 27.820088716844708, 27.561463604370743, 28.131922653565795, 35.300350447495774, 36.01480569442113, 35.90439900507529, 42.8342367025713, 42.56263984988132, 42.65778588751951, 40.53418678045273, 40.728220481425524, 40.82521789520979, 37.92975695927937, 39.05587181340282, 38.7896789809068, 37.136410623788834, 37.534263394773006, 37.8089808113873, 29.816222185268998, 29.86288116220385, 29.438886366784573, 37.81209137787421, 37.55541272958119, 37.30039787044127, 57.04860445236166, 56.67878048618634, 56.951044016828135, 47.8799140850703, 48.25614655638735, 48.19102444003026, 23.916541561484337, 24.549064692109823, 24.804872035165317, 44.17079544067383, 43.734522968530655, 44.246961142867804, 33.74411607471605, 33.184511115153626, 32.98467231293519, 33.726144567131996, 34.18077592179179, 33.685072273015976, 39.264157181372866, 39.07556650787592, 38.4520727545023, 43.43248230467239, 43.70428877944747, 43.74131592052677, 44.189218054215104, 43.877202714482934, 43.89425865809122, 43.58300307889779, 44.08685917158921, 44.58343530197938, 44.09096420556307, 44.23512095399201, 42.89714854955673, 39.42942205568154, 39.348971394201115, 39.52775466938813, 25.065872110426426, 25.174113288521767, 25.150244496762753, 56.68901805331309, 56.669387505700186, 56.762344395120934, 37.44498758514722, 38.05315989473213, 37.69532124449809, 30.906278885900974, 30.872522428631783, 30.588179774582386, 39.9577915209035, 39.87421968082586, 39.84892432639995, 42.73950193822384, 42.6308351457119, 42.69319225847721, 27.102040479580552, 27.61688733349243, 27.25572338203588, 41.852481581270695, 41.849054127931595, 41.64279270172119, 41.92595670372248, 41.82342889159918, 41.870638601481915, 44.89270545790592, 44.613660427431256, 44.805132581541926, 39.00135450127223, 38.767454298834, 39.09365565709109, 39.6510642816623, 39.44023557504018, 39.897630145152405, 28.6755785420537, 28.86660196632147, 28.970302783884108, 36.34340681717731, 36.090757828205824, 36.20928346179426]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14205082976497793, "mean_inference_ms": 0.6957022121730464, "mean_action_processing_ms": 0.09573346700390559, "mean_env_wait_ms": 0.7945529523467593, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 600000, "timesteps_this_iter": 0, "agent_timesteps_total": 1800000, "timers": {"sample_time_ms": 10483.671, "sample_throughput": 476.932, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1925.12, "learn_throughput": 2597.24, "update_time_ms": 9.694}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.524354896707238e-30, "cur_lr": 0.0005000000000000001, "total_loss": 7.000009632110595, "policy_loss": -0.001809199143564344, "vf_loss": 7.100715827941895, "vf_explained_var": -0.03443326950073242, "kl": 0.002235443505960428, "entropy": 9.889684009552003, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 600000, "num_agent_steps_sampled": 1800000, "num_steps_trained": 600000, "num_agent_steps_trained": 1800000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1867, "training_iteration": 120, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-22-56", "timestamp": 1706232176, "time_this_iter_s": 10.410974502563477, "time_total_s": 1291.6676545143127, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401A96550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1291.6676545143127, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 6.533333333333334, "ram_util_percent": 61.580000000000005}}
{"episode_reward_max": 170.67842895537623, "episode_reward_min": -263.4324786812067, "episode_reward_mean": 109.81376605068596, "episode_len_mean": 496.97, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -93.96110393106937}, "policy_reward_max": {"shared_policy": 57.04860445236166}, "policy_reward_mean": {"shared_policy": 36.60458868356198}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.61644740030164, 105.44677679240704, 137.511679583695, 130.89373084530257, -263.4324786812067, 116.46629769727586, 121.88108812645076, 105.22790687531231, 144.50558718759552, 107.30030279792842, 110.56790264882144, 120.53252869658169, 75.93256045505403, 99.92087399680166, 126.04779209941623, 98.60766397789119, 108.84065857739186, 95.67496652156115, 88.34877679124475, 89.95365823805331, 98.99424967728552, 90.75361186079681, 133.41355917975307, 144.98442363739017, 97.79033887060356, 74.63518793880938, 88.45512999407946, 101.74745170678943, 126.91550877224651, 92.34969269484279, 122.87996386922896, 119.26281052222475, 149.17220940720284, 87.14092328306288, 93.9843154326081, 113.26110249571502, 123.37716764956711, 126.26712691783902, 117.11249715089797, 104.56996344402431, 165.9125775732098, 118.4342697430402, 99.1735882423818, 123.92471907660365, 100.01355635374784, 115.37941997125743, 114.10110600106415, 112.79086792422456, 117.5021630823612, 112.61412791535257, 86.42325198510659, 122.48507402231917, 90.56586074642837, 95.03227677196263, 86.96774041652677, 126.37574340589345, 83.51347497478125, 107.21955514699219, 128.05466243997213, 122.08762515708804, 115.77530775358899, 112.47965482994914, 89.11798971425742, 112.66790197789668, 170.67842895537623, 144.32708508148795, 73.27047828875948, 132.1522795520724, 99.91329950280486, 101.59199276193976, 116.79179644375108, 130.8780870046467, 131.9606794267891, 132.25329755246628, 131.22323370911198, 118.30614811927079, 75.39022989571095, 170.1207499541343, 113.19346872437744, 92.36698108911514, 119.68093552812931, 128.06352934241295, 81.97465119510886, 125.34432841092348, 125.62002419680357, 134.31149846687896, 116.86246445719732, 118.98893000185488, 86.51248329225928, 108.64344810717739, 90.99538918118921, 126.27239778824149, 109.54635477066037, 124.78391729295252, 100.083554957062, 123.97133801318704, 112.0297864060849, 155.32116809487326, 119.68342098221181, 121.7442781627178], "episode_lengths": [500, 500, 500, 500, 197, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [43.441752697030694, 43.79151180262366, 43.38318290064731, 35.24496532604098, 34.96268482506275, 35.2391266413033, 45.955092525885746, 45.80639179175098, 45.75019526605804, 43.333808595935494, 43.90512602652112, 43.654796222845704, -84.52637128531933, -84.945003464818, -93.96110393106937, 39.12296485279997, 38.436166291435555, 38.90716655304034, 40.59494674702485, 40.67966340606411, 40.606477973361805, 35.32644614701469, 34.55535890658696, 35.34610182171066, 48.295124109524, 47.94720395157735, 48.26325912649433, 35.41543276111284, 35.83791052053371, 36.04695951628187, 36.86055947902301, 36.85559999073544, 36.85174317906299, 40.33788851896921, 40.47689626427987, 39.71774391333261, 25.692807120581463, 24.432111849387482, 25.807641485085085, 33.24625913550456, 33.35381352373709, 33.32080133756001, 42.11208301285902, 41.58534037570158, 42.35036871085563, 32.66656530400117, 32.618783464034394, 33.32231520985563, 36.13088476782043, 36.41083542218742, 36.29893838738401, 31.047299772500992, 32.453905276954174, 32.17376147210598, 29.56757894717157, 29.571773735806346, 29.20942410826683, 29.848086794217423, 30.217194517453507, 29.888376926382378, 33.218154958138854, 33.18006366925934, 32.59603104988733, 30.25930070132017, 30.063120283186436, 30.431190876290202, 44.60011130198836, 44.406769536435604, 44.4066783413291, 47.82255636155604, 48.6260724402964, 48.53579483553766, 33.05171799721816, 33.121612147583306, 31.617008725802094, 25.01458756377299, 25.008366999526814, 24.612233375509575, 28.901138191421822, 29.745377299686268, 29.808614502971366, 33.18625965714455, 34.08219789713621, 34.478994152508676, 42.16083843509355, 42.33689183617631, 42.41777850097665, 30.46688380340734, 30.88581609229246, 30.996992799142987, 41.001523077487946, 41.029962008818984, 40.84847878292203, 39.56466028094292, 39.85253250785172, 39.84561773343012, 49.94776648438226, 49.453090834120914, 49.77135208869974, 29.53980442788452, 29.135130263864994, 28.465988591313362, 31.669580877448112, 31.650310304636747, 30.66442425052324, 37.63401123136282, 37.68777659535408, 37.93931466899812, 40.724709292252854, 41.368894947071865, 41.283563410242394, 41.85671162108579, 42.19943892459074, 42.21097637216249, 39.04521217693885, 39.11952158560355, 38.94776338835557, 34.65630756815274, 34.67403562863667, 35.239620247234896, 55.01106892029445, 55.36463190118472, 55.536876751730844, 39.773964086547494, 39.336151868104935, 39.324153788387775, 33.05574554701646, 32.91304465134938, 33.20479804401596, 40.986210480332375, 41.286529526114464, 41.65197907015681, 33.53181295841932, 33.64545185863972, 32.836291536688805, 38.52625581187506, 38.45168179584046, 38.401482363541916, 38.11101708809534, 37.77750145892301, 38.2125874540458, 37.56228409955898, 37.21533309916654, 38.013250725499034, 39.104647410412625, 39.275453237195805, 39.12206243475278, 37.75803268452485, 37.110287105043724, 37.745808125783995, 29.026324273242295, 28.78390523294607, 28.613022478918225, 40.99268787493929, 40.76613274589181, 40.726253401488066, 29.944470487535, 30.405938839539886, 30.215451419353485, 32.03970727821191, 31.99484461297591, 30.99772488077481, 29.3234728972117, 29.487918535868317, 28.156348983446748, 42.22705846466124, 42.221827141940594, 41.92685779929161, 27.820088716844708, 27.561463604370743, 28.131922653565795, 35.300350447495774, 36.01480569442113, 35.90439900507529, 42.8342367025713, 42.56263984988132, 42.65778588751951, 40.53418678045273, 40.728220481425524, 40.82521789520979, 37.92975695927937, 39.05587181340282, 38.7896789809068, 37.136410623788834, 37.534263394773006, 37.8089808113873, 29.816222185268998, 29.86288116220385, 29.438886366784573, 37.81209137787421, 37.55541272958119, 37.30039787044127, 57.04860445236166, 56.67878048618634, 56.951044016828135, 47.8799140850703, 48.25614655638735, 48.19102444003026, 23.916541561484337, 24.549064692109823, 24.804872035165317, 44.17079544067383, 43.734522968530655, 44.246961142867804, 33.74411607471605, 33.184511115153626, 32.98467231293519, 33.726144567131996, 34.18077592179179, 33.685072273015976, 39.264157181372866, 39.07556650787592, 38.4520727545023, 43.43248230467239, 43.70428877944747, 43.74131592052677, 44.189218054215104, 43.877202714482934, 43.89425865809122, 43.58300307889779, 44.08685917158921, 44.58343530197938, 44.09096420556307, 44.23512095399201, 42.89714854955673, 39.42942205568154, 39.348971394201115, 39.52775466938813, 25.065872110426426, 25.174113288521767, 25.150244496762753, 56.68901805331309, 56.669387505700186, 56.762344395120934, 37.44498758514722, 38.05315989473213, 37.69532124449809, 30.906278885900974, 30.872522428631783, 30.588179774582386, 39.9577915209035, 39.87421968082586, 39.84892432639995, 42.73950193822384, 42.6308351457119, 42.69319225847721, 27.102040479580552, 27.61688733349243, 27.25572338203588, 41.852481581270695, 41.849054127931595, 41.64279270172119, 41.92595670372248, 41.82342889159918, 41.870638601481915, 44.89270545790592, 44.613660427431256, 44.805132581541926, 39.00135450127223, 38.767454298834, 39.09365565709109, 39.6510642816623, 39.44023557504018, 39.897630145152405, 28.6755785420537, 28.86660196632147, 28.970302783884108, 36.34340681717731, 36.090757828205824, 36.20928346179426, 30.456745728539914, 30.101531768838555, 30.43711168381074, 42.07941308369239, 42.298631674920514, 41.89435302962859, 36.32656730214754, 36.70056052009264, 36.5192269484202, 41.830991966029, 41.22060192128022, 41.7323234056433, 33.2191521525383, 33.43425631895661, 33.43014648556709, 41.35615803052981, 41.04571584363778, 41.569464139019445, 37.3451815135777, 37.11375614255667, 37.57084874995053, 51.609414870540306, 51.88688548157613, 51.82486774275701, 39.43124457200368, 40.63118343179424, 39.620992978413895, 40.933087324102715, 40.73901892205079, 40.0721719165643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14202591605476075, "mean_inference_ms": 0.6956155745817866, "mean_action_processing_ms": 0.09573757456612517, "mean_env_wait_ms": 0.7943366164240261, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 605000, "timesteps_this_iter": 0, "agent_timesteps_total": 1815000, "timers": {"sample_time_ms": 10446.866, "sample_throughput": 478.612, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1929.203, "learn_throughput": 2591.744, "update_time_ms": 9.588}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.262177448353619e-30, "cur_lr": 0.0005000000000000001, "total_loss": 8.784582614898682, "policy_loss": -0.0018858370999112139, "vf_loss": 8.884738159179687, "vf_explained_var": -0.027202820777893065, "kl": 0.0030006505200072787, "entropy": 9.826995086669921, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 605000, "num_agent_steps_sampled": 1815000, "num_steps_trained": 605000, "num_agent_steps_trained": 1815000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1877, "training_iteration": 121, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-23-07", "timestamp": 1706232187, "time_this_iter_s": 10.405795812606812, "time_total_s": 1302.0734503269196, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021404255160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1302.0734503269196, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 7.173333333333334, "ram_util_percent": 61.62000000000001}}
{"episode_reward_max": 170.67842895537623, "episode_reward_min": 73.27047828875948, "episode_reward_mean": 113.08442078425345, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 23.916541561484337}, "policy_reward_max": {"shared_policy": 57.04860445236166}, "policy_reward_mean": {"shared_policy": 37.694806928084475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [110.56790264882144, 120.53252869658169, 75.93256045505403, 99.92087399680166, 126.04779209941623, 98.60766397789119, 108.84065857739186, 95.67496652156115, 88.34877679124475, 89.95365823805331, 98.99424967728552, 90.75361186079681, 133.41355917975307, 144.98442363739017, 97.79033887060356, 74.63518793880938, 88.45512999407946, 101.74745170678943, 126.91550877224651, 92.34969269484279, 122.87996386922896, 119.26281052222475, 149.17220940720284, 87.14092328306288, 93.9843154326081, 113.26110249571502, 123.37716764956711, 126.26712691783902, 117.11249715089797, 104.56996344402431, 165.9125775732098, 118.4342697430402, 99.1735882423818, 123.92471907660365, 100.01355635374784, 115.37941997125743, 114.10110600106415, 112.79086792422456, 117.5021630823612, 112.61412791535257, 86.42325198510659, 122.48507402231917, 90.56586074642837, 95.03227677196263, 86.96774041652677, 126.37574340589345, 83.51347497478125, 107.21955514699219, 128.05466243997213, 122.08762515708804, 115.77530775358899, 112.47965482994914, 89.11798971425742, 112.66790197789668, 170.67842895537623, 144.32708508148795, 73.27047828875948, 132.1522795520724, 99.91329950280486, 101.59199276193976, 116.79179644375108, 130.8780870046467, 131.9606794267891, 132.25329755246628, 131.22323370911198, 118.30614811927079, 75.39022989571095, 170.1207499541343, 113.19346872437744, 92.36698108911514, 119.68093552812931, 128.06352934241295, 81.97465119510886, 125.34432841092348, 125.62002419680357, 134.31149846687896, 116.86246445719732, 118.98893000185488, 86.51248329225928, 108.64344810717739, 90.99538918118921, 126.27239778824149, 109.54635477066037, 124.78391729295252, 100.083554957062, 123.97133801318704, 112.0297864060849, 155.32116809487326, 119.68342098221181, 121.7442781627178, 115.93474324792624, 120.01007695309815, 139.78491587191803, 102.19029112160204, 76.36578299105165, 134.78829581849283, 88.45658763498068, 88.42612276971337, 157.23599469102905, 140.29000088199976], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [36.86055947902301, 36.85559999073544, 36.85174317906299, 40.33788851896921, 40.47689626427987, 39.71774391333261, 25.692807120581463, 24.432111849387482, 25.807641485085085, 33.24625913550456, 33.35381352373709, 33.32080133756001, 42.11208301285902, 41.58534037570158, 42.35036871085563, 32.66656530400117, 32.618783464034394, 33.32231520985563, 36.13088476782043, 36.41083542218742, 36.29893838738401, 31.047299772500992, 32.453905276954174, 32.17376147210598, 29.56757894717157, 29.571773735806346, 29.20942410826683, 29.848086794217423, 30.217194517453507, 29.888376926382378, 33.218154958138854, 33.18006366925934, 32.59603104988733, 30.25930070132017, 30.063120283186436, 30.431190876290202, 44.60011130198836, 44.406769536435604, 44.4066783413291, 47.82255636155604, 48.6260724402964, 48.53579483553766, 33.05171799721816, 33.121612147583306, 31.617008725802094, 25.01458756377299, 25.008366999526814, 24.612233375509575, 28.901138191421822, 29.745377299686268, 29.808614502971366, 33.18625965714455, 34.08219789713621, 34.478994152508676, 42.16083843509355, 42.33689183617631, 42.41777850097665, 30.46688380340734, 30.88581609229246, 30.996992799142987, 41.001523077487946, 41.029962008818984, 40.84847878292203, 39.56466028094292, 39.85253250785172, 39.84561773343012, 49.94776648438226, 49.453090834120914, 49.77135208869974, 29.53980442788452, 29.135130263864994, 28.465988591313362, 31.669580877448112, 31.650310304636747, 30.66442425052324, 37.63401123136282, 37.68777659535408, 37.93931466899812, 40.724709292252854, 41.368894947071865, 41.283563410242394, 41.85671162108579, 42.19943892459074, 42.21097637216249, 39.04521217693885, 39.11952158560355, 38.94776338835557, 34.65630756815274, 34.67403562863667, 35.239620247234896, 55.01106892029445, 55.36463190118472, 55.536876751730844, 39.773964086547494, 39.336151868104935, 39.324153788387775, 33.05574554701646, 32.91304465134938, 33.20479804401596, 40.986210480332375, 41.286529526114464, 41.65197907015681, 33.53181295841932, 33.64545185863972, 32.836291536688805, 38.52625581187506, 38.45168179584046, 38.401482363541916, 38.11101708809534, 37.77750145892301, 38.2125874540458, 37.56228409955898, 37.21533309916654, 38.013250725499034, 39.104647410412625, 39.275453237195805, 39.12206243475278, 37.75803268452485, 37.110287105043724, 37.745808125783995, 29.026324273242295, 28.78390523294607, 28.613022478918225, 40.99268787493929, 40.76613274589181, 40.726253401488066, 29.944470487535, 30.405938839539886, 30.215451419353485, 32.03970727821191, 31.99484461297591, 30.99772488077481, 29.3234728972117, 29.487918535868317, 28.156348983446748, 42.22705846466124, 42.221827141940594, 41.92685779929161, 27.820088716844708, 27.561463604370743, 28.131922653565795, 35.300350447495774, 36.01480569442113, 35.90439900507529, 42.8342367025713, 42.56263984988132, 42.65778588751951, 40.53418678045273, 40.728220481425524, 40.82521789520979, 37.92975695927937, 39.05587181340282, 38.7896789809068, 37.136410623788834, 37.534263394773006, 37.8089808113873, 29.816222185268998, 29.86288116220385, 29.438886366784573, 37.81209137787421, 37.55541272958119, 37.30039787044127, 57.04860445236166, 56.67878048618634, 56.951044016828135, 47.8799140850703, 48.25614655638735, 48.19102444003026, 23.916541561484337, 24.549064692109823, 24.804872035165317, 44.17079544067383, 43.734522968530655, 44.246961142867804, 33.74411607471605, 33.184511115153626, 32.98467231293519, 33.726144567131996, 34.18077592179179, 33.685072273015976, 39.264157181372866, 39.07556650787592, 38.4520727545023, 43.43248230467239, 43.70428877944747, 43.74131592052677, 44.189218054215104, 43.877202714482934, 43.89425865809122, 43.58300307889779, 44.08685917158921, 44.58343530197938, 44.09096420556307, 44.23512095399201, 42.89714854955673, 39.42942205568154, 39.348971394201115, 39.52775466938813, 25.065872110426426, 25.174113288521767, 25.150244496762753, 56.68901805331309, 56.669387505700186, 56.762344395120934, 37.44498758514722, 38.05315989473213, 37.69532124449809, 30.906278885900974, 30.872522428631783, 30.588179774582386, 39.9577915209035, 39.87421968082586, 39.84892432639995, 42.73950193822384, 42.6308351457119, 42.69319225847721, 27.102040479580552, 27.61688733349243, 27.25572338203588, 41.852481581270695, 41.849054127931595, 41.64279270172119, 41.92595670372248, 41.82342889159918, 41.870638601481915, 44.89270545790592, 44.613660427431256, 44.805132581541926, 39.00135450127223, 38.767454298834, 39.09365565709109, 39.6510642816623, 39.44023557504018, 39.897630145152405, 28.6755785420537, 28.86660196632147, 28.970302783884108, 36.34340681717731, 36.090757828205824, 36.20928346179426, 30.456745728539914, 30.101531768838555, 30.43711168381074, 42.07941308369239, 42.298631674920514, 41.89435302962859, 36.32656730214754, 36.70056052009264, 36.5192269484202, 41.830991966029, 41.22060192128022, 41.7323234056433, 33.2191521525383, 33.43425631895661, 33.43014648556709, 41.35615803052981, 41.04571584363778, 41.569464139019445, 37.3451815135777, 37.11375614255667, 37.57084874995053, 51.609414870540306, 51.88688548157613, 51.82486774275701, 39.43124457200368, 40.63118343179424, 39.620992978413895, 40.933087324102715, 40.73901892205079, 40.0721719165643, 38.84390566498041, 38.62032275646925, 38.470514826476574, 39.64727422098318, 40.080766322712094, 40.28203640940288, 46.57149062057336, 46.87073726703723, 46.3426879843076, 34.322027434905365, 33.40688543518384, 34.46137825151284, 25.890980480859668, 24.556102106968552, 25.918700403223426, 44.70196899523337, 45.09405724269648, 44.992269580562905, 29.411920964717865, 29.38408701121807, 29.660579659044743, 29.78009809801975, 28.938600505391747, 29.707424166301877, 52.373819962143884, 52.52832543663679, 52.33384929224847, 47.480722006410346, 45.95531436800955, 46.85396450757979]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14200824854052535, "mean_inference_ms": 0.6956348077267404, "mean_action_processing_ms": 0.09576769129131829, "mean_env_wait_ms": 0.7941213268858519, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 610000, "timesteps_this_iter": 0, "agent_timesteps_total": 1830000, "timers": {"sample_time_ms": 10494.107, "sample_throughput": 476.458, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1937.236, "learn_throughput": 2580.997, "update_time_ms": 9.587}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.310887241768095e-31, "cur_lr": 0.0005000000000000001, "total_loss": 5.890822076797486, "policy_loss": -0.0010231924036393281, "vf_loss": 5.99061598777771, "vf_explained_var": -0.009348368644714356, "kl": 0.0037916781148311547, "entropy": 9.877051162719727, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 610000, "num_agent_steps_sampled": 1830000, "num_steps_trained": 610000, "num_agent_steps_trained": 1830000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1887, "training_iteration": 122, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-23-17", "timestamp": 1706232197, "time_this_iter_s": 10.600852966308594, "time_total_s": 1312.6743032932281, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021404255D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1312.6743032932281, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 7.526666666666667, "ram_util_percent": 61.60666666666668}}
{"episode_reward_max": 170.67842895537623, "episode_reward_min": 73.27047828875948, "episode_reward_mean": 113.66156424659799, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 23.916541561484337}, "policy_reward_max": {"shared_policy": 57.04860445236166}, "policy_reward_mean": {"shared_policy": 37.88718808219933}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.99424967728552, 90.75361186079681, 133.41355917975307, 144.98442363739017, 97.79033887060356, 74.63518793880938, 88.45512999407946, 101.74745170678943, 126.91550877224651, 92.34969269484279, 122.87996386922896, 119.26281052222475, 149.17220940720284, 87.14092328306288, 93.9843154326081, 113.26110249571502, 123.37716764956711, 126.26712691783902, 117.11249715089797, 104.56996344402431, 165.9125775732098, 118.4342697430402, 99.1735882423818, 123.92471907660365, 100.01355635374784, 115.37941997125743, 114.10110600106415, 112.79086792422456, 117.5021630823612, 112.61412791535257, 86.42325198510659, 122.48507402231917, 90.56586074642837, 95.03227677196263, 86.96774041652677, 126.37574340589345, 83.51347497478125, 107.21955514699219, 128.05466243997213, 122.08762515708804, 115.77530775358899, 112.47965482994914, 89.11798971425742, 112.66790197789668, 170.67842895537623, 144.32708508148795, 73.27047828875948, 132.1522795520724, 99.91329950280486, 101.59199276193976, 116.79179644375108, 130.8780870046467, 131.9606794267891, 132.25329755246628, 131.22323370911198, 118.30614811927079, 75.39022989571095, 170.1207499541343, 113.19346872437744, 92.36698108911514, 119.68093552812931, 128.06352934241295, 81.97465119510886, 125.34432841092348, 125.62002419680357, 134.31149846687896, 116.86246445719732, 118.98893000185488, 86.51248329225928, 108.64344810717739, 90.99538918118921, 126.27239778824149, 109.54635477066037, 124.78391729295252, 100.083554957062, 123.97133801318704, 112.0297864060849, 155.32116809487326, 119.68342098221181, 121.7442781627178, 115.93474324792624, 120.01007695309815, 139.78491587191803, 102.19029112160204, 76.36578299105165, 134.78829581849283, 88.45658763498068, 88.42612276971337, 157.23599469102905, 140.29000088199976, 96.86673707701264, 115.37516812607643, 101.31040180474517, 102.84862949699163, 112.59338438510893, 97.1988659799099, 89.79614648781714, 114.18181034550071, 100.17063071578741, 141.7999538183208], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [33.218154958138854, 33.18006366925934, 32.59603104988733, 30.25930070132017, 30.063120283186436, 30.431190876290202, 44.60011130198836, 44.406769536435604, 44.4066783413291, 47.82255636155604, 48.6260724402964, 48.53579483553766, 33.05171799721816, 33.121612147583306, 31.617008725802094, 25.01458756377299, 25.008366999526814, 24.612233375509575, 28.901138191421822, 29.745377299686268, 29.808614502971366, 33.18625965714455, 34.08219789713621, 34.478994152508676, 42.16083843509355, 42.33689183617631, 42.41777850097665, 30.46688380340734, 30.88581609229246, 30.996992799142987, 41.001523077487946, 41.029962008818984, 40.84847878292203, 39.56466028094292, 39.85253250785172, 39.84561773343012, 49.94776648438226, 49.453090834120914, 49.77135208869974, 29.53980442788452, 29.135130263864994, 28.465988591313362, 31.669580877448112, 31.650310304636747, 30.66442425052324, 37.63401123136282, 37.68777659535408, 37.93931466899812, 40.724709292252854, 41.368894947071865, 41.283563410242394, 41.85671162108579, 42.19943892459074, 42.21097637216249, 39.04521217693885, 39.11952158560355, 38.94776338835557, 34.65630756815274, 34.67403562863667, 35.239620247234896, 55.01106892029445, 55.36463190118472, 55.536876751730844, 39.773964086547494, 39.336151868104935, 39.324153788387775, 33.05574554701646, 32.91304465134938, 33.20479804401596, 40.986210480332375, 41.286529526114464, 41.65197907015681, 33.53181295841932, 33.64545185863972, 32.836291536688805, 38.52625581187506, 38.45168179584046, 38.401482363541916, 38.11101708809534, 37.77750145892301, 38.2125874540458, 37.56228409955898, 37.21533309916654, 38.013250725499034, 39.104647410412625, 39.275453237195805, 39.12206243475278, 37.75803268452485, 37.110287105043724, 37.745808125783995, 29.026324273242295, 28.78390523294607, 28.613022478918225, 40.99268787493929, 40.76613274589181, 40.726253401488066, 29.944470487535, 30.405938839539886, 30.215451419353485, 32.03970727821191, 31.99484461297591, 30.99772488077481, 29.3234728972117, 29.487918535868317, 28.156348983446748, 42.22705846466124, 42.221827141940594, 41.92685779929161, 27.820088716844708, 27.561463604370743, 28.131922653565795, 35.300350447495774, 36.01480569442113, 35.90439900507529, 42.8342367025713, 42.56263984988132, 42.65778588751951, 40.53418678045273, 40.728220481425524, 40.82521789520979, 37.92975695927937, 39.05587181340282, 38.7896789809068, 37.136410623788834, 37.534263394773006, 37.8089808113873, 29.816222185268998, 29.86288116220385, 29.438886366784573, 37.81209137787421, 37.55541272958119, 37.30039787044127, 57.04860445236166, 56.67878048618634, 56.951044016828135, 47.8799140850703, 48.25614655638735, 48.19102444003026, 23.916541561484337, 24.549064692109823, 24.804872035165317, 44.17079544067383, 43.734522968530655, 44.246961142867804, 33.74411607471605, 33.184511115153626, 32.98467231293519, 33.726144567131996, 34.18077592179179, 33.685072273015976, 39.264157181372866, 39.07556650787592, 38.4520727545023, 43.43248230467239, 43.70428877944747, 43.74131592052677, 44.189218054215104, 43.877202714482934, 43.89425865809122, 43.58300307889779, 44.08685917158921, 44.58343530197938, 44.09096420556307, 44.23512095399201, 42.89714854955673, 39.42942205568154, 39.348971394201115, 39.52775466938813, 25.065872110426426, 25.174113288521767, 25.150244496762753, 56.68901805331309, 56.669387505700186, 56.762344395120934, 37.44498758514722, 38.05315989473213, 37.69532124449809, 30.906278885900974, 30.872522428631783, 30.588179774582386, 39.9577915209035, 39.87421968082586, 39.84892432639995, 42.73950193822384, 42.6308351457119, 42.69319225847721, 27.102040479580552, 27.61688733349243, 27.25572338203588, 41.852481581270695, 41.849054127931595, 41.64279270172119, 41.92595670372248, 41.82342889159918, 41.870638601481915, 44.89270545790592, 44.613660427431256, 44.805132581541926, 39.00135450127223, 38.767454298834, 39.09365565709109, 39.6510642816623, 39.44023557504018, 39.897630145152405, 28.6755785420537, 28.86660196632147, 28.970302783884108, 36.34340681717731, 36.090757828205824, 36.20928346179426, 30.456745728539914, 30.101531768838555, 30.43711168381074, 42.07941308369239, 42.298631674920514, 41.89435302962859, 36.32656730214754, 36.70056052009264, 36.5192269484202, 41.830991966029, 41.22060192128022, 41.7323234056433, 33.2191521525383, 33.43425631895661, 33.43014648556709, 41.35615803052981, 41.04571584363778, 41.569464139019445, 37.3451815135777, 37.11375614255667, 37.57084874995053, 51.609414870540306, 51.88688548157613, 51.82486774275701, 39.43124457200368, 40.63118343179424, 39.620992978413895, 40.933087324102715, 40.73901892205079, 40.0721719165643, 38.84390566498041, 38.62032275646925, 38.470514826476574, 39.64727422098318, 40.080766322712094, 40.28203640940288, 46.57149062057336, 46.87073726703723, 46.3426879843076, 34.322027434905365, 33.40688543518384, 34.46137825151284, 25.890980480859668, 24.556102106968552, 25.918700403223426, 44.70196899523337, 45.09405724269648, 44.992269580562905, 29.411920964717865, 29.38408701121807, 29.660579659044743, 29.78009809801975, 28.938600505391747, 29.707424166301877, 52.373819962143884, 52.52832543663679, 52.33384929224847, 47.480722006410346, 45.95531436800955, 46.85396450757979, 32.282192950447396, 32.68438215491672, 31.90016197164853, 38.6299433770279, 38.28982230524221, 38.45540244380632, 34.17370233188072, 33.24137910703817, 33.89532036582628, 34.353809751570225, 34.36975537240505, 34.12506437301636, 37.894829524060086, 37.247374330957726, 37.45118053009112, 32.539220467209816, 32.36419574916363, 32.29544976353645, 29.970021101335675, 29.864999803404004, 29.96112558307746, 37.88869997113943, 38.227693006396294, 38.06541736796498, 33.402980372309685, 33.600183717906475, 33.16746662557125, 47.28962127616008, 47.4416390483578, 47.06869349380334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1419951214708056, "mean_inference_ms": 0.6956393397785651, "mean_action_processing_ms": 0.09577787581944765, "mean_env_wait_ms": 0.7939735296871636, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 615000, "timesteps_this_iter": 0, "agent_timesteps_total": 1845000, "timers": {"sample_time_ms": 10564.707, "sample_throughput": 473.274, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1944.927, "learn_throughput": 2570.791, "update_time_ms": 9.686}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.1554436208840474e-31, "cur_lr": 0.0005000000000000001, "total_loss": 6.476453971862793, "policy_loss": 0.0003523965809526075, "vf_loss": 6.576192903518677, "vf_explained_var": -0.006053698062896728, "kl": 0.003575173334722627, "entropy": 10.00914545059204, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 615000, "num_agent_steps_sampled": 1845000, "num_steps_trained": 615000, "num_agent_steps_trained": 1845000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1897, "training_iteration": 123, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-23-28", "timestamp": 1706232208, "time_this_iter_s": 10.899722814559937, "time_total_s": 1323.574026107788, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214025549D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1323.574026107788, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 7.919999999999999, "ram_util_percent": 61.71999999999999}}
{"episode_reward_max": 170.67842895537623, "episode_reward_min": 73.27047828875948, "episode_reward_mean": 115.352417087341, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 23.916541561484337}, "policy_reward_max": {"shared_policy": 57.04860445236166}, "policy_reward_mean": {"shared_policy": 38.450805695780325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [122.87996386922896, 119.26281052222475, 149.17220940720284, 87.14092328306288, 93.9843154326081, 113.26110249571502, 123.37716764956711, 126.26712691783902, 117.11249715089797, 104.56996344402431, 165.9125775732098, 118.4342697430402, 99.1735882423818, 123.92471907660365, 100.01355635374784, 115.37941997125743, 114.10110600106415, 112.79086792422456, 117.5021630823612, 112.61412791535257, 86.42325198510659, 122.48507402231917, 90.56586074642837, 95.03227677196263, 86.96774041652677, 126.37574340589345, 83.51347497478125, 107.21955514699219, 128.05466243997213, 122.08762515708804, 115.77530775358899, 112.47965482994914, 89.11798971425742, 112.66790197789668, 170.67842895537623, 144.32708508148795, 73.27047828875948, 132.1522795520724, 99.91329950280486, 101.59199276193976, 116.79179644375108, 130.8780870046467, 131.9606794267891, 132.25329755246628, 131.22323370911198, 118.30614811927079, 75.39022989571095, 170.1207499541343, 113.19346872437744, 92.36698108911514, 119.68093552812931, 128.06352934241295, 81.97465119510886, 125.34432841092348, 125.62002419680357, 134.31149846687896, 116.86246445719732, 118.98893000185488, 86.51248329225928, 108.64344810717739, 90.99538918118921, 126.27239778824149, 109.54635477066037, 124.78391729295252, 100.083554957062, 123.97133801318704, 112.0297864060849, 155.32116809487326, 119.68342098221181, 121.7442781627178, 115.93474324792624, 120.01007695309815, 139.78491587191803, 102.19029112160204, 76.36578299105165, 134.78829581849283, 88.45658763498068, 88.42612276971337, 157.23599469102905, 140.29000088199976, 96.86673707701264, 115.37516812607643, 101.31040180474517, 102.84862949699163, 112.59338438510893, 97.1988659799099, 89.79614648781714, 114.18181034550071, 100.17063071578741, 141.7999538183208, 131.74417598545546, 115.63765986612998, 125.54375000298022, 132.691582651809, 135.06793657829954, 147.7591934024822, 107.56696170940992, 113.45968980994073, 93.71276669856161, 115.94072170183063], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [41.001523077487946, 41.029962008818984, 40.84847878292203, 39.56466028094292, 39.85253250785172, 39.84561773343012, 49.94776648438226, 49.453090834120914, 49.77135208869974, 29.53980442788452, 29.135130263864994, 28.465988591313362, 31.669580877448112, 31.650310304636747, 30.66442425052324, 37.63401123136282, 37.68777659535408, 37.93931466899812, 40.724709292252854, 41.368894947071865, 41.283563410242394, 41.85671162108579, 42.19943892459074, 42.21097637216249, 39.04521217693885, 39.11952158560355, 38.94776338835557, 34.65630756815274, 34.67403562863667, 35.239620247234896, 55.01106892029445, 55.36463190118472, 55.536876751730844, 39.773964086547494, 39.336151868104935, 39.324153788387775, 33.05574554701646, 32.91304465134938, 33.20479804401596, 40.986210480332375, 41.286529526114464, 41.65197907015681, 33.53181295841932, 33.64545185863972, 32.836291536688805, 38.52625581187506, 38.45168179584046, 38.401482363541916, 38.11101708809534, 37.77750145892301, 38.2125874540458, 37.56228409955898, 37.21533309916654, 38.013250725499034, 39.104647410412625, 39.275453237195805, 39.12206243475278, 37.75803268452485, 37.110287105043724, 37.745808125783995, 29.026324273242295, 28.78390523294607, 28.613022478918225, 40.99268787493929, 40.76613274589181, 40.726253401488066, 29.944470487535, 30.405938839539886, 30.215451419353485, 32.03970727821191, 31.99484461297591, 30.99772488077481, 29.3234728972117, 29.487918535868317, 28.156348983446748, 42.22705846466124, 42.221827141940594, 41.92685779929161, 27.820088716844708, 27.561463604370743, 28.131922653565795, 35.300350447495774, 36.01480569442113, 35.90439900507529, 42.8342367025713, 42.56263984988132, 42.65778588751951, 40.53418678045273, 40.728220481425524, 40.82521789520979, 37.92975695927937, 39.05587181340282, 38.7896789809068, 37.136410623788834, 37.534263394773006, 37.8089808113873, 29.816222185268998, 29.86288116220385, 29.438886366784573, 37.81209137787421, 37.55541272958119, 37.30039787044127, 57.04860445236166, 56.67878048618634, 56.951044016828135, 47.8799140850703, 48.25614655638735, 48.19102444003026, 23.916541561484337, 24.549064692109823, 24.804872035165317, 44.17079544067383, 43.734522968530655, 44.246961142867804, 33.74411607471605, 33.184511115153626, 32.98467231293519, 33.726144567131996, 34.18077592179179, 33.685072273015976, 39.264157181372866, 39.07556650787592, 38.4520727545023, 43.43248230467239, 43.70428877944747, 43.74131592052677, 44.189218054215104, 43.877202714482934, 43.89425865809122, 43.58300307889779, 44.08685917158921, 44.58343530197938, 44.09096420556307, 44.23512095399201, 42.89714854955673, 39.42942205568154, 39.348971394201115, 39.52775466938813, 25.065872110426426, 25.174113288521767, 25.150244496762753, 56.68901805331309, 56.669387505700186, 56.762344395120934, 37.44498758514722, 38.05315989473213, 37.69532124449809, 30.906278885900974, 30.872522428631783, 30.588179774582386, 39.9577915209035, 39.87421968082586, 39.84892432639995, 42.73950193822384, 42.6308351457119, 42.69319225847721, 27.102040479580552, 27.61688733349243, 27.25572338203588, 41.852481581270695, 41.849054127931595, 41.64279270172119, 41.92595670372248, 41.82342889159918, 41.870638601481915, 44.89270545790592, 44.613660427431256, 44.805132581541926, 39.00135450127223, 38.767454298834, 39.09365565709109, 39.6510642816623, 39.44023557504018, 39.897630145152405, 28.6755785420537, 28.86660196632147, 28.970302783884108, 36.34340681717731, 36.090757828205824, 36.20928346179426, 30.456745728539914, 30.101531768838555, 30.43711168381074, 42.07941308369239, 42.298631674920514, 41.89435302962859, 36.32656730214754, 36.70056052009264, 36.5192269484202, 41.830991966029, 41.22060192128022, 41.7323234056433, 33.2191521525383, 33.43425631895661, 33.43014648556709, 41.35615803052981, 41.04571584363778, 41.569464139019445, 37.3451815135777, 37.11375614255667, 37.57084874995053, 51.609414870540306, 51.88688548157613, 51.82486774275701, 39.43124457200368, 40.63118343179424, 39.620992978413895, 40.933087324102715, 40.73901892205079, 40.0721719165643, 38.84390566498041, 38.62032275646925, 38.470514826476574, 39.64727422098318, 40.080766322712094, 40.28203640940288, 46.57149062057336, 46.87073726703723, 46.3426879843076, 34.322027434905365, 33.40688543518384, 34.46137825151284, 25.890980480859668, 24.556102106968552, 25.918700403223426, 44.70196899523337, 45.09405724269648, 44.992269580562905, 29.411920964717865, 29.38408701121807, 29.660579659044743, 29.78009809801975, 28.938600505391747, 29.707424166301877, 52.373819962143884, 52.52832543663679, 52.33384929224847, 47.480722006410346, 45.95531436800955, 46.85396450757979, 32.282192950447396, 32.68438215491672, 31.90016197164853, 38.6299433770279, 38.28982230524221, 38.45540244380632, 34.17370233188072, 33.24137910703817, 33.89532036582628, 34.353809751570225, 34.36975537240505, 34.12506437301636, 37.894829524060086, 37.247374330957726, 37.45118053009112, 32.539220467209816, 32.36419574916363, 32.29544976353645, 29.970021101335675, 29.864999803404004, 29.96112558307746, 37.88869997113943, 38.227693006396294, 38.06541736796498, 33.402980372309685, 33.600183717906475, 33.16746662557125, 47.28962127616008, 47.4416390483578, 47.06869349380334, 43.978549423317105, 44.192946063975484, 43.572680498162896, 38.75189488916658, 38.24716002494097, 38.63860495202243, 41.693675344189, 41.95175250371297, 41.89832215507825, 44.191787148515374, 44.03256000826755, 44.4672354950259, 44.691895484924316, 45.205425828229636, 45.1706152651459, 49.4353604298861, 49.386246771862105, 48.937586200733975, 35.88633509601155, 35.91865573326746, 35.76197088013092, 37.6985508861641, 37.83003763357797, 37.931101290198654, 31.516792233102024, 30.887559562921524, 31.30841490253806, 38.84776798263192, 38.59010677039623, 38.50284694880247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14198605993133653, "mean_inference_ms": 0.6956411338601162, "mean_action_processing_ms": 0.09578674750169106, "mean_env_wait_ms": 0.7938316930702695, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 620000, "timesteps_this_iter": 0, "agent_timesteps_total": 1860000, "timers": {"sample_time_ms": 10574.501, "sample_throughput": 472.836, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1952.413, "learn_throughput": 2560.934, "update_time_ms": 9.519}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5777218104420237e-31, "cur_lr": 0.0005000000000000001, "total_loss": 6.311302709579468, "policy_loss": -0.001817442695082505, "vf_loss": 6.41285719871521, "vf_explained_var": -0.013207054138183594, "kl": 0.003089887159914733, "entropy": 9.973655033111573, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 620000, "num_agent_steps_sampled": 1860000, "num_steps_trained": 620000, "num_agent_steps_trained": 1860000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1907, "training_iteration": 124, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-23-39", "timestamp": 1706232219, "time_this_iter_s": 10.646263599395752, "time_total_s": 1334.2202897071838, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402530790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1334.2202897071838, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 6.733333333333333, "ram_util_percent": 61.80666666666665}}
{"episode_reward_max": 170.67842895537623, "episode_reward_min": 73.27047828875948, "episode_reward_mean": 116.35707833122024, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 23.916541561484337}, "policy_reward_max": {"shared_policy": 57.04860445236166}, "policy_reward_mean": {"shared_policy": 38.785692777073415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [165.9125775732098, 118.4342697430402, 99.1735882423818, 123.92471907660365, 100.01355635374784, 115.37941997125743, 114.10110600106415, 112.79086792422456, 117.5021630823612, 112.61412791535257, 86.42325198510659, 122.48507402231917, 90.56586074642837, 95.03227677196263, 86.96774041652677, 126.37574340589345, 83.51347497478125, 107.21955514699219, 128.05466243997213, 122.08762515708804, 115.77530775358899, 112.47965482994914, 89.11798971425742, 112.66790197789668, 170.67842895537623, 144.32708508148795, 73.27047828875948, 132.1522795520724, 99.91329950280486, 101.59199276193976, 116.79179644375108, 130.8780870046467, 131.9606794267891, 132.25329755246628, 131.22323370911198, 118.30614811927079, 75.39022989571095, 170.1207499541343, 113.19346872437744, 92.36698108911514, 119.68093552812931, 128.06352934241295, 81.97465119510886, 125.34432841092348, 125.62002419680357, 134.31149846687896, 116.86246445719732, 118.98893000185488, 86.51248329225928, 108.64344810717739, 90.99538918118921, 126.27239778824149, 109.54635477066037, 124.78391729295252, 100.083554957062, 123.97133801318704, 112.0297864060849, 155.32116809487326, 119.68342098221181, 121.7442781627178, 115.93474324792624, 120.01007695309815, 139.78491587191803, 102.19029112160204, 76.36578299105165, 134.78829581849283, 88.45658763498068, 88.42612276971337, 157.23599469102905, 140.29000088199976, 96.86673707701264, 115.37516812607643, 101.31040180474517, 102.84862949699163, 112.59338438510893, 97.1988659799099, 89.79614648781714, 114.18181034550071, 100.17063071578741, 141.7999538183208, 131.74417598545546, 115.63765986612998, 125.54375000298022, 132.691582651809, 135.06793657829954, 147.7591934024822, 107.56696170940992, 113.45968980994073, 93.71276669856161, 115.94072170183063, 124.65534887928516, 89.83801336213945, 137.94751274120074, 120.31370067596433, 125.0745694749057, 120.96267866156994, 134.7223692648114, 143.7634446993471, 118.74014297872779, 141.47642382234304], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [55.01106892029445, 55.36463190118472, 55.536876751730844, 39.773964086547494, 39.336151868104935, 39.324153788387775, 33.05574554701646, 32.91304465134938, 33.20479804401596, 40.986210480332375, 41.286529526114464, 41.65197907015681, 33.53181295841932, 33.64545185863972, 32.836291536688805, 38.52625581187506, 38.45168179584046, 38.401482363541916, 38.11101708809534, 37.77750145892301, 38.2125874540458, 37.56228409955898, 37.21533309916654, 38.013250725499034, 39.104647410412625, 39.275453237195805, 39.12206243475278, 37.75803268452485, 37.110287105043724, 37.745808125783995, 29.026324273242295, 28.78390523294607, 28.613022478918225, 40.99268787493929, 40.76613274589181, 40.726253401488066, 29.944470487535, 30.405938839539886, 30.215451419353485, 32.03970727821191, 31.99484461297591, 30.99772488077481, 29.3234728972117, 29.487918535868317, 28.156348983446748, 42.22705846466124, 42.221827141940594, 41.92685779929161, 27.820088716844708, 27.561463604370743, 28.131922653565795, 35.300350447495774, 36.01480569442113, 35.90439900507529, 42.8342367025713, 42.56263984988132, 42.65778588751951, 40.53418678045273, 40.728220481425524, 40.82521789520979, 37.92975695927937, 39.05587181340282, 38.7896789809068, 37.136410623788834, 37.534263394773006, 37.8089808113873, 29.816222185268998, 29.86288116220385, 29.438886366784573, 37.81209137787421, 37.55541272958119, 37.30039787044127, 57.04860445236166, 56.67878048618634, 56.951044016828135, 47.8799140850703, 48.25614655638735, 48.19102444003026, 23.916541561484337, 24.549064692109823, 24.804872035165317, 44.17079544067383, 43.734522968530655, 44.246961142867804, 33.74411607471605, 33.184511115153626, 32.98467231293519, 33.726144567131996, 34.18077592179179, 33.685072273015976, 39.264157181372866, 39.07556650787592, 38.4520727545023, 43.43248230467239, 43.70428877944747, 43.74131592052677, 44.189218054215104, 43.877202714482934, 43.89425865809122, 43.58300307889779, 44.08685917158921, 44.58343530197938, 44.09096420556307, 44.23512095399201, 42.89714854955673, 39.42942205568154, 39.348971394201115, 39.52775466938813, 25.065872110426426, 25.174113288521767, 25.150244496762753, 56.68901805331309, 56.669387505700186, 56.762344395120934, 37.44498758514722, 38.05315989473213, 37.69532124449809, 30.906278885900974, 30.872522428631783, 30.588179774582386, 39.9577915209035, 39.87421968082586, 39.84892432639995, 42.73950193822384, 42.6308351457119, 42.69319225847721, 27.102040479580552, 27.61688733349243, 27.25572338203588, 41.852481581270695, 41.849054127931595, 41.64279270172119, 41.92595670372248, 41.82342889159918, 41.870638601481915, 44.89270545790592, 44.613660427431256, 44.805132581541926, 39.00135450127223, 38.767454298834, 39.09365565709109, 39.6510642816623, 39.44023557504018, 39.897630145152405, 28.6755785420537, 28.86660196632147, 28.970302783884108, 36.34340681717731, 36.090757828205824, 36.20928346179426, 30.456745728539914, 30.101531768838555, 30.43711168381074, 42.07941308369239, 42.298631674920514, 41.89435302962859, 36.32656730214754, 36.70056052009264, 36.5192269484202, 41.830991966029, 41.22060192128022, 41.7323234056433, 33.2191521525383, 33.43425631895661, 33.43014648556709, 41.35615803052981, 41.04571584363778, 41.569464139019445, 37.3451815135777, 37.11375614255667, 37.57084874995053, 51.609414870540306, 51.88688548157613, 51.82486774275701, 39.43124457200368, 40.63118343179424, 39.620992978413895, 40.933087324102715, 40.73901892205079, 40.0721719165643, 38.84390566498041, 38.62032275646925, 38.470514826476574, 39.64727422098318, 40.080766322712094, 40.28203640940288, 46.57149062057336, 46.87073726703723, 46.3426879843076, 34.322027434905365, 33.40688543518384, 34.46137825151284, 25.890980480859668, 24.556102106968552, 25.918700403223426, 44.70196899523337, 45.09405724269648, 44.992269580562905, 29.411920964717865, 29.38408701121807, 29.660579659044743, 29.78009809801975, 28.938600505391747, 29.707424166301877, 52.373819962143884, 52.52832543663679, 52.33384929224847, 47.480722006410346, 45.95531436800955, 46.85396450757979, 32.282192950447396, 32.68438215491672, 31.90016197164853, 38.6299433770279, 38.28982230524221, 38.45540244380632, 34.17370233188072, 33.24137910703817, 33.89532036582628, 34.353809751570225, 34.36975537240505, 34.12506437301636, 37.894829524060086, 37.247374330957726, 37.45118053009112, 32.539220467209816, 32.36419574916363, 32.29544976353645, 29.970021101335675, 29.864999803404004, 29.96112558307746, 37.88869997113943, 38.227693006396294, 38.06541736796498, 33.402980372309685, 33.600183717906475, 33.16746662557125, 47.28962127616008, 47.4416390483578, 47.06869349380334, 43.978549423317105, 44.192946063975484, 43.572680498162896, 38.75189488916658, 38.24716002494097, 38.63860495202243, 41.693675344189, 41.95175250371297, 41.89832215507825, 44.191787148515374, 44.03256000826755, 44.4672354950259, 44.691895484924316, 45.205425828229636, 45.1706152651459, 49.4353604298861, 49.386246771862105, 48.937586200733975, 35.88633509601155, 35.91865573326746, 35.76197088013092, 37.6985508861641, 37.83003763357797, 37.931101290198654, 31.516792233102024, 30.887559562921524, 31.30841490253806, 38.84776798263192, 38.59010677039623, 38.50284694880247, 41.583615535870194, 41.659769545309246, 41.41196379810572, 29.771190730233982, 30.18125159417589, 29.885571037729576, 46.06508057937026, 46.20489615853876, 45.67753600329161, 39.92191662887731, 40.23254100109139, 40.15924304599562, 41.48716933528581, 41.81942425171533, 41.767975887904555, 40.67937290978928, 40.3174106751879, 39.96589507659276, 44.92565357685089, 45.10816823318601, 44.68854745477438, 47.8082137107849, 47.825210161507115, 48.13002082705496, 39.72480486581722, 39.4832314501206, 39.53210666278997, 47.26725602149962, 47.08311518281697, 47.12605261802672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14197544983091462, "mean_inference_ms": 0.6955946096594969, "mean_action_processing_ms": 0.0957869934153891, "mean_env_wait_ms": 0.793633727494183, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 625000, "timesteps_this_iter": 0, "agent_timesteps_total": 1875000, "timers": {"sample_time_ms": 10510.972, "sample_throughput": 475.693, "load_time_ms": 0.1, "load_throughput": 50075262.655, "learn_time_ms": 1974.368, "learn_throughput": 2532.455, "update_time_ms": 9.398}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.888609052210118e-32, "cur_lr": 0.0005000000000000001, "total_loss": 7.077373790740967, "policy_loss": -0.0018485613881066953, "vf_loss": 7.17816128730774, "vf_explained_var": 0.009612667560577392, "kl": 0.0028639350436068254, "entropy": 9.893876075744629, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 625000, "num_agent_steps_sampled": 1875000, "num_steps_trained": 625000, "num_agent_steps_trained": 1875000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1917, "training_iteration": 125, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-23-50", "timestamp": 1706232230, "time_this_iter_s": 10.475836992263794, "time_total_s": 1344.6961266994476, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140234DEE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1344.6961266994476, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 5.913333333333333, "ram_util_percent": 61.660000000000004}}
{"episode_reward_max": 170.67842895537623, "episode_reward_min": 73.27047828875948, "episode_reward_mean": 117.49148897260922, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 23.916541561484337}, "policy_reward_max": {"shared_policy": 57.04860445236166}, "policy_reward_mean": {"shared_policy": 39.16382965753641}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.42325198510659, 122.48507402231917, 90.56586074642837, 95.03227677196263, 86.96774041652677, 126.37574340589345, 83.51347497478125, 107.21955514699219, 128.05466243997213, 122.08762515708804, 115.77530775358899, 112.47965482994914, 89.11798971425742, 112.66790197789668, 170.67842895537623, 144.32708508148795, 73.27047828875948, 132.1522795520724, 99.91329950280486, 101.59199276193976, 116.79179644375108, 130.8780870046467, 131.9606794267891, 132.25329755246628, 131.22323370911198, 118.30614811927079, 75.39022989571095, 170.1207499541343, 113.19346872437744, 92.36698108911514, 119.68093552812931, 128.06352934241295, 81.97465119510886, 125.34432841092348, 125.62002419680357, 134.31149846687896, 116.86246445719732, 118.98893000185488, 86.51248329225928, 108.64344810717739, 90.99538918118921, 126.27239778824149, 109.54635477066037, 124.78391729295252, 100.083554957062, 123.97133801318704, 112.0297864060849, 155.32116809487326, 119.68342098221181, 121.7442781627178, 115.93474324792624, 120.01007695309815, 139.78491587191803, 102.19029112160204, 76.36578299105165, 134.78829581849283, 88.45658763498068, 88.42612276971337, 157.23599469102905, 140.29000088199976, 96.86673707701264, 115.37516812607643, 101.31040180474517, 102.84862949699163, 112.59338438510893, 97.1988659799099, 89.79614648781714, 114.18181034550071, 100.17063071578741, 141.7999538183208, 131.74417598545546, 115.63765986612998, 125.54375000298022, 132.691582651809, 135.06793657829954, 147.7591934024822, 107.56696170940992, 113.45968980994073, 93.71276669856161, 115.94072170183063, 124.65534887928516, 89.83801336213945, 137.94751274120074, 120.31370067596433, 125.0745694749057, 120.96267866156994, 134.7223692648114, 143.7634446993471, 118.74014297872779, 141.47642382234304, 108.06907014548779, 139.2395355030892, 150.467748962343, 146.9393635564484, 86.17034833179784, 116.95246766507623, 141.5258214399219, 135.19952405523497, 138.3493619509971, 130.37421841174356], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [29.026324273242295, 28.78390523294607, 28.613022478918225, 40.99268787493929, 40.76613274589181, 40.726253401488066, 29.944470487535, 30.405938839539886, 30.215451419353485, 32.03970727821191, 31.99484461297591, 30.99772488077481, 29.3234728972117, 29.487918535868317, 28.156348983446748, 42.22705846466124, 42.221827141940594, 41.92685779929161, 27.820088716844708, 27.561463604370743, 28.131922653565795, 35.300350447495774, 36.01480569442113, 35.90439900507529, 42.8342367025713, 42.56263984988132, 42.65778588751951, 40.53418678045273, 40.728220481425524, 40.82521789520979, 37.92975695927937, 39.05587181340282, 38.7896789809068, 37.136410623788834, 37.534263394773006, 37.8089808113873, 29.816222185268998, 29.86288116220385, 29.438886366784573, 37.81209137787421, 37.55541272958119, 37.30039787044127, 57.04860445236166, 56.67878048618634, 56.951044016828135, 47.8799140850703, 48.25614655638735, 48.19102444003026, 23.916541561484337, 24.549064692109823, 24.804872035165317, 44.17079544067383, 43.734522968530655, 44.246961142867804, 33.74411607471605, 33.184511115153626, 32.98467231293519, 33.726144567131996, 34.18077592179179, 33.685072273015976, 39.264157181372866, 39.07556650787592, 38.4520727545023, 43.43248230467239, 43.70428877944747, 43.74131592052677, 44.189218054215104, 43.877202714482934, 43.89425865809122, 43.58300307889779, 44.08685917158921, 44.58343530197938, 44.09096420556307, 44.23512095399201, 42.89714854955673, 39.42942205568154, 39.348971394201115, 39.52775466938813, 25.065872110426426, 25.174113288521767, 25.150244496762753, 56.68901805331309, 56.669387505700186, 56.762344395120934, 37.44498758514722, 38.05315989473213, 37.69532124449809, 30.906278885900974, 30.872522428631783, 30.588179774582386, 39.9577915209035, 39.87421968082586, 39.84892432639995, 42.73950193822384, 42.6308351457119, 42.69319225847721, 27.102040479580552, 27.61688733349243, 27.25572338203588, 41.852481581270695, 41.849054127931595, 41.64279270172119, 41.92595670372248, 41.82342889159918, 41.870638601481915, 44.89270545790592, 44.613660427431256, 44.805132581541926, 39.00135450127223, 38.767454298834, 39.09365565709109, 39.6510642816623, 39.44023557504018, 39.897630145152405, 28.6755785420537, 28.86660196632147, 28.970302783884108, 36.34340681717731, 36.090757828205824, 36.20928346179426, 30.456745728539914, 30.101531768838555, 30.43711168381074, 42.07941308369239, 42.298631674920514, 41.89435302962859, 36.32656730214754, 36.70056052009264, 36.5192269484202, 41.830991966029, 41.22060192128022, 41.7323234056433, 33.2191521525383, 33.43425631895661, 33.43014648556709, 41.35615803052981, 41.04571584363778, 41.569464139019445, 37.3451815135777, 37.11375614255667, 37.57084874995053, 51.609414870540306, 51.88688548157613, 51.82486774275701, 39.43124457200368, 40.63118343179424, 39.620992978413895, 40.933087324102715, 40.73901892205079, 40.0721719165643, 38.84390566498041, 38.62032275646925, 38.470514826476574, 39.64727422098318, 40.080766322712094, 40.28203640940288, 46.57149062057336, 46.87073726703723, 46.3426879843076, 34.322027434905365, 33.40688543518384, 34.46137825151284, 25.890980480859668, 24.556102106968552, 25.918700403223426, 44.70196899523337, 45.09405724269648, 44.992269580562905, 29.411920964717865, 29.38408701121807, 29.660579659044743, 29.78009809801975, 28.938600505391747, 29.707424166301877, 52.373819962143884, 52.52832543663679, 52.33384929224847, 47.480722006410346, 45.95531436800955, 46.85396450757979, 32.282192950447396, 32.68438215491672, 31.90016197164853, 38.6299433770279, 38.28982230524221, 38.45540244380632, 34.17370233188072, 33.24137910703817, 33.89532036582628, 34.353809751570225, 34.36975537240505, 34.12506437301636, 37.894829524060086, 37.247374330957726, 37.45118053009112, 32.539220467209816, 32.36419574916363, 32.29544976353645, 29.970021101335675, 29.864999803404004, 29.96112558307746, 37.88869997113943, 38.227693006396294, 38.06541736796498, 33.402980372309685, 33.600183717906475, 33.16746662557125, 47.28962127616008, 47.4416390483578, 47.06869349380334, 43.978549423317105, 44.192946063975484, 43.572680498162896, 38.75189488916658, 38.24716002494097, 38.63860495202243, 41.693675344189, 41.95175250371297, 41.89832215507825, 44.191787148515374, 44.03256000826755, 44.4672354950259, 44.691895484924316, 45.205425828229636, 45.1706152651459, 49.4353604298861, 49.386246771862105, 48.937586200733975, 35.88633509601155, 35.91865573326746, 35.76197088013092, 37.6985508861641, 37.83003763357797, 37.931101290198654, 31.516792233102024, 30.887559562921524, 31.30841490253806, 38.84776798263192, 38.59010677039623, 38.50284694880247, 41.583615535870194, 41.659769545309246, 41.41196379810572, 29.771190730233982, 30.18125159417589, 29.885571037729576, 46.06508057937026, 46.20489615853876, 45.67753600329161, 39.92191662887731, 40.23254100109139, 40.15924304599562, 41.48716933528581, 41.81942425171533, 41.767975887904555, 40.67937290978928, 40.3174106751879, 39.96589507659276, 44.92565357685089, 45.10816823318601, 44.68854745477438, 47.8082137107849, 47.825210161507115, 48.13002082705496, 39.72480486581722, 39.4832314501206, 39.53210666278997, 47.26725602149962, 47.08311518281697, 47.12605261802672, 36.01941756159067, 35.9348961263895, 36.11475645750761, 46.775391717751816, 46.587513742347554, 45.876630042990044, 50.31204654028018, 50.22594059010346, 49.929761831959084, 49.60311087702091, 48.74546120564143, 48.59079147378604, 28.629594823966414, 28.844662103025854, 28.69609140480557, 38.63829550395408, 39.230196504543215, 39.08397565657893, 47.20580579588811, 47.13055668274562, 47.18945896128814, 44.65182050069173, 45.4306001815324, 45.11710337301095, 45.96261206020911, 46.103755225737885, 46.28299466505025, 43.49239073693752, 43.176884949207306, 43.70494272559881]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14196677894681356, "mean_inference_ms": 0.6955590720408434, "mean_action_processing_ms": 0.09579046754857767, "mean_env_wait_ms": 0.7934459021389462, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 630000, "timesteps_this_iter": 0, "agent_timesteps_total": 1890000, "timers": {"sample_time_ms": 10546.629, "sample_throughput": 474.085, "load_time_ms": 0.1, "load_throughput": 50075262.655, "learn_time_ms": 2012.779, "learn_throughput": 2484.127, "update_time_ms": 9.398}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.944304526105059e-32, "cur_lr": 0.0005000000000000001, "total_loss": 9.280888652801513, "policy_loss": -0.001379545005393812, "vf_loss": 9.380952930450439, "vf_explained_var": -0.019398319721221923, "kl": 0.0025962184591124516, "entropy": 9.86847620010376, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 630000, "num_agent_steps_sampled": 1890000, "num_steps_trained": 630000, "num_agent_steps_trained": 1890000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1927, "training_iteration": 126, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-24-01", "timestamp": 1706232241, "time_this_iter_s": 10.97754430770874, "time_total_s": 1355.6736710071564, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002146F566430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1355.6736710071564, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 7.500000000000001, "ram_util_percent": 61.30666666666665}}
{"episode_reward_max": 170.67842895537623, "episode_reward_min": -334.1127348523587, "episode_reward_mean": 115.52855652074359, "episode_len_mean": 495.66, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -123.139257589976}, "policy_reward_max": {"shared_policy": 57.04860445236166}, "policy_reward_mean": {"shared_policy": 38.50951884024785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [112.47965482994914, 89.11798971425742, 112.66790197789668, 170.67842895537623, 144.32708508148795, 73.27047828875948, 132.1522795520724, 99.91329950280486, 101.59199276193976, 116.79179644375108, 130.8780870046467, 131.9606794267891, 132.25329755246628, 131.22323370911198, 118.30614811927079, 75.39022989571095, 170.1207499541343, 113.19346872437744, 92.36698108911514, 119.68093552812931, 128.06352934241295, 81.97465119510886, 125.34432841092348, 125.62002419680357, 134.31149846687896, 116.86246445719732, 118.98893000185488, 86.51248329225928, 108.64344810717739, 90.99538918118921, 126.27239778824149, 109.54635477066037, 124.78391729295252, 100.083554957062, 123.97133801318704, 112.0297864060849, 155.32116809487326, 119.68342098221181, 121.7442781627178, 115.93474324792624, 120.01007695309815, 139.78491587191803, 102.19029112160204, 76.36578299105165, 134.78829581849283, 88.45658763498068, 88.42612276971337, 157.23599469102905, 140.29000088199976, 96.86673707701264, 115.37516812607643, 101.31040180474517, 102.84862949699163, 112.59338438510893, 97.1988659799099, 89.79614648781714, 114.18181034550071, 100.17063071578741, 141.7999538183208, 131.74417598545546, 115.63765986612998, 125.54375000298022, 132.691582651809, 135.06793657829954, 147.7591934024822, 107.56696170940992, 113.45968980994073, 93.71276669856161, 115.94072170183063, 124.65534887928516, 89.83801336213945, 137.94751274120074, 120.31370067596433, 125.0745694749057, 120.96267866156994, 134.7223692648114, 143.7634446993471, 118.74014297872779, 141.47642382234304, 108.06907014548779, 139.2395355030892, 150.467748962343, 146.9393635564484, 86.17034833179784, 116.95246766507623, 141.5258214399219, 135.19952405523497, 138.3493619509971, 130.37421841174356, 133.57581363618374, 131.83051039464775, -334.1127348523587, 118.62903110682964, 99.27664101868868, 117.75752358883616, 129.39919628575433, 137.37411436066014, 134.24030498787735, 166.29037875682104, 133.9465483501554], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [37.136410623788834, 37.534263394773006, 37.8089808113873, 29.816222185268998, 29.86288116220385, 29.438886366784573, 37.81209137787421, 37.55541272958119, 37.30039787044127, 57.04860445236166, 56.67878048618634, 56.951044016828135, 47.8799140850703, 48.25614655638735, 48.19102444003026, 23.916541561484337, 24.549064692109823, 24.804872035165317, 44.17079544067383, 43.734522968530655, 44.246961142867804, 33.74411607471605, 33.184511115153626, 32.98467231293519, 33.726144567131996, 34.18077592179179, 33.685072273015976, 39.264157181372866, 39.07556650787592, 38.4520727545023, 43.43248230467239, 43.70428877944747, 43.74131592052677, 44.189218054215104, 43.877202714482934, 43.89425865809122, 43.58300307889779, 44.08685917158921, 44.58343530197938, 44.09096420556307, 44.23512095399201, 42.89714854955673, 39.42942205568154, 39.348971394201115, 39.52775466938813, 25.065872110426426, 25.174113288521767, 25.150244496762753, 56.68901805331309, 56.669387505700186, 56.762344395120934, 37.44498758514722, 38.05315989473213, 37.69532124449809, 30.906278885900974, 30.872522428631783, 30.588179774582386, 39.9577915209035, 39.87421968082586, 39.84892432639995, 42.73950193822384, 42.6308351457119, 42.69319225847721, 27.102040479580552, 27.61688733349243, 27.25572338203588, 41.852481581270695, 41.849054127931595, 41.64279270172119, 41.92595670372248, 41.82342889159918, 41.870638601481915, 44.89270545790592, 44.613660427431256, 44.805132581541926, 39.00135450127223, 38.767454298834, 39.09365565709109, 39.6510642816623, 39.44023557504018, 39.897630145152405, 28.6755785420537, 28.86660196632147, 28.970302783884108, 36.34340681717731, 36.090757828205824, 36.20928346179426, 30.456745728539914, 30.101531768838555, 30.43711168381074, 42.07941308369239, 42.298631674920514, 41.89435302962859, 36.32656730214754, 36.70056052009264, 36.5192269484202, 41.830991966029, 41.22060192128022, 41.7323234056433, 33.2191521525383, 33.43425631895661, 33.43014648556709, 41.35615803052981, 41.04571584363778, 41.569464139019445, 37.3451815135777, 37.11375614255667, 37.57084874995053, 51.609414870540306, 51.88688548157613, 51.82486774275701, 39.43124457200368, 40.63118343179424, 39.620992978413895, 40.933087324102715, 40.73901892205079, 40.0721719165643, 38.84390566498041, 38.62032275646925, 38.470514826476574, 39.64727422098318, 40.080766322712094, 40.28203640940288, 46.57149062057336, 46.87073726703723, 46.3426879843076, 34.322027434905365, 33.40688543518384, 34.46137825151284, 25.890980480859668, 24.556102106968552, 25.918700403223426, 44.70196899523337, 45.09405724269648, 44.992269580562905, 29.411920964717865, 29.38408701121807, 29.660579659044743, 29.78009809801975, 28.938600505391747, 29.707424166301877, 52.373819962143884, 52.52832543663679, 52.33384929224847, 47.480722006410346, 45.95531436800955, 46.85396450757979, 32.282192950447396, 32.68438215491672, 31.90016197164853, 38.6299433770279, 38.28982230524221, 38.45540244380632, 34.17370233188072, 33.24137910703817, 33.89532036582628, 34.353809751570225, 34.36975537240505, 34.12506437301636, 37.894829524060086, 37.247374330957726, 37.45118053009112, 32.539220467209816, 32.36419574916363, 32.29544976353645, 29.970021101335675, 29.864999803404004, 29.96112558307746, 37.88869997113943, 38.227693006396294, 38.06541736796498, 33.402980372309685, 33.600183717906475, 33.16746662557125, 47.28962127616008, 47.4416390483578, 47.06869349380334, 43.978549423317105, 44.192946063975484, 43.572680498162896, 38.75189488916658, 38.24716002494097, 38.63860495202243, 41.693675344189, 41.95175250371297, 41.89832215507825, 44.191787148515374, 44.03256000826755, 44.4672354950259, 44.691895484924316, 45.205425828229636, 45.1706152651459, 49.4353604298861, 49.386246771862105, 48.937586200733975, 35.88633509601155, 35.91865573326746, 35.76197088013092, 37.6985508861641, 37.83003763357797, 37.931101290198654, 31.516792233102024, 30.887559562921524, 31.30841490253806, 38.84776798263192, 38.59010677039623, 38.50284694880247, 41.583615535870194, 41.659769545309246, 41.41196379810572, 29.771190730233982, 30.18125159417589, 29.885571037729576, 46.06508057937026, 46.20489615853876, 45.67753600329161, 39.92191662887731, 40.23254100109139, 40.15924304599562, 41.48716933528581, 41.81942425171533, 41.767975887904555, 40.67937290978928, 40.3174106751879, 39.96589507659276, 44.92565357685089, 45.10816823318601, 44.68854745477438, 47.8082137107849, 47.825210161507115, 48.13002082705496, 39.72480486581722, 39.4832314501206, 39.53210666278997, 47.26725602149962, 47.08311518281697, 47.12605261802672, 36.01941756159067, 35.9348961263895, 36.11475645750761, 46.775391717751816, 46.587513742347554, 45.876630042990044, 50.31204654028018, 50.22594059010346, 49.929761831959084, 49.60311087702091, 48.74546120564143, 48.59079147378604, 28.629594823966414, 28.844662103025854, 28.69609140480557, 38.63829550395408, 39.230196504543215, 39.08397565657893, 47.20580579588811, 47.13055668274562, 47.18945896128814, 44.65182050069173, 45.4306001815324, 45.11710337301095, 45.96261206020911, 46.103755225737885, 46.28299466505025, 43.49239073693752, 43.176884949207306, 43.70494272559881, 44.54001827041307, 44.738160277406365, 44.297635088364274, 44.037245583410055, 43.85904802630344, 43.93421678493419, -123.139257589976, -105.5268137815098, -105.44666348087291, 39.54834533855319, 39.65923769399524, 39.421448074281216, 33.1395472548902, 32.94441980868578, 33.192673955112696, 39.17080525557199, 39.54569563517967, 39.041022698084504, 42.82685979704061, 43.14149572948614, 43.430840759227664, 45.34985914329687, 45.87114504973093, 46.15311016763249, 44.945745546370745, 44.58515374362469, 44.709405697882175, 55.5903464059035, 55.26689844826858, 55.43313390264909, 44.59852636605501, 44.67296187579632, 44.675060108304024]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14194250775952363, "mean_inference_ms": 0.6955305478097553, "mean_action_processing_ms": 0.09577451775340079, "mean_env_wait_ms": 0.7933478537856987, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 635000, "timesteps_this_iter": 0, "agent_timesteps_total": 1905000, "timers": {"sample_time_ms": 10644.56, "sample_throughput": 469.724, "load_time_ms": 0.1, "load_throughput": 50075262.655, "learn_time_ms": 2047.994, "learn_throughput": 2441.413, "update_time_ms": 9.597}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9721522630525296e-32, "cur_lr": 0.0005000000000000001, "total_loss": 105.18136215209961, "policy_loss": -0.0016713097493230244, "vf_loss": 105.27990341186523, "vf_explained_var": 0.039577633142471313, "kl": 0.0568779432680814, "entropy": 9.686846923828124, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 635000, "num_agent_steps_sampled": 1905000, "num_steps_trained": 635000, "num_agent_steps_trained": 1905000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1938, "training_iteration": 127, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-24-12", "timestamp": 1706232252, "time_this_iter_s": 11.206668853759766, "time_total_s": 1366.8803398609161, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401890C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1366.8803398609161, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 8.08125, "ram_util_percent": 61.25}}
{"episode_reward_max": 170.1207499541343, "episode_reward_min": -334.1127348523587, "episode_reward_mean": 115.56169950575709, "episode_len_mean": 495.66, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -123.139257589976}, "policy_reward_max": {"shared_policy": 56.762344395120934}, "policy_reward_mean": {"shared_policy": 38.520566501919035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.8780870046467, 131.9606794267891, 132.25329755246628, 131.22323370911198, 118.30614811927079, 75.39022989571095, 170.1207499541343, 113.19346872437744, 92.36698108911514, 119.68093552812931, 128.06352934241295, 81.97465119510886, 125.34432841092348, 125.62002419680357, 134.31149846687896, 116.86246445719732, 118.98893000185488, 86.51248329225928, 108.64344810717739, 90.99538918118921, 126.27239778824149, 109.54635477066037, 124.78391729295252, 100.083554957062, 123.97133801318704, 112.0297864060849, 155.32116809487326, 119.68342098221181, 121.7442781627178, 115.93474324792624, 120.01007695309815, 139.78491587191803, 102.19029112160204, 76.36578299105165, 134.78829581849283, 88.45658763498068, 88.42612276971337, 157.23599469102905, 140.29000088199976, 96.86673707701264, 115.37516812607643, 101.31040180474517, 102.84862949699163, 112.59338438510893, 97.1988659799099, 89.79614648781714, 114.18181034550071, 100.17063071578741, 141.7999538183208, 131.74417598545546, 115.63765986612998, 125.54375000298022, 132.691582651809, 135.06793657829954, 147.7591934024822, 107.56696170940992, 113.45968980994073, 93.71276669856161, 115.94072170183063, 124.65534887928516, 89.83801336213945, 137.94751274120074, 120.31370067596433, 125.0745694749057, 120.96267866156994, 134.7223692648114, 143.7634446993471, 118.74014297872779, 141.47642382234304, 108.06907014548779, 139.2395355030892, 150.467748962343, 146.9393635564484, 86.17034833179784, 116.95246766507623, 141.5258214399219, 135.19952405523497, 138.3493619509971, 130.37421841174356, 133.57581363618374, 131.83051039464775, -334.1127348523587, 118.62903110682964, 99.27664101868868, 117.75752358883616, 129.39919628575433, 137.37411436066014, 134.24030498787735, 166.29037875682104, 133.9465483501554, 101.21973105147478, 133.95984096825134, 137.35658907890308, 108.92666305974126, 81.2803883422166, 134.76634057238687, 101.75679232925175, 130.80428305268293, 91.95194386877117, 134.28263328596944], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [43.43248230467239, 43.70428877944747, 43.74131592052677, 44.189218054215104, 43.877202714482934, 43.89425865809122, 43.58300307889779, 44.08685917158921, 44.58343530197938, 44.09096420556307, 44.23512095399201, 42.89714854955673, 39.42942205568154, 39.348971394201115, 39.52775466938813, 25.065872110426426, 25.174113288521767, 25.150244496762753, 56.68901805331309, 56.669387505700186, 56.762344395120934, 37.44498758514722, 38.05315989473213, 37.69532124449809, 30.906278885900974, 30.872522428631783, 30.588179774582386, 39.9577915209035, 39.87421968082586, 39.84892432639995, 42.73950193822384, 42.6308351457119, 42.69319225847721, 27.102040479580552, 27.61688733349243, 27.25572338203588, 41.852481581270695, 41.849054127931595, 41.64279270172119, 41.92595670372248, 41.82342889159918, 41.870638601481915, 44.89270545790592, 44.613660427431256, 44.805132581541926, 39.00135450127223, 38.767454298834, 39.09365565709109, 39.6510642816623, 39.44023557504018, 39.897630145152405, 28.6755785420537, 28.86660196632147, 28.970302783884108, 36.34340681717731, 36.090757828205824, 36.20928346179426, 30.456745728539914, 30.101531768838555, 30.43711168381074, 42.07941308369239, 42.298631674920514, 41.89435302962859, 36.32656730214754, 36.70056052009264, 36.5192269484202, 41.830991966029, 41.22060192128022, 41.7323234056433, 33.2191521525383, 33.43425631895661, 33.43014648556709, 41.35615803052981, 41.04571584363778, 41.569464139019445, 37.3451815135777, 37.11375614255667, 37.57084874995053, 51.609414870540306, 51.88688548157613, 51.82486774275701, 39.43124457200368, 40.63118343179424, 39.620992978413895, 40.933087324102715, 40.73901892205079, 40.0721719165643, 38.84390566498041, 38.62032275646925, 38.470514826476574, 39.64727422098318, 40.080766322712094, 40.28203640940288, 46.57149062057336, 46.87073726703723, 46.3426879843076, 34.322027434905365, 33.40688543518384, 34.46137825151284, 25.890980480859668, 24.556102106968552, 25.918700403223426, 44.70196899523337, 45.09405724269648, 44.992269580562905, 29.411920964717865, 29.38408701121807, 29.660579659044743, 29.78009809801975, 28.938600505391747, 29.707424166301877, 52.373819962143884, 52.52832543663679, 52.33384929224847, 47.480722006410346, 45.95531436800955, 46.85396450757979, 32.282192950447396, 32.68438215491672, 31.90016197164853, 38.6299433770279, 38.28982230524221, 38.45540244380632, 34.17370233188072, 33.24137910703817, 33.89532036582628, 34.353809751570225, 34.36975537240505, 34.12506437301636, 37.894829524060086, 37.247374330957726, 37.45118053009112, 32.539220467209816, 32.36419574916363, 32.29544976353645, 29.970021101335675, 29.864999803404004, 29.96112558307746, 37.88869997113943, 38.227693006396294, 38.06541736796498, 33.402980372309685, 33.600183717906475, 33.16746662557125, 47.28962127616008, 47.4416390483578, 47.06869349380334, 43.978549423317105, 44.192946063975484, 43.572680498162896, 38.75189488916658, 38.24716002494097, 38.63860495202243, 41.693675344189, 41.95175250371297, 41.89832215507825, 44.191787148515374, 44.03256000826755, 44.4672354950259, 44.691895484924316, 45.205425828229636, 45.1706152651459, 49.4353604298861, 49.386246771862105, 48.937586200733975, 35.88633509601155, 35.91865573326746, 35.76197088013092, 37.6985508861641, 37.83003763357797, 37.931101290198654, 31.516792233102024, 30.887559562921524, 31.30841490253806, 38.84776798263192, 38.59010677039623, 38.50284694880247, 41.583615535870194, 41.659769545309246, 41.41196379810572, 29.771190730233982, 30.18125159417589, 29.885571037729576, 46.06508057937026, 46.20489615853876, 45.67753600329161, 39.92191662887731, 40.23254100109139, 40.15924304599562, 41.48716933528581, 41.81942425171533, 41.767975887904555, 40.67937290978928, 40.3174106751879, 39.96589507659276, 44.92565357685089, 45.10816823318601, 44.68854745477438, 47.8082137107849, 47.825210161507115, 48.13002082705496, 39.72480486581722, 39.4832314501206, 39.53210666278997, 47.26725602149962, 47.08311518281697, 47.12605261802672, 36.01941756159067, 35.9348961263895, 36.11475645750761, 46.775391717751816, 46.587513742347554, 45.876630042990044, 50.31204654028018, 50.22594059010346, 49.929761831959084, 49.60311087702091, 48.74546120564143, 48.59079147378604, 28.629594823966414, 28.844662103025854, 28.69609140480557, 38.63829550395408, 39.230196504543215, 39.08397565657893, 47.20580579588811, 47.13055668274562, 47.18945896128814, 44.65182050069173, 45.4306001815324, 45.11710337301095, 45.96261206020911, 46.103755225737885, 46.28299466505025, 43.49239073693752, 43.176884949207306, 43.70494272559881, 44.54001827041307, 44.738160277406365, 44.297635088364274, 44.037245583410055, 43.85904802630344, 43.93421678493419, -123.139257589976, -105.5268137815098, -105.44666348087291, 39.54834533855319, 39.65923769399524, 39.421448074281216, 33.1395472548902, 32.94441980868578, 33.192673955112696, 39.17080525557199, 39.54569563517967, 39.041022698084504, 42.82685979704061, 43.14149572948614, 43.430840759227664, 45.34985914329687, 45.87114504973093, 46.15311016763249, 44.945745546370745, 44.58515374362469, 44.709405697882175, 55.5903464059035, 55.26689844826858, 55.43313390264909, 44.59852636605501, 44.67296187579632, 44.675060108304024, 33.751097465554864, 34.11265478904048, 33.35597879687944, 44.96781174838543, 44.66676068305969, 44.32526853680611, 45.91165178020795, 45.88201307257016, 45.56292422612508, 36.48026268184185, 35.88510911166668, 36.56129126623273, 27.324076715235904, 26.70661935706933, 27.249692269911364, 45.14874357109268, 44.71746133019526, 44.90013567109902, 34.0252107878526, 34.12317932893832, 33.60840221246083, 44.10742904742558, 43.148900528748825, 43.547953476508454, 30.57377981642881, 30.497785384456307, 30.88037866788605, 44.86177272970477, 44.59771660963693, 44.823143946627766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14193009977040696, "mean_inference_ms": 0.6955518072098126, "mean_action_processing_ms": 0.09578604366092032, "mean_env_wait_ms": 0.7932176044330216, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 640000, "timesteps_this_iter": 0, "agent_timesteps_total": 1920000, "timers": {"sample_time_ms": 10695.599, "sample_throughput": 467.482, "load_time_ms": 0.1, "load_throughput": 50075262.655, "learn_time_ms": 2067.157, "learn_throughput": 2418.781, "update_time_ms": 9.497}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.958228394578794e-32, "cur_lr": 0.0005000000000000001, "total_loss": 7.469736051559448, "policy_loss": -0.0010388506178495404, "vf_loss": 7.569613838195801, "vf_explained_var": 0.022801202535629273, "kl": 0.0029530706582975167, "entropy": 9.88387451171875, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 640000, "num_agent_steps_sampled": 1920000, "num_steps_trained": 640000, "num_agent_steps_trained": 1920000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1948, "training_iteration": 128, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-24-22", "timestamp": 1706232262, "time_this_iter_s": 10.660917043685913, "time_total_s": 1377.541256904602, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D7BF70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1377.541256904602, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 6.766666666666667, "ram_util_percent": 61.68666666666669}}
{"episode_reward_max": 166.29037875682104, "episode_reward_min": -334.1127348523587, "episode_reward_mean": 115.82681855647968, "episode_len_mean": 495.66, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -123.139257589976}, "policy_reward_max": {"shared_policy": 55.5903464059035}, "policy_reward_mean": {"shared_policy": 38.60893951882656}, "custom_metrics": {}, "hist_stats": {"episode_reward": [128.06352934241295, 81.97465119510886, 125.34432841092348, 125.62002419680357, 134.31149846687896, 116.86246445719732, 118.98893000185488, 86.51248329225928, 108.64344810717739, 90.99538918118921, 126.27239778824149, 109.54635477066037, 124.78391729295252, 100.083554957062, 123.97133801318704, 112.0297864060849, 155.32116809487326, 119.68342098221181, 121.7442781627178, 115.93474324792624, 120.01007695309815, 139.78491587191803, 102.19029112160204, 76.36578299105165, 134.78829581849283, 88.45658763498068, 88.42612276971337, 157.23599469102905, 140.29000088199976, 96.86673707701264, 115.37516812607643, 101.31040180474517, 102.84862949699163, 112.59338438510893, 97.1988659799099, 89.79614648781714, 114.18181034550071, 100.17063071578741, 141.7999538183208, 131.74417598545546, 115.63765986612998, 125.54375000298022, 132.691582651809, 135.06793657829954, 147.7591934024822, 107.56696170940992, 113.45968980994073, 93.71276669856161, 115.94072170183063, 124.65534887928516, 89.83801336213945, 137.94751274120074, 120.31370067596433, 125.0745694749057, 120.96267866156994, 134.7223692648114, 143.7634446993471, 118.74014297872779, 141.47642382234304, 108.06907014548779, 139.2395355030892, 150.467748962343, 146.9393635564484, 86.17034833179784, 116.95246766507623, 141.5258214399219, 135.19952405523497, 138.3493619509971, 130.37421841174356, 133.57581363618374, 131.83051039464775, -334.1127348523587, 118.62903110682964, 99.27664101868868, 117.75752358883616, 129.39919628575433, 137.37411436066014, 134.24030498787735, 166.29037875682104, 133.9465483501554, 101.21973105147478, 133.95984096825134, 137.35658907890308, 108.92666305974126, 81.2803883422166, 134.76634057238687, 101.75679232925175, 130.80428305268293, 91.95194386877117, 134.28263328596944, 78.13246705755591, 156.09084088355303, 146.6532235220077, 129.27248310111457, 103.73645926639435, 126.36014158837494, 123.86945599317549, 85.54257975146172, 146.75875849276795, 145.46930641960367], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [42.73950193822384, 42.6308351457119, 42.69319225847721, 27.102040479580552, 27.61688733349243, 27.25572338203588, 41.852481581270695, 41.849054127931595, 41.64279270172119, 41.92595670372248, 41.82342889159918, 41.870638601481915, 44.89270545790592, 44.613660427431256, 44.805132581541926, 39.00135450127223, 38.767454298834, 39.09365565709109, 39.6510642816623, 39.44023557504018, 39.897630145152405, 28.6755785420537, 28.86660196632147, 28.970302783884108, 36.34340681717731, 36.090757828205824, 36.20928346179426, 30.456745728539914, 30.101531768838555, 30.43711168381074, 42.07941308369239, 42.298631674920514, 41.89435302962859, 36.32656730214754, 36.70056052009264, 36.5192269484202, 41.830991966029, 41.22060192128022, 41.7323234056433, 33.2191521525383, 33.43425631895661, 33.43014648556709, 41.35615803052981, 41.04571584363778, 41.569464139019445, 37.3451815135777, 37.11375614255667, 37.57084874995053, 51.609414870540306, 51.88688548157613, 51.82486774275701, 39.43124457200368, 40.63118343179424, 39.620992978413895, 40.933087324102715, 40.73901892205079, 40.0721719165643, 38.84390566498041, 38.62032275646925, 38.470514826476574, 39.64727422098318, 40.080766322712094, 40.28203640940288, 46.57149062057336, 46.87073726703723, 46.3426879843076, 34.322027434905365, 33.40688543518384, 34.46137825151284, 25.890980480859668, 24.556102106968552, 25.918700403223426, 44.70196899523337, 45.09405724269648, 44.992269580562905, 29.411920964717865, 29.38408701121807, 29.660579659044743, 29.78009809801975, 28.938600505391747, 29.707424166301877, 52.373819962143884, 52.52832543663679, 52.33384929224847, 47.480722006410346, 45.95531436800955, 46.85396450757979, 32.282192950447396, 32.68438215491672, 31.90016197164853, 38.6299433770279, 38.28982230524221, 38.45540244380632, 34.17370233188072, 33.24137910703817, 33.89532036582628, 34.353809751570225, 34.36975537240505, 34.12506437301636, 37.894829524060086, 37.247374330957726, 37.45118053009112, 32.539220467209816, 32.36419574916363, 32.29544976353645, 29.970021101335675, 29.864999803404004, 29.96112558307746, 37.88869997113943, 38.227693006396294, 38.06541736796498, 33.402980372309685, 33.600183717906475, 33.16746662557125, 47.28962127616008, 47.4416390483578, 47.06869349380334, 43.978549423317105, 44.192946063975484, 43.572680498162896, 38.75189488916658, 38.24716002494097, 38.63860495202243, 41.693675344189, 41.95175250371297, 41.89832215507825, 44.191787148515374, 44.03256000826755, 44.4672354950259, 44.691895484924316, 45.205425828229636, 45.1706152651459, 49.4353604298861, 49.386246771862105, 48.937586200733975, 35.88633509601155, 35.91865573326746, 35.76197088013092, 37.6985508861641, 37.83003763357797, 37.931101290198654, 31.516792233102024, 30.887559562921524, 31.30841490253806, 38.84776798263192, 38.59010677039623, 38.50284694880247, 41.583615535870194, 41.659769545309246, 41.41196379810572, 29.771190730233982, 30.18125159417589, 29.885571037729576, 46.06508057937026, 46.20489615853876, 45.67753600329161, 39.92191662887731, 40.23254100109139, 40.15924304599562, 41.48716933528581, 41.81942425171533, 41.767975887904555, 40.67937290978928, 40.3174106751879, 39.96589507659276, 44.92565357685089, 45.10816823318601, 44.68854745477438, 47.8082137107849, 47.825210161507115, 48.13002082705496, 39.72480486581722, 39.4832314501206, 39.53210666278997, 47.26725602149962, 47.08311518281697, 47.12605261802672, 36.01941756159067, 35.9348961263895, 36.11475645750761, 46.775391717751816, 46.587513742347554, 45.876630042990044, 50.31204654028018, 50.22594059010346, 49.929761831959084, 49.60311087702091, 48.74546120564143, 48.59079147378604, 28.629594823966414, 28.844662103025854, 28.69609140480557, 38.63829550395408, 39.230196504543215, 39.08397565657893, 47.20580579588811, 47.13055668274562, 47.18945896128814, 44.65182050069173, 45.4306001815324, 45.11710337301095, 45.96261206020911, 46.103755225737885, 46.28299466505025, 43.49239073693752, 43.176884949207306, 43.70494272559881, 44.54001827041307, 44.738160277406365, 44.297635088364274, 44.037245583410055, 43.85904802630344, 43.93421678493419, -123.139257589976, -105.5268137815098, -105.44666348087291, 39.54834533855319, 39.65923769399524, 39.421448074281216, 33.1395472548902, 32.94441980868578, 33.192673955112696, 39.17080525557199, 39.54569563517967, 39.041022698084504, 42.82685979704061, 43.14149572948614, 43.430840759227664, 45.34985914329687, 45.87114504973093, 46.15311016763249, 44.945745546370745, 44.58515374362469, 44.709405697882175, 55.5903464059035, 55.26689844826858, 55.43313390264909, 44.59852636605501, 44.67296187579632, 44.675060108304024, 33.751097465554864, 34.11265478904048, 33.35597879687944, 44.96781174838543, 44.66676068305969, 44.32526853680611, 45.91165178020795, 45.88201307257016, 45.56292422612508, 36.48026268184185, 35.88510911166668, 36.56129126623273, 27.324076715235904, 26.70661935706933, 27.249692269911364, 45.14874357109268, 44.71746133019526, 44.90013567109902, 34.0252107878526, 34.12317932893832, 33.60840221246083, 44.10742904742558, 43.148900528748825, 43.547953476508454, 30.57377981642881, 30.497785384456307, 30.88037866788605, 44.86177272970477, 44.59771660963693, 44.823143946627766, 26.209995936602354, 25.959388971328735, 25.963082149624825, 51.953840814530835, 52.13110953569411, 52.00589053332804, 48.9758359765013, 48.86188255002101, 48.81550499548514, 43.33477020201583, 43.325486229111746, 42.61222666998704, 34.76399494583407, 34.349934498469025, 34.62252982209125, 41.41166085998216, 42.426547079036624, 42.52193364935616, 41.52854636808236, 41.246471894284085, 41.09443773080905, 28.58454271281758, 28.30209833631912, 28.655938702325017, 48.82130034019549, 48.90164863069852, 49.03580952187379, 48.86650497745721, 48.369170308113084, 48.23363113403319]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14191376146240628, "mean_inference_ms": 0.6955603836533462, "mean_action_processing_ms": 0.09579241316003481, "mean_env_wait_ms": 0.7930731683990195, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 645000, "timesteps_this_iter": 0, "agent_timesteps_total": 1935000, "timers": {"sample_time_ms": 10680.964, "sample_throughput": 468.123, "load_time_ms": 0.1, "load_throughput": 50075262.655, "learn_time_ms": 2068.678, "learn_throughput": 2417.002, "update_time_ms": 9.478}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.479114197289397e-32, "cur_lr": 0.0005000000000000001, "total_loss": 6.3917745590209964, "policy_loss": -0.0008218367318040265, "vf_loss": 6.492076396942139, "vf_explained_var": -0.051019132137298584, "kl": 0.0031550412299493555, "entropy": 9.947965908050538, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 645000, "num_agent_steps_sampled": 1935000, "num_steps_trained": 645000, "num_agent_steps_trained": 1935000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1958, "training_iteration": 129, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-24-33", "timestamp": 1706232273, "time_this_iter_s": 10.184222936630249, "time_total_s": 1387.7254798412323, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401890B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1387.7254798412323, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 4.742857142857143, "ram_util_percent": 61.407142857142844}}
{"episode_reward_max": 166.29037875682104, "episode_reward_min": -334.1127348523587, "episode_reward_mean": 117.15079648141281, "episode_len_mean": 495.66, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -123.139257589976}, "policy_reward_max": {"shared_policy": 55.5903464059035}, "policy_reward_mean": {"shared_policy": 39.050265493804275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [126.27239778824149, 109.54635477066037, 124.78391729295252, 100.083554957062, 123.97133801318704, 112.0297864060849, 155.32116809487326, 119.68342098221181, 121.7442781627178, 115.93474324792624, 120.01007695309815, 139.78491587191803, 102.19029112160204, 76.36578299105165, 134.78829581849283, 88.45658763498068, 88.42612276971337, 157.23599469102905, 140.29000088199976, 96.86673707701264, 115.37516812607643, 101.31040180474517, 102.84862949699163, 112.59338438510893, 97.1988659799099, 89.79614648781714, 114.18181034550071, 100.17063071578741, 141.7999538183208, 131.74417598545546, 115.63765986612998, 125.54375000298022, 132.691582651809, 135.06793657829954, 147.7591934024822, 107.56696170940992, 113.45968980994073, 93.71276669856161, 115.94072170183063, 124.65534887928516, 89.83801336213945, 137.94751274120074, 120.31370067596433, 125.0745694749057, 120.96267866156994, 134.7223692648114, 143.7634446993471, 118.74014297872779, 141.47642382234304, 108.06907014548779, 139.2395355030892, 150.467748962343, 146.9393635564484, 86.17034833179784, 116.95246766507623, 141.5258214399219, 135.19952405523497, 138.3493619509971, 130.37421841174356, 133.57581363618374, 131.83051039464775, -334.1127348523587, 118.62903110682964, 99.27664101868868, 117.75752358883616, 129.39919628575433, 137.37411436066014, 134.24030498787735, 166.29037875682104, 133.9465483501554, 101.21973105147478, 133.95984096825134, 137.35658907890308, 108.92666305974126, 81.2803883422166, 134.76634057238687, 101.75679232925175, 130.80428305268293, 91.95194386877117, 134.28263328596944, 78.13246705755591, 156.09084088355303, 146.6532235220077, 129.27248310111457, 103.73645926639435, 126.36014158837494, 123.86945599317549, 85.54257975146172, 146.75875849276795, 145.46930641960367, 128.9043200071901, 135.57737649977213, 118.53046343848106, 103.53722780104727, 116.56761591881511, 135.50912843458352, 134.05540016293506, 108.53489834070204, 120.14562484063207, 148.35248370096076], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [42.07941308369239, 42.298631674920514, 41.89435302962859, 36.32656730214754, 36.70056052009264, 36.5192269484202, 41.830991966029, 41.22060192128022, 41.7323234056433, 33.2191521525383, 33.43425631895661, 33.43014648556709, 41.35615803052981, 41.04571584363778, 41.569464139019445, 37.3451815135777, 37.11375614255667, 37.57084874995053, 51.609414870540306, 51.88688548157613, 51.82486774275701, 39.43124457200368, 40.63118343179424, 39.620992978413895, 40.933087324102715, 40.73901892205079, 40.0721719165643, 38.84390566498041, 38.62032275646925, 38.470514826476574, 39.64727422098318, 40.080766322712094, 40.28203640940288, 46.57149062057336, 46.87073726703723, 46.3426879843076, 34.322027434905365, 33.40688543518384, 34.46137825151284, 25.890980480859668, 24.556102106968552, 25.918700403223426, 44.70196899523337, 45.09405724269648, 44.992269580562905, 29.411920964717865, 29.38408701121807, 29.660579659044743, 29.78009809801975, 28.938600505391747, 29.707424166301877, 52.373819962143884, 52.52832543663679, 52.33384929224847, 47.480722006410346, 45.95531436800955, 46.85396450757979, 32.282192950447396, 32.68438215491672, 31.90016197164853, 38.6299433770279, 38.28982230524221, 38.45540244380632, 34.17370233188072, 33.24137910703817, 33.89532036582628, 34.353809751570225, 34.36975537240505, 34.12506437301636, 37.894829524060086, 37.247374330957726, 37.45118053009112, 32.539220467209816, 32.36419574916363, 32.29544976353645, 29.970021101335675, 29.864999803404004, 29.96112558307746, 37.88869997113943, 38.227693006396294, 38.06541736796498, 33.402980372309685, 33.600183717906475, 33.16746662557125, 47.28962127616008, 47.4416390483578, 47.06869349380334, 43.978549423317105, 44.192946063975484, 43.572680498162896, 38.75189488916658, 38.24716002494097, 38.63860495202243, 41.693675344189, 41.95175250371297, 41.89832215507825, 44.191787148515374, 44.03256000826755, 44.4672354950259, 44.691895484924316, 45.205425828229636, 45.1706152651459, 49.4353604298861, 49.386246771862105, 48.937586200733975, 35.88633509601155, 35.91865573326746, 35.76197088013092, 37.6985508861641, 37.83003763357797, 37.931101290198654, 31.516792233102024, 30.887559562921524, 31.30841490253806, 38.84776798263192, 38.59010677039623, 38.50284694880247, 41.583615535870194, 41.659769545309246, 41.41196379810572, 29.771190730233982, 30.18125159417589, 29.885571037729576, 46.06508057937026, 46.20489615853876, 45.67753600329161, 39.92191662887731, 40.23254100109139, 40.15924304599562, 41.48716933528581, 41.81942425171533, 41.767975887904555, 40.67937290978928, 40.3174106751879, 39.96589507659276, 44.92565357685089, 45.10816823318601, 44.68854745477438, 47.8082137107849, 47.825210161507115, 48.13002082705496, 39.72480486581722, 39.4832314501206, 39.53210666278997, 47.26725602149962, 47.08311518281697, 47.12605261802672, 36.01941756159067, 35.9348961263895, 36.11475645750761, 46.775391717751816, 46.587513742347554, 45.876630042990044, 50.31204654028018, 50.22594059010346, 49.929761831959084, 49.60311087702091, 48.74546120564143, 48.59079147378604, 28.629594823966414, 28.844662103025854, 28.69609140480557, 38.63829550395408, 39.230196504543215, 39.08397565657893, 47.20580579588811, 47.13055668274562, 47.18945896128814, 44.65182050069173, 45.4306001815324, 45.11710337301095, 45.96261206020911, 46.103755225737885, 46.28299466505025, 43.49239073693752, 43.176884949207306, 43.70494272559881, 44.54001827041307, 44.738160277406365, 44.297635088364274, 44.037245583410055, 43.85904802630344, 43.93421678493419, -123.139257589976, -105.5268137815098, -105.44666348087291, 39.54834533855319, 39.65923769399524, 39.421448074281216, 33.1395472548902, 32.94441980868578, 33.192673955112696, 39.17080525557199, 39.54569563517967, 39.041022698084504, 42.82685979704061, 43.14149572948614, 43.430840759227664, 45.34985914329687, 45.87114504973093, 46.15311016763249, 44.945745546370745, 44.58515374362469, 44.709405697882175, 55.5903464059035, 55.26689844826858, 55.43313390264909, 44.59852636605501, 44.67296187579632, 44.675060108304024, 33.751097465554864, 34.11265478904048, 33.35597879687944, 44.96781174838543, 44.66676068305969, 44.32526853680611, 45.91165178020795, 45.88201307257016, 45.56292422612508, 36.48026268184185, 35.88510911166668, 36.56129126623273, 27.324076715235904, 26.70661935706933, 27.249692269911364, 45.14874357109268, 44.71746133019526, 44.90013567109902, 34.0252107878526, 34.12317932893832, 33.60840221246083, 44.10742904742558, 43.148900528748825, 43.547953476508454, 30.57377981642881, 30.497785384456307, 30.88037866788605, 44.86177272970477, 44.59771660963693, 44.823143946627766, 26.209995936602354, 25.959388971328735, 25.963082149624825, 51.953840814530835, 52.13110953569411, 52.00589053332804, 48.9758359765013, 48.86188255002101, 48.81550499548514, 43.33477020201583, 43.325486229111746, 42.61222666998704, 34.76399494583407, 34.349934498469025, 34.62252982209125, 41.41166085998216, 42.426547079036624, 42.52193364935616, 41.52854636808236, 41.246471894284085, 41.09443773080905, 28.58454271281758, 28.30209833631912, 28.655938702325017, 48.82130034019549, 48.90164863069852, 49.03580952187379, 48.86650497745721, 48.369170308113084, 48.23363113403319, 42.50648695230484, 43.32084542326629, 43.07698763161898, 45.55552602310975, 45.4955799182256, 44.52627055843671, 39.59753504085043, 39.34542209903398, 39.58750629859665, 35.09266420919448, 35.01894306577742, 33.42562052607536, 38.7879088881115, 38.88708697507778, 38.89262005562583, 45.059374038130045, 45.21234262548387, 45.23741177096963, 44.22196829319, 45.09085373580456, 44.7425781339407, 36.196886764218405, 36.10648749147852, 36.23152408500512, 39.902309623857334, 40.31909626660247, 39.92421895017226, 49.5441653529803, 49.506925469885275, 49.301392878095314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14190120489238608, "mean_inference_ms": 0.6955715664778701, "mean_action_processing_ms": 0.0958030022892915, "mean_env_wait_ms": 0.7929268344272173, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 650000, "timesteps_this_iter": 0, "agent_timesteps_total": 1950000, "timers": {"sample_time_ms": 10686.013, "sample_throughput": 467.901, "load_time_ms": 0.1, "load_throughput": 50075262.655, "learn_time_ms": 2069.388, "learn_throughput": 2416.173, "update_time_ms": 9.299}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.395570986446985e-33, "cur_lr": 0.0005000000000000001, "total_loss": 6.7929178237915036, "policy_loss": -0.001434756364334966, "vf_loss": 6.892511606216431, "vf_explained_var": 0.0030648112297058105, "kl": 0.0025293616811189077, "entropy": 9.815904235839843, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 650000, "num_agent_steps_sampled": 1950000, "num_steps_trained": 650000, "num_agent_steps_trained": 1950000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1968, "training_iteration": 130, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-24-43", "timestamp": 1706232283, "time_this_iter_s": 10.450876951217651, "time_total_s": 1398.17635679245, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021404255DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1398.17635679245, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 5.293333333333333, "ram_util_percent": 61.45333333333333}}
{"episode_reward_max": 166.29037875682104, "episode_reward_min": -334.1127348523587, "episode_reward_mean": 118.18466240934791, "episode_len_mean": 495.66, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -123.139257589976}, "policy_reward_max": {"shared_policy": 55.5903464059035}, "policy_reward_mean": {"shared_policy": 39.39488746978265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.01007695309815, 139.78491587191803, 102.19029112160204, 76.36578299105165, 134.78829581849283, 88.45658763498068, 88.42612276971337, 157.23599469102905, 140.29000088199976, 96.86673707701264, 115.37516812607643, 101.31040180474517, 102.84862949699163, 112.59338438510893, 97.1988659799099, 89.79614648781714, 114.18181034550071, 100.17063071578741, 141.7999538183208, 131.74417598545546, 115.63765986612998, 125.54375000298022, 132.691582651809, 135.06793657829954, 147.7591934024822, 107.56696170940992, 113.45968980994073, 93.71276669856161, 115.94072170183063, 124.65534887928516, 89.83801336213945, 137.94751274120074, 120.31370067596433, 125.0745694749057, 120.96267866156994, 134.7223692648114, 143.7634446993471, 118.74014297872779, 141.47642382234304, 108.06907014548779, 139.2395355030892, 150.467748962343, 146.9393635564484, 86.17034833179784, 116.95246766507623, 141.5258214399219, 135.19952405523497, 138.3493619509971, 130.37421841174356, 133.57581363618374, 131.83051039464775, -334.1127348523587, 118.62903110682964, 99.27664101868868, 117.75752358883616, 129.39919628575433, 137.37411436066014, 134.24030498787735, 166.29037875682104, 133.9465483501554, 101.21973105147478, 133.95984096825134, 137.35658907890308, 108.92666305974126, 81.2803883422166, 134.76634057238687, 101.75679232925175, 130.80428305268293, 91.95194386877117, 134.28263328596944, 78.13246705755591, 156.09084088355303, 146.6532235220077, 129.27248310111457, 103.73645926639435, 126.36014158837494, 123.86945599317549, 85.54257975146172, 146.75875849276795, 145.46930641960367, 128.9043200071901, 135.57737649977213, 118.53046343848106, 103.53722780104727, 116.56761591881511, 135.50912843458352, 134.05540016293506, 108.53489834070204, 120.14562484063207, 148.35248370096076, 151.22383191436538, 107.11645891144869, 90.1723614372313, 139.85744353500206, 132.95435233414176, 135.23914025723934, 156.58811207674438, 109.85375495254993, 146.31933071650562, 143.43276637420058], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [39.64727422098318, 40.080766322712094, 40.28203640940288, 46.57149062057336, 46.87073726703723, 46.3426879843076, 34.322027434905365, 33.40688543518384, 34.46137825151284, 25.890980480859668, 24.556102106968552, 25.918700403223426, 44.70196899523337, 45.09405724269648, 44.992269580562905, 29.411920964717865, 29.38408701121807, 29.660579659044743, 29.78009809801975, 28.938600505391747, 29.707424166301877, 52.373819962143884, 52.52832543663679, 52.33384929224847, 47.480722006410346, 45.95531436800955, 46.85396450757979, 32.282192950447396, 32.68438215491672, 31.90016197164853, 38.6299433770279, 38.28982230524221, 38.45540244380632, 34.17370233188072, 33.24137910703817, 33.89532036582628, 34.353809751570225, 34.36975537240505, 34.12506437301636, 37.894829524060086, 37.247374330957726, 37.45118053009112, 32.539220467209816, 32.36419574916363, 32.29544976353645, 29.970021101335675, 29.864999803404004, 29.96112558307746, 37.88869997113943, 38.227693006396294, 38.06541736796498, 33.402980372309685, 33.600183717906475, 33.16746662557125, 47.28962127616008, 47.4416390483578, 47.06869349380334, 43.978549423317105, 44.192946063975484, 43.572680498162896, 38.75189488916658, 38.24716002494097, 38.63860495202243, 41.693675344189, 41.95175250371297, 41.89832215507825, 44.191787148515374, 44.03256000826755, 44.4672354950259, 44.691895484924316, 45.205425828229636, 45.1706152651459, 49.4353604298861, 49.386246771862105, 48.937586200733975, 35.88633509601155, 35.91865573326746, 35.76197088013092, 37.6985508861641, 37.83003763357797, 37.931101290198654, 31.516792233102024, 30.887559562921524, 31.30841490253806, 38.84776798263192, 38.59010677039623, 38.50284694880247, 41.583615535870194, 41.659769545309246, 41.41196379810572, 29.771190730233982, 30.18125159417589, 29.885571037729576, 46.06508057937026, 46.20489615853876, 45.67753600329161, 39.92191662887731, 40.23254100109139, 40.15924304599562, 41.48716933528581, 41.81942425171533, 41.767975887904555, 40.67937290978928, 40.3174106751879, 39.96589507659276, 44.92565357685089, 45.10816823318601, 44.68854745477438, 47.8082137107849, 47.825210161507115, 48.13002082705496, 39.72480486581722, 39.4832314501206, 39.53210666278997, 47.26725602149962, 47.08311518281697, 47.12605261802672, 36.01941756159067, 35.9348961263895, 36.11475645750761, 46.775391717751816, 46.587513742347554, 45.876630042990044, 50.31204654028018, 50.22594059010346, 49.929761831959084, 49.60311087702091, 48.74546120564143, 48.59079147378604, 28.629594823966414, 28.844662103025854, 28.69609140480557, 38.63829550395408, 39.230196504543215, 39.08397565657893, 47.20580579588811, 47.13055668274562, 47.18945896128814, 44.65182050069173, 45.4306001815324, 45.11710337301095, 45.96261206020911, 46.103755225737885, 46.28299466505025, 43.49239073693752, 43.176884949207306, 43.70494272559881, 44.54001827041307, 44.738160277406365, 44.297635088364274, 44.037245583410055, 43.85904802630344, 43.93421678493419, -123.139257589976, -105.5268137815098, -105.44666348087291, 39.54834533855319, 39.65923769399524, 39.421448074281216, 33.1395472548902, 32.94441980868578, 33.192673955112696, 39.17080525557199, 39.54569563517967, 39.041022698084504, 42.82685979704061, 43.14149572948614, 43.430840759227664, 45.34985914329687, 45.87114504973093, 46.15311016763249, 44.945745546370745, 44.58515374362469, 44.709405697882175, 55.5903464059035, 55.26689844826858, 55.43313390264909, 44.59852636605501, 44.67296187579632, 44.675060108304024, 33.751097465554864, 34.11265478904048, 33.35597879687944, 44.96781174838543, 44.66676068305969, 44.32526853680611, 45.91165178020795, 45.88201307257016, 45.56292422612508, 36.48026268184185, 35.88510911166668, 36.56129126623273, 27.324076715235904, 26.70661935706933, 27.249692269911364, 45.14874357109268, 44.71746133019526, 44.90013567109902, 34.0252107878526, 34.12317932893832, 33.60840221246083, 44.10742904742558, 43.148900528748825, 43.547953476508454, 30.57377981642881, 30.497785384456307, 30.88037866788605, 44.86177272970477, 44.59771660963693, 44.823143946627766, 26.209995936602354, 25.959388971328735, 25.963082149624825, 51.953840814530835, 52.13110953569411, 52.00589053332804, 48.9758359765013, 48.86188255002101, 48.81550499548514, 43.33477020201583, 43.325486229111746, 42.61222666998704, 34.76399494583407, 34.349934498469025, 34.62252982209125, 41.41166085998216, 42.426547079036624, 42.52193364935616, 41.52854636808236, 41.246471894284085, 41.09443773080905, 28.58454271281758, 28.30209833631912, 28.655938702325017, 48.82130034019549, 48.90164863069852, 49.03580952187379, 48.86650497745721, 48.369170308113084, 48.23363113403319, 42.50648695230484, 43.32084542326629, 43.07698763161898, 45.55552602310975, 45.4955799182256, 44.52627055843671, 39.59753504085043, 39.34542209903398, 39.58750629859665, 35.09266420919448, 35.01894306577742, 33.42562052607536, 38.7879088881115, 38.88708697507778, 38.89262005562583, 45.059374038130045, 45.21234262548387, 45.23741177096963, 44.22196829319, 45.09085373580456, 44.7425781339407, 36.196886764218405, 36.10648749147852, 36.23152408500512, 39.902309623857334, 40.31909626660247, 39.92421895017226, 49.5441653529803, 49.506925469885275, 49.301392878095314, 50.585787529746696, 50.45189526925485, 50.18614911536376, 35.163063565889985, 36.514508603761584, 35.43888674179712, 30.184687308967113, 30.347724433988333, 29.639949694275856, 46.64923969656229, 46.478160470724106, 46.73004336771555, 44.31555781016746, 44.17379781107107, 44.46499671290317, 45.01273884624243, 44.994434241205454, 45.23196716979146, 51.9688869168361, 52.60993925792475, 52.009285901983574, 36.26050452888012, 36.72144643217325, 36.87180399149656, 48.75368596985935, 48.70624143630265, 48.85940331034361, 47.79548057913779, 47.87285973876713, 47.76442605629562]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1418891249056045, "mean_inference_ms": 0.6955974093662757, "mean_action_processing_ms": 0.09581815987933907, "mean_env_wait_ms": 0.7927985160436699, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 655000, "timesteps_this_iter": 0, "agent_timesteps_total": 1965000, "timers": {"sample_time_ms": 10712.586, "sample_throughput": 466.741, "load_time_ms": 0.1, "load_throughput": 50075262.655, "learn_time_ms": 2085.261, "learn_throughput": 2397.781, "update_time_ms": 9.329}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.697785493223493e-33, "cur_lr": 0.0005000000000000001, "total_loss": 7.198504877090454, "policy_loss": -0.0011593310826155446, "vf_loss": 7.297978734970092, "vf_explained_var": -0.0013733983039855957, "kl": 0.0023165081395214665, "entropy": 9.831432628631593, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 655000, "num_agent_steps_sampled": 1965000, "num_steps_trained": 655000, "num_agent_steps_trained": 1965000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1978, "training_iteration": 131, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-24-54", "timestamp": 1706232294, "time_this_iter_s": 10.837291240692139, "time_total_s": 1409.013648033142, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402E08DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1409.013648033142, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 8.1125, "ram_util_percent": 61.537499999999994}}
{"episode_reward_max": 166.29037875682104, "episode_reward_min": -334.1127348523587, "episode_reward_mean": 119.16161027159802, "episode_len_mean": 495.66, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -123.139257589976}, "policy_reward_max": {"shared_policy": 55.5903464059035}, "policy_reward_mean": {"shared_policy": 39.72053675719933}, "custom_metrics": {}, "hist_stats": {"episode_reward": [115.37516812607643, 101.31040180474517, 102.84862949699163, 112.59338438510893, 97.1988659799099, 89.79614648781714, 114.18181034550071, 100.17063071578741, 141.7999538183208, 131.74417598545546, 115.63765986612998, 125.54375000298022, 132.691582651809, 135.06793657829954, 147.7591934024822, 107.56696170940992, 113.45968980994073, 93.71276669856161, 115.94072170183063, 124.65534887928516, 89.83801336213945, 137.94751274120074, 120.31370067596433, 125.0745694749057, 120.96267866156994, 134.7223692648114, 143.7634446993471, 118.74014297872779, 141.47642382234304, 108.06907014548779, 139.2395355030892, 150.467748962343, 146.9393635564484, 86.17034833179784, 116.95246766507623, 141.5258214399219, 135.19952405523497, 138.3493619509971, 130.37421841174356, 133.57581363618374, 131.83051039464775, -334.1127348523587, 118.62903110682964, 99.27664101868868, 117.75752358883616, 129.39919628575433, 137.37411436066014, 134.24030498787735, 166.29037875682104, 133.9465483501554, 101.21973105147478, 133.95984096825134, 137.35658907890308, 108.92666305974126, 81.2803883422166, 134.76634057238687, 101.75679232925175, 130.80428305268293, 91.95194386877117, 134.28263328596944, 78.13246705755591, 156.09084088355303, 146.6532235220077, 129.27248310111457, 103.73645926639435, 126.36014158837494, 123.86945599317549, 85.54257975146172, 146.75875849276795, 145.46930641960367, 128.9043200071901, 135.57737649977213, 118.53046343848106, 103.53722780104727, 116.56761591881511, 135.50912843458352, 134.05540016293506, 108.53489834070204, 120.14562484063207, 148.35248370096076, 151.22383191436538, 107.11645891144869, 90.1723614372313, 139.85744353500206, 132.95435233414176, 135.23914025723934, 156.58811207674438, 109.85375495254993, 146.31933071650562, 143.43276637420058, 136.9448690488935, 134.11737747862927, 142.3183945827189, 106.27096373215318, 101.4941501766443, 134.0058088228107, 99.19877780508249, 154.15001678280535, 96.64703982789068, 136.96219377827936], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [38.6299433770279, 38.28982230524221, 38.45540244380632, 34.17370233188072, 33.24137910703817, 33.89532036582628, 34.353809751570225, 34.36975537240505, 34.12506437301636, 37.894829524060086, 37.247374330957726, 37.45118053009112, 32.539220467209816, 32.36419574916363, 32.29544976353645, 29.970021101335675, 29.864999803404004, 29.96112558307746, 37.88869997113943, 38.227693006396294, 38.06541736796498, 33.402980372309685, 33.600183717906475, 33.16746662557125, 47.28962127616008, 47.4416390483578, 47.06869349380334, 43.978549423317105, 44.192946063975484, 43.572680498162896, 38.75189488916658, 38.24716002494097, 38.63860495202243, 41.693675344189, 41.95175250371297, 41.89832215507825, 44.191787148515374, 44.03256000826755, 44.4672354950259, 44.691895484924316, 45.205425828229636, 45.1706152651459, 49.4353604298861, 49.386246771862105, 48.937586200733975, 35.88633509601155, 35.91865573326746, 35.76197088013092, 37.6985508861641, 37.83003763357797, 37.931101290198654, 31.516792233102024, 30.887559562921524, 31.30841490253806, 38.84776798263192, 38.59010677039623, 38.50284694880247, 41.583615535870194, 41.659769545309246, 41.41196379810572, 29.771190730233982, 30.18125159417589, 29.885571037729576, 46.06508057937026, 46.20489615853876, 45.67753600329161, 39.92191662887731, 40.23254100109139, 40.15924304599562, 41.48716933528581, 41.81942425171533, 41.767975887904555, 40.67937290978928, 40.3174106751879, 39.96589507659276, 44.92565357685089, 45.10816823318601, 44.68854745477438, 47.8082137107849, 47.825210161507115, 48.13002082705496, 39.72480486581722, 39.4832314501206, 39.53210666278997, 47.26725602149962, 47.08311518281697, 47.12605261802672, 36.01941756159067, 35.9348961263895, 36.11475645750761, 46.775391717751816, 46.587513742347554, 45.876630042990044, 50.31204654028018, 50.22594059010346, 49.929761831959084, 49.60311087702091, 48.74546120564143, 48.59079147378604, 28.629594823966414, 28.844662103025854, 28.69609140480557, 38.63829550395408, 39.230196504543215, 39.08397565657893, 47.20580579588811, 47.13055668274562, 47.18945896128814, 44.65182050069173, 45.4306001815324, 45.11710337301095, 45.96261206020911, 46.103755225737885, 46.28299466505025, 43.49239073693752, 43.176884949207306, 43.70494272559881, 44.54001827041307, 44.738160277406365, 44.297635088364274, 44.037245583410055, 43.85904802630344, 43.93421678493419, -123.139257589976, -105.5268137815098, -105.44666348087291, 39.54834533855319, 39.65923769399524, 39.421448074281216, 33.1395472548902, 32.94441980868578, 33.192673955112696, 39.17080525557199, 39.54569563517967, 39.041022698084504, 42.82685979704061, 43.14149572948614, 43.430840759227664, 45.34985914329687, 45.87114504973093, 46.15311016763249, 44.945745546370745, 44.58515374362469, 44.709405697882175, 55.5903464059035, 55.26689844826858, 55.43313390264909, 44.59852636605501, 44.67296187579632, 44.675060108304024, 33.751097465554864, 34.11265478904048, 33.35597879687944, 44.96781174838543, 44.66676068305969, 44.32526853680611, 45.91165178020795, 45.88201307257016, 45.56292422612508, 36.48026268184185, 35.88510911166668, 36.56129126623273, 27.324076715235904, 26.70661935706933, 27.249692269911364, 45.14874357109268, 44.71746133019526, 44.90013567109902, 34.0252107878526, 34.12317932893832, 33.60840221246083, 44.10742904742558, 43.148900528748825, 43.547953476508454, 30.57377981642881, 30.497785384456307, 30.88037866788605, 44.86177272970477, 44.59771660963693, 44.823143946627766, 26.209995936602354, 25.959388971328735, 25.963082149624825, 51.953840814530835, 52.13110953569411, 52.00589053332804, 48.9758359765013, 48.86188255002101, 48.81550499548514, 43.33477020201583, 43.325486229111746, 42.61222666998704, 34.76399494583407, 34.349934498469025, 34.62252982209125, 41.41166085998216, 42.426547079036624, 42.52193364935616, 41.52854636808236, 41.246471894284085, 41.09443773080905, 28.58454271281758, 28.30209833631912, 28.655938702325017, 48.82130034019549, 48.90164863069852, 49.03580952187379, 48.86650497745721, 48.369170308113084, 48.23363113403319, 42.50648695230484, 43.32084542326629, 43.07698763161898, 45.55552602310975, 45.4955799182256, 44.52627055843671, 39.59753504085043, 39.34542209903398, 39.58750629859665, 35.09266420919448, 35.01894306577742, 33.42562052607536, 38.7879088881115, 38.88708697507778, 38.89262005562583, 45.059374038130045, 45.21234262548387, 45.23741177096963, 44.22196829319, 45.09085373580456, 44.7425781339407, 36.196886764218405, 36.10648749147852, 36.23152408500512, 39.902309623857334, 40.31909626660247, 39.92421895017226, 49.5441653529803, 49.506925469885275, 49.301392878095314, 50.585787529746696, 50.45189526925485, 50.18614911536376, 35.163063565889985, 36.514508603761584, 35.43888674179712, 30.184687308967113, 30.347724433988333, 29.639949694275856, 46.64923969656229, 46.478160470724106, 46.73004336771555, 44.31555781016746, 44.17379781107107, 44.46499671290317, 45.01273884624243, 44.994434241205454, 45.23196716979146, 51.9688869168361, 52.60993925792475, 52.009285901983574, 36.26050452888012, 36.72144643217325, 36.87180399149656, 48.75368596985935, 48.70624143630265, 48.85940331034361, 47.79548057913779, 47.87285973876713, 47.76442605629562, 45.733269446839884, 45.62022704010208, 45.591372561951474, 44.481723489860684, 44.79034812624255, 44.84530586252609, 47.40731324007113, 47.4012867261966, 47.50979461645086, 35.215998992323875, 35.661337833851576, 35.393626905977726, 33.77927070359388, 34.1667517820994, 33.54812769095102, 44.92155412584543, 44.80714900791645, 44.27710568904877, 33.1511616812398, 32.90747597937782, 33.140140144464866, 51.380060166120515, 51.50359793566166, 51.26635868102311, 32.16781839852531, 32.37969322719921, 32.099528202166155, 45.275131473938615, 46.36361962668403, 45.3234426776568]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14188137892044447, "mean_inference_ms": 0.6956336490630874, "mean_action_processing_ms": 0.09583290783154869, "mean_env_wait_ms": 0.7926610543485317, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 660000, "timesteps_this_iter": 0, "agent_timesteps_total": 1980000, "timers": {"sample_time_ms": 10723.347, "sample_throughput": 466.272, "load_time_ms": 0.199, "load_throughput": 25151739.026, "learn_time_ms": 2095.489, "learn_throughput": 2386.078, "update_time_ms": 9.33}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8488927466117464e-33, "cur_lr": 0.0005000000000000001, "total_loss": 7.104607057571411, "policy_loss": -0.0017175305373562822, "vf_loss": 7.2037575244903564, "vf_explained_var": 0.03149996399879455, "kl": 0.0026852121693462885, "entropy": 9.74331169128418, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 660000, "num_agent_steps_sampled": 1980000, "num_steps_trained": 660000, "num_agent_steps_trained": 1980000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1988, "training_iteration": 132, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-25-05", "timestamp": 1706232305, "time_this_iter_s": 10.680182218551636, "time_total_s": 1419.6938302516937, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D8C430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1419.6938302516937, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 7.5200000000000005, "ram_util_percent": 61.61333333333334}}
{"episode_reward_max": 166.29037875682104, "episode_reward_min": -334.1127348523587, "episode_reward_mean": 114.70533558525639, "episode_len_mean": 491.59, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -123.139257589976}, "policy_reward_max": {"shared_policy": 55.5903464059035}, "policy_reward_mean": {"shared_policy": 38.235111861752124}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.54375000298022, 132.691582651809, 135.06793657829954, 147.7591934024822, 107.56696170940992, 113.45968980994073, 93.71276669856161, 115.94072170183063, 124.65534887928516, 89.83801336213945, 137.94751274120074, 120.31370067596433, 125.0745694749057, 120.96267866156994, 134.7223692648114, 143.7634446993471, 118.74014297872779, 141.47642382234304, 108.06907014548779, 139.2395355030892, 150.467748962343, 146.9393635564484, 86.17034833179784, 116.95246766507623, 141.5258214399219, 135.19952405523497, 138.3493619509971, 130.37421841174356, 133.57581363618374, 131.83051039464775, -334.1127348523587, 118.62903110682964, 99.27664101868868, 117.75752358883616, 129.39919628575433, 137.37411436066014, 134.24030498787735, 166.29037875682104, 133.9465483501554, 101.21973105147478, 133.95984096825134, 137.35658907890308, 108.92666305974126, 81.2803883422166, 134.76634057238687, 101.75679232925175, 130.80428305268293, 91.95194386877117, 134.28263328596944, 78.13246705755591, 156.09084088355303, 146.6532235220077, 129.27248310111457, 103.73645926639435, 126.36014158837494, 123.86945599317549, 85.54257975146172, 146.75875849276795, 145.46930641960367, 128.9043200071901, 135.57737649977213, 118.53046343848106, 103.53722780104727, 116.56761591881511, 135.50912843458352, 134.05540016293506, 108.53489834070204, 120.14562484063207, 148.35248370096076, 151.22383191436538, 107.11645891144869, 90.1723614372313, 139.85744353500206, 132.95435233414176, 135.23914025723934, 156.58811207674438, 109.85375495254993, 146.31933071650562, 143.43276637420058, 136.9448690488935, 134.11737747862927, 142.3183945827189, 106.27096373215318, 101.4941501766443, 134.0058088228107, 99.19877780508249, 154.15001678280535, 96.64703982789068, 136.96219377827936, 88.5382442101836, 133.05644864588993, 75.89013805240391, 103.00750897079706, 119.4322717115283, 79.93189235217866, 127.46524012647568, 110.58188949897882, 113.12407694011924, 108.71036775410175, -282.70871988497674], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 93], "policy_shared_policy_reward": [41.693675344189, 41.95175250371297, 41.89832215507825, 44.191787148515374, 44.03256000826755, 44.4672354950259, 44.691895484924316, 45.205425828229636, 45.1706152651459, 49.4353604298861, 49.386246771862105, 48.937586200733975, 35.88633509601155, 35.91865573326746, 35.76197088013092, 37.6985508861641, 37.83003763357797, 37.931101290198654, 31.516792233102024, 30.887559562921524, 31.30841490253806, 38.84776798263192, 38.59010677039623, 38.50284694880247, 41.583615535870194, 41.659769545309246, 41.41196379810572, 29.771190730233982, 30.18125159417589, 29.885571037729576, 46.06508057937026, 46.20489615853876, 45.67753600329161, 39.92191662887731, 40.23254100109139, 40.15924304599562, 41.48716933528581, 41.81942425171533, 41.767975887904555, 40.67937290978928, 40.3174106751879, 39.96589507659276, 44.92565357685089, 45.10816823318601, 44.68854745477438, 47.8082137107849, 47.825210161507115, 48.13002082705496, 39.72480486581722, 39.4832314501206, 39.53210666278997, 47.26725602149962, 47.08311518281697, 47.12605261802672, 36.01941756159067, 35.9348961263895, 36.11475645750761, 46.775391717751816, 46.587513742347554, 45.876630042990044, 50.31204654028018, 50.22594059010346, 49.929761831959084, 49.60311087702091, 48.74546120564143, 48.59079147378604, 28.629594823966414, 28.844662103025854, 28.69609140480557, 38.63829550395408, 39.230196504543215, 39.08397565657893, 47.20580579588811, 47.13055668274562, 47.18945896128814, 44.65182050069173, 45.4306001815324, 45.11710337301095, 45.96261206020911, 46.103755225737885, 46.28299466505025, 43.49239073693752, 43.176884949207306, 43.70494272559881, 44.54001827041307, 44.738160277406365, 44.297635088364274, 44.037245583410055, 43.85904802630344, 43.93421678493419, -123.139257589976, -105.5268137815098, -105.44666348087291, 39.54834533855319, 39.65923769399524, 39.421448074281216, 33.1395472548902, 32.94441980868578, 33.192673955112696, 39.17080525557199, 39.54569563517967, 39.041022698084504, 42.82685979704061, 43.14149572948614, 43.430840759227664, 45.34985914329687, 45.87114504973093, 46.15311016763249, 44.945745546370745, 44.58515374362469, 44.709405697882175, 55.5903464059035, 55.26689844826858, 55.43313390264909, 44.59852636605501, 44.67296187579632, 44.675060108304024, 33.751097465554864, 34.11265478904048, 33.35597879687944, 44.96781174838543, 44.66676068305969, 44.32526853680611, 45.91165178020795, 45.88201307257016, 45.56292422612508, 36.48026268184185, 35.88510911166668, 36.56129126623273, 27.324076715235904, 26.70661935706933, 27.249692269911364, 45.14874357109268, 44.71746133019526, 44.90013567109902, 34.0252107878526, 34.12317932893832, 33.60840221246083, 44.10742904742558, 43.148900528748825, 43.547953476508454, 30.57377981642881, 30.497785384456307, 30.88037866788605, 44.86177272970477, 44.59771660963693, 44.823143946627766, 26.209995936602354, 25.959388971328735, 25.963082149624825, 51.953840814530835, 52.13110953569411, 52.00589053332804, 48.9758359765013, 48.86188255002101, 48.81550499548514, 43.33477020201583, 43.325486229111746, 42.61222666998704, 34.76399494583407, 34.349934498469025, 34.62252982209125, 41.41166085998216, 42.426547079036624, 42.52193364935616, 41.52854636808236, 41.246471894284085, 41.09443773080905, 28.58454271281758, 28.30209833631912, 28.655938702325017, 48.82130034019549, 48.90164863069852, 49.03580952187379, 48.86650497745721, 48.369170308113084, 48.23363113403319, 42.50648695230484, 43.32084542326629, 43.07698763161898, 45.55552602310975, 45.4955799182256, 44.52627055843671, 39.59753504085043, 39.34542209903398, 39.58750629859665, 35.09266420919448, 35.01894306577742, 33.42562052607536, 38.7879088881115, 38.88708697507778, 38.89262005562583, 45.059374038130045, 45.21234262548387, 45.23741177096963, 44.22196829319, 45.09085373580456, 44.7425781339407, 36.196886764218405, 36.10648749147852, 36.23152408500512, 39.902309623857334, 40.31909626660247, 39.92421895017226, 49.5441653529803, 49.506925469885275, 49.301392878095314, 50.585787529746696, 50.45189526925485, 50.18614911536376, 35.163063565889985, 36.514508603761584, 35.43888674179712, 30.184687308967113, 30.347724433988333, 29.639949694275856, 46.64923969656229, 46.478160470724106, 46.73004336771555, 44.31555781016746, 44.17379781107107, 44.46499671290317, 45.01273884624243, 44.994434241205454, 45.23196716979146, 51.9688869168361, 52.60993925792475, 52.009285901983574, 36.26050452888012, 36.72144643217325, 36.87180399149656, 48.75368596985935, 48.70624143630265, 48.85940331034361, 47.79548057913779, 47.87285973876713, 47.76442605629562, 45.733269446839884, 45.62022704010208, 45.591372561951474, 44.481723489860684, 44.79034812624255, 44.84530586252609, 47.40731324007113, 47.4012867261966, 47.50979461645086, 35.215998992323875, 35.661337833851576, 35.393626905977726, 33.77927070359388, 34.1667517820994, 33.54812769095102, 44.92155412584543, 44.80714900791645, 44.27710568904877, 33.1511616812398, 32.90747597937782, 33.140140144464866, 51.380060166120515, 51.50359793566166, 51.26635868102311, 32.16781839852531, 32.37969322719921, 32.099528202166155, 45.275131473938615, 46.36361962668403, 45.3234426776568, 29.62230559190114, 29.594813508292034, 29.321125109990433, 44.63909646930793, 43.88514972726503, 44.53220244931677, 24.943212648232773, 25.533745815356568, 25.41317958881457, 34.56345988065004, 34.399751737713814, 34.044297352433205, 40.16272837668657, 39.406241685152054, 39.863301649689674, 26.67361358801523, 26.367595369617135, 26.8906833945463, 42.543158059318856, 42.632256078844264, 42.28982598831256, 36.88895215342441, 36.633733371893555, 37.05920397366086, 37.73404852549234, 37.7448146889607, 37.645213725666196, 36.13717131316662, 36.481280997395515, 36.09191544353962, -90.452999866878, -90.62463916217288, -101.63108085592589]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1418757136984049, "mean_inference_ms": 0.6955991421622296, "mean_action_processing_ms": 0.09585031956948697, "mean_env_wait_ms": 0.7924181678701773, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 665000, "timesteps_this_iter": 0, "agent_timesteps_total": 1995000, "timers": {"sample_time_ms": 10705.511, "sample_throughput": 467.049, "load_time_ms": 0.199, "load_throughput": 25151739.026, "learn_time_ms": 2103.805, "learn_throughput": 2376.647, "update_time_ms": 9.332}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.244463733058732e-34, "cur_lr": 0.0005000000000000001, "total_loss": 106.42937088012695, "policy_loss": -0.0016090800521466164, "vf_loss": 106.52887725830078, "vf_explained_var": -0.0016494274139404296, "kl": 0.00554031813520979, "entropy": 9.789347743988037, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 665000, "num_agent_steps_sampled": 1995000, "num_steps_trained": 665000, "num_agent_steps_trained": 1995000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1999, "training_iteration": 133, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-25-15", "timestamp": 1706232315, "time_this_iter_s": 10.700225114822388, "time_total_s": 1430.394055366516, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002146F566430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1430.394055366516, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 6.346666666666666, "ram_util_percent": 61.40666666666666}}
{"episode_reward_max": 166.55837408825758, "episode_reward_min": -334.1127348523587, "episode_reward_mean": 111.87341181414463, "episode_len_mean": 489.11, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -123.139257589976}, "policy_reward_max": {"shared_policy": 55.5903464059035}, "policy_reward_mean": {"shared_policy": 37.29113727138154}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.31370067596433, 125.0745694749057, 120.96267866156994, 134.7223692648114, 143.7634446993471, 118.74014297872779, 141.47642382234304, 108.06907014548779, 139.2395355030892, 150.467748962343, 146.9393635564484, 86.17034833179784, 116.95246766507623, 141.5258214399219, 135.19952405523497, 138.3493619509971, 130.37421841174356, 133.57581363618374, 131.83051039464775, -334.1127348523587, 118.62903110682964, 99.27664101868868, 117.75752358883616, 129.39919628575433, 137.37411436066014, 134.24030498787735, 166.29037875682104, 133.9465483501554, 101.21973105147478, 133.95984096825134, 137.35658907890308, 108.92666305974126, 81.2803883422166, 134.76634057238687, 101.75679232925175, 130.80428305268293, 91.95194386877117, 134.28263328596944, 78.13246705755591, 156.09084088355303, 146.6532235220077, 129.27248310111457, 103.73645926639435, 126.36014158837494, 123.86945599317549, 85.54257975146172, 146.75875849276795, 145.46930641960367, 128.9043200071901, 135.57737649977213, 118.53046343848106, 103.53722780104727, 116.56761591881511, 135.50912843458352, 134.05540016293506, 108.53489834070204, 120.14562484063207, 148.35248370096076, 151.22383191436538, 107.11645891144869, 90.1723614372313, 139.85744353500206, 132.95435233414176, 135.23914025723934, 156.58811207674438, 109.85375495254993, 146.31933071650562, 143.43276637420058, 136.9448690488935, 134.11737747862927, 142.3183945827189, 106.27096373215318, 101.4941501766443, 134.0058088228107, 99.19877780508249, 154.15001678280535, 96.64703982789068, 136.96219377827936, 88.5382442101836, 133.05644864588993, 75.89013805240391, 103.00750897079706, 119.4322717115283, 79.93189235217866, 127.46524012647568, 110.58188949897882, 113.12407694011924, 108.71036775410175, -282.70871988497674, 166.55837408825758, 106.90667642652987, 130.9302619695663, 114.63451047614215, -234.48652505129576, 166.1607483513653, 112.53934800624846, 134.8140159491448, 121.53096856176853, 113.75381665863097, 107.64890499040482], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 93, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [39.92191662887731, 40.23254100109139, 40.15924304599562, 41.48716933528581, 41.81942425171533, 41.767975887904555, 40.67937290978928, 40.3174106751879, 39.96589507659276, 44.92565357685089, 45.10816823318601, 44.68854745477438, 47.8082137107849, 47.825210161507115, 48.13002082705496, 39.72480486581722, 39.4832314501206, 39.53210666278997, 47.26725602149962, 47.08311518281697, 47.12605261802672, 36.01941756159067, 35.9348961263895, 36.11475645750761, 46.775391717751816, 46.587513742347554, 45.876630042990044, 50.31204654028018, 50.22594059010346, 49.929761831959084, 49.60311087702091, 48.74546120564143, 48.59079147378604, 28.629594823966414, 28.844662103025854, 28.69609140480557, 38.63829550395408, 39.230196504543215, 39.08397565657893, 47.20580579588811, 47.13055668274562, 47.18945896128814, 44.65182050069173, 45.4306001815324, 45.11710337301095, 45.96261206020911, 46.103755225737885, 46.28299466505025, 43.49239073693752, 43.176884949207306, 43.70494272559881, 44.54001827041307, 44.738160277406365, 44.297635088364274, 44.037245583410055, 43.85904802630344, 43.93421678493419, -123.139257589976, -105.5268137815098, -105.44666348087291, 39.54834533855319, 39.65923769399524, 39.421448074281216, 33.1395472548902, 32.94441980868578, 33.192673955112696, 39.17080525557199, 39.54569563517967, 39.041022698084504, 42.82685979704061, 43.14149572948614, 43.430840759227664, 45.34985914329687, 45.87114504973093, 46.15311016763249, 44.945745546370745, 44.58515374362469, 44.709405697882175, 55.5903464059035, 55.26689844826858, 55.43313390264909, 44.59852636605501, 44.67296187579632, 44.675060108304024, 33.751097465554864, 34.11265478904048, 33.35597879687944, 44.96781174838543, 44.66676068305969, 44.32526853680611, 45.91165178020795, 45.88201307257016, 45.56292422612508, 36.48026268184185, 35.88510911166668, 36.56129126623273, 27.324076715235904, 26.70661935706933, 27.249692269911364, 45.14874357109268, 44.71746133019526, 44.90013567109902, 34.0252107878526, 34.12317932893832, 33.60840221246083, 44.10742904742558, 43.148900528748825, 43.547953476508454, 30.57377981642881, 30.497785384456307, 30.88037866788605, 44.86177272970477, 44.59771660963693, 44.823143946627766, 26.209995936602354, 25.959388971328735, 25.963082149624825, 51.953840814530835, 52.13110953569411, 52.00589053332804, 48.9758359765013, 48.86188255002101, 48.81550499548514, 43.33477020201583, 43.325486229111746, 42.61222666998704, 34.76399494583407, 34.349934498469025, 34.62252982209125, 41.41166085998216, 42.426547079036624, 42.52193364935616, 41.52854636808236, 41.246471894284085, 41.09443773080905, 28.58454271281758, 28.30209833631912, 28.655938702325017, 48.82130034019549, 48.90164863069852, 49.03580952187379, 48.86650497745721, 48.369170308113084, 48.23363113403319, 42.50648695230484, 43.32084542326629, 43.07698763161898, 45.55552602310975, 45.4955799182256, 44.52627055843671, 39.59753504085043, 39.34542209903398, 39.58750629859665, 35.09266420919448, 35.01894306577742, 33.42562052607536, 38.7879088881115, 38.88708697507778, 38.89262005562583, 45.059374038130045, 45.21234262548387, 45.23741177096963, 44.22196829319, 45.09085373580456, 44.7425781339407, 36.196886764218405, 36.10648749147852, 36.23152408500512, 39.902309623857334, 40.31909626660247, 39.92421895017226, 49.5441653529803, 49.506925469885275, 49.301392878095314, 50.585787529746696, 50.45189526925485, 50.18614911536376, 35.163063565889985, 36.514508603761584, 35.43888674179712, 30.184687308967113, 30.347724433988333, 29.639949694275856, 46.64923969656229, 46.478160470724106, 46.73004336771555, 44.31555781016746, 44.17379781107107, 44.46499671290317, 45.01273884624243, 44.994434241205454, 45.23196716979146, 51.9688869168361, 52.60993925792475, 52.009285901983574, 36.26050452888012, 36.72144643217325, 36.87180399149656, 48.75368596985935, 48.70624143630265, 48.85940331034361, 47.79548057913779, 47.87285973876713, 47.76442605629562, 45.733269446839884, 45.62022704010208, 45.591372561951474, 44.481723489860684, 44.79034812624255, 44.84530586252609, 47.40731324007113, 47.4012867261966, 47.50979461645086, 35.215998992323875, 35.661337833851576, 35.393626905977726, 33.77927070359388, 34.1667517820994, 33.54812769095102, 44.92155412584543, 44.80714900791645, 44.27710568904877, 33.1511616812398, 32.90747597937782, 33.140140144464866, 51.380060166120515, 51.50359793566166, 51.26635868102311, 32.16781839852531, 32.37969322719921, 32.099528202166155, 45.275131473938615, 46.36361962668403, 45.3234426776568, 29.62230559190114, 29.594813508292034, 29.321125109990433, 44.63909646930793, 43.88514972726503, 44.53220244931677, 24.943212648232773, 25.533745815356568, 25.41317958881457, 34.56345988065004, 34.399751737713814, 34.044297352433205, 40.16272837668657, 39.406241685152054, 39.863301649689674, 26.67361358801523, 26.367595369617135, 26.8906833945463, 42.543158059318856, 42.632256078844264, 42.28982598831256, 36.88895215342441, 36.633733371893555, 37.05920397366086, 37.73404852549234, 37.7448146889607, 37.645213725666196, 36.13717131316662, 36.481280997395515, 36.09191544353962, -90.452999866878, -90.62463916217288, -101.63108085592589, 55.53757536100845, 55.553597201282784, 55.46720152596633, 35.01098306973775, 36.08390266199906, 35.81179069479306, 44.12823738654454, 43.64041881759961, 43.16160576542218, 38.10191709299882, 38.3144102965792, 38.21818308656414, -88.27613389492035, -72.57270219177008, -73.63768896460533, 55.42393612116574, 55.48906803503631, 55.247744195163236, 37.43987302606304, 37.53454820563395, 37.564926774551466, 45.23798442321518, 44.84430586795011, 44.73172565797964, 40.70479924976826, 40.376173585653305, 40.44999572634697, 37.573327749967575, 38.08076598402113, 38.099722924642265, 35.90057834858695, 35.78848147640625, 35.95984516541162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1418488468128417, "mean_inference_ms": 0.6956766160726896, "mean_action_processing_ms": 0.09588754292364192, "mean_env_wait_ms": 0.7922128039934173, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 670000, "timesteps_this_iter": 0, "agent_timesteps_total": 2010000, "timers": {"sample_time_ms": 10706.71, "sample_throughput": 466.997, "load_time_ms": 0.298, "load_throughput": 16794682.47, "learn_time_ms": 2109.548, "learn_throughput": 2370.176, "update_time_ms": 9.628}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.244463733058732e-34, "cur_lr": 0.0005000000000000001, "total_loss": 110.8788948059082, "policy_loss": -0.002603319437325302, "vf_loss": 110.97971420288086, "vf_explained_var": 0.0176658034324646, "kl": 0.00595006409570637, "entropy": 9.821460914611816, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 670000, "num_agent_steps_sampled": 2010000, "num_steps_trained": 670000, "num_agent_steps_trained": 2010000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2010, "training_iteration": 134, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-25-26", "timestamp": 1706232326, "time_this_iter_s": 10.632027864456177, "time_total_s": 1441.0260832309723, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402DF0160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1441.0260832309723, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 6.2, "ram_util_percent": 61.48666666666667}}
{"episode_reward_max": 166.55837408825758, "episode_reward_min": -334.1127348523587, "episode_reward_mean": 110.46081545844005, "episode_len_mean": 489.11, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -123.139257589976}, "policy_reward_max": {"shared_policy": 55.5903464059035}, "policy_reward_mean": {"shared_policy": 36.82027181948001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.9393635564484, 86.17034833179784, 116.95246766507623, 141.5258214399219, 135.19952405523497, 138.3493619509971, 130.37421841174356, 133.57581363618374, 131.83051039464775, -334.1127348523587, 118.62903110682964, 99.27664101868868, 117.75752358883616, 129.39919628575433, 137.37411436066014, 134.24030498787735, 166.29037875682104, 133.9465483501554, 101.21973105147478, 133.95984096825134, 137.35658907890308, 108.92666305974126, 81.2803883422166, 134.76634057238687, 101.75679232925175, 130.80428305268293, 91.95194386877117, 134.28263328596944, 78.13246705755591, 156.09084088355303, 146.6532235220077, 129.27248310111457, 103.73645926639435, 126.36014158837494, 123.86945599317549, 85.54257975146172, 146.75875849276795, 145.46930641960367, 128.9043200071901, 135.57737649977213, 118.53046343848106, 103.53722780104727, 116.56761591881511, 135.50912843458352, 134.05540016293506, 108.53489834070204, 120.14562484063207, 148.35248370096076, 151.22383191436538, 107.11645891144869, 90.1723614372313, 139.85744353500206, 132.95435233414176, 135.23914025723934, 156.58811207674438, 109.85375495254993, 146.31933071650562, 143.43276637420058, 136.9448690488935, 134.11737747862927, 142.3183945827189, 106.27096373215318, 101.4941501766443, 134.0058088228107, 99.19877780508249, 154.15001678280535, 96.64703982789068, 136.96219377827936, 88.5382442101836, 133.05644864588993, 75.89013805240391, 103.00750897079706, 119.4322717115283, 79.93189235217866, 127.46524012647568, 110.58188949897882, 113.12407694011924, 108.71036775410175, -282.70871988497674, 166.55837408825758, 106.90667642652987, 130.9302619695663, 114.63451047614215, -234.48652505129576, 166.1607483513653, 112.53934800624846, 134.8140159491448, 121.53096856176853, 113.75381665863097, 107.64890499040482, 106.72567705344409, 110.96877437829971, 107.03476688731462, 76.39730695076287, 120.10110156424342, 155.27600269485248, 104.80076988041398, 129.2837157510221, 132.8412256091832, 118.14070784859358], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 66, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 93, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [49.60311087702091, 48.74546120564143, 48.59079147378604, 28.629594823966414, 28.844662103025854, 28.69609140480557, 38.63829550395408, 39.230196504543215, 39.08397565657893, 47.20580579588811, 47.13055668274562, 47.18945896128814, 44.65182050069173, 45.4306001815324, 45.11710337301095, 45.96261206020911, 46.103755225737885, 46.28299466505025, 43.49239073693752, 43.176884949207306, 43.70494272559881, 44.54001827041307, 44.738160277406365, 44.297635088364274, 44.037245583410055, 43.85904802630344, 43.93421678493419, -123.139257589976, -105.5268137815098, -105.44666348087291, 39.54834533855319, 39.65923769399524, 39.421448074281216, 33.1395472548902, 32.94441980868578, 33.192673955112696, 39.17080525557199, 39.54569563517967, 39.041022698084504, 42.82685979704061, 43.14149572948614, 43.430840759227664, 45.34985914329687, 45.87114504973093, 46.15311016763249, 44.945745546370745, 44.58515374362469, 44.709405697882175, 55.5903464059035, 55.26689844826858, 55.43313390264909, 44.59852636605501, 44.67296187579632, 44.675060108304024, 33.751097465554864, 34.11265478904048, 33.35597879687944, 44.96781174838543, 44.66676068305969, 44.32526853680611, 45.91165178020795, 45.88201307257016, 45.56292422612508, 36.48026268184185, 35.88510911166668, 36.56129126623273, 27.324076715235904, 26.70661935706933, 27.249692269911364, 45.14874357109268, 44.71746133019526, 44.90013567109902, 34.0252107878526, 34.12317932893832, 33.60840221246083, 44.10742904742558, 43.148900528748825, 43.547953476508454, 30.57377981642881, 30.497785384456307, 30.88037866788605, 44.86177272970477, 44.59771660963693, 44.823143946627766, 26.209995936602354, 25.959388971328735, 25.963082149624825, 51.953840814530835, 52.13110953569411, 52.00589053332804, 48.9758359765013, 48.86188255002101, 48.81550499548514, 43.33477020201583, 43.325486229111746, 42.61222666998704, 34.76399494583407, 34.349934498469025, 34.62252982209125, 41.41166085998216, 42.426547079036624, 42.52193364935616, 41.52854636808236, 41.246471894284085, 41.09443773080905, 28.58454271281758, 28.30209833631912, 28.655938702325017, 48.82130034019549, 48.90164863069852, 49.03580952187379, 48.86650497745721, 48.369170308113084, 48.23363113403319, 42.50648695230484, 43.32084542326629, 43.07698763161898, 45.55552602310975, 45.4955799182256, 44.52627055843671, 39.59753504085043, 39.34542209903398, 39.58750629859665, 35.09266420919448, 35.01894306577742, 33.42562052607536, 38.7879088881115, 38.88708697507778, 38.89262005562583, 45.059374038130045, 45.21234262548387, 45.23741177096963, 44.22196829319, 45.09085373580456, 44.7425781339407, 36.196886764218405, 36.10648749147852, 36.23152408500512, 39.902309623857334, 40.31909626660247, 39.92421895017226, 49.5441653529803, 49.506925469885275, 49.301392878095314, 50.585787529746696, 50.45189526925485, 50.18614911536376, 35.163063565889985, 36.514508603761584, 35.43888674179712, 30.184687308967113, 30.347724433988333, 29.639949694275856, 46.64923969656229, 46.478160470724106, 46.73004336771555, 44.31555781016746, 44.17379781107107, 44.46499671290317, 45.01273884624243, 44.994434241205454, 45.23196716979146, 51.9688869168361, 52.60993925792475, 52.009285901983574, 36.26050452888012, 36.72144643217325, 36.87180399149656, 48.75368596985935, 48.70624143630265, 48.85940331034361, 47.79548057913779, 47.87285973876713, 47.76442605629562, 45.733269446839884, 45.62022704010208, 45.591372561951474, 44.481723489860684, 44.79034812624255, 44.84530586252609, 47.40731324007113, 47.4012867261966, 47.50979461645086, 35.215998992323875, 35.661337833851576, 35.393626905977726, 33.77927070359388, 34.1667517820994, 33.54812769095102, 44.92155412584543, 44.80714900791645, 44.27710568904877, 33.1511616812398, 32.90747597937782, 33.140140144464866, 51.380060166120515, 51.50359793566166, 51.26635868102311, 32.16781839852531, 32.37969322719921, 32.099528202166155, 45.275131473938615, 46.36361962668403, 45.3234426776568, 29.62230559190114, 29.594813508292034, 29.321125109990433, 44.63909646930793, 43.88514972726503, 44.53220244931677, 24.943212648232773, 25.533745815356568, 25.41317958881457, 34.56345988065004, 34.399751737713814, 34.044297352433205, 40.16272837668657, 39.406241685152054, 39.863301649689674, 26.67361358801523, 26.367595369617135, 26.8906833945463, 42.543158059318856, 42.632256078844264, 42.28982598831256, 36.88895215342441, 36.633733371893555, 37.05920397366086, 37.73404852549234, 37.7448146889607, 37.645213725666196, 36.13717131316662, 36.481280997395515, 36.09191544353962, -90.452999866878, -90.62463916217288, -101.63108085592589, 55.53757536100845, 55.553597201282784, 55.46720152596633, 35.01098306973775, 36.08390266199906, 35.81179069479306, 44.12823738654454, 43.64041881759961, 43.16160576542218, 38.10191709299882, 38.3144102965792, 38.21818308656414, -88.27613389492035, -72.57270219177008, -73.63768896460533, 55.42393612116574, 55.48906803503631, 55.247744195163236, 37.43987302606304, 37.53454820563395, 37.564926774551466, 45.23798442321518, 44.84430586795011, 44.73172565797964, 40.70479924976826, 40.376173585653305, 40.44999572634697, 37.573327749967575, 38.08076598402113, 38.099722924642265, 35.90057834858695, 35.78848147640625, 35.95984516541162, 35.444799683988094, 35.426423609256744, 35.85445376019925, 37.19739392027259, 36.43748441338539, 37.33389604464173, 36.0526805864647, 35.62658604979515, 35.355500251054764, 25.510033609345555, 25.602442033588886, 25.284831307828426, 40.36516293821235, 39.976343912382916, 39.759594713648156, 51.98152809310703, 51.80447487533091, 51.489999726414666, 35.17832912753025, 35.08547850201526, 34.53696225086847, 43.218054722994566, 43.05760060250759, 43.00806042551994, 44.43379200001557, 44.6394309302171, 43.76800267895062, 39.20436496039231, 39.51781288844843, 39.418529999752835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14182311646804716, "mean_inference_ms": 0.6956952668306708, "mean_action_processing_ms": 0.09590309794285617, "mean_env_wait_ms": 0.7920637842386465, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 675000, "timesteps_this_iter": 0, "agent_timesteps_total": 2025000, "timers": {"sample_time_ms": 10709.633, "sample_throughput": 466.869, "load_time_ms": 0.198, "load_throughput": 25269936.137, "learn_time_ms": 2092.131, "learn_throughput": 2389.908, "update_time_ms": 9.545}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.244463733058732e-34, "cur_lr": 0.0005000000000000001, "total_loss": 6.536473751068115, "policy_loss": -0.0004692706576797434, "vf_loss": 6.634567356109619, "vf_explained_var": -0.008211159706115722, "kl": 0.004273769725151941, "entropy": 9.76241226196289, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 675000, "num_agent_steps_sampled": 2025000, "num_steps_trained": 675000, "num_agent_steps_trained": 2025000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2020, "training_iteration": 135, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-25-36", "timestamp": 1706232336, "time_this_iter_s": 10.26483154296875, "time_total_s": 1451.290914773941, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021400813E50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1451.290914773941, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 5.314285714285715, "ram_util_percent": 61.478571428571435}}
{"episode_reward_max": 181.17499745241375, "episode_reward_min": -303.1994125302881, "episode_reward_mean": 107.16481514557759, "episode_len_mean": 486.79, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -109.16718113422394}, "policy_reward_max": {"shared_policy": 60.62688618130049}, "policy_reward_mean": {"shared_policy": 35.72160504852586}, "custom_metrics": {}, "hist_stats": {"episode_reward": [117.75752358883616, 129.39919628575433, 137.37411436066014, 134.24030498787735, 166.29037875682104, 133.9465483501554, 101.21973105147478, 133.95984096825134, 137.35658907890308, 108.92666305974126, 81.2803883422166, 134.76634057238687, 101.75679232925175, 130.80428305268293, 91.95194386877117, 134.28263328596944, 78.13246705755591, 156.09084088355303, 146.6532235220077, 129.27248310111457, 103.73645926639435, 126.36014158837494, 123.86945599317549, 85.54257975146172, 146.75875849276795, 145.46930641960367, 128.9043200071901, 135.57737649977213, 118.53046343848106, 103.53722780104727, 116.56761591881511, 135.50912843458352, 134.05540016293506, 108.53489834070204, 120.14562484063207, 148.35248370096076, 151.22383191436538, 107.11645891144869, 90.1723614372313, 139.85744353500206, 132.95435233414176, 135.23914025723934, 156.58811207674438, 109.85375495254993, 146.31933071650562, 143.43276637420058, 136.9448690488935, 134.11737747862927, 142.3183945827189, 106.27096373215318, 101.4941501766443, 134.0058088228107, 99.19877780508249, 154.15001678280535, 96.64703982789068, 136.96219377827936, 88.5382442101836, 133.05644864588993, 75.89013805240391, 103.00750897079706, 119.4322717115283, 79.93189235217866, 127.46524012647568, 110.58188949897882, 113.12407694011924, 108.71036775410175, -282.70871988497674, 166.55837408825758, 106.90667642652987, 130.9302619695663, 114.63451047614215, -234.48652505129576, 166.1607483513653, 112.53934800624846, 134.8140159491448, 121.53096856176853, 113.75381665863097, 107.64890499040482, 106.72567705344409, 110.96877437829971, 107.03476688731462, 76.39730695076287, 120.10110156424342, 155.27600269485248, 104.80076988041398, 129.2837157510221, 132.8412256091832, 118.14070784859358, 111.39417836070058, 161.1890098527073, 181.17499745241375, -303.1994125302881, 83.52716783585493, 141.98441110027483, 102.50034510041587, 149.82120734266908, 112.97435819962992, 80.40515379048884, -239.5863424800337, 132.92526140413253], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 93, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 53, 500, 500, 500, 500, 500, 500, 281, 500], "policy_shared_policy_reward": [39.17080525557199, 39.54569563517967, 39.041022698084504, 42.82685979704061, 43.14149572948614, 43.430840759227664, 45.34985914329687, 45.87114504973093, 46.15311016763249, 44.945745546370745, 44.58515374362469, 44.709405697882175, 55.5903464059035, 55.26689844826858, 55.43313390264909, 44.59852636605501, 44.67296187579632, 44.675060108304024, 33.751097465554864, 34.11265478904048, 33.35597879687944, 44.96781174838543, 44.66676068305969, 44.32526853680611, 45.91165178020795, 45.88201307257016, 45.56292422612508, 36.48026268184185, 35.88510911166668, 36.56129126623273, 27.324076715235904, 26.70661935706933, 27.249692269911364, 45.14874357109268, 44.71746133019526, 44.90013567109902, 34.0252107878526, 34.12317932893832, 33.60840221246083, 44.10742904742558, 43.148900528748825, 43.547953476508454, 30.57377981642881, 30.497785384456307, 30.88037866788605, 44.86177272970477, 44.59771660963693, 44.823143946627766, 26.209995936602354, 25.959388971328735, 25.963082149624825, 51.953840814530835, 52.13110953569411, 52.00589053332804, 48.9758359765013, 48.86188255002101, 48.81550499548514, 43.33477020201583, 43.325486229111746, 42.61222666998704, 34.76399494583407, 34.349934498469025, 34.62252982209125, 41.41166085998216, 42.426547079036624, 42.52193364935616, 41.52854636808236, 41.246471894284085, 41.09443773080905, 28.58454271281758, 28.30209833631912, 28.655938702325017, 48.82130034019549, 48.90164863069852, 49.03580952187379, 48.86650497745721, 48.369170308113084, 48.23363113403319, 42.50648695230484, 43.32084542326629, 43.07698763161898, 45.55552602310975, 45.4955799182256, 44.52627055843671, 39.59753504085043, 39.34542209903398, 39.58750629859665, 35.09266420919448, 35.01894306577742, 33.42562052607536, 38.7879088881115, 38.88708697507778, 38.89262005562583, 45.059374038130045, 45.21234262548387, 45.23741177096963, 44.22196829319, 45.09085373580456, 44.7425781339407, 36.196886764218405, 36.10648749147852, 36.23152408500512, 39.902309623857334, 40.31909626660247, 39.92421895017226, 49.5441653529803, 49.506925469885275, 49.301392878095314, 50.585787529746696, 50.45189526925485, 50.18614911536376, 35.163063565889985, 36.514508603761584, 35.43888674179712, 30.184687308967113, 30.347724433988333, 29.639949694275856, 46.64923969656229, 46.478160470724106, 46.73004336771555, 44.31555781016746, 44.17379781107107, 44.46499671290317, 45.01273884624243, 44.994434241205454, 45.23196716979146, 51.9688869168361, 52.60993925792475, 52.009285901983574, 36.26050452888012, 36.72144643217325, 36.87180399149656, 48.75368596985935, 48.70624143630265, 48.85940331034361, 47.79548057913779, 47.87285973876713, 47.76442605629562, 45.733269446839884, 45.62022704010208, 45.591372561951474, 44.481723489860684, 44.79034812624255, 44.84530586252609, 47.40731324007113, 47.4012867261966, 47.50979461645086, 35.215998992323875, 35.661337833851576, 35.393626905977726, 33.77927070359388, 34.1667517820994, 33.54812769095102, 44.92155412584543, 44.80714900791645, 44.27710568904877, 33.1511616812398, 32.90747597937782, 33.140140144464866, 51.380060166120515, 51.50359793566166, 51.26635868102311, 32.16781839852531, 32.37969322719921, 32.099528202166155, 45.275131473938615, 46.36361962668403, 45.3234426776568, 29.62230559190114, 29.594813508292034, 29.321125109990433, 44.63909646930793, 43.88514972726503, 44.53220244931677, 24.943212648232773, 25.533745815356568, 25.41317958881457, 34.56345988065004, 34.399751737713814, 34.044297352433205, 40.16272837668657, 39.406241685152054, 39.863301649689674, 26.67361358801523, 26.367595369617135, 26.8906833945463, 42.543158059318856, 42.632256078844264, 42.28982598831256, 36.88895215342441, 36.633733371893555, 37.05920397366086, 37.73404852549234, 37.7448146889607, 37.645213725666196, 36.13717131316662, 36.481280997395515, 36.09191544353962, -90.452999866878, -90.62463916217288, -101.63108085592589, 55.53757536100845, 55.553597201282784, 55.46720152596633, 35.01098306973775, 36.08390266199906, 35.81179069479306, 44.12823738654454, 43.64041881759961, 43.16160576542218, 38.10191709299882, 38.3144102965792, 38.21818308656414, -88.27613389492035, -72.57270219177008, -73.63768896460533, 55.42393612116574, 55.48906803503631, 55.247744195163236, 37.43987302606304, 37.53454820563395, 37.564926774551466, 45.23798442321518, 44.84430586795011, 44.73172565797964, 40.70479924976826, 40.376173585653305, 40.44999572634697, 37.573327749967575, 38.08076598402113, 38.099722924642265, 35.90057834858695, 35.78848147640625, 35.95984516541162, 35.444799683988094, 35.426423609256744, 35.85445376019925, 37.19739392027259, 36.43748441338539, 37.33389604464173, 36.0526805864647, 35.62658604979515, 35.355500251054764, 25.510033609345555, 25.602442033588886, 25.284831307828426, 40.36516293821235, 39.976343912382916, 39.759594713648156, 51.98152809310703, 51.80447487533091, 51.489999726414666, 35.17832912753025, 35.08547850201526, 34.53696225086847, 43.218054722994566, 43.05760060250759, 43.00806042551994, 44.43379200001557, 44.6394309302171, 43.76800267895062, 39.20436496039231, 39.51781288844843, 39.418529999752835, 37.21162050838271, 37.06285679588714, 37.11970105643073, 53.911289239923164, 53.79948236296575, 53.47823824981849, 60.1735087558627, 60.37460251525043, 60.62688618130049, -97.07115820795298, -96.96107318811119, -109.16718113422394, 28.44436051847879, 27.042333632707596, 28.04047368466854, 47.027305439114556, 47.48796140484045, 47.46914425631984, 33.75309191644192, 34.118182212114334, 34.62907097185962, 49.647291357318565, 50.16044664072494, 50.013469344625875, 37.938123836958155, 37.7392415938278, 37.296992768843964, 26.896764524281025, 27.19278414733708, 26.315605118870735, -76.38109737386307, -76.1298431394001, -87.0754019667705, 44.05523631473382, 44.34816542764504, 44.521859661753595]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1418205492978892, "mean_inference_ms": 0.695589452968424, "mean_action_processing_ms": 0.09590785259966397, "mean_env_wait_ms": 0.7917888759242344, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 680000, "timesteps_this_iter": 0, "agent_timesteps_total": 2040000, "timers": {"sample_time_ms": 10641.901, "sample_throughput": 469.841, "load_time_ms": 0.198, "load_throughput": 25269936.137, "learn_time_ms": 2070.895, "learn_throughput": 2414.415, "update_time_ms": 9.492}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.622231866529366e-34, "cur_lr": 0.0005000000000000001, "total_loss": 200.98111572265626, "policy_loss": -0.0015106469449216674, "vf_loss": 201.079931640625, "vf_explained_var": 0.004790741205215454, "kl": 0.005860821902790456, "entropy": 9.730699348449708, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 680000, "num_agent_steps_sampled": 2040000, "num_steps_trained": 680000, "num_agent_steps_trained": 2040000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2032, "training_iteration": 136, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-25-47", "timestamp": 1706232347, "time_this_iter_s": 10.264079093933105, "time_total_s": 1461.5549938678741, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140234DE50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1461.5549938678741, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 5.813333333333334, "ram_util_percent": 61.48}}
{"episode_reward_max": 181.17499745241375, "episode_reward_min": -303.1994125302881, "episode_reward_mean": 102.2563653698776, "episode_len_mean": 482.7, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -109.16718113422394}, "policy_reward_max": {"shared_policy": 60.62688618130049}, "policy_reward_mean": {"shared_policy": 34.085455123292526}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.76634057238687, 101.75679232925175, 130.80428305268293, 91.95194386877117, 134.28263328596944, 78.13246705755591, 156.09084088355303, 146.6532235220077, 129.27248310111457, 103.73645926639435, 126.36014158837494, 123.86945599317549, 85.54257975146172, 146.75875849276795, 145.46930641960367, 128.9043200071901, 135.57737649977213, 118.53046343848106, 103.53722780104727, 116.56761591881511, 135.50912843458352, 134.05540016293506, 108.53489834070204, 120.14562484063207, 148.35248370096076, 151.22383191436538, 107.11645891144869, 90.1723614372313, 139.85744353500206, 132.95435233414176, 135.23914025723934, 156.58811207674438, 109.85375495254993, 146.31933071650562, 143.43276637420058, 136.9448690488935, 134.11737747862927, 142.3183945827189, 106.27096373215318, 101.4941501766443, 134.0058088228107, 99.19877780508249, 154.15001678280535, 96.64703982789068, 136.96219377827936, 88.5382442101836, 133.05644864588993, 75.89013805240391, 103.00750897079706, 119.4322717115283, 79.93189235217866, 127.46524012647568, 110.58188949897882, 113.12407694011924, 108.71036775410175, -282.70871988497674, 166.55837408825758, 106.90667642652987, 130.9302619695663, 114.63451047614215, -234.48652505129576, 166.1607483513653, 112.53934800624846, 134.8140159491448, 121.53096856176853, 113.75381665863097, 107.64890499040482, 106.72567705344409, 110.96877437829971, 107.03476688731462, 76.39730695076287, 120.10110156424342, 155.27600269485248, 104.80076988041398, 129.2837157510221, 132.8412256091832, 118.14070784859358, 111.39417836070058, 161.1890098527073, 181.17499745241375, -303.1994125302881, 83.52716783585493, 141.98441110027483, 102.50034510041587, 149.82120734266908, 112.97435819962992, 80.40515379048884, -239.5863424800337, 132.92526140413253, 89.53199425898491, 139.85591719090007, 122.4228584244847, -296.1362987756729, 74.19125166721642, 137.99588149040943, 111.04732467327267, 136.0462535470723, 128.31319213286042, 126.16882505267856, 121.46910159848629], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 93, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 53, 500, 500, 500, 500, 500, 500, 281, 500, 500, 500, 500, 91, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [45.14874357109268, 44.71746133019526, 44.90013567109902, 34.0252107878526, 34.12317932893832, 33.60840221246083, 44.10742904742558, 43.148900528748825, 43.547953476508454, 30.57377981642881, 30.497785384456307, 30.88037866788605, 44.86177272970477, 44.59771660963693, 44.823143946627766, 26.209995936602354, 25.959388971328735, 25.963082149624825, 51.953840814530835, 52.13110953569411, 52.00589053332804, 48.9758359765013, 48.86188255002101, 48.81550499548514, 43.33477020201583, 43.325486229111746, 42.61222666998704, 34.76399494583407, 34.349934498469025, 34.62252982209125, 41.41166085998216, 42.426547079036624, 42.52193364935616, 41.52854636808236, 41.246471894284085, 41.09443773080905, 28.58454271281758, 28.30209833631912, 28.655938702325017, 48.82130034019549, 48.90164863069852, 49.03580952187379, 48.86650497745721, 48.369170308113084, 48.23363113403319, 42.50648695230484, 43.32084542326629, 43.07698763161898, 45.55552602310975, 45.4955799182256, 44.52627055843671, 39.59753504085043, 39.34542209903398, 39.58750629859665, 35.09266420919448, 35.01894306577742, 33.42562052607536, 38.7879088881115, 38.88708697507778, 38.89262005562583, 45.059374038130045, 45.21234262548387, 45.23741177096963, 44.22196829319, 45.09085373580456, 44.7425781339407, 36.196886764218405, 36.10648749147852, 36.23152408500512, 39.902309623857334, 40.31909626660247, 39.92421895017226, 49.5441653529803, 49.506925469885275, 49.301392878095314, 50.585787529746696, 50.45189526925485, 50.18614911536376, 35.163063565889985, 36.514508603761584, 35.43888674179712, 30.184687308967113, 30.347724433988333, 29.639949694275856, 46.64923969656229, 46.478160470724106, 46.73004336771555, 44.31555781016746, 44.17379781107107, 44.46499671290317, 45.01273884624243, 44.994434241205454, 45.23196716979146, 51.9688869168361, 52.60993925792475, 52.009285901983574, 36.26050452888012, 36.72144643217325, 36.87180399149656, 48.75368596985935, 48.70624143630265, 48.85940331034361, 47.79548057913779, 47.87285973876713, 47.76442605629562, 45.733269446839884, 45.62022704010208, 45.591372561951474, 44.481723489860684, 44.79034812624255, 44.84530586252609, 47.40731324007113, 47.4012867261966, 47.50979461645086, 35.215998992323875, 35.661337833851576, 35.393626905977726, 33.77927070359388, 34.1667517820994, 33.54812769095102, 44.92155412584543, 44.80714900791645, 44.27710568904877, 33.1511616812398, 32.90747597937782, 33.140140144464866, 51.380060166120515, 51.50359793566166, 51.26635868102311, 32.16781839852531, 32.37969322719921, 32.099528202166155, 45.275131473938615, 46.36361962668403, 45.3234426776568, 29.62230559190114, 29.594813508292034, 29.321125109990433, 44.63909646930793, 43.88514972726503, 44.53220244931677, 24.943212648232773, 25.533745815356568, 25.41317958881457, 34.56345988065004, 34.399751737713814, 34.044297352433205, 40.16272837668657, 39.406241685152054, 39.863301649689674, 26.67361358801523, 26.367595369617135, 26.8906833945463, 42.543158059318856, 42.632256078844264, 42.28982598831256, 36.88895215342441, 36.633733371893555, 37.05920397366086, 37.73404852549234, 37.7448146889607, 37.645213725666196, 36.13717131316662, 36.481280997395515, 36.09191544353962, -90.452999866878, -90.62463916217288, -101.63108085592589, 55.53757536100845, 55.553597201282784, 55.46720152596633, 35.01098306973775, 36.08390266199906, 35.81179069479306, 44.12823738654454, 43.64041881759961, 43.16160576542218, 38.10191709299882, 38.3144102965792, 38.21818308656414, -88.27613389492035, -72.57270219177008, -73.63768896460533, 55.42393612116574, 55.48906803503631, 55.247744195163236, 37.43987302606304, 37.53454820563395, 37.564926774551466, 45.23798442321518, 44.84430586795011, 44.73172565797964, 40.70479924976826, 40.376173585653305, 40.44999572634697, 37.573327749967575, 38.08076598402113, 38.099722924642265, 35.90057834858695, 35.78848147640625, 35.95984516541162, 35.444799683988094, 35.426423609256744, 35.85445376019925, 37.19739392027259, 36.43748441338539, 37.33389604464173, 36.0526805864647, 35.62658604979515, 35.355500251054764, 25.510033609345555, 25.602442033588886, 25.284831307828426, 40.36516293821235, 39.976343912382916, 39.759594713648156, 51.98152809310703, 51.80447487533091, 51.489999726414666, 35.17832912753025, 35.08547850201526, 34.53696225086847, 43.218054722994566, 43.05760060250759, 43.00806042551994, 44.43379200001557, 44.6394309302171, 43.76800267895062, 39.20436496039231, 39.51781288844843, 39.418529999752835, 37.21162050838271, 37.06285679588714, 37.11970105643073, 53.911289239923164, 53.79948236296575, 53.47823824981849, 60.1735087558627, 60.37460251525043, 60.62688618130049, -97.07115820795298, -96.96107318811119, -109.16718113422394, 28.44436051847879, 27.042333632707596, 28.04047368466854, 47.027305439114556, 47.48796140484045, 47.46914425631984, 33.75309191644192, 34.118182212114334, 34.62907097185962, 49.647291357318565, 50.16044664072494, 50.013469344625875, 37.938123836958155, 37.7392415938278, 37.296992768843964, 26.896764524281025, 27.19278414733708, 26.315605118870735, -76.38109737386307, -76.1298431394001, -87.0754019667705, 44.05523631473382, 44.34816542764504, 44.521859661753595, 30.074816744153694, 29.95257418354352, 29.504603331287697, 46.43214262028535, 46.52701026697953, 46.89676430363518, 40.86498276765147, 40.71704927335182, 40.840826383481414, -108.37670902411143, -93.81685181210439, -93.9427379394571, 24.830312337726355, 24.441387690603733, 24.919551638886333, 46.08130123962958, 45.93867112447818, 45.9759091263016, 37.126725227572024, 36.73610005527735, 37.1844993904233, 45.215592121084526, 45.3799885114034, 45.45067291458447, 42.910995211452246, 42.694633796811104, 42.70756312459707, 41.82405761877695, 42.16700460265079, 42.17776283125082, 40.36350903411706, 40.5382960413893, 40.56729652297993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14178680743807823, "mean_inference_ms": 0.6954657125466455, "mean_action_processing_ms": 0.09589263060085862, "mean_env_wait_ms": 0.7915570755377521, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 685000, "timesteps_this_iter": 0, "agent_timesteps_total": 2055000, "timers": {"sample_time_ms": 10585.557, "sample_throughput": 472.342, "load_time_ms": 0.198, "load_throughput": 25269936.137, "learn_time_ms": 2049.174, "learn_throughput": 2440.007, "update_time_ms": 9.292}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.622231866529366e-34, "cur_lr": 0.0005000000000000001, "total_loss": 105.38296813964844, "policy_loss": -0.001974396029650194, "vf_loss": 105.48274002075195, "vf_explained_var": 0.0015710353851318359, "kl": 0.006697236187794053, "entropy": 9.779951858520509, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 685000, "num_agent_steps_sampled": 2055000, "num_steps_trained": 685000, "num_agent_steps_trained": 2055000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2043, "training_iteration": 137, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-25-57", "timestamp": 1706232357, "time_this_iter_s": 10.632747411727905, "time_total_s": 1472.187741279602, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021404255CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1472.187741279602, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 6.420000000000001, "ram_util_percent": 61.513333333333335}}
{"episode_reward_max": 181.17499745241375, "episode_reward_min": -303.1994125302881, "episode_reward_mean": 97.68810742847418, "episode_len_mean": 482.31, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -109.16718113422394}, "policy_reward_max": {"shared_policy": 60.62688618130049}, "policy_reward_mean": {"shared_policy": 32.56270247615806}, "custom_metrics": {}, "hist_stats": {"episode_reward": [126.36014158837494, 123.86945599317549, 85.54257975146172, 146.75875849276795, 145.46930641960367, 128.9043200071901, 135.57737649977213, 118.53046343848106, 103.53722780104727, 116.56761591881511, 135.50912843458352, 134.05540016293506, 108.53489834070204, 120.14562484063207, 148.35248370096076, 151.22383191436538, 107.11645891144869, 90.1723614372313, 139.85744353500206, 132.95435233414176, 135.23914025723934, 156.58811207674438, 109.85375495254993, 146.31933071650562, 143.43276637420058, 136.9448690488935, 134.11737747862927, 142.3183945827189, 106.27096373215318, 101.4941501766443, 134.0058088228107, 99.19877780508249, 154.15001678280535, 96.64703982789068, 136.96219377827936, 88.5382442101836, 133.05644864588993, 75.89013805240391, 103.00750897079706, 119.4322717115283, 79.93189235217866, 127.46524012647568, 110.58188949897882, 113.12407694011924, 108.71036775410175, -282.70871988497674, 166.55837408825758, 106.90667642652987, 130.9302619695663, 114.63451047614215, -234.48652505129576, 166.1607483513653, 112.53934800624846, 134.8140159491448, 121.53096856176853, 113.75381665863097, 107.64890499040482, 106.72567705344409, 110.96877437829971, 107.03476688731462, 76.39730695076287, 120.10110156424342, 155.27600269485248, 104.80076988041398, 129.2837157510221, 132.8412256091832, 118.14070784859358, 111.39417836070058, 161.1890098527073, 181.17499745241375, -303.1994125302881, 83.52716783585493, 141.98441110027483, 102.50034510041587, 149.82120734266908, 112.97435819962992, 80.40515379048884, -239.5863424800337, 132.92526140413253, 89.53199425898491, 139.85591719090007, 122.4228584244847, -296.1362987756729, 74.19125166721642, 137.99588149040943, 111.04732467327267, 136.0462535470723, 128.31319213286042, 126.16882505267856, 121.46910159848629, 156.57340302690855, 39.5711806663312, 131.97337436676003, 114.13621800858525, 100.11342062056063, 113.90759727358818, 108.31833931058645, 104.14087188243866, -223.8802601546049, 105.7675277981907], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 93, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 53, 500, 500, 500, 500, 500, 500, 281, 500, 500, 500, 500, 91, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 461, 500], "policy_shared_policy_reward": [41.41166085998216, 42.426547079036624, 42.52193364935616, 41.52854636808236, 41.246471894284085, 41.09443773080905, 28.58454271281758, 28.30209833631912, 28.655938702325017, 48.82130034019549, 48.90164863069852, 49.03580952187379, 48.86650497745721, 48.369170308113084, 48.23363113403319, 42.50648695230484, 43.32084542326629, 43.07698763161898, 45.55552602310975, 45.4955799182256, 44.52627055843671, 39.59753504085043, 39.34542209903398, 39.58750629859665, 35.09266420919448, 35.01894306577742, 33.42562052607536, 38.7879088881115, 38.88708697507778, 38.89262005562583, 45.059374038130045, 45.21234262548387, 45.23741177096963, 44.22196829319, 45.09085373580456, 44.7425781339407, 36.196886764218405, 36.10648749147852, 36.23152408500512, 39.902309623857334, 40.31909626660247, 39.92421895017226, 49.5441653529803, 49.506925469885275, 49.301392878095314, 50.585787529746696, 50.45189526925485, 50.18614911536376, 35.163063565889985, 36.514508603761584, 35.43888674179712, 30.184687308967113, 30.347724433988333, 29.639949694275856, 46.64923969656229, 46.478160470724106, 46.73004336771555, 44.31555781016746, 44.17379781107107, 44.46499671290317, 45.01273884624243, 44.994434241205454, 45.23196716979146, 51.9688869168361, 52.60993925792475, 52.009285901983574, 36.26050452888012, 36.72144643217325, 36.87180399149656, 48.75368596985935, 48.70624143630265, 48.85940331034361, 47.79548057913779, 47.87285973876713, 47.76442605629562, 45.733269446839884, 45.62022704010208, 45.591372561951474, 44.481723489860684, 44.79034812624255, 44.84530586252609, 47.40731324007113, 47.4012867261966, 47.50979461645086, 35.215998992323875, 35.661337833851576, 35.393626905977726, 33.77927070359388, 34.1667517820994, 33.54812769095102, 44.92155412584543, 44.80714900791645, 44.27710568904877, 33.1511616812398, 32.90747597937782, 33.140140144464866, 51.380060166120515, 51.50359793566166, 51.26635868102311, 32.16781839852531, 32.37969322719921, 32.099528202166155, 45.275131473938615, 46.36361962668403, 45.3234426776568, 29.62230559190114, 29.594813508292034, 29.321125109990433, 44.63909646930793, 43.88514972726503, 44.53220244931677, 24.943212648232773, 25.533745815356568, 25.41317958881457, 34.56345988065004, 34.399751737713814, 34.044297352433205, 40.16272837668657, 39.406241685152054, 39.863301649689674, 26.67361358801523, 26.367595369617135, 26.8906833945463, 42.543158059318856, 42.632256078844264, 42.28982598831256, 36.88895215342441, 36.633733371893555, 37.05920397366086, 37.73404852549234, 37.7448146889607, 37.645213725666196, 36.13717131316662, 36.481280997395515, 36.09191544353962, -90.452999866878, -90.62463916217288, -101.63108085592589, 55.53757536100845, 55.553597201282784, 55.46720152596633, 35.01098306973775, 36.08390266199906, 35.81179069479306, 44.12823738654454, 43.64041881759961, 43.16160576542218, 38.10191709299882, 38.3144102965792, 38.21818308656414, -88.27613389492035, -72.57270219177008, -73.63768896460533, 55.42393612116574, 55.48906803503631, 55.247744195163236, 37.43987302606304, 37.53454820563395, 37.564926774551466, 45.23798442321518, 44.84430586795011, 44.73172565797964, 40.70479924976826, 40.376173585653305, 40.44999572634697, 37.573327749967575, 38.08076598402113, 38.099722924642265, 35.90057834858695, 35.78848147640625, 35.95984516541162, 35.444799683988094, 35.426423609256744, 35.85445376019925, 37.19739392027259, 36.43748441338539, 37.33389604464173, 36.0526805864647, 35.62658604979515, 35.355500251054764, 25.510033609345555, 25.602442033588886, 25.284831307828426, 40.36516293821235, 39.976343912382916, 39.759594713648156, 51.98152809310703, 51.80447487533091, 51.489999726414666, 35.17832912753025, 35.08547850201526, 34.53696225086847, 43.218054722994566, 43.05760060250759, 43.00806042551994, 44.43379200001557, 44.6394309302171, 43.76800267895062, 39.20436496039231, 39.51781288844843, 39.418529999752835, 37.21162050838271, 37.06285679588714, 37.11970105643073, 53.911289239923164, 53.79948236296575, 53.47823824981849, 60.1735087558627, 60.37460251525043, 60.62688618130049, -97.07115820795298, -96.96107318811119, -109.16718113422394, 28.44436051847879, 27.042333632707596, 28.04047368466854, 47.027305439114556, 47.48796140484045, 47.46914425631984, 33.75309191644192, 34.118182212114334, 34.62907097185962, 49.647291357318565, 50.16044664072494, 50.013469344625875, 37.938123836958155, 37.7392415938278, 37.296992768843964, 26.896764524281025, 27.19278414733708, 26.315605118870735, -76.38109737386307, -76.1298431394001, -87.0754019667705, 44.05523631473382, 44.34816542764504, 44.521859661753595, 30.074816744153694, 29.95257418354352, 29.504603331287697, 46.43214262028535, 46.52701026697953, 46.89676430363518, 40.86498276765147, 40.71704927335182, 40.840826383481414, -108.37670902411143, -93.81685181210439, -93.9427379394571, 24.830312337726355, 24.441387690603733, 24.919551638886333, 46.08130123962958, 45.93867112447818, 45.9759091263016, 37.126725227572024, 36.73610005527735, 37.1844993904233, 45.215592121084526, 45.3799885114034, 45.45067291458447, 42.910995211452246, 42.694633796811104, 42.70756312459707, 41.82405761877695, 42.16700460265079, 42.17776283125082, 40.36350903411706, 40.5382960413893, 40.56729652297993, 52.10965369393428, 51.985741933186844, 52.4780073997875, 13.456567572895437, 12.776961147785187, 13.337651945650578, 44.16740478078523, 43.92675646642843, 43.87921311954656, 38.4062093819181, 38.74375797777125, 36.98625064889589, 33.60262336333592, 33.37627826382716, 33.13451899339755, 38.02206200361252, 37.62497243285179, 38.26056283712387, 36.09808987751603, 36.02556270360947, 36.194686729460955, 34.770189836621284, 34.745650455355644, 34.62503159046173, -74.6025822609663, -74.66120622307062, -74.61647167056799, 35.22059553240736, 35.34598426831265, 35.20094799747069]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14176670066237423, "mean_inference_ms": 0.695454922851037, "mean_action_processing_ms": 0.09589842289959156, "mean_env_wait_ms": 0.7913760031145375, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 690000, "timesteps_this_iter": 0, "agent_timesteps_total": 2070000, "timers": {"sample_time_ms": 10582.881, "sample_throughput": 472.461, "load_time_ms": 0.198, "load_throughput": 25269936.137, "learn_time_ms": 2036.297, "learn_throughput": 2455.438, "update_time_ms": 9.316}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.622231866529366e-34, "cur_lr": 0.0005000000000000001, "total_loss": 114.61477355957031, "policy_loss": -0.0012826202578594347, "vf_loss": 114.71222305297852, "vf_explained_var": 0.008701914548873901, "kl": 0.003423226875055726, "entropy": 9.61674108505249, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 690000, "num_agent_steps_sampled": 2070000, "num_steps_trained": 690000, "num_agent_steps_trained": 2070000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2053, "training_iteration": 138, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-26-08", "timestamp": 1706232368, "time_this_iter_s": 10.734816789627075, "time_total_s": 1482.9225580692291, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402E085E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1482.9225580692291, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 7.220000000000001, "ram_util_percent": 61.660000000000004}}
{"episode_reward_max": 181.17499745241375, "episode_reward_min": -303.1994125302881, "episode_reward_mean": 96.75302439201415, "episode_len_mean": 482.31, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -109.16718113422394}, "policy_reward_max": {"shared_policy": 60.62688618130049}, "policy_reward_mean": {"shared_policy": 32.251008130671394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.50912843458352, 134.05540016293506, 108.53489834070204, 120.14562484063207, 148.35248370096076, 151.22383191436538, 107.11645891144869, 90.1723614372313, 139.85744353500206, 132.95435233414176, 135.23914025723934, 156.58811207674438, 109.85375495254993, 146.31933071650562, 143.43276637420058, 136.9448690488935, 134.11737747862927, 142.3183945827189, 106.27096373215318, 101.4941501766443, 134.0058088228107, 99.19877780508249, 154.15001678280535, 96.64703982789068, 136.96219377827936, 88.5382442101836, 133.05644864588993, 75.89013805240391, 103.00750897079706, 119.4322717115283, 79.93189235217866, 127.46524012647568, 110.58188949897882, 113.12407694011924, 108.71036775410175, -282.70871988497674, 166.55837408825758, 106.90667642652987, 130.9302619695663, 114.63451047614215, -234.48652505129576, 166.1607483513653, 112.53934800624846, 134.8140159491448, 121.53096856176853, 113.75381665863097, 107.64890499040482, 106.72567705344409, 110.96877437829971, 107.03476688731462, 76.39730695076287, 120.10110156424342, 155.27600269485248, 104.80076988041398, 129.2837157510221, 132.8412256091832, 118.14070784859358, 111.39417836070058, 161.1890098527073, 181.17499745241375, -303.1994125302881, 83.52716783585493, 141.98441110027483, 102.50034510041587, 149.82120734266908, 112.97435819962992, 80.40515379048884, -239.5863424800337, 132.92526140413253, 89.53199425898491, 139.85591719090007, 122.4228584244847, -296.1362987756729, 74.19125166721642, 137.99588149040943, 111.04732467327267, 136.0462535470723, 128.31319213286042, 126.16882505267856, 121.46910159848629, 156.57340302690855, 39.5711806663312, 131.97337436676003, 114.13621800858525, 100.11342062056063, 113.90759727358818, 108.31833931058645, 104.14087188243866, -223.8802601546049, 105.7675277981907, 111.07169938459992, 119.08682406321167, 95.57382511347531, 125.91711830347776, 118.84283803403375, 136.90850454568823, 109.27299441397189, 89.73259615898132, 107.22453337162732, 123.97800887562332], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 93, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 53, 500, 500, 500, 500, 500, 500, 281, 500, 500, 500, 500, 91, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 461, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [45.059374038130045, 45.21234262548387, 45.23741177096963, 44.22196829319, 45.09085373580456, 44.7425781339407, 36.196886764218405, 36.10648749147852, 36.23152408500512, 39.902309623857334, 40.31909626660247, 39.92421895017226, 49.5441653529803, 49.506925469885275, 49.301392878095314, 50.585787529746696, 50.45189526925485, 50.18614911536376, 35.163063565889985, 36.514508603761584, 35.43888674179712, 30.184687308967113, 30.347724433988333, 29.639949694275856, 46.64923969656229, 46.478160470724106, 46.73004336771555, 44.31555781016746, 44.17379781107107, 44.46499671290317, 45.01273884624243, 44.994434241205454, 45.23196716979146, 51.9688869168361, 52.60993925792475, 52.009285901983574, 36.26050452888012, 36.72144643217325, 36.87180399149656, 48.75368596985935, 48.70624143630265, 48.85940331034361, 47.79548057913779, 47.87285973876713, 47.76442605629562, 45.733269446839884, 45.62022704010208, 45.591372561951474, 44.481723489860684, 44.79034812624255, 44.84530586252609, 47.40731324007113, 47.4012867261966, 47.50979461645086, 35.215998992323875, 35.661337833851576, 35.393626905977726, 33.77927070359388, 34.1667517820994, 33.54812769095102, 44.92155412584543, 44.80714900791645, 44.27710568904877, 33.1511616812398, 32.90747597937782, 33.140140144464866, 51.380060166120515, 51.50359793566166, 51.26635868102311, 32.16781839852531, 32.37969322719921, 32.099528202166155, 45.275131473938615, 46.36361962668403, 45.3234426776568, 29.62230559190114, 29.594813508292034, 29.321125109990433, 44.63909646930793, 43.88514972726503, 44.53220244931677, 24.943212648232773, 25.533745815356568, 25.41317958881457, 34.56345988065004, 34.399751737713814, 34.044297352433205, 40.16272837668657, 39.406241685152054, 39.863301649689674, 26.67361358801523, 26.367595369617135, 26.8906833945463, 42.543158059318856, 42.632256078844264, 42.28982598831256, 36.88895215342441, 36.633733371893555, 37.05920397366086, 37.73404852549234, 37.7448146889607, 37.645213725666196, 36.13717131316662, 36.481280997395515, 36.09191544353962, -90.452999866878, -90.62463916217288, -101.63108085592589, 55.53757536100845, 55.553597201282784, 55.46720152596633, 35.01098306973775, 36.08390266199906, 35.81179069479306, 44.12823738654454, 43.64041881759961, 43.16160576542218, 38.10191709299882, 38.3144102965792, 38.21818308656414, -88.27613389492035, -72.57270219177008, -73.63768896460533, 55.42393612116574, 55.48906803503631, 55.247744195163236, 37.43987302606304, 37.53454820563395, 37.564926774551466, 45.23798442321518, 44.84430586795011, 44.73172565797964, 40.70479924976826, 40.376173585653305, 40.44999572634697, 37.573327749967575, 38.08076598402113, 38.099722924642265, 35.90057834858695, 35.78848147640625, 35.95984516541162, 35.444799683988094, 35.426423609256744, 35.85445376019925, 37.19739392027259, 36.43748441338539, 37.33389604464173, 36.0526805864647, 35.62658604979515, 35.355500251054764, 25.510033609345555, 25.602442033588886, 25.284831307828426, 40.36516293821235, 39.976343912382916, 39.759594713648156, 51.98152809310703, 51.80447487533091, 51.489999726414666, 35.17832912753025, 35.08547850201526, 34.53696225086847, 43.218054722994566, 43.05760060250759, 43.00806042551994, 44.43379200001557, 44.6394309302171, 43.76800267895062, 39.20436496039231, 39.51781288844843, 39.418529999752835, 37.21162050838271, 37.06285679588714, 37.11970105643073, 53.911289239923164, 53.79948236296575, 53.47823824981849, 60.1735087558627, 60.37460251525043, 60.62688618130049, -97.07115820795298, -96.96107318811119, -109.16718113422394, 28.44436051847879, 27.042333632707596, 28.04047368466854, 47.027305439114556, 47.48796140484045, 47.46914425631984, 33.75309191644192, 34.118182212114334, 34.62907097185962, 49.647291357318565, 50.16044664072494, 50.013469344625875, 37.938123836958155, 37.7392415938278, 37.296992768843964, 26.896764524281025, 27.19278414733708, 26.315605118870735, -76.38109737386307, -76.1298431394001, -87.0754019667705, 44.05523631473382, 44.34816542764504, 44.521859661753595, 30.074816744153694, 29.95257418354352, 29.504603331287697, 46.43214262028535, 46.52701026697953, 46.89676430363518, 40.86498276765147, 40.71704927335182, 40.840826383481414, -108.37670902411143, -93.81685181210439, -93.9427379394571, 24.830312337726355, 24.441387690603733, 24.919551638886333, 46.08130123962958, 45.93867112447818, 45.9759091263016, 37.126725227572024, 36.73610005527735, 37.1844993904233, 45.215592121084526, 45.3799885114034, 45.45067291458447, 42.910995211452246, 42.694633796811104, 42.70756312459707, 41.82405761877695, 42.16700460265079, 42.17776283125082, 40.36350903411706, 40.5382960413893, 40.56729652297993, 52.10965369393428, 51.985741933186844, 52.4780073997875, 13.456567572895437, 12.776961147785187, 13.337651945650578, 44.16740478078523, 43.92675646642843, 43.87921311954656, 38.4062093819181, 38.74375797777125, 36.98625064889589, 33.60262336333592, 33.37627826382716, 33.13451899339755, 38.02206200361252, 37.62497243285179, 38.26056283712387, 36.09808987751603, 36.02556270360947, 36.194686729460955, 34.770189836621284, 34.745650455355644, 34.62503159046173, -74.6025822609663, -74.66120622307062, -74.61647167056799, 35.22059553240736, 35.34598426831265, 35.20094799747069, 37.115206852555275, 36.55290810763836, 37.40358442440629, 39.31894349058469, 39.68094417949517, 40.08693639313181, 31.697492135067776, 31.961452086766556, 31.914880891640976, 41.944814547896385, 42.17380318790674, 41.79850056767464, 39.65660852069655, 39.638439199576766, 39.54779031376043, 45.60504880795875, 45.618875725815684, 45.684580011914164, 36.77407458921273, 36.53363496561845, 35.96528485914071, 30.098677299916744, 29.827178739011288, 29.80674012005329, 35.8046677087744, 35.66902258743842, 35.750843075414494, 41.400661513830215, 41.25126121441522, 41.32608614737788]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14175194916119208, "mean_inference_ms": 0.6954987469102204, "mean_action_processing_ms": 0.09590189709352549, "mean_env_wait_ms": 0.7912289152736267, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 695000, "timesteps_this_iter": 0, "agent_timesteps_total": 2085000, "timers": {"sample_time_ms": 10640.592, "sample_throughput": 469.899, "load_time_ms": 0.198, "load_throughput": 25269936.137, "learn_time_ms": 2043.024, "learn_throughput": 2447.352, "update_time_ms": 9.247}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.311115933264683e-34, "cur_lr": 0.0005000000000000001, "total_loss": 8.111688995361328, "policy_loss": -0.001496769347687632, "vf_loss": 8.211838340759277, "vf_explained_var": 0.0035022497177124023, "kl": 0.0032503978349662796, "entropy": 9.865250778198241, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 695000, "num_agent_steps_sampled": 2085000, "num_steps_trained": 695000, "num_agent_steps_trained": 2085000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2063, "training_iteration": 139, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-26-19", "timestamp": 1706232379, "time_this_iter_s": 10.95723557472229, "time_total_s": 1493.8797936439514, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214024170D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1493.8797936439514, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 7.966666666666666, "ram_util_percent": 61.580000000000005}}
{"episode_reward_max": 181.17499745241375, "episode_reward_min": -303.1994125302881, "episode_reward_mean": 94.53062011331812, "episode_len_mean": 482.31, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -109.16718113422394}, "policy_reward_max": {"shared_policy": 60.62688618130049}, "policy_reward_mean": {"shared_policy": 31.51020670443937}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.23914025723934, 156.58811207674438, 109.85375495254993, 146.31933071650562, 143.43276637420058, 136.9448690488935, 134.11737747862927, 142.3183945827189, 106.27096373215318, 101.4941501766443, 134.0058088228107, 99.19877780508249, 154.15001678280535, 96.64703982789068, 136.96219377827936, 88.5382442101836, 133.05644864588993, 75.89013805240391, 103.00750897079706, 119.4322717115283, 79.93189235217866, 127.46524012647568, 110.58188949897882, 113.12407694011924, 108.71036775410175, -282.70871988497674, 166.55837408825758, 106.90667642652987, 130.9302619695663, 114.63451047614215, -234.48652505129576, 166.1607483513653, 112.53934800624846, 134.8140159491448, 121.53096856176853, 113.75381665863097, 107.64890499040482, 106.72567705344409, 110.96877437829971, 107.03476688731462, 76.39730695076287, 120.10110156424342, 155.27600269485248, 104.80076988041398, 129.2837157510221, 132.8412256091832, 118.14070784859358, 111.39417836070058, 161.1890098527073, 181.17499745241375, -303.1994125302881, 83.52716783585493, 141.98441110027483, 102.50034510041587, 149.82120734266908, 112.97435819962992, 80.40515379048884, -239.5863424800337, 132.92526140413253, 89.53199425898491, 139.85591719090007, 122.4228584244847, -296.1362987756729, 74.19125166721642, 137.99588149040943, 111.04732467327267, 136.0462535470723, 128.31319213286042, 126.16882505267856, 121.46910159848629, 156.57340302690855, 39.5711806663312, 131.97337436676003, 114.13621800858525, 100.11342062056063, 113.90759727358818, 108.31833931058645, 104.14087188243866, -223.8802601546049, 105.7675277981907, 111.07169938459992, 119.08682406321167, 95.57382511347531, 125.91711830347776, 118.84283803403375, 136.90850454568823, 109.27299441397189, 89.73259615898132, 107.22453337162732, 123.97800887562332, 113.5765783265233, 145.38434826768938, 56.472413957118974, 124.22974827885625, 116.17014850303528, 83.37216308154163, 8.265249807387562, 143.75262240320444, 122.07174899056551, 132.3865341264753], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 93, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 53, 500, 500, 500, 500, 500, 500, 281, 500, 500, 500, 500, 91, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 461, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [45.01273884624243, 44.994434241205454, 45.23196716979146, 51.9688869168361, 52.60993925792475, 52.009285901983574, 36.26050452888012, 36.72144643217325, 36.87180399149656, 48.75368596985935, 48.70624143630265, 48.85940331034361, 47.79548057913779, 47.87285973876713, 47.76442605629562, 45.733269446839884, 45.62022704010208, 45.591372561951474, 44.481723489860684, 44.79034812624255, 44.84530586252609, 47.40731324007113, 47.4012867261966, 47.50979461645086, 35.215998992323875, 35.661337833851576, 35.393626905977726, 33.77927070359388, 34.1667517820994, 33.54812769095102, 44.92155412584543, 44.80714900791645, 44.27710568904877, 33.1511616812398, 32.90747597937782, 33.140140144464866, 51.380060166120515, 51.50359793566166, 51.26635868102311, 32.16781839852531, 32.37969322719921, 32.099528202166155, 45.275131473938615, 46.36361962668403, 45.3234426776568, 29.62230559190114, 29.594813508292034, 29.321125109990433, 44.63909646930793, 43.88514972726503, 44.53220244931677, 24.943212648232773, 25.533745815356568, 25.41317958881457, 34.56345988065004, 34.399751737713814, 34.044297352433205, 40.16272837668657, 39.406241685152054, 39.863301649689674, 26.67361358801523, 26.367595369617135, 26.8906833945463, 42.543158059318856, 42.632256078844264, 42.28982598831256, 36.88895215342441, 36.633733371893555, 37.05920397366086, 37.73404852549234, 37.7448146889607, 37.645213725666196, 36.13717131316662, 36.481280997395515, 36.09191544353962, -90.452999866878, -90.62463916217288, -101.63108085592589, 55.53757536100845, 55.553597201282784, 55.46720152596633, 35.01098306973775, 36.08390266199906, 35.81179069479306, 44.12823738654454, 43.64041881759961, 43.16160576542218, 38.10191709299882, 38.3144102965792, 38.21818308656414, -88.27613389492035, -72.57270219177008, -73.63768896460533, 55.42393612116574, 55.48906803503631, 55.247744195163236, 37.43987302606304, 37.53454820563395, 37.564926774551466, 45.23798442321518, 44.84430586795011, 44.73172565797964, 40.70479924976826, 40.376173585653305, 40.44999572634697, 37.573327749967575, 38.08076598402113, 38.099722924642265, 35.90057834858695, 35.78848147640625, 35.95984516541162, 35.444799683988094, 35.426423609256744, 35.85445376019925, 37.19739392027259, 36.43748441338539, 37.33389604464173, 36.0526805864647, 35.62658604979515, 35.355500251054764, 25.510033609345555, 25.602442033588886, 25.284831307828426, 40.36516293821235, 39.976343912382916, 39.759594713648156, 51.98152809310703, 51.80447487533091, 51.489999726414666, 35.17832912753025, 35.08547850201526, 34.53696225086847, 43.218054722994566, 43.05760060250759, 43.00806042551994, 44.43379200001557, 44.6394309302171, 43.76800267895062, 39.20436496039231, 39.51781288844843, 39.418529999752835, 37.21162050838271, 37.06285679588714, 37.11970105643073, 53.911289239923164, 53.79948236296575, 53.47823824981849, 60.1735087558627, 60.37460251525043, 60.62688618130049, -97.07115820795298, -96.96107318811119, -109.16718113422394, 28.44436051847879, 27.042333632707596, 28.04047368466854, 47.027305439114556, 47.48796140484045, 47.46914425631984, 33.75309191644192, 34.118182212114334, 34.62907097185962, 49.647291357318565, 50.16044664072494, 50.013469344625875, 37.938123836958155, 37.7392415938278, 37.296992768843964, 26.896764524281025, 27.19278414733708, 26.315605118870735, -76.38109737386307, -76.1298431394001, -87.0754019667705, 44.05523631473382, 44.34816542764504, 44.521859661753595, 30.074816744153694, 29.95257418354352, 29.504603331287697, 46.43214262028535, 46.52701026697953, 46.89676430363518, 40.86498276765147, 40.71704927335182, 40.840826383481414, -108.37670902411143, -93.81685181210439, -93.9427379394571, 24.830312337726355, 24.441387690603733, 24.919551638886333, 46.08130123962958, 45.93867112447818, 45.9759091263016, 37.126725227572024, 36.73610005527735, 37.1844993904233, 45.215592121084526, 45.3799885114034, 45.45067291458447, 42.910995211452246, 42.694633796811104, 42.70756312459707, 41.82405761877695, 42.16700460265079, 42.17776283125082, 40.36350903411706, 40.5382960413893, 40.56729652297993, 52.10965369393428, 51.985741933186844, 52.4780073997875, 13.456567572895437, 12.776961147785187, 13.337651945650578, 44.16740478078523, 43.92675646642843, 43.87921311954656, 38.4062093819181, 38.74375797777125, 36.98625064889589, 33.60262336333592, 33.37627826382716, 33.13451899339755, 38.02206200361252, 37.62497243285179, 38.26056283712387, 36.09808987751603, 36.02556270360947, 36.194686729460955, 34.770189836621284, 34.745650455355644, 34.62503159046173, -74.6025822609663, -74.66120622307062, -74.61647167056799, 35.22059553240736, 35.34598426831265, 35.20094799747069, 37.115206852555275, 36.55290810763836, 37.40358442440629, 39.31894349058469, 39.68094417949517, 40.08693639313181, 31.697492135067776, 31.961452086766556, 31.914880891640976, 41.944814547896385, 42.17380318790674, 41.79850056767464, 39.65660852069655, 39.638439199576766, 39.54779031376043, 45.60504880795875, 45.618875725815684, 45.684580011914164, 36.77407458921273, 36.53363496561845, 35.96528485914071, 30.098677299916744, 29.827178739011288, 29.80674012005329, 35.8046677087744, 35.66902258743842, 35.750843075414494, 41.400661513830215, 41.25126121441522, 41.32608614737788, 37.725937992334366, 37.953024722635746, 37.89761561155319, 48.68994125165044, 48.6871065199375, 48.007300496101365, 18.894877442469195, 18.87486123417814, 18.702675280471638, 41.731257076064736, 41.6804026911656, 40.818088511625916, 38.66284616539875, 38.78805862988034, 38.71924370775619, 27.913852066422493, 27.527595872680337, 27.9307151424388, 2.6699794034163062, 2.880746624122054, 2.714523779849202, 47.95348519583543, 48.16067749758561, 47.63845970978339, 40.685722852746636, 40.60194010535875, 40.784086032460124, 43.86974196135998, 44.02265506982803, 44.49413709528744]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14173185629031035, "mean_inference_ms": 0.695526188089798, "mean_action_processing_ms": 0.0959021184735321, "mean_env_wait_ms": 0.7910668276052418, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 700000, "timesteps_this_iter": 0, "agent_timesteps_total": 2100000, "timers": {"sample_time_ms": 10618.488, "sample_throughput": 470.877, "load_time_ms": 0.198, "load_throughput": 25269936.137, "learn_time_ms": 2044.045, "learn_throughput": 2446.13, "update_time_ms": 9.326}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1555579666323415e-34, "cur_lr": 0.0005000000000000001, "total_loss": 8.113170480728149, "policy_loss": -0.0017007871265366959, "vf_loss": 8.210591650009155, "vf_explained_var": 0.03024413585662842, "kl": 0.002959483582562597, "entropy": 9.572031211853027, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 700000, "num_agent_steps_sampled": 2100000, "num_steps_trained": 700000, "num_agent_steps_trained": 2100000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2073, "training_iteration": 140, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-26-29", "timestamp": 1706232389, "time_this_iter_s": 10.171886682510376, "time_total_s": 1504.0516803264618, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021400813DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1504.0516803264618, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 5.013333333333334, "ram_util_percent": 61.620000000000005}}
{"episode_reward_max": 181.17499745241375, "episode_reward_min": -303.1994125302881, "episode_reward_mean": 89.55719444610614, "episode_len_mean": 480.18, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -109.16718113422394}, "policy_reward_max": {"shared_policy": 60.62688618130049}, "policy_reward_mean": {"shared_policy": 29.852398148702044}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.0058088228107, 99.19877780508249, 154.15001678280535, 96.64703982789068, 136.96219377827936, 88.5382442101836, 133.05644864588993, 75.89013805240391, 103.00750897079706, 119.4322717115283, 79.93189235217866, 127.46524012647568, 110.58188949897882, 113.12407694011924, 108.71036775410175, -282.70871988497674, 166.55837408825758, 106.90667642652987, 130.9302619695663, 114.63451047614215, -234.48652505129576, 166.1607483513653, 112.53934800624846, 134.8140159491448, 121.53096856176853, 113.75381665863097, 107.64890499040482, 106.72567705344409, 110.96877437829971, 107.03476688731462, 76.39730695076287, 120.10110156424342, 155.27600269485248, 104.80076988041398, 129.2837157510221, 132.8412256091832, 118.14070784859358, 111.39417836070058, 161.1890098527073, 181.17499745241375, -303.1994125302881, 83.52716783585493, 141.98441110027483, 102.50034510041587, 149.82120734266908, 112.97435819962992, 80.40515379048884, -239.5863424800337, 132.92526140413253, 89.53199425898491, 139.85591719090007, 122.4228584244847, -296.1362987756729, 74.19125166721642, 137.99588149040943, 111.04732467327267, 136.0462535470723, 128.31319213286042, 126.16882505267856, 121.46910159848629, 156.57340302690855, 39.5711806663312, 131.97337436676003, 114.13621800858525, 100.11342062056063, 113.90759727358818, 108.31833931058645, 104.14087188243866, -223.8802601546049, 105.7675277981907, 111.07169938459992, 119.08682406321167, 95.57382511347531, 125.91711830347776, 118.84283803403375, 136.90850454568823, 109.27299441397189, 89.73259615898132, 107.22453337162732, 123.97800887562332, 113.5765783265233, 145.38434826768938, 56.472413957118974, 124.22974827885625, 116.17014850303528, 83.37216308154163, 8.265249807387562, 143.75262240320444, 122.07174899056551, 132.3865341264753, 121.13704105344368, 128.8227591793984, 113.98802920617163, -238.151207767427, 150.01631849259138, 125.17767405509947, 86.20125055313109, 139.851355687948, 66.99746800959109, 121.1956042051315], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 93, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 53, 500, 500, 500, 500, 500, 500, 281, 500, 500, 500, 500, 91, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 461, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 287, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [44.92155412584543, 44.80714900791645, 44.27710568904877, 33.1511616812398, 32.90747597937782, 33.140140144464866, 51.380060166120515, 51.50359793566166, 51.26635868102311, 32.16781839852531, 32.37969322719921, 32.099528202166155, 45.275131473938615, 46.36361962668403, 45.3234426776568, 29.62230559190114, 29.594813508292034, 29.321125109990433, 44.63909646930793, 43.88514972726503, 44.53220244931677, 24.943212648232773, 25.533745815356568, 25.41317958881457, 34.56345988065004, 34.399751737713814, 34.044297352433205, 40.16272837668657, 39.406241685152054, 39.863301649689674, 26.67361358801523, 26.367595369617135, 26.8906833945463, 42.543158059318856, 42.632256078844264, 42.28982598831256, 36.88895215342441, 36.633733371893555, 37.05920397366086, 37.73404852549234, 37.7448146889607, 37.645213725666196, 36.13717131316662, 36.481280997395515, 36.09191544353962, -90.452999866878, -90.62463916217288, -101.63108085592589, 55.53757536100845, 55.553597201282784, 55.46720152596633, 35.01098306973775, 36.08390266199906, 35.81179069479306, 44.12823738654454, 43.64041881759961, 43.16160576542218, 38.10191709299882, 38.3144102965792, 38.21818308656414, -88.27613389492035, -72.57270219177008, -73.63768896460533, 55.42393612116574, 55.48906803503631, 55.247744195163236, 37.43987302606304, 37.53454820563395, 37.564926774551466, 45.23798442321518, 44.84430586795011, 44.73172565797964, 40.70479924976826, 40.376173585653305, 40.44999572634697, 37.573327749967575, 38.08076598402113, 38.099722924642265, 35.90057834858695, 35.78848147640625, 35.95984516541162, 35.444799683988094, 35.426423609256744, 35.85445376019925, 37.19739392027259, 36.43748441338539, 37.33389604464173, 36.0526805864647, 35.62658604979515, 35.355500251054764, 25.510033609345555, 25.602442033588886, 25.284831307828426, 40.36516293821235, 39.976343912382916, 39.759594713648156, 51.98152809310703, 51.80447487533091, 51.489999726414666, 35.17832912753025, 35.08547850201526, 34.53696225086847, 43.218054722994566, 43.05760060250759, 43.00806042551994, 44.43379200001557, 44.6394309302171, 43.76800267895062, 39.20436496039231, 39.51781288844843, 39.418529999752835, 37.21162050838271, 37.06285679588714, 37.11970105643073, 53.911289239923164, 53.79948236296575, 53.47823824981849, 60.1735087558627, 60.37460251525043, 60.62688618130049, -97.07115820795298, -96.96107318811119, -109.16718113422394, 28.44436051847879, 27.042333632707596, 28.04047368466854, 47.027305439114556, 47.48796140484045, 47.46914425631984, 33.75309191644192, 34.118182212114334, 34.62907097185962, 49.647291357318565, 50.16044664072494, 50.013469344625875, 37.938123836958155, 37.7392415938278, 37.296992768843964, 26.896764524281025, 27.19278414733708, 26.315605118870735, -76.38109737386307, -76.1298431394001, -87.0754019667705, 44.05523631473382, 44.34816542764504, 44.521859661753595, 30.074816744153694, 29.95257418354352, 29.504603331287697, 46.43214262028535, 46.52701026697953, 46.89676430363518, 40.86498276765147, 40.71704927335182, 40.840826383481414, -108.37670902411143, -93.81685181210439, -93.9427379394571, 24.830312337726355, 24.441387690603733, 24.919551638886333, 46.08130123962958, 45.93867112447818, 45.9759091263016, 37.126725227572024, 36.73610005527735, 37.1844993904233, 45.215592121084526, 45.3799885114034, 45.45067291458447, 42.910995211452246, 42.694633796811104, 42.70756312459707, 41.82405761877695, 42.16700460265079, 42.17776283125082, 40.36350903411706, 40.5382960413893, 40.56729652297993, 52.10965369393428, 51.985741933186844, 52.4780073997875, 13.456567572895437, 12.776961147785187, 13.337651945650578, 44.16740478078523, 43.92675646642843, 43.87921311954656, 38.4062093819181, 38.74375797777125, 36.98625064889589, 33.60262336333592, 33.37627826382716, 33.13451899339755, 38.02206200361252, 37.62497243285179, 38.26056283712387, 36.09808987751603, 36.02556270360947, 36.194686729460955, 34.770189836621284, 34.745650455355644, 34.62503159046173, -74.6025822609663, -74.66120622307062, -74.61647167056799, 35.22059553240736, 35.34598426831265, 35.20094799747069, 37.115206852555275, 36.55290810763836, 37.40358442440629, 39.31894349058469, 39.68094417949517, 40.08693639313181, 31.697492135067776, 31.961452086766556, 31.914880891640976, 41.944814547896385, 42.17380318790674, 41.79850056767464, 39.65660852069655, 39.638439199576766, 39.54779031376043, 45.60504880795875, 45.618875725815684, 45.684580011914164, 36.77407458921273, 36.53363496561845, 35.96528485914071, 30.098677299916744, 29.827178739011288, 29.80674012005329, 35.8046677087744, 35.66902258743842, 35.750843075414494, 41.400661513830215, 41.25126121441522, 41.32608614737788, 37.725937992334366, 37.953024722635746, 37.89761561155319, 48.68994125165044, 48.6871065199375, 48.007300496101365, 18.894877442469195, 18.87486123417814, 18.702675280471638, 41.731257076064736, 41.6804026911656, 40.818088511625916, 38.66284616539875, 38.78805862988034, 38.71924370775619, 27.913852066422493, 27.527595872680337, 27.9307151424388, 2.6699794034163062, 2.880746624122054, 2.714523779849202, 47.95348519583543, 48.16067749758561, 47.63845970978339, 40.685722852746636, 40.60194010535875, 40.784086032460124, 43.86974196135998, 44.02265506982803, 44.49413709528744, 40.221398919820786, 40.21922629326582, 40.696415840357076, 43.081651203955204, 42.78619873772064, 42.954909237722546, 38.18404501117766, 38.12325698137283, 37.68072721362114, -90.23836263020834, -73.82090393950543, -74.09194119771323, 49.848045970002815, 50.37451446304719, 49.79375805954139, 41.81832065929969, 41.847277005513504, 41.51207639028628, 27.880267103513077, 28.967059602340058, 29.353923847277954, 46.35384042561054, 46.47056628763676, 47.026948974700645, 22.423013803859547, 22.54887221505244, 22.0255819906791, 40.699374737838895, 40.72080849359432, 39.77542097369829]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14169752941188674, "mean_inference_ms": 0.6955204122309788, "mean_action_processing_ms": 0.09589479352503566, "mean_env_wait_ms": 0.7908960840029451, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 705000, "timesteps_this_iter": 0, "agent_timesteps_total": 2115000, "timers": {"sample_time_ms": 10585.121, "sample_throughput": 472.361, "load_time_ms": 0.198, "load_throughput": 25269936.137, "learn_time_ms": 2031.556, "learn_throughput": 2461.168, "update_time_ms": 9.308}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.777789833161707e-35, "cur_lr": 0.0005000000000000001, "total_loss": 94.48827438354492, "policy_loss": -0.001354346062246048, "vf_loss": 94.58840408325196, "vf_explained_var": 0.03419089317321777, "kl": 0.0030535625701701816, "entropy": 9.877646446228027, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 705000, "num_agent_steps_sampled": 2115000, "num_steps_trained": 705000, "num_agent_steps_trained": 2115000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2083, "training_iteration": 141, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-26-40", "timestamp": 1706232400, "time_this_iter_s": 10.35508680343628, "time_total_s": 1514.406767129898, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021400813940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1514.406767129898, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 5.9, "ram_util_percent": 61.66666666666667}}
{"episode_reward_max": 181.17499745241375, "episode_reward_min": -303.1994125302881, "episode_reward_mean": 90.49925212414233, "episode_len_mean": 480.18, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -109.16718113422394}, "policy_reward_max": {"shared_policy": 60.62688618130049}, "policy_reward_mean": {"shared_policy": 30.166417374714122}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.93189235217866, 127.46524012647568, 110.58188949897882, 113.12407694011924, 108.71036775410175, -282.70871988497674, 166.55837408825758, 106.90667642652987, 130.9302619695663, 114.63451047614215, -234.48652505129576, 166.1607483513653, 112.53934800624846, 134.8140159491448, 121.53096856176853, 113.75381665863097, 107.64890499040482, 106.72567705344409, 110.96877437829971, 107.03476688731462, 76.39730695076287, 120.10110156424342, 155.27600269485248, 104.80076988041398, 129.2837157510221, 132.8412256091832, 118.14070784859358, 111.39417836070058, 161.1890098527073, 181.17499745241375, -303.1994125302881, 83.52716783585493, 141.98441110027483, 102.50034510041587, 149.82120734266908, 112.97435819962992, 80.40515379048884, -239.5863424800337, 132.92526140413253, 89.53199425898491, 139.85591719090007, 122.4228584244847, -296.1362987756729, 74.19125166721642, 137.99588149040943, 111.04732467327267, 136.0462535470723, 128.31319213286042, 126.16882505267856, 121.46910159848629, 156.57340302690855, 39.5711806663312, 131.97337436676003, 114.13621800858525, 100.11342062056063, 113.90759727358818, 108.31833931058645, 104.14087188243866, -223.8802601546049, 105.7675277981907, 111.07169938459992, 119.08682406321167, 95.57382511347531, 125.91711830347776, 118.84283803403375, 136.90850454568823, 109.27299441397189, 89.73259615898132, 107.22453337162732, 123.97800887562332, 113.5765783265233, 145.38434826768938, 56.472413957118974, 124.22974827885625, 116.17014850303528, 83.37216308154163, 8.265249807387562, 143.75262240320444, 122.07174899056551, 132.3865341264753, 121.13704105344368, 128.8227591793984, 113.98802920617163, -238.151207767427, 150.01631849259138, 125.17767405509947, 86.20125055313109, 139.851355687948, 66.99746800959109, 121.1956042051315, 113.44794831052421, 115.76236588880417, 130.04762677848333, 118.3942104639718, 162.74641777575002, 137.4668347612021, 110.95950779010306, 103.8478490151465, 121.01969178020953, 121.40176384709774], "episode_lengths": [500, 500, 500, 500, 500, 93, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 53, 500, 500, 500, 500, 500, 500, 281, 500, 500, 500, 500, 91, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 461, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 287, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [26.67361358801523, 26.367595369617135, 26.8906833945463, 42.543158059318856, 42.632256078844264, 42.28982598831256, 36.88895215342441, 36.633733371893555, 37.05920397366086, 37.73404852549234, 37.7448146889607, 37.645213725666196, 36.13717131316662, 36.481280997395515, 36.09191544353962, -90.452999866878, -90.62463916217288, -101.63108085592589, 55.53757536100845, 55.553597201282784, 55.46720152596633, 35.01098306973775, 36.08390266199906, 35.81179069479306, 44.12823738654454, 43.64041881759961, 43.16160576542218, 38.10191709299882, 38.3144102965792, 38.21818308656414, -88.27613389492035, -72.57270219177008, -73.63768896460533, 55.42393612116574, 55.48906803503631, 55.247744195163236, 37.43987302606304, 37.53454820563395, 37.564926774551466, 45.23798442321518, 44.84430586795011, 44.73172565797964, 40.70479924976826, 40.376173585653305, 40.44999572634697, 37.573327749967575, 38.08076598402113, 38.099722924642265, 35.90057834858695, 35.78848147640625, 35.95984516541162, 35.444799683988094, 35.426423609256744, 35.85445376019925, 37.19739392027259, 36.43748441338539, 37.33389604464173, 36.0526805864647, 35.62658604979515, 35.355500251054764, 25.510033609345555, 25.602442033588886, 25.284831307828426, 40.36516293821235, 39.976343912382916, 39.759594713648156, 51.98152809310703, 51.80447487533091, 51.489999726414666, 35.17832912753025, 35.08547850201526, 34.53696225086847, 43.218054722994566, 43.05760060250759, 43.00806042551994, 44.43379200001557, 44.6394309302171, 43.76800267895062, 39.20436496039231, 39.51781288844843, 39.418529999752835, 37.21162050838271, 37.06285679588714, 37.11970105643073, 53.911289239923164, 53.79948236296575, 53.47823824981849, 60.1735087558627, 60.37460251525043, 60.62688618130049, -97.07115820795298, -96.96107318811119, -109.16718113422394, 28.44436051847879, 27.042333632707596, 28.04047368466854, 47.027305439114556, 47.48796140484045, 47.46914425631984, 33.75309191644192, 34.118182212114334, 34.62907097185962, 49.647291357318565, 50.16044664072494, 50.013469344625875, 37.938123836958155, 37.7392415938278, 37.296992768843964, 26.896764524281025, 27.19278414733708, 26.315605118870735, -76.38109737386307, -76.1298431394001, -87.0754019667705, 44.05523631473382, 44.34816542764504, 44.521859661753595, 30.074816744153694, 29.95257418354352, 29.504603331287697, 46.43214262028535, 46.52701026697953, 46.89676430363518, 40.86498276765147, 40.71704927335182, 40.840826383481414, -108.37670902411143, -93.81685181210439, -93.9427379394571, 24.830312337726355, 24.441387690603733, 24.919551638886333, 46.08130123962958, 45.93867112447818, 45.9759091263016, 37.126725227572024, 36.73610005527735, 37.1844993904233, 45.215592121084526, 45.3799885114034, 45.45067291458447, 42.910995211452246, 42.694633796811104, 42.70756312459707, 41.82405761877695, 42.16700460265079, 42.17776283125082, 40.36350903411706, 40.5382960413893, 40.56729652297993, 52.10965369393428, 51.985741933186844, 52.4780073997875, 13.456567572895437, 12.776961147785187, 13.337651945650578, 44.16740478078523, 43.92675646642843, 43.87921311954656, 38.4062093819181, 38.74375797777125, 36.98625064889589, 33.60262336333592, 33.37627826382716, 33.13451899339755, 38.02206200361252, 37.62497243285179, 38.26056283712387, 36.09808987751603, 36.02556270360947, 36.194686729460955, 34.770189836621284, 34.745650455355644, 34.62503159046173, -74.6025822609663, -74.66120622307062, -74.61647167056799, 35.22059553240736, 35.34598426831265, 35.20094799747069, 37.115206852555275, 36.55290810763836, 37.40358442440629, 39.31894349058469, 39.68094417949517, 40.08693639313181, 31.697492135067776, 31.961452086766556, 31.914880891640976, 41.944814547896385, 42.17380318790674, 41.79850056767464, 39.65660852069655, 39.638439199576766, 39.54779031376043, 45.60504880795875, 45.618875725815684, 45.684580011914164, 36.77407458921273, 36.53363496561845, 35.96528485914071, 30.098677299916744, 29.827178739011288, 29.80674012005329, 35.8046677087744, 35.66902258743842, 35.750843075414494, 41.400661513830215, 41.25126121441522, 41.32608614737788, 37.725937992334366, 37.953024722635746, 37.89761561155319, 48.68994125165044, 48.6871065199375, 48.007300496101365, 18.894877442469195, 18.87486123417814, 18.702675280471638, 41.731257076064736, 41.6804026911656, 40.818088511625916, 38.66284616539875, 38.78805862988034, 38.71924370775619, 27.913852066422493, 27.527595872680337, 27.9307151424388, 2.6699794034163062, 2.880746624122054, 2.714523779849202, 47.95348519583543, 48.16067749758561, 47.63845970978339, 40.685722852746636, 40.60194010535875, 40.784086032460124, 43.86974196135998, 44.02265506982803, 44.49413709528744, 40.221398919820786, 40.21922629326582, 40.696415840357076, 43.081651203955204, 42.78619873772064, 42.954909237722546, 38.18404501117766, 38.12325698137283, 37.68072721362114, -90.23836263020834, -73.82090393950543, -74.09194119771323, 49.848045970002815, 50.37451446304719, 49.79375805954139, 41.81832065929969, 41.847277005513504, 41.51207639028628, 27.880267103513077, 28.967059602340058, 29.353923847277954, 46.35384042561054, 46.47056628763676, 47.026948974700645, 22.423013803859547, 22.54887221505244, 22.0255819906791, 40.699374737838895, 40.72080849359432, 39.77542097369829, 37.936226454873875, 38.11091554289062, 37.40080631275971, 38.66367085526386, 38.551999318102986, 38.54669571543732, 43.255162383119256, 43.50838317970434, 43.28408121565977, 39.03095699350038, 39.94655209154976, 39.41670137892166, 54.34334793190162, 54.03299891451995, 54.370070929328605, 45.898698846499116, 45.966574418048054, 45.60156149665514, 37.127448820198566, 37.15459331996195, 36.67746564994255, 34.658869011327624, 34.758270075544715, 34.430709928274155, 40.25217696775992, 40.45650165279706, 40.311013159652546, 40.50659877558549, 40.31424728532632, 40.580917786185935]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1416542977582454, "mean_inference_ms": 0.6954957322698873, "mean_action_processing_ms": 0.09588799377906117, "mean_env_wait_ms": 0.7907221607400361, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 710000, "timesteps_this_iter": 0, "agent_timesteps_total": 2130000, "timers": {"sample_time_ms": 10564.871, "sample_throughput": 473.267, "load_time_ms": 0.099, "load_throughput": 50545962.883, "learn_time_ms": 2036.317, "learn_throughput": 2455.414, "update_time_ms": 9.315}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.8888949165808537e-35, "cur_lr": 0.0005000000000000001, "total_loss": 6.6327920913696286, "policy_loss": -0.0014538745938645903, "vf_loss": 6.733739948272705, "vf_explained_var": 0.016210788488388063, "kl": 0.002340237720677052, "entropy": 9.949396324157714, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 710000, "num_agent_steps_sampled": 2130000, "num_steps_trained": 710000, "num_agent_steps_trained": 2130000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2093, "training_iteration": 142, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-26-50", "timestamp": 1706232410, "time_this_iter_s": 10.620853662490845, "time_total_s": 1525.027620792389, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402E08790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1525.027620792389, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 5.386666666666667, "ram_util_percent": 61.77999999999999}}
{"episode_reward_max": 181.17499745241375, "episode_reward_min": -303.1994125302881, "episode_reward_mean": 90.85287500585659, "episode_len_mean": 483.66, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -109.16718113422394}, "policy_reward_max": {"shared_policy": 60.62688618130049}, "policy_reward_mean": {"shared_policy": 30.284291668618867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-234.48652505129576, 166.1607483513653, 112.53934800624846, 134.8140159491448, 121.53096856176853, 113.75381665863097, 107.64890499040482, 106.72567705344409, 110.96877437829971, 107.03476688731462, 76.39730695076287, 120.10110156424342, 155.27600269485248, 104.80076988041398, 129.2837157510221, 132.8412256091832, 118.14070784859358, 111.39417836070058, 161.1890098527073, 181.17499745241375, -303.1994125302881, 83.52716783585493, 141.98441110027483, 102.50034510041587, 149.82120734266908, 112.97435819962992, 80.40515379048884, -239.5863424800337, 132.92526140413253, 89.53199425898491, 139.85591719090007, 122.4228584244847, -296.1362987756729, 74.19125166721642, 137.99588149040943, 111.04732467327267, 136.0462535470723, 128.31319213286042, 126.16882505267856, 121.46910159848629, 156.57340302690855, 39.5711806663312, 131.97337436676003, 114.13621800858525, 100.11342062056063, 113.90759727358818, 108.31833931058645, 104.14087188243866, -223.8802601546049, 105.7675277981907, 111.07169938459992, 119.08682406321167, 95.57382511347531, 125.91711830347776, 118.84283803403375, 136.90850454568823, 109.27299441397189, 89.73259615898132, 107.22453337162732, 123.97800887562332, 113.5765783265233, 145.38434826768938, 56.472413957118974, 124.22974827885625, 116.17014850303528, 83.37216308154163, 8.265249807387562, 143.75262240320444, 122.07174899056551, 132.3865341264753, 121.13704105344368, 128.8227591793984, 113.98802920617163, -238.151207767427, 150.01631849259138, 125.17767405509947, 86.20125055313109, 139.851355687948, 66.99746800959109, 121.1956042051315, 113.44794831052421, 115.76236588880417, 130.04762677848333, 118.3942104639718, 162.74641777575002, 137.4668347612021, 110.95950779010306, 103.8478490151465, 121.01969178020953, 121.40176384709774, 156.39102496579284, 139.51691002771233, 130.87160644680262, 104.773629527539, 85.87541884928939, 127.30437207967043, 102.0550153888762, -231.89148797839883, 120.2270218655467, 76.37334674596784], "episode_lengths": [252, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 53, 500, 500, 500, 500, 500, 500, 281, 500, 500, 500, 500, 91, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 461, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 287, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 441, 500, 500], "policy_shared_policy_reward": [-88.27613389492035, -72.57270219177008, -73.63768896460533, 55.42393612116574, 55.48906803503631, 55.247744195163236, 37.43987302606304, 37.53454820563395, 37.564926774551466, 45.23798442321518, 44.84430586795011, 44.73172565797964, 40.70479924976826, 40.376173585653305, 40.44999572634697, 37.573327749967575, 38.08076598402113, 38.099722924642265, 35.90057834858695, 35.78848147640625, 35.95984516541162, 35.444799683988094, 35.426423609256744, 35.85445376019925, 37.19739392027259, 36.43748441338539, 37.33389604464173, 36.0526805864647, 35.62658604979515, 35.355500251054764, 25.510033609345555, 25.602442033588886, 25.284831307828426, 40.36516293821235, 39.976343912382916, 39.759594713648156, 51.98152809310703, 51.80447487533091, 51.489999726414666, 35.17832912753025, 35.08547850201526, 34.53696225086847, 43.218054722994566, 43.05760060250759, 43.00806042551994, 44.43379200001557, 44.6394309302171, 43.76800267895062, 39.20436496039231, 39.51781288844843, 39.418529999752835, 37.21162050838271, 37.06285679588714, 37.11970105643073, 53.911289239923164, 53.79948236296575, 53.47823824981849, 60.1735087558627, 60.37460251525043, 60.62688618130049, -97.07115820795298, -96.96107318811119, -109.16718113422394, 28.44436051847879, 27.042333632707596, 28.04047368466854, 47.027305439114556, 47.48796140484045, 47.46914425631984, 33.75309191644192, 34.118182212114334, 34.62907097185962, 49.647291357318565, 50.16044664072494, 50.013469344625875, 37.938123836958155, 37.7392415938278, 37.296992768843964, 26.896764524281025, 27.19278414733708, 26.315605118870735, -76.38109737386307, -76.1298431394001, -87.0754019667705, 44.05523631473382, 44.34816542764504, 44.521859661753595, 30.074816744153694, 29.95257418354352, 29.504603331287697, 46.43214262028535, 46.52701026697953, 46.89676430363518, 40.86498276765147, 40.71704927335182, 40.840826383481414, -108.37670902411143, -93.81685181210439, -93.9427379394571, 24.830312337726355, 24.441387690603733, 24.919551638886333, 46.08130123962958, 45.93867112447818, 45.9759091263016, 37.126725227572024, 36.73610005527735, 37.1844993904233, 45.215592121084526, 45.3799885114034, 45.45067291458447, 42.910995211452246, 42.694633796811104, 42.70756312459707, 41.82405761877695, 42.16700460265079, 42.17776283125082, 40.36350903411706, 40.5382960413893, 40.56729652297993, 52.10965369393428, 51.985741933186844, 52.4780073997875, 13.456567572895437, 12.776961147785187, 13.337651945650578, 44.16740478078523, 43.92675646642843, 43.87921311954656, 38.4062093819181, 38.74375797777125, 36.98625064889589, 33.60262336333592, 33.37627826382716, 33.13451899339755, 38.02206200361252, 37.62497243285179, 38.26056283712387, 36.09808987751603, 36.02556270360947, 36.194686729460955, 34.770189836621284, 34.745650455355644, 34.62503159046173, -74.6025822609663, -74.66120622307062, -74.61647167056799, 35.22059553240736, 35.34598426831265, 35.20094799747069, 37.115206852555275, 36.55290810763836, 37.40358442440629, 39.31894349058469, 39.68094417949517, 40.08693639313181, 31.697492135067776, 31.961452086766556, 31.914880891640976, 41.944814547896385, 42.17380318790674, 41.79850056767464, 39.65660852069655, 39.638439199576766, 39.54779031376043, 45.60504880795875, 45.618875725815684, 45.684580011914164, 36.77407458921273, 36.53363496561845, 35.96528485914071, 30.098677299916744, 29.827178739011288, 29.80674012005329, 35.8046677087744, 35.66902258743842, 35.750843075414494, 41.400661513830215, 41.25126121441522, 41.32608614737788, 37.725937992334366, 37.953024722635746, 37.89761561155319, 48.68994125165044, 48.6871065199375, 48.007300496101365, 18.894877442469195, 18.87486123417814, 18.702675280471638, 41.731257076064736, 41.6804026911656, 40.818088511625916, 38.66284616539875, 38.78805862988034, 38.71924370775619, 27.913852066422493, 27.527595872680337, 27.9307151424388, 2.6699794034163062, 2.880746624122054, 2.714523779849202, 47.95348519583543, 48.16067749758561, 47.63845970978339, 40.685722852746636, 40.60194010535875, 40.784086032460124, 43.86974196135998, 44.02265506982803, 44.49413709528744, 40.221398919820786, 40.21922629326582, 40.696415840357076, 43.081651203955204, 42.78619873772064, 42.954909237722546, 38.18404501117766, 38.12325698137283, 37.68072721362114, -90.23836263020834, -73.82090393950543, -74.09194119771323, 49.848045970002815, 50.37451446304719, 49.79375805954139, 41.81832065929969, 41.847277005513504, 41.51207639028628, 27.880267103513077, 28.967059602340058, 29.353923847277954, 46.35384042561054, 46.47056628763676, 47.026948974700645, 22.423013803859547, 22.54887221505244, 22.0255819906791, 40.699374737838895, 40.72080849359432, 39.77542097369829, 37.936226454873875, 38.11091554289062, 37.40080631275971, 38.66367085526386, 38.551999318102986, 38.54669571543732, 43.255162383119256, 43.50838317970434, 43.28408121565977, 39.03095699350038, 39.94655209154976, 39.41670137892166, 54.34334793190162, 54.03299891451995, 54.370070929328605, 45.898698846499116, 45.966574418048054, 45.60156149665514, 37.127448820198566, 37.15459331996195, 36.67746564994255, 34.658869011327624, 34.758270075544715, 34.430709928274155, 40.25217696775992, 40.45650165279706, 40.311013159652546, 40.50659877558549, 40.31424728532632, 40.580917786185935, 51.988362602889524, 52.272463504225, 52.13019885867833, 46.11000759899616, 46.75771242380142, 46.649190004915, 43.641764402389526, 43.81463534384966, 43.41520670056343, 35.021134470899895, 35.047517256190375, 34.70497780044873, 28.685802715520055, 28.78631682197252, 28.403299311796815, 42.42820106446743, 42.319111451506615, 42.557059563696384, 34.042158260941505, 34.02005151286721, 33.99280561506748, -87.90253992875418, -72.10056211551031, -71.88838593413433, 39.899816274642944, 40.09719109535217, 40.230014495551586, 25.39741540948549, 25.782339374224335, 25.19359196225801]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1416233521441596, "mean_inference_ms": 0.6954639042210451, "mean_action_processing_ms": 0.09587001688745435, "mean_env_wait_ms": 0.7905315882977346, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 715000, "timesteps_this_iter": 0, "agent_timesteps_total": 2145000, "timers": {"sample_time_ms": 10527.157, "sample_throughput": 474.962, "load_time_ms": 0.099, "load_throughput": 50545962.883, "learn_time_ms": 2029.138, "learn_throughput": 2464.101, "update_time_ms": 9.32}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4444474582904268e-35, "cur_lr": 0.0005000000000000001, "total_loss": 126.33479766845703, "policy_loss": -0.0024584590451019574, "vf_loss": 126.43546676635742, "vf_explained_var": 0.04791353344917297, "kl": 0.00427510141748214, "entropy": 9.821684169769288, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 715000, "num_agent_steps_sampled": 2145000, "num_steps_trained": 715000, "num_agent_steps_trained": 2145000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2103, "training_iteration": 143, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-27-01", "timestamp": 1706232421, "time_this_iter_s": 10.203802824020386, "time_total_s": 1535.2314236164093, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402554F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1535.2314236164093, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 7.949999999999998, "ram_util_percent": 61.78571428571428}}
{"episode_reward_max": 181.17499745241375, "episode_reward_min": -303.1994125302881, "episode_reward_mean": 93.96856974455527, "episode_len_mean": 486.14, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -109.16718113422394}, "policy_reward_max": {"shared_policy": 60.62688618130049}, "policy_reward_mean": {"shared_policy": 31.322856581518426}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.39730695076287, 120.10110156424342, 155.27600269485248, 104.80076988041398, 129.2837157510221, 132.8412256091832, 118.14070784859358, 111.39417836070058, 161.1890098527073, 181.17499745241375, -303.1994125302881, 83.52716783585493, 141.98441110027483, 102.50034510041587, 149.82120734266908, 112.97435819962992, 80.40515379048884, -239.5863424800337, 132.92526140413253, 89.53199425898491, 139.85591719090007, 122.4228584244847, -296.1362987756729, 74.19125166721642, 137.99588149040943, 111.04732467327267, 136.0462535470723, 128.31319213286042, 126.16882505267856, 121.46910159848629, 156.57340302690855, 39.5711806663312, 131.97337436676003, 114.13621800858525, 100.11342062056063, 113.90759727358818, 108.31833931058645, 104.14087188243866, -223.8802601546049, 105.7675277981907, 111.07169938459992, 119.08682406321167, 95.57382511347531, 125.91711830347776, 118.84283803403375, 136.90850454568823, 109.27299441397189, 89.73259615898132, 107.22453337162732, 123.97800887562332, 113.5765783265233, 145.38434826768938, 56.472413957118974, 124.22974827885625, 116.17014850303528, 83.37216308154163, 8.265249807387562, 143.75262240320444, 122.07174899056551, 132.3865341264753, 121.13704105344368, 128.8227591793984, 113.98802920617163, -238.151207767427, 150.01631849259138, 125.17767405509947, 86.20125055313109, 139.851355687948, 66.99746800959109, 121.1956042051315, 113.44794831052421, 115.76236588880417, 130.04762677848333, 118.3942104639718, 162.74641777575002, 137.4668347612021, 110.95950779010306, 103.8478490151465, 121.01969178020953, 121.40176384709774, 156.39102496579284, 139.51691002771233, 130.87160644680262, 104.773629527539, 85.87541884928939, 127.30437207967043, 102.0550153888762, -231.89148797839883, 120.2270218655467, 76.37334674596784, 70.63930404745042, 128.0969271287322, 124.62452434003353, 123.69610049575567, 105.34417300717904, 127.31107435352169, 87.63965208735317, 93.8966621980071, 158.38800730975333, 138.62354468740523], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 53, 500, 500, 500, 500, 500, 500, 281, 500, 500, 500, 500, 91, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 461, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 287, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 441, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [25.510033609345555, 25.602442033588886, 25.284831307828426, 40.36516293821235, 39.976343912382916, 39.759594713648156, 51.98152809310703, 51.80447487533091, 51.489999726414666, 35.17832912753025, 35.08547850201526, 34.53696225086847, 43.218054722994566, 43.05760060250759, 43.00806042551994, 44.43379200001557, 44.6394309302171, 43.76800267895062, 39.20436496039231, 39.51781288844843, 39.418529999752835, 37.21162050838271, 37.06285679588714, 37.11970105643073, 53.911289239923164, 53.79948236296575, 53.47823824981849, 60.1735087558627, 60.37460251525043, 60.62688618130049, -97.07115820795298, -96.96107318811119, -109.16718113422394, 28.44436051847879, 27.042333632707596, 28.04047368466854, 47.027305439114556, 47.48796140484045, 47.46914425631984, 33.75309191644192, 34.118182212114334, 34.62907097185962, 49.647291357318565, 50.16044664072494, 50.013469344625875, 37.938123836958155, 37.7392415938278, 37.296992768843964, 26.896764524281025, 27.19278414733708, 26.315605118870735, -76.38109737386307, -76.1298431394001, -87.0754019667705, 44.05523631473382, 44.34816542764504, 44.521859661753595, 30.074816744153694, 29.95257418354352, 29.504603331287697, 46.43214262028535, 46.52701026697953, 46.89676430363518, 40.86498276765147, 40.71704927335182, 40.840826383481414, -108.37670902411143, -93.81685181210439, -93.9427379394571, 24.830312337726355, 24.441387690603733, 24.919551638886333, 46.08130123962958, 45.93867112447818, 45.9759091263016, 37.126725227572024, 36.73610005527735, 37.1844993904233, 45.215592121084526, 45.3799885114034, 45.45067291458447, 42.910995211452246, 42.694633796811104, 42.70756312459707, 41.82405761877695, 42.16700460265079, 42.17776283125082, 40.36350903411706, 40.5382960413893, 40.56729652297993, 52.10965369393428, 51.985741933186844, 52.4780073997875, 13.456567572895437, 12.776961147785187, 13.337651945650578, 44.16740478078523, 43.92675646642843, 43.87921311954656, 38.4062093819181, 38.74375797777125, 36.98625064889589, 33.60262336333592, 33.37627826382716, 33.13451899339755, 38.02206200361252, 37.62497243285179, 38.26056283712387, 36.09808987751603, 36.02556270360947, 36.194686729460955, 34.770189836621284, 34.745650455355644, 34.62503159046173, -74.6025822609663, -74.66120622307062, -74.61647167056799, 35.22059553240736, 35.34598426831265, 35.20094799747069, 37.115206852555275, 36.55290810763836, 37.40358442440629, 39.31894349058469, 39.68094417949517, 40.08693639313181, 31.697492135067776, 31.961452086766556, 31.914880891640976, 41.944814547896385, 42.17380318790674, 41.79850056767464, 39.65660852069655, 39.638439199576766, 39.54779031376043, 45.60504880795875, 45.618875725815684, 45.684580011914164, 36.77407458921273, 36.53363496561845, 35.96528485914071, 30.098677299916744, 29.827178739011288, 29.80674012005329, 35.8046677087744, 35.66902258743842, 35.750843075414494, 41.400661513830215, 41.25126121441522, 41.32608614737788, 37.725937992334366, 37.953024722635746, 37.89761561155319, 48.68994125165044, 48.6871065199375, 48.007300496101365, 18.894877442469195, 18.87486123417814, 18.702675280471638, 41.731257076064736, 41.6804026911656, 40.818088511625916, 38.66284616539875, 38.78805862988034, 38.71924370775619, 27.913852066422493, 27.527595872680337, 27.9307151424388, 2.6699794034163062, 2.880746624122054, 2.714523779849202, 47.95348519583543, 48.16067749758561, 47.63845970978339, 40.685722852746636, 40.60194010535875, 40.784086032460124, 43.86974196135998, 44.02265506982803, 44.49413709528744, 40.221398919820786, 40.21922629326582, 40.696415840357076, 43.081651203955204, 42.78619873772064, 42.954909237722546, 38.18404501117766, 38.12325698137283, 37.68072721362114, -90.23836263020834, -73.82090393950543, -74.09194119771323, 49.848045970002815, 50.37451446304719, 49.79375805954139, 41.81832065929969, 41.847277005513504, 41.51207639028628, 27.880267103513077, 28.967059602340058, 29.353923847277954, 46.35384042561054, 46.47056628763676, 47.026948974700645, 22.423013803859547, 22.54887221505244, 22.0255819906791, 40.699374737838895, 40.72080849359432, 39.77542097369829, 37.936226454873875, 38.11091554289062, 37.40080631275971, 38.66367085526386, 38.551999318102986, 38.54669571543732, 43.255162383119256, 43.50838317970434, 43.28408121565977, 39.03095699350038, 39.94655209154976, 39.41670137892166, 54.34334793190162, 54.03299891451995, 54.370070929328605, 45.898698846499116, 45.966574418048054, 45.60156149665514, 37.127448820198566, 37.15459331996195, 36.67746564994255, 34.658869011327624, 34.758270075544715, 34.430709928274155, 40.25217696775992, 40.45650165279706, 40.311013159652546, 40.50659877558549, 40.31424728532632, 40.580917786185935, 51.988362602889524, 52.272463504225, 52.13019885867833, 46.11000759899616, 46.75771242380142, 46.649190004915, 43.641764402389526, 43.81463534384966, 43.41520670056343, 35.021134470899895, 35.047517256190375, 34.70497780044873, 28.685802715520055, 28.78631682197252, 28.403299311796815, 42.42820106446743, 42.319111451506615, 42.557059563696384, 34.042158260941505, 34.02005151286721, 33.99280561506748, -87.90253992875418, -72.10056211551031, -71.88838593413433, 39.899816274642944, 40.09719109535217, 40.230014495551586, 25.39741540948549, 25.782339374224335, 25.19359196225801, 23.753039909526706, 23.569231748580933, 23.317032389342785, 43.079850755631924, 42.77687904238701, 42.24019733071327, 41.75011172890663, 41.40097297728062, 41.47343963384628, 41.56030760705471, 41.2531546279788, 40.88263826072216, 35.31755122899388, 35.261966160808996, 34.764655617376164, 42.41251276433468, 42.8018435460981, 42.09671804308891, 29.36195809300989, 29.257217071950436, 29.020476922392845, 31.256568610668182, 31.347833454608917, 31.292260132730007, 52.805135993907854, 52.95080267932887, 52.632068636516735, 46.28292331844568, 45.912964068353176, 46.42765730060637]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14158227432102696, "mean_inference_ms": 0.6954415830019599, "mean_action_processing_ms": 0.09586447605042699, "mean_env_wait_ms": 0.7903519629600688, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 720000, "timesteps_this_iter": 0, "agent_timesteps_total": 2160000, "timers": {"sample_time_ms": 10541.706, "sample_throughput": 474.307, "load_time_ms": 0.102, "load_throughput": 49010329.516, "learn_time_ms": 2022.809, "learn_throughput": 2471.81, "update_time_ms": 9.025}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.222237291452134e-36, "cur_lr": 0.0005000000000000001, "total_loss": 5.752209186553955, "policy_loss": 0.0009387994674098954, "vf_loss": 5.84991569519043, "vf_explained_var": -0.038043093681335446, "kl": 0.005254838406147931, "entropy": 9.864542579650879, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 720000, "num_agent_steps_sampled": 2160000, "num_steps_trained": 720000, "num_agent_steps_trained": 2160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2113, "training_iteration": 144, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-27-12", "timestamp": 1706232432, "time_this_iter_s": 10.78174901008606, "time_total_s": 1546.0131726264954, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402E088B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1546.0131726264954, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 5.6466666666666665, "ram_util_percent": 61.75333333333333}}
{"episode_reward_max": 162.74641777575002, "episode_reward_min": -303.1994125302881, "episode_reward_mean": 92.95161517640484, "episode_len_mean": 486.14, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -109.16718113422394}, "policy_reward_max": {"shared_policy": 54.370070929328605}, "policy_reward_mean": {"shared_policy": 30.98387172546829}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-303.1994125302881, 83.52716783585493, 141.98441110027483, 102.50034510041587, 149.82120734266908, 112.97435819962992, 80.40515379048884, -239.5863424800337, 132.92526140413253, 89.53199425898491, 139.85591719090007, 122.4228584244847, -296.1362987756729, 74.19125166721642, 137.99588149040943, 111.04732467327267, 136.0462535470723, 128.31319213286042, 126.16882505267856, 121.46910159848629, 156.57340302690855, 39.5711806663312, 131.97337436676003, 114.13621800858525, 100.11342062056063, 113.90759727358818, 108.31833931058645, 104.14087188243866, -223.8802601546049, 105.7675277981907, 111.07169938459992, 119.08682406321167, 95.57382511347531, 125.91711830347776, 118.84283803403375, 136.90850454568823, 109.27299441397189, 89.73259615898132, 107.22453337162732, 123.97800887562332, 113.5765783265233, 145.38434826768938, 56.472413957118974, 124.22974827885625, 116.17014850303528, 83.37216308154163, 8.265249807387562, 143.75262240320444, 122.07174899056551, 132.3865341264753, 121.13704105344368, 128.8227591793984, 113.98802920617163, -238.151207767427, 150.01631849259138, 125.17767405509947, 86.20125055313109, 139.851355687948, 66.99746800959109, 121.1956042051315, 113.44794831052421, 115.76236588880417, 130.04762677848333, 118.3942104639718, 162.74641777575002, 137.4668347612021, 110.95950779010306, 103.8478490151465, 121.01969178020953, 121.40176384709774, 156.39102496579284, 139.51691002771233, 130.87160644680262, 104.773629527539, 85.87541884928939, 127.30437207967043, 102.0550153888762, -231.89148797839883, 120.2270218655467, 76.37334674596784, 70.63930404745042, 128.0969271287322, 124.62452434003353, 123.69610049575567, 105.34417300717904, 127.31107435352169, 87.63965208735317, 93.8966621980071, 158.38800730975333, 138.62354468740523, 114.77228544620445, 149.29392079263928, 134.6330457683652, 113.17326779104768, 128.22584149241453, 90.52444141358137, 48.22108421288431, 130.38390654698017, 132.9513198323548, 146.72444585338218], "episode_lengths": [53, 500, 500, 500, 500, 500, 500, 281, 500, 500, 500, 500, 91, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 461, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 287, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 441, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-97.07115820795298, -96.96107318811119, -109.16718113422394, 28.44436051847879, 27.042333632707596, 28.04047368466854, 47.027305439114556, 47.48796140484045, 47.46914425631984, 33.75309191644192, 34.118182212114334, 34.62907097185962, 49.647291357318565, 50.16044664072494, 50.013469344625875, 37.938123836958155, 37.7392415938278, 37.296992768843964, 26.896764524281025, 27.19278414733708, 26.315605118870735, -76.38109737386307, -76.1298431394001, -87.0754019667705, 44.05523631473382, 44.34816542764504, 44.521859661753595, 30.074816744153694, 29.95257418354352, 29.504603331287697, 46.43214262028535, 46.52701026697953, 46.89676430363518, 40.86498276765147, 40.71704927335182, 40.840826383481414, -108.37670902411143, -93.81685181210439, -93.9427379394571, 24.830312337726355, 24.441387690603733, 24.919551638886333, 46.08130123962958, 45.93867112447818, 45.9759091263016, 37.126725227572024, 36.73610005527735, 37.1844993904233, 45.215592121084526, 45.3799885114034, 45.45067291458447, 42.910995211452246, 42.694633796811104, 42.70756312459707, 41.82405761877695, 42.16700460265079, 42.17776283125082, 40.36350903411706, 40.5382960413893, 40.56729652297993, 52.10965369393428, 51.985741933186844, 52.4780073997875, 13.456567572895437, 12.776961147785187, 13.337651945650578, 44.16740478078523, 43.92675646642843, 43.87921311954656, 38.4062093819181, 38.74375797777125, 36.98625064889589, 33.60262336333592, 33.37627826382716, 33.13451899339755, 38.02206200361252, 37.62497243285179, 38.26056283712387, 36.09808987751603, 36.02556270360947, 36.194686729460955, 34.770189836621284, 34.745650455355644, 34.62503159046173, -74.6025822609663, -74.66120622307062, -74.61647167056799, 35.22059553240736, 35.34598426831265, 35.20094799747069, 37.115206852555275, 36.55290810763836, 37.40358442440629, 39.31894349058469, 39.68094417949517, 40.08693639313181, 31.697492135067776, 31.961452086766556, 31.914880891640976, 41.944814547896385, 42.17380318790674, 41.79850056767464, 39.65660852069655, 39.638439199576766, 39.54779031376043, 45.60504880795875, 45.618875725815684, 45.684580011914164, 36.77407458921273, 36.53363496561845, 35.96528485914071, 30.098677299916744, 29.827178739011288, 29.80674012005329, 35.8046677087744, 35.66902258743842, 35.750843075414494, 41.400661513830215, 41.25126121441522, 41.32608614737788, 37.725937992334366, 37.953024722635746, 37.89761561155319, 48.68994125165044, 48.6871065199375, 48.007300496101365, 18.894877442469195, 18.87486123417814, 18.702675280471638, 41.731257076064736, 41.6804026911656, 40.818088511625916, 38.66284616539875, 38.78805862988034, 38.71924370775619, 27.913852066422493, 27.527595872680337, 27.9307151424388, 2.6699794034163062, 2.880746624122054, 2.714523779849202, 47.95348519583543, 48.16067749758561, 47.63845970978339, 40.685722852746636, 40.60194010535875, 40.784086032460124, 43.86974196135998, 44.02265506982803, 44.49413709528744, 40.221398919820786, 40.21922629326582, 40.696415840357076, 43.081651203955204, 42.78619873772064, 42.954909237722546, 38.18404501117766, 38.12325698137283, 37.68072721362114, -90.23836263020834, -73.82090393950543, -74.09194119771323, 49.848045970002815, 50.37451446304719, 49.79375805954139, 41.81832065929969, 41.847277005513504, 41.51207639028628, 27.880267103513077, 28.967059602340058, 29.353923847277954, 46.35384042561054, 46.47056628763676, 47.026948974700645, 22.423013803859547, 22.54887221505244, 22.0255819906791, 40.699374737838895, 40.72080849359432, 39.77542097369829, 37.936226454873875, 38.11091554289062, 37.40080631275971, 38.66367085526386, 38.551999318102986, 38.54669571543732, 43.255162383119256, 43.50838317970434, 43.28408121565977, 39.03095699350038, 39.94655209154976, 39.41670137892166, 54.34334793190162, 54.03299891451995, 54.370070929328605, 45.898698846499116, 45.966574418048054, 45.60156149665514, 37.127448820198566, 37.15459331996195, 36.67746564994255, 34.658869011327624, 34.758270075544715, 34.430709928274155, 40.25217696775992, 40.45650165279706, 40.311013159652546, 40.50659877558549, 40.31424728532632, 40.580917786185935, 51.988362602889524, 52.272463504225, 52.13019885867833, 46.11000759899616, 46.75771242380142, 46.649190004915, 43.641764402389526, 43.81463534384966, 43.41520670056343, 35.021134470899895, 35.047517256190375, 34.70497780044873, 28.685802715520055, 28.78631682197252, 28.403299311796815, 42.42820106446743, 42.319111451506615, 42.557059563696384, 34.042158260941505, 34.02005151286721, 33.99280561506748, -87.90253992875418, -72.10056211551031, -71.88838593413433, 39.899816274642944, 40.09719109535217, 40.230014495551586, 25.39741540948549, 25.782339374224335, 25.19359196225801, 23.753039909526706, 23.569231748580933, 23.317032389342785, 43.079850755631924, 42.77687904238701, 42.24019733071327, 41.75011172890663, 41.40097297728062, 41.47343963384628, 41.56030760705471, 41.2531546279788, 40.88263826072216, 35.31755122899388, 35.261966160808996, 34.764655617376164, 42.41251276433468, 42.8018435460981, 42.09671804308891, 29.36195809300989, 29.257217071950436, 29.020476922392845, 31.256568610668182, 31.347833454608917, 31.292260132730007, 52.805135993907854, 52.95080267932887, 52.632068636516735, 46.28292331844568, 45.912964068353176, 46.42765730060637, 38.24337244095901, 38.16931751618782, 38.359595489057625, 49.96599656964342, 49.50322370479505, 49.8247005182008, 45.10423139793177, 44.90752125283082, 44.62129311760266, 37.898270259921745, 37.5312009503444, 37.743796580781535, 43.14409190416336, 42.65910924971104, 42.42264033854008, 30.26561537757516, 29.934149757027626, 30.324676278978586, 16.065717950463295, 16.38190650008619, 15.773459762334824, 43.38903223971525, 43.15337953964868, 43.84149476761618, 44.14525049428144, 44.51073848331967, 44.295330854753644, 48.58140926063059, 48.930508784949765, 49.21252780780195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1415541588493917, "mean_inference_ms": 0.6954335663387939, "mean_action_processing_ms": 0.09585834667719738, "mean_env_wait_ms": 0.7901797017678328, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 725000, "timesteps_this_iter": 0, "agent_timesteps_total": 2175000, "timers": {"sample_time_ms": 10549.523, "sample_throughput": 473.955, "load_time_ms": 0.102, "load_throughput": 49010329.516, "learn_time_ms": 2022.652, "learn_throughput": 2472.002, "update_time_ms": 9.013}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.222237291452134e-36, "cur_lr": 0.0005000000000000001, "total_loss": 9.656065273284913, "policy_loss": 0.0013437570102958318, "vf_loss": 9.754961299896241, "vf_explained_var": -0.00925896167755127, "kl": 0.0072333623189906075, "entropy": 10.023960208892822, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 725000, "num_agent_steps_sampled": 2175000, "num_steps_trained": 725000, "num_agent_steps_trained": 2175000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2123, "training_iteration": 145, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-27-22", "timestamp": 1706232442, "time_this_iter_s": 10.408084869384766, "time_total_s": 1556.4212574958801, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401A7A790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1556.4212574958801, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 5.826666666666666, "ram_util_percent": 61.786666666666655}}
{"episode_reward_max": 162.74641777575002, "episode_reward_min": -296.1362987756729, "episode_reward_mean": 101.19716861949212, "episode_len_mean": 492.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -108.37670902411143}, "policy_reward_max": {"shared_policy": 54.370070929328605}, "policy_reward_mean": {"shared_policy": 33.73238953983071}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.85591719090007, 122.4228584244847, -296.1362987756729, 74.19125166721642, 137.99588149040943, 111.04732467327267, 136.0462535470723, 128.31319213286042, 126.16882505267856, 121.46910159848629, 156.57340302690855, 39.5711806663312, 131.97337436676003, 114.13621800858525, 100.11342062056063, 113.90759727358818, 108.31833931058645, 104.14087188243866, -223.8802601546049, 105.7675277981907, 111.07169938459992, 119.08682406321167, 95.57382511347531, 125.91711830347776, 118.84283803403375, 136.90850454568823, 109.27299441397189, 89.73259615898132, 107.22453337162732, 123.97800887562332, 113.5765783265233, 145.38434826768938, 56.472413957118974, 124.22974827885625, 116.17014850303528, 83.37216308154163, 8.265249807387562, 143.75262240320444, 122.07174899056551, 132.3865341264753, 121.13704105344368, 128.8227591793984, 113.98802920617163, -238.151207767427, 150.01631849259138, 125.17767405509947, 86.20125055313109, 139.851355687948, 66.99746800959109, 121.1956042051315, 113.44794831052421, 115.76236588880417, 130.04762677848333, 118.3942104639718, 162.74641777575002, 137.4668347612021, 110.95950779010306, 103.8478490151465, 121.01969178020953, 121.40176384709774, 156.39102496579284, 139.51691002771233, 130.87160644680262, 104.773629527539, 85.87541884928939, 127.30437207967043, 102.0550153888762, -231.89148797839883, 120.2270218655467, 76.37334674596784, 70.63930404745042, 128.0969271287322, 124.62452434003353, 123.69610049575567, 105.34417300717904, 127.31107435352169, 87.63965208735317, 93.8966621980071, 158.38800730975333, 138.62354468740523, 114.77228544620445, 149.29392079263928, 134.6330457683652, 113.17326779104768, 128.22584149241453, 90.52444141358137, 48.22108421288431, 130.38390654698017, 132.9513198323548, 146.72444585338218, 83.06399566680192, 122.38233834598212, 95.22738229483366, 125.46214329078794, 88.84310431219637, 134.73960977979016, 116.44149575009942, 146.4382644332944, 148.75055703334513, 114.0905974237248], "episode_lengths": [500, 500, 91, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 461, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 287, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 441, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [46.43214262028535, 46.52701026697953, 46.89676430363518, 40.86498276765147, 40.71704927335182, 40.840826383481414, -108.37670902411143, -93.81685181210439, -93.9427379394571, 24.830312337726355, 24.441387690603733, 24.919551638886333, 46.08130123962958, 45.93867112447818, 45.9759091263016, 37.126725227572024, 36.73610005527735, 37.1844993904233, 45.215592121084526, 45.3799885114034, 45.45067291458447, 42.910995211452246, 42.694633796811104, 42.70756312459707, 41.82405761877695, 42.16700460265079, 42.17776283125082, 40.36350903411706, 40.5382960413893, 40.56729652297993, 52.10965369393428, 51.985741933186844, 52.4780073997875, 13.456567572895437, 12.776961147785187, 13.337651945650578, 44.16740478078523, 43.92675646642843, 43.87921311954656, 38.4062093819181, 38.74375797777125, 36.98625064889589, 33.60262336333592, 33.37627826382716, 33.13451899339755, 38.02206200361252, 37.62497243285179, 38.26056283712387, 36.09808987751603, 36.02556270360947, 36.194686729460955, 34.770189836621284, 34.745650455355644, 34.62503159046173, -74.6025822609663, -74.66120622307062, -74.61647167056799, 35.22059553240736, 35.34598426831265, 35.20094799747069, 37.115206852555275, 36.55290810763836, 37.40358442440629, 39.31894349058469, 39.68094417949517, 40.08693639313181, 31.697492135067776, 31.961452086766556, 31.914880891640976, 41.944814547896385, 42.17380318790674, 41.79850056767464, 39.65660852069655, 39.638439199576766, 39.54779031376043, 45.60504880795875, 45.618875725815684, 45.684580011914164, 36.77407458921273, 36.53363496561845, 35.96528485914071, 30.098677299916744, 29.827178739011288, 29.80674012005329, 35.8046677087744, 35.66902258743842, 35.750843075414494, 41.400661513830215, 41.25126121441522, 41.32608614737788, 37.725937992334366, 37.953024722635746, 37.89761561155319, 48.68994125165044, 48.6871065199375, 48.007300496101365, 18.894877442469195, 18.87486123417814, 18.702675280471638, 41.731257076064736, 41.6804026911656, 40.818088511625916, 38.66284616539875, 38.78805862988034, 38.71924370775619, 27.913852066422493, 27.527595872680337, 27.9307151424388, 2.6699794034163062, 2.880746624122054, 2.714523779849202, 47.95348519583543, 48.16067749758561, 47.63845970978339, 40.685722852746636, 40.60194010535875, 40.784086032460124, 43.86974196135998, 44.02265506982803, 44.49413709528744, 40.221398919820786, 40.21922629326582, 40.696415840357076, 43.081651203955204, 42.78619873772064, 42.954909237722546, 38.18404501117766, 38.12325698137283, 37.68072721362114, -90.23836263020834, -73.82090393950543, -74.09194119771323, 49.848045970002815, 50.37451446304719, 49.79375805954139, 41.81832065929969, 41.847277005513504, 41.51207639028628, 27.880267103513077, 28.967059602340058, 29.353923847277954, 46.35384042561054, 46.47056628763676, 47.026948974700645, 22.423013803859547, 22.54887221505244, 22.0255819906791, 40.699374737838895, 40.72080849359432, 39.77542097369829, 37.936226454873875, 38.11091554289062, 37.40080631275971, 38.66367085526386, 38.551999318102986, 38.54669571543732, 43.255162383119256, 43.50838317970434, 43.28408121565977, 39.03095699350038, 39.94655209154976, 39.41670137892166, 54.34334793190162, 54.03299891451995, 54.370070929328605, 45.898698846499116, 45.966574418048054, 45.60156149665514, 37.127448820198566, 37.15459331996195, 36.67746564994255, 34.658869011327624, 34.758270075544715, 34.430709928274155, 40.25217696775992, 40.45650165279706, 40.311013159652546, 40.50659877558549, 40.31424728532632, 40.580917786185935, 51.988362602889524, 52.272463504225, 52.13019885867833, 46.11000759899616, 46.75771242380142, 46.649190004915, 43.641764402389526, 43.81463534384966, 43.41520670056343, 35.021134470899895, 35.047517256190375, 34.70497780044873, 28.685802715520055, 28.78631682197252, 28.403299311796815, 42.42820106446743, 42.319111451506615, 42.557059563696384, 34.042158260941505, 34.02005151286721, 33.99280561506748, -87.90253992875418, -72.10056211551031, -71.88838593413433, 39.899816274642944, 40.09719109535217, 40.230014495551586, 25.39741540948549, 25.782339374224335, 25.19359196225801, 23.753039909526706, 23.569231748580933, 23.317032389342785, 43.079850755631924, 42.77687904238701, 42.24019733071327, 41.75011172890663, 41.40097297728062, 41.47343963384628, 41.56030760705471, 41.2531546279788, 40.88263826072216, 35.31755122899388, 35.261966160808996, 34.764655617376164, 42.41251276433468, 42.8018435460981, 42.09671804308891, 29.36195809300989, 29.257217071950436, 29.020476922392845, 31.256568610668182, 31.347833454608917, 31.292260132730007, 52.805135993907854, 52.95080267932887, 52.632068636516735, 46.28292331844568, 45.912964068353176, 46.42765730060637, 38.24337244095901, 38.16931751618782, 38.359595489057625, 49.96599656964342, 49.50322370479505, 49.8247005182008, 45.10423139793177, 44.90752125283082, 44.62129311760266, 37.898270259921745, 37.5312009503444, 37.743796580781535, 43.14409190416336, 42.65910924971104, 42.42264033854008, 30.26561537757516, 29.934149757027626, 30.324676278978586, 16.065717950463295, 16.38190650008619, 15.773459762334824, 43.38903223971525, 43.15337953964868, 43.84149476761618, 44.14525049428144, 44.51073848331967, 44.295330854753644, 48.58140926063059, 48.930508784949765, 49.21252780780195, 27.591607352097824, 27.538155173261956, 27.934233141442135, 41.249416647789374, 40.890123066802815, 40.24279863138993, 31.879578568041325, 31.93569205701351, 31.412111669778824, 41.836058497428894, 42.07254933193326, 41.55353546142578, 29.885440746322274, 29.534558847546577, 29.423104718327522, 45.150590858732656, 44.950760876139, 44.63825804491837, 38.752987898886204, 38.776608884334564, 38.91189896687865, 48.59319876134394, 49.03717384859918, 48.80789182335137, 49.65030752122401, 49.76787569932638, 49.33237381279467, 37.68188900748888, 38.153693857292325, 38.2550145589436]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14150598836366454, "mean_inference_ms": 0.6954869099111022, "mean_action_processing_ms": 0.09584236797495363, "mean_env_wait_ms": 0.7900955819725293, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 730000, "timesteps_this_iter": 0, "agent_timesteps_total": 2190000, "timers": {"sample_time_ms": 10606.011, "sample_throughput": 471.431, "load_time_ms": 0.102, "load_throughput": 49010329.516, "learn_time_ms": 2018.641, "learn_throughput": 2476.914, "update_time_ms": 9.013}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.222237291452134e-36, "cur_lr": 0.0005000000000000001, "total_loss": 8.354523754119873, "policy_loss": 0.0008667680865084293, "vf_loss": 8.454068279266357, "vf_explained_var": -0.029561126232147218, "kl": 0.004690540744966078, "entropy": 10.041160774230956, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 730000, "num_agent_steps_sampled": 2190000, "num_steps_trained": 730000, "num_agent_steps_trained": 2190000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2133, "training_iteration": 146, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-27-33", "timestamp": 1706232453, "time_this_iter_s": 10.786026000976562, "time_total_s": 1567.2072834968567, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021400844040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1567.2072834968567, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 6.406666666666666, "ram_util_percent": 61.93333333333333}}
{"episode_reward_max": 162.74641777575002, "episode_reward_min": -238.151207767427, "episode_reward_mean": 106.237939728593, "episode_len_mean": 496.89, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -90.23836263020834}, "policy_reward_max": {"shared_policy": 54.370070929328605}, "policy_reward_mean": {"shared_policy": 35.41264657619768}, "custom_metrics": {}, "hist_stats": {"episode_reward": [156.57340302690855, 39.5711806663312, 131.97337436676003, 114.13621800858525, 100.11342062056063, 113.90759727358818, 108.31833931058645, 104.14087188243866, -223.8802601546049, 105.7675277981907, 111.07169938459992, 119.08682406321167, 95.57382511347531, 125.91711830347776, 118.84283803403375, 136.90850454568823, 109.27299441397189, 89.73259615898132, 107.22453337162732, 123.97800887562332, 113.5765783265233, 145.38434826768938, 56.472413957118974, 124.22974827885625, 116.17014850303528, 83.37216308154163, 8.265249807387562, 143.75262240320444, 122.07174899056551, 132.3865341264753, 121.13704105344368, 128.8227591793984, 113.98802920617163, -238.151207767427, 150.01631849259138, 125.17767405509947, 86.20125055313109, 139.851355687948, 66.99746800959109, 121.1956042051315, 113.44794831052421, 115.76236588880417, 130.04762677848333, 118.3942104639718, 162.74641777575002, 137.4668347612021, 110.95950779010306, 103.8478490151465, 121.01969178020953, 121.40176384709774, 156.39102496579284, 139.51691002771233, 130.87160644680262, 104.773629527539, 85.87541884928939, 127.30437207967043, 102.0550153888762, -231.89148797839883, 120.2270218655467, 76.37334674596784, 70.63930404745042, 128.0969271287322, 124.62452434003353, 123.69610049575567, 105.34417300717904, 127.31107435352169, 87.63965208735317, 93.8966621980071, 158.38800730975333, 138.62354468740523, 114.77228544620445, 149.29392079263928, 134.6330457683652, 113.17326779104768, 128.22584149241453, 90.52444141358137, 48.22108421288431, 130.38390654698017, 132.9513198323548, 146.72444585338218, 83.06399566680192, 122.38233834598212, 95.22738229483366, 125.46214329078794, 88.84310431219637, 134.73960977979016, 116.44149575009942, 146.4382644332944, 148.75055703334513, 114.0905974237248, 130.61748124659064, 130.3595157396048, 128.34620474651456, 116.90814207494257, 135.5260631851852, 148.39593432843662, 95.81441573798655, 127.26430328749117, 140.87533176690357, 151.3440257981417], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 461, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 287, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 441, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [52.10965369393428, 51.985741933186844, 52.4780073997875, 13.456567572895437, 12.776961147785187, 13.337651945650578, 44.16740478078523, 43.92675646642843, 43.87921311954656, 38.4062093819181, 38.74375797777125, 36.98625064889589, 33.60262336333592, 33.37627826382716, 33.13451899339755, 38.02206200361252, 37.62497243285179, 38.26056283712387, 36.09808987751603, 36.02556270360947, 36.194686729460955, 34.770189836621284, 34.745650455355644, 34.62503159046173, -74.6025822609663, -74.66120622307062, -74.61647167056799, 35.22059553240736, 35.34598426831265, 35.20094799747069, 37.115206852555275, 36.55290810763836, 37.40358442440629, 39.31894349058469, 39.68094417949517, 40.08693639313181, 31.697492135067776, 31.961452086766556, 31.914880891640976, 41.944814547896385, 42.17380318790674, 41.79850056767464, 39.65660852069655, 39.638439199576766, 39.54779031376043, 45.60504880795875, 45.618875725815684, 45.684580011914164, 36.77407458921273, 36.53363496561845, 35.96528485914071, 30.098677299916744, 29.827178739011288, 29.80674012005329, 35.8046677087744, 35.66902258743842, 35.750843075414494, 41.400661513830215, 41.25126121441522, 41.32608614737788, 37.725937992334366, 37.953024722635746, 37.89761561155319, 48.68994125165044, 48.6871065199375, 48.007300496101365, 18.894877442469195, 18.87486123417814, 18.702675280471638, 41.731257076064736, 41.6804026911656, 40.818088511625916, 38.66284616539875, 38.78805862988034, 38.71924370775619, 27.913852066422493, 27.527595872680337, 27.9307151424388, 2.6699794034163062, 2.880746624122054, 2.714523779849202, 47.95348519583543, 48.16067749758561, 47.63845970978339, 40.685722852746636, 40.60194010535875, 40.784086032460124, 43.86974196135998, 44.02265506982803, 44.49413709528744, 40.221398919820786, 40.21922629326582, 40.696415840357076, 43.081651203955204, 42.78619873772064, 42.954909237722546, 38.18404501117766, 38.12325698137283, 37.68072721362114, -90.23836263020834, -73.82090393950543, -74.09194119771323, 49.848045970002815, 50.37451446304719, 49.79375805954139, 41.81832065929969, 41.847277005513504, 41.51207639028628, 27.880267103513077, 28.967059602340058, 29.353923847277954, 46.35384042561054, 46.47056628763676, 47.026948974700645, 22.423013803859547, 22.54887221505244, 22.0255819906791, 40.699374737838895, 40.72080849359432, 39.77542097369829, 37.936226454873875, 38.11091554289062, 37.40080631275971, 38.66367085526386, 38.551999318102986, 38.54669571543732, 43.255162383119256, 43.50838317970434, 43.28408121565977, 39.03095699350038, 39.94655209154976, 39.41670137892166, 54.34334793190162, 54.03299891451995, 54.370070929328605, 45.898698846499116, 45.966574418048054, 45.60156149665514, 37.127448820198566, 37.15459331996195, 36.67746564994255, 34.658869011327624, 34.758270075544715, 34.430709928274155, 40.25217696775992, 40.45650165279706, 40.311013159652546, 40.50659877558549, 40.31424728532632, 40.580917786185935, 51.988362602889524, 52.272463504225, 52.13019885867833, 46.11000759899616, 46.75771242380142, 46.649190004915, 43.641764402389526, 43.81463534384966, 43.41520670056343, 35.021134470899895, 35.047517256190375, 34.70497780044873, 28.685802715520055, 28.78631682197252, 28.403299311796815, 42.42820106446743, 42.319111451506615, 42.557059563696384, 34.042158260941505, 34.02005151286721, 33.99280561506748, -87.90253992875418, -72.10056211551031, -71.88838593413433, 39.899816274642944, 40.09719109535217, 40.230014495551586, 25.39741540948549, 25.782339374224335, 25.19359196225801, 23.753039909526706, 23.569231748580933, 23.317032389342785, 43.079850755631924, 42.77687904238701, 42.24019733071327, 41.75011172890663, 41.40097297728062, 41.47343963384628, 41.56030760705471, 41.2531546279788, 40.88263826072216, 35.31755122899388, 35.261966160808996, 34.764655617376164, 42.41251276433468, 42.8018435460981, 42.09671804308891, 29.36195809300989, 29.257217071950436, 29.020476922392845, 31.256568610668182, 31.347833454608917, 31.292260132730007, 52.805135993907854, 52.95080267932887, 52.632068636516735, 46.28292331844568, 45.912964068353176, 46.42765730060637, 38.24337244095901, 38.16931751618782, 38.359595489057625, 49.96599656964342, 49.50322370479505, 49.8247005182008, 45.10423139793177, 44.90752125283082, 44.62129311760266, 37.898270259921745, 37.5312009503444, 37.743796580781535, 43.14409190416336, 42.65910924971104, 42.42264033854008, 30.26561537757516, 29.934149757027626, 30.324676278978586, 16.065717950463295, 16.38190650008619, 15.773459762334824, 43.38903223971525, 43.15337953964868, 43.84149476761618, 44.14525049428144, 44.51073848331967, 44.295330854753644, 48.58140926063059, 48.930508784949765, 49.21252780780195, 27.591607352097824, 27.538155173261956, 27.934233141442135, 41.249416647789374, 40.890123066802815, 40.24279863138993, 31.879578568041325, 31.93569205701351, 31.412111669778824, 41.836058497428894, 42.07254933193326, 41.55353546142578, 29.885440746322274, 29.534558847546577, 29.423104718327522, 45.150590858732656, 44.950760876139, 44.63825804491837, 38.752987898886204, 38.776608884334564, 38.91189896687865, 48.59319876134394, 49.03717384859918, 48.80789182335137, 49.65030752122401, 49.76787569932638, 49.33237381279467, 37.68188900748888, 38.153693857292325, 38.2550145589436, 42.98690865437189, 43.8148263717691, 43.8157462204496, 43.34127219269672, 43.4233067917327, 43.59493675517538, 42.394779190421104, 42.96496418863535, 42.986461367458105, 39.03465147813161, 38.780509417255715, 39.09298117955525, 45.160816207528114, 45.05272422730923, 45.31252275034785, 49.48031773169835, 49.38646992047627, 49.529146676262215, 31.948034924765423, 32.19193757822116, 31.67444323499997, 42.634421289588005, 42.27055319646993, 42.359328801433236, 46.804800656934574, 47.18413817634185, 46.886392933626965, 50.0977607667446, 50.50400989502667, 50.742255136370645]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14149096945125655, "mean_inference_ms": 0.6956935787762843, "mean_action_processing_ms": 0.09589633113138218, "mean_env_wait_ms": 0.7899613343536938, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 735000, "timesteps_this_iter": 0, "agent_timesteps_total": 2205000, "timers": {"sample_time_ms": 10650.693, "sample_throughput": 469.453, "load_time_ms": 0.102, "load_throughput": 49010329.516, "learn_time_ms": 2024.52, "learn_throughput": 2469.721, "update_time_ms": 9.113}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.611118645726067e-36, "cur_lr": 0.0005000000000000001, "total_loss": 8.453862476348878, "policy_loss": -7.50557155386744e-05, "vf_loss": 8.553420543670654, "vf_explained_var": -0.0025098323822021484, "kl": 0.004268672200893113, "entropy": 9.948304271697998, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 735000, "num_agent_steps_sampled": 2205000, "num_steps_trained": 735000, "num_agent_steps_trained": 2205000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2143, "training_iteration": 147, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-27-44", "timestamp": 1706232464, "time_this_iter_s": 11.177568912506104, "time_total_s": 1578.3848524093628, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402DE5B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1578.3848524093628, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 5.19375, "ram_util_percent": 62.1375}}
{"episode_reward_max": 177.16056297020967, "episode_reward_min": -238.151207767427, "episode_reward_mean": 111.23159182983595, "episode_len_mean": 497.28, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -90.23836263020834}, "policy_reward_max": {"shared_policy": 59.21396186249329}, "policy_reward_mean": {"shared_policy": 37.07719727661199}, "custom_metrics": {}, "hist_stats": {"episode_reward": [111.07169938459992, 119.08682406321167, 95.57382511347531, 125.91711830347776, 118.84283803403375, 136.90850454568823, 109.27299441397189, 89.73259615898132, 107.22453337162732, 123.97800887562332, 113.5765783265233, 145.38434826768938, 56.472413957118974, 124.22974827885625, 116.17014850303528, 83.37216308154163, 8.265249807387562, 143.75262240320444, 122.07174899056551, 132.3865341264753, 121.13704105344368, 128.8227591793984, 113.98802920617163, -238.151207767427, 150.01631849259138, 125.17767405509947, 86.20125055313109, 139.851355687948, 66.99746800959109, 121.1956042051315, 113.44794831052421, 115.76236588880417, 130.04762677848333, 118.3942104639718, 162.74641777575002, 137.4668347612021, 110.95950779010306, 103.8478490151465, 121.01969178020953, 121.40176384709774, 156.39102496579284, 139.51691002771233, 130.87160644680262, 104.773629527539, 85.87541884928939, 127.30437207967043, 102.0550153888762, -231.89148797839883, 120.2270218655467, 76.37334674596784, 70.63930404745042, 128.0969271287322, 124.62452434003353, 123.69610049575567, 105.34417300717904, 127.31107435352169, 87.63965208735317, 93.8966621980071, 158.38800730975333, 138.62354468740523, 114.77228544620445, 149.29392079263928, 134.6330457683652, 113.17326779104768, 128.22584149241453, 90.52444141358137, 48.22108421288431, 130.38390654698017, 132.9513198323548, 146.72444585338218, 83.06399566680192, 122.38233834598212, 95.22738229483366, 125.46214329078794, 88.84310431219637, 134.73960977979016, 116.44149575009942, 146.4382644332944, 148.75055703334513, 114.0905974237248, 130.61748124659064, 130.3595157396048, 128.34620474651456, 116.90814207494257, 135.5260631851852, 148.39593432843662, 95.81441573798655, 127.26430328749117, 140.87533176690357, 151.3440257981417, 101.66583557939157, 145.02412297111, 127.52829801663756, 145.52326996997016, 127.20814116671681, 78.21914334595203, 71.41574680432676, 132.21945872530335, 177.16056297020967, 144.0223033740185], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 287, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 441, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [37.115206852555275, 36.55290810763836, 37.40358442440629, 39.31894349058469, 39.68094417949517, 40.08693639313181, 31.697492135067776, 31.961452086766556, 31.914880891640976, 41.944814547896385, 42.17380318790674, 41.79850056767464, 39.65660852069655, 39.638439199576766, 39.54779031376043, 45.60504880795875, 45.618875725815684, 45.684580011914164, 36.77407458921273, 36.53363496561845, 35.96528485914071, 30.098677299916744, 29.827178739011288, 29.80674012005329, 35.8046677087744, 35.66902258743842, 35.750843075414494, 41.400661513830215, 41.25126121441522, 41.32608614737788, 37.725937992334366, 37.953024722635746, 37.89761561155319, 48.68994125165044, 48.6871065199375, 48.007300496101365, 18.894877442469195, 18.87486123417814, 18.702675280471638, 41.731257076064736, 41.6804026911656, 40.818088511625916, 38.66284616539875, 38.78805862988034, 38.71924370775619, 27.913852066422493, 27.527595872680337, 27.9307151424388, 2.6699794034163062, 2.880746624122054, 2.714523779849202, 47.95348519583543, 48.16067749758561, 47.63845970978339, 40.685722852746636, 40.60194010535875, 40.784086032460124, 43.86974196135998, 44.02265506982803, 44.49413709528744, 40.221398919820786, 40.21922629326582, 40.696415840357076, 43.081651203955204, 42.78619873772064, 42.954909237722546, 38.18404501117766, 38.12325698137283, 37.68072721362114, -90.23836263020834, -73.82090393950543, -74.09194119771323, 49.848045970002815, 50.37451446304719, 49.79375805954139, 41.81832065929969, 41.847277005513504, 41.51207639028628, 27.880267103513077, 28.967059602340058, 29.353923847277954, 46.35384042561054, 46.47056628763676, 47.026948974700645, 22.423013803859547, 22.54887221505244, 22.0255819906791, 40.699374737838895, 40.72080849359432, 39.77542097369829, 37.936226454873875, 38.11091554289062, 37.40080631275971, 38.66367085526386, 38.551999318102986, 38.54669571543732, 43.255162383119256, 43.50838317970434, 43.28408121565977, 39.03095699350038, 39.94655209154976, 39.41670137892166, 54.34334793190162, 54.03299891451995, 54.370070929328605, 45.898698846499116, 45.966574418048054, 45.60156149665514, 37.127448820198566, 37.15459331996195, 36.67746564994255, 34.658869011327624, 34.758270075544715, 34.430709928274155, 40.25217696775992, 40.45650165279706, 40.311013159652546, 40.50659877558549, 40.31424728532632, 40.580917786185935, 51.988362602889524, 52.272463504225, 52.13019885867833, 46.11000759899616, 46.75771242380142, 46.649190004915, 43.641764402389526, 43.81463534384966, 43.41520670056343, 35.021134470899895, 35.047517256190375, 34.70497780044873, 28.685802715520055, 28.78631682197252, 28.403299311796815, 42.42820106446743, 42.319111451506615, 42.557059563696384, 34.042158260941505, 34.02005151286721, 33.99280561506748, -87.90253992875418, -72.10056211551031, -71.88838593413433, 39.899816274642944, 40.09719109535217, 40.230014495551586, 25.39741540948549, 25.782339374224335, 25.19359196225801, 23.753039909526706, 23.569231748580933, 23.317032389342785, 43.079850755631924, 42.77687904238701, 42.24019733071327, 41.75011172890663, 41.40097297728062, 41.47343963384628, 41.56030760705471, 41.2531546279788, 40.88263826072216, 35.31755122899388, 35.261966160808996, 34.764655617376164, 42.41251276433468, 42.8018435460981, 42.09671804308891, 29.36195809300989, 29.257217071950436, 29.020476922392845, 31.256568610668182, 31.347833454608917, 31.292260132730007, 52.805135993907854, 52.95080267932887, 52.632068636516735, 46.28292331844568, 45.912964068353176, 46.42765730060637, 38.24337244095901, 38.16931751618782, 38.359595489057625, 49.96599656964342, 49.50322370479505, 49.8247005182008, 45.10423139793177, 44.90752125283082, 44.62129311760266, 37.898270259921745, 37.5312009503444, 37.743796580781535, 43.14409190416336, 42.65910924971104, 42.42264033854008, 30.26561537757516, 29.934149757027626, 30.324676278978586, 16.065717950463295, 16.38190650008619, 15.773459762334824, 43.38903223971525, 43.15337953964868, 43.84149476761618, 44.14525049428144, 44.51073848331967, 44.295330854753644, 48.58140926063059, 48.930508784949765, 49.21252780780195, 27.591607352097824, 27.538155173261956, 27.934233141442135, 41.249416647789374, 40.890123066802815, 40.24279863138993, 31.879578568041325, 31.93569205701351, 31.412111669778824, 41.836058497428894, 42.07254933193326, 41.55353546142578, 29.885440746322274, 29.534558847546577, 29.423104718327522, 45.150590858732656, 44.950760876139, 44.63825804491837, 38.752987898886204, 38.776608884334564, 38.91189896687865, 48.59319876134394, 49.03717384859918, 48.80789182335137, 49.65030752122401, 49.76787569932638, 49.33237381279467, 37.68188900748888, 38.153693857292325, 38.2550145589436, 42.98690865437189, 43.8148263717691, 43.8157462204496, 43.34127219269672, 43.4233067917327, 43.59493675517538, 42.394779190421104, 42.96496418863535, 42.986461367458105, 39.03465147813161, 38.780509417255715, 39.09298117955525, 45.160816207528114, 45.05272422730923, 45.31252275034785, 49.48031773169835, 49.38646992047627, 49.529146676262215, 31.948034924765423, 32.19193757822116, 31.67444323499997, 42.634421289588005, 42.27055319646993, 42.359328801433236, 46.804800656934574, 47.18413817634185, 46.886392933626965, 50.0977607667446, 50.50400989502667, 50.742255136370645, 33.70628114044666, 33.73104605078697, 34.228508388157934, 48.50875351205467, 47.866003602743135, 48.6493658563122, 42.76184241101146, 42.51189757883549, 42.25455802679062, 48.65019328643878, 48.224684593578175, 48.64839208995302, 42.14676280319691, 42.46933967620134, 42.59203868731856, 25.957155913114548, 26.124308673664927, 26.13767875917256, 24.072860949983195, 23.60414021213849, 23.738745642205075, 44.57588854556282, 43.8066487510999, 43.83692142864068, 58.95516842976211, 59.21396186249329, 58.99143267795442, 47.87373123814662, 47.91428407778342, 48.23428805808847]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14148086708764895, "mean_inference_ms": 0.6957391357755434, "mean_action_processing_ms": 0.0959009798080372, "mean_env_wait_ms": 0.7898325954201431, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 740000, "timesteps_this_iter": 0, "agent_timesteps_total": 2220000, "timers": {"sample_time_ms": 10654.899, "sample_throughput": 469.268, "load_time_ms": 0.102, "load_throughput": 49010329.516, "learn_time_ms": 2035.832, "learn_throughput": 2455.998, "update_time_ms": 9.089}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8055593228630335e-36, "cur_lr": 0.0005000000000000001, "total_loss": 8.042704486846924, "policy_loss": 0.0003934372181387147, "vf_loss": 8.143226146697998, "vf_explained_var": -0.004270708560943604, "kl": 0.00480012684133627, "entropy": 10.091482162475586, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 740000, "num_agent_steps_sampled": 2220000, "num_steps_trained": 740000, "num_agent_steps_trained": 2220000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2153, "training_iteration": 148, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-27-55", "timestamp": 1706232475, "time_this_iter_s": 10.831216812133789, "time_total_s": 1589.2160692214966, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402DF0820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1589.2160692214966, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 7.1866666666666665, "ram_util_percent": 62.22000000000001}}
{"episode_reward_max": 177.16056297020967, "episode_reward_min": -238.151207767427, "episode_reward_mean": 112.73756700361757, "episode_len_mean": 497.28, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -90.23836263020834}, "policy_reward_max": {"shared_policy": 59.21396186249329}, "policy_reward_mean": {"shared_policy": 37.57918900120585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [113.5765783265233, 145.38434826768938, 56.472413957118974, 124.22974827885625, 116.17014850303528, 83.37216308154163, 8.265249807387562, 143.75262240320444, 122.07174899056551, 132.3865341264753, 121.13704105344368, 128.8227591793984, 113.98802920617163, -238.151207767427, 150.01631849259138, 125.17767405509947, 86.20125055313109, 139.851355687948, 66.99746800959109, 121.1956042051315, 113.44794831052421, 115.76236588880417, 130.04762677848333, 118.3942104639718, 162.74641777575002, 137.4668347612021, 110.95950779010306, 103.8478490151465, 121.01969178020953, 121.40176384709774, 156.39102496579284, 139.51691002771233, 130.87160644680262, 104.773629527539, 85.87541884928939, 127.30437207967043, 102.0550153888762, -231.89148797839883, 120.2270218655467, 76.37334674596784, 70.63930404745042, 128.0969271287322, 124.62452434003353, 123.69610049575567, 105.34417300717904, 127.31107435352169, 87.63965208735317, 93.8966621980071, 158.38800730975333, 138.62354468740523, 114.77228544620445, 149.29392079263928, 134.6330457683652, 113.17326779104768, 128.22584149241453, 90.52444141358137, 48.22108421288431, 130.38390654698017, 132.9513198323548, 146.72444585338218, 83.06399566680192, 122.38233834598212, 95.22738229483366, 125.46214329078794, 88.84310431219637, 134.73960977979016, 116.44149575009942, 146.4382644332944, 148.75055703334513, 114.0905974237248, 130.61748124659064, 130.3595157396048, 128.34620474651456, 116.90814207494257, 135.5260631851852, 148.39593432843662, 95.81441573798655, 127.26430328749117, 140.87533176690357, 151.3440257981417, 101.66583557939157, 145.02412297111, 127.52829801663756, 145.52326996997016, 127.20814116671681, 78.21914334595203, 71.41574680432676, 132.21945872530335, 177.16056297020967, 144.0223033740185, 139.3294664863496, 122.44080320000646, 112.84873830527067, 166.1768071739936, 129.94275546818977, 81.71020007133481, 112.11539597064255, 135.07463781908143, 139.43943646177655, 149.12821868620804], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 287, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 441, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [37.725937992334366, 37.953024722635746, 37.89761561155319, 48.68994125165044, 48.6871065199375, 48.007300496101365, 18.894877442469195, 18.87486123417814, 18.702675280471638, 41.731257076064736, 41.6804026911656, 40.818088511625916, 38.66284616539875, 38.78805862988034, 38.71924370775619, 27.913852066422493, 27.527595872680337, 27.9307151424388, 2.6699794034163062, 2.880746624122054, 2.714523779849202, 47.95348519583543, 48.16067749758561, 47.63845970978339, 40.685722852746636, 40.60194010535875, 40.784086032460124, 43.86974196135998, 44.02265506982803, 44.49413709528744, 40.221398919820786, 40.21922629326582, 40.696415840357076, 43.081651203955204, 42.78619873772064, 42.954909237722546, 38.18404501117766, 38.12325698137283, 37.68072721362114, -90.23836263020834, -73.82090393950543, -74.09194119771323, 49.848045970002815, 50.37451446304719, 49.79375805954139, 41.81832065929969, 41.847277005513504, 41.51207639028628, 27.880267103513077, 28.967059602340058, 29.353923847277954, 46.35384042561054, 46.47056628763676, 47.026948974700645, 22.423013803859547, 22.54887221505244, 22.0255819906791, 40.699374737838895, 40.72080849359432, 39.77542097369829, 37.936226454873875, 38.11091554289062, 37.40080631275971, 38.66367085526386, 38.551999318102986, 38.54669571543732, 43.255162383119256, 43.50838317970434, 43.28408121565977, 39.03095699350038, 39.94655209154976, 39.41670137892166, 54.34334793190162, 54.03299891451995, 54.370070929328605, 45.898698846499116, 45.966574418048054, 45.60156149665514, 37.127448820198566, 37.15459331996195, 36.67746564994255, 34.658869011327624, 34.758270075544715, 34.430709928274155, 40.25217696775992, 40.45650165279706, 40.311013159652546, 40.50659877558549, 40.31424728532632, 40.580917786185935, 51.988362602889524, 52.272463504225, 52.13019885867833, 46.11000759899616, 46.75771242380142, 46.649190004915, 43.641764402389526, 43.81463534384966, 43.41520670056343, 35.021134470899895, 35.047517256190375, 34.70497780044873, 28.685802715520055, 28.78631682197252, 28.403299311796815, 42.42820106446743, 42.319111451506615, 42.557059563696384, 34.042158260941505, 34.02005151286721, 33.99280561506748, -87.90253992875418, -72.10056211551031, -71.88838593413433, 39.899816274642944, 40.09719109535217, 40.230014495551586, 25.39741540948549, 25.782339374224335, 25.19359196225801, 23.753039909526706, 23.569231748580933, 23.317032389342785, 43.079850755631924, 42.77687904238701, 42.24019733071327, 41.75011172890663, 41.40097297728062, 41.47343963384628, 41.56030760705471, 41.2531546279788, 40.88263826072216, 35.31755122899388, 35.261966160808996, 34.764655617376164, 42.41251276433468, 42.8018435460981, 42.09671804308891, 29.36195809300989, 29.257217071950436, 29.020476922392845, 31.256568610668182, 31.347833454608917, 31.292260132730007, 52.805135993907854, 52.95080267932887, 52.632068636516735, 46.28292331844568, 45.912964068353176, 46.42765730060637, 38.24337244095901, 38.16931751618782, 38.359595489057625, 49.96599656964342, 49.50322370479505, 49.8247005182008, 45.10423139793177, 44.90752125283082, 44.62129311760266, 37.898270259921745, 37.5312009503444, 37.743796580781535, 43.14409190416336, 42.65910924971104, 42.42264033854008, 30.26561537757516, 29.934149757027626, 30.324676278978586, 16.065717950463295, 16.38190650008619, 15.773459762334824, 43.38903223971525, 43.15337953964868, 43.84149476761618, 44.14525049428144, 44.51073848331967, 44.295330854753644, 48.58140926063059, 48.930508784949765, 49.21252780780195, 27.591607352097824, 27.538155173261956, 27.934233141442135, 41.249416647789374, 40.890123066802815, 40.24279863138993, 31.879578568041325, 31.93569205701351, 31.412111669778824, 41.836058497428894, 42.07254933193326, 41.55353546142578, 29.885440746322274, 29.534558847546577, 29.423104718327522, 45.150590858732656, 44.950760876139, 44.63825804491837, 38.752987898886204, 38.776608884334564, 38.91189896687865, 48.59319876134394, 49.03717384859918, 48.80789182335137, 49.65030752122401, 49.76787569932638, 49.33237381279467, 37.68188900748888, 38.153693857292325, 38.2550145589436, 42.98690865437189, 43.8148263717691, 43.8157462204496, 43.34127219269672, 43.4233067917327, 43.59493675517538, 42.394779190421104, 42.96496418863535, 42.986461367458105, 39.03465147813161, 38.780509417255715, 39.09298117955525, 45.160816207528114, 45.05272422730923, 45.31252275034785, 49.48031773169835, 49.38646992047627, 49.529146676262215, 31.948034924765423, 32.19193757822116, 31.67444323499997, 42.634421289588005, 42.27055319646993, 42.359328801433236, 46.804800656934574, 47.18413817634185, 46.886392933626965, 50.0977607667446, 50.50400989502667, 50.742255136370645, 33.70628114044666, 33.73104605078697, 34.228508388157934, 48.50875351205467, 47.866003602743135, 48.6493658563122, 42.76184241101146, 42.51189757883549, 42.25455802679062, 48.65019328643878, 48.224684593578175, 48.64839208995302, 42.14676280319691, 42.46933967620134, 42.59203868731856, 25.957155913114548, 26.124308673664927, 26.13767875917256, 24.072860949983195, 23.60414021213849, 23.738745642205075, 44.57588854556282, 43.8066487510999, 43.83692142864068, 58.95516842976211, 59.21396186249329, 58.99143267795442, 47.87373123814662, 47.91428407778342, 48.23428805808847, 46.62397447414696, 46.23129351437092, 46.47419849783182, 40.65811468909183, 40.883268971617014, 40.89941953929761, 37.78093383461237, 37.572170466184616, 37.495634004473686, 55.284723671774074, 55.665686849659934, 55.226396652559444, 42.649634912610054, 43.643495965749025, 43.64962458983064, 26.906683589021355, 27.48059708128372, 27.322919401029736, 37.178666320939854, 37.47736581539114, 37.45936383431156, 45.09103524436553, 45.247869686534, 44.735732888182, 46.71563261623183, 46.31030637274185, 46.41349747280279, 49.847852637991295, 49.705592118203626, 49.574773930013166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1414933437725237, "mean_inference_ms": 0.6958665062059572, "mean_action_processing_ms": 0.0959228621471847, "mean_env_wait_ms": 0.7897602857061107, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 745000, "timesteps_this_iter": 0, "agent_timesteps_total": 2235000, "timers": {"sample_time_ms": 10800.99, "sample_throughput": 462.921, "load_time_ms": 0.102, "load_throughput": 49010329.516, "learn_time_ms": 2043.085, "learn_throughput": 2447.28, "update_time_ms": 9.263}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.027796614315168e-37, "cur_lr": 0.0005000000000000001, "total_loss": 6.989385890960693, "policy_loss": 0.001273787436330842, "vf_loss": 7.088385009765625, "vf_explained_var": -0.08390361070632935, "kl": 0.004218752891800693, "entropy": 10.027301502227782, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 745000, "num_agent_steps_sampled": 2235000, "num_steps_trained": 745000, "num_agent_steps_trained": 2235000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2163, "training_iteration": 149, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-28-07", "timestamp": 1706232487, "time_this_iter_s": 12.380001783370972, "time_total_s": 1601.5960710048676, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140250DF70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1601.5960710048676, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 8.155555555555557, "ram_util_percent": 62.411111111111104}}
{"episode_reward_max": 177.16056297020967, "episode_reward_min": -238.151207767427, "episode_reward_mean": 114.54208110975014, "episode_len_mean": 497.28, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -90.23836263020834}, "policy_reward_max": {"shared_policy": 59.21396186249329}, "policy_reward_mean": {"shared_policy": 38.18069370325005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [121.13704105344368, 128.8227591793984, 113.98802920617163, -238.151207767427, 150.01631849259138, 125.17767405509947, 86.20125055313109, 139.851355687948, 66.99746800959109, 121.1956042051315, 113.44794831052421, 115.76236588880417, 130.04762677848333, 118.3942104639718, 162.74641777575002, 137.4668347612021, 110.95950779010306, 103.8478490151465, 121.01969178020953, 121.40176384709774, 156.39102496579284, 139.51691002771233, 130.87160644680262, 104.773629527539, 85.87541884928939, 127.30437207967043, 102.0550153888762, -231.89148797839883, 120.2270218655467, 76.37334674596784, 70.63930404745042, 128.0969271287322, 124.62452434003353, 123.69610049575567, 105.34417300717904, 127.31107435352169, 87.63965208735317, 93.8966621980071, 158.38800730975333, 138.62354468740523, 114.77228544620445, 149.29392079263928, 134.6330457683652, 113.17326779104768, 128.22584149241453, 90.52444141358137, 48.22108421288431, 130.38390654698017, 132.9513198323548, 146.72444585338218, 83.06399566680192, 122.38233834598212, 95.22738229483366, 125.46214329078794, 88.84310431219637, 134.73960977979016, 116.44149575009942, 146.4382644332944, 148.75055703334513, 114.0905974237248, 130.61748124659064, 130.3595157396048, 128.34620474651456, 116.90814207494257, 135.5260631851852, 148.39593432843662, 95.81441573798655, 127.26430328749117, 140.87533176690357, 151.3440257981417, 101.66583557939157, 145.02412297111, 127.52829801663756, 145.52326996997016, 127.20814116671681, 78.21914334595203, 71.41574680432676, 132.21945872530335, 177.16056297020967, 144.0223033740185, 139.3294664863496, 122.44080320000646, 112.84873830527067, 166.1768071739936, 129.94275546818977, 81.71020007133481, 112.11539597064255, 135.07463781908143, 139.43943646177655, 149.12821868620804, 81.1745581086725, 117.50501052243635, 128.5832016430795, 127.21619920060037, 131.27307688421573, 134.3879014104608, 132.13676774874332, 116.15150114148855, 126.37737348675726, 131.32737620919912], "episode_lengths": [500, 500, 500, 287, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 441, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [40.221398919820786, 40.21922629326582, 40.696415840357076, 43.081651203955204, 42.78619873772064, 42.954909237722546, 38.18404501117766, 38.12325698137283, 37.68072721362114, -90.23836263020834, -73.82090393950543, -74.09194119771323, 49.848045970002815, 50.37451446304719, 49.79375805954139, 41.81832065929969, 41.847277005513504, 41.51207639028628, 27.880267103513077, 28.967059602340058, 29.353923847277954, 46.35384042561054, 46.47056628763676, 47.026948974700645, 22.423013803859547, 22.54887221505244, 22.0255819906791, 40.699374737838895, 40.72080849359432, 39.77542097369829, 37.936226454873875, 38.11091554289062, 37.40080631275971, 38.66367085526386, 38.551999318102986, 38.54669571543732, 43.255162383119256, 43.50838317970434, 43.28408121565977, 39.03095699350038, 39.94655209154976, 39.41670137892166, 54.34334793190162, 54.03299891451995, 54.370070929328605, 45.898698846499116, 45.966574418048054, 45.60156149665514, 37.127448820198566, 37.15459331996195, 36.67746564994255, 34.658869011327624, 34.758270075544715, 34.430709928274155, 40.25217696775992, 40.45650165279706, 40.311013159652546, 40.50659877558549, 40.31424728532632, 40.580917786185935, 51.988362602889524, 52.272463504225, 52.13019885867833, 46.11000759899616, 46.75771242380142, 46.649190004915, 43.641764402389526, 43.81463534384966, 43.41520670056343, 35.021134470899895, 35.047517256190375, 34.70497780044873, 28.685802715520055, 28.78631682197252, 28.403299311796815, 42.42820106446743, 42.319111451506615, 42.557059563696384, 34.042158260941505, 34.02005151286721, 33.99280561506748, -87.90253992875418, -72.10056211551031, -71.88838593413433, 39.899816274642944, 40.09719109535217, 40.230014495551586, 25.39741540948549, 25.782339374224335, 25.19359196225801, 23.753039909526706, 23.569231748580933, 23.317032389342785, 43.079850755631924, 42.77687904238701, 42.24019733071327, 41.75011172890663, 41.40097297728062, 41.47343963384628, 41.56030760705471, 41.2531546279788, 40.88263826072216, 35.31755122899388, 35.261966160808996, 34.764655617376164, 42.41251276433468, 42.8018435460981, 42.09671804308891, 29.36195809300989, 29.257217071950436, 29.020476922392845, 31.256568610668182, 31.347833454608917, 31.292260132730007, 52.805135993907854, 52.95080267932887, 52.632068636516735, 46.28292331844568, 45.912964068353176, 46.42765730060637, 38.24337244095901, 38.16931751618782, 38.359595489057625, 49.96599656964342, 49.50322370479505, 49.8247005182008, 45.10423139793177, 44.90752125283082, 44.62129311760266, 37.898270259921745, 37.5312009503444, 37.743796580781535, 43.14409190416336, 42.65910924971104, 42.42264033854008, 30.26561537757516, 29.934149757027626, 30.324676278978586, 16.065717950463295, 16.38190650008619, 15.773459762334824, 43.38903223971525, 43.15337953964868, 43.84149476761618, 44.14525049428144, 44.51073848331967, 44.295330854753644, 48.58140926063059, 48.930508784949765, 49.21252780780195, 27.591607352097824, 27.538155173261956, 27.934233141442135, 41.249416647789374, 40.890123066802815, 40.24279863138993, 31.879578568041325, 31.93569205701351, 31.412111669778824, 41.836058497428894, 42.07254933193326, 41.55353546142578, 29.885440746322274, 29.534558847546577, 29.423104718327522, 45.150590858732656, 44.950760876139, 44.63825804491837, 38.752987898886204, 38.776608884334564, 38.91189896687865, 48.59319876134394, 49.03717384859918, 48.80789182335137, 49.65030752122401, 49.76787569932638, 49.33237381279467, 37.68188900748888, 38.153693857292325, 38.2550145589436, 42.98690865437189, 43.8148263717691, 43.8157462204496, 43.34127219269672, 43.4233067917327, 43.59493675517538, 42.394779190421104, 42.96496418863535, 42.986461367458105, 39.03465147813161, 38.780509417255715, 39.09298117955525, 45.160816207528114, 45.05272422730923, 45.31252275034785, 49.48031773169835, 49.38646992047627, 49.529146676262215, 31.948034924765423, 32.19193757822116, 31.67444323499997, 42.634421289588005, 42.27055319646993, 42.359328801433236, 46.804800656934574, 47.18413817634185, 46.886392933626965, 50.0977607667446, 50.50400989502667, 50.742255136370645, 33.70628114044666, 33.73104605078697, 34.228508388157934, 48.50875351205467, 47.866003602743135, 48.6493658563122, 42.76184241101146, 42.51189757883549, 42.25455802679062, 48.65019328643878, 48.224684593578175, 48.64839208995302, 42.14676280319691, 42.46933967620134, 42.59203868731856, 25.957155913114548, 26.124308673664927, 26.13767875917256, 24.072860949983195, 23.60414021213849, 23.738745642205075, 44.57588854556282, 43.8066487510999, 43.83692142864068, 58.95516842976211, 59.21396186249329, 58.99143267795442, 47.87373123814662, 47.91428407778342, 48.23428805808847, 46.62397447414696, 46.23129351437092, 46.47419849783182, 40.65811468909183, 40.883268971617014, 40.89941953929761, 37.78093383461237, 37.572170466184616, 37.495634004473686, 55.284723671774074, 55.665686849659934, 55.226396652559444, 42.649634912610054, 43.643495965749025, 43.64962458983064, 26.906683589021355, 27.48059708128372, 27.322919401029736, 37.178666320939854, 37.47736581539114, 37.45936383431156, 45.09103524436553, 45.247869686534, 44.735732888182, 46.71563261623183, 46.31030637274185, 46.41349747280279, 49.847852637991295, 49.705592118203626, 49.574773930013166, 27.163626581430435, 26.79157766699791, 27.219353860244155, 39.093348011374474, 38.97004306316376, 39.44161944789812, 43.05461924771467, 43.00556862975159, 42.52301376561323, 42.51306378965576, 42.16094474991162, 42.54219066103299, 44.150244085506216, 43.94271585221091, 43.18011694649854, 44.90587445100148, 44.885406514008835, 44.59662044545014, 44.02335104222098, 44.0764119165639, 44.03700478995839, 38.855819173157215, 38.84642916917801, 38.44925279915333, 42.146099408467606, 42.05079061289628, 42.18048346539338, 44.10042154043913, 43.51418985426426, 43.71276481449604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14152136863698547, "mean_inference_ms": 0.696062713691874, "mean_action_processing_ms": 0.0959500723662966, "mean_env_wait_ms": 0.7897361946829637, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 750000, "timesteps_this_iter": 0, "agent_timesteps_total": 2250000, "timers": {"sample_time_ms": 10909.299, "sample_throughput": 458.325, "load_time_ms": 0.102, "load_throughput": 49010329.516, "learn_time_ms": 2050.599, "learn_throughput": 2438.312, "update_time_ms": 9.263}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.513898307157584e-37, "cur_lr": 0.0005000000000000001, "total_loss": 8.357202339172364, "policy_loss": 0.0003590739144378574, "vf_loss": 8.455521392822266, "vf_explained_var": -0.021946442127227784, "kl": 0.004498762846966246, "entropy": 9.867779350280761, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 750000, "num_agent_steps_sampled": 2250000, "num_steps_trained": 750000, "num_agent_steps_trained": 2250000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 149.18046981655078, "episode_reward_min": -294.3256338927895, "episode_reward_mean": 83.36725075989959, "episode_len_mean": 462.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -111.87275417645773}, "policy_reward_max": {"shared_policy": 49.888967041547104}, "policy_reward_mean": {"shared_policy": 27.789083586633197}, "custom_metrics": {}, "hist_stats": {"episode_reward": [149.18046981655078, 112.05713931471107, 145.70737112686027, 113.35581229440865, 113.06454349309205, 141.51011491566882, -294.3256338927895, 114.98271322250366, 112.22102472931144, 125.91895257867873], "episode_lengths": [500, 500, 500, 500, 500, 500, 120, 500, 500, 500], "policy_shared_policy_reward": [49.63277308146159, 49.888967041547104, 49.65872969354193, 37.21697318057218, 37.64343849072853, 37.196727643410355, 48.777565119167164, 48.629067727675036, 48.300738280018166, 38.02542793999115, 36.96088797847429, 38.369496375943214, 37.17149545749028, 37.898596612115696, 37.99445142348607, 47.06306352714698, 47.088279085854694, 47.358772302667305, -91.0887137943258, -91.36416592200598, -111.87275417645773, 38.27217682078481, 38.52273675426841, 38.18779964745045, 37.47466098020473, 37.36721258113781, 37.3791511679689, 42.07434524409473, 41.86793004721403, 41.97667728736997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13216670005312894, "mean_inference_ms": 0.7187009652676466, "mean_action_processing_ms": 0.0997229429310181, "mean_env_wait_ms": 0.798277737001937, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 2173, "training_iteration": 150, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-28-26", "timestamp": 1706232506, "time_this_iter_s": 19.15373969078064, "time_total_s": 1620.7498106956482, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214018EEF70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1620.7498106956482, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 7.977777777777778, "ram_util_percent": 62.407407407407405}}
{"episode_reward_max": 177.16056297020967, "episode_reward_min": -231.89148797839883, "episode_reward_mean": 118.4937544112114, "episode_len_mean": 499.41, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -87.90253992875418}, "policy_reward_max": {"shared_policy": 59.21396186249329}, "policy_reward_mean": {"shared_policy": 39.497918137070464}, "custom_metrics": {}, "hist_stats": {"episode_reward": [113.44794831052421, 115.76236588880417, 130.04762677848333, 118.3942104639718, 162.74641777575002, 137.4668347612021, 110.95950779010306, 103.8478490151465, 121.01969178020953, 121.40176384709774, 156.39102496579284, 139.51691002771233, 130.87160644680262, 104.773629527539, 85.87541884928939, 127.30437207967043, 102.0550153888762, -231.89148797839883, 120.2270218655467, 76.37334674596784, 70.63930404745042, 128.0969271287322, 124.62452434003353, 123.69610049575567, 105.34417300717904, 127.31107435352169, 87.63965208735317, 93.8966621980071, 158.38800730975333, 138.62354468740523, 114.77228544620445, 149.29392079263928, 134.6330457683652, 113.17326779104768, 128.22584149241453, 90.52444141358137, 48.22108421288431, 130.38390654698017, 132.9513198323548, 146.72444585338218, 83.06399566680192, 122.38233834598212, 95.22738229483366, 125.46214329078794, 88.84310431219637, 134.73960977979016, 116.44149575009942, 146.4382644332944, 148.75055703334513, 114.0905974237248, 130.61748124659064, 130.3595157396048, 128.34620474651456, 116.90814207494257, 135.5260631851852, 148.39593432843662, 95.81441573798655, 127.26430328749117, 140.87533176690357, 151.3440257981417, 101.66583557939157, 145.02412297111, 127.52829801663756, 145.52326996997016, 127.20814116671681, 78.21914334595203, 71.41574680432676, 132.21945872530335, 177.16056297020967, 144.0223033740185, 139.3294664863496, 122.44080320000646, 112.84873830527067, 166.1768071739936, 129.94275546818977, 81.71020007133481, 112.11539597064255, 135.07463781908143, 139.43943646177655, 149.12821868620804, 81.1745581086725, 117.50501052243635, 128.5832016430795, 127.21619920060037, 131.27307688421573, 134.3879014104608, 132.13676774874332, 116.15150114148855, 126.37737348675726, 131.32737620919912, 127.43587940931319, 106.98706471547483, 101.55131395277564, 76.6385534442961, 163.2835091575979, 136.71905034594232, 148.20747021678827, 119.24144928902386, 107.40102516859767, 122.93830712139604], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 441, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [37.936226454873875, 38.11091554289062, 37.40080631275971, 38.66367085526386, 38.551999318102986, 38.54669571543732, 43.255162383119256, 43.50838317970434, 43.28408121565977, 39.03095699350038, 39.94655209154976, 39.41670137892166, 54.34334793190162, 54.03299891451995, 54.370070929328605, 45.898698846499116, 45.966574418048054, 45.60156149665514, 37.127448820198566, 37.15459331996195, 36.67746564994255, 34.658869011327624, 34.758270075544715, 34.430709928274155, 40.25217696775992, 40.45650165279706, 40.311013159652546, 40.50659877558549, 40.31424728532632, 40.580917786185935, 51.988362602889524, 52.272463504225, 52.13019885867833, 46.11000759899616, 46.75771242380142, 46.649190004915, 43.641764402389526, 43.81463534384966, 43.41520670056343, 35.021134470899895, 35.047517256190375, 34.70497780044873, 28.685802715520055, 28.78631682197252, 28.403299311796815, 42.42820106446743, 42.319111451506615, 42.557059563696384, 34.042158260941505, 34.02005151286721, 33.99280561506748, -87.90253992875418, -72.10056211551031, -71.88838593413433, 39.899816274642944, 40.09719109535217, 40.230014495551586, 25.39741540948549, 25.782339374224335, 25.19359196225801, 23.753039909526706, 23.569231748580933, 23.317032389342785, 43.079850755631924, 42.77687904238701, 42.24019733071327, 41.75011172890663, 41.40097297728062, 41.47343963384628, 41.56030760705471, 41.2531546279788, 40.88263826072216, 35.31755122899388, 35.261966160808996, 34.764655617376164, 42.41251276433468, 42.8018435460981, 42.09671804308891, 29.36195809300989, 29.257217071950436, 29.020476922392845, 31.256568610668182, 31.347833454608917, 31.292260132730007, 52.805135993907854, 52.95080267932887, 52.632068636516735, 46.28292331844568, 45.912964068353176, 46.42765730060637, 38.24337244095901, 38.16931751618782, 38.359595489057625, 49.96599656964342, 49.50322370479505, 49.8247005182008, 45.10423139793177, 44.90752125283082, 44.62129311760266, 37.898270259921745, 37.5312009503444, 37.743796580781535, 43.14409190416336, 42.65910924971104, 42.42264033854008, 30.26561537757516, 29.934149757027626, 30.324676278978586, 16.065717950463295, 16.38190650008619, 15.773459762334824, 43.38903223971525, 43.15337953964868, 43.84149476761618, 44.14525049428144, 44.51073848331967, 44.295330854753644, 48.58140926063059, 48.930508784949765, 49.21252780780195, 27.591607352097824, 27.538155173261956, 27.934233141442135, 41.249416647789374, 40.890123066802815, 40.24279863138993, 31.879578568041325, 31.93569205701351, 31.412111669778824, 41.836058497428894, 42.07254933193326, 41.55353546142578, 29.885440746322274, 29.534558847546577, 29.423104718327522, 45.150590858732656, 44.950760876139, 44.63825804491837, 38.752987898886204, 38.776608884334564, 38.91189896687865, 48.59319876134394, 49.03717384859918, 48.80789182335137, 49.65030752122401, 49.76787569932638, 49.33237381279467, 37.68188900748888, 38.153693857292325, 38.2550145589436, 42.98690865437189, 43.8148263717691, 43.8157462204496, 43.34127219269672, 43.4233067917327, 43.59493675517538, 42.394779190421104, 42.96496418863535, 42.986461367458105, 39.03465147813161, 38.780509417255715, 39.09298117955525, 45.160816207528114, 45.05272422730923, 45.31252275034785, 49.48031773169835, 49.38646992047627, 49.529146676262215, 31.948034924765423, 32.19193757822116, 31.67444323499997, 42.634421289588005, 42.27055319646993, 42.359328801433236, 46.804800656934574, 47.18413817634185, 46.886392933626965, 50.0977607667446, 50.50400989502667, 50.742255136370645, 33.70628114044666, 33.73104605078697, 34.228508388157934, 48.50875351205467, 47.866003602743135, 48.6493658563122, 42.76184241101146, 42.51189757883549, 42.25455802679062, 48.65019328643878, 48.224684593578175, 48.64839208995302, 42.14676280319691, 42.46933967620134, 42.59203868731856, 25.957155913114548, 26.124308673664927, 26.13767875917256, 24.072860949983195, 23.60414021213849, 23.738745642205075, 44.57588854556282, 43.8066487510999, 43.83692142864068, 58.95516842976211, 59.21396186249329, 58.99143267795442, 47.87373123814662, 47.91428407778342, 48.23428805808847, 46.62397447414696, 46.23129351437092, 46.47419849783182, 40.65811468909183, 40.883268971617014, 40.89941953929761, 37.78093383461237, 37.572170466184616, 37.495634004473686, 55.284723671774074, 55.665686849659934, 55.226396652559444, 42.649634912610054, 43.643495965749025, 43.64962458983064, 26.906683589021355, 27.48059708128372, 27.322919401029736, 37.178666320939854, 37.47736581539114, 37.45936383431156, 45.09103524436553, 45.247869686534, 44.735732888182, 46.71563261623183, 46.31030637274185, 46.41349747280279, 49.847852637991295, 49.705592118203626, 49.574773930013166, 27.163626581430435, 26.79157766699791, 27.219353860244155, 39.093348011374474, 38.97004306316376, 39.44161944789812, 43.05461924771467, 43.00556862975159, 42.52301376561323, 42.51306378965576, 42.16094474991162, 42.54219066103299, 44.150244085506216, 43.94271585221091, 43.18011694649854, 44.90587445100148, 44.885406514008835, 44.59662044545014, 44.02335104222098, 44.0764119165639, 44.03700478995839, 38.855819173157215, 38.84642916917801, 38.44925279915333, 42.146099408467606, 42.05079061289628, 42.18048346539338, 44.10042154043913, 43.51418985426426, 43.71276481449604, 42.65470163275798, 42.32450825472672, 42.45666952182849, 35.598347426702574, 35.768924334396914, 35.61979295437534, 34.13135992890844, 33.26764152447382, 34.15231249939339, 25.644918675223977, 25.267602796355874, 25.726031972716243, 54.240887100497886, 54.67795287321012, 54.36466918389003, 45.636503803233296, 45.37692728887001, 45.705619253839046, 49.357755685846016, 49.183882604042694, 49.665831926899656, 39.739514277627066, 39.86331848924358, 39.638616522153214, 35.84008503208557, 35.69996278236309, 35.860977354149014, 41.12845760087171, 41.00232798854509, 40.80752153197923]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14155588268789993, "mean_inference_ms": 0.696255854332212, "mean_action_processing_ms": 0.09597417039313026, "mean_env_wait_ms": 0.7897091115680799, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 755000, "timesteps_this_iter": 0, "agent_timesteps_total": 2265000, "timers": {"sample_time_ms": 11705.444, "sample_throughput": 427.152, "load_time_ms": 0.102, "load_throughput": 49010329.516, "learn_time_ms": 2058.179, "learn_throughput": 2429.332, "update_time_ms": 9.258}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.256949153578792e-37, "cur_lr": 0.0005000000000000001, "total_loss": 7.629259443283081, "policy_loss": -0.0005460693729979482, "vf_loss": 7.728257703781128, "vf_explained_var": 0.004233396053314209, "kl": 0.0025455010356804407, "entropy": 9.845234775543213, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 755000, "num_agent_steps_sampled": 2265000, "num_steps_trained": 755000, "num_agent_steps_trained": 2265000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2183, "training_iteration": 151, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-28-37", "timestamp": 1706232517, "time_this_iter_s": 10.409368753433228, "time_total_s": 1631.1591794490814, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140234D790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1631.1591794490814, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 6.333333333333333, "ram_util_percent": 62.113333333333344}}
{"episode_reward_max": 177.16056297020967, "episode_reward_min": -283.6350773051381, "episode_reward_mean": 115.28219779432429, "episode_len_mean": 496.63, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -106.2095632950465}, "policy_reward_max": {"shared_policy": 59.21396186249329}, "policy_reward_mean": {"shared_policy": 38.42739926477476}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.51691002771233, 130.87160644680262, 104.773629527539, 85.87541884928939, 127.30437207967043, 102.0550153888762, -231.89148797839883, 120.2270218655467, 76.37334674596784, 70.63930404745042, 128.0969271287322, 124.62452434003353, 123.69610049575567, 105.34417300717904, 127.31107435352169, 87.63965208735317, 93.8966621980071, 158.38800730975333, 138.62354468740523, 114.77228544620445, 149.29392079263928, 134.6330457683652, 113.17326779104768, 128.22584149241453, 90.52444141358137, 48.22108421288431, 130.38390654698017, 132.9513198323548, 146.72444585338218, 83.06399566680192, 122.38233834598212, 95.22738229483366, 125.46214329078794, 88.84310431219637, 134.73960977979016, 116.44149575009942, 146.4382644332944, 148.75055703334513, 114.0905974237248, 130.61748124659064, 130.3595157396048, 128.34620474651456, 116.90814207494257, 135.5260631851852, 148.39593432843662, 95.81441573798655, 127.26430328749117, 140.87533176690357, 151.3440257981417, 101.66583557939157, 145.02412297111, 127.52829801663756, 145.52326996997016, 127.20814116671681, 78.21914334595203, 71.41574680432676, 132.21945872530335, 177.16056297020967, 144.0223033740185, 139.3294664863496, 122.44080320000646, 112.84873830527067, 166.1768071739936, 129.94275546818977, 81.71020007133481, 112.11539597064255, 135.07463781908143, 139.43943646177655, 149.12821868620804, 81.1745581086725, 117.50501052243635, 128.5832016430795, 127.21619920060037, 131.27307688421573, 134.3879014104608, 132.13676774874332, 116.15150114148855, 126.37737348675726, 131.32737620919912, 127.43587940931319, 106.98706471547483, 101.55131395277564, 76.6385534442961, 163.2835091575979, 136.71905034594232, 148.20747021678827, 119.24144928902386, 107.40102516859767, 122.93830712139604, 132.4479737132788, 102.6958606066182, 153.6484650280324, 111.43982787802814, 147.63141994271373, 124.934755560942, 139.41569055966096, -283.6350773051381, 167.71350562572482, 122.13204435259101, 151.90511372592277], "episode_lengths": [500, 500, 500, 500, 500, 500, 441, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 222, 500, 500, 500], "policy_shared_policy_reward": [46.11000759899616, 46.75771242380142, 46.649190004915, 43.641764402389526, 43.81463534384966, 43.41520670056343, 35.021134470899895, 35.047517256190375, 34.70497780044873, 28.685802715520055, 28.78631682197252, 28.403299311796815, 42.42820106446743, 42.319111451506615, 42.557059563696384, 34.042158260941505, 34.02005151286721, 33.99280561506748, -87.90253992875418, -72.10056211551031, -71.88838593413433, 39.899816274642944, 40.09719109535217, 40.230014495551586, 25.39741540948549, 25.782339374224335, 25.19359196225801, 23.753039909526706, 23.569231748580933, 23.317032389342785, 43.079850755631924, 42.77687904238701, 42.24019733071327, 41.75011172890663, 41.40097297728062, 41.47343963384628, 41.56030760705471, 41.2531546279788, 40.88263826072216, 35.31755122899388, 35.261966160808996, 34.764655617376164, 42.41251276433468, 42.8018435460981, 42.09671804308891, 29.36195809300989, 29.257217071950436, 29.020476922392845, 31.256568610668182, 31.347833454608917, 31.292260132730007, 52.805135993907854, 52.95080267932887, 52.632068636516735, 46.28292331844568, 45.912964068353176, 46.42765730060637, 38.24337244095901, 38.16931751618782, 38.359595489057625, 49.96599656964342, 49.50322370479505, 49.8247005182008, 45.10423139793177, 44.90752125283082, 44.62129311760266, 37.898270259921745, 37.5312009503444, 37.743796580781535, 43.14409190416336, 42.65910924971104, 42.42264033854008, 30.26561537757516, 29.934149757027626, 30.324676278978586, 16.065717950463295, 16.38190650008619, 15.773459762334824, 43.38903223971525, 43.15337953964868, 43.84149476761618, 44.14525049428144, 44.51073848331967, 44.295330854753644, 48.58140926063059, 48.930508784949765, 49.21252780780195, 27.591607352097824, 27.538155173261956, 27.934233141442135, 41.249416647789374, 40.890123066802815, 40.24279863138993, 31.879578568041325, 31.93569205701351, 31.412111669778824, 41.836058497428894, 42.07254933193326, 41.55353546142578, 29.885440746322274, 29.534558847546577, 29.423104718327522, 45.150590858732656, 44.950760876139, 44.63825804491837, 38.752987898886204, 38.776608884334564, 38.91189896687865, 48.59319876134394, 49.03717384859918, 48.80789182335137, 49.65030752122401, 49.76787569932638, 49.33237381279467, 37.68188900748888, 38.153693857292325, 38.2550145589436, 42.98690865437189, 43.8148263717691, 43.8157462204496, 43.34127219269672, 43.4233067917327, 43.59493675517538, 42.394779190421104, 42.96496418863535, 42.986461367458105, 39.03465147813161, 38.780509417255715, 39.09298117955525, 45.160816207528114, 45.05272422730923, 45.31252275034785, 49.48031773169835, 49.38646992047627, 49.529146676262215, 31.948034924765423, 32.19193757822116, 31.67444323499997, 42.634421289588005, 42.27055319646993, 42.359328801433236, 46.804800656934574, 47.18413817634185, 46.886392933626965, 50.0977607667446, 50.50400989502667, 50.742255136370645, 33.70628114044666, 33.73104605078697, 34.228508388157934, 48.50875351205467, 47.866003602743135, 48.6493658563122, 42.76184241101146, 42.51189757883549, 42.25455802679062, 48.65019328643878, 48.224684593578175, 48.64839208995302, 42.14676280319691, 42.46933967620134, 42.59203868731856, 25.957155913114548, 26.124308673664927, 26.13767875917256, 24.072860949983195, 23.60414021213849, 23.738745642205075, 44.57588854556282, 43.8066487510999, 43.83692142864068, 58.95516842976211, 59.21396186249329, 58.99143267795442, 47.87373123814662, 47.91428407778342, 48.23428805808847, 46.62397447414696, 46.23129351437092, 46.47419849783182, 40.65811468909183, 40.883268971617014, 40.89941953929761, 37.78093383461237, 37.572170466184616, 37.495634004473686, 55.284723671774074, 55.665686849659934, 55.226396652559444, 42.649634912610054, 43.643495965749025, 43.64962458983064, 26.906683589021355, 27.48059708128372, 27.322919401029736, 37.178666320939854, 37.47736581539114, 37.45936383431156, 45.09103524436553, 45.247869686534, 44.735732888182, 46.71563261623183, 46.31030637274185, 46.41349747280279, 49.847852637991295, 49.705592118203626, 49.574773930013166, 27.163626581430435, 26.79157766699791, 27.219353860244155, 39.093348011374474, 38.97004306316376, 39.44161944789812, 43.05461924771467, 43.00556862975159, 42.52301376561323, 42.51306378965576, 42.16094474991162, 42.54219066103299, 44.150244085506216, 43.94271585221091, 43.18011694649854, 44.90587445100148, 44.885406514008835, 44.59662044545014, 44.02335104222098, 44.0764119165639, 44.03700478995839, 38.855819173157215, 38.84642916917801, 38.44925279915333, 42.146099408467606, 42.05079061289628, 42.18048346539338, 44.10042154043913, 43.51418985426426, 43.71276481449604, 42.65470163275798, 42.32450825472672, 42.45666952182849, 35.598347426702574, 35.768924334396914, 35.61979295437534, 34.13135992890844, 33.26764152447382, 34.15231249939339, 25.644918675223977, 25.267602796355874, 25.726031972716243, 54.240887100497886, 54.67795287321012, 54.36466918389003, 45.636503803233296, 45.37692728887001, 45.705619253839046, 49.357755685846016, 49.183882604042694, 49.665831926899656, 39.739514277627066, 39.86331848924358, 39.638616522153214, 35.84008503208557, 35.69996278236309, 35.860977354149014, 41.12845760087171, 41.00232798854509, 40.80752153197923, 44.00960747152567, 44.22623986378312, 44.21212637796998, 33.918425167600304, 34.21466390291849, 34.562771536099405, 51.4375159498304, 51.01297893375157, 51.19797014445065, 36.885332127412156, 37.10921223958333, 37.445283511032656, 49.08688752104838, 49.22538740684588, 49.319145014819995, 41.701818419620395, 41.66707500722259, 41.56586213409901, 47.00197012575032, 46.18888841072717, 46.224832023183495, -88.37737919638555, -89.04813481370608, -106.2095632950465, 56.243741214275346, 55.62869533896445, 55.841069072484956, 40.7411977748076, 40.89263496051231, 40.498211617271096, 51.058293840847895, 50.00207251310347, 50.84474737197159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1416233166968971, "mean_inference_ms": 0.6963606821535216, "mean_action_processing_ms": 0.09597050505887582, "mean_env_wait_ms": 0.789687838431925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 760000, "timesteps_this_iter": 0, "agent_timesteps_total": 2280000, "timers": {"sample_time_ms": 11697.337, "sample_throughput": 427.448, "load_time_ms": 0.102, "load_throughput": 49010329.516, "learn_time_ms": 2051.541, "learn_throughput": 2437.192, "update_time_ms": 9.85}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.128474576789396e-37, "cur_lr": 0.0005000000000000001, "total_loss": 135.97164916992188, "policy_loss": 0.004270298719353249, "vf_loss": 136.0659408569336, "vf_explained_var": 0.03363640904426575, "kl": 22.579125308990523, "entropy": 9.856236362457276, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 760000, "num_agent_steps_sampled": 2280000, "num_steps_trained": 760000, "num_agent_steps_trained": 2280000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2194, "training_iteration": 152, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-28-47", "timestamp": 1706232527, "time_this_iter_s": 10.432529926300049, "time_total_s": 1641.5917093753815, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D10DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1641.5917093753815, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 5.035714285714286, "ram_util_percent": 62.050000000000004}}
{"episode_reward_max": 177.16056297020967, "episode_reward_min": -283.6350773051381, "episode_reward_mean": 120.57612212136998, "episode_len_mean": 497.22, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -106.2095632950465}, "policy_reward_max": {"shared_policy": 59.21396186249329}, "policy_reward_mean": {"shared_policy": 40.19204070712332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [128.0969271287322, 124.62452434003353, 123.69610049575567, 105.34417300717904, 127.31107435352169, 87.63965208735317, 93.8966621980071, 158.38800730975333, 138.62354468740523, 114.77228544620445, 149.29392079263928, 134.6330457683652, 113.17326779104768, 128.22584149241453, 90.52444141358137, 48.22108421288431, 130.38390654698017, 132.9513198323548, 146.72444585338218, 83.06399566680192, 122.38233834598212, 95.22738229483366, 125.46214329078794, 88.84310431219637, 134.73960977979016, 116.44149575009942, 146.4382644332944, 148.75055703334513, 114.0905974237248, 130.61748124659064, 130.3595157396048, 128.34620474651456, 116.90814207494257, 135.5260631851852, 148.39593432843662, 95.81441573798655, 127.26430328749117, 140.87533176690357, 151.3440257981417, 101.66583557939157, 145.02412297111, 127.52829801663756, 145.52326996997016, 127.20814116671681, 78.21914334595203, 71.41574680432676, 132.21945872530335, 177.16056297020967, 144.0223033740185, 139.3294664863496, 122.44080320000646, 112.84873830527067, 166.1768071739936, 129.94275546818977, 81.71020007133481, 112.11539597064255, 135.07463781908143, 139.43943646177655, 149.12821868620804, 81.1745581086725, 117.50501052243635, 128.5832016430795, 127.21619920060037, 131.27307688421573, 134.3879014104608, 132.13676774874332, 116.15150114148855, 126.37737348675726, 131.32737620919912, 127.43587940931319, 106.98706471547483, 101.55131395277564, 76.6385534442961, 163.2835091575979, 136.71905034594232, 148.20747021678827, 119.24144928902386, 107.40102516859767, 122.93830712139604, 132.4479737132788, 102.6958606066182, 153.6484650280324, 111.43982787802814, 147.63141994271373, 124.934755560942, 139.41569055966096, -283.6350773051381, 167.71350562572482, 122.13204435259101, 151.90511372592277, 143.26552789658328, 122.79055600147694, 133.46472808718687, 165.44596934691063, 139.87059166654913, 121.2524015419185, 106.55757299065587, 127.33555624075233, 107.90922973956911, 87.24543619342145], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 222, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [43.079850755631924, 42.77687904238701, 42.24019733071327, 41.75011172890663, 41.40097297728062, 41.47343963384628, 41.56030760705471, 41.2531546279788, 40.88263826072216, 35.31755122899388, 35.261966160808996, 34.764655617376164, 42.41251276433468, 42.8018435460981, 42.09671804308891, 29.36195809300989, 29.257217071950436, 29.020476922392845, 31.256568610668182, 31.347833454608917, 31.292260132730007, 52.805135993907854, 52.95080267932887, 52.632068636516735, 46.28292331844568, 45.912964068353176, 46.42765730060637, 38.24337244095901, 38.16931751618782, 38.359595489057625, 49.96599656964342, 49.50322370479505, 49.8247005182008, 45.10423139793177, 44.90752125283082, 44.62129311760266, 37.898270259921745, 37.5312009503444, 37.743796580781535, 43.14409190416336, 42.65910924971104, 42.42264033854008, 30.26561537757516, 29.934149757027626, 30.324676278978586, 16.065717950463295, 16.38190650008619, 15.773459762334824, 43.38903223971525, 43.15337953964868, 43.84149476761618, 44.14525049428144, 44.51073848331967, 44.295330854753644, 48.58140926063059, 48.930508784949765, 49.21252780780195, 27.591607352097824, 27.538155173261956, 27.934233141442135, 41.249416647789374, 40.890123066802815, 40.24279863138993, 31.879578568041325, 31.93569205701351, 31.412111669778824, 41.836058497428894, 42.07254933193326, 41.55353546142578, 29.885440746322274, 29.534558847546577, 29.423104718327522, 45.150590858732656, 44.950760876139, 44.63825804491837, 38.752987898886204, 38.776608884334564, 38.91189896687865, 48.59319876134394, 49.03717384859918, 48.80789182335137, 49.65030752122401, 49.76787569932638, 49.33237381279467, 37.68188900748888, 38.153693857292325, 38.2550145589436, 42.98690865437189, 43.8148263717691, 43.8157462204496, 43.34127219269672, 43.4233067917327, 43.59493675517538, 42.394779190421104, 42.96496418863535, 42.986461367458105, 39.03465147813161, 38.780509417255715, 39.09298117955525, 45.160816207528114, 45.05272422730923, 45.31252275034785, 49.48031773169835, 49.38646992047627, 49.529146676262215, 31.948034924765423, 32.19193757822116, 31.67444323499997, 42.634421289588005, 42.27055319646993, 42.359328801433236, 46.804800656934574, 47.18413817634185, 46.886392933626965, 50.0977607667446, 50.50400989502667, 50.742255136370645, 33.70628114044666, 33.73104605078697, 34.228508388157934, 48.50875351205467, 47.866003602743135, 48.6493658563122, 42.76184241101146, 42.51189757883549, 42.25455802679062, 48.65019328643878, 48.224684593578175, 48.64839208995302, 42.14676280319691, 42.46933967620134, 42.59203868731856, 25.957155913114548, 26.124308673664927, 26.13767875917256, 24.072860949983195, 23.60414021213849, 23.738745642205075, 44.57588854556282, 43.8066487510999, 43.83692142864068, 58.95516842976211, 59.21396186249329, 58.99143267795442, 47.87373123814662, 47.91428407778342, 48.23428805808847, 46.62397447414696, 46.23129351437092, 46.47419849783182, 40.65811468909183, 40.883268971617014, 40.89941953929761, 37.78093383461237, 37.572170466184616, 37.495634004473686, 55.284723671774074, 55.665686849659934, 55.226396652559444, 42.649634912610054, 43.643495965749025, 43.64962458983064, 26.906683589021355, 27.48059708128372, 27.322919401029736, 37.178666320939854, 37.47736581539114, 37.45936383431156, 45.09103524436553, 45.247869686534, 44.735732888182, 46.71563261623183, 46.31030637274185, 46.41349747280279, 49.847852637991295, 49.705592118203626, 49.574773930013166, 27.163626581430435, 26.79157766699791, 27.219353860244155, 39.093348011374474, 38.97004306316376, 39.44161944789812, 43.05461924771467, 43.00556862975159, 42.52301376561323, 42.51306378965576, 42.16094474991162, 42.54219066103299, 44.150244085506216, 43.94271585221091, 43.18011694649854, 44.90587445100148, 44.885406514008835, 44.59662044545014, 44.02335104222098, 44.0764119165639, 44.03700478995839, 38.855819173157215, 38.84642916917801, 38.44925279915333, 42.146099408467606, 42.05079061289628, 42.18048346539338, 44.10042154043913, 43.51418985426426, 43.71276481449604, 42.65470163275798, 42.32450825472672, 42.45666952182849, 35.598347426702574, 35.768924334396914, 35.61979295437534, 34.13135992890844, 33.26764152447382, 34.15231249939339, 25.644918675223977, 25.267602796355874, 25.726031972716243, 54.240887100497886, 54.67795287321012, 54.36466918389003, 45.636503803233296, 45.37692728887001, 45.705619253839046, 49.357755685846016, 49.183882604042694, 49.665831926899656, 39.739514277627066, 39.86331848924358, 39.638616522153214, 35.84008503208557, 35.69996278236309, 35.860977354149014, 41.12845760087171, 41.00232798854509, 40.80752153197923, 44.00960747152567, 44.22623986378312, 44.21212637796998, 33.918425167600304, 34.21466390291849, 34.562771536099405, 51.4375159498304, 51.01297893375157, 51.19797014445065, 36.885332127412156, 37.10921223958333, 37.445283511032656, 49.08688752104838, 49.22538740684588, 49.319145014819995, 41.701818419620395, 41.66707500722259, 41.56586213409901, 47.00197012575032, 46.18888841072717, 46.224832023183495, -88.37737919638555, -89.04813481370608, -106.2095632950465, 56.243741214275346, 55.62869533896445, 55.841069072484956, 40.7411977748076, 40.89263496051231, 40.498211617271096, 51.058293840847895, 50.00207251310347, 50.84474737197159, 47.88226136316855, 47.526966383059815, 47.8563001503547, 41.36940217297524, 41.06590497493744, 40.35524885356426, 44.33113113542397, 44.59464494635661, 44.538952005406216, 55.29196933843194, 54.92096535861491, 55.233034649863825, 46.6079060609142, 46.401926899949714, 46.86075870568554, 40.68870140736301, 40.35186045368512, 40.21183968087037, 35.185044849912316, 35.85346314559379, 35.51906499514976, 42.89073314455648, 42.291362201174096, 42.15346089502175, 35.99606472750504, 36.01822122217466, 35.89494378988941, 29.190594255613775, 29.224701821493596, 28.830140116314084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1416555739431886, "mean_inference_ms": 0.6965518900942684, "mean_action_processing_ms": 0.09599254451729752, "mean_env_wait_ms": 0.7896718714943931, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 765000, "timesteps_this_iter": 0, "agent_timesteps_total": 2295000, "timers": {"sample_time_ms": 11699.311, "sample_throughput": 427.376, "load_time_ms": 0.102, "load_throughput": 49010329.516, "learn_time_ms": 2054.44, "learn_throughput": 2433.754, "update_time_ms": 9.778}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6927118651840943e-37, "cur_lr": 0.0005000000000000001, "total_loss": 7.436644458770752, "policy_loss": 0.0004697233148501567, "vf_loss": 7.538228845596313, "vf_explained_var": 0.007177382707595825, "kl": 0.005949628935239837, "entropy": 10.205419921875, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 765000, "num_agent_steps_sampled": 2295000, "num_steps_trained": 765000, "num_agent_steps_trained": 2295000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2204, "training_iteration": 153, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-28-58", "timestamp": 1706232538, "time_this_iter_s": 10.31424355506897, "time_total_s": 1651.9059529304504, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140234D9D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1651.9059529304504, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 5.693333333333333, "ram_util_percent": 61.686666666666675}}
{"episode_reward_max": 177.16056297020967, "episode_reward_min": -283.6350773051381, "episode_reward_mean": 119.44974557449865, "episode_len_mean": 497.22, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -106.2095632950465}, "policy_reward_max": {"shared_policy": 59.21396186249329}, "policy_reward_mean": {"shared_policy": 39.81658185816622}, "custom_metrics": {}, "hist_stats": {"episode_reward": [149.29392079263928, 134.6330457683652, 113.17326779104768, 128.22584149241453, 90.52444141358137, 48.22108421288431, 130.38390654698017, 132.9513198323548, 146.72444585338218, 83.06399566680192, 122.38233834598212, 95.22738229483366, 125.46214329078794, 88.84310431219637, 134.73960977979016, 116.44149575009942, 146.4382644332944, 148.75055703334513, 114.0905974237248, 130.61748124659064, 130.3595157396048, 128.34620474651456, 116.90814207494257, 135.5260631851852, 148.39593432843662, 95.81441573798655, 127.26430328749117, 140.87533176690357, 151.3440257981417, 101.66583557939157, 145.02412297111, 127.52829801663756, 145.52326996997016, 127.20814116671681, 78.21914334595203, 71.41574680432676, 132.21945872530335, 177.16056297020967, 144.0223033740185, 139.3294664863496, 122.44080320000646, 112.84873830527067, 166.1768071739936, 129.94275546818977, 81.71020007133481, 112.11539597064255, 135.07463781908143, 139.43943646177655, 149.12821868620804, 81.1745581086725, 117.50501052243635, 128.5832016430795, 127.21619920060037, 131.27307688421573, 134.3879014104608, 132.13676774874332, 116.15150114148855, 126.37737348675726, 131.32737620919912, 127.43587940931319, 106.98706471547483, 101.55131395277564, 76.6385534442961, 163.2835091575979, 136.71905034594232, 148.20747021678827, 119.24144928902386, 107.40102516859767, 122.93830712139604, 132.4479737132788, 102.6958606066182, 153.6484650280324, 111.43982787802814, 147.63141994271373, 124.934755560942, 139.41569055966096, -283.6350773051381, 167.71350562572482, 122.13204435259101, 151.90511372592277, 143.26552789658328, 122.79055600147694, 133.46472808718687, 165.44596934691063, 139.87059166654913, 121.2524015419185, 106.55757299065587, 127.33555624075233, 107.90922973956911, 87.24543619342145, 93.34046942368147, 119.35176232457158, 135.153921738267, 117.77831073850393, 80.68333777040243, 145.2294125854969, 100.86507566139335, 102.18861218541859, 68.43397231400012, 126.73042162507772], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 222, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [49.96599656964342, 49.50322370479505, 49.8247005182008, 45.10423139793177, 44.90752125283082, 44.62129311760266, 37.898270259921745, 37.5312009503444, 37.743796580781535, 43.14409190416336, 42.65910924971104, 42.42264033854008, 30.26561537757516, 29.934149757027626, 30.324676278978586, 16.065717950463295, 16.38190650008619, 15.773459762334824, 43.38903223971525, 43.15337953964868, 43.84149476761618, 44.14525049428144, 44.51073848331967, 44.295330854753644, 48.58140926063059, 48.930508784949765, 49.21252780780195, 27.591607352097824, 27.538155173261956, 27.934233141442135, 41.249416647789374, 40.890123066802815, 40.24279863138993, 31.879578568041325, 31.93569205701351, 31.412111669778824, 41.836058497428894, 42.07254933193326, 41.55353546142578, 29.885440746322274, 29.534558847546577, 29.423104718327522, 45.150590858732656, 44.950760876139, 44.63825804491837, 38.752987898886204, 38.776608884334564, 38.91189896687865, 48.59319876134394, 49.03717384859918, 48.80789182335137, 49.65030752122401, 49.76787569932638, 49.33237381279467, 37.68188900748888, 38.153693857292325, 38.2550145589436, 42.98690865437189, 43.8148263717691, 43.8157462204496, 43.34127219269672, 43.4233067917327, 43.59493675517538, 42.394779190421104, 42.96496418863535, 42.986461367458105, 39.03465147813161, 38.780509417255715, 39.09298117955525, 45.160816207528114, 45.05272422730923, 45.31252275034785, 49.48031773169835, 49.38646992047627, 49.529146676262215, 31.948034924765423, 32.19193757822116, 31.67444323499997, 42.634421289588005, 42.27055319646993, 42.359328801433236, 46.804800656934574, 47.18413817634185, 46.886392933626965, 50.0977607667446, 50.50400989502667, 50.742255136370645, 33.70628114044666, 33.73104605078697, 34.228508388157934, 48.50875351205467, 47.866003602743135, 48.6493658563122, 42.76184241101146, 42.51189757883549, 42.25455802679062, 48.65019328643878, 48.224684593578175, 48.64839208995302, 42.14676280319691, 42.46933967620134, 42.59203868731856, 25.957155913114548, 26.124308673664927, 26.13767875917256, 24.072860949983195, 23.60414021213849, 23.738745642205075, 44.57588854556282, 43.8066487510999, 43.83692142864068, 58.95516842976211, 59.21396186249329, 58.99143267795442, 47.87373123814662, 47.91428407778342, 48.23428805808847, 46.62397447414696, 46.23129351437092, 46.47419849783182, 40.65811468909183, 40.883268971617014, 40.89941953929761, 37.78093383461237, 37.572170466184616, 37.495634004473686, 55.284723671774074, 55.665686849659934, 55.226396652559444, 42.649634912610054, 43.643495965749025, 43.64962458983064, 26.906683589021355, 27.48059708128372, 27.322919401029736, 37.178666320939854, 37.47736581539114, 37.45936383431156, 45.09103524436553, 45.247869686534, 44.735732888182, 46.71563261623183, 46.31030637274185, 46.41349747280279, 49.847852637991295, 49.705592118203626, 49.574773930013166, 27.163626581430435, 26.79157766699791, 27.219353860244155, 39.093348011374474, 38.97004306316376, 39.44161944789812, 43.05461924771467, 43.00556862975159, 42.52301376561323, 42.51306378965576, 42.16094474991162, 42.54219066103299, 44.150244085506216, 43.94271585221091, 43.18011694649854, 44.90587445100148, 44.885406514008835, 44.59662044545014, 44.02335104222098, 44.0764119165639, 44.03700478995839, 38.855819173157215, 38.84642916917801, 38.44925279915333, 42.146099408467606, 42.05079061289628, 42.18048346539338, 44.10042154043913, 43.51418985426426, 43.71276481449604, 42.65470163275798, 42.32450825472672, 42.45666952182849, 35.598347426702574, 35.768924334396914, 35.61979295437534, 34.13135992890844, 33.26764152447382, 34.15231249939339, 25.644918675223977, 25.267602796355874, 25.726031972716243, 54.240887100497886, 54.67795287321012, 54.36466918389003, 45.636503803233296, 45.37692728887001, 45.705619253839046, 49.357755685846016, 49.183882604042694, 49.665831926899656, 39.739514277627066, 39.86331848924358, 39.638616522153214, 35.84008503208557, 35.69996278236309, 35.860977354149014, 41.12845760087171, 41.00232798854509, 40.80752153197923, 44.00960747152567, 44.22623986378312, 44.21212637796998, 33.918425167600304, 34.21466390291849, 34.562771536099405, 51.4375159498304, 51.01297893375157, 51.19797014445065, 36.885332127412156, 37.10921223958333, 37.445283511032656, 49.08688752104838, 49.22538740684588, 49.319145014819995, 41.701818419620395, 41.66707500722259, 41.56586213409901, 47.00197012575032, 46.18888841072717, 46.224832023183495, -88.37737919638555, -89.04813481370608, -106.2095632950465, 56.243741214275346, 55.62869533896445, 55.841069072484956, 40.7411977748076, 40.89263496051231, 40.498211617271096, 51.058293840847895, 50.00207251310347, 50.84474737197159, 47.88226136316855, 47.526966383059815, 47.8563001503547, 41.36940217297524, 41.06590497493744, 40.35524885356426, 44.33113113542397, 44.59464494635661, 44.538952005406216, 55.29196933843194, 54.92096535861491, 55.233034649863825, 46.6079060609142, 46.401926899949714, 46.86075870568554, 40.68870140736301, 40.35186045368512, 40.21183968087037, 35.185044849912316, 35.85346314559379, 35.51906499514976, 42.89073314455648, 42.291362201174096, 42.15346089502175, 35.99606472750504, 36.01822122217466, 35.89494378988941, 29.190594255613775, 29.224701821493596, 28.830140116314084, 31.271551391730696, 31.32119958351055, 30.747718448440224, 39.42851675550142, 39.999841096500546, 39.923404472569615, 45.09248327091336, 45.06163250282407, 44.999805964529514, 39.26667915657163, 39.34768442064524, 39.16394716128707, 26.68777284026146, 27.159527771174908, 26.836037158966064, 48.36833908160527, 48.52394024779399, 48.33713325609763, 33.58246727287769, 33.30677120387554, 33.97583718464011, 33.972557832797364, 34.11437855412562, 34.101675798495606, 22.823318024476364, 22.865818632145718, 22.744835657378033, 42.194783225655556, 42.581230498850346, 41.95440790057182]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1416963072908154, "mean_inference_ms": 0.6967516789335932, "mean_action_processing_ms": 0.09601337805612951, "mean_env_wait_ms": 0.7896687880008811, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 770000, "timesteps_this_iter": 0, "agent_timesteps_total": 2310000, "timers": {"sample_time_ms": 11726.003, "sample_throughput": 426.403, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 2057.539, "learn_throughput": 2430.087, "update_time_ms": 9.746}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6927118651840943e-37, "cur_lr": 0.0005000000000000001, "total_loss": 6.02533369064331, "policy_loss": -0.001159180552425454, "vf_loss": 6.129279136657715, "vf_explained_var": 0.01820380687713623, "kl": 0.003983150282919944, "entropy": 10.278613758087157, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 770000, "num_agent_steps_sampled": 2310000, "num_steps_trained": 770000, "num_agent_steps_trained": 2310000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2214, "training_iteration": 154, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-29-09", "timestamp": 1706232549, "time_this_iter_s": 11.054876327514648, "time_total_s": 1662.960829257965, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D10D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1662.960829257965, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 6.475, "ram_util_percent": 61.78125}}
{"episode_reward_max": 177.16056297020967, "episode_reward_min": -283.6350773051381, "episode_reward_mean": 118.38910334585056, "episode_len_mean": 497.22, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -106.2095632950465}, "policy_reward_max": {"shared_policy": 59.21396186249329}, "policy_reward_mean": {"shared_policy": 39.46303444861685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [122.38233834598212, 95.22738229483366, 125.46214329078794, 88.84310431219637, 134.73960977979016, 116.44149575009942, 146.4382644332944, 148.75055703334513, 114.0905974237248, 130.61748124659064, 130.3595157396048, 128.34620474651456, 116.90814207494257, 135.5260631851852, 148.39593432843662, 95.81441573798655, 127.26430328749117, 140.87533176690357, 151.3440257981417, 101.66583557939157, 145.02412297111, 127.52829801663756, 145.52326996997016, 127.20814116671681, 78.21914334595203, 71.41574680432676, 132.21945872530335, 177.16056297020967, 144.0223033740185, 139.3294664863496, 122.44080320000646, 112.84873830527067, 166.1768071739936, 129.94275546818977, 81.71020007133481, 112.11539597064255, 135.07463781908143, 139.43943646177655, 149.12821868620804, 81.1745581086725, 117.50501052243635, 128.5832016430795, 127.21619920060037, 131.27307688421573, 134.3879014104608, 132.13676774874332, 116.15150114148855, 126.37737348675726, 131.32737620919912, 127.43587940931319, 106.98706471547483, 101.55131395277564, 76.6385534442961, 163.2835091575979, 136.71905034594232, 148.20747021678827, 119.24144928902386, 107.40102516859767, 122.93830712139604, 132.4479737132788, 102.6958606066182, 153.6484650280324, 111.43982787802814, 147.63141994271373, 124.934755560942, 139.41569055966096, -283.6350773051381, 167.71350562572482, 122.13204435259101, 151.90511372592277, 143.26552789658328, 122.79055600147694, 133.46472808718687, 165.44596934691063, 139.87059166654913, 121.2524015419185, 106.55757299065587, 127.33555624075233, 107.90922973956911, 87.24543619342145, 93.34046942368147, 119.35176232457158, 135.153921738267, 117.77831073850393, 80.68333777040243, 145.2294125854969, 100.86507566139335, 102.18861218541859, 68.43397231400012, 126.73042162507772, 38.445289151743054, 129.28577009588474, 95.46048341132698, 122.60641931369898, 106.03572011366484, 129.52691145986324, 122.79164804890752, 122.20104810036716, 94.49985885620116, 90.2778979539871], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 222, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [41.249416647789374, 40.890123066802815, 40.24279863138993, 31.879578568041325, 31.93569205701351, 31.412111669778824, 41.836058497428894, 42.07254933193326, 41.55353546142578, 29.885440746322274, 29.534558847546577, 29.423104718327522, 45.150590858732656, 44.950760876139, 44.63825804491837, 38.752987898886204, 38.776608884334564, 38.91189896687865, 48.59319876134394, 49.03717384859918, 48.80789182335137, 49.65030752122401, 49.76787569932638, 49.33237381279467, 37.68188900748888, 38.153693857292325, 38.2550145589436, 42.98690865437189, 43.8148263717691, 43.8157462204496, 43.34127219269672, 43.4233067917327, 43.59493675517538, 42.394779190421104, 42.96496418863535, 42.986461367458105, 39.03465147813161, 38.780509417255715, 39.09298117955525, 45.160816207528114, 45.05272422730923, 45.31252275034785, 49.48031773169835, 49.38646992047627, 49.529146676262215, 31.948034924765423, 32.19193757822116, 31.67444323499997, 42.634421289588005, 42.27055319646993, 42.359328801433236, 46.804800656934574, 47.18413817634185, 46.886392933626965, 50.0977607667446, 50.50400989502667, 50.742255136370645, 33.70628114044666, 33.73104605078697, 34.228508388157934, 48.50875351205467, 47.866003602743135, 48.6493658563122, 42.76184241101146, 42.51189757883549, 42.25455802679062, 48.65019328643878, 48.224684593578175, 48.64839208995302, 42.14676280319691, 42.46933967620134, 42.59203868731856, 25.957155913114548, 26.124308673664927, 26.13767875917256, 24.072860949983195, 23.60414021213849, 23.738745642205075, 44.57588854556282, 43.8066487510999, 43.83692142864068, 58.95516842976211, 59.21396186249329, 58.99143267795442, 47.87373123814662, 47.91428407778342, 48.23428805808847, 46.62397447414696, 46.23129351437092, 46.47419849783182, 40.65811468909183, 40.883268971617014, 40.89941953929761, 37.78093383461237, 37.572170466184616, 37.495634004473686, 55.284723671774074, 55.665686849659934, 55.226396652559444, 42.649634912610054, 43.643495965749025, 43.64962458983064, 26.906683589021355, 27.48059708128372, 27.322919401029736, 37.178666320939854, 37.47736581539114, 37.45936383431156, 45.09103524436553, 45.247869686534, 44.735732888182, 46.71563261623183, 46.31030637274185, 46.41349747280279, 49.847852637991295, 49.705592118203626, 49.574773930013166, 27.163626581430435, 26.79157766699791, 27.219353860244155, 39.093348011374474, 38.97004306316376, 39.44161944789812, 43.05461924771467, 43.00556862975159, 42.52301376561323, 42.51306378965576, 42.16094474991162, 42.54219066103299, 44.150244085506216, 43.94271585221091, 43.18011694649854, 44.90587445100148, 44.885406514008835, 44.59662044545014, 44.02335104222098, 44.0764119165639, 44.03700478995839, 38.855819173157215, 38.84642916917801, 38.44925279915333, 42.146099408467606, 42.05079061289628, 42.18048346539338, 44.10042154043913, 43.51418985426426, 43.71276481449604, 42.65470163275798, 42.32450825472672, 42.45666952182849, 35.598347426702574, 35.768924334396914, 35.61979295437534, 34.13135992890844, 33.26764152447382, 34.15231249939339, 25.644918675223977, 25.267602796355874, 25.726031972716243, 54.240887100497886, 54.67795287321012, 54.36466918389003, 45.636503803233296, 45.37692728887001, 45.705619253839046, 49.357755685846016, 49.183882604042694, 49.665831926899656, 39.739514277627066, 39.86331848924358, 39.638616522153214, 35.84008503208557, 35.69996278236309, 35.860977354149014, 41.12845760087171, 41.00232798854509, 40.80752153197923, 44.00960747152567, 44.22623986378312, 44.21212637796998, 33.918425167600304, 34.21466390291849, 34.562771536099405, 51.4375159498304, 51.01297893375157, 51.19797014445065, 36.885332127412156, 37.10921223958333, 37.445283511032656, 49.08688752104838, 49.22538740684588, 49.319145014819995, 41.701818419620395, 41.66707500722259, 41.56586213409901, 47.00197012575032, 46.18888841072717, 46.224832023183495, -88.37737919638555, -89.04813481370608, -106.2095632950465, 56.243741214275346, 55.62869533896445, 55.841069072484956, 40.7411977748076, 40.89263496051231, 40.498211617271096, 51.058293840847895, 50.00207251310347, 50.84474737197159, 47.88226136316855, 47.526966383059815, 47.8563001503547, 41.36940217297524, 41.06590497493744, 40.35524885356426, 44.33113113542397, 44.59464494635661, 44.538952005406216, 55.29196933843194, 54.92096535861491, 55.233034649863825, 46.6079060609142, 46.401926899949714, 46.86075870568554, 40.68870140736301, 40.35186045368512, 40.21183968087037, 35.185044849912316, 35.85346314559379, 35.51906499514976, 42.89073314455648, 42.291362201174096, 42.15346089502175, 35.99606472750504, 36.01822122217466, 35.89494378988941, 29.190594255613775, 29.224701821493596, 28.830140116314084, 31.271551391730696, 31.32119958351055, 30.747718448440224, 39.42851675550142, 39.999841096500546, 39.923404472569615, 45.09248327091336, 45.06163250282407, 44.999805964529514, 39.26667915657163, 39.34768442064524, 39.16394716128707, 26.68777284026146, 27.159527771174908, 26.836037158966064, 48.36833908160527, 48.52394024779399, 48.33713325609763, 33.58246727287769, 33.30677120387554, 33.97583718464011, 33.972557832797364, 34.11437855412562, 34.101675798495606, 22.823318024476364, 22.865818632145718, 22.744835657378033, 42.194783225655556, 42.581230498850346, 41.95440790057182, 13.111676644533873, 13.286236679181457, 12.047375828027725, 42.83593085904916, 43.029208456476525, 43.420630780359105, 31.9267704548935, 31.48507137099901, 32.04864158543447, 41.307072697828204, 40.513932446638734, 40.78541416923204, 35.65543544913331, 35.12408241132894, 35.25620225320259, 43.16621555884679, 42.979417880376175, 43.38127802064021, 40.844034008681774, 41.18948492780328, 40.758129112422466, 40.76219649116197, 40.904387888188154, 40.53446372101703, 31.153334123392895, 31.713771378000573, 31.63275335480769, 30.17672100911537, 30.1903326238195, 29.910844321052224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14174619684263917, "mean_inference_ms": 0.6970586220672158, "mean_action_processing_ms": 0.0960468306992779, "mean_env_wait_ms": 0.7897371936967242, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 775000, "timesteps_this_iter": 0, "agent_timesteps_total": 2325000, "timers": {"sample_time_ms": 11884.819, "sample_throughput": 420.705, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 2073.135, "learn_throughput": 2411.806, "update_time_ms": 9.757}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.463559325920471e-38, "cur_lr": 0.0005000000000000001, "total_loss": 6.132989740371704, "policy_loss": -0.0010674546329328294, "vf_loss": 6.237617826461792, "vf_explained_var": 0.030958789587020873, "kl": 0.002955626603262383, "entropy": 10.35607385635376, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 775000, "num_agent_steps_sampled": 2325000, "num_steps_trained": 775000, "num_agent_steps_trained": 2325000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2224, "training_iteration": 155, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-29-21", "timestamp": 1706232561, "time_this_iter_s": 12.122328758239746, "time_total_s": 1675.0831580162048, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402DE5310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1675.0831580162048, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 7.305882352941176, "ram_util_percent": 61.95882352941176}}
{"episode_reward_max": 177.16056297020967, "episode_reward_min": -283.6350773051381, "episode_reward_mean": 117.63588572288161, "episode_len_mean": 497.22, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -106.2095632950465}, "policy_reward_max": {"shared_policy": 59.21396186249329}, "policy_reward_mean": {"shared_policy": 39.21196190762721}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.3595157396048, 128.34620474651456, 116.90814207494257, 135.5260631851852, 148.39593432843662, 95.81441573798655, 127.26430328749117, 140.87533176690357, 151.3440257981417, 101.66583557939157, 145.02412297111, 127.52829801663756, 145.52326996997016, 127.20814116671681, 78.21914334595203, 71.41574680432676, 132.21945872530335, 177.16056297020967, 144.0223033740185, 139.3294664863496, 122.44080320000646, 112.84873830527067, 166.1768071739936, 129.94275546818977, 81.71020007133481, 112.11539597064255, 135.07463781908143, 139.43943646177655, 149.12821868620804, 81.1745581086725, 117.50501052243635, 128.5832016430795, 127.21619920060037, 131.27307688421573, 134.3879014104608, 132.13676774874332, 116.15150114148855, 126.37737348675726, 131.32737620919912, 127.43587940931319, 106.98706471547483, 101.55131395277564, 76.6385534442961, 163.2835091575979, 136.71905034594232, 148.20747021678827, 119.24144928902386, 107.40102516859767, 122.93830712139604, 132.4479737132788, 102.6958606066182, 153.6484650280324, 111.43982787802814, 147.63141994271373, 124.934755560942, 139.41569055966096, -283.6350773051381, 167.71350562572482, 122.13204435259101, 151.90511372592277, 143.26552789658328, 122.79055600147694, 133.46472808718687, 165.44596934691063, 139.87059166654913, 121.2524015419185, 106.55757299065587, 127.33555624075233, 107.90922973956911, 87.24543619342145, 93.34046942368147, 119.35176232457158, 135.153921738267, 117.77831073850393, 80.68333777040243, 145.2294125854969, 100.86507566139335, 102.18861218541859, 68.43397231400012, 126.73042162507772, 38.445289151743054, 129.28577009588474, 95.46048341132698, 122.60641931369898, 106.03572011366484, 129.52691145986324, 122.79164804890752, 122.20104810036716, 94.49985885620116, 90.2778979539871, 86.89443819969891, 109.33762769121675, 159.46840573102216, 129.6786733954214, 123.09554521739483, 105.97806772403419, 72.69913367973639, 113.51940655708313, 138.47240078111585, 108.52751263702518], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 222, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [43.34127219269672, 43.4233067917327, 43.59493675517538, 42.394779190421104, 42.96496418863535, 42.986461367458105, 39.03465147813161, 38.780509417255715, 39.09298117955525, 45.160816207528114, 45.05272422730923, 45.31252275034785, 49.48031773169835, 49.38646992047627, 49.529146676262215, 31.948034924765423, 32.19193757822116, 31.67444323499997, 42.634421289588005, 42.27055319646993, 42.359328801433236, 46.804800656934574, 47.18413817634185, 46.886392933626965, 50.0977607667446, 50.50400989502667, 50.742255136370645, 33.70628114044666, 33.73104605078697, 34.228508388157934, 48.50875351205467, 47.866003602743135, 48.6493658563122, 42.76184241101146, 42.51189757883549, 42.25455802679062, 48.65019328643878, 48.224684593578175, 48.64839208995302, 42.14676280319691, 42.46933967620134, 42.59203868731856, 25.957155913114548, 26.124308673664927, 26.13767875917256, 24.072860949983195, 23.60414021213849, 23.738745642205075, 44.57588854556282, 43.8066487510999, 43.83692142864068, 58.95516842976211, 59.21396186249329, 58.99143267795442, 47.87373123814662, 47.91428407778342, 48.23428805808847, 46.62397447414696, 46.23129351437092, 46.47419849783182, 40.65811468909183, 40.883268971617014, 40.89941953929761, 37.78093383461237, 37.572170466184616, 37.495634004473686, 55.284723671774074, 55.665686849659934, 55.226396652559444, 42.649634912610054, 43.643495965749025, 43.64962458983064, 26.906683589021355, 27.48059708128372, 27.322919401029736, 37.178666320939854, 37.47736581539114, 37.45936383431156, 45.09103524436553, 45.247869686534, 44.735732888182, 46.71563261623183, 46.31030637274185, 46.41349747280279, 49.847852637991295, 49.705592118203626, 49.574773930013166, 27.163626581430435, 26.79157766699791, 27.219353860244155, 39.093348011374474, 38.97004306316376, 39.44161944789812, 43.05461924771467, 43.00556862975159, 42.52301376561323, 42.51306378965576, 42.16094474991162, 42.54219066103299, 44.150244085506216, 43.94271585221091, 43.18011694649854, 44.90587445100148, 44.885406514008835, 44.59662044545014, 44.02335104222098, 44.0764119165639, 44.03700478995839, 38.855819173157215, 38.84642916917801, 38.44925279915333, 42.146099408467606, 42.05079061289628, 42.18048346539338, 44.10042154043913, 43.51418985426426, 43.71276481449604, 42.65470163275798, 42.32450825472672, 42.45666952182849, 35.598347426702574, 35.768924334396914, 35.61979295437534, 34.13135992890844, 33.26764152447382, 34.15231249939339, 25.644918675223977, 25.267602796355874, 25.726031972716243, 54.240887100497886, 54.67795287321012, 54.36466918389003, 45.636503803233296, 45.37692728887001, 45.705619253839046, 49.357755685846016, 49.183882604042694, 49.665831926899656, 39.739514277627066, 39.86331848924358, 39.638616522153214, 35.84008503208557, 35.69996278236309, 35.860977354149014, 41.12845760087171, 41.00232798854509, 40.80752153197923, 44.00960747152567, 44.22623986378312, 44.21212637796998, 33.918425167600304, 34.21466390291849, 34.562771536099405, 51.4375159498304, 51.01297893375157, 51.19797014445065, 36.885332127412156, 37.10921223958333, 37.445283511032656, 49.08688752104838, 49.22538740684588, 49.319145014819995, 41.701818419620395, 41.66707500722259, 41.56586213409901, 47.00197012575032, 46.18888841072717, 46.224832023183495, -88.37737919638555, -89.04813481370608, -106.2095632950465, 56.243741214275346, 55.62869533896445, 55.841069072484956, 40.7411977748076, 40.89263496051231, 40.498211617271096, 51.058293840847895, 50.00207251310347, 50.84474737197159, 47.88226136316855, 47.526966383059815, 47.8563001503547, 41.36940217297524, 41.06590497493744, 40.35524885356426, 44.33113113542397, 44.59464494635661, 44.538952005406216, 55.29196933843194, 54.92096535861491, 55.233034649863825, 46.6079060609142, 46.401926899949714, 46.86075870568554, 40.68870140736301, 40.35186045368512, 40.21183968087037, 35.185044849912316, 35.85346314559379, 35.51906499514976, 42.89073314455648, 42.291362201174096, 42.15346089502175, 35.99606472750504, 36.01822122217466, 35.89494378988941, 29.190594255613775, 29.224701821493596, 28.830140116314084, 31.271551391730696, 31.32119958351055, 30.747718448440224, 39.42851675550142, 39.999841096500546, 39.923404472569615, 45.09248327091336, 45.06163250282407, 44.999805964529514, 39.26667915657163, 39.34768442064524, 39.16394716128707, 26.68777284026146, 27.159527771174908, 26.836037158966064, 48.36833908160527, 48.52394024779399, 48.33713325609763, 33.58246727287769, 33.30677120387554, 33.97583718464011, 33.972557832797364, 34.11437855412562, 34.101675798495606, 22.823318024476364, 22.865818632145718, 22.744835657378033, 42.194783225655556, 42.581230498850346, 41.95440790057182, 13.111676644533873, 13.286236679181457, 12.047375828027725, 42.83593085904916, 43.029208456476525, 43.420630780359105, 31.9267704548935, 31.48507137099901, 32.04864158543447, 41.307072697828204, 40.513932446638734, 40.78541416923204, 35.65543544913331, 35.12408241132894, 35.25620225320259, 43.16621555884679, 42.979417880376175, 43.38127802064021, 40.844034008681774, 41.18948492780328, 40.758129112422466, 40.76219649116197, 40.904387888188154, 40.53446372101703, 31.153334123392895, 31.713771378000573, 31.63275335480769, 30.17672100911537, 30.1903326238195, 29.910844321052224, 28.665821467836693, 28.89410263796647, 29.33451409389575, 35.95790499945481, 36.4631498431166, 36.916572848645345, 53.32254579290746, 52.82916091382502, 53.31669902428983, 43.16421194871266, 43.47266298423831, 43.04179846247037, 41.4398154951632, 41.26873425766826, 40.38699546456337, 35.18190062046051, 35.35747351497412, 35.43869358859956, 24.586243142218635, 24.590375921068087, 23.52251461644967, 37.967480823397636, 37.97180938720703, 37.58011634647846, 46.150284361094236, 45.93573425710201, 46.3863821629202, 36.04235628123084, 36.3329728913765, 36.152183464417845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14180141321753065, "mean_inference_ms": 0.6974014712544381, "mean_action_processing_ms": 0.09608436870093329, "mean_env_wait_ms": 0.7898400547792148, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 780000, "timesteps_this_iter": 0, "agent_timesteps_total": 2340000, "timers": {"sample_time_ms": 11973.732, "sample_throughput": 417.581, "load_time_ms": 0.1, "load_throughput": 50219157.088, "learn_time_ms": 2087.706, "learn_throughput": 2394.973, "update_time_ms": 10.079}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.2317796629602357e-38, "cur_lr": 0.0005000000000000001, "total_loss": 7.450043058395385, "policy_loss": -0.0005874090076584792, "vf_loss": 7.554307222366333, "vf_explained_var": 0.026116454601287843, "kl": 0.002752107405152418, "entropy": 10.367686653137207, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 780000, "num_agent_steps_sampled": 2340000, "num_steps_trained": 780000, "num_agent_steps_trained": 2340000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2234, "training_iteration": 156, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-29-33", "timestamp": 1706232573, "time_this_iter_s": 11.672126054763794, "time_total_s": 1686.7552840709686, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214025413A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1686.7552840709686, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 7.6375, "ram_util_percent": 62.0}}
{"episode_reward_max": 177.16056297020967, "episode_reward_min": -283.6350773051381, "episode_reward_mean": 116.54304634336145, "episode_len_mean": 497.22, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -106.2095632950465}, "policy_reward_max": {"shared_policy": 59.21396186249329}, "policy_reward_mean": {"shared_policy": 38.847682114453825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [145.02412297111, 127.52829801663756, 145.52326996997016, 127.20814116671681, 78.21914334595203, 71.41574680432676, 132.21945872530335, 177.16056297020967, 144.0223033740185, 139.3294664863496, 122.44080320000646, 112.84873830527067, 166.1768071739936, 129.94275546818977, 81.71020007133481, 112.11539597064255, 135.07463781908143, 139.43943646177655, 149.12821868620804, 81.1745581086725, 117.50501052243635, 128.5832016430795, 127.21619920060037, 131.27307688421573, 134.3879014104608, 132.13676774874332, 116.15150114148855, 126.37737348675726, 131.32737620919912, 127.43587940931319, 106.98706471547483, 101.55131395277564, 76.6385534442961, 163.2835091575979, 136.71905034594232, 148.20747021678827, 119.24144928902386, 107.40102516859767, 122.93830712139604, 132.4479737132788, 102.6958606066182, 153.6484650280324, 111.43982787802814, 147.63141994271373, 124.934755560942, 139.41569055966096, -283.6350773051381, 167.71350562572482, 122.13204435259101, 151.90511372592277, 143.26552789658328, 122.79055600147694, 133.46472808718687, 165.44596934691063, 139.87059166654913, 121.2524015419185, 106.55757299065587, 127.33555624075233, 107.90922973956911, 87.24543619342145, 93.34046942368147, 119.35176232457158, 135.153921738267, 117.77831073850393, 80.68333777040243, 145.2294125854969, 100.86507566139335, 102.18861218541859, 68.43397231400012, 126.73042162507772, 38.445289151743054, 129.28577009588474, 95.46048341132698, 122.60641931369898, 106.03572011366484, 129.52691145986324, 122.79164804890752, 122.20104810036716, 94.49985885620116, 90.2778979539871, 86.89443819969891, 109.33762769121675, 159.46840573102216, 129.6786733954214, 123.09554521739483, 105.97806772403419, 72.69913367973639, 113.51940655708313, 138.47240078111585, 108.52751263702518, 107.18194416351614, 87.79960797447711, 90.43408256396648, 115.30966121517122, 126.03366627171633, 100.21227802708744, 125.86725437268612, 139.82517124526214, 142.77139724791053, 131.7807712107897], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 222, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [48.50875351205467, 47.866003602743135, 48.6493658563122, 42.76184241101146, 42.51189757883549, 42.25455802679062, 48.65019328643878, 48.224684593578175, 48.64839208995302, 42.14676280319691, 42.46933967620134, 42.59203868731856, 25.957155913114548, 26.124308673664927, 26.13767875917256, 24.072860949983195, 23.60414021213849, 23.738745642205075, 44.57588854556282, 43.8066487510999, 43.83692142864068, 58.95516842976211, 59.21396186249329, 58.99143267795442, 47.87373123814662, 47.91428407778342, 48.23428805808847, 46.62397447414696, 46.23129351437092, 46.47419849783182, 40.65811468909183, 40.883268971617014, 40.89941953929761, 37.78093383461237, 37.572170466184616, 37.495634004473686, 55.284723671774074, 55.665686849659934, 55.226396652559444, 42.649634912610054, 43.643495965749025, 43.64962458983064, 26.906683589021355, 27.48059708128372, 27.322919401029736, 37.178666320939854, 37.47736581539114, 37.45936383431156, 45.09103524436553, 45.247869686534, 44.735732888182, 46.71563261623183, 46.31030637274185, 46.41349747280279, 49.847852637991295, 49.705592118203626, 49.574773930013166, 27.163626581430435, 26.79157766699791, 27.219353860244155, 39.093348011374474, 38.97004306316376, 39.44161944789812, 43.05461924771467, 43.00556862975159, 42.52301376561323, 42.51306378965576, 42.16094474991162, 42.54219066103299, 44.150244085506216, 43.94271585221091, 43.18011694649854, 44.90587445100148, 44.885406514008835, 44.59662044545014, 44.02335104222098, 44.0764119165639, 44.03700478995839, 38.855819173157215, 38.84642916917801, 38.44925279915333, 42.146099408467606, 42.05079061289628, 42.18048346539338, 44.10042154043913, 43.51418985426426, 43.71276481449604, 42.65470163275798, 42.32450825472672, 42.45666952182849, 35.598347426702574, 35.768924334396914, 35.61979295437534, 34.13135992890844, 33.26764152447382, 34.15231249939339, 25.644918675223977, 25.267602796355874, 25.726031972716243, 54.240887100497886, 54.67795287321012, 54.36466918389003, 45.636503803233296, 45.37692728887001, 45.705619253839046, 49.357755685846016, 49.183882604042694, 49.665831926899656, 39.739514277627066, 39.86331848924358, 39.638616522153214, 35.84008503208557, 35.69996278236309, 35.860977354149014, 41.12845760087171, 41.00232798854509, 40.80752153197923, 44.00960747152567, 44.22623986378312, 44.21212637796998, 33.918425167600304, 34.21466390291849, 34.562771536099405, 51.4375159498304, 51.01297893375157, 51.19797014445065, 36.885332127412156, 37.10921223958333, 37.445283511032656, 49.08688752104838, 49.22538740684588, 49.319145014819995, 41.701818419620395, 41.66707500722259, 41.56586213409901, 47.00197012575032, 46.18888841072717, 46.224832023183495, -88.37737919638555, -89.04813481370608, -106.2095632950465, 56.243741214275346, 55.62869533896445, 55.841069072484956, 40.7411977748076, 40.89263496051231, 40.498211617271096, 51.058293840847895, 50.00207251310347, 50.84474737197159, 47.88226136316855, 47.526966383059815, 47.8563001503547, 41.36940217297524, 41.06590497493744, 40.35524885356426, 44.33113113542397, 44.59464494635661, 44.538952005406216, 55.29196933843194, 54.92096535861491, 55.233034649863825, 46.6079060609142, 46.401926899949714, 46.86075870568554, 40.68870140736301, 40.35186045368512, 40.21183968087037, 35.185044849912316, 35.85346314559379, 35.51906499514976, 42.89073314455648, 42.291362201174096, 42.15346089502175, 35.99606472750504, 36.01822122217466, 35.89494378988941, 29.190594255613775, 29.224701821493596, 28.830140116314084, 31.271551391730696, 31.32119958351055, 30.747718448440224, 39.42851675550142, 39.999841096500546, 39.923404472569615, 45.09248327091336, 45.06163250282407, 44.999805964529514, 39.26667915657163, 39.34768442064524, 39.16394716128707, 26.68777284026146, 27.159527771174908, 26.836037158966064, 48.36833908160527, 48.52394024779399, 48.33713325609763, 33.58246727287769, 33.30677120387554, 33.97583718464011, 33.972557832797364, 34.11437855412562, 34.101675798495606, 22.823318024476364, 22.865818632145718, 22.744835657378033, 42.194783225655556, 42.581230498850346, 41.95440790057182, 13.111676644533873, 13.286236679181457, 12.047375828027725, 42.83593085904916, 43.029208456476525, 43.420630780359105, 31.9267704548935, 31.48507137099901, 32.04864158543447, 41.307072697828204, 40.513932446638734, 40.78541416923204, 35.65543544913331, 35.12408241132894, 35.25620225320259, 43.16621555884679, 42.979417880376175, 43.38127802064021, 40.844034008681774, 41.18948492780328, 40.758129112422466, 40.76219649116197, 40.904387888188154, 40.53446372101703, 31.153334123392895, 31.713771378000573, 31.63275335480769, 30.17672100911537, 30.1903326238195, 29.910844321052224, 28.665821467836693, 28.89410263796647, 29.33451409389575, 35.95790499945481, 36.4631498431166, 36.916572848645345, 53.32254579290746, 52.82916091382502, 53.31669902428983, 43.16421194871266, 43.47266298423831, 43.04179846247037, 41.4398154951632, 41.26873425766826, 40.38699546456337, 35.18190062046051, 35.35747351497412, 35.43869358859956, 24.586243142218635, 24.590375921068087, 23.52251461644967, 37.967480823397636, 37.97180938720703, 37.58011634647846, 46.150284361094236, 45.93573425710201, 46.3863821629202, 36.04235628123084, 36.3329728913765, 36.152183464417845, 35.71671703706184, 35.80894729929665, 35.65627982715765, 28.992660731077194, 29.490638022311032, 29.316309221088886, 30.24240731696287, 30.26519404227534, 29.926481204728276, 38.038748145103455, 38.295202791690826, 38.97571027837694, 42.39893703038493, 42.036482880512864, 41.598246360818536, 33.37842625131209, 33.55186457311113, 33.28198720266421, 41.322597871224076, 42.46868810678521, 42.075968394676835, 46.51481106380622, 47.100739949072405, 46.209620232383415, 47.57788438846667, 47.42599793275197, 47.767514926691845, 44.21827198565006, 44.00837758183479, 43.554121643304825]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14185915528938897, "mean_inference_ms": 0.6977720182525872, "mean_action_processing_ms": 0.09611771303964922, "mean_env_wait_ms": 0.789950043097039, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 785000, "timesteps_this_iter": 0, "agent_timesteps_total": 2355000, "timers": {"sample_time_ms": 12018.435, "sample_throughput": 416.028, "load_time_ms": 0.1, "load_throughput": 50219157.088, "learn_time_ms": 2084.937, "learn_throughput": 2398.154, "update_time_ms": 10.079}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.1158898314801178e-38, "cur_lr": 0.0005000000000000001, "total_loss": 9.139543151855468, "policy_loss": -0.0014579334048972826, "vf_loss": 9.243882274627685, "vf_explained_var": 0.13566781878471373, "kl": 0.002133677635038468, "entropy": 10.28810920715332, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 785000, "num_agent_steps_sampled": 2355000, "num_steps_trained": 785000, "num_agent_steps_trained": 2355000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2244, "training_iteration": 157, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-29-44", "timestamp": 1706232584, "time_this_iter_s": 11.44511890411377, "time_total_s": 1698.2004029750824, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021400813940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1698.2004029750824, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 7.76875, "ram_util_percent": 62.3}}
{"episode_reward_max": 167.71350562572482, "episode_reward_min": -283.6350773051381, "episode_reward_mean": 112.96526529486054, "episode_len_mean": 497.22, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -106.2095632950465}, "policy_reward_max": {"shared_policy": 56.243741214275346}, "policy_reward_mean": {"shared_policy": 37.655088431620186}, "custom_metrics": {}, "hist_stats": {"episode_reward": [122.44080320000646, 112.84873830527067, 166.1768071739936, 129.94275546818977, 81.71020007133481, 112.11539597064255, 135.07463781908143, 139.43943646177655, 149.12821868620804, 81.1745581086725, 117.50501052243635, 128.5832016430795, 127.21619920060037, 131.27307688421573, 134.3879014104608, 132.13676774874332, 116.15150114148855, 126.37737348675726, 131.32737620919912, 127.43587940931319, 106.98706471547483, 101.55131395277564, 76.6385534442961, 163.2835091575979, 136.71905034594232, 148.20747021678827, 119.24144928902386, 107.40102516859767, 122.93830712139604, 132.4479737132788, 102.6958606066182, 153.6484650280324, 111.43982787802814, 147.63141994271373, 124.934755560942, 139.41569055966096, -283.6350773051381, 167.71350562572482, 122.13204435259101, 151.90511372592277, 143.26552789658328, 122.79055600147694, 133.46472808718687, 165.44596934691063, 139.87059166654913, 121.2524015419185, 106.55757299065587, 127.33555624075233, 107.90922973956911, 87.24543619342145, 93.34046942368147, 119.35176232457158, 135.153921738267, 117.77831073850393, 80.68333777040243, 145.2294125854969, 100.86507566139335, 102.18861218541859, 68.43397231400012, 126.73042162507772, 38.445289151743054, 129.28577009588474, 95.46048341132698, 122.60641931369898, 106.03572011366484, 129.52691145986324, 122.79164804890752, 122.20104810036716, 94.49985885620116, 90.2778979539871, 86.89443819969891, 109.33762769121675, 159.46840573102216, 129.6786733954214, 123.09554521739483, 105.97806772403419, 72.69913367973639, 113.51940655708313, 138.47240078111585, 108.52751263702518, 107.18194416351614, 87.79960797447711, 90.43408256396648, 115.30966121517122, 126.03366627171633, 100.21227802708744, 125.86725437268612, 139.82517124526214, 142.77139724791053, 131.7807712107897, 128.88982671406114, 84.19299399852751, 65.63071608543396, 141.50389912724486, 78.92159821838138, 46.05853009223938, 74.88776521850377, 129.66591227799645, 34.273860378190875, 145.84730686992432], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 222, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [40.65811468909183, 40.883268971617014, 40.89941953929761, 37.78093383461237, 37.572170466184616, 37.495634004473686, 55.284723671774074, 55.665686849659934, 55.226396652559444, 42.649634912610054, 43.643495965749025, 43.64962458983064, 26.906683589021355, 27.48059708128372, 27.322919401029736, 37.178666320939854, 37.47736581539114, 37.45936383431156, 45.09103524436553, 45.247869686534, 44.735732888182, 46.71563261623183, 46.31030637274185, 46.41349747280279, 49.847852637991295, 49.705592118203626, 49.574773930013166, 27.163626581430435, 26.79157766699791, 27.219353860244155, 39.093348011374474, 38.97004306316376, 39.44161944789812, 43.05461924771467, 43.00556862975159, 42.52301376561323, 42.51306378965576, 42.16094474991162, 42.54219066103299, 44.150244085506216, 43.94271585221091, 43.18011694649854, 44.90587445100148, 44.885406514008835, 44.59662044545014, 44.02335104222098, 44.0764119165639, 44.03700478995839, 38.855819173157215, 38.84642916917801, 38.44925279915333, 42.146099408467606, 42.05079061289628, 42.18048346539338, 44.10042154043913, 43.51418985426426, 43.71276481449604, 42.65470163275798, 42.32450825472672, 42.45666952182849, 35.598347426702574, 35.768924334396914, 35.61979295437534, 34.13135992890844, 33.26764152447382, 34.15231249939339, 25.644918675223977, 25.267602796355874, 25.726031972716243, 54.240887100497886, 54.67795287321012, 54.36466918389003, 45.636503803233296, 45.37692728887001, 45.705619253839046, 49.357755685846016, 49.183882604042694, 49.665831926899656, 39.739514277627066, 39.86331848924358, 39.638616522153214, 35.84008503208557, 35.69996278236309, 35.860977354149014, 41.12845760087171, 41.00232798854509, 40.80752153197923, 44.00960747152567, 44.22623986378312, 44.21212637796998, 33.918425167600304, 34.21466390291849, 34.562771536099405, 51.4375159498304, 51.01297893375157, 51.19797014445065, 36.885332127412156, 37.10921223958333, 37.445283511032656, 49.08688752104838, 49.22538740684588, 49.319145014819995, 41.701818419620395, 41.66707500722259, 41.56586213409901, 47.00197012575032, 46.18888841072717, 46.224832023183495, -88.37737919638555, -89.04813481370608, -106.2095632950465, 56.243741214275346, 55.62869533896445, 55.841069072484956, 40.7411977748076, 40.89263496051231, 40.498211617271096, 51.058293840847895, 50.00207251310347, 50.84474737197159, 47.88226136316855, 47.526966383059815, 47.8563001503547, 41.36940217297524, 41.06590497493744, 40.35524885356426, 44.33113113542397, 44.59464494635661, 44.538952005406216, 55.29196933843194, 54.92096535861491, 55.233034649863825, 46.6079060609142, 46.401926899949714, 46.86075870568554, 40.68870140736301, 40.35186045368512, 40.21183968087037, 35.185044849912316, 35.85346314559379, 35.51906499514976, 42.89073314455648, 42.291362201174096, 42.15346089502175, 35.99606472750504, 36.01822122217466, 35.89494378988941, 29.190594255613775, 29.224701821493596, 28.830140116314084, 31.271551391730696, 31.32119958351055, 30.747718448440224, 39.42851675550142, 39.999841096500546, 39.923404472569615, 45.09248327091336, 45.06163250282407, 44.999805964529514, 39.26667915657163, 39.34768442064524, 39.16394716128707, 26.68777284026146, 27.159527771174908, 26.836037158966064, 48.36833908160527, 48.52394024779399, 48.33713325609763, 33.58246727287769, 33.30677120387554, 33.97583718464011, 33.972557832797364, 34.11437855412562, 34.101675798495606, 22.823318024476364, 22.865818632145718, 22.744835657378033, 42.194783225655556, 42.581230498850346, 41.95440790057182, 13.111676644533873, 13.286236679181457, 12.047375828027725, 42.83593085904916, 43.029208456476525, 43.420630780359105, 31.9267704548935, 31.48507137099901, 32.04864158543447, 41.307072697828204, 40.513932446638734, 40.78541416923204, 35.65543544913331, 35.12408241132894, 35.25620225320259, 43.16621555884679, 42.979417880376175, 43.38127802064021, 40.844034008681774, 41.18948492780328, 40.758129112422466, 40.76219649116197, 40.904387888188154, 40.53446372101703, 31.153334123392895, 31.713771378000573, 31.63275335480769, 30.17672100911537, 30.1903326238195, 29.910844321052224, 28.665821467836693, 28.89410263796647, 29.33451409389575, 35.95790499945481, 36.4631498431166, 36.916572848645345, 53.32254579290746, 52.82916091382502, 53.31669902428983, 43.16421194871266, 43.47266298423831, 43.04179846247037, 41.4398154951632, 41.26873425766826, 40.38699546456337, 35.18190062046051, 35.35747351497412, 35.43869358859956, 24.586243142218635, 24.590375921068087, 23.52251461644967, 37.967480823397636, 37.97180938720703, 37.58011634647846, 46.150284361094236, 45.93573425710201, 46.3863821629202, 36.04235628123084, 36.3329728913765, 36.152183464417845, 35.71671703706184, 35.80894729929665, 35.65627982715765, 28.992660731077194, 29.490638022311032, 29.316309221088886, 30.24240731696287, 30.26519404227534, 29.926481204728276, 38.038748145103455, 38.295202791690826, 38.97571027837694, 42.39893703038493, 42.036482880512864, 41.598246360818536, 33.37842625131209, 33.55186457311113, 33.28198720266421, 41.322597871224076, 42.46868810678521, 42.075968394676835, 46.51481106380622, 47.100739949072405, 46.209620232383415, 47.57788438846667, 47.42599793275197, 47.767514926691845, 44.21827198565006, 44.00837758183479, 43.554121643304825, 42.61460461219151, 42.88227592160304, 43.392946180266634, 28.020202053089932, 28.019173090656594, 28.153618854780987, 22.03677475452423, 21.81851029396057, 21.775431036949158, 47.204154230654225, 47.00860267877577, 47.29114221781491, 26.2320322493712, 26.095664049188287, 26.59390191982189, 15.722342789173126, 15.565053433179855, 14.771133869886398, 25.476302017457783, 24.8546324968338, 24.55683070421219, 43.10242671519518, 43.36043942719698, 43.20304613560438, 12.012805795297027, 11.664800323545933, 10.596254259347916, 48.49179694553216, 48.61423337956269, 48.741276544829205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14191795790061104, "mean_inference_ms": 0.6981534704507157, "mean_action_processing_ms": 0.09615801323765578, "mean_env_wait_ms": 0.7900554489739801, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 790000, "timesteps_this_iter": 0, "agent_timesteps_total": 2370000, "timers": {"sample_time_ms": 12031.821, "sample_throughput": 415.565, "load_time_ms": 0.1, "load_throughput": 50219157.088, "learn_time_ms": 2082.84, "learn_throughput": 2400.568, "update_time_ms": 10.18}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0579449157400589e-38, "cur_lr": 0.0005000000000000001, "total_loss": 7.433876323699951, "policy_loss": -0.001118867095012277, "vf_loss": 7.5368414402008055, "vf_explained_var": 0.04632759690284729, "kl": 0.0024221970147195785, "entropy": 10.184623432159423, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 790000, "num_agent_steps_sampled": 2370000, "num_steps_trained": 790000, "num_agent_steps_trained": 2370000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2254, "training_iteration": 158, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-29-55", "timestamp": 1706232595, "time_this_iter_s": 10.972330808639526, "time_total_s": 1709.172733783722, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D293A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1709.172733783722, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 7.899999999999999, "ram_util_percent": 62.206250000000004}}
{"episode_reward_max": 167.71350562572482, "episode_reward_min": -283.6350773051381, "episode_reward_mean": 111.00451053926952, "episode_len_mean": 497.22, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -106.2095632950465}, "policy_reward_max": {"shared_policy": 56.243741214275346}, "policy_reward_mean": {"shared_policy": 37.00150351308984}, "custom_metrics": {}, "hist_stats": {"episode_reward": [117.50501052243635, 128.5832016430795, 127.21619920060037, 131.27307688421573, 134.3879014104608, 132.13676774874332, 116.15150114148855, 126.37737348675726, 131.32737620919912, 127.43587940931319, 106.98706471547483, 101.55131395277564, 76.6385534442961, 163.2835091575979, 136.71905034594232, 148.20747021678827, 119.24144928902386, 107.40102516859767, 122.93830712139604, 132.4479737132788, 102.6958606066182, 153.6484650280324, 111.43982787802814, 147.63141994271373, 124.934755560942, 139.41569055966096, -283.6350773051381, 167.71350562572482, 122.13204435259101, 151.90511372592277, 143.26552789658328, 122.79055600147694, 133.46472808718687, 165.44596934691063, 139.87059166654913, 121.2524015419185, 106.55757299065587, 127.33555624075233, 107.90922973956911, 87.24543619342145, 93.34046942368147, 119.35176232457158, 135.153921738267, 117.77831073850393, 80.68333777040243, 145.2294125854969, 100.86507566139335, 102.18861218541859, 68.43397231400012, 126.73042162507772, 38.445289151743054, 129.28577009588474, 95.46048341132698, 122.60641931369898, 106.03572011366484, 129.52691145986324, 122.79164804890752, 122.20104810036716, 94.49985885620116, 90.2778979539871, 86.89443819969891, 109.33762769121675, 159.46840573102216, 129.6786733954214, 123.09554521739483, 105.97806772403419, 72.69913367973639, 113.51940655708313, 138.47240078111585, 108.52751263702518, 107.18194416351614, 87.79960797447711, 90.43408256396648, 115.30966121517122, 126.03366627171633, 100.21227802708744, 125.86725437268612, 139.82517124526214, 142.77139724791053, 131.7807712107897, 128.88982671406114, 84.19299399852751, 65.63071608543396, 141.50389912724486, 78.92159821838138, 46.05853009223938, 74.88776521850377, 129.66591227799645, 34.273860378190875, 145.84730686992432, 109.63727054744957, 98.98887035995722, 49.30759030580519, 102.87672439054583, 119.69674702733754, 94.8352228552103, 86.21078065037725, 105.67277956055476, 105.28649556473829, 161.46359444409606], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 222, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [39.093348011374474, 38.97004306316376, 39.44161944789812, 43.05461924771467, 43.00556862975159, 42.52301376561323, 42.51306378965576, 42.16094474991162, 42.54219066103299, 44.150244085506216, 43.94271585221091, 43.18011694649854, 44.90587445100148, 44.885406514008835, 44.59662044545014, 44.02335104222098, 44.0764119165639, 44.03700478995839, 38.855819173157215, 38.84642916917801, 38.44925279915333, 42.146099408467606, 42.05079061289628, 42.18048346539338, 44.10042154043913, 43.51418985426426, 43.71276481449604, 42.65470163275798, 42.32450825472672, 42.45666952182849, 35.598347426702574, 35.768924334396914, 35.61979295437534, 34.13135992890844, 33.26764152447382, 34.15231249939339, 25.644918675223977, 25.267602796355874, 25.726031972716243, 54.240887100497886, 54.67795287321012, 54.36466918389003, 45.636503803233296, 45.37692728887001, 45.705619253839046, 49.357755685846016, 49.183882604042694, 49.665831926899656, 39.739514277627066, 39.86331848924358, 39.638616522153214, 35.84008503208557, 35.69996278236309, 35.860977354149014, 41.12845760087171, 41.00232798854509, 40.80752153197923, 44.00960747152567, 44.22623986378312, 44.21212637796998, 33.918425167600304, 34.21466390291849, 34.562771536099405, 51.4375159498304, 51.01297893375157, 51.19797014445065, 36.885332127412156, 37.10921223958333, 37.445283511032656, 49.08688752104838, 49.22538740684588, 49.319145014819995, 41.701818419620395, 41.66707500722259, 41.56586213409901, 47.00197012575032, 46.18888841072717, 46.224832023183495, -88.37737919638555, -89.04813481370608, -106.2095632950465, 56.243741214275346, 55.62869533896445, 55.841069072484956, 40.7411977748076, 40.89263496051231, 40.498211617271096, 51.058293840847895, 50.00207251310347, 50.84474737197159, 47.88226136316855, 47.526966383059815, 47.8563001503547, 41.36940217297524, 41.06590497493744, 40.35524885356426, 44.33113113542397, 44.59464494635661, 44.538952005406216, 55.29196933843194, 54.92096535861491, 55.233034649863825, 46.6079060609142, 46.401926899949714, 46.86075870568554, 40.68870140736301, 40.35186045368512, 40.21183968087037, 35.185044849912316, 35.85346314559379, 35.51906499514976, 42.89073314455648, 42.291362201174096, 42.15346089502175, 35.99606472750504, 36.01822122217466, 35.89494378988941, 29.190594255613775, 29.224701821493596, 28.830140116314084, 31.271551391730696, 31.32119958351055, 30.747718448440224, 39.42851675550142, 39.999841096500546, 39.923404472569615, 45.09248327091336, 45.06163250282407, 44.999805964529514, 39.26667915657163, 39.34768442064524, 39.16394716128707, 26.68777284026146, 27.159527771174908, 26.836037158966064, 48.36833908160527, 48.52394024779399, 48.33713325609763, 33.58246727287769, 33.30677120387554, 33.97583718464011, 33.972557832797364, 34.11437855412562, 34.101675798495606, 22.823318024476364, 22.865818632145718, 22.744835657378033, 42.194783225655556, 42.581230498850346, 41.95440790057182, 13.111676644533873, 13.286236679181457, 12.047375828027725, 42.83593085904916, 43.029208456476525, 43.420630780359105, 31.9267704548935, 31.48507137099901, 32.04864158543447, 41.307072697828204, 40.513932446638734, 40.78541416923204, 35.65543544913331, 35.12408241132894, 35.25620225320259, 43.16621555884679, 42.979417880376175, 43.38127802064021, 40.844034008681774, 41.18948492780328, 40.758129112422466, 40.76219649116197, 40.904387888188154, 40.53446372101703, 31.153334123392895, 31.713771378000573, 31.63275335480769, 30.17672100911537, 30.1903326238195, 29.910844321052224, 28.665821467836693, 28.89410263796647, 29.33451409389575, 35.95790499945481, 36.4631498431166, 36.916572848645345, 53.32254579290746, 52.82916091382502, 53.31669902428983, 43.16421194871266, 43.47266298423831, 43.04179846247037, 41.4398154951632, 41.26873425766826, 40.38699546456337, 35.18190062046051, 35.35747351497412, 35.43869358859956, 24.586243142218635, 24.590375921068087, 23.52251461644967, 37.967480823397636, 37.97180938720703, 37.58011634647846, 46.150284361094236, 45.93573425710201, 46.3863821629202, 36.04235628123084, 36.3329728913765, 36.152183464417845, 35.71671703706184, 35.80894729929665, 35.65627982715765, 28.992660731077194, 29.490638022311032, 29.316309221088886, 30.24240731696287, 30.26519404227534, 29.926481204728276, 38.038748145103455, 38.295202791690826, 38.97571027837694, 42.39893703038493, 42.036482880512864, 41.598246360818536, 33.37842625131209, 33.55186457311113, 33.28198720266421, 41.322597871224076, 42.46868810678521, 42.075968394676835, 46.51481106380622, 47.100739949072405, 46.209620232383415, 47.57788438846667, 47.42599793275197, 47.767514926691845, 44.21827198565006, 44.00837758183479, 43.554121643304825, 42.61460461219151, 42.88227592160304, 43.392946180266634, 28.020202053089932, 28.019173090656594, 28.153618854780987, 22.03677475452423, 21.81851029396057, 21.775431036949158, 47.204154230654225, 47.00860267877577, 47.29114221781491, 26.2320322493712, 26.095664049188287, 26.59390191982189, 15.722342789173126, 15.565053433179855, 14.771133869886398, 25.476302017457783, 24.8546324968338, 24.55683070421219, 43.10242671519518, 43.36043942719698, 43.20304613560438, 12.012805795297027, 11.664800323545933, 10.596254259347916, 48.49179694553216, 48.61423337956269, 48.741276544829205, 36.318909530838326, 36.65562928219636, 36.66273173441489, 32.75759916007519, 33.117104314267635, 33.114166885614395, 16.278352213402584, 16.446117234726742, 16.583120857675866, 34.18879572550455, 34.57191736336486, 34.11601130167642, 40.163270620008305, 39.95794494946797, 39.57553145786126, 31.608861848711967, 31.448361814022064, 31.777999192476273, 28.92258434991041, 28.74960123995939, 28.538595060507447, 35.37362153253828, 35.2806758445998, 35.01848218341668, 34.87309382110834, 35.30053045065142, 35.112871292978525, 53.40022046367328, 53.85315265754859, 54.21022132287423]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1419527282675369, "mean_inference_ms": 0.6984315990757192, "mean_action_processing_ms": 0.0961883960263968, "mean_env_wait_ms": 0.7900844231682785, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 795000, "timesteps_this_iter": 0, "agent_timesteps_total": 2385000, "timers": {"sample_time_ms": 11878.732, "sample_throughput": 420.92, "load_time_ms": 0.1, "load_throughput": 50219157.088, "learn_time_ms": 2094.986, "learn_throughput": 2386.651, "update_time_ms": 10.373}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.2897245787002946e-39, "cur_lr": 0.0005000000000000001, "total_loss": 7.074065256118774, "policy_loss": -0.0015007743705327758, "vf_loss": 7.179052829742432, "vf_explained_var": 0.02559543251991272, "kl": 0.00250038673698443, "entropy": 10.34867296218872, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 795000, "num_agent_steps_sampled": 2385000, "num_steps_trained": 795000, "num_agent_steps_trained": 2385000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2264, "training_iteration": 159, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-30-06", "timestamp": 1706232606, "time_this_iter_s": 10.987669467926025, "time_total_s": 1720.160403251648, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002146F7DD1F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1720.160403251648, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 6.879999999999999, "ram_util_percent": 62.34666666666666}}
{"episode_reward_max": 167.71350562572482, "episode_reward_min": -283.6350773051381, "episode_reward_mean": 108.41680146538882, "episode_len_mean": 497.22, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -106.2095632950465}, "policy_reward_max": {"shared_policy": 56.243741214275346}, "policy_reward_mean": {"shared_policy": 36.13893382179628}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.98706471547483, 101.55131395277564, 76.6385534442961, 163.2835091575979, 136.71905034594232, 148.20747021678827, 119.24144928902386, 107.40102516859767, 122.93830712139604, 132.4479737132788, 102.6958606066182, 153.6484650280324, 111.43982787802814, 147.63141994271373, 124.934755560942, 139.41569055966096, -283.6350773051381, 167.71350562572482, 122.13204435259101, 151.90511372592277, 143.26552789658328, 122.79055600147694, 133.46472808718687, 165.44596934691063, 139.87059166654913, 121.2524015419185, 106.55757299065587, 127.33555624075233, 107.90922973956911, 87.24543619342145, 93.34046942368147, 119.35176232457158, 135.153921738267, 117.77831073850393, 80.68333777040243, 145.2294125854969, 100.86507566139335, 102.18861218541859, 68.43397231400012, 126.73042162507772, 38.445289151743054, 129.28577009588474, 95.46048341132698, 122.60641931369898, 106.03572011366484, 129.52691145986324, 122.79164804890752, 122.20104810036716, 94.49985885620116, 90.2778979539871, 86.89443819969891, 109.33762769121675, 159.46840573102216, 129.6786733954214, 123.09554521739483, 105.97806772403419, 72.69913367973639, 113.51940655708313, 138.47240078111585, 108.52751263702518, 107.18194416351614, 87.79960797447711, 90.43408256396648, 115.30966121517122, 126.03366627171633, 100.21227802708744, 125.86725437268612, 139.82517124526214, 142.77139724791053, 131.7807712107897, 128.88982671406114, 84.19299399852751, 65.63071608543396, 141.50389912724486, 78.92159821838138, 46.05853009223938, 74.88776521850377, 129.66591227799645, 34.273860378190875, 145.84730686992432, 109.63727054744957, 98.98887035995722, 49.30759030580519, 102.87672439054583, 119.69674702733754, 94.8352228552103, 86.21078065037725, 105.67277956055476, 105.28649556473829, 161.46359444409606, 52.030442090006545, 134.10454852366826, 134.81398713914666, 99.77304358733815, 102.58738779276607, 129.68345360085385, 90.46199790388344, 135.1755575085991, 43.22068928927182, 91.77227283269166], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 222, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [35.598347426702574, 35.768924334396914, 35.61979295437534, 34.13135992890844, 33.26764152447382, 34.15231249939339, 25.644918675223977, 25.267602796355874, 25.726031972716243, 54.240887100497886, 54.67795287321012, 54.36466918389003, 45.636503803233296, 45.37692728887001, 45.705619253839046, 49.357755685846016, 49.183882604042694, 49.665831926899656, 39.739514277627066, 39.86331848924358, 39.638616522153214, 35.84008503208557, 35.69996278236309, 35.860977354149014, 41.12845760087171, 41.00232798854509, 40.80752153197923, 44.00960747152567, 44.22623986378312, 44.21212637796998, 33.918425167600304, 34.21466390291849, 34.562771536099405, 51.4375159498304, 51.01297893375157, 51.19797014445065, 36.885332127412156, 37.10921223958333, 37.445283511032656, 49.08688752104838, 49.22538740684588, 49.319145014819995, 41.701818419620395, 41.66707500722259, 41.56586213409901, 47.00197012575032, 46.18888841072717, 46.224832023183495, -88.37737919638555, -89.04813481370608, -106.2095632950465, 56.243741214275346, 55.62869533896445, 55.841069072484956, 40.7411977748076, 40.89263496051231, 40.498211617271096, 51.058293840847895, 50.00207251310347, 50.84474737197159, 47.88226136316855, 47.526966383059815, 47.8563001503547, 41.36940217297524, 41.06590497493744, 40.35524885356426, 44.33113113542397, 44.59464494635661, 44.538952005406216, 55.29196933843194, 54.92096535861491, 55.233034649863825, 46.6079060609142, 46.401926899949714, 46.86075870568554, 40.68870140736301, 40.35186045368512, 40.21183968087037, 35.185044849912316, 35.85346314559379, 35.51906499514976, 42.89073314455648, 42.291362201174096, 42.15346089502175, 35.99606472750504, 36.01822122217466, 35.89494378988941, 29.190594255613775, 29.224701821493596, 28.830140116314084, 31.271551391730696, 31.32119958351055, 30.747718448440224, 39.42851675550142, 39.999841096500546, 39.923404472569615, 45.09248327091336, 45.06163250282407, 44.999805964529514, 39.26667915657163, 39.34768442064524, 39.16394716128707, 26.68777284026146, 27.159527771174908, 26.836037158966064, 48.36833908160527, 48.52394024779399, 48.33713325609763, 33.58246727287769, 33.30677120387554, 33.97583718464011, 33.972557832797364, 34.11437855412562, 34.101675798495606, 22.823318024476364, 22.865818632145718, 22.744835657378033, 42.194783225655556, 42.581230498850346, 41.95440790057182, 13.111676644533873, 13.286236679181457, 12.047375828027725, 42.83593085904916, 43.029208456476525, 43.420630780359105, 31.9267704548935, 31.48507137099901, 32.04864158543447, 41.307072697828204, 40.513932446638734, 40.78541416923204, 35.65543544913331, 35.12408241132894, 35.25620225320259, 43.16621555884679, 42.979417880376175, 43.38127802064021, 40.844034008681774, 41.18948492780328, 40.758129112422466, 40.76219649116197, 40.904387888188154, 40.53446372101703, 31.153334123392895, 31.713771378000573, 31.63275335480769, 30.17672100911537, 30.1903326238195, 29.910844321052224, 28.665821467836693, 28.89410263796647, 29.33451409389575, 35.95790499945481, 36.4631498431166, 36.916572848645345, 53.32254579290746, 52.82916091382502, 53.31669902428983, 43.16421194871266, 43.47266298423831, 43.04179846247037, 41.4398154951632, 41.26873425766826, 40.38699546456337, 35.18190062046051, 35.35747351497412, 35.43869358859956, 24.586243142218635, 24.590375921068087, 23.52251461644967, 37.967480823397636, 37.97180938720703, 37.58011634647846, 46.150284361094236, 45.93573425710201, 46.3863821629202, 36.04235628123084, 36.3329728913765, 36.152183464417845, 35.71671703706184, 35.80894729929665, 35.65627982715765, 28.992660731077194, 29.490638022311032, 29.316309221088886, 30.24240731696287, 30.26519404227534, 29.926481204728276, 38.038748145103455, 38.295202791690826, 38.97571027837694, 42.39893703038493, 42.036482880512864, 41.598246360818536, 33.37842625131209, 33.55186457311113, 33.28198720266421, 41.322597871224076, 42.46868810678521, 42.075968394676835, 46.51481106380622, 47.100739949072405, 46.209620232383415, 47.57788438846667, 47.42599793275197, 47.767514926691845, 44.21827198565006, 44.00837758183479, 43.554121643304825, 42.61460461219151, 42.88227592160304, 43.392946180266634, 28.020202053089932, 28.019173090656594, 28.153618854780987, 22.03677475452423, 21.81851029396057, 21.775431036949158, 47.204154230654225, 47.00860267877577, 47.29114221781491, 26.2320322493712, 26.095664049188287, 26.59390191982189, 15.722342789173126, 15.565053433179855, 14.771133869886398, 25.476302017457783, 24.8546324968338, 24.55683070421219, 43.10242671519518, 43.36043942719698, 43.20304613560438, 12.012805795297027, 11.664800323545933, 10.596254259347916, 48.49179694553216, 48.61423337956269, 48.741276544829205, 36.318909530838326, 36.65562928219636, 36.66273173441489, 32.75759916007519, 33.117104314267635, 33.114166885614395, 16.278352213402584, 16.446117234726742, 16.583120857675866, 34.18879572550455, 34.57191736336486, 34.11601130167642, 40.163270620008305, 39.95794494946797, 39.57553145786126, 31.608861848711967, 31.448361814022064, 31.777999192476273, 28.92258434991041, 28.74960123995939, 28.538595060507447, 35.37362153253828, 35.2806758445998, 35.01848218341668, 34.87309382110834, 35.30053045065142, 35.112871292978525, 53.40022046367328, 53.85315265754859, 54.21022132287423, 17.117227599024773, 17.221152655780315, 17.692061835201457, 44.74658256272474, 44.302134344975144, 45.05583161596829, 45.165520331046224, 44.76948786030212, 44.8789789477984, 33.40934662769237, 33.55959768795097, 32.80409927169481, 34.25290152678886, 34.19727249319354, 34.13721377278367, 43.05538358539343, 43.189618460834026, 43.438451554626226, 30.14704495420058, 29.976868850489453, 30.33808409919341, 44.62966366112232, 44.88108253479004, 45.66481131268665, 14.58907739942272, 13.960389976700142, 14.671221913148955, 30.685562026997403, 30.35957148422797, 30.727139321466282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14198659993540075, "mean_inference_ms": 0.6987093186729844, "mean_action_processing_ms": 0.09621401478912052, "mean_env_wait_ms": 0.7901099156951112, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 800000, "timesteps_this_iter": 0, "agent_timesteps_total": 2400000, "timers": {"sample_time_ms": 11879.938, "sample_throughput": 420.878, "load_time_ms": 0.1, "load_throughput": 50219157.088, "learn_time_ms": 2095.749, "learn_throughput": 2385.782, "update_time_ms": 10.414}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.6448622893501473e-39, "cur_lr": 0.0005000000000000001, "total_loss": 7.065499782562256, "policy_loss": -0.0006373264250582267, "vf_loss": 7.168876361846924, "vf_explained_var": -0.011688232421875, "kl": 0.0027824651566786605, "entropy": 10.273954963684082, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 800000, "num_agent_steps_sampled": 2400000, "num_steps_trained": 800000, "num_agent_steps_trained": 2400000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2274, "training_iteration": 160, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-30-17", "timestamp": 1706232617, "time_this_iter_s": 11.149391174316406, "time_total_s": 1731.3097944259644, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140424F8B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1731.3097944259644, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 6.699999999999999, "ram_util_percent": 62.33125}}
{"episode_reward_max": 167.71350562572482, "episode_reward_min": -283.6350773051381, "episode_reward_mean": 101.04403863267972, "episode_len_mean": 492.83, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -106.2095632950465}, "policy_reward_max": {"shared_policy": 56.243741214275346}, "policy_reward_mean": {"shared_policy": 33.681346210893246}, "custom_metrics": {}, "hist_stats": {"episode_reward": [111.43982787802814, 147.63141994271373, 124.934755560942, 139.41569055966096, -283.6350773051381, 167.71350562572482, 122.13204435259101, 151.90511372592277, 143.26552789658328, 122.79055600147694, 133.46472808718687, 165.44596934691063, 139.87059166654913, 121.2524015419185, 106.55757299065587, 127.33555624075233, 107.90922973956911, 87.24543619342145, 93.34046942368147, 119.35176232457158, 135.153921738267, 117.77831073850393, 80.68333777040243, 145.2294125854969, 100.86507566139335, 102.18861218541859, 68.43397231400012, 126.73042162507772, 38.445289151743054, 129.28577009588474, 95.46048341132698, 122.60641931369898, 106.03572011366484, 129.52691145986324, 122.79164804890752, 122.20104810036716, 94.49985885620116, 90.2778979539871, 86.89443819969891, 109.33762769121675, 159.46840573102216, 129.6786733954214, 123.09554521739483, 105.97806772403419, 72.69913367973639, 113.51940655708313, 138.47240078111585, 108.52751263702518, 107.18194416351614, 87.79960797447711, 90.43408256396648, 115.30966121517122, 126.03366627171633, 100.21227802708744, 125.86725437268612, 139.82517124526214, 142.77139724791053, 131.7807712107897, 128.88982671406114, 84.19299399852751, 65.63071608543396, 141.50389912724486, 78.92159821838138, 46.05853009223938, 74.88776521850377, 129.66591227799645, 34.273860378190875, 145.84730686992432, 109.63727054744957, 98.98887035995722, 49.30759030580519, 102.87672439054583, 119.69674702733754, 94.8352228552103, 86.21078065037725, 105.67277956055476, 105.28649556473829, 161.46359444409606, 52.030442090006545, 134.10454852366826, 134.81398713914666, 99.77304358733815, 102.58738779276607, 129.68345360085385, 90.46199790388344, 135.1755575085991, 43.22068928927182, 91.77227283269166, 140.5483671892434, 116.28110626339911, 105.72648086398837, 139.72010543756195, -256.8339165300131, 158.2229510825126, 131.12963367067283, -274.76691576465964, 145.22717176377782, 112.9151337556541, 96.35493125021458, 119.9587105065584], "episode_lengths": [500, 500, 500, 500, 222, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 259, 500, 500, 500, 500], "policy_shared_policy_reward": [36.885332127412156, 37.10921223958333, 37.445283511032656, 49.08688752104838, 49.22538740684588, 49.319145014819995, 41.701818419620395, 41.66707500722259, 41.56586213409901, 47.00197012575032, 46.18888841072717, 46.224832023183495, -88.37737919638555, -89.04813481370608, -106.2095632950465, 56.243741214275346, 55.62869533896445, 55.841069072484956, 40.7411977748076, 40.89263496051231, 40.498211617271096, 51.058293840847895, 50.00207251310347, 50.84474737197159, 47.88226136316855, 47.526966383059815, 47.8563001503547, 41.36940217297524, 41.06590497493744, 40.35524885356426, 44.33113113542397, 44.59464494635661, 44.538952005406216, 55.29196933843194, 54.92096535861491, 55.233034649863825, 46.6079060609142, 46.401926899949714, 46.86075870568554, 40.68870140736301, 40.35186045368512, 40.21183968087037, 35.185044849912316, 35.85346314559379, 35.51906499514976, 42.89073314455648, 42.291362201174096, 42.15346089502175, 35.99606472750504, 36.01822122217466, 35.89494378988941, 29.190594255613775, 29.224701821493596, 28.830140116314084, 31.271551391730696, 31.32119958351055, 30.747718448440224, 39.42851675550142, 39.999841096500546, 39.923404472569615, 45.09248327091336, 45.06163250282407, 44.999805964529514, 39.26667915657163, 39.34768442064524, 39.16394716128707, 26.68777284026146, 27.159527771174908, 26.836037158966064, 48.36833908160527, 48.52394024779399, 48.33713325609763, 33.58246727287769, 33.30677120387554, 33.97583718464011, 33.972557832797364, 34.11437855412562, 34.101675798495606, 22.823318024476364, 22.865818632145718, 22.744835657378033, 42.194783225655556, 42.581230498850346, 41.95440790057182, 13.111676644533873, 13.286236679181457, 12.047375828027725, 42.83593085904916, 43.029208456476525, 43.420630780359105, 31.9267704548935, 31.48507137099901, 32.04864158543447, 41.307072697828204, 40.513932446638734, 40.78541416923204, 35.65543544913331, 35.12408241132894, 35.25620225320259, 43.16621555884679, 42.979417880376175, 43.38127802064021, 40.844034008681774, 41.18948492780328, 40.758129112422466, 40.76219649116197, 40.904387888188154, 40.53446372101703, 31.153334123392895, 31.713771378000573, 31.63275335480769, 30.17672100911537, 30.1903326238195, 29.910844321052224, 28.665821467836693, 28.89410263796647, 29.33451409389575, 35.95790499945481, 36.4631498431166, 36.916572848645345, 53.32254579290746, 52.82916091382502, 53.31669902428983, 43.16421194871266, 43.47266298423831, 43.04179846247037, 41.4398154951632, 41.26873425766826, 40.38699546456337, 35.18190062046051, 35.35747351497412, 35.43869358859956, 24.586243142218635, 24.590375921068087, 23.52251461644967, 37.967480823397636, 37.97180938720703, 37.58011634647846, 46.150284361094236, 45.93573425710201, 46.3863821629202, 36.04235628123084, 36.3329728913765, 36.152183464417845, 35.71671703706184, 35.80894729929665, 35.65627982715765, 28.992660731077194, 29.490638022311032, 29.316309221088886, 30.24240731696287, 30.26519404227534, 29.926481204728276, 38.038748145103455, 38.295202791690826, 38.97571027837694, 42.39893703038493, 42.036482880512864, 41.598246360818536, 33.37842625131209, 33.55186457311113, 33.28198720266421, 41.322597871224076, 42.46868810678521, 42.075968394676835, 46.51481106380622, 47.100739949072405, 46.209620232383415, 47.57788438846667, 47.42599793275197, 47.767514926691845, 44.21827198565006, 44.00837758183479, 43.554121643304825, 42.61460461219151, 42.88227592160304, 43.392946180266634, 28.020202053089932, 28.019173090656594, 28.153618854780987, 22.03677475452423, 21.81851029396057, 21.775431036949158, 47.204154230654225, 47.00860267877577, 47.29114221781491, 26.2320322493712, 26.095664049188287, 26.59390191982189, 15.722342789173126, 15.565053433179855, 14.771133869886398, 25.476302017457783, 24.8546324968338, 24.55683070421219, 43.10242671519518, 43.36043942719698, 43.20304613560438, 12.012805795297027, 11.664800323545933, 10.596254259347916, 48.49179694553216, 48.61423337956269, 48.741276544829205, 36.318909530838326, 36.65562928219636, 36.66273173441489, 32.75759916007519, 33.117104314267635, 33.114166885614395, 16.278352213402584, 16.446117234726742, 16.583120857675866, 34.18879572550455, 34.57191736336486, 34.11601130167642, 40.163270620008305, 39.95794494946797, 39.57553145786126, 31.608861848711967, 31.448361814022064, 31.777999192476273, 28.92258434991041, 28.74960123995939, 28.538595060507447, 35.37362153253828, 35.2806758445998, 35.01848218341668, 34.87309382110834, 35.30053045065142, 35.112871292978525, 53.40022046367328, 53.85315265754859, 54.21022132287423, 17.117227599024773, 17.221152655780315, 17.692061835201457, 44.74658256272474, 44.302134344975144, 45.05583161596829, 45.165520331046224, 44.76948786030212, 44.8789789477984, 33.40934662769237, 33.55959768795097, 32.80409927169481, 34.25290152678886, 34.19727249319354, 34.13721377278367, 43.05538358539343, 43.189618460834026, 43.438451554626226, 30.14704495420058, 29.976868850489453, 30.33808409919341, 44.62966366112232, 44.88108253479004, 45.66481131268665, 14.58907739942272, 13.960389976700142, 14.671221913148955, 30.685562026997403, 30.35957148422797, 30.727139321466282, 46.74169651418923, 46.5949546843767, 47.21171599067746, 37.364440490802124, 39.264806290467575, 39.65185948212941, 35.11081092307964, 35.31086759890118, 35.30480234200755, 46.4948715120554, 46.37310864776373, 46.85212527774274, -85.31834869335096, -85.60098885248105, -85.91457898418109, 52.60398645699023, 52.55635448545216, 53.062610140070305, 43.25363026559353, 43.81872461736202, 44.05727878771722, -103.03561969598135, -86.18722452720007, -85.54407154147825, 48.20354513327281, 48.75274560848872, 48.27088102201621, 37.34077478945255, 37.71571456640959, 37.858644399791956, 32.10952325165272, 32.24371975660324, 32.00168824195862, 40.371460412939385, 39.828690384825066, 39.75855970879395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14203766761648448, "mean_inference_ms": 0.69905712970279, "mean_action_processing_ms": 0.09628473212825377, "mean_env_wait_ms": 0.7900778672251251, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 805000, "timesteps_this_iter": 0, "agent_timesteps_total": 2415000, "timers": {"sample_time_ms": 11141.803, "sample_throughput": 448.76, "load_time_ms": 0.1, "load_throughput": 50219157.088, "learn_time_ms": 2098.963, "learn_throughput": 2382.129, "update_time_ms": 10.414}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3224311446750736e-39, "cur_lr": 0.0005000000000000001, "total_loss": 231.6550033569336, "policy_loss": -0.001525277609652842, "vf_loss": 231.75894317626953, "vf_explained_var": 0.05040790438652039, "kl": 0.0033533753944095476, "entropy": 10.24203405380249, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 805000, "num_agent_steps_sampled": 2415000, "num_steps_trained": 805000, "num_agent_steps_trained": 2415000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2286, "training_iteration": 161, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-30-28", "timestamp": 1706232628, "time_this_iter_s": 10.958986759185791, "time_total_s": 1742.2687811851501, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D103A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1742.2687811851501, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 7.000000000000001, "ram_util_percent": 62.324999999999996}}
{"episode_reward_max": 165.44596934691063, "episode_reward_min": -274.76691576465964, "episode_reward_mean": 101.36607766320111, "episode_len_mean": 495.61, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -103.03561969598135}, "policy_reward_max": {"shared_policy": 55.29196933843194}, "policy_reward_mean": {"shared_policy": 33.78869255440038}, "custom_metrics": {}, "hist_stats": {"episode_reward": [133.46472808718687, 165.44596934691063, 139.87059166654913, 121.2524015419185, 106.55757299065587, 127.33555624075233, 107.90922973956911, 87.24543619342145, 93.34046942368147, 119.35176232457158, 135.153921738267, 117.77831073850393, 80.68333777040243, 145.2294125854969, 100.86507566139335, 102.18861218541859, 68.43397231400012, 126.73042162507772, 38.445289151743054, 129.28577009588474, 95.46048341132698, 122.60641931369898, 106.03572011366484, 129.52691145986324, 122.79164804890752, 122.20104810036716, 94.49985885620116, 90.2778979539871, 86.89443819969891, 109.33762769121675, 159.46840573102216, 129.6786733954214, 123.09554521739483, 105.97806772403419, 72.69913367973639, 113.51940655708313, 138.47240078111585, 108.52751263702518, 107.18194416351614, 87.79960797447711, 90.43408256396648, 115.30966121517122, 126.03366627171633, 100.21227802708744, 125.86725437268612, 139.82517124526214, 142.77139724791053, 131.7807712107897, 128.88982671406114, 84.19299399852751, 65.63071608543396, 141.50389912724486, 78.92159821838138, 46.05853009223938, 74.88776521850377, 129.66591227799645, 34.273860378190875, 145.84730686992432, 109.63727054744957, 98.98887035995722, 49.30759030580519, 102.87672439054583, 119.69674702733754, 94.8352228552103, 86.21078065037725, 105.67277956055476, 105.28649556473829, 161.46359444409606, 52.030442090006545, 134.10454852366826, 134.81398713914666, 99.77304358733815, 102.58738779276607, 129.68345360085385, 90.46199790388344, 135.1755575085991, 43.22068928927182, 91.77227283269166, 140.5483671892434, 116.28110626339911, 105.72648086398837, 139.72010543756195, -256.8339165300131, 158.2229510825126, 131.12963367067283, -274.76691576465964, 145.22717176377782, 112.9151337556541, 96.35493125021458, 119.9587105065584, 125.66843081451952, 124.24316695146263, 61.84237842820583, 113.33701720694079, 110.97970009595156, 98.27357029030097, 75.9966181562049, 77.30360133294015, 75.91303378343582, 116.23975023068486], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 259, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [44.33113113542397, 44.59464494635661, 44.538952005406216, 55.29196933843194, 54.92096535861491, 55.233034649863825, 46.6079060609142, 46.401926899949714, 46.86075870568554, 40.68870140736301, 40.35186045368512, 40.21183968087037, 35.185044849912316, 35.85346314559379, 35.51906499514976, 42.89073314455648, 42.291362201174096, 42.15346089502175, 35.99606472750504, 36.01822122217466, 35.89494378988941, 29.190594255613775, 29.224701821493596, 28.830140116314084, 31.271551391730696, 31.32119958351055, 30.747718448440224, 39.42851675550142, 39.999841096500546, 39.923404472569615, 45.09248327091336, 45.06163250282407, 44.999805964529514, 39.26667915657163, 39.34768442064524, 39.16394716128707, 26.68777284026146, 27.159527771174908, 26.836037158966064, 48.36833908160527, 48.52394024779399, 48.33713325609763, 33.58246727287769, 33.30677120387554, 33.97583718464011, 33.972557832797364, 34.11437855412562, 34.101675798495606, 22.823318024476364, 22.865818632145718, 22.744835657378033, 42.194783225655556, 42.581230498850346, 41.95440790057182, 13.111676644533873, 13.286236679181457, 12.047375828027725, 42.83593085904916, 43.029208456476525, 43.420630780359105, 31.9267704548935, 31.48507137099901, 32.04864158543447, 41.307072697828204, 40.513932446638734, 40.78541416923204, 35.65543544913331, 35.12408241132894, 35.25620225320259, 43.16621555884679, 42.979417880376175, 43.38127802064021, 40.844034008681774, 41.18948492780328, 40.758129112422466, 40.76219649116197, 40.904387888188154, 40.53446372101703, 31.153334123392895, 31.713771378000573, 31.63275335480769, 30.17672100911537, 30.1903326238195, 29.910844321052224, 28.665821467836693, 28.89410263796647, 29.33451409389575, 35.95790499945481, 36.4631498431166, 36.916572848645345, 53.32254579290746, 52.82916091382502, 53.31669902428983, 43.16421194871266, 43.47266298423831, 43.04179846247037, 41.4398154951632, 41.26873425766826, 40.38699546456337, 35.18190062046051, 35.35747351497412, 35.43869358859956, 24.586243142218635, 24.590375921068087, 23.52251461644967, 37.967480823397636, 37.97180938720703, 37.58011634647846, 46.150284361094236, 45.93573425710201, 46.3863821629202, 36.04235628123084, 36.3329728913765, 36.152183464417845, 35.71671703706184, 35.80894729929665, 35.65627982715765, 28.992660731077194, 29.490638022311032, 29.316309221088886, 30.24240731696287, 30.26519404227534, 29.926481204728276, 38.038748145103455, 38.295202791690826, 38.97571027837694, 42.39893703038493, 42.036482880512864, 41.598246360818536, 33.37842625131209, 33.55186457311113, 33.28198720266421, 41.322597871224076, 42.46868810678521, 42.075968394676835, 46.51481106380622, 47.100739949072405, 46.209620232383415, 47.57788438846667, 47.42599793275197, 47.767514926691845, 44.21827198565006, 44.00837758183479, 43.554121643304825, 42.61460461219151, 42.88227592160304, 43.392946180266634, 28.020202053089932, 28.019173090656594, 28.153618854780987, 22.03677475452423, 21.81851029396057, 21.775431036949158, 47.204154230654225, 47.00860267877577, 47.29114221781491, 26.2320322493712, 26.095664049188287, 26.59390191982189, 15.722342789173126, 15.565053433179855, 14.771133869886398, 25.476302017457783, 24.8546324968338, 24.55683070421219, 43.10242671519518, 43.36043942719698, 43.20304613560438, 12.012805795297027, 11.664800323545933, 10.596254259347916, 48.49179694553216, 48.61423337956269, 48.741276544829205, 36.318909530838326, 36.65562928219636, 36.66273173441489, 32.75759916007519, 33.117104314267635, 33.114166885614395, 16.278352213402584, 16.446117234726742, 16.583120857675866, 34.18879572550455, 34.57191736336486, 34.11601130167642, 40.163270620008305, 39.95794494946797, 39.57553145786126, 31.608861848711967, 31.448361814022064, 31.777999192476273, 28.92258434991041, 28.74960123995939, 28.538595060507447, 35.37362153253828, 35.2806758445998, 35.01848218341668, 34.87309382110834, 35.30053045065142, 35.112871292978525, 53.40022046367328, 53.85315265754859, 54.21022132287423, 17.117227599024773, 17.221152655780315, 17.692061835201457, 44.74658256272474, 44.302134344975144, 45.05583161596829, 45.165520331046224, 44.76948786030212, 44.8789789477984, 33.40934662769237, 33.55959768795097, 32.80409927169481, 34.25290152678886, 34.19727249319354, 34.13721377278367, 43.05538358539343, 43.189618460834026, 43.438451554626226, 30.14704495420058, 29.976868850489453, 30.33808409919341, 44.62966366112232, 44.88108253479004, 45.66481131268665, 14.58907739942272, 13.960389976700142, 14.671221913148955, 30.685562026997403, 30.35957148422797, 30.727139321466282, 46.74169651418923, 46.5949546843767, 47.21171599067746, 37.364440490802124, 39.264806290467575, 39.65185948212941, 35.11081092307964, 35.31086759890118, 35.30480234200755, 46.4948715120554, 46.37310864776373, 46.85212527774274, -85.31834869335096, -85.60098885248105, -85.91457898418109, 52.60398645699023, 52.55635448545216, 53.062610140070305, 43.25363026559353, 43.81872461736202, 44.05727878771722, -103.03561969598135, -86.18722452720007, -85.54407154147825, 48.20354513327281, 48.75274560848872, 48.27088102201621, 37.34077478945255, 37.71571456640959, 37.858644399791956, 32.10952325165272, 32.24371975660324, 32.00168824195862, 40.371460412939385, 39.828690384825066, 39.75855970879395, 41.872894898056984, 41.812491439282894, 41.98304447717965, 41.04101075232029, 41.39033282548189, 41.811823373660445, 20.500086826582745, 20.64808813979228, 20.69420346183081, 38.07411634906505, 37.357324709494904, 37.90557614838083, 37.294020891189575, 36.81271830201149, 36.87296090275049, 32.47407772640386, 32.660215246180684, 33.13927731771642, 25.499584864398145, 25.202065526197345, 25.294967765609414, 25.93166783669342, 25.85730494682987, 25.514628549416855, 25.043688789010048, 25.406805463135242, 25.46253953129053, 38.821607549985245, 39.28668866989513, 38.13145401080449]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1420581227448625, "mean_inference_ms": 0.6993299038977336, "mean_action_processing_ms": 0.09629081498463231, "mean_env_wait_ms": 0.7901444280516999, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 810000, "timesteps_this_iter": 0, "agent_timesteps_total": 2430000, "timers": {"sample_time_ms": 11183.721, "sample_throughput": 447.078, "load_time_ms": 0.1, "load_throughput": 50219157.088, "learn_time_ms": 2101.027, "learn_throughput": 2379.789, "update_time_ms": 9.814}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.612155723375368e-40, "cur_lr": 0.0005000000000000001, "total_loss": 10.495745182037354, "policy_loss": -0.0009736272015104408, "vf_loss": 10.600961494445801, "vf_explained_var": -0.08266786336898804, "kl": 0.0021579160122687886, "entropy": 10.424263000488281, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 810000, "num_agent_steps_sampled": 2430000, "num_steps_trained": 810000, "num_agent_steps_trained": 2430000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2296, "training_iteration": 162, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-30-39", "timestamp": 1706232639, "time_this_iter_s": 10.79483413696289, "time_total_s": 1753.063615322113, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D10CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1753.063615322113, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 7.7266666666666675, "ram_util_percent": 62.33999999999999}}
{"episode_reward_max": 161.46359444409606, "episode_reward_min": -274.76691576465964, "episode_reward_mean": 100.80292573941523, "episode_len_mean": 495.61, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -103.03561969598135}, "policy_reward_max": {"shared_policy": 54.21022132287423}, "policy_reward_mean": {"shared_policy": 33.60097524647173}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.153921738267, 117.77831073850393, 80.68333777040243, 145.2294125854969, 100.86507566139335, 102.18861218541859, 68.43397231400012, 126.73042162507772, 38.445289151743054, 129.28577009588474, 95.46048341132698, 122.60641931369898, 106.03572011366484, 129.52691145986324, 122.79164804890752, 122.20104810036716, 94.49985885620116, 90.2778979539871, 86.89443819969891, 109.33762769121675, 159.46840573102216, 129.6786733954214, 123.09554521739483, 105.97806772403419, 72.69913367973639, 113.51940655708313, 138.47240078111585, 108.52751263702518, 107.18194416351614, 87.79960797447711, 90.43408256396648, 115.30966121517122, 126.03366627171633, 100.21227802708744, 125.86725437268612, 139.82517124526214, 142.77139724791053, 131.7807712107897, 128.88982671406114, 84.19299399852751, 65.63071608543396, 141.50389912724486, 78.92159821838138, 46.05853009223938, 74.88776521850377, 129.66591227799645, 34.273860378190875, 145.84730686992432, 109.63727054744957, 98.98887035995722, 49.30759030580519, 102.87672439054583, 119.69674702733754, 94.8352228552103, 86.21078065037725, 105.67277956055476, 105.28649556473829, 161.46359444409606, 52.030442090006545, 134.10454852366826, 134.81398713914666, 99.77304358733815, 102.58738779276607, 129.68345360085385, 90.46199790388344, 135.1755575085991, 43.22068928927182, 91.77227283269166, 140.5483671892434, 116.28110626339911, 105.72648086398837, 139.72010543756195, -256.8339165300131, 158.2229510825126, 131.12963367067283, -274.76691576465964, 145.22717176377782, 112.9151337556541, 96.35493125021458, 119.9587105065584, 125.66843081451952, 124.24316695146263, 61.84237842820583, 113.33701720694079, 110.97970009595156, 98.27357029030097, 75.9966181562049, 77.30360133294015, 75.91303378343582, 116.23975023068486, 121.17680274881423, 99.46048504486677, 88.84649420902132, 101.69978922978042, 103.77098914608358, 125.12166463956234, 114.87179277837274, 144.99244096828625, 129.29785605520004, 116.2202103566378], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 259, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [45.09248327091336, 45.06163250282407, 44.999805964529514, 39.26667915657163, 39.34768442064524, 39.16394716128707, 26.68777284026146, 27.159527771174908, 26.836037158966064, 48.36833908160527, 48.52394024779399, 48.33713325609763, 33.58246727287769, 33.30677120387554, 33.97583718464011, 33.972557832797364, 34.11437855412562, 34.101675798495606, 22.823318024476364, 22.865818632145718, 22.744835657378033, 42.194783225655556, 42.581230498850346, 41.95440790057182, 13.111676644533873, 13.286236679181457, 12.047375828027725, 42.83593085904916, 43.029208456476525, 43.420630780359105, 31.9267704548935, 31.48507137099901, 32.04864158543447, 41.307072697828204, 40.513932446638734, 40.78541416923204, 35.65543544913331, 35.12408241132894, 35.25620225320259, 43.16621555884679, 42.979417880376175, 43.38127802064021, 40.844034008681774, 41.18948492780328, 40.758129112422466, 40.76219649116197, 40.904387888188154, 40.53446372101703, 31.153334123392895, 31.713771378000573, 31.63275335480769, 30.17672100911537, 30.1903326238195, 29.910844321052224, 28.665821467836693, 28.89410263796647, 29.33451409389575, 35.95790499945481, 36.4631498431166, 36.916572848645345, 53.32254579290746, 52.82916091382502, 53.31669902428983, 43.16421194871266, 43.47266298423831, 43.04179846247037, 41.4398154951632, 41.26873425766826, 40.38699546456337, 35.18190062046051, 35.35747351497412, 35.43869358859956, 24.586243142218635, 24.590375921068087, 23.52251461644967, 37.967480823397636, 37.97180938720703, 37.58011634647846, 46.150284361094236, 45.93573425710201, 46.3863821629202, 36.04235628123084, 36.3329728913765, 36.152183464417845, 35.71671703706184, 35.80894729929665, 35.65627982715765, 28.992660731077194, 29.490638022311032, 29.316309221088886, 30.24240731696287, 30.26519404227534, 29.926481204728276, 38.038748145103455, 38.295202791690826, 38.97571027837694, 42.39893703038493, 42.036482880512864, 41.598246360818536, 33.37842625131209, 33.55186457311113, 33.28198720266421, 41.322597871224076, 42.46868810678521, 42.075968394676835, 46.51481106380622, 47.100739949072405, 46.209620232383415, 47.57788438846667, 47.42599793275197, 47.767514926691845, 44.21827198565006, 44.00837758183479, 43.554121643304825, 42.61460461219151, 42.88227592160304, 43.392946180266634, 28.020202053089932, 28.019173090656594, 28.153618854780987, 22.03677475452423, 21.81851029396057, 21.775431036949158, 47.204154230654225, 47.00860267877577, 47.29114221781491, 26.2320322493712, 26.095664049188287, 26.59390191982189, 15.722342789173126, 15.565053433179855, 14.771133869886398, 25.476302017457783, 24.8546324968338, 24.55683070421219, 43.10242671519518, 43.36043942719698, 43.20304613560438, 12.012805795297027, 11.664800323545933, 10.596254259347916, 48.49179694553216, 48.61423337956269, 48.741276544829205, 36.318909530838326, 36.65562928219636, 36.66273173441489, 32.75759916007519, 33.117104314267635, 33.114166885614395, 16.278352213402584, 16.446117234726742, 16.583120857675866, 34.18879572550455, 34.57191736336486, 34.11601130167642, 40.163270620008305, 39.95794494946797, 39.57553145786126, 31.608861848711967, 31.448361814022064, 31.777999192476273, 28.92258434991041, 28.74960123995939, 28.538595060507447, 35.37362153253828, 35.2806758445998, 35.01848218341668, 34.87309382110834, 35.30053045065142, 35.112871292978525, 53.40022046367328, 53.85315265754859, 54.21022132287423, 17.117227599024773, 17.221152655780315, 17.692061835201457, 44.74658256272474, 44.302134344975144, 45.05583161596829, 45.165520331046224, 44.76948786030212, 44.8789789477984, 33.40934662769237, 33.55959768795097, 32.80409927169481, 34.25290152678886, 34.19727249319354, 34.13721377278367, 43.05538358539343, 43.189618460834026, 43.438451554626226, 30.14704495420058, 29.976868850489453, 30.33808409919341, 44.62966366112232, 44.88108253479004, 45.66481131268665, 14.58907739942272, 13.960389976700142, 14.671221913148955, 30.685562026997403, 30.35957148422797, 30.727139321466282, 46.74169651418923, 46.5949546843767, 47.21171599067746, 37.364440490802124, 39.264806290467575, 39.65185948212941, 35.11081092307964, 35.31086759890118, 35.30480234200755, 46.4948715120554, 46.37310864776373, 46.85212527774274, -85.31834869335096, -85.60098885248105, -85.91457898418109, 52.60398645699023, 52.55635448545216, 53.062610140070305, 43.25363026559353, 43.81872461736202, 44.05727878771722, -103.03561969598135, -86.18722452720007, -85.54407154147825, 48.20354513327281, 48.75274560848872, 48.27088102201621, 37.34077478945255, 37.71571456640959, 37.858644399791956, 32.10952325165272, 32.24371975660324, 32.00168824195862, 40.371460412939385, 39.828690384825066, 39.75855970879395, 41.872894898056984, 41.812491439282894, 41.98304447717965, 41.04101075232029, 41.39033282548189, 41.811823373660445, 20.500086826582745, 20.64808813979228, 20.69420346183081, 38.07411634906505, 37.357324709494904, 37.90557614838083, 37.294020891189575, 36.81271830201149, 36.87296090275049, 32.47407772640386, 32.660215246180684, 33.13927731771642, 25.499584864398145, 25.202065526197345, 25.294967765609414, 25.93166783669342, 25.85730494682987, 25.514628549416855, 25.043688789010048, 25.406805463135242, 25.46253953129053, 38.821607549985245, 39.28668866989513, 38.13145401080449, 40.39210954681039, 40.21839562803507, 40.56629757396877, 32.865078563491494, 33.1946173335115, 33.400789147863776, 30.068046906342104, 29.545126510163144, 29.233320792516068, 34.07402203356226, 33.81481411804755, 33.81095307817061, 34.3640684535106, 34.84953154002626, 34.55738915254672, 41.932212012509495, 42.0222588914136, 41.167193735639245, 38.32512720922628, 38.20801760504642, 38.33864796410003, 48.20576200385888, 48.84139499518399, 47.94528396924336, 42.60611953834692, 43.301939653853566, 43.38979686299959, 38.96726768898466, 38.85422309363881, 38.398719574014336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14211255560729577, "mean_inference_ms": 0.6997194146288964, "mean_action_processing_ms": 0.09633586360047014, "mean_env_wait_ms": 0.7902412441000974, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 815000, "timesteps_this_iter": 0, "agent_timesteps_total": 2445000, "timers": {"sample_time_ms": 11271.754, "sample_throughput": 443.587, "load_time_ms": 0.1, "load_throughput": 50219157.088, "learn_time_ms": 2102.738, "learn_throughput": 2377.852, "update_time_ms": 9.909}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.306077861687684e-40, "cur_lr": 0.0005000000000000001, "total_loss": 8.189153575897217, "policy_loss": -0.0010346989593607247, "vf_loss": 8.293928241729736, "vf_explained_var": -0.03024735450744629, "kl": 0.003020063007763311, "entropy": 10.373960399627686, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 815000, "num_agent_steps_sampled": 2445000, "num_steps_trained": 815000, "num_agent_steps_trained": 2445000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2306, "training_iteration": 163, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-30-50", "timestamp": 1706232650, "time_this_iter_s": 11.197251081466675, "time_total_s": 1764.2608664035797, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402DE5550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1764.2608664035797, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 6.24375, "ram_util_percent": 62.4125}}
{"episode_reward_max": 161.46359444409606, "episode_reward_min": -274.76691576465964, "episode_reward_mean": 103.51438687899208, "episode_len_mean": 495.61, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -103.03561969598135}, "policy_reward_max": {"shared_policy": 54.21022132287423}, "policy_reward_mean": {"shared_policy": 34.50479562633068}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.46048341132698, 122.60641931369898, 106.03572011366484, 129.52691145986324, 122.79164804890752, 122.20104810036716, 94.49985885620116, 90.2778979539871, 86.89443819969891, 109.33762769121675, 159.46840573102216, 129.6786733954214, 123.09554521739483, 105.97806772403419, 72.69913367973639, 113.51940655708313, 138.47240078111585, 108.52751263702518, 107.18194416351614, 87.79960797447711, 90.43408256396648, 115.30966121517122, 126.03366627171633, 100.21227802708744, 125.86725437268612, 139.82517124526214, 142.77139724791053, 131.7807712107897, 128.88982671406114, 84.19299399852751, 65.63071608543396, 141.50389912724486, 78.92159821838138, 46.05853009223938, 74.88776521850377, 129.66591227799645, 34.273860378190875, 145.84730686992432, 109.63727054744957, 98.98887035995722, 49.30759030580519, 102.87672439054583, 119.69674702733754, 94.8352228552103, 86.21078065037725, 105.67277956055476, 105.28649556473829, 161.46359444409606, 52.030442090006545, 134.10454852366826, 134.81398713914666, 99.77304358733815, 102.58738779276607, 129.68345360085385, 90.46199790388344, 135.1755575085991, 43.22068928927182, 91.77227283269166, 140.5483671892434, 116.28110626339911, 105.72648086398837, 139.72010543756195, -256.8339165300131, 158.2229510825126, 131.12963367067283, -274.76691576465964, 145.22717176377782, 112.9151337556541, 96.35493125021458, 119.9587105065584, 125.66843081451952, 124.24316695146263, 61.84237842820583, 113.33701720694079, 110.97970009595156, 98.27357029030097, 75.9966181562049, 77.30360133294015, 75.91303378343582, 116.23975023068486, 121.17680274881423, 99.46048504486677, 88.84649420902132, 101.69978922978042, 103.77098914608358, 125.12166463956234, 114.87179277837274, 144.99244096828625, 129.29785605520004, 116.2202103566378, 153.8661180585622, 115.77346492558718, 142.96533404663197, 111.33218773081896, 144.91715050861242, 119.1646930128336, 108.36582427099346, 143.00537782907506, 126.48912224918604, 150.06096519157276], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 259, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [31.9267704548935, 31.48507137099901, 32.04864158543447, 41.307072697828204, 40.513932446638734, 40.78541416923204, 35.65543544913331, 35.12408241132894, 35.25620225320259, 43.16621555884679, 42.979417880376175, 43.38127802064021, 40.844034008681774, 41.18948492780328, 40.758129112422466, 40.76219649116197, 40.904387888188154, 40.53446372101703, 31.153334123392895, 31.713771378000573, 31.63275335480769, 30.17672100911537, 30.1903326238195, 29.910844321052224, 28.665821467836693, 28.89410263796647, 29.33451409389575, 35.95790499945481, 36.4631498431166, 36.916572848645345, 53.32254579290746, 52.82916091382502, 53.31669902428983, 43.16421194871266, 43.47266298423831, 43.04179846247037, 41.4398154951632, 41.26873425766826, 40.38699546456337, 35.18190062046051, 35.35747351497412, 35.43869358859956, 24.586243142218635, 24.590375921068087, 23.52251461644967, 37.967480823397636, 37.97180938720703, 37.58011634647846, 46.150284361094236, 45.93573425710201, 46.3863821629202, 36.04235628123084, 36.3329728913765, 36.152183464417845, 35.71671703706184, 35.80894729929665, 35.65627982715765, 28.992660731077194, 29.490638022311032, 29.316309221088886, 30.24240731696287, 30.26519404227534, 29.926481204728276, 38.038748145103455, 38.295202791690826, 38.97571027837694, 42.39893703038493, 42.036482880512864, 41.598246360818536, 33.37842625131209, 33.55186457311113, 33.28198720266421, 41.322597871224076, 42.46868810678521, 42.075968394676835, 46.51481106380622, 47.100739949072405, 46.209620232383415, 47.57788438846667, 47.42599793275197, 47.767514926691845, 44.21827198565006, 44.00837758183479, 43.554121643304825, 42.61460461219151, 42.88227592160304, 43.392946180266634, 28.020202053089932, 28.019173090656594, 28.153618854780987, 22.03677475452423, 21.81851029396057, 21.775431036949158, 47.204154230654225, 47.00860267877577, 47.29114221781491, 26.2320322493712, 26.095664049188287, 26.59390191982189, 15.722342789173126, 15.565053433179855, 14.771133869886398, 25.476302017457783, 24.8546324968338, 24.55683070421219, 43.10242671519518, 43.36043942719698, 43.20304613560438, 12.012805795297027, 11.664800323545933, 10.596254259347916, 48.49179694553216, 48.61423337956269, 48.741276544829205, 36.318909530838326, 36.65562928219636, 36.66273173441489, 32.75759916007519, 33.117104314267635, 33.114166885614395, 16.278352213402584, 16.446117234726742, 16.583120857675866, 34.18879572550455, 34.57191736336486, 34.11601130167642, 40.163270620008305, 39.95794494946797, 39.57553145786126, 31.608861848711967, 31.448361814022064, 31.777999192476273, 28.92258434991041, 28.74960123995939, 28.538595060507447, 35.37362153253828, 35.2806758445998, 35.01848218341668, 34.87309382110834, 35.30053045065142, 35.112871292978525, 53.40022046367328, 53.85315265754859, 54.21022132287423, 17.117227599024773, 17.221152655780315, 17.692061835201457, 44.74658256272474, 44.302134344975144, 45.05583161596829, 45.165520331046224, 44.76948786030212, 44.8789789477984, 33.40934662769237, 33.55959768795097, 32.80409927169481, 34.25290152678886, 34.19727249319354, 34.13721377278367, 43.05538358539343, 43.189618460834026, 43.438451554626226, 30.14704495420058, 29.976868850489453, 30.33808409919341, 44.62966366112232, 44.88108253479004, 45.66481131268665, 14.58907739942272, 13.960389976700142, 14.671221913148955, 30.685562026997403, 30.35957148422797, 30.727139321466282, 46.74169651418923, 46.5949546843767, 47.21171599067746, 37.364440490802124, 39.264806290467575, 39.65185948212941, 35.11081092307964, 35.31086759890118, 35.30480234200755, 46.4948715120554, 46.37310864776373, 46.85212527774274, -85.31834869335096, -85.60098885248105, -85.91457898418109, 52.60398645699023, 52.55635448545216, 53.062610140070305, 43.25363026559353, 43.81872461736202, 44.05727878771722, -103.03561969598135, -86.18722452720007, -85.54407154147825, 48.20354513327281, 48.75274560848872, 48.27088102201621, 37.34077478945255, 37.71571456640959, 37.858644399791956, 32.10952325165272, 32.24371975660324, 32.00168824195862, 40.371460412939385, 39.828690384825066, 39.75855970879395, 41.872894898056984, 41.812491439282894, 41.98304447717965, 41.04101075232029, 41.39033282548189, 41.811823373660445, 20.500086826582745, 20.64808813979228, 20.69420346183081, 38.07411634906505, 37.357324709494904, 37.90557614838083, 37.294020891189575, 36.81271830201149, 36.87296090275049, 32.47407772640386, 32.660215246180684, 33.13927731771642, 25.499584864398145, 25.202065526197345, 25.294967765609414, 25.93166783669342, 25.85730494682987, 25.514628549416855, 25.043688789010048, 25.406805463135242, 25.46253953129053, 38.821607549985245, 39.28668866989513, 38.13145401080449, 40.39210954681039, 40.21839562803507, 40.56629757396877, 32.865078563491494, 33.1946173335115, 33.400789147863776, 30.068046906342104, 29.545126510163144, 29.233320792516068, 34.07402203356226, 33.81481411804755, 33.81095307817061, 34.3640684535106, 34.84953154002626, 34.55738915254672, 41.932212012509495, 42.0222588914136, 41.167193735639245, 38.32512720922628, 38.20801760504642, 38.33864796410003, 48.20576200385888, 48.84139499518399, 47.94528396924336, 42.60611953834692, 43.301939653853566, 43.38979686299959, 38.96726768898466, 38.85422309363881, 38.398719574014336, 51.39438911527394, 50.99465619027613, 51.477072753012166, 38.605534732341766, 38.53302303701639, 38.63490715622902, 47.344999750455216, 47.88621039067705, 47.73412390549977, 36.923820222417504, 37.50416041786471, 36.904207090536744, 48.20552149042486, 48.35079544410108, 48.36083357408641, 39.38181748986244, 39.91714641824365, 39.86572910472751, 36.018019167085484, 36.255245113124445, 36.09255999078353, 47.83308091635506, 47.36325980226199, 47.80903711045782, 42.16737635433674, 42.198396474123, 42.1233494207263, 49.99110625311731, 50.074789032340036, 49.99506990611552]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14217307450230834, "mean_inference_ms": 0.7001153868850181, "mean_action_processing_ms": 0.09638327630754545, "mean_env_wait_ms": 0.79034165922603, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 820000, "timesteps_this_iter": 0, "agent_timesteps_total": 2460000, "timers": {"sample_time_ms": 11295.198, "sample_throughput": 442.666, "load_time_ms": 0.1, "load_throughput": 50219157.088, "learn_time_ms": 2111.393, "learn_throughput": 2368.104, "update_time_ms": 9.809}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.653038930843842e-40, "cur_lr": 0.0005000000000000001, "total_loss": 8.937051773071289, "policy_loss": -0.0011911505884009798, "vf_loss": 9.043257808685302, "vf_explained_var": 0.015684300661087038, "kl": 0.0025009383680786226, "entropy": 10.501526355743408, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 820000, "num_agent_steps_sampled": 2460000, "num_steps_trained": 820000, "num_agent_steps_trained": 2460000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2316, "training_iteration": 164, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-31-02", "timestamp": 1706232662, "time_this_iter_s": 11.356278419494629, "time_total_s": 1775.6171448230743, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140424F820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1775.6171448230743, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 7.875, "ram_util_percent": 62.5}}
{"episode_reward_max": 161.46359444409606, "episode_reward_min": -274.76691576465964, "episode_reward_mean": 101.02801124906459, "episode_len_mean": 495.41, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -103.03561969598135}, "policy_reward_max": {"shared_policy": 54.21022132287423}, "policy_reward_mean": {"shared_policy": 33.676003749688185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [159.46840573102216, 129.6786733954214, 123.09554521739483, 105.97806772403419, 72.69913367973639, 113.51940655708313, 138.47240078111585, 108.52751263702518, 107.18194416351614, 87.79960797447711, 90.43408256396648, 115.30966121517122, 126.03366627171633, 100.21227802708744, 125.86725437268612, 139.82517124526214, 142.77139724791053, 131.7807712107897, 128.88982671406114, 84.19299399852751, 65.63071608543396, 141.50389912724486, 78.92159821838138, 46.05853009223938, 74.88776521850377, 129.66591227799645, 34.273860378190875, 145.84730686992432, 109.63727054744957, 98.98887035995722, 49.30759030580519, 102.87672439054583, 119.69674702733754, 94.8352228552103, 86.21078065037725, 105.67277956055476, 105.28649556473829, 161.46359444409606, 52.030442090006545, 134.10454852366826, 134.81398713914666, 99.77304358733815, 102.58738779276607, 129.68345360085385, 90.46199790388344, 135.1755575085991, 43.22068928927182, 91.77227283269166, 140.5483671892434, 116.28110626339911, 105.72648086398837, 139.72010543756195, -256.8339165300131, 158.2229510825126, 131.12963367067283, -274.76691576465964, 145.22717176377782, 112.9151337556541, 96.35493125021458, 119.9587105065584, 125.66843081451952, 124.24316695146263, 61.84237842820583, 113.33701720694079, 110.97970009595156, 98.27357029030097, 75.9966181562049, 77.30360133294015, 75.91303378343582, 116.23975023068486, 121.17680274881423, 99.46048504486677, 88.84649420902132, 101.69978922978042, 103.77098914608358, 125.12166463956234, 114.87179277837274, 144.99244096828625, 129.29785605520004, 116.2202103566378, 153.8661180585622, 115.77346492558718, 142.96533404663197, 111.33218773081896, 144.91715050861242, 119.1646930128336, 108.36582427099346, 143.00537782907506, 126.48912224918604, 150.06096519157276, 138.29241822659972, 129.19237302988785, -192.38582016900182, 129.53281736071216, 99.46443556994197, 117.50451138895005, 122.35489232838152, 117.1782021448016, 83.79244908178224, 86.06821119412777], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 259, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 480, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [53.32254579290746, 52.82916091382502, 53.31669902428983, 43.16421194871266, 43.47266298423831, 43.04179846247037, 41.4398154951632, 41.26873425766826, 40.38699546456337, 35.18190062046051, 35.35747351497412, 35.43869358859956, 24.586243142218635, 24.590375921068087, 23.52251461644967, 37.967480823397636, 37.97180938720703, 37.58011634647846, 46.150284361094236, 45.93573425710201, 46.3863821629202, 36.04235628123084, 36.3329728913765, 36.152183464417845, 35.71671703706184, 35.80894729929665, 35.65627982715765, 28.992660731077194, 29.490638022311032, 29.316309221088886, 30.24240731696287, 30.26519404227534, 29.926481204728276, 38.038748145103455, 38.295202791690826, 38.97571027837694, 42.39893703038493, 42.036482880512864, 41.598246360818536, 33.37842625131209, 33.55186457311113, 33.28198720266421, 41.322597871224076, 42.46868810678521, 42.075968394676835, 46.51481106380622, 47.100739949072405, 46.209620232383415, 47.57788438846667, 47.42599793275197, 47.767514926691845, 44.21827198565006, 44.00837758183479, 43.554121643304825, 42.61460461219151, 42.88227592160304, 43.392946180266634, 28.020202053089932, 28.019173090656594, 28.153618854780987, 22.03677475452423, 21.81851029396057, 21.775431036949158, 47.204154230654225, 47.00860267877577, 47.29114221781491, 26.2320322493712, 26.095664049188287, 26.59390191982189, 15.722342789173126, 15.565053433179855, 14.771133869886398, 25.476302017457783, 24.8546324968338, 24.55683070421219, 43.10242671519518, 43.36043942719698, 43.20304613560438, 12.012805795297027, 11.664800323545933, 10.596254259347916, 48.49179694553216, 48.61423337956269, 48.741276544829205, 36.318909530838326, 36.65562928219636, 36.66273173441489, 32.75759916007519, 33.117104314267635, 33.114166885614395, 16.278352213402584, 16.446117234726742, 16.583120857675866, 34.18879572550455, 34.57191736336486, 34.11601130167642, 40.163270620008305, 39.95794494946797, 39.57553145786126, 31.608861848711967, 31.448361814022064, 31.777999192476273, 28.92258434991041, 28.74960123995939, 28.538595060507447, 35.37362153253828, 35.2806758445998, 35.01848218341668, 34.87309382110834, 35.30053045065142, 35.112871292978525, 53.40022046367328, 53.85315265754859, 54.21022132287423, 17.117227599024773, 17.221152655780315, 17.692061835201457, 44.74658256272474, 44.302134344975144, 45.05583161596829, 45.165520331046224, 44.76948786030212, 44.8789789477984, 33.40934662769237, 33.55959768795097, 32.80409927169481, 34.25290152678886, 34.19727249319354, 34.13721377278367, 43.05538358539343, 43.189618460834026, 43.438451554626226, 30.14704495420058, 29.976868850489453, 30.33808409919341, 44.62966366112232, 44.88108253479004, 45.66481131268665, 14.58907739942272, 13.960389976700142, 14.671221913148955, 30.685562026997403, 30.35957148422797, 30.727139321466282, 46.74169651418923, 46.5949546843767, 47.21171599067746, 37.364440490802124, 39.264806290467575, 39.65185948212941, 35.11081092307964, 35.31086759890118, 35.30480234200755, 46.4948715120554, 46.37310864776373, 46.85212527774274, -85.31834869335096, -85.60098885248105, -85.91457898418109, 52.60398645699023, 52.55635448545216, 53.062610140070305, 43.25363026559353, 43.81872461736202, 44.05727878771722, -103.03561969598135, -86.18722452720007, -85.54407154147825, 48.20354513327281, 48.75274560848872, 48.27088102201621, 37.34077478945255, 37.71571456640959, 37.858644399791956, 32.10952325165272, 32.24371975660324, 32.00168824195862, 40.371460412939385, 39.828690384825066, 39.75855970879395, 41.872894898056984, 41.812491439282894, 41.98304447717965, 41.04101075232029, 41.39033282548189, 41.811823373660445, 20.500086826582745, 20.64808813979228, 20.69420346183081, 38.07411634906505, 37.357324709494904, 37.90557614838083, 37.294020891189575, 36.81271830201149, 36.87296090275049, 32.47407772640386, 32.660215246180684, 33.13927731771642, 25.499584864398145, 25.202065526197345, 25.294967765609414, 25.93166783669342, 25.85730494682987, 25.514628549416855, 25.043688789010048, 25.406805463135242, 25.46253953129053, 38.821607549985245, 39.28668866989513, 38.13145401080449, 40.39210954681039, 40.21839562803507, 40.56629757396877, 32.865078563491494, 33.1946173335115, 33.400789147863776, 30.068046906342104, 29.545126510163144, 29.233320792516068, 34.07402203356226, 33.81481411804755, 33.81095307817061, 34.3640684535106, 34.84953154002626, 34.55738915254672, 41.932212012509495, 42.0222588914136, 41.167193735639245, 38.32512720922628, 38.20801760504642, 38.33864796410003, 48.20576200385888, 48.84139499518399, 47.94528396924336, 42.60611953834692, 43.301939653853566, 43.38979686299959, 38.96726768898466, 38.85422309363881, 38.398719574014336, 51.39438911527394, 50.99465619027613, 51.477072753012166, 38.605534732341766, 38.53302303701639, 38.63490715622902, 47.344999750455216, 47.88621039067705, 47.73412390549977, 36.923820222417504, 37.50416041786471, 36.904207090536744, 48.20552149042486, 48.35079544410108, 48.36083357408641, 39.38181748986244, 39.91714641824365, 39.86572910472751, 36.018019167085484, 36.255245113124445, 36.09255999078353, 47.83308091635506, 47.36325980226199, 47.80903711045782, 42.16737635433674, 42.198396474123, 42.1233494207263, 49.99110625311731, 50.074789032340036, 49.99506990611552, 46.041205311814934, 46.10006596023837, 46.15114695454636, 42.811613028248146, 43.2681317453583, 43.11262825628121, -63.921787310391665, -64.13378648459911, -64.33024637401104, 43.29683978056224, 43.171241516868264, 43.064736063281686, 32.831928888956696, 33.26498420039812, 33.367522480587155, 38.90904816240072, 39.23465557768941, 39.36080764885992, 40.084171538551644, 41.21920880054434, 41.051511989285544, 38.833733965953186, 38.84925814469655, 39.49521003415187, 28.13921388223146, 27.69489548852046, 27.95833971103032, 28.667339401940495, 28.812820127854735, 28.58805166433254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14221788972661165, "mean_inference_ms": 0.700393407457786, "mean_action_processing_ms": 0.0964152255653357, "mean_env_wait_ms": 0.7903723272763408, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 825000, "timesteps_this_iter": 0, "agent_timesteps_total": 2475000, "timers": {"sample_time_ms": 11152.863, "sample_throughput": 448.315, "load_time_ms": 0.1, "load_throughput": 50219157.088, "learn_time_ms": 2099.132, "learn_throughput": 2381.936, "update_time_ms": 9.792}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.26519465421921e-41, "cur_lr": 0.0005000000000000001, "total_loss": 113.44991912841797, "policy_loss": -0.0011537349421302245, "vf_loss": 113.55640182495117, "vf_explained_var": 0.009390115737915039, "kl": 0.0035757825826786757, "entropy": 10.533158779144287, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 825000, "num_agent_steps_sampled": 2475000, "num_steps_trained": 825000, "num_agent_steps_trained": 2475000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2326, "training_iteration": 165, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-31-12", "timestamp": 1706232672, "time_this_iter_s": 10.489433288574219, "time_total_s": 1786.1065781116486, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214024E8EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1786.1065781116486, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 7.679999999999999, "ram_util_percent": 62.60666666666667}}
{"episode_reward_max": 161.46359444409606, "episode_reward_min": -274.76691576465964, "episode_reward_mean": 100.95929270015448, "episode_len_mean": 495.41, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -103.03561969598135}, "policy_reward_max": {"shared_policy": 54.21022132287423}, "policy_reward_mean": {"shared_policy": 33.65309756671816}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.43408256396648, 115.30966121517122, 126.03366627171633, 100.21227802708744, 125.86725437268612, 139.82517124526214, 142.77139724791053, 131.7807712107897, 128.88982671406114, 84.19299399852751, 65.63071608543396, 141.50389912724486, 78.92159821838138, 46.05853009223938, 74.88776521850377, 129.66591227799645, 34.273860378190875, 145.84730686992432, 109.63727054744957, 98.98887035995722, 49.30759030580519, 102.87672439054583, 119.69674702733754, 94.8352228552103, 86.21078065037725, 105.67277956055476, 105.28649556473829, 161.46359444409606, 52.030442090006545, 134.10454852366826, 134.81398713914666, 99.77304358733815, 102.58738779276607, 129.68345360085385, 90.46199790388344, 135.1755575085991, 43.22068928927182, 91.77227283269166, 140.5483671892434, 116.28110626339911, 105.72648086398837, 139.72010543756195, -256.8339165300131, 158.2229510825126, 131.12963367067283, -274.76691576465964, 145.22717176377782, 112.9151337556541, 96.35493125021458, 119.9587105065584, 125.66843081451952, 124.24316695146263, 61.84237842820583, 113.33701720694079, 110.97970009595156, 98.27357029030097, 75.9966181562049, 77.30360133294015, 75.91303378343582, 116.23975023068486, 121.17680274881423, 99.46048504486677, 88.84649420902132, 101.69978922978042, 103.77098914608358, 125.12166463956234, 114.87179277837274, 144.99244096828625, 129.29785605520004, 116.2202103566378, 153.8661180585622, 115.77346492558718, 142.96533404663197, 111.33218773081896, 144.91715050861242, 119.1646930128336, 108.36582427099346, 143.00537782907506, 126.48912224918604, 150.06096519157276, 138.29241822659972, 129.19237302988785, -192.38582016900182, 129.53281736071216, 99.46443556994197, 117.50451138895005, 122.35489232838152, 117.1782021448016, 83.79244908178224, 86.06821119412777, 151.46064167562858, 89.8940650075674, 73.27576611563562, 117.76318308152258, 125.8180595561862, 104.06246560439466, 117.99342365935442, 154.51018762262538, 97.81372896209358, 106.95732168480752], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 259, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 480, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [30.24240731696287, 30.26519404227534, 29.926481204728276, 38.038748145103455, 38.295202791690826, 38.97571027837694, 42.39893703038493, 42.036482880512864, 41.598246360818536, 33.37842625131209, 33.55186457311113, 33.28198720266421, 41.322597871224076, 42.46868810678521, 42.075968394676835, 46.51481106380622, 47.100739949072405, 46.209620232383415, 47.57788438846667, 47.42599793275197, 47.767514926691845, 44.21827198565006, 44.00837758183479, 43.554121643304825, 42.61460461219151, 42.88227592160304, 43.392946180266634, 28.020202053089932, 28.019173090656594, 28.153618854780987, 22.03677475452423, 21.81851029396057, 21.775431036949158, 47.204154230654225, 47.00860267877577, 47.29114221781491, 26.2320322493712, 26.095664049188287, 26.59390191982189, 15.722342789173126, 15.565053433179855, 14.771133869886398, 25.476302017457783, 24.8546324968338, 24.55683070421219, 43.10242671519518, 43.36043942719698, 43.20304613560438, 12.012805795297027, 11.664800323545933, 10.596254259347916, 48.49179694553216, 48.61423337956269, 48.741276544829205, 36.318909530838326, 36.65562928219636, 36.66273173441489, 32.75759916007519, 33.117104314267635, 33.114166885614395, 16.278352213402584, 16.446117234726742, 16.583120857675866, 34.18879572550455, 34.57191736336486, 34.11601130167642, 40.163270620008305, 39.95794494946797, 39.57553145786126, 31.608861848711967, 31.448361814022064, 31.777999192476273, 28.92258434991041, 28.74960123995939, 28.538595060507447, 35.37362153253828, 35.2806758445998, 35.01848218341668, 34.87309382110834, 35.30053045065142, 35.112871292978525, 53.40022046367328, 53.85315265754859, 54.21022132287423, 17.117227599024773, 17.221152655780315, 17.692061835201457, 44.74658256272474, 44.302134344975144, 45.05583161596829, 45.165520331046224, 44.76948786030212, 44.8789789477984, 33.40934662769237, 33.55959768795097, 32.80409927169481, 34.25290152678886, 34.19727249319354, 34.13721377278367, 43.05538358539343, 43.189618460834026, 43.438451554626226, 30.14704495420058, 29.976868850489453, 30.33808409919341, 44.62966366112232, 44.88108253479004, 45.66481131268665, 14.58907739942272, 13.960389976700142, 14.671221913148955, 30.685562026997403, 30.35957148422797, 30.727139321466282, 46.74169651418923, 46.5949546843767, 47.21171599067746, 37.364440490802124, 39.264806290467575, 39.65185948212941, 35.11081092307964, 35.31086759890118, 35.30480234200755, 46.4948715120554, 46.37310864776373, 46.85212527774274, -85.31834869335096, -85.60098885248105, -85.91457898418109, 52.60398645699023, 52.55635448545216, 53.062610140070305, 43.25363026559353, 43.81872461736202, 44.05727878771722, -103.03561969598135, -86.18722452720007, -85.54407154147825, 48.20354513327281, 48.75274560848872, 48.27088102201621, 37.34077478945255, 37.71571456640959, 37.858644399791956, 32.10952325165272, 32.24371975660324, 32.00168824195862, 40.371460412939385, 39.828690384825066, 39.75855970879395, 41.872894898056984, 41.812491439282894, 41.98304447717965, 41.04101075232029, 41.39033282548189, 41.811823373660445, 20.500086826582745, 20.64808813979228, 20.69420346183081, 38.07411634906505, 37.357324709494904, 37.90557614838083, 37.294020891189575, 36.81271830201149, 36.87296090275049, 32.47407772640386, 32.660215246180684, 33.13927731771642, 25.499584864398145, 25.202065526197345, 25.294967765609414, 25.93166783669342, 25.85730494682987, 25.514628549416855, 25.043688789010048, 25.406805463135242, 25.46253953129053, 38.821607549985245, 39.28668866989513, 38.13145401080449, 40.39210954681039, 40.21839562803507, 40.56629757396877, 32.865078563491494, 33.1946173335115, 33.400789147863776, 30.068046906342104, 29.545126510163144, 29.233320792516068, 34.07402203356226, 33.81481411804755, 33.81095307817061, 34.3640684535106, 34.84953154002626, 34.55738915254672, 41.932212012509495, 42.0222588914136, 41.167193735639245, 38.32512720922628, 38.20801760504642, 38.33864796410003, 48.20576200385888, 48.84139499518399, 47.94528396924336, 42.60611953834692, 43.301939653853566, 43.38979686299959, 38.96726768898466, 38.85422309363881, 38.398719574014336, 51.39438911527394, 50.99465619027613, 51.477072753012166, 38.605534732341766, 38.53302303701639, 38.63490715622902, 47.344999750455216, 47.88621039067705, 47.73412390549977, 36.923820222417504, 37.50416041786471, 36.904207090536744, 48.20552149042486, 48.35079544410108, 48.36083357408641, 39.38181748986244, 39.91714641824365, 39.86572910472751, 36.018019167085484, 36.255245113124445, 36.09255999078353, 47.83308091635506, 47.36325980226199, 47.80903711045782, 42.16737635433674, 42.198396474123, 42.1233494207263, 49.99110625311731, 50.074789032340036, 49.99506990611552, 46.041205311814934, 46.10006596023837, 46.15114695454636, 42.811613028248146, 43.2681317453583, 43.11262825628121, -63.921787310391665, -64.13378648459911, -64.33024637401104, 43.29683978056224, 43.171241516868264, 43.064736063281686, 32.831928888956696, 33.26498420039812, 33.367522480587155, 38.90904816240072, 39.23465557768941, 39.36080764885992, 40.084171538551644, 41.21920880054434, 41.051511989285544, 38.833733965953186, 38.84925814469655, 39.49521003415187, 28.13921388223146, 27.69489548852046, 27.95833971103032, 28.667339401940495, 28.812820127854735, 28.58805166433254, 50.73414165123056, 50.28509424130122, 50.441405783096954, 29.917693227529526, 30.026403233408928, 29.949968546628952, 24.744380881388977, 24.970583767940596, 23.560801466306046, 38.79177285730839, 39.28492168337107, 39.68648854084313, 41.553489342331886, 42.379975877702236, 41.88459433615208, 34.41075711448987, 34.90140401696165, 34.75030447294314, 39.3332738118867, 39.349408509830624, 39.3107413376371, 50.74075148502986, 51.78863964105646, 51.98079649653907, 32.63200473909576, 32.51114825656016, 32.67057596643765, 36.00132408117254, 35.61218526711066, 35.34381233652432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14224379230447887, "mean_inference_ms": 0.7006030094140333, "mean_action_processing_ms": 0.09643558545502959, "mean_env_wait_ms": 0.7903432551210898, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 830000, "timesteps_this_iter": 0, "agent_timesteps_total": 2490000, "timers": {"sample_time_ms": 11036.214, "sample_throughput": 453.054, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 2082.239, "learn_throughput": 2401.261, "update_time_ms": 9.569}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.132597327109605e-41, "cur_lr": 0.0005000000000000001, "total_loss": 8.107479476928711, "policy_loss": -0.0012177020007239747, "vf_loss": 8.213025999069213, "vf_explained_var": 0.024098730087280272, "kl": 0.0028907255502906384, "entropy": 10.43286190032959, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 830000, "num_agent_steps_sampled": 2490000, "num_steps_trained": 830000, "num_agent_steps_trained": 2490000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2336, "training_iteration": 166, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-31-23", "timestamp": 1706232683, "time_this_iter_s": 10.454728364944458, "time_total_s": 1796.561306476593, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214023C8670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1796.561306476593, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 6.799999999999999, "ram_util_percent": 62.52666666666667}}
{"episode_reward_max": 181.1726001426578, "episode_reward_min": -274.76691576465964, "episode_reward_mean": 100.86221090791165, "episode_len_mean": 495.41, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -103.03561969598135}, "policy_reward_max": {"shared_policy": 60.67833450188239}, "policy_reward_mean": {"shared_policy": 33.62073696930387}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.63071608543396, 141.50389912724486, 78.92159821838138, 46.05853009223938, 74.88776521850377, 129.66591227799645, 34.273860378190875, 145.84730686992432, 109.63727054744957, 98.98887035995722, 49.30759030580519, 102.87672439054583, 119.69674702733754, 94.8352228552103, 86.21078065037725, 105.67277956055476, 105.28649556473829, 161.46359444409606, 52.030442090006545, 134.10454852366826, 134.81398713914666, 99.77304358733815, 102.58738779276607, 129.68345360085385, 90.46199790388344, 135.1755575085991, 43.22068928927182, 91.77227283269166, 140.5483671892434, 116.28110626339911, 105.72648086398837, 139.72010543756195, -256.8339165300131, 158.2229510825126, 131.12963367067283, -274.76691576465964, 145.22717176377782, 112.9151337556541, 96.35493125021458, 119.9587105065584, 125.66843081451952, 124.24316695146263, 61.84237842820583, 113.33701720694079, 110.97970009595156, 98.27357029030097, 75.9966181562049, 77.30360133294015, 75.91303378343582, 116.23975023068486, 121.17680274881423, 99.46048504486677, 88.84649420902132, 101.69978922978042, 103.77098914608358, 125.12166463956234, 114.87179277837274, 144.99244096828625, 129.29785605520004, 116.2202103566378, 153.8661180585622, 115.77346492558718, 142.96533404663197, 111.33218773081896, 144.91715050861242, 119.1646930128336, 108.36582427099346, 143.00537782907506, 126.48912224918604, 150.06096519157276, 138.29241822659972, 129.19237302988785, -192.38582016900182, 129.53281736071216, 99.46443556994197, 117.50451138895005, 122.35489232838152, 117.1782021448016, 83.79244908178224, 86.06821119412777, 151.46064167562858, 89.8940650075674, 73.27576611563562, 117.76318308152258, 125.8180595561862, 104.06246560439466, 117.99342365935442, 154.51018762262538, 97.81372896209358, 106.95732168480752, 138.47192808240618, 86.16803855448961, 48.69334913045168, 112.15997965633866, 181.1726001426578, 92.7317830324173, 120.97364815045145, 113.48680284433064, 147.55857839807857, 134.19221565127387], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 259, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 480, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [22.03677475452423, 21.81851029396057, 21.775431036949158, 47.204154230654225, 47.00860267877577, 47.29114221781491, 26.2320322493712, 26.095664049188287, 26.59390191982189, 15.722342789173126, 15.565053433179855, 14.771133869886398, 25.476302017457783, 24.8546324968338, 24.55683070421219, 43.10242671519518, 43.36043942719698, 43.20304613560438, 12.012805795297027, 11.664800323545933, 10.596254259347916, 48.49179694553216, 48.61423337956269, 48.741276544829205, 36.318909530838326, 36.65562928219636, 36.66273173441489, 32.75759916007519, 33.117104314267635, 33.114166885614395, 16.278352213402584, 16.446117234726742, 16.583120857675866, 34.18879572550455, 34.57191736336486, 34.11601130167642, 40.163270620008305, 39.95794494946797, 39.57553145786126, 31.608861848711967, 31.448361814022064, 31.777999192476273, 28.92258434991041, 28.74960123995939, 28.538595060507447, 35.37362153253828, 35.2806758445998, 35.01848218341668, 34.87309382110834, 35.30053045065142, 35.112871292978525, 53.40022046367328, 53.85315265754859, 54.21022132287423, 17.117227599024773, 17.221152655780315, 17.692061835201457, 44.74658256272474, 44.302134344975144, 45.05583161596829, 45.165520331046224, 44.76948786030212, 44.8789789477984, 33.40934662769237, 33.55959768795097, 32.80409927169481, 34.25290152678886, 34.19727249319354, 34.13721377278367, 43.05538358539343, 43.189618460834026, 43.438451554626226, 30.14704495420058, 29.976868850489453, 30.33808409919341, 44.62966366112232, 44.88108253479004, 45.66481131268665, 14.58907739942272, 13.960389976700142, 14.671221913148955, 30.685562026997403, 30.35957148422797, 30.727139321466282, 46.74169651418923, 46.5949546843767, 47.21171599067746, 37.364440490802124, 39.264806290467575, 39.65185948212941, 35.11081092307964, 35.31086759890118, 35.30480234200755, 46.4948715120554, 46.37310864776373, 46.85212527774274, -85.31834869335096, -85.60098885248105, -85.91457898418109, 52.60398645699023, 52.55635448545216, 53.062610140070305, 43.25363026559353, 43.81872461736202, 44.05727878771722, -103.03561969598135, -86.18722452720007, -85.54407154147825, 48.20354513327281, 48.75274560848872, 48.27088102201621, 37.34077478945255, 37.71571456640959, 37.858644399791956, 32.10952325165272, 32.24371975660324, 32.00168824195862, 40.371460412939385, 39.828690384825066, 39.75855970879395, 41.872894898056984, 41.812491439282894, 41.98304447717965, 41.04101075232029, 41.39033282548189, 41.811823373660445, 20.500086826582745, 20.64808813979228, 20.69420346183081, 38.07411634906505, 37.357324709494904, 37.90557614838083, 37.294020891189575, 36.81271830201149, 36.87296090275049, 32.47407772640386, 32.660215246180684, 33.13927731771642, 25.499584864398145, 25.202065526197345, 25.294967765609414, 25.93166783669342, 25.85730494682987, 25.514628549416855, 25.043688789010048, 25.406805463135242, 25.46253953129053, 38.821607549985245, 39.28668866989513, 38.13145401080449, 40.39210954681039, 40.21839562803507, 40.56629757396877, 32.865078563491494, 33.1946173335115, 33.400789147863776, 30.068046906342104, 29.545126510163144, 29.233320792516068, 34.07402203356226, 33.81481411804755, 33.81095307817061, 34.3640684535106, 34.84953154002626, 34.55738915254672, 41.932212012509495, 42.0222588914136, 41.167193735639245, 38.32512720922628, 38.20801760504642, 38.33864796410003, 48.20576200385888, 48.84139499518399, 47.94528396924336, 42.60611953834692, 43.301939653853566, 43.38979686299959, 38.96726768898466, 38.85422309363881, 38.398719574014336, 51.39438911527394, 50.99465619027613, 51.477072753012166, 38.605534732341766, 38.53302303701639, 38.63490715622902, 47.344999750455216, 47.88621039067705, 47.73412390549977, 36.923820222417504, 37.50416041786471, 36.904207090536744, 48.20552149042486, 48.35079544410108, 48.36083357408641, 39.38181748986244, 39.91714641824365, 39.86572910472751, 36.018019167085484, 36.255245113124445, 36.09255999078353, 47.83308091635506, 47.36325980226199, 47.80903711045782, 42.16737635433674, 42.198396474123, 42.1233494207263, 49.99110625311731, 50.074789032340036, 49.99506990611552, 46.041205311814934, 46.10006596023837, 46.15114695454636, 42.811613028248146, 43.2681317453583, 43.11262825628121, -63.921787310391665, -64.13378648459911, -64.33024637401104, 43.29683978056224, 43.171241516868264, 43.064736063281686, 32.831928888956696, 33.26498420039812, 33.367522480587155, 38.90904816240072, 39.23465557768941, 39.36080764885992, 40.084171538551644, 41.21920880054434, 41.051511989285544, 38.833733965953186, 38.84925814469655, 39.49521003415187, 28.13921388223146, 27.69489548852046, 27.95833971103032, 28.667339401940495, 28.812820127854735, 28.58805166433254, 50.73414165123056, 50.28509424130122, 50.441405783096954, 29.917693227529526, 30.026403233408928, 29.949968546628952, 24.744380881388977, 24.970583767940596, 23.560801466306046, 38.79177285730839, 39.28492168337107, 39.68648854084313, 41.553489342331886, 42.379975877702236, 41.88459433615208, 34.41075711448987, 34.90140401696165, 34.75030447294314, 39.3332738118867, 39.349408509830624, 39.3107413376371, 50.74075148502986, 51.78863964105646, 51.98079649653907, 32.63200473909576, 32.51114825656016, 32.67057596643765, 36.00132408117254, 35.61218526711066, 35.34381233652432, 45.812669853369385, 46.346094655493886, 46.31316357354322, 28.62366819381714, 28.665057957172394, 28.87931240350008, 15.980027750134468, 16.402876660227776, 16.310444720089436, 37.34605898956457, 37.62928014496961, 37.18464052180448, 60.67833450188239, 60.270752017696694, 60.22351362307866, 30.6749175041914, 30.986491210758686, 31.070374317467213, 40.6236437090362, 40.64147475051382, 39.70852969090143, 37.868603392193705, 37.99885052132109, 37.619348930815846, 49.04082488765319, 49.165471759935215, 49.35228175049026, 44.72489020476738, 44.76961115996042, 44.6977142865459]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14225668733684715, "mean_inference_ms": 0.7007565722951264, "mean_action_processing_ms": 0.09645309879940171, "mean_env_wait_ms": 0.7902874477441063, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 835000, "timesteps_this_iter": 0, "agent_timesteps_total": 2505000, "timers": {"sample_time_ms": 10930.206, "sample_throughput": 457.448, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 2072.908, "learn_throughput": 2412.07, "update_time_ms": 9.458}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.0662986635548026e-41, "cur_lr": 0.0005000000000000001, "total_loss": 9.359113502502442, "policy_loss": -0.0003611661893121454, "vf_loss": 9.464383411407471, "vf_explained_var": 0.004429852962493897, "kl": 0.003501420945444064, "entropy": 10.490932083129882, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 835000, "num_agent_steps_sampled": 2505000, "num_steps_trained": 835000, "num_agent_steps_trained": 2505000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2346, "training_iteration": 167, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-31-33", "timestamp": 1706232693, "time_this_iter_s": 10.46212387084961, "time_total_s": 1807.0234303474426, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402417040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1807.0234303474426, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 6.114285714285715, "ram_util_percent": 62.557142857142864}}
{"episode_reward_max": 181.1726001426578, "episode_reward_min": -274.76691576465964, "episode_reward_mean": 102.82363663742872, "episode_len_mean": 495.41, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -103.03561969598135}, "policy_reward_max": {"shared_policy": 60.67833450188239}, "policy_reward_mean": {"shared_policy": 34.27454554580957}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.30759030580519, 102.87672439054583, 119.69674702733754, 94.8352228552103, 86.21078065037725, 105.67277956055476, 105.28649556473829, 161.46359444409606, 52.030442090006545, 134.10454852366826, 134.81398713914666, 99.77304358733815, 102.58738779276607, 129.68345360085385, 90.46199790388344, 135.1755575085991, 43.22068928927182, 91.77227283269166, 140.5483671892434, 116.28110626339911, 105.72648086398837, 139.72010543756195, -256.8339165300131, 158.2229510825126, 131.12963367067283, -274.76691576465964, 145.22717176377782, 112.9151337556541, 96.35493125021458, 119.9587105065584, 125.66843081451952, 124.24316695146263, 61.84237842820583, 113.33701720694079, 110.97970009595156, 98.27357029030097, 75.9966181562049, 77.30360133294015, 75.91303378343582, 116.23975023068486, 121.17680274881423, 99.46048504486677, 88.84649420902132, 101.69978922978042, 103.77098914608358, 125.12166463956234, 114.87179277837274, 144.99244096828625, 129.29785605520004, 116.2202103566378, 153.8661180585622, 115.77346492558718, 142.96533404663197, 111.33218773081896, 144.91715050861242, 119.1646930128336, 108.36582427099346, 143.00537782907506, 126.48912224918604, 150.06096519157276, 138.29241822659972, 129.19237302988785, -192.38582016900182, 129.53281736071216, 99.46443556994197, 117.50451138895005, 122.35489232838152, 117.1782021448016, 83.79244908178224, 86.06821119412777, 151.46064167562858, 89.8940650075674, 73.27576611563562, 117.76318308152258, 125.8180595561862, 104.06246560439466, 117.99342365935442, 154.51018762262538, 97.81372896209358, 106.95732168480752, 138.47192808240618, 86.16803855448961, 48.69334913045168, 112.15997965633866, 181.1726001426578, 92.7317830324173, 120.97364815045145, 113.48680284433064, 147.55857839807857, 134.19221565127387, 104.7689970843494, 117.13114257901906, 106.7037243915256, 97.2755436748266, 120.85498972609636, 109.55877458304164, 122.08243857134948, 118.6630719141103, 87.32181786745784, 137.19780173525191], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 259, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 480, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [16.278352213402584, 16.446117234726742, 16.583120857675866, 34.18879572550455, 34.57191736336486, 34.11601130167642, 40.163270620008305, 39.95794494946797, 39.57553145786126, 31.608861848711967, 31.448361814022064, 31.777999192476273, 28.92258434991041, 28.74960123995939, 28.538595060507447, 35.37362153253828, 35.2806758445998, 35.01848218341668, 34.87309382110834, 35.30053045065142, 35.112871292978525, 53.40022046367328, 53.85315265754859, 54.21022132287423, 17.117227599024773, 17.221152655780315, 17.692061835201457, 44.74658256272474, 44.302134344975144, 45.05583161596829, 45.165520331046224, 44.76948786030212, 44.8789789477984, 33.40934662769237, 33.55959768795097, 32.80409927169481, 34.25290152678886, 34.19727249319354, 34.13721377278367, 43.05538358539343, 43.189618460834026, 43.438451554626226, 30.14704495420058, 29.976868850489453, 30.33808409919341, 44.62966366112232, 44.88108253479004, 45.66481131268665, 14.58907739942272, 13.960389976700142, 14.671221913148955, 30.685562026997403, 30.35957148422797, 30.727139321466282, 46.74169651418923, 46.5949546843767, 47.21171599067746, 37.364440490802124, 39.264806290467575, 39.65185948212941, 35.11081092307964, 35.31086759890118, 35.30480234200755, 46.4948715120554, 46.37310864776373, 46.85212527774274, -85.31834869335096, -85.60098885248105, -85.91457898418109, 52.60398645699023, 52.55635448545216, 53.062610140070305, 43.25363026559353, 43.81872461736202, 44.05727878771722, -103.03561969598135, -86.18722452720007, -85.54407154147825, 48.20354513327281, 48.75274560848872, 48.27088102201621, 37.34077478945255, 37.71571456640959, 37.858644399791956, 32.10952325165272, 32.24371975660324, 32.00168824195862, 40.371460412939385, 39.828690384825066, 39.75855970879395, 41.872894898056984, 41.812491439282894, 41.98304447717965, 41.04101075232029, 41.39033282548189, 41.811823373660445, 20.500086826582745, 20.64808813979228, 20.69420346183081, 38.07411634906505, 37.357324709494904, 37.90557614838083, 37.294020891189575, 36.81271830201149, 36.87296090275049, 32.47407772640386, 32.660215246180684, 33.13927731771642, 25.499584864398145, 25.202065526197345, 25.294967765609414, 25.93166783669342, 25.85730494682987, 25.514628549416855, 25.043688789010048, 25.406805463135242, 25.46253953129053, 38.821607549985245, 39.28668866989513, 38.13145401080449, 40.39210954681039, 40.21839562803507, 40.56629757396877, 32.865078563491494, 33.1946173335115, 33.400789147863776, 30.068046906342104, 29.545126510163144, 29.233320792516068, 34.07402203356226, 33.81481411804755, 33.81095307817061, 34.3640684535106, 34.84953154002626, 34.55738915254672, 41.932212012509495, 42.0222588914136, 41.167193735639245, 38.32512720922628, 38.20801760504642, 38.33864796410003, 48.20576200385888, 48.84139499518399, 47.94528396924336, 42.60611953834692, 43.301939653853566, 43.38979686299959, 38.96726768898466, 38.85422309363881, 38.398719574014336, 51.39438911527394, 50.99465619027613, 51.477072753012166, 38.605534732341766, 38.53302303701639, 38.63490715622902, 47.344999750455216, 47.88621039067705, 47.73412390549977, 36.923820222417504, 37.50416041786471, 36.904207090536744, 48.20552149042486, 48.35079544410108, 48.36083357408641, 39.38181748986244, 39.91714641824365, 39.86572910472751, 36.018019167085484, 36.255245113124445, 36.09255999078353, 47.83308091635506, 47.36325980226199, 47.80903711045782, 42.16737635433674, 42.198396474123, 42.1233494207263, 49.99110625311731, 50.074789032340036, 49.99506990611552, 46.041205311814934, 46.10006596023837, 46.15114695454636, 42.811613028248146, 43.2681317453583, 43.11262825628121, -63.921787310391665, -64.13378648459911, -64.33024637401104, 43.29683978056224, 43.171241516868264, 43.064736063281686, 32.831928888956696, 33.26498420039812, 33.367522480587155, 38.90904816240072, 39.23465557768941, 39.36080764885992, 40.084171538551644, 41.21920880054434, 41.051511989285544, 38.833733965953186, 38.84925814469655, 39.49521003415187, 28.13921388223146, 27.69489548852046, 27.95833971103032, 28.667339401940495, 28.812820127854735, 28.58805166433254, 50.73414165123056, 50.28509424130122, 50.441405783096954, 29.917693227529526, 30.026403233408928, 29.949968546628952, 24.744380881388977, 24.970583767940596, 23.560801466306046, 38.79177285730839, 39.28492168337107, 39.68648854084313, 41.553489342331886, 42.379975877702236, 41.88459433615208, 34.41075711448987, 34.90140401696165, 34.75030447294314, 39.3332738118867, 39.349408509830624, 39.3107413376371, 50.74075148502986, 51.78863964105646, 51.98079649653907, 32.63200473909576, 32.51114825656016, 32.67057596643765, 36.00132408117254, 35.61218526711066, 35.34381233652432, 45.812669853369385, 46.346094655493886, 46.31316357354322, 28.62366819381714, 28.665057957172394, 28.87931240350008, 15.980027750134468, 16.402876660227776, 16.310444720089436, 37.34605898956457, 37.62928014496961, 37.18464052180448, 60.67833450188239, 60.270752017696694, 60.22351362307866, 30.6749175041914, 30.986491210758686, 31.070374317467213, 40.6236437090362, 40.64147475051382, 39.70852969090143, 37.868603392193705, 37.99885052132109, 37.619348930815846, 49.04082488765319, 49.165471759935215, 49.35228175049026, 44.72489020476738, 44.76961115996042, 44.6977142865459, 34.837198346853256, 35.49548267945647, 34.436316058039665, 39.04657348369558, 39.05098171283801, 39.033587382485464, 35.75695137594205, 35.297794600327805, 35.64897841525574, 32.66226846600571, 32.14949661741653, 32.46377859140435, 40.34204332406321, 40.32760717223087, 40.18533922980228, 36.297243925432355, 36.71950677285591, 36.54202388475338, 40.98944609236787, 40.88040708936751, 40.212585389614105, 39.52880023854473, 39.566464425219834, 39.56780725034574, 28.958140696088464, 29.303599568704755, 29.06007760266462, 45.63812272747357, 45.830341951300696, 45.72933705647786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14226659853805776, "mean_inference_ms": 0.7008943769018291, "mean_action_processing_ms": 0.09646230182975282, "mean_env_wait_ms": 0.7902192086616782, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 840000, "timesteps_this_iter": 0, "agent_timesteps_total": 2520000, "timers": {"sample_time_ms": 10891.431, "sample_throughput": 459.076, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 2056.296, "learn_throughput": 2431.556, "update_time_ms": 9.357}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0331493317774013e-41, "cur_lr": 0.0005000000000000001, "total_loss": 5.828900861740112, "policy_loss": 0.0008050137912994249, "vf_loss": 5.933424377441407, "vf_explained_var": 0.012720638513565063, "kl": 0.0040781321470191355, "entropy": 10.532874965667725, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 840000, "num_agent_steps_sampled": 2520000, "num_steps_trained": 840000, "num_agent_steps_trained": 2520000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2356, "training_iteration": 168, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-31-44", "timestamp": 1706232704, "time_this_iter_s": 10.51410460472107, "time_total_s": 1817.5375349521637, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214024E8AF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1817.5375349521637, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 7.1866666666666665, "ram_util_percent": 62.59333333333334}}
{"episode_reward_max": 181.1726001426578, "episode_reward_min": -274.76691576465964, "episode_reward_mean": 104.26908769201225, "episode_len_mean": 495.41, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -103.03561969598135}, "policy_reward_max": {"shared_policy": 60.67833450188239}, "policy_reward_mean": {"shared_policy": 34.75636256400408}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.81398713914666, 99.77304358733815, 102.58738779276607, 129.68345360085385, 90.46199790388344, 135.1755575085991, 43.22068928927182, 91.77227283269166, 140.5483671892434, 116.28110626339911, 105.72648086398837, 139.72010543756195, -256.8339165300131, 158.2229510825126, 131.12963367067283, -274.76691576465964, 145.22717176377782, 112.9151337556541, 96.35493125021458, 119.9587105065584, 125.66843081451952, 124.24316695146263, 61.84237842820583, 113.33701720694079, 110.97970009595156, 98.27357029030097, 75.9966181562049, 77.30360133294015, 75.91303378343582, 116.23975023068486, 121.17680274881423, 99.46048504486677, 88.84649420902132, 101.69978922978042, 103.77098914608358, 125.12166463956234, 114.87179277837274, 144.99244096828625, 129.29785605520004, 116.2202103566378, 153.8661180585622, 115.77346492558718, 142.96533404663197, 111.33218773081896, 144.91715050861242, 119.1646930128336, 108.36582427099346, 143.00537782907506, 126.48912224918604, 150.06096519157276, 138.29241822659972, 129.19237302988785, -192.38582016900182, 129.53281736071216, 99.46443556994197, 117.50451138895005, 122.35489232838152, 117.1782021448016, 83.79244908178224, 86.06821119412777, 151.46064167562858, 89.8940650075674, 73.27576611563562, 117.76318308152258, 125.8180595561862, 104.06246560439466, 117.99342365935442, 154.51018762262538, 97.81372896209358, 106.95732168480752, 138.47192808240618, 86.16803855448961, 48.69334913045168, 112.15997965633866, 181.1726001426578, 92.7317830324173, 120.97364815045145, 113.48680284433064, 147.55857839807857, 134.19221565127387, 104.7689970843494, 117.13114257901906, 106.7037243915256, 97.2755436748266, 120.85498972609636, 109.55877458304164, 122.08243857134948, 118.6630719141103, 87.32181786745784, 137.19780173525191, 86.58758154697713, 140.5787329860029, 111.65368960797785, 124.39348085969685, 129.45127037272312, 81.17156056687234, 73.27663133479653, 150.04150463989947, 148.51627250388248, 110.35930645186454], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 259, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 480, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [45.165520331046224, 44.76948786030212, 44.8789789477984, 33.40934662769237, 33.55959768795097, 32.80409927169481, 34.25290152678886, 34.19727249319354, 34.13721377278367, 43.05538358539343, 43.189618460834026, 43.438451554626226, 30.14704495420058, 29.976868850489453, 30.33808409919341, 44.62966366112232, 44.88108253479004, 45.66481131268665, 14.58907739942272, 13.960389976700142, 14.671221913148955, 30.685562026997403, 30.35957148422797, 30.727139321466282, 46.74169651418923, 46.5949546843767, 47.21171599067746, 37.364440490802124, 39.264806290467575, 39.65185948212941, 35.11081092307964, 35.31086759890118, 35.30480234200755, 46.4948715120554, 46.37310864776373, 46.85212527774274, -85.31834869335096, -85.60098885248105, -85.91457898418109, 52.60398645699023, 52.55635448545216, 53.062610140070305, 43.25363026559353, 43.81872461736202, 44.05727878771722, -103.03561969598135, -86.18722452720007, -85.54407154147825, 48.20354513327281, 48.75274560848872, 48.27088102201621, 37.34077478945255, 37.71571456640959, 37.858644399791956, 32.10952325165272, 32.24371975660324, 32.00168824195862, 40.371460412939385, 39.828690384825066, 39.75855970879395, 41.872894898056984, 41.812491439282894, 41.98304447717965, 41.04101075232029, 41.39033282548189, 41.811823373660445, 20.500086826582745, 20.64808813979228, 20.69420346183081, 38.07411634906505, 37.357324709494904, 37.90557614838083, 37.294020891189575, 36.81271830201149, 36.87296090275049, 32.47407772640386, 32.660215246180684, 33.13927731771642, 25.499584864398145, 25.202065526197345, 25.294967765609414, 25.93166783669342, 25.85730494682987, 25.514628549416855, 25.043688789010048, 25.406805463135242, 25.46253953129053, 38.821607549985245, 39.28668866989513, 38.13145401080449, 40.39210954681039, 40.21839562803507, 40.56629757396877, 32.865078563491494, 33.1946173335115, 33.400789147863776, 30.068046906342104, 29.545126510163144, 29.233320792516068, 34.07402203356226, 33.81481411804755, 33.81095307817061, 34.3640684535106, 34.84953154002626, 34.55738915254672, 41.932212012509495, 42.0222588914136, 41.167193735639245, 38.32512720922628, 38.20801760504642, 38.33864796410003, 48.20576200385888, 48.84139499518399, 47.94528396924336, 42.60611953834692, 43.301939653853566, 43.38979686299959, 38.96726768898466, 38.85422309363881, 38.398719574014336, 51.39438911527394, 50.99465619027613, 51.477072753012166, 38.605534732341766, 38.53302303701639, 38.63490715622902, 47.344999750455216, 47.88621039067705, 47.73412390549977, 36.923820222417504, 37.50416041786471, 36.904207090536744, 48.20552149042486, 48.35079544410108, 48.36083357408641, 39.38181748986244, 39.91714641824365, 39.86572910472751, 36.018019167085484, 36.255245113124445, 36.09255999078353, 47.83308091635506, 47.36325980226199, 47.80903711045782, 42.16737635433674, 42.198396474123, 42.1233494207263, 49.99110625311731, 50.074789032340036, 49.99506990611552, 46.041205311814934, 46.10006596023837, 46.15114695454636, 42.811613028248146, 43.2681317453583, 43.11262825628121, -63.921787310391665, -64.13378648459911, -64.33024637401104, 43.29683978056224, 43.171241516868264, 43.064736063281686, 32.831928888956696, 33.26498420039812, 33.367522480587155, 38.90904816240072, 39.23465557768941, 39.36080764885992, 40.084171538551644, 41.21920880054434, 41.051511989285544, 38.833733965953186, 38.84925814469655, 39.49521003415187, 28.13921388223146, 27.69489548852046, 27.95833971103032, 28.667339401940495, 28.812820127854735, 28.58805166433254, 50.73414165123056, 50.28509424130122, 50.441405783096954, 29.917693227529526, 30.026403233408928, 29.949968546628952, 24.744380881388977, 24.970583767940596, 23.560801466306046, 38.79177285730839, 39.28492168337107, 39.68648854084313, 41.553489342331886, 42.379975877702236, 41.88459433615208, 34.41075711448987, 34.90140401696165, 34.75030447294314, 39.3332738118867, 39.349408509830624, 39.3107413376371, 50.74075148502986, 51.78863964105646, 51.98079649653907, 32.63200473909576, 32.51114825656016, 32.67057596643765, 36.00132408117254, 35.61218526711066, 35.34381233652432, 45.812669853369385, 46.346094655493886, 46.31316357354322, 28.62366819381714, 28.665057957172394, 28.87931240350008, 15.980027750134468, 16.402876660227776, 16.310444720089436, 37.34605898956457, 37.62928014496961, 37.18464052180448, 60.67833450188239, 60.270752017696694, 60.22351362307866, 30.6749175041914, 30.986491210758686, 31.070374317467213, 40.6236437090362, 40.64147475051382, 39.70852969090143, 37.868603392193705, 37.99885052132109, 37.619348930815846, 49.04082488765319, 49.165471759935215, 49.35228175049026, 44.72489020476738, 44.76961115996042, 44.6977142865459, 34.837198346853256, 35.49548267945647, 34.436316058039665, 39.04657348369558, 39.05098171283801, 39.033587382485464, 35.75695137594205, 35.297794600327805, 35.64897841525574, 32.66226846600571, 32.14949661741653, 32.46377859140435, 40.34204332406321, 40.32760717223087, 40.18533922980228, 36.297243925432355, 36.71950677285591, 36.54202388475338, 40.98944609236787, 40.88040708936751, 40.212585389614105, 39.52880023854473, 39.566464425219834, 39.56780725034574, 28.958140696088464, 29.303599568704755, 29.06007760266462, 45.63812272747357, 45.830341951300696, 45.72933705647786, 28.832025638471038, 29.054000162209064, 28.701555746297032, 46.78973915427922, 46.97051391378044, 46.81847991794346, 37.17656128605206, 37.10023932655652, 37.37688899536927, 41.3320845713218, 41.27427953978379, 41.78711674859126, 42.88503805051246, 43.31835896874932, 43.247873353461415, 27.14551045869787, 27.249951300521687, 26.776098807652787, 24.107133155067757, 24.322991674145058, 24.84650650558372, 49.684662876029805, 50.16216707074393, 50.194674693125606, 49.14503729343413, 49.74963900074361, 49.62159620970486, 36.77068682387471, 36.967866220511496, 36.62075340747833]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14227288194783635, "mean_inference_ms": 0.7010038376711987, "mean_action_processing_ms": 0.09647091281724947, "mean_env_wait_ms": 0.7901346885304988, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 845000, "timesteps_this_iter": 0, "agent_timesteps_total": 2535000, "timers": {"sample_time_ms": 10848.252, "sample_throughput": 460.904, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 2021.665, "learn_throughput": 2473.209, "update_time_ms": 9.175}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.1657466588870064e-42, "cur_lr": 0.0005000000000000001, "total_loss": 5.860283756256104, "policy_loss": -0.0011810908626182838, "vf_loss": 5.966157150268555, "vf_explained_var": 0.0460486114025116, "kl": 0.00261702771536334, "entropy": 10.46922254562378, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 845000, "num_agent_steps_sampled": 2535000, "num_steps_trained": 845000, "num_agent_steps_trained": 2535000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2366, "training_iteration": 169, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-31-54", "timestamp": 1706232714, "time_this_iter_s": 10.375873327255249, "time_total_s": 1827.913408279419, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D211F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1827.913408279419, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 6.859999999999999, "ram_util_percent": 62.56000000000001}}
{"episode_reward_max": 181.1726001426578, "episode_reward_min": -274.76691576465964, "episode_reward_mean": 104.82987436999538, "episode_len_mean": 495.41, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -103.03561969598135}, "policy_reward_max": {"shared_policy": 60.67833450188239}, "policy_reward_mean": {"shared_policy": 34.94329145666512}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.72648086398837, 139.72010543756195, -256.8339165300131, 158.2229510825126, 131.12963367067283, -274.76691576465964, 145.22717176377782, 112.9151337556541, 96.35493125021458, 119.9587105065584, 125.66843081451952, 124.24316695146263, 61.84237842820583, 113.33701720694079, 110.97970009595156, 98.27357029030097, 75.9966181562049, 77.30360133294015, 75.91303378343582, 116.23975023068486, 121.17680274881423, 99.46048504486677, 88.84649420902132, 101.69978922978042, 103.77098914608358, 125.12166463956234, 114.87179277837274, 144.99244096828625, 129.29785605520004, 116.2202103566378, 153.8661180585622, 115.77346492558718, 142.96533404663197, 111.33218773081896, 144.91715050861242, 119.1646930128336, 108.36582427099346, 143.00537782907506, 126.48912224918604, 150.06096519157276, 138.29241822659972, 129.19237302988785, -192.38582016900182, 129.53281736071216, 99.46443556994197, 117.50451138895005, 122.35489232838152, 117.1782021448016, 83.79244908178224, 86.06821119412777, 151.46064167562858, 89.8940650075674, 73.27576611563562, 117.76318308152258, 125.8180595561862, 104.06246560439466, 117.99342365935442, 154.51018762262538, 97.81372896209358, 106.95732168480752, 138.47192808240618, 86.16803855448961, 48.69334913045168, 112.15997965633866, 181.1726001426578, 92.7317830324173, 120.97364815045145, 113.48680284433064, 147.55857839807857, 134.19221565127387, 104.7689970843494, 117.13114257901906, 106.7037243915256, 97.2755436748266, 120.85498972609636, 109.55877458304164, 122.08243857134948, 118.6630719141103, 87.32181786745784, 137.19780173525191, 86.58758154697713, 140.5787329860029, 111.65368960797785, 124.39348085969685, 129.45127037272312, 81.17156056687234, 73.27663133479653, 150.04150463989947, 148.51627250388248, 110.35930645186454, 131.3013291105163, 134.91510375542572, 117.78233885532244, 124.01459141448139, 79.7008546218276, 83.36108776926993, 101.96372764185071, 123.6073152348399, 122.14091636240481, 121.60926613956688], "episode_lengths": [500, 500, 302, 500, 500, 259, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 480, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [35.11081092307964, 35.31086759890118, 35.30480234200755, 46.4948715120554, 46.37310864776373, 46.85212527774274, -85.31834869335096, -85.60098885248105, -85.91457898418109, 52.60398645699023, 52.55635448545216, 53.062610140070305, 43.25363026559353, 43.81872461736202, 44.05727878771722, -103.03561969598135, -86.18722452720007, -85.54407154147825, 48.20354513327281, 48.75274560848872, 48.27088102201621, 37.34077478945255, 37.71571456640959, 37.858644399791956, 32.10952325165272, 32.24371975660324, 32.00168824195862, 40.371460412939385, 39.828690384825066, 39.75855970879395, 41.872894898056984, 41.812491439282894, 41.98304447717965, 41.04101075232029, 41.39033282548189, 41.811823373660445, 20.500086826582745, 20.64808813979228, 20.69420346183081, 38.07411634906505, 37.357324709494904, 37.90557614838083, 37.294020891189575, 36.81271830201149, 36.87296090275049, 32.47407772640386, 32.660215246180684, 33.13927731771642, 25.499584864398145, 25.202065526197345, 25.294967765609414, 25.93166783669342, 25.85730494682987, 25.514628549416855, 25.043688789010048, 25.406805463135242, 25.46253953129053, 38.821607549985245, 39.28668866989513, 38.13145401080449, 40.39210954681039, 40.21839562803507, 40.56629757396877, 32.865078563491494, 33.1946173335115, 33.400789147863776, 30.068046906342104, 29.545126510163144, 29.233320792516068, 34.07402203356226, 33.81481411804755, 33.81095307817061, 34.3640684535106, 34.84953154002626, 34.55738915254672, 41.932212012509495, 42.0222588914136, 41.167193735639245, 38.32512720922628, 38.20801760504642, 38.33864796410003, 48.20576200385888, 48.84139499518399, 47.94528396924336, 42.60611953834692, 43.301939653853566, 43.38979686299959, 38.96726768898466, 38.85422309363881, 38.398719574014336, 51.39438911527394, 50.99465619027613, 51.477072753012166, 38.605534732341766, 38.53302303701639, 38.63490715622902, 47.344999750455216, 47.88621039067705, 47.73412390549977, 36.923820222417504, 37.50416041786471, 36.904207090536744, 48.20552149042486, 48.35079544410108, 48.36083357408641, 39.38181748986244, 39.91714641824365, 39.86572910472751, 36.018019167085484, 36.255245113124445, 36.09255999078353, 47.83308091635506, 47.36325980226199, 47.80903711045782, 42.16737635433674, 42.198396474123, 42.1233494207263, 49.99110625311731, 50.074789032340036, 49.99506990611552, 46.041205311814934, 46.10006596023837, 46.15114695454636, 42.811613028248146, 43.2681317453583, 43.11262825628121, -63.921787310391665, -64.13378648459911, -64.33024637401104, 43.29683978056224, 43.171241516868264, 43.064736063281686, 32.831928888956696, 33.26498420039812, 33.367522480587155, 38.90904816240072, 39.23465557768941, 39.36080764885992, 40.084171538551644, 41.21920880054434, 41.051511989285544, 38.833733965953186, 38.84925814469655, 39.49521003415187, 28.13921388223146, 27.69489548852046, 27.95833971103032, 28.667339401940495, 28.812820127854735, 28.58805166433254, 50.73414165123056, 50.28509424130122, 50.441405783096954, 29.917693227529526, 30.026403233408928, 29.949968546628952, 24.744380881388977, 24.970583767940596, 23.560801466306046, 38.79177285730839, 39.28492168337107, 39.68648854084313, 41.553489342331886, 42.379975877702236, 41.88459433615208, 34.41075711448987, 34.90140401696165, 34.75030447294314, 39.3332738118867, 39.349408509830624, 39.3107413376371, 50.74075148502986, 51.78863964105646, 51.98079649653907, 32.63200473909576, 32.51114825656016, 32.67057596643765, 36.00132408117254, 35.61218526711066, 35.34381233652432, 45.812669853369385, 46.346094655493886, 46.31316357354322, 28.62366819381714, 28.665057957172394, 28.87931240350008, 15.980027750134468, 16.402876660227776, 16.310444720089436, 37.34605898956457, 37.62928014496961, 37.18464052180448, 60.67833450188239, 60.270752017696694, 60.22351362307866, 30.6749175041914, 30.986491210758686, 31.070374317467213, 40.6236437090362, 40.64147475051382, 39.70852969090143, 37.868603392193705, 37.99885052132109, 37.619348930815846, 49.04082488765319, 49.165471759935215, 49.35228175049026, 44.72489020476738, 44.76961115996042, 44.6977142865459, 34.837198346853256, 35.49548267945647, 34.436316058039665, 39.04657348369558, 39.05098171283801, 39.033587382485464, 35.75695137594205, 35.297794600327805, 35.64897841525574, 32.66226846600571, 32.14949661741653, 32.46377859140435, 40.34204332406321, 40.32760717223087, 40.18533922980228, 36.297243925432355, 36.71950677285591, 36.54202388475338, 40.98944609236787, 40.88040708936751, 40.212585389614105, 39.52880023854473, 39.566464425219834, 39.56780725034574, 28.958140696088464, 29.303599568704755, 29.06007760266462, 45.63812272747357, 45.830341951300696, 45.72933705647786, 28.832025638471038, 29.054000162209064, 28.701555746297032, 46.78973915427922, 46.97051391378044, 46.81847991794346, 37.17656128605206, 37.10023932655652, 37.37688899536927, 41.3320845713218, 41.27427953978379, 41.78711674859126, 42.88503805051246, 43.31835896874932, 43.247873353461415, 27.14551045869787, 27.249951300521687, 26.776098807652787, 24.107133155067757, 24.322991674145058, 24.84650650558372, 49.684662876029805, 50.16216707074393, 50.194674693125606, 49.14503729343413, 49.74963900074361, 49.62159620970486, 36.77068682387471, 36.967866220511496, 36.62075340747833, 43.96832962877427, 43.99757904706833, 43.33542043467362, 44.71647036075592, 45.15629734424874, 45.042336050421, 39.01406434675057, 39.27786221106847, 39.4904122975034, 40.99821514387925, 41.50939256822069, 41.50698370238145, 26.72260022908449, 26.63150730729103, 26.34674708545208, 27.908330669005707, 27.616749738653496, 27.836007361610726, 34.20911265537143, 33.475976809859276, 34.27863817662001, 40.482916732629135, 41.42307845254739, 41.70132004966338, 40.40881422658761, 40.68980277826388, 41.04229935755332, 40.13814528783162, 40.66990492244561, 40.801215929289654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1422728941797363, "mean_inference_ms": 0.7010780914895679, "mean_action_processing_ms": 0.0964815751711291, "mean_env_wait_ms": 0.7900269016528256, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 850000, "timesteps_this_iter": 0, "agent_timesteps_total": 2550000, "timers": {"sample_time_ms": 10732.44, "sample_throughput": 465.877, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 2005.933, "learn_throughput": 2492.605, "update_time_ms": 9.136}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.5828733294435032e-42, "cur_lr": 0.0005000000000000001, "total_loss": 6.126554775238037, "policy_loss": -0.0012833102732463075, "vf_loss": 6.232696866989135, "vf_explained_var": 0.07835167050361633, "kl": 0.0029597775778293736, "entropy": 10.485890197753907, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 850000, "num_agent_steps_sampled": 2550000, "num_steps_trained": 850000, "num_agent_steps_trained": 2550000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2376, "training_iteration": 170, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-32-05", "timestamp": 1706232725, "time_this_iter_s": 10.182733535766602, "time_total_s": 1838.0961418151855, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401A964C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1838.0961418151855, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 7.328571428571428, "ram_util_percent": 62.550000000000004}}
{"episode_reward_max": 181.1726001426578, "episode_reward_min": -192.38582016900182, "episode_reward_mean": 112.02444966489416, "episode_len_mean": 499.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -64.33024637401104}, "policy_reward_max": {"shared_policy": 60.67833450188239}, "policy_reward_mean": {"shared_policy": 37.34148322163139}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.66843081451952, 124.24316695146263, 61.84237842820583, 113.33701720694079, 110.97970009595156, 98.27357029030097, 75.9966181562049, 77.30360133294015, 75.91303378343582, 116.23975023068486, 121.17680274881423, 99.46048504486677, 88.84649420902132, 101.69978922978042, 103.77098914608358, 125.12166463956234, 114.87179277837274, 144.99244096828625, 129.29785605520004, 116.2202103566378, 153.8661180585622, 115.77346492558718, 142.96533404663197, 111.33218773081896, 144.91715050861242, 119.1646930128336, 108.36582427099346, 143.00537782907506, 126.48912224918604, 150.06096519157276, 138.29241822659972, 129.19237302988785, -192.38582016900182, 129.53281736071216, 99.46443556994197, 117.50451138895005, 122.35489232838152, 117.1782021448016, 83.79244908178224, 86.06821119412777, 151.46064167562858, 89.8940650075674, 73.27576611563562, 117.76318308152258, 125.8180595561862, 104.06246560439466, 117.99342365935442, 154.51018762262538, 97.81372896209358, 106.95732168480752, 138.47192808240618, 86.16803855448961, 48.69334913045168, 112.15997965633866, 181.1726001426578, 92.7317830324173, 120.97364815045145, 113.48680284433064, 147.55857839807857, 134.19221565127387, 104.7689970843494, 117.13114257901906, 106.7037243915256, 97.2755436748266, 120.85498972609636, 109.55877458304164, 122.08243857134948, 118.6630719141103, 87.32181786745784, 137.19780173525191, 86.58758154697713, 140.5787329860029, 111.65368960797785, 124.39348085969685, 129.45127037272312, 81.17156056687234, 73.27663133479653, 150.04150463989947, 148.51627250388248, 110.35930645186454, 131.3013291105163, 134.91510375542572, 117.78233885532244, 124.01459141448139, 79.7008546218276, 83.36108776926993, 101.96372764185071, 123.6073152348399, 122.14091636240481, 121.60926613956688, 135.3320670276879, 124.02909008413553, 81.2758203819394, 121.48541076108813, 149.49014445114864, 81.4721916913986, 96.03856132179497, 100.78986747562885, 149.36821856535963, 157.83044376596834], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 480, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [41.872894898056984, 41.812491439282894, 41.98304447717965, 41.04101075232029, 41.39033282548189, 41.811823373660445, 20.500086826582745, 20.64808813979228, 20.69420346183081, 38.07411634906505, 37.357324709494904, 37.90557614838083, 37.294020891189575, 36.81271830201149, 36.87296090275049, 32.47407772640386, 32.660215246180684, 33.13927731771642, 25.499584864398145, 25.202065526197345, 25.294967765609414, 25.93166783669342, 25.85730494682987, 25.514628549416855, 25.043688789010048, 25.406805463135242, 25.46253953129053, 38.821607549985245, 39.28668866989513, 38.13145401080449, 40.39210954681039, 40.21839562803507, 40.56629757396877, 32.865078563491494, 33.1946173335115, 33.400789147863776, 30.068046906342104, 29.545126510163144, 29.233320792516068, 34.07402203356226, 33.81481411804755, 33.81095307817061, 34.3640684535106, 34.84953154002626, 34.55738915254672, 41.932212012509495, 42.0222588914136, 41.167193735639245, 38.32512720922628, 38.20801760504642, 38.33864796410003, 48.20576200385888, 48.84139499518399, 47.94528396924336, 42.60611953834692, 43.301939653853566, 43.38979686299959, 38.96726768898466, 38.85422309363881, 38.398719574014336, 51.39438911527394, 50.99465619027613, 51.477072753012166, 38.605534732341766, 38.53302303701639, 38.63490715622902, 47.344999750455216, 47.88621039067705, 47.73412390549977, 36.923820222417504, 37.50416041786471, 36.904207090536744, 48.20552149042486, 48.35079544410108, 48.36083357408641, 39.38181748986244, 39.91714641824365, 39.86572910472751, 36.018019167085484, 36.255245113124445, 36.09255999078353, 47.83308091635506, 47.36325980226199, 47.80903711045782, 42.16737635433674, 42.198396474123, 42.1233494207263, 49.99110625311731, 50.074789032340036, 49.99506990611552, 46.041205311814934, 46.10006596023837, 46.15114695454636, 42.811613028248146, 43.2681317453583, 43.11262825628121, -63.921787310391665, -64.13378648459911, -64.33024637401104, 43.29683978056224, 43.171241516868264, 43.064736063281686, 32.831928888956696, 33.26498420039812, 33.367522480587155, 38.90904816240072, 39.23465557768941, 39.36080764885992, 40.084171538551644, 41.21920880054434, 41.051511989285544, 38.833733965953186, 38.84925814469655, 39.49521003415187, 28.13921388223146, 27.69489548852046, 27.95833971103032, 28.667339401940495, 28.812820127854735, 28.58805166433254, 50.73414165123056, 50.28509424130122, 50.441405783096954, 29.917693227529526, 30.026403233408928, 29.949968546628952, 24.744380881388977, 24.970583767940596, 23.560801466306046, 38.79177285730839, 39.28492168337107, 39.68648854084313, 41.553489342331886, 42.379975877702236, 41.88459433615208, 34.41075711448987, 34.90140401696165, 34.75030447294314, 39.3332738118867, 39.349408509830624, 39.3107413376371, 50.74075148502986, 51.78863964105646, 51.98079649653907, 32.63200473909576, 32.51114825656016, 32.67057596643765, 36.00132408117254, 35.61218526711066, 35.34381233652432, 45.812669853369385, 46.346094655493886, 46.31316357354322, 28.62366819381714, 28.665057957172394, 28.87931240350008, 15.980027750134468, 16.402876660227776, 16.310444720089436, 37.34605898956457, 37.62928014496961, 37.18464052180448, 60.67833450188239, 60.270752017696694, 60.22351362307866, 30.6749175041914, 30.986491210758686, 31.070374317467213, 40.6236437090362, 40.64147475051382, 39.70852969090143, 37.868603392193705, 37.99885052132109, 37.619348930815846, 49.04082488765319, 49.165471759935215, 49.35228175049026, 44.72489020476738, 44.76961115996042, 44.6977142865459, 34.837198346853256, 35.49548267945647, 34.436316058039665, 39.04657348369558, 39.05098171283801, 39.033587382485464, 35.75695137594205, 35.297794600327805, 35.64897841525574, 32.66226846600571, 32.14949661741653, 32.46377859140435, 40.34204332406321, 40.32760717223087, 40.18533922980228, 36.297243925432355, 36.71950677285591, 36.54202388475338, 40.98944609236787, 40.88040708936751, 40.212585389614105, 39.52880023854473, 39.566464425219834, 39.56780725034574, 28.958140696088464, 29.303599568704755, 29.06007760266462, 45.63812272747357, 45.830341951300696, 45.72933705647786, 28.832025638471038, 29.054000162209064, 28.701555746297032, 46.78973915427922, 46.97051391378044, 46.81847991794346, 37.17656128605206, 37.10023932655652, 37.37688899536927, 41.3320845713218, 41.27427953978379, 41.78711674859126, 42.88503805051246, 43.31835896874932, 43.247873353461415, 27.14551045869787, 27.249951300521687, 26.776098807652787, 24.107133155067757, 24.322991674145058, 24.84650650558372, 49.684662876029805, 50.16216707074393, 50.194674693125606, 49.14503729343413, 49.74963900074361, 49.62159620970486, 36.77068682387471, 36.967866220511496, 36.62075340747833, 43.96832962877427, 43.99757904706833, 43.33542043467362, 44.71647036075592, 45.15629734424874, 45.042336050421, 39.01406434675057, 39.27786221106847, 39.4904122975034, 40.99821514387925, 41.50939256822069, 41.50698370238145, 26.72260022908449, 26.63150730729103, 26.34674708545208, 27.908330669005707, 27.616749738653496, 27.836007361610726, 34.20911265537143, 33.475976809859276, 34.27863817662001, 40.482916732629135, 41.42307845254739, 41.70132004966338, 40.40881422658761, 40.68980277826388, 41.04229935755332, 40.13814528783162, 40.66990492244561, 40.801215929289654, 45.4557997037967, 44.831878696878746, 45.044388627012566, 41.24385657906532, 41.64110466092825, 41.14412884414196, 27.404990439613655, 26.37974040706952, 27.491089535256222, 40.385214015841484, 40.35962447524071, 40.74057227000594, 49.974812285664186, 49.615933748583004, 49.89939841690163, 27.178733961035803, 27.212054447581366, 27.081403282781437, 32.13867776965101, 32.20814698313673, 31.691736569007233, 33.442702412605286, 33.632556207478046, 33.71460885554552, 50.212835070366665, 49.97874512026708, 49.17663837472598, 52.67057837049167, 52.497625845174, 52.66223955030243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14226625915107655, "mean_inference_ms": 0.7013018777833666, "mean_action_processing_ms": 0.09651570472336973, "mean_env_wait_ms": 0.7899942355016439, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 855000, "timesteps_this_iter": 0, "agent_timesteps_total": 2565000, "timers": {"sample_time_ms": 10671.487, "sample_throughput": 468.538, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1988.156, "learn_throughput": 2514.894, "update_time_ms": 9.137}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2914366647217516e-42, "cur_lr": 0.0005000000000000001, "total_loss": 7.046702766418457, "policy_loss": -0.0012060178127481168, "vf_loss": 7.1528843402862545, "vf_explained_var": 0.04719493985176086, "kl": 0.0021352431824684217, "entropy": 10.497559356689454, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 855000, "num_agent_steps_sampled": 2565000, "num_steps_trained": 855000, "num_agent_steps_trained": 2565000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2386, "training_iteration": 171, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-32-15", "timestamp": 1706232735, "time_this_iter_s": 10.341240406036377, "time_total_s": 1848.437382221222, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140424FB80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1848.437382221222, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 5.626666666666666, "ram_util_percent": 62.640000000000015}}
{"episode_reward_max": 181.1726001426578, "episode_reward_min": -192.38582016900182, "episode_reward_mean": 115.24824688991328, "episode_len_mean": 499.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -64.33024637401104}, "policy_reward_max": {"shared_policy": 60.67833450188239}, "policy_reward_mean": {"shared_policy": 38.416082296637754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [121.17680274881423, 99.46048504486677, 88.84649420902132, 101.69978922978042, 103.77098914608358, 125.12166463956234, 114.87179277837274, 144.99244096828625, 129.29785605520004, 116.2202103566378, 153.8661180585622, 115.77346492558718, 142.96533404663197, 111.33218773081896, 144.91715050861242, 119.1646930128336, 108.36582427099346, 143.00537782907506, 126.48912224918604, 150.06096519157276, 138.29241822659972, 129.19237302988785, -192.38582016900182, 129.53281736071216, 99.46443556994197, 117.50451138895005, 122.35489232838152, 117.1782021448016, 83.79244908178224, 86.06821119412777, 151.46064167562858, 89.8940650075674, 73.27576611563562, 117.76318308152258, 125.8180595561862, 104.06246560439466, 117.99342365935442, 154.51018762262538, 97.81372896209358, 106.95732168480752, 138.47192808240618, 86.16803855448961, 48.69334913045168, 112.15997965633866, 181.1726001426578, 92.7317830324173, 120.97364815045145, 113.48680284433064, 147.55857839807857, 134.19221565127387, 104.7689970843494, 117.13114257901906, 106.7037243915256, 97.2755436748266, 120.85498972609636, 109.55877458304164, 122.08243857134948, 118.6630719141103, 87.32181786745784, 137.19780173525191, 86.58758154697713, 140.5787329860029, 111.65368960797785, 124.39348085969685, 129.45127037272312, 81.17156056687234, 73.27663133479653, 150.04150463989947, 148.51627250388248, 110.35930645186454, 131.3013291105163, 134.91510375542572, 117.78233885532244, 124.01459141448139, 79.7008546218276, 83.36108776926993, 101.96372764185071, 123.6073152348399, 122.14091636240481, 121.60926613956688, 135.3320670276879, 124.02909008413553, 81.2758203819394, 121.48541076108813, 149.49014445114864, 81.4721916913986, 96.03856132179497, 100.78986747562885, 149.36821856535963, 157.83044376596834, 135.1077692918479, 157.68254493921987, 71.66607001051307, 125.35621864645508, 141.81636703014408, 119.85771983116865, 143.9591757557353, 162.75008944794527, 140.5315816439686, 103.44945319555697], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 480, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [40.39210954681039, 40.21839562803507, 40.56629757396877, 32.865078563491494, 33.1946173335115, 33.400789147863776, 30.068046906342104, 29.545126510163144, 29.233320792516068, 34.07402203356226, 33.81481411804755, 33.81095307817061, 34.3640684535106, 34.84953154002626, 34.55738915254672, 41.932212012509495, 42.0222588914136, 41.167193735639245, 38.32512720922628, 38.20801760504642, 38.33864796410003, 48.20576200385888, 48.84139499518399, 47.94528396924336, 42.60611953834692, 43.301939653853566, 43.38979686299959, 38.96726768898466, 38.85422309363881, 38.398719574014336, 51.39438911527394, 50.99465619027613, 51.477072753012166, 38.605534732341766, 38.53302303701639, 38.63490715622902, 47.344999750455216, 47.88621039067705, 47.73412390549977, 36.923820222417504, 37.50416041786471, 36.904207090536744, 48.20552149042486, 48.35079544410108, 48.36083357408641, 39.38181748986244, 39.91714641824365, 39.86572910472751, 36.018019167085484, 36.255245113124445, 36.09255999078353, 47.83308091635506, 47.36325980226199, 47.80903711045782, 42.16737635433674, 42.198396474123, 42.1233494207263, 49.99110625311731, 50.074789032340036, 49.99506990611552, 46.041205311814934, 46.10006596023837, 46.15114695454636, 42.811613028248146, 43.2681317453583, 43.11262825628121, -63.921787310391665, -64.13378648459911, -64.33024637401104, 43.29683978056224, 43.171241516868264, 43.064736063281686, 32.831928888956696, 33.26498420039812, 33.367522480587155, 38.90904816240072, 39.23465557768941, 39.36080764885992, 40.084171538551644, 41.21920880054434, 41.051511989285544, 38.833733965953186, 38.84925814469655, 39.49521003415187, 28.13921388223146, 27.69489548852046, 27.95833971103032, 28.667339401940495, 28.812820127854735, 28.58805166433254, 50.73414165123056, 50.28509424130122, 50.441405783096954, 29.917693227529526, 30.026403233408928, 29.949968546628952, 24.744380881388977, 24.970583767940596, 23.560801466306046, 38.79177285730839, 39.28492168337107, 39.68648854084313, 41.553489342331886, 42.379975877702236, 41.88459433615208, 34.41075711448987, 34.90140401696165, 34.75030447294314, 39.3332738118867, 39.349408509830624, 39.3107413376371, 50.74075148502986, 51.78863964105646, 51.98079649653907, 32.63200473909576, 32.51114825656016, 32.67057596643765, 36.00132408117254, 35.61218526711066, 35.34381233652432, 45.812669853369385, 46.346094655493886, 46.31316357354322, 28.62366819381714, 28.665057957172394, 28.87931240350008, 15.980027750134468, 16.402876660227776, 16.310444720089436, 37.34605898956457, 37.62928014496961, 37.18464052180448, 60.67833450188239, 60.270752017696694, 60.22351362307866, 30.6749175041914, 30.986491210758686, 31.070374317467213, 40.6236437090362, 40.64147475051382, 39.70852969090143, 37.868603392193705, 37.99885052132109, 37.619348930815846, 49.04082488765319, 49.165471759935215, 49.35228175049026, 44.72489020476738, 44.76961115996042, 44.6977142865459, 34.837198346853256, 35.49548267945647, 34.436316058039665, 39.04657348369558, 39.05098171283801, 39.033587382485464, 35.75695137594205, 35.297794600327805, 35.64897841525574, 32.66226846600571, 32.14949661741653, 32.46377859140435, 40.34204332406321, 40.32760717223087, 40.18533922980228, 36.297243925432355, 36.71950677285591, 36.54202388475338, 40.98944609236787, 40.88040708936751, 40.212585389614105, 39.52880023854473, 39.566464425219834, 39.56780725034574, 28.958140696088464, 29.303599568704755, 29.06007760266462, 45.63812272747357, 45.830341951300696, 45.72933705647786, 28.832025638471038, 29.054000162209064, 28.701555746297032, 46.78973915427922, 46.97051391378044, 46.81847991794346, 37.17656128605206, 37.10023932655652, 37.37688899536927, 41.3320845713218, 41.27427953978379, 41.78711674859126, 42.88503805051246, 43.31835896874932, 43.247873353461415, 27.14551045869787, 27.249951300521687, 26.776098807652787, 24.107133155067757, 24.322991674145058, 24.84650650558372, 49.684662876029805, 50.16216707074393, 50.194674693125606, 49.14503729343413, 49.74963900074361, 49.62159620970486, 36.77068682387471, 36.967866220511496, 36.62075340747833, 43.96832962877427, 43.99757904706833, 43.33542043467362, 44.71647036075592, 45.15629734424874, 45.042336050421, 39.01406434675057, 39.27786221106847, 39.4904122975034, 40.99821514387925, 41.50939256822069, 41.50698370238145, 26.72260022908449, 26.63150730729103, 26.34674708545208, 27.908330669005707, 27.616749738653496, 27.836007361610726, 34.20911265537143, 33.475976809859276, 34.27863817662001, 40.482916732629135, 41.42307845254739, 41.70132004966338, 40.40881422658761, 40.68980277826388, 41.04229935755332, 40.13814528783162, 40.66990492244561, 40.801215929289654, 45.4557997037967, 44.831878696878746, 45.044388627012566, 41.24385657906532, 41.64110466092825, 41.14412884414196, 27.404990439613655, 26.37974040706952, 27.491089535256222, 40.385214015841484, 40.35962447524071, 40.74057227000594, 49.974812285664186, 49.615933748583004, 49.89939841690163, 27.178733961035803, 27.212054447581366, 27.081403282781437, 32.13867776965101, 32.20814698313673, 31.691736569007233, 33.442702412605286, 33.632556207478046, 33.71460885554552, 50.212835070366665, 49.97874512026708, 49.17663837472598, 52.67057837049167, 52.497625845174, 52.66223955030243, 44.88999914874633, 45.07055152704318, 45.147218616058424, 52.47374079376458, 52.84169393777846, 52.36711020767687, 23.800225131213665, 23.68370158970356, 24.182143289595842, 41.55122410257657, 41.800668628265456, 42.00432591561305, 47.10454592108725, 47.13085630536078, 47.580964803695665, 39.46698671579361, 40.84033029526472, 39.55040282011032, 47.700277045369134, 47.80933633446692, 48.44956237589939, 54.07044276595114, 54.47621090337633, 54.203435778617845, 47.12883026152848, 47.014222916215644, 46.388528466224656, 34.66500231872001, 34.0326666633288, 34.75178421350816]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14224948252998312, "mean_inference_ms": 0.7013439639853278, "mean_action_processing_ms": 0.09652524505316579, "mean_env_wait_ms": 0.789855812848106, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 860000, "timesteps_this_iter": 0, "agent_timesteps_total": 2580000, "timers": {"sample_time_ms": 10618.818, "sample_throughput": 470.862, "load_time_ms": 0.1, "load_throughput": 49991704.41, "learn_time_ms": 1971.189, "learn_throughput": 2536.541, "update_time_ms": 9.237}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.457183323608758e-43, "cur_lr": 0.0005000000000000001, "total_loss": 9.68210210800171, "policy_loss": -0.0017853408526629978, "vf_loss": 9.789013481140136, "vf_explained_var": -0.0016588807106018067, "kl": 0.0024484690919552242, "entropy": 10.512575626373291, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 860000, "num_agent_steps_sampled": 2580000, "num_steps_trained": 860000, "num_agent_steps_trained": 2580000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2396, "training_iteration": 172, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-32-25", "timestamp": 1706232745, "time_this_iter_s": 10.318689584732056, "time_total_s": 1858.756071805954, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140234D790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1858.756071805954, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 7.864285714285714, "ram_util_percent": 62.564285714285724}}
{"episode_reward_max": 181.1726001426578, "episode_reward_min": -192.38582016900182, "episode_reward_mean": 114.85217469144175, "episode_len_mean": 499.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -64.33024637401104}, "policy_reward_max": {"shared_policy": 60.67833450188239}, "policy_reward_mean": {"shared_policy": 38.28405823048059}, "custom_metrics": {}, "hist_stats": {"episode_reward": [153.8661180585622, 115.77346492558718, 142.96533404663197, 111.33218773081896, 144.91715050861242, 119.1646930128336, 108.36582427099346, 143.00537782907506, 126.48912224918604, 150.06096519157276, 138.29241822659972, 129.19237302988785, -192.38582016900182, 129.53281736071216, 99.46443556994197, 117.50451138895005, 122.35489232838152, 117.1782021448016, 83.79244908178224, 86.06821119412777, 151.46064167562858, 89.8940650075674, 73.27576611563562, 117.76318308152258, 125.8180595561862, 104.06246560439466, 117.99342365935442, 154.51018762262538, 97.81372896209358, 106.95732168480752, 138.47192808240618, 86.16803855448961, 48.69334913045168, 112.15997965633866, 181.1726001426578, 92.7317830324173, 120.97364815045145, 113.48680284433064, 147.55857839807857, 134.19221565127387, 104.7689970843494, 117.13114257901906, 106.7037243915256, 97.2755436748266, 120.85498972609636, 109.55877458304164, 122.08243857134948, 118.6630719141103, 87.32181786745784, 137.19780173525191, 86.58758154697713, 140.5787329860029, 111.65368960797785, 124.39348085969685, 129.45127037272312, 81.17156056687234, 73.27663133479653, 150.04150463989947, 148.51627250388248, 110.35930645186454, 131.3013291105163, 134.91510375542572, 117.78233885532244, 124.01459141448139, 79.7008546218276, 83.36108776926993, 101.96372764185071, 123.6073152348399, 122.14091636240481, 121.60926613956688, 135.3320670276879, 124.02909008413553, 81.2758203819394, 121.48541076108813, 149.49014445114864, 81.4721916913986, 96.03856132179497, 100.78986747562885, 149.36821856535963, 157.83044376596834, 135.1077692918479, 157.68254493921987, 71.66607001051307, 125.35621864645508, 141.81636703014408, 119.85771983116865, 143.9591757557353, 162.75008944794527, 140.5315816439686, 103.44945319555697, 134.83161361212836, 84.43382710078728, 94.3345118537545, 87.47815917432308, 107.1426448263228, 114.60413473471998, 130.61997028905893, 117.31973693519828, 123.37663860712199, 111.71006819605826], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 480, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [51.39438911527394, 50.99465619027613, 51.477072753012166, 38.605534732341766, 38.53302303701639, 38.63490715622902, 47.344999750455216, 47.88621039067705, 47.73412390549977, 36.923820222417504, 37.50416041786471, 36.904207090536744, 48.20552149042486, 48.35079544410108, 48.36083357408641, 39.38181748986244, 39.91714641824365, 39.86572910472751, 36.018019167085484, 36.255245113124445, 36.09255999078353, 47.83308091635506, 47.36325980226199, 47.80903711045782, 42.16737635433674, 42.198396474123, 42.1233494207263, 49.99110625311731, 50.074789032340036, 49.99506990611552, 46.041205311814934, 46.10006596023837, 46.15114695454636, 42.811613028248146, 43.2681317453583, 43.11262825628121, -63.921787310391665, -64.13378648459911, -64.33024637401104, 43.29683978056224, 43.171241516868264, 43.064736063281686, 32.831928888956696, 33.26498420039812, 33.367522480587155, 38.90904816240072, 39.23465557768941, 39.36080764885992, 40.084171538551644, 41.21920880054434, 41.051511989285544, 38.833733965953186, 38.84925814469655, 39.49521003415187, 28.13921388223146, 27.69489548852046, 27.95833971103032, 28.667339401940495, 28.812820127854735, 28.58805166433254, 50.73414165123056, 50.28509424130122, 50.441405783096954, 29.917693227529526, 30.026403233408928, 29.949968546628952, 24.744380881388977, 24.970583767940596, 23.560801466306046, 38.79177285730839, 39.28492168337107, 39.68648854084313, 41.553489342331886, 42.379975877702236, 41.88459433615208, 34.41075711448987, 34.90140401696165, 34.75030447294314, 39.3332738118867, 39.349408509830624, 39.3107413376371, 50.74075148502986, 51.78863964105646, 51.98079649653907, 32.63200473909576, 32.51114825656016, 32.67057596643765, 36.00132408117254, 35.61218526711066, 35.34381233652432, 45.812669853369385, 46.346094655493886, 46.31316357354322, 28.62366819381714, 28.665057957172394, 28.87931240350008, 15.980027750134468, 16.402876660227776, 16.310444720089436, 37.34605898956457, 37.62928014496961, 37.18464052180448, 60.67833450188239, 60.270752017696694, 60.22351362307866, 30.6749175041914, 30.986491210758686, 31.070374317467213, 40.6236437090362, 40.64147475051382, 39.70852969090143, 37.868603392193705, 37.99885052132109, 37.619348930815846, 49.04082488765319, 49.165471759935215, 49.35228175049026, 44.72489020476738, 44.76961115996042, 44.6977142865459, 34.837198346853256, 35.49548267945647, 34.436316058039665, 39.04657348369558, 39.05098171283801, 39.033587382485464, 35.75695137594205, 35.297794600327805, 35.64897841525574, 32.66226846600571, 32.14949661741653, 32.46377859140435, 40.34204332406321, 40.32760717223087, 40.18533922980228, 36.297243925432355, 36.71950677285591, 36.54202388475338, 40.98944609236787, 40.88040708936751, 40.212585389614105, 39.52880023854473, 39.566464425219834, 39.56780725034574, 28.958140696088464, 29.303599568704755, 29.06007760266462, 45.63812272747357, 45.830341951300696, 45.72933705647786, 28.832025638471038, 29.054000162209064, 28.701555746297032, 46.78973915427922, 46.97051391378044, 46.81847991794346, 37.17656128605206, 37.10023932655652, 37.37688899536927, 41.3320845713218, 41.27427953978379, 41.78711674859126, 42.88503805051246, 43.31835896874932, 43.247873353461415, 27.14551045869787, 27.249951300521687, 26.776098807652787, 24.107133155067757, 24.322991674145058, 24.84650650558372, 49.684662876029805, 50.16216707074393, 50.194674693125606, 49.14503729343413, 49.74963900074361, 49.62159620970486, 36.77068682387471, 36.967866220511496, 36.62075340747833, 43.96832962877427, 43.99757904706833, 43.33542043467362, 44.71647036075592, 45.15629734424874, 45.042336050421, 39.01406434675057, 39.27786221106847, 39.4904122975034, 40.99821514387925, 41.50939256822069, 41.50698370238145, 26.72260022908449, 26.63150730729103, 26.34674708545208, 27.908330669005707, 27.616749738653496, 27.836007361610726, 34.20911265537143, 33.475976809859276, 34.27863817662001, 40.482916732629135, 41.42307845254739, 41.70132004966338, 40.40881422658761, 40.68980277826388, 41.04229935755332, 40.13814528783162, 40.66990492244561, 40.801215929289654, 45.4557997037967, 44.831878696878746, 45.044388627012566, 41.24385657906532, 41.64110466092825, 41.14412884414196, 27.404990439613655, 26.37974040706952, 27.491089535256222, 40.385214015841484, 40.35962447524071, 40.74057227000594, 49.974812285664186, 49.615933748583004, 49.89939841690163, 27.178733961035803, 27.212054447581366, 27.081403282781437, 32.13867776965101, 32.20814698313673, 31.691736569007233, 33.442702412605286, 33.632556207478046, 33.71460885554552, 50.212835070366665, 49.97874512026708, 49.17663837472598, 52.67057837049167, 52.497625845174, 52.66223955030243, 44.88999914874633, 45.07055152704318, 45.147218616058424, 52.47374079376458, 52.84169393777846, 52.36711020767687, 23.800225131213665, 23.68370158970356, 24.182143289595842, 41.55122410257657, 41.800668628265456, 42.00432591561305, 47.10454592108725, 47.13085630536078, 47.580964803695665, 39.46698671579361, 40.84033029526472, 39.55040282011032, 47.700277045369134, 47.80933633446692, 48.44956237589939, 54.07044276595114, 54.47621090337633, 54.203435778617845, 47.12883026152848, 47.014222916215644, 46.388528466224656, 34.66500231872001, 34.0326666633288, 34.75178421350816, 44.96605738461949, 44.94873427832499, 44.91682194918394, 28.73571325202161, 27.456419895092637, 28.241693953673035, 31.92178340752919, 31.66394895066817, 30.748779495557145, 29.005625903606415, 29.36517572402954, 29.107357546687126, 35.49861018359661, 35.72712753713131, 35.91690710559487, 37.62106045087178, 38.34477051099141, 38.63830377285679, 43.58872420589128, 43.39347358296314, 43.637772500204534, 38.79590336481729, 39.18572604904571, 39.338107521335274, 41.79651366764058, 41.317127381761864, 40.262997557719544, 37.151180674632386, 37.326471378405884, 37.23241614301999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.142229235871127, "mean_inference_ms": 0.7013439152944265, "mean_action_processing_ms": 0.09653260265619396, "mean_env_wait_ms": 0.7896968506290759, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 865000, "timesteps_this_iter": 0, "agent_timesteps_total": 2595000, "timers": {"sample_time_ms": 10546.431, "sample_throughput": 474.094, "load_time_ms": 0.1, "load_throughput": 49991704.41, "learn_time_ms": 1961.366, "learn_throughput": 2549.243, "update_time_ms": 9.107}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.228591661804379e-43, "cur_lr": 0.0005000000000000001, "total_loss": 6.182181549072266, "policy_loss": -0.000625878502706545, "vf_loss": 6.286233949661255, "vf_explained_var": 0.031988883018493654, "kl": 0.0027928673313482866, "entropy": 10.342652225494385, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 865000, "num_agent_steps_sampled": 2595000, "num_steps_trained": 865000, "num_agent_steps_trained": 2595000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2406, "training_iteration": 173, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-32-36", "timestamp": 1706232756, "time_this_iter_s": 10.54180121421814, "time_total_s": 1869.2978730201721, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402517310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1869.2978730201721, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 5.840000000000001, "ram_util_percent": 62.69333333333332}}
{"episode_reward_max": 181.1726001426578, "episode_reward_min": -192.38582016900182, "episode_reward_mean": 114.16121833235053, "episode_len_mean": 499.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -64.33024637401104}, "policy_reward_max": {"shared_policy": 60.67833450188239}, "policy_reward_mean": {"shared_policy": 38.05373944411684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [138.29241822659972, 129.19237302988785, -192.38582016900182, 129.53281736071216, 99.46443556994197, 117.50451138895005, 122.35489232838152, 117.1782021448016, 83.79244908178224, 86.06821119412777, 151.46064167562858, 89.8940650075674, 73.27576611563562, 117.76318308152258, 125.8180595561862, 104.06246560439466, 117.99342365935442, 154.51018762262538, 97.81372896209358, 106.95732168480752, 138.47192808240618, 86.16803855448961, 48.69334913045168, 112.15997965633866, 181.1726001426578, 92.7317830324173, 120.97364815045145, 113.48680284433064, 147.55857839807857, 134.19221565127387, 104.7689970843494, 117.13114257901906, 106.7037243915256, 97.2755436748266, 120.85498972609636, 109.55877458304164, 122.08243857134948, 118.6630719141103, 87.32181786745784, 137.19780173525191, 86.58758154697713, 140.5787329860029, 111.65368960797785, 124.39348085969685, 129.45127037272312, 81.17156056687234, 73.27663133479653, 150.04150463989947, 148.51627250388248, 110.35930645186454, 131.3013291105163, 134.91510375542572, 117.78233885532244, 124.01459141448139, 79.7008546218276, 83.36108776926993, 101.96372764185071, 123.6073152348399, 122.14091636240481, 121.60926613956688, 135.3320670276879, 124.02909008413553, 81.2758203819394, 121.48541076108813, 149.49014445114864, 81.4721916913986, 96.03856132179497, 100.78986747562885, 149.36821856535963, 157.83044376596834, 135.1077692918479, 157.68254493921987, 71.66607001051307, 125.35621864645508, 141.81636703014408, 119.85771983116865, 143.9591757557353, 162.75008944794527, 140.5315816439686, 103.44945319555697, 134.83161361212836, 84.43382710078728, 94.3345118537545, 87.47815917432308, 107.1426448263228, 114.60413473471998, 130.61997028905893, 117.31973693519828, 123.37663860712199, 111.71006819605826, 130.5558179803192, 143.51088436692947, 123.17823532968758, 117.12377241626382, 112.88997936295343, 110.35572691261767, 122.20521162077782, 133.41438711062048, 125.7779339402914, 127.83265287429093], "episode_lengths": [500, 500, 480, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [46.041205311814934, 46.10006596023837, 46.15114695454636, 42.811613028248146, 43.2681317453583, 43.11262825628121, -63.921787310391665, -64.13378648459911, -64.33024637401104, 43.29683978056224, 43.171241516868264, 43.064736063281686, 32.831928888956696, 33.26498420039812, 33.367522480587155, 38.90904816240072, 39.23465557768941, 39.36080764885992, 40.084171538551644, 41.21920880054434, 41.051511989285544, 38.833733965953186, 38.84925814469655, 39.49521003415187, 28.13921388223146, 27.69489548852046, 27.95833971103032, 28.667339401940495, 28.812820127854735, 28.58805166433254, 50.73414165123056, 50.28509424130122, 50.441405783096954, 29.917693227529526, 30.026403233408928, 29.949968546628952, 24.744380881388977, 24.970583767940596, 23.560801466306046, 38.79177285730839, 39.28492168337107, 39.68648854084313, 41.553489342331886, 42.379975877702236, 41.88459433615208, 34.41075711448987, 34.90140401696165, 34.75030447294314, 39.3332738118867, 39.349408509830624, 39.3107413376371, 50.74075148502986, 51.78863964105646, 51.98079649653907, 32.63200473909576, 32.51114825656016, 32.67057596643765, 36.00132408117254, 35.61218526711066, 35.34381233652432, 45.812669853369385, 46.346094655493886, 46.31316357354322, 28.62366819381714, 28.665057957172394, 28.87931240350008, 15.980027750134468, 16.402876660227776, 16.310444720089436, 37.34605898956457, 37.62928014496961, 37.18464052180448, 60.67833450188239, 60.270752017696694, 60.22351362307866, 30.6749175041914, 30.986491210758686, 31.070374317467213, 40.6236437090362, 40.64147475051382, 39.70852969090143, 37.868603392193705, 37.99885052132109, 37.619348930815846, 49.04082488765319, 49.165471759935215, 49.35228175049026, 44.72489020476738, 44.76961115996042, 44.6977142865459, 34.837198346853256, 35.49548267945647, 34.436316058039665, 39.04657348369558, 39.05098171283801, 39.033587382485464, 35.75695137594205, 35.297794600327805, 35.64897841525574, 32.66226846600571, 32.14949661741653, 32.46377859140435, 40.34204332406321, 40.32760717223087, 40.18533922980228, 36.297243925432355, 36.71950677285591, 36.54202388475338, 40.98944609236787, 40.88040708936751, 40.212585389614105, 39.52880023854473, 39.566464425219834, 39.56780725034574, 28.958140696088464, 29.303599568704755, 29.06007760266462, 45.63812272747357, 45.830341951300696, 45.72933705647786, 28.832025638471038, 29.054000162209064, 28.701555746297032, 46.78973915427922, 46.97051391378044, 46.81847991794346, 37.17656128605206, 37.10023932655652, 37.37688899536927, 41.3320845713218, 41.27427953978379, 41.78711674859126, 42.88503805051246, 43.31835896874932, 43.247873353461415, 27.14551045869787, 27.249951300521687, 26.776098807652787, 24.107133155067757, 24.322991674145058, 24.84650650558372, 49.684662876029805, 50.16216707074393, 50.194674693125606, 49.14503729343413, 49.74963900074361, 49.62159620970486, 36.77068682387471, 36.967866220511496, 36.62075340747833, 43.96832962877427, 43.99757904706833, 43.33542043467362, 44.71647036075592, 45.15629734424874, 45.042336050421, 39.01406434675057, 39.27786221106847, 39.4904122975034, 40.99821514387925, 41.50939256822069, 41.50698370238145, 26.72260022908449, 26.63150730729103, 26.34674708545208, 27.908330669005707, 27.616749738653496, 27.836007361610726, 34.20911265537143, 33.475976809859276, 34.27863817662001, 40.482916732629135, 41.42307845254739, 41.70132004966338, 40.40881422658761, 40.68980277826388, 41.04229935755332, 40.13814528783162, 40.66990492244561, 40.801215929289654, 45.4557997037967, 44.831878696878746, 45.044388627012566, 41.24385657906532, 41.64110466092825, 41.14412884414196, 27.404990439613655, 26.37974040706952, 27.491089535256222, 40.385214015841484, 40.35962447524071, 40.74057227000594, 49.974812285664186, 49.615933748583004, 49.89939841690163, 27.178733961035803, 27.212054447581366, 27.081403282781437, 32.13867776965101, 32.20814698313673, 31.691736569007233, 33.442702412605286, 33.632556207478046, 33.71460885554552, 50.212835070366665, 49.97874512026708, 49.17663837472598, 52.67057837049167, 52.497625845174, 52.66223955030243, 44.88999914874633, 45.07055152704318, 45.147218616058424, 52.47374079376458, 52.84169393777846, 52.36711020767687, 23.800225131213665, 23.68370158970356, 24.182143289595842, 41.55122410257657, 41.800668628265456, 42.00432591561305, 47.10454592108725, 47.13085630536078, 47.580964803695665, 39.46698671579361, 40.84033029526472, 39.55040282011032, 47.700277045369134, 47.80933633446692, 48.44956237589939, 54.07044276595114, 54.47621090337633, 54.203435778617845, 47.12883026152848, 47.014222916215644, 46.388528466224656, 34.66500231872001, 34.0326666633288, 34.75178421350816, 44.96605738461949, 44.94873427832499, 44.91682194918394, 28.73571325202161, 27.456419895092637, 28.241693953673035, 31.92178340752919, 31.66394895066817, 30.748779495557145, 29.005625903606415, 29.36517572402954, 29.107357546687126, 35.49861018359661, 35.72712753713131, 35.91690710559487, 37.62106045087178, 38.34477051099141, 38.63830377285679, 43.58872420589128, 43.39347358296314, 43.637772500204534, 38.79590336481729, 39.18572604904571, 39.338107521335274, 41.79651366764058, 41.317127381761864, 40.262997557719544, 37.151180674632386, 37.326471378405884, 37.23241614301999, 43.489845293263585, 43.17926050225893, 43.88671218479672, 47.6252098828554, 48.094371452927575, 47.79130303114651, 41.25118117158611, 40.733668630321816, 41.193385527779654, 38.885737504810095, 39.116807110607624, 39.1212278008461, 37.85227638591701, 37.76554632621506, 37.27215665082136, 36.671864335735634, 37.1233868052562, 36.56047577162583, 40.20258624354997, 40.96803622568646, 41.03458915154138, 44.344934940338135, 44.43310369551182, 44.636348474770784, 41.903934828937054, 42.173523508012295, 41.700475603342056, 41.42730714877446, 43.206292671461895, 43.19905305405457]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1421949946535617, "mean_inference_ms": 0.7012986742764263, "mean_action_processing_ms": 0.09652864288328938, "mean_env_wait_ms": 0.7895149016304012, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 870000, "timesteps_this_iter": 0, "agent_timesteps_total": 2610000, "timers": {"sample_time_ms": 10457.836, "sample_throughput": 478.11, "load_time_ms": 0.1, "load_throughput": 49991704.41, "learn_time_ms": 1944.742, "learn_throughput": 2571.035, "update_time_ms": 9.375}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6142958309021895e-43, "cur_lr": 0.0005000000000000001, "total_loss": 7.90680832862854, "policy_loss": 0.0007854443148834101, "vf_loss": 8.01099910736084, "vf_explained_var": 0.025701117515563966, "kl": 0.007634182367523512, "entropy": 10.497583866119385, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 870000, "num_agent_steps_sampled": 2610000, "num_steps_trained": 870000, "num_agent_steps_trained": 2610000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2416, "training_iteration": 174, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-32-46", "timestamp": 1706232766, "time_this_iter_s": 10.402420043945312, "time_total_s": 1879.7002930641174, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402DE5820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1879.7002930641174, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 7.9, "ram_util_percent": 62.68666666666669}}
{"episode_reward_max": 181.1726001426578, "episode_reward_min": 48.69334913045168, "episode_reward_mean": 118.33761477306467, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 15.980027750134468}, "policy_reward_max": {"shared_policy": 60.67833450188239}, "policy_reward_mean": {"shared_policy": 39.44587159102156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [151.46064167562858, 89.8940650075674, 73.27576611563562, 117.76318308152258, 125.8180595561862, 104.06246560439466, 117.99342365935442, 154.51018762262538, 97.81372896209358, 106.95732168480752, 138.47192808240618, 86.16803855448961, 48.69334913045168, 112.15997965633866, 181.1726001426578, 92.7317830324173, 120.97364815045145, 113.48680284433064, 147.55857839807857, 134.19221565127387, 104.7689970843494, 117.13114257901906, 106.7037243915256, 97.2755436748266, 120.85498972609636, 109.55877458304164, 122.08243857134948, 118.6630719141103, 87.32181786745784, 137.19780173525191, 86.58758154697713, 140.5787329860029, 111.65368960797785, 124.39348085969685, 129.45127037272312, 81.17156056687234, 73.27663133479653, 150.04150463989947, 148.51627250388248, 110.35930645186454, 131.3013291105163, 134.91510375542572, 117.78233885532244, 124.01459141448139, 79.7008546218276, 83.36108776926993, 101.96372764185071, 123.6073152348399, 122.14091636240481, 121.60926613956688, 135.3320670276879, 124.02909008413553, 81.2758203819394, 121.48541076108813, 149.49014445114864, 81.4721916913986, 96.03856132179497, 100.78986747562885, 149.36821856535963, 157.83044376596834, 135.1077692918479, 157.68254493921987, 71.66607001051307, 125.35621864645508, 141.81636703014408, 119.85771983116865, 143.9591757557353, 162.75008944794527, 140.5315816439686, 103.44945319555697, 134.83161361212836, 84.43382710078728, 94.3345118537545, 87.47815917432308, 107.1426448263228, 114.60413473471998, 130.61997028905893, 117.31973693519828, 123.37663860712199, 111.71006819605826, 130.5558179803192, 143.51088436692947, 123.17823532968758, 117.12377241626382, 112.88997936295343, 110.35572691261767, 122.20521162077782, 133.41438711062048, 125.7779339402914, 127.83265287429093, 63.7600343301892, 130.59043564088643, 177.14064905606216, 117.94993558526036, 115.8164441138506, 138.3880854882299, 128.25192284025252, 133.16929940153196, 126.53568694368002, 117.03164082765576], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [50.73414165123056, 50.28509424130122, 50.441405783096954, 29.917693227529526, 30.026403233408928, 29.949968546628952, 24.744380881388977, 24.970583767940596, 23.560801466306046, 38.79177285730839, 39.28492168337107, 39.68648854084313, 41.553489342331886, 42.379975877702236, 41.88459433615208, 34.41075711448987, 34.90140401696165, 34.75030447294314, 39.3332738118867, 39.349408509830624, 39.3107413376371, 50.74075148502986, 51.78863964105646, 51.98079649653907, 32.63200473909576, 32.51114825656016, 32.67057596643765, 36.00132408117254, 35.61218526711066, 35.34381233652432, 45.812669853369385, 46.346094655493886, 46.31316357354322, 28.62366819381714, 28.665057957172394, 28.87931240350008, 15.980027750134468, 16.402876660227776, 16.310444720089436, 37.34605898956457, 37.62928014496961, 37.18464052180448, 60.67833450188239, 60.270752017696694, 60.22351362307866, 30.6749175041914, 30.986491210758686, 31.070374317467213, 40.6236437090362, 40.64147475051382, 39.70852969090143, 37.868603392193705, 37.99885052132109, 37.619348930815846, 49.04082488765319, 49.165471759935215, 49.35228175049026, 44.72489020476738, 44.76961115996042, 44.6977142865459, 34.837198346853256, 35.49548267945647, 34.436316058039665, 39.04657348369558, 39.05098171283801, 39.033587382485464, 35.75695137594205, 35.297794600327805, 35.64897841525574, 32.66226846600571, 32.14949661741653, 32.46377859140435, 40.34204332406321, 40.32760717223087, 40.18533922980228, 36.297243925432355, 36.71950677285591, 36.54202388475338, 40.98944609236787, 40.88040708936751, 40.212585389614105, 39.52880023854473, 39.566464425219834, 39.56780725034574, 28.958140696088464, 29.303599568704755, 29.06007760266462, 45.63812272747357, 45.830341951300696, 45.72933705647786, 28.832025638471038, 29.054000162209064, 28.701555746297032, 46.78973915427922, 46.97051391378044, 46.81847991794346, 37.17656128605206, 37.10023932655652, 37.37688899536927, 41.3320845713218, 41.27427953978379, 41.78711674859126, 42.88503805051246, 43.31835896874932, 43.247873353461415, 27.14551045869787, 27.249951300521687, 26.776098807652787, 24.107133155067757, 24.322991674145058, 24.84650650558372, 49.684662876029805, 50.16216707074393, 50.194674693125606, 49.14503729343413, 49.74963900074361, 49.62159620970486, 36.77068682387471, 36.967866220511496, 36.62075340747833, 43.96832962877427, 43.99757904706833, 43.33542043467362, 44.71647036075592, 45.15629734424874, 45.042336050421, 39.01406434675057, 39.27786221106847, 39.4904122975034, 40.99821514387925, 41.50939256822069, 41.50698370238145, 26.72260022908449, 26.63150730729103, 26.34674708545208, 27.908330669005707, 27.616749738653496, 27.836007361610726, 34.20911265537143, 33.475976809859276, 34.27863817662001, 40.482916732629135, 41.42307845254739, 41.70132004966338, 40.40881422658761, 40.68980277826388, 41.04229935755332, 40.13814528783162, 40.66990492244561, 40.801215929289654, 45.4557997037967, 44.831878696878746, 45.044388627012566, 41.24385657906532, 41.64110466092825, 41.14412884414196, 27.404990439613655, 26.37974040706952, 27.491089535256222, 40.385214015841484, 40.35962447524071, 40.74057227000594, 49.974812285664186, 49.615933748583004, 49.89939841690163, 27.178733961035803, 27.212054447581366, 27.081403282781437, 32.13867776965101, 32.20814698313673, 31.691736569007233, 33.442702412605286, 33.632556207478046, 33.71460885554552, 50.212835070366665, 49.97874512026708, 49.17663837472598, 52.67057837049167, 52.497625845174, 52.66223955030243, 44.88999914874633, 45.07055152704318, 45.147218616058424, 52.47374079376458, 52.84169393777846, 52.36711020767687, 23.800225131213665, 23.68370158970356, 24.182143289595842, 41.55122410257657, 41.800668628265456, 42.00432591561305, 47.10454592108725, 47.13085630536078, 47.580964803695665, 39.46698671579361, 40.84033029526472, 39.55040282011032, 47.700277045369134, 47.80933633446692, 48.44956237589939, 54.07044276595114, 54.47621090337633, 54.203435778617845, 47.12883026152848, 47.014222916215644, 46.388528466224656, 34.66500231872001, 34.0326666633288, 34.75178421350816, 44.96605738461949, 44.94873427832499, 44.91682194918394, 28.73571325202161, 27.456419895092637, 28.241693953673035, 31.92178340752919, 31.66394895066817, 30.748779495557145, 29.005625903606415, 29.36517572402954, 29.107357546687126, 35.49861018359661, 35.72712753713131, 35.91690710559487, 37.62106045087178, 38.34477051099141, 38.63830377285679, 43.58872420589128, 43.39347358296314, 43.637772500204534, 38.79590336481729, 39.18572604904571, 39.338107521335274, 41.79651366764058, 41.317127381761864, 40.262997557719544, 37.151180674632386, 37.326471378405884, 37.23241614301999, 43.489845293263585, 43.17926050225893, 43.88671218479672, 47.6252098828554, 48.094371452927575, 47.79130303114651, 41.25118117158611, 40.733668630321816, 41.193385527779654, 38.885737504810095, 39.116807110607624, 39.1212278008461, 37.85227638591701, 37.76554632621506, 37.27215665082136, 36.671864335735634, 37.1233868052562, 36.56047577162583, 40.20258624354997, 40.96803622568646, 41.03458915154138, 44.344934940338135, 44.43310369551182, 44.636348474770784, 41.903934828937054, 42.173523508012295, 41.700475603342056, 41.42730714877446, 43.206292671461895, 43.19905305405457, 21.148416871825845, 21.218298772970826, 21.39331868539253, 43.206883927186325, 43.623752293487385, 43.7597994202127, 59.16682641704877, 58.76439057042201, 59.20943206859131, 39.44927437106767, 39.24358462790647, 39.25707658628622, 38.45464149862528, 38.54397876560688, 38.817823849618435, 46.184361916035414, 46.21342681720853, 45.99029675498605, 42.32637619972229, 42.78909756243229, 43.13644907809794, 44.49206496650973, 44.00794730583826, 44.66928712918403, 42.67102726424733, 42.334939452509076, 41.529720226923615, 39.113322163621575, 39.2440338085095, 38.67428485552469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1421640317189624, "mean_inference_ms": 0.7012544031382187, "mean_action_processing_ms": 0.09652959226587007, "mean_env_wait_ms": 0.7893227257566927, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 875000, "timesteps_this_iter": 0, "agent_timesteps_total": 2625000, "timers": {"sample_time_ms": 10437.923, "sample_throughput": 479.023, "load_time_ms": 0.1, "load_throughput": 49991704.41, "learn_time_ms": 1932.585, "learn_throughput": 2587.208, "update_time_ms": 9.375}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6142958309021895e-43, "cur_lr": 0.0005000000000000001, "total_loss": 7.324699211120605, "policy_loss": -0.00019477301251225043, "vf_loss": 7.429033613204956, "vf_explained_var": 0.01798674464225769, "kl": 0.0028417905327438866, "entropy": 10.413947486877442, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 875000, "num_agent_steps_sampled": 2625000, "num_steps_trained": 875000, "num_agent_steps_trained": 2625000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2426, "training_iteration": 175, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-32-57", "timestamp": 1706232777, "time_this_iter_s": 10.331439733505249, "time_total_s": 1890.0317327976227, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214023C89D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1890.0317327976227, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 7.95, "ram_util_percent": 62.62857142857143}}
{"episode_reward_max": 181.1726001426578, "episode_reward_min": 48.69334913045168, "episode_reward_mean": 120.05206699810904, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 15.980027750134468}, "policy_reward_max": {"shared_policy": 60.67833450188239}, "policy_reward_mean": {"shared_policy": 40.01735566603636}, "custom_metrics": {}, "hist_stats": {"episode_reward": [138.47192808240618, 86.16803855448961, 48.69334913045168, 112.15997965633866, 181.1726001426578, 92.7317830324173, 120.97364815045145, 113.48680284433064, 147.55857839807857, 134.19221565127387, 104.7689970843494, 117.13114257901906, 106.7037243915256, 97.2755436748266, 120.85498972609636, 109.55877458304164, 122.08243857134948, 118.6630719141103, 87.32181786745784, 137.19780173525191, 86.58758154697713, 140.5787329860029, 111.65368960797785, 124.39348085969685, 129.45127037272312, 81.17156056687234, 73.27663133479653, 150.04150463989947, 148.51627250388248, 110.35930645186454, 131.3013291105163, 134.91510375542572, 117.78233885532244, 124.01459141448139, 79.7008546218276, 83.36108776926993, 101.96372764185071, 123.6073152348399, 122.14091636240481, 121.60926613956688, 135.3320670276879, 124.02909008413553, 81.2758203819394, 121.48541076108813, 149.49014445114864, 81.4721916913986, 96.03856132179497, 100.78986747562885, 149.36821856535963, 157.83044376596834, 135.1077692918479, 157.68254493921987, 71.66607001051307, 125.35621864645508, 141.81636703014408, 119.85771983116865, 143.9591757557353, 162.75008944794527, 140.5315816439686, 103.44945319555697, 134.83161361212836, 84.43382710078728, 94.3345118537545, 87.47815917432308, 107.1426448263228, 114.60413473471998, 130.61997028905893, 117.31973693519828, 123.37663860712199, 111.71006819605826, 130.5558179803192, 143.51088436692947, 123.17823532968758, 117.12377241626382, 112.88997936295343, 110.35572691261767, 122.20521162077782, 133.41438711062048, 125.7779339402914, 127.83265287429093, 63.7600343301892, 130.59043564088643, 177.14064905606216, 117.94993558526036, 115.8164441138506, 138.3880854882299, 128.25192284025252, 133.16929940153196, 126.53568694368002, 117.03164082765576, 113.50473319366571, 132.11534128710656, 146.401625053957, 138.00520781893283, 85.36352886632085, 150.96837258525184, 121.22144376114008, 142.44295906648043, 127.58283773669969, 153.38801610469827], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [45.812669853369385, 46.346094655493886, 46.31316357354322, 28.62366819381714, 28.665057957172394, 28.87931240350008, 15.980027750134468, 16.402876660227776, 16.310444720089436, 37.34605898956457, 37.62928014496961, 37.18464052180448, 60.67833450188239, 60.270752017696694, 60.22351362307866, 30.6749175041914, 30.986491210758686, 31.070374317467213, 40.6236437090362, 40.64147475051382, 39.70852969090143, 37.868603392193705, 37.99885052132109, 37.619348930815846, 49.04082488765319, 49.165471759935215, 49.35228175049026, 44.72489020476738, 44.76961115996042, 44.6977142865459, 34.837198346853256, 35.49548267945647, 34.436316058039665, 39.04657348369558, 39.05098171283801, 39.033587382485464, 35.75695137594205, 35.297794600327805, 35.64897841525574, 32.66226846600571, 32.14949661741653, 32.46377859140435, 40.34204332406321, 40.32760717223087, 40.18533922980228, 36.297243925432355, 36.71950677285591, 36.54202388475338, 40.98944609236787, 40.88040708936751, 40.212585389614105, 39.52880023854473, 39.566464425219834, 39.56780725034574, 28.958140696088464, 29.303599568704755, 29.06007760266462, 45.63812272747357, 45.830341951300696, 45.72933705647786, 28.832025638471038, 29.054000162209064, 28.701555746297032, 46.78973915427922, 46.97051391378044, 46.81847991794346, 37.17656128605206, 37.10023932655652, 37.37688899536927, 41.3320845713218, 41.27427953978379, 41.78711674859126, 42.88503805051246, 43.31835896874932, 43.247873353461415, 27.14551045869787, 27.249951300521687, 26.776098807652787, 24.107133155067757, 24.322991674145058, 24.84650650558372, 49.684662876029805, 50.16216707074393, 50.194674693125606, 49.14503729343413, 49.74963900074361, 49.62159620970486, 36.77068682387471, 36.967866220511496, 36.62075340747833, 43.96832962877427, 43.99757904706833, 43.33542043467362, 44.71647036075592, 45.15629734424874, 45.042336050421, 39.01406434675057, 39.27786221106847, 39.4904122975034, 40.99821514387925, 41.50939256822069, 41.50698370238145, 26.72260022908449, 26.63150730729103, 26.34674708545208, 27.908330669005707, 27.616749738653496, 27.836007361610726, 34.20911265537143, 33.475976809859276, 34.27863817662001, 40.482916732629135, 41.42307845254739, 41.70132004966338, 40.40881422658761, 40.68980277826388, 41.04229935755332, 40.13814528783162, 40.66990492244561, 40.801215929289654, 45.4557997037967, 44.831878696878746, 45.044388627012566, 41.24385657906532, 41.64110466092825, 41.14412884414196, 27.404990439613655, 26.37974040706952, 27.491089535256222, 40.385214015841484, 40.35962447524071, 40.74057227000594, 49.974812285664186, 49.615933748583004, 49.89939841690163, 27.178733961035803, 27.212054447581366, 27.081403282781437, 32.13867776965101, 32.20814698313673, 31.691736569007233, 33.442702412605286, 33.632556207478046, 33.71460885554552, 50.212835070366665, 49.97874512026708, 49.17663837472598, 52.67057837049167, 52.497625845174, 52.66223955030243, 44.88999914874633, 45.07055152704318, 45.147218616058424, 52.47374079376458, 52.84169393777846, 52.36711020767687, 23.800225131213665, 23.68370158970356, 24.182143289595842, 41.55122410257657, 41.800668628265456, 42.00432591561305, 47.10454592108725, 47.13085630536078, 47.580964803695665, 39.46698671579361, 40.84033029526472, 39.55040282011032, 47.700277045369134, 47.80933633446692, 48.44956237589939, 54.07044276595114, 54.47621090337633, 54.203435778617845, 47.12883026152848, 47.014222916215644, 46.388528466224656, 34.66500231872001, 34.0326666633288, 34.75178421350816, 44.96605738461949, 44.94873427832499, 44.91682194918394, 28.73571325202161, 27.456419895092637, 28.241693953673035, 31.92178340752919, 31.66394895066817, 30.748779495557145, 29.005625903606415, 29.36517572402954, 29.107357546687126, 35.49861018359661, 35.72712753713131, 35.91690710559487, 37.62106045087178, 38.34477051099141, 38.63830377285679, 43.58872420589128, 43.39347358296314, 43.637772500204534, 38.79590336481729, 39.18572604904571, 39.338107521335274, 41.79651366764058, 41.317127381761864, 40.262997557719544, 37.151180674632386, 37.326471378405884, 37.23241614301999, 43.489845293263585, 43.17926050225893, 43.88671218479672, 47.6252098828554, 48.094371452927575, 47.79130303114651, 41.25118117158611, 40.733668630321816, 41.193385527779654, 38.885737504810095, 39.116807110607624, 39.1212278008461, 37.85227638591701, 37.76554632621506, 37.27215665082136, 36.671864335735634, 37.1233868052562, 36.56047577162583, 40.20258624354997, 40.96803622568646, 41.03458915154138, 44.344934940338135, 44.43310369551182, 44.636348474770784, 41.903934828937054, 42.173523508012295, 41.700475603342056, 41.42730714877446, 43.206292671461895, 43.19905305405457, 21.148416871825845, 21.218298772970826, 21.39331868539253, 43.206883927186325, 43.623752293487385, 43.7597994202127, 59.16682641704877, 58.76439057042201, 59.20943206859131, 39.44927437106767, 39.24358462790647, 39.25707658628622, 38.45464149862528, 38.54397876560688, 38.817823849618435, 46.184361916035414, 46.21342681720853, 45.99029675498605, 42.32637619972229, 42.78909756243229, 43.13644907809794, 44.49206496650973, 44.00794730583826, 44.66928712918403, 42.67102726424733, 42.334939452509076, 41.529720226923615, 39.113322163621575, 39.2440338085095, 38.67428485552469, 37.71131039659181, 38.108372940371424, 37.68504985670248, 44.10076501220465, 43.72208847105503, 44.2924878038466, 48.68967526654403, 49.071876425916955, 48.640073361496135, 46.18286426955213, 45.66052758445342, 46.16181596492727, 28.47304556146264, 28.354799054563046, 28.535684250295162, 49.80246417721112, 50.54616934185226, 50.61973906618853, 40.15424684683481, 40.650276011476905, 40.416920902828366, 47.77152112498878, 47.317143648862825, 47.35429429262875, 42.95334541161233, 42.592564287285, 42.03692803780237, 51.21145715688665, 50.8660430808862, 51.310515866925314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14213617585990898, "mean_inference_ms": 0.7011903070844572, "mean_action_processing_ms": 0.09653033541238475, "mean_env_wait_ms": 0.7891310259076407, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 880000, "timesteps_this_iter": 0, "agent_timesteps_total": 2640000, "timers": {"sample_time_ms": 10408.608, "sample_throughput": 480.372, "load_time_ms": 0.1, "load_throughput": 49991704.41, "learn_time_ms": 1921.802, "learn_throughput": 2601.725, "update_time_ms": 9.282}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.071479154510948e-44, "cur_lr": 0.0005000000000000001, "total_loss": 6.733640813827515, "policy_loss": 0.00022780852028789767, "vf_loss": 6.838351535797119, "vf_explained_var": 0.00023804306983947753, "kl": 0.0034020466730487068, "entropy": 10.49385757446289, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 880000, "num_agent_steps_sampled": 2640000, "num_steps_trained": 880000, "num_agent_steps_trained": 2640000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2436, "training_iteration": 176, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-33-07", "timestamp": 1706232787, "time_this_iter_s": 10.176582098007202, "time_total_s": 1900.2083148956299, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401A2DAF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1900.2083148956299, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 7.086666666666665, "ram_util_percent": 62.67333333333335}}
{"episode_reward_max": 177.14064905606216, "episode_reward_min": 63.7600343301892, "episode_reward_mean": 121.43005721309724, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 21.148416871825845}, "policy_reward_max": {"shared_policy": 59.20943206859131}, "policy_reward_mean": {"shared_policy": 40.47668573769908}, "custom_metrics": {}, "hist_stats": {"episode_reward": [104.7689970843494, 117.13114257901906, 106.7037243915256, 97.2755436748266, 120.85498972609636, 109.55877458304164, 122.08243857134948, 118.6630719141103, 87.32181786745784, 137.19780173525191, 86.58758154697713, 140.5787329860029, 111.65368960797785, 124.39348085969685, 129.45127037272312, 81.17156056687234, 73.27663133479653, 150.04150463989947, 148.51627250388248, 110.35930645186454, 131.3013291105163, 134.91510375542572, 117.78233885532244, 124.01459141448139, 79.7008546218276, 83.36108776926993, 101.96372764185071, 123.6073152348399, 122.14091636240481, 121.60926613956688, 135.3320670276879, 124.02909008413553, 81.2758203819394, 121.48541076108813, 149.49014445114864, 81.4721916913986, 96.03856132179497, 100.78986747562885, 149.36821856535963, 157.83044376596834, 135.1077692918479, 157.68254493921987, 71.66607001051307, 125.35621864645508, 141.81636703014408, 119.85771983116865, 143.9591757557353, 162.75008944794527, 140.5315816439686, 103.44945319555697, 134.83161361212836, 84.43382710078728, 94.3345118537545, 87.47815917432308, 107.1426448263228, 114.60413473471998, 130.61997028905893, 117.31973693519828, 123.37663860712199, 111.71006819605826, 130.5558179803192, 143.51088436692947, 123.17823532968758, 117.12377241626382, 112.88997936295343, 110.35572691261767, 122.20521162077782, 133.41438711062048, 125.7779339402914, 127.83265287429093, 63.7600343301892, 130.59043564088643, 177.14064905606216, 117.94993558526036, 115.8164441138506, 138.3880854882299, 128.25192284025252, 133.16929940153196, 126.53568694368002, 117.03164082765576, 113.50473319366571, 132.11534128710656, 146.401625053957, 138.00520781893283, 85.36352886632085, 150.96837258525184, 121.22144376114008, 142.44295906648043, 127.58283773669969, 153.38801610469827, 148.73173022270203, 132.99025286175316, 126.59121947363019, 114.42232736002188, 112.84807807952164, 121.30397454154081, 139.4322611466049, 127.36527986824511, 146.32187515683458, 143.4009464308619], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [34.837198346853256, 35.49548267945647, 34.436316058039665, 39.04657348369558, 39.05098171283801, 39.033587382485464, 35.75695137594205, 35.297794600327805, 35.64897841525574, 32.66226846600571, 32.14949661741653, 32.46377859140435, 40.34204332406321, 40.32760717223087, 40.18533922980228, 36.297243925432355, 36.71950677285591, 36.54202388475338, 40.98944609236787, 40.88040708936751, 40.212585389614105, 39.52880023854473, 39.566464425219834, 39.56780725034574, 28.958140696088464, 29.303599568704755, 29.06007760266462, 45.63812272747357, 45.830341951300696, 45.72933705647786, 28.832025638471038, 29.054000162209064, 28.701555746297032, 46.78973915427922, 46.97051391378044, 46.81847991794346, 37.17656128605206, 37.10023932655652, 37.37688899536927, 41.3320845713218, 41.27427953978379, 41.78711674859126, 42.88503805051246, 43.31835896874932, 43.247873353461415, 27.14551045869787, 27.249951300521687, 26.776098807652787, 24.107133155067757, 24.322991674145058, 24.84650650558372, 49.684662876029805, 50.16216707074393, 50.194674693125606, 49.14503729343413, 49.74963900074361, 49.62159620970486, 36.77068682387471, 36.967866220511496, 36.62075340747833, 43.96832962877427, 43.99757904706833, 43.33542043467362, 44.71647036075592, 45.15629734424874, 45.042336050421, 39.01406434675057, 39.27786221106847, 39.4904122975034, 40.99821514387925, 41.50939256822069, 41.50698370238145, 26.72260022908449, 26.63150730729103, 26.34674708545208, 27.908330669005707, 27.616749738653496, 27.836007361610726, 34.20911265537143, 33.475976809859276, 34.27863817662001, 40.482916732629135, 41.42307845254739, 41.70132004966338, 40.40881422658761, 40.68980277826388, 41.04229935755332, 40.13814528783162, 40.66990492244561, 40.801215929289654, 45.4557997037967, 44.831878696878746, 45.044388627012566, 41.24385657906532, 41.64110466092825, 41.14412884414196, 27.404990439613655, 26.37974040706952, 27.491089535256222, 40.385214015841484, 40.35962447524071, 40.74057227000594, 49.974812285664186, 49.615933748583004, 49.89939841690163, 27.178733961035803, 27.212054447581366, 27.081403282781437, 32.13867776965101, 32.20814698313673, 31.691736569007233, 33.442702412605286, 33.632556207478046, 33.71460885554552, 50.212835070366665, 49.97874512026708, 49.17663837472598, 52.67057837049167, 52.497625845174, 52.66223955030243, 44.88999914874633, 45.07055152704318, 45.147218616058424, 52.47374079376458, 52.84169393777846, 52.36711020767687, 23.800225131213665, 23.68370158970356, 24.182143289595842, 41.55122410257657, 41.800668628265456, 42.00432591561305, 47.10454592108725, 47.13085630536078, 47.580964803695665, 39.46698671579361, 40.84033029526472, 39.55040282011032, 47.700277045369134, 47.80933633446692, 48.44956237589939, 54.07044276595114, 54.47621090337633, 54.203435778617845, 47.12883026152848, 47.014222916215644, 46.388528466224656, 34.66500231872001, 34.0326666633288, 34.75178421350816, 44.96605738461949, 44.94873427832499, 44.91682194918394, 28.73571325202161, 27.456419895092637, 28.241693953673035, 31.92178340752919, 31.66394895066817, 30.748779495557145, 29.005625903606415, 29.36517572402954, 29.107357546687126, 35.49861018359661, 35.72712753713131, 35.91690710559487, 37.62106045087178, 38.34477051099141, 38.63830377285679, 43.58872420589128, 43.39347358296314, 43.637772500204534, 38.79590336481729, 39.18572604904571, 39.338107521335274, 41.79651366764058, 41.317127381761864, 40.262997557719544, 37.151180674632386, 37.326471378405884, 37.23241614301999, 43.489845293263585, 43.17926050225893, 43.88671218479672, 47.6252098828554, 48.094371452927575, 47.79130303114651, 41.25118117158611, 40.733668630321816, 41.193385527779654, 38.885737504810095, 39.116807110607624, 39.1212278008461, 37.85227638591701, 37.76554632621506, 37.27215665082136, 36.671864335735634, 37.1233868052562, 36.56047577162583, 40.20258624354997, 40.96803622568646, 41.03458915154138, 44.344934940338135, 44.43310369551182, 44.636348474770784, 41.903934828937054, 42.173523508012295, 41.700475603342056, 41.42730714877446, 43.206292671461895, 43.19905305405457, 21.148416871825845, 21.218298772970826, 21.39331868539253, 43.206883927186325, 43.623752293487385, 43.7597994202127, 59.16682641704877, 58.76439057042201, 59.20943206859131, 39.44927437106767, 39.24358462790647, 39.25707658628622, 38.45464149862528, 38.54397876560688, 38.817823849618435, 46.184361916035414, 46.21342681720853, 45.99029675498605, 42.32637619972229, 42.78909756243229, 43.13644907809794, 44.49206496650973, 44.00794730583826, 44.66928712918403, 42.67102726424733, 42.334939452509076, 41.529720226923615, 39.113322163621575, 39.2440338085095, 38.67428485552469, 37.71131039659181, 38.108372940371424, 37.68504985670248, 44.10076501220465, 43.72208847105503, 44.2924878038466, 48.68967526654403, 49.071876425916955, 48.640073361496135, 46.18286426955213, 45.66052758445342, 46.16181596492727, 28.47304556146264, 28.354799054563046, 28.535684250295162, 49.80246417721112, 50.54616934185226, 50.61973906618853, 40.15424684683481, 40.650276011476905, 40.416920902828366, 47.77152112498878, 47.317143648862825, 47.35429429262875, 42.95334541161233, 42.592564287285, 42.03692803780237, 51.21145715688665, 50.8660430808862, 51.310515866925314, 49.75395769377549, 50.02094284196694, 48.95682968695958, 44.57168675400317, 44.15716240555048, 44.26140370219946, 42.36424272879958, 42.2522796690464, 41.974697075784206, 38.471429988741875, 38.70727664779406, 37.24362072348595, 37.55254257222016, 37.384976406892136, 37.910559100409344, 40.176588132977486, 40.60542513121254, 40.52196127735078, 46.778625053664044, 46.47954738636811, 46.174088706572846, 42.32033361991246, 42.29520623882611, 42.74974000950654, 48.74782203137873, 48.490315139293656, 49.08373798616229, 48.08718140671651, 47.971873576442405, 47.34189144770305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14211829203826126, "mean_inference_ms": 0.701137520868652, "mean_action_processing_ms": 0.0965324865108363, "mean_env_wait_ms": 0.7889453601512928, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 885000, "timesteps_this_iter": 0, "agent_timesteps_total": 2655000, "timers": {"sample_time_ms": 10419.974, "sample_throughput": 479.848, "load_time_ms": 0.1, "load_throughput": 49991704.41, "learn_time_ms": 1932.387, "learn_throughput": 2587.474, "update_time_ms": 9.293}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.035739577255474e-44, "cur_lr": 0.0005000000000000001, "total_loss": 7.190428829193115, "policy_loss": -0.0009629794391710078, "vf_loss": 7.295650577545166, "vf_explained_var": 0.09354345202445984, "kl": 0.0031255389564237832, "entropy": 10.425879764556885, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 885000, "num_agent_steps_sampled": 2655000, "num_steps_trained": 885000, "num_agent_steps_trained": 2655000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2446, "training_iteration": 177, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-33-18", "timestamp": 1706232798, "time_this_iter_s": 10.796683073043823, "time_total_s": 1911.0049979686737, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401AAADC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1911.0049979686737, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 7.62, "ram_util_percent": 62.786666666666655}}
{"episode_reward_max": 177.14064905606216, "episode_reward_min": 56.6865110620856, "episode_reward_mean": 121.62133239743599, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 18.8084072942535}, "policy_reward_max": {"shared_policy": 59.20943206859131}, "policy_reward_mean": {"shared_policy": 40.54044413247866}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.58758154697713, 140.5787329860029, 111.65368960797785, 124.39348085969685, 129.45127037272312, 81.17156056687234, 73.27663133479653, 150.04150463989947, 148.51627250388248, 110.35930645186454, 131.3013291105163, 134.91510375542572, 117.78233885532244, 124.01459141448139, 79.7008546218276, 83.36108776926993, 101.96372764185071, 123.6073152348399, 122.14091636240481, 121.60926613956688, 135.3320670276879, 124.02909008413553, 81.2758203819394, 121.48541076108813, 149.49014445114864, 81.4721916913986, 96.03856132179497, 100.78986747562885, 149.36821856535963, 157.83044376596834, 135.1077692918479, 157.68254493921987, 71.66607001051307, 125.35621864645508, 141.81636703014408, 119.85771983116865, 143.9591757557353, 162.75008944794527, 140.5315816439686, 103.44945319555697, 134.83161361212836, 84.43382710078728, 94.3345118537545, 87.47815917432308, 107.1426448263228, 114.60413473471998, 130.61997028905893, 117.31973693519828, 123.37663860712199, 111.71006819605826, 130.5558179803192, 143.51088436692947, 123.17823532968758, 117.12377241626382, 112.88997936295343, 110.35572691261767, 122.20521162077782, 133.41438711062048, 125.7779339402914, 127.83265287429093, 63.7600343301892, 130.59043564088643, 177.14064905606216, 117.94993558526036, 115.8164441138506, 138.3880854882299, 128.25192284025252, 133.16929940153196, 126.53568694368002, 117.03164082765576, 113.50473319366571, 132.11534128710656, 146.401625053957, 138.00520781893283, 85.36352886632085, 150.96837258525184, 121.22144376114008, 142.44295906648043, 127.58283773669969, 153.38801610469827, 148.73173022270203, 132.99025286175316, 126.59121947363019, 114.42232736002188, 112.84807807952164, 121.30397454154081, 139.4322611466049, 127.36527986824511, 146.32187515683458, 143.4009464308619, 91.01179200410843, 145.15377718210217, 113.59094110876322, 112.60303831472991, 160.3187047839167, 63.12572652846575, 150.8909553699195, 118.10484035499393, 129.19953385181722, 56.6865110620856], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [28.832025638471038, 29.054000162209064, 28.701555746297032, 46.78973915427922, 46.97051391378044, 46.81847991794346, 37.17656128605206, 37.10023932655652, 37.37688899536927, 41.3320845713218, 41.27427953978379, 41.78711674859126, 42.88503805051246, 43.31835896874932, 43.247873353461415, 27.14551045869787, 27.249951300521687, 26.776098807652787, 24.107133155067757, 24.322991674145058, 24.84650650558372, 49.684662876029805, 50.16216707074393, 50.194674693125606, 49.14503729343413, 49.74963900074361, 49.62159620970486, 36.77068682387471, 36.967866220511496, 36.62075340747833, 43.96832962877427, 43.99757904706833, 43.33542043467362, 44.71647036075592, 45.15629734424874, 45.042336050421, 39.01406434675057, 39.27786221106847, 39.4904122975034, 40.99821514387925, 41.50939256822069, 41.50698370238145, 26.72260022908449, 26.63150730729103, 26.34674708545208, 27.908330669005707, 27.616749738653496, 27.836007361610726, 34.20911265537143, 33.475976809859276, 34.27863817662001, 40.482916732629135, 41.42307845254739, 41.70132004966338, 40.40881422658761, 40.68980277826388, 41.04229935755332, 40.13814528783162, 40.66990492244561, 40.801215929289654, 45.4557997037967, 44.831878696878746, 45.044388627012566, 41.24385657906532, 41.64110466092825, 41.14412884414196, 27.404990439613655, 26.37974040706952, 27.491089535256222, 40.385214015841484, 40.35962447524071, 40.74057227000594, 49.974812285664186, 49.615933748583004, 49.89939841690163, 27.178733961035803, 27.212054447581366, 27.081403282781437, 32.13867776965101, 32.20814698313673, 31.691736569007233, 33.442702412605286, 33.632556207478046, 33.71460885554552, 50.212835070366665, 49.97874512026708, 49.17663837472598, 52.67057837049167, 52.497625845174, 52.66223955030243, 44.88999914874633, 45.07055152704318, 45.147218616058424, 52.47374079376458, 52.84169393777846, 52.36711020767687, 23.800225131213665, 23.68370158970356, 24.182143289595842, 41.55122410257657, 41.800668628265456, 42.00432591561305, 47.10454592108725, 47.13085630536078, 47.580964803695665, 39.46698671579361, 40.84033029526472, 39.55040282011032, 47.700277045369134, 47.80933633446692, 48.44956237589939, 54.07044276595114, 54.47621090337633, 54.203435778617845, 47.12883026152848, 47.014222916215644, 46.388528466224656, 34.66500231872001, 34.0326666633288, 34.75178421350816, 44.96605738461949, 44.94873427832499, 44.91682194918394, 28.73571325202161, 27.456419895092637, 28.241693953673035, 31.92178340752919, 31.66394895066817, 30.748779495557145, 29.005625903606415, 29.36517572402954, 29.107357546687126, 35.49861018359661, 35.72712753713131, 35.91690710559487, 37.62106045087178, 38.34477051099141, 38.63830377285679, 43.58872420589128, 43.39347358296314, 43.637772500204534, 38.79590336481729, 39.18572604904571, 39.338107521335274, 41.79651366764058, 41.317127381761864, 40.262997557719544, 37.151180674632386, 37.326471378405884, 37.23241614301999, 43.489845293263585, 43.17926050225893, 43.88671218479672, 47.6252098828554, 48.094371452927575, 47.79130303114651, 41.25118117158611, 40.733668630321816, 41.193385527779654, 38.885737504810095, 39.116807110607624, 39.1212278008461, 37.85227638591701, 37.76554632621506, 37.27215665082136, 36.671864335735634, 37.1233868052562, 36.56047577162583, 40.20258624354997, 40.96803622568646, 41.03458915154138, 44.344934940338135, 44.43310369551182, 44.636348474770784, 41.903934828937054, 42.173523508012295, 41.700475603342056, 41.42730714877446, 43.206292671461895, 43.19905305405457, 21.148416871825845, 21.218298772970826, 21.39331868539253, 43.206883927186325, 43.623752293487385, 43.7597994202127, 59.16682641704877, 58.76439057042201, 59.20943206859131, 39.44927437106767, 39.24358462790647, 39.25707658628622, 38.45464149862528, 38.54397876560688, 38.817823849618435, 46.184361916035414, 46.21342681720853, 45.99029675498605, 42.32637619972229, 42.78909756243229, 43.13644907809794, 44.49206496650973, 44.00794730583826, 44.66928712918403, 42.67102726424733, 42.334939452509076, 41.529720226923615, 39.113322163621575, 39.2440338085095, 38.67428485552469, 37.71131039659181, 38.108372940371424, 37.68504985670248, 44.10076501220465, 43.72208847105503, 44.2924878038466, 48.68967526654403, 49.071876425916955, 48.640073361496135, 46.18286426955213, 45.66052758445342, 46.16181596492727, 28.47304556146264, 28.354799054563046, 28.535684250295162, 49.80246417721112, 50.54616934185226, 50.61973906618853, 40.15424684683481, 40.650276011476905, 40.416920902828366, 47.77152112498878, 47.317143648862825, 47.35429429262875, 42.95334541161233, 42.592564287285, 42.03692803780237, 51.21145715688665, 50.8660430808862, 51.310515866925314, 49.75395769377549, 50.02094284196694, 48.95682968695958, 44.57168675400317, 44.15716240555048, 44.26140370219946, 42.36424272879958, 42.2522796690464, 41.974697075784206, 38.471429988741875, 38.70727664779406, 37.24362072348595, 37.55254257222016, 37.384976406892136, 37.910559100409344, 40.176588132977486, 40.60542513121254, 40.52196127735078, 46.778625053664044, 46.47954738636811, 46.174088706572846, 42.32033361991246, 42.29520623882611, 42.74974000950654, 48.74782203137873, 48.490315139293656, 49.08373798616229, 48.08718140671651, 47.971873576442405, 47.34189144770305, 30.340273961424828, 30.710043147206306, 29.961474895477295, 48.27889103194077, 48.36992896844943, 48.50495718171199, 37.78027183562517, 37.911033771932125, 37.89963550120592, 37.684599551682666, 37.67916863722105, 37.239270125826195, 53.366157342990235, 53.16020794709523, 53.792339493830994, 21.482362531125546, 21.37737785279751, 20.265986144542694, 50.409589435905204, 50.05226247757672, 50.42910345643757, 39.574317760144666, 39.09152370442946, 39.438998890419796, 42.98576923335591, 43.1055680780361, 43.10819654042521, 19.050497053811938, 18.827606714020163, 18.8084072942535]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14210005756435898, "mean_inference_ms": 0.7011192639696098, "mean_action_processing_ms": 0.09653536016895542, "mean_env_wait_ms": 0.7887914247109877, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 890000, "timesteps_this_iter": 0, "agent_timesteps_total": 2670000, "timers": {"sample_time_ms": 10488.209, "sample_throughput": 476.726, "load_time_ms": 0.1, "load_throughput": 49991704.41, "learn_time_ms": 1941.542, "learn_throughput": 2575.273, "update_time_ms": 9.324}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.017869788627737e-44, "cur_lr": 0.0005000000000000001, "total_loss": 7.574036550521851, "policy_loss": -0.0008055891565043715, "vf_loss": 7.679287528991699, "vf_explained_var": -0.015137696266174316, "kl": 0.002284393704080232, "entropy": 10.444530963897705, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 890000, "num_agent_steps_sampled": 2670000, "num_steps_trained": 890000, "num_agent_steps_trained": 2670000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2456, "training_iteration": 178, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-33-29", "timestamp": 1706232809, "time_this_iter_s": 11.185428142547607, "time_total_s": 1922.1904261112213, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140251FE50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1922.1904261112213, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 7.0375, "ram_util_percent": 63.325}}
{"episode_reward_max": 177.14064905606216, "episode_reward_min": 56.6865110620856, "episode_reward_mean": 123.22759340958154, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 18.8084072942535}, "policy_reward_max": {"shared_policy": 59.20943206859131}, "policy_reward_mean": {"shared_policy": 41.07586446986052}, "custom_metrics": {}, "hist_stats": {"episode_reward": [131.3013291105163, 134.91510375542572, 117.78233885532244, 124.01459141448139, 79.7008546218276, 83.36108776926993, 101.96372764185071, 123.6073152348399, 122.14091636240481, 121.60926613956688, 135.3320670276879, 124.02909008413553, 81.2758203819394, 121.48541076108813, 149.49014445114864, 81.4721916913986, 96.03856132179497, 100.78986747562885, 149.36821856535963, 157.83044376596834, 135.1077692918479, 157.68254493921987, 71.66607001051307, 125.35621864645508, 141.81636703014408, 119.85771983116865, 143.9591757557353, 162.75008944794527, 140.5315816439686, 103.44945319555697, 134.83161361212836, 84.43382710078728, 94.3345118537545, 87.47815917432308, 107.1426448263228, 114.60413473471998, 130.61997028905893, 117.31973693519828, 123.37663860712199, 111.71006819605826, 130.5558179803192, 143.51088436692947, 123.17823532968758, 117.12377241626382, 112.88997936295343, 110.35572691261767, 122.20521162077782, 133.41438711062048, 125.7779339402914, 127.83265287429093, 63.7600343301892, 130.59043564088643, 177.14064905606216, 117.94993558526036, 115.8164441138506, 138.3880854882299, 128.25192284025252, 133.16929940153196, 126.53568694368002, 117.03164082765576, 113.50473319366571, 132.11534128710656, 146.401625053957, 138.00520781893283, 85.36352886632085, 150.96837258525184, 121.22144376114008, 142.44295906648043, 127.58283773669969, 153.38801610469827, 148.73173022270203, 132.99025286175316, 126.59121947363019, 114.42232736002188, 112.84807807952164, 121.30397454154081, 139.4322611466049, 127.36527986824511, 146.32187515683458, 143.4009464308619, 91.01179200410843, 145.15377718210217, 113.59094110876322, 112.60303831472991, 160.3187047839167, 63.12572652846575, 150.8909553699195, 118.10484035499393, 129.19953385181722, 56.6865110620856, 170.79972099140258, 136.70451466552913, 131.13702936470509, 124.0891227684915, 150.35996825620566, 120.45581988431512, 128.53690421953786, 123.66667005605993, 109.92993589118122, 120.97644598782063], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [43.96832962877427, 43.99757904706833, 43.33542043467362, 44.71647036075592, 45.15629734424874, 45.042336050421, 39.01406434675057, 39.27786221106847, 39.4904122975034, 40.99821514387925, 41.50939256822069, 41.50698370238145, 26.72260022908449, 26.63150730729103, 26.34674708545208, 27.908330669005707, 27.616749738653496, 27.836007361610726, 34.20911265537143, 33.475976809859276, 34.27863817662001, 40.482916732629135, 41.42307845254739, 41.70132004966338, 40.40881422658761, 40.68980277826388, 41.04229935755332, 40.13814528783162, 40.66990492244561, 40.801215929289654, 45.4557997037967, 44.831878696878746, 45.044388627012566, 41.24385657906532, 41.64110466092825, 41.14412884414196, 27.404990439613655, 26.37974040706952, 27.491089535256222, 40.385214015841484, 40.35962447524071, 40.74057227000594, 49.974812285664186, 49.615933748583004, 49.89939841690163, 27.178733961035803, 27.212054447581366, 27.081403282781437, 32.13867776965101, 32.20814698313673, 31.691736569007233, 33.442702412605286, 33.632556207478046, 33.71460885554552, 50.212835070366665, 49.97874512026708, 49.17663837472598, 52.67057837049167, 52.497625845174, 52.66223955030243, 44.88999914874633, 45.07055152704318, 45.147218616058424, 52.47374079376458, 52.84169393777846, 52.36711020767687, 23.800225131213665, 23.68370158970356, 24.182143289595842, 41.55122410257657, 41.800668628265456, 42.00432591561305, 47.10454592108725, 47.13085630536078, 47.580964803695665, 39.46698671579361, 40.84033029526472, 39.55040282011032, 47.700277045369134, 47.80933633446692, 48.44956237589939, 54.07044276595114, 54.47621090337633, 54.203435778617845, 47.12883026152848, 47.014222916215644, 46.388528466224656, 34.66500231872001, 34.0326666633288, 34.75178421350816, 44.96605738461949, 44.94873427832499, 44.91682194918394, 28.73571325202161, 27.456419895092637, 28.241693953673035, 31.92178340752919, 31.66394895066817, 30.748779495557145, 29.005625903606415, 29.36517572402954, 29.107357546687126, 35.49861018359661, 35.72712753713131, 35.91690710559487, 37.62106045087178, 38.34477051099141, 38.63830377285679, 43.58872420589128, 43.39347358296314, 43.637772500204534, 38.79590336481729, 39.18572604904571, 39.338107521335274, 41.79651366764058, 41.317127381761864, 40.262997557719544, 37.151180674632386, 37.326471378405884, 37.23241614301999, 43.489845293263585, 43.17926050225893, 43.88671218479672, 47.6252098828554, 48.094371452927575, 47.79130303114651, 41.25118117158611, 40.733668630321816, 41.193385527779654, 38.885737504810095, 39.116807110607624, 39.1212278008461, 37.85227638591701, 37.76554632621506, 37.27215665082136, 36.671864335735634, 37.1233868052562, 36.56047577162583, 40.20258624354997, 40.96803622568646, 41.03458915154138, 44.344934940338135, 44.43310369551182, 44.636348474770784, 41.903934828937054, 42.173523508012295, 41.700475603342056, 41.42730714877446, 43.206292671461895, 43.19905305405457, 21.148416871825845, 21.218298772970826, 21.39331868539253, 43.206883927186325, 43.623752293487385, 43.7597994202127, 59.16682641704877, 58.76439057042201, 59.20943206859131, 39.44927437106767, 39.24358462790647, 39.25707658628622, 38.45464149862528, 38.54397876560688, 38.817823849618435, 46.184361916035414, 46.21342681720853, 45.99029675498605, 42.32637619972229, 42.78909756243229, 43.13644907809794, 44.49206496650973, 44.00794730583826, 44.66928712918403, 42.67102726424733, 42.334939452509076, 41.529720226923615, 39.113322163621575, 39.2440338085095, 38.67428485552469, 37.71131039659181, 38.108372940371424, 37.68504985670248, 44.10076501220465, 43.72208847105503, 44.2924878038466, 48.68967526654403, 49.071876425916955, 48.640073361496135, 46.18286426955213, 45.66052758445342, 46.16181596492727, 28.47304556146264, 28.354799054563046, 28.535684250295162, 49.80246417721112, 50.54616934185226, 50.61973906618853, 40.15424684683481, 40.650276011476905, 40.416920902828366, 47.77152112498878, 47.317143648862825, 47.35429429262875, 42.95334541161233, 42.592564287285, 42.03692803780237, 51.21145715688665, 50.8660430808862, 51.310515866925314, 49.75395769377549, 50.02094284196694, 48.95682968695958, 44.57168675400317, 44.15716240555048, 44.26140370219946, 42.36424272879958, 42.2522796690464, 41.974697075784206, 38.471429988741875, 38.70727664779406, 37.24362072348595, 37.55254257222016, 37.384976406892136, 37.910559100409344, 40.176588132977486, 40.60542513121254, 40.52196127735078, 46.778625053664044, 46.47954738636811, 46.174088706572846, 42.32033361991246, 42.29520623882611, 42.74974000950654, 48.74782203137873, 48.490315139293656, 49.08373798616229, 48.08718140671651, 47.971873576442405, 47.34189144770305, 30.340273961424828, 30.710043147206306, 29.961474895477295, 48.27889103194077, 48.36992896844943, 48.50495718171199, 37.78027183562517, 37.911033771932125, 37.89963550120592, 37.684599551682666, 37.67916863722105, 37.239270125826195, 53.366157342990235, 53.16020794709523, 53.792339493830994, 21.482362531125546, 21.37737785279751, 20.265986144542694, 50.409589435905204, 50.05226247757672, 50.42910345643757, 39.574317760144666, 39.09152370442946, 39.438998890419796, 42.98576923335591, 43.1055680780361, 43.10819654042521, 19.050497053811938, 18.827606714020163, 18.8084072942535, 56.960538581013665, 56.80417592823504, 57.03500648215412, 45.48300294702251, 45.61525795174141, 45.60625376676519, 43.612258193393544, 43.73957136770089, 43.78519980361064, 41.66154691949487, 41.40525113791227, 41.022324711084366, 50.115597655375794, 50.2198561069866, 50.024514493842915, 40.038741064568356, 40.142124240597084, 40.27495457914968, 42.8855609546105, 42.694822552303464, 42.956520712623984, 41.41555803331235, 40.95778513203064, 41.29332689071694, 36.362534319361046, 36.61686447014411, 36.95053710167606, 40.21176519989967, 40.49188235029578, 40.27279843762517]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1420762354811664, "mean_inference_ms": 0.7010967594220752, "mean_action_processing_ms": 0.09653738988105998, "mean_env_wait_ms": 0.7886397054762894, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 895000, "timesteps_this_iter": 0, "agent_timesteps_total": 2685000, "timers": {"sample_time_ms": 10487.237, "sample_throughput": 476.77, "load_time_ms": 0.1, "load_throughput": 49991704.41, "learn_time_ms": 1941.432, "learn_throughput": 2575.419, "update_time_ms": 9.107}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0089348943138684e-44, "cur_lr": 0.0005000000000000001, "total_loss": 7.783193492889405, "policy_loss": -0.0014851921601159112, "vf_loss": 7.88980393409729, "vf_explained_var": 0.02856118083000183, "kl": 0.0024615458562537917, "entropy": 10.512539482116699, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 895000, "num_agent_steps_sampled": 2685000, "num_steps_trained": 895000, "num_agent_steps_trained": 2685000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2466, "training_iteration": 179, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-33-39", "timestamp": 1706232819, "time_this_iter_s": 10.277677774429321, "time_total_s": 1932.4681038856506, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D2D8B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1932.4681038856506, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 5.014285714285714, "ram_util_percent": 63.20000000000001}}
{"episode_reward_max": 177.14064905606216, "episode_reward_min": 56.6865110620856, "episode_reward_mean": 125.7384367738473, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 18.8084072942535}, "policy_reward_max": {"shared_policy": 59.20943206859131}, "policy_reward_mean": {"shared_policy": 41.9128122579491}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.3320670276879, 124.02909008413553, 81.2758203819394, 121.48541076108813, 149.49014445114864, 81.4721916913986, 96.03856132179497, 100.78986747562885, 149.36821856535963, 157.83044376596834, 135.1077692918479, 157.68254493921987, 71.66607001051307, 125.35621864645508, 141.81636703014408, 119.85771983116865, 143.9591757557353, 162.75008944794527, 140.5315816439686, 103.44945319555697, 134.83161361212836, 84.43382710078728, 94.3345118537545, 87.47815917432308, 107.1426448263228, 114.60413473471998, 130.61997028905893, 117.31973693519828, 123.37663860712199, 111.71006819605826, 130.5558179803192, 143.51088436692947, 123.17823532968758, 117.12377241626382, 112.88997936295343, 110.35572691261767, 122.20521162077782, 133.41438711062048, 125.7779339402914, 127.83265287429093, 63.7600343301892, 130.59043564088643, 177.14064905606216, 117.94993558526036, 115.8164441138506, 138.3880854882299, 128.25192284025252, 133.16929940153196, 126.53568694368002, 117.03164082765576, 113.50473319366571, 132.11534128710656, 146.401625053957, 138.00520781893283, 85.36352886632085, 150.96837258525184, 121.22144376114008, 142.44295906648043, 127.58283773669969, 153.38801610469827, 148.73173022270203, 132.99025286175316, 126.59121947363019, 114.42232736002188, 112.84807807952164, 121.30397454154081, 139.4322611466049, 127.36527986824511, 146.32187515683458, 143.4009464308619, 91.01179200410843, 145.15377718210217, 113.59094110876322, 112.60303831472991, 160.3187047839167, 63.12572652846575, 150.8909553699195, 118.10484035499393, 129.19953385181722, 56.6865110620856, 170.79972099140258, 136.70451466552913, 131.13702936470509, 124.0891227684915, 150.35996825620566, 120.45581988431512, 128.53690421953786, 123.66667005605993, 109.92993589118122, 120.97644598782063, 142.38458878174407, 137.78859271877437, 133.48944316059328, 133.8364479104058, 127.65681176446375, 172.33469638600934, 169.54227360431108, 147.84329211153107, 115.02765936404465, 111.57706153020263], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [45.4557997037967, 44.831878696878746, 45.044388627012566, 41.24385657906532, 41.64110466092825, 41.14412884414196, 27.404990439613655, 26.37974040706952, 27.491089535256222, 40.385214015841484, 40.35962447524071, 40.74057227000594, 49.974812285664186, 49.615933748583004, 49.89939841690163, 27.178733961035803, 27.212054447581366, 27.081403282781437, 32.13867776965101, 32.20814698313673, 31.691736569007233, 33.442702412605286, 33.632556207478046, 33.71460885554552, 50.212835070366665, 49.97874512026708, 49.17663837472598, 52.67057837049167, 52.497625845174, 52.66223955030243, 44.88999914874633, 45.07055152704318, 45.147218616058424, 52.47374079376458, 52.84169393777846, 52.36711020767687, 23.800225131213665, 23.68370158970356, 24.182143289595842, 41.55122410257657, 41.800668628265456, 42.00432591561305, 47.10454592108725, 47.13085630536078, 47.580964803695665, 39.46698671579361, 40.84033029526472, 39.55040282011032, 47.700277045369134, 47.80933633446692, 48.44956237589939, 54.07044276595114, 54.47621090337633, 54.203435778617845, 47.12883026152848, 47.014222916215644, 46.388528466224656, 34.66500231872001, 34.0326666633288, 34.75178421350816, 44.96605738461949, 44.94873427832499, 44.91682194918394, 28.73571325202161, 27.456419895092637, 28.241693953673035, 31.92178340752919, 31.66394895066817, 30.748779495557145, 29.005625903606415, 29.36517572402954, 29.107357546687126, 35.49861018359661, 35.72712753713131, 35.91690710559487, 37.62106045087178, 38.34477051099141, 38.63830377285679, 43.58872420589128, 43.39347358296314, 43.637772500204534, 38.79590336481729, 39.18572604904571, 39.338107521335274, 41.79651366764058, 41.317127381761864, 40.262997557719544, 37.151180674632386, 37.326471378405884, 37.23241614301999, 43.489845293263585, 43.17926050225893, 43.88671218479672, 47.6252098828554, 48.094371452927575, 47.79130303114651, 41.25118117158611, 40.733668630321816, 41.193385527779654, 38.885737504810095, 39.116807110607624, 39.1212278008461, 37.85227638591701, 37.76554632621506, 37.27215665082136, 36.671864335735634, 37.1233868052562, 36.56047577162583, 40.20258624354997, 40.96803622568646, 41.03458915154138, 44.344934940338135, 44.43310369551182, 44.636348474770784, 41.903934828937054, 42.173523508012295, 41.700475603342056, 41.42730714877446, 43.206292671461895, 43.19905305405457, 21.148416871825845, 21.218298772970826, 21.39331868539253, 43.206883927186325, 43.623752293487385, 43.7597994202127, 59.16682641704877, 58.76439057042201, 59.20943206859131, 39.44927437106767, 39.24358462790647, 39.25707658628622, 38.45464149862528, 38.54397876560688, 38.817823849618435, 46.184361916035414, 46.21342681720853, 45.99029675498605, 42.32637619972229, 42.78909756243229, 43.13644907809794, 44.49206496650973, 44.00794730583826, 44.66928712918403, 42.67102726424733, 42.334939452509076, 41.529720226923615, 39.113322163621575, 39.2440338085095, 38.67428485552469, 37.71131039659181, 38.108372940371424, 37.68504985670248, 44.10076501220465, 43.72208847105503, 44.2924878038466, 48.68967526654403, 49.071876425916955, 48.640073361496135, 46.18286426955213, 45.66052758445342, 46.16181596492727, 28.47304556146264, 28.354799054563046, 28.535684250295162, 49.80246417721112, 50.54616934185226, 50.61973906618853, 40.15424684683481, 40.650276011476905, 40.416920902828366, 47.77152112498878, 47.317143648862825, 47.35429429262875, 42.95334541161233, 42.592564287285, 42.03692803780237, 51.21145715688665, 50.8660430808862, 51.310515866925314, 49.75395769377549, 50.02094284196694, 48.95682968695958, 44.57168675400317, 44.15716240555048, 44.26140370219946, 42.36424272879958, 42.2522796690464, 41.974697075784206, 38.471429988741875, 38.70727664779406, 37.24362072348595, 37.55254257222016, 37.384976406892136, 37.910559100409344, 40.176588132977486, 40.60542513121254, 40.52196127735078, 46.778625053664044, 46.47954738636811, 46.174088706572846, 42.32033361991246, 42.29520623882611, 42.74974000950654, 48.74782203137873, 48.490315139293656, 49.08373798616229, 48.08718140671651, 47.971873576442405, 47.34189144770305, 30.340273961424828, 30.710043147206306, 29.961474895477295, 48.27889103194077, 48.36992896844943, 48.50495718171199, 37.78027183562517, 37.911033771932125, 37.89963550120592, 37.684599551682666, 37.67916863722105, 37.239270125826195, 53.366157342990235, 53.16020794709523, 53.792339493830994, 21.482362531125546, 21.37737785279751, 20.265986144542694, 50.409589435905204, 50.05226247757672, 50.42910345643757, 39.574317760144666, 39.09152370442946, 39.438998890419796, 42.98576923335591, 43.1055680780361, 43.10819654042521, 19.050497053811938, 18.827606714020163, 18.8084072942535, 56.960538581013665, 56.80417592823504, 57.03500648215412, 45.48300294702251, 45.61525795174141, 45.60625376676519, 43.612258193393544, 43.73957136770089, 43.78519980361064, 41.66154691949487, 41.40525113791227, 41.022324711084366, 50.115597655375794, 50.2198561069866, 50.024514493842915, 40.038741064568356, 40.142124240597084, 40.27495457914968, 42.8855609546105, 42.694822552303464, 42.956520712623984, 41.41555803331235, 40.95778513203064, 41.29332689071694, 36.362534319361046, 36.61686447014411, 36.95053710167606, 40.21176519989967, 40.49188235029578, 40.27279843762517, 47.59502991661428, 47.547375015914426, 47.24218384921549, 46.26552362763323, 45.55913197994232, 45.9639371111989, 43.573253522316605, 45.16157607982555, 44.754613558451325, 45.027603656674415, 43.69088993469873, 45.11795431903252, 42.466163026789815, 42.712001331771404, 42.478647405902535, 57.31397477785747, 57.35995648304622, 57.66076512510578, 56.39295982817809, 56.45015000055234, 56.69916377558063, 49.56980355021854, 49.01737122734387, 49.256117333968476, 38.368281727035836, 38.69751740743716, 37.961860229571656, 37.24574927985668, 37.27647411450744, 37.05483813583851]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1420530916046527, "mean_inference_ms": 0.7010720280760298, "mean_action_processing_ms": 0.09653848600012223, "mean_env_wait_ms": 0.7884939888268306, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 900000, "timesteps_this_iter": 0, "agent_timesteps_total": 2700000, "timers": {"sample_time_ms": 10486.324, "sample_throughput": 476.812, "load_time_ms": 0.1, "load_throughput": 49991704.41, "learn_time_ms": 1955.491, "learn_throughput": 2556.903, "update_time_ms": 9.306}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.044674471569342e-45, "cur_lr": 0.0005000000000000001, "total_loss": 8.20101261138916, "policy_loss": -0.0010744556964790263, "vf_loss": 8.306861400604248, "vf_explained_var": 0.017558735609054566, "kl": 0.0019715318340382685, "entropy": 10.477408027648925, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 900000, "num_agent_steps_sampled": 2700000, "num_steps_trained": 900000, "num_agent_steps_trained": 2700000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2476, "training_iteration": 180, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-33-50", "timestamp": 1706232830, "time_this_iter_s": 10.326440334320068, "time_total_s": 1942.7945442199707, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140239E040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1942.7945442199707, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 6.653333333333334, "ram_util_percent": 63.08}}
{"episode_reward_max": 177.14064905606216, "episode_reward_min": 56.6865110620856, "episode_reward_mean": 126.73297328059049, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 18.8084072942535}, "policy_reward_max": {"shared_policy": 59.20943206859131}, "policy_reward_mean": {"shared_policy": 42.244324426863486}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.1077692918479, 157.68254493921987, 71.66607001051307, 125.35621864645508, 141.81636703014408, 119.85771983116865, 143.9591757557353, 162.75008944794527, 140.5315816439686, 103.44945319555697, 134.83161361212836, 84.43382710078728, 94.3345118537545, 87.47815917432308, 107.1426448263228, 114.60413473471998, 130.61997028905893, 117.31973693519828, 123.37663860712199, 111.71006819605826, 130.5558179803192, 143.51088436692947, 123.17823532968758, 117.12377241626382, 112.88997936295343, 110.35572691261767, 122.20521162077782, 133.41438711062048, 125.7779339402914, 127.83265287429093, 63.7600343301892, 130.59043564088643, 177.14064905606216, 117.94993558526036, 115.8164441138506, 138.3880854882299, 128.25192284025252, 133.16929940153196, 126.53568694368002, 117.03164082765576, 113.50473319366571, 132.11534128710656, 146.401625053957, 138.00520781893283, 85.36352886632085, 150.96837258525184, 121.22144376114008, 142.44295906648043, 127.58283773669969, 153.38801610469827, 148.73173022270203, 132.99025286175316, 126.59121947363019, 114.42232736002188, 112.84807807952164, 121.30397454154081, 139.4322611466049, 127.36527986824511, 146.32187515683458, 143.4009464308619, 91.01179200410843, 145.15377718210217, 113.59094110876322, 112.60303831472991, 160.3187047839167, 63.12572652846575, 150.8909553699195, 118.10484035499393, 129.19953385181722, 56.6865110620856, 170.79972099140258, 136.70451466552913, 131.13702936470509, 124.0891227684915, 150.35996825620566, 120.45581988431512, 128.53690421953786, 123.66667005605993, 109.92993589118122, 120.97644598782063, 142.38458878174407, 137.78859271877437, 133.48944316059328, 133.8364479104058, 127.65681176446375, 172.33469638600934, 169.54227360431108, 147.84329211153107, 115.02765936404465, 111.57706153020263, 151.8910580608064, 134.84543563053003, 95.6744093969464, 163.18846082687398, 163.19694819301367, 114.87588725239037, 121.81050304882226, 77.79878136701879, 132.51878186129025, 140.7652005627754], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [44.88999914874633, 45.07055152704318, 45.147218616058424, 52.47374079376458, 52.84169393777846, 52.36711020767687, 23.800225131213665, 23.68370158970356, 24.182143289595842, 41.55122410257657, 41.800668628265456, 42.00432591561305, 47.10454592108725, 47.13085630536078, 47.580964803695665, 39.46698671579361, 40.84033029526472, 39.55040282011032, 47.700277045369134, 47.80933633446692, 48.44956237589939, 54.07044276595114, 54.47621090337633, 54.203435778617845, 47.12883026152848, 47.014222916215644, 46.388528466224656, 34.66500231872001, 34.0326666633288, 34.75178421350816, 44.96605738461949, 44.94873427832499, 44.91682194918394, 28.73571325202161, 27.456419895092637, 28.241693953673035, 31.92178340752919, 31.66394895066817, 30.748779495557145, 29.005625903606415, 29.36517572402954, 29.107357546687126, 35.49861018359661, 35.72712753713131, 35.91690710559487, 37.62106045087178, 38.34477051099141, 38.63830377285679, 43.58872420589128, 43.39347358296314, 43.637772500204534, 38.79590336481729, 39.18572604904571, 39.338107521335274, 41.79651366764058, 41.317127381761864, 40.262997557719544, 37.151180674632386, 37.326471378405884, 37.23241614301999, 43.489845293263585, 43.17926050225893, 43.88671218479672, 47.6252098828554, 48.094371452927575, 47.79130303114651, 41.25118117158611, 40.733668630321816, 41.193385527779654, 38.885737504810095, 39.116807110607624, 39.1212278008461, 37.85227638591701, 37.76554632621506, 37.27215665082136, 36.671864335735634, 37.1233868052562, 36.56047577162583, 40.20258624354997, 40.96803622568646, 41.03458915154138, 44.344934940338135, 44.43310369551182, 44.636348474770784, 41.903934828937054, 42.173523508012295, 41.700475603342056, 41.42730714877446, 43.206292671461895, 43.19905305405457, 21.148416871825845, 21.218298772970826, 21.39331868539253, 43.206883927186325, 43.623752293487385, 43.7597994202127, 59.16682641704877, 58.76439057042201, 59.20943206859131, 39.44927437106767, 39.24358462790647, 39.25707658628622, 38.45464149862528, 38.54397876560688, 38.817823849618435, 46.184361916035414, 46.21342681720853, 45.99029675498605, 42.32637619972229, 42.78909756243229, 43.13644907809794, 44.49206496650973, 44.00794730583826, 44.66928712918403, 42.67102726424733, 42.334939452509076, 41.529720226923615, 39.113322163621575, 39.2440338085095, 38.67428485552469, 37.71131039659181, 38.108372940371424, 37.68504985670248, 44.10076501220465, 43.72208847105503, 44.2924878038466, 48.68967526654403, 49.071876425916955, 48.640073361496135, 46.18286426955213, 45.66052758445342, 46.16181596492727, 28.47304556146264, 28.354799054563046, 28.535684250295162, 49.80246417721112, 50.54616934185226, 50.61973906618853, 40.15424684683481, 40.650276011476905, 40.416920902828366, 47.77152112498878, 47.317143648862825, 47.35429429262875, 42.95334541161233, 42.592564287285, 42.03692803780237, 51.21145715688665, 50.8660430808862, 51.310515866925314, 49.75395769377549, 50.02094284196694, 48.95682968695958, 44.57168675400317, 44.15716240555048, 44.26140370219946, 42.36424272879958, 42.2522796690464, 41.974697075784206, 38.471429988741875, 38.70727664779406, 37.24362072348595, 37.55254257222016, 37.384976406892136, 37.910559100409344, 40.176588132977486, 40.60542513121254, 40.52196127735078, 46.778625053664044, 46.47954738636811, 46.174088706572846, 42.32033361991246, 42.29520623882611, 42.74974000950654, 48.74782203137873, 48.490315139293656, 49.08373798616229, 48.08718140671651, 47.971873576442405, 47.34189144770305, 30.340273961424828, 30.710043147206306, 29.961474895477295, 48.27889103194077, 48.36992896844943, 48.50495718171199, 37.78027183562517, 37.911033771932125, 37.89963550120592, 37.684599551682666, 37.67916863722105, 37.239270125826195, 53.366157342990235, 53.16020794709523, 53.792339493830994, 21.482362531125546, 21.37737785279751, 20.265986144542694, 50.409589435905204, 50.05226247757672, 50.42910345643757, 39.574317760144666, 39.09152370442946, 39.438998890419796, 42.98576923335591, 43.1055680780361, 43.10819654042521, 19.050497053811938, 18.827606714020163, 18.8084072942535, 56.960538581013665, 56.80417592823504, 57.03500648215412, 45.48300294702251, 45.61525795174141, 45.60625376676519, 43.612258193393544, 43.73957136770089, 43.78519980361064, 41.66154691949487, 41.40525113791227, 41.022324711084366, 50.115597655375794, 50.2198561069866, 50.024514493842915, 40.038741064568356, 40.142124240597084, 40.27495457914968, 42.8855609546105, 42.694822552303464, 42.956520712623984, 41.41555803331235, 40.95778513203064, 41.29332689071694, 36.362534319361046, 36.61686447014411, 36.95053710167606, 40.21176519989967, 40.49188235029578, 40.27279843762517, 47.59502991661428, 47.547375015914426, 47.24218384921549, 46.26552362763323, 45.55913197994232, 45.9639371111989, 43.573253522316605, 45.16157607982555, 44.754613558451325, 45.027603656674415, 43.69088993469873, 45.11795431903252, 42.466163026789815, 42.712001331771404, 42.478647405902535, 57.31397477785747, 57.35995648304622, 57.66076512510578, 56.39295982817809, 56.45015000055234, 56.69916377558063, 49.56980355021854, 49.01737122734387, 49.256117333968476, 38.368281727035836, 38.69751740743716, 37.961860229571656, 37.24574927985668, 37.27647411450744, 37.05483813583851, 50.759848873596624, 50.65671049803494, 50.47449868917464, 44.4678046653668, 45.16107532257834, 45.21655564258495, 31.727670485774667, 31.82922689119974, 32.117512019972, 54.614559729894, 54.240010922153786, 54.33389017482598, 53.61194498340289, 54.70318413774173, 54.88181907186906, 38.542700854440525, 38.53175092240174, 37.801435475548104, 40.443821306029946, 40.3349597553412, 41.03172198745111, 25.791031687209994, 26.019631928453833, 25.988117751354963, 43.82855015496412, 43.99636710683504, 44.69386459949115, 47.053344028691455, 47.16937158505122, 46.54248494903247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1420445883520028, "mean_inference_ms": 0.7011039837482558, "mean_action_processing_ms": 0.09654432823243875, "mean_env_wait_ms": 0.7883935613015954, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 905000, "timesteps_this_iter": 0, "agent_timesteps_total": 2715000, "timers": {"sample_time_ms": 10610.634, "sample_throughput": 471.225, "load_time_ms": 0.1, "load_throughput": 49991704.41, "learn_time_ms": 1971.677, "learn_throughput": 2535.912, "update_time_ms": 9.358}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.522337235784671e-45, "cur_lr": 0.0005000000000000001, "total_loss": 8.092958927154541, "policy_loss": -0.0013383367778835975, "vf_loss": 8.198782444000244, "vf_explained_var": -0.00488593578338623, "kl": 0.002341411309367258, "entropy": 10.448493099212646, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 905000, "num_agent_steps_sampled": 2715000, "num_steps_trained": 905000, "num_agent_steps_trained": 2715000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2486, "training_iteration": 181, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-34-01", "timestamp": 1706232841, "time_this_iter_s": 11.58436107635498, "time_total_s": 1954.3789052963257, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401AAAEE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1954.3789052963257, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 7.24375, "ram_util_percent": 62.443749999999994}}
{"episode_reward_max": 177.14064905606216, "episode_reward_min": 56.6865110620856, "episode_reward_mean": 127.17257786275597, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 18.8084072942535}, "policy_reward_max": {"shared_policy": 59.20943206859131}, "policy_reward_mean": {"shared_policy": 42.390859287585315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.83161361212836, 84.43382710078728, 94.3345118537545, 87.47815917432308, 107.1426448263228, 114.60413473471998, 130.61997028905893, 117.31973693519828, 123.37663860712199, 111.71006819605826, 130.5558179803192, 143.51088436692947, 123.17823532968758, 117.12377241626382, 112.88997936295343, 110.35572691261767, 122.20521162077782, 133.41438711062048, 125.7779339402914, 127.83265287429093, 63.7600343301892, 130.59043564088643, 177.14064905606216, 117.94993558526036, 115.8164441138506, 138.3880854882299, 128.25192284025252, 133.16929940153196, 126.53568694368002, 117.03164082765576, 113.50473319366571, 132.11534128710656, 146.401625053957, 138.00520781893283, 85.36352886632085, 150.96837258525184, 121.22144376114008, 142.44295906648043, 127.58283773669969, 153.38801610469827, 148.73173022270203, 132.99025286175316, 126.59121947363019, 114.42232736002188, 112.84807807952164, 121.30397454154081, 139.4322611466049, 127.36527986824511, 146.32187515683458, 143.4009464308619, 91.01179200410843, 145.15377718210217, 113.59094110876322, 112.60303831472991, 160.3187047839167, 63.12572652846575, 150.8909553699195, 118.10484035499393, 129.19953385181722, 56.6865110620856, 170.79972099140258, 136.70451466552913, 131.13702936470509, 124.0891227684915, 150.35996825620566, 120.45581988431512, 128.53690421953786, 123.66667005605993, 109.92993589118122, 120.97644598782063, 142.38458878174407, 137.78859271877437, 133.48944316059328, 133.8364479104058, 127.65681176446375, 172.33469638600934, 169.54227360431108, 147.84329211153107, 115.02765936404465, 111.57706153020263, 151.8910580608064, 134.84543563053003, 95.6744093969464, 163.18846082687398, 163.19694819301367, 114.87588725239037, 121.81050304882226, 77.79878136701879, 132.51878186129025, 140.7652005627754, 108.62770472839475, 122.0880103930831, 112.45479739457369, 155.51600860804328, 104.4445683993399, 136.73577820509678, 144.27243508398527, 154.58753555640592, 152.3973483145234, 155.01326132565717], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [44.96605738461949, 44.94873427832499, 44.91682194918394, 28.73571325202161, 27.456419895092637, 28.241693953673035, 31.92178340752919, 31.66394895066817, 30.748779495557145, 29.005625903606415, 29.36517572402954, 29.107357546687126, 35.49861018359661, 35.72712753713131, 35.91690710559487, 37.62106045087178, 38.34477051099141, 38.63830377285679, 43.58872420589128, 43.39347358296314, 43.637772500204534, 38.79590336481729, 39.18572604904571, 39.338107521335274, 41.79651366764058, 41.317127381761864, 40.262997557719544, 37.151180674632386, 37.326471378405884, 37.23241614301999, 43.489845293263585, 43.17926050225893, 43.88671218479672, 47.6252098828554, 48.094371452927575, 47.79130303114651, 41.25118117158611, 40.733668630321816, 41.193385527779654, 38.885737504810095, 39.116807110607624, 39.1212278008461, 37.85227638591701, 37.76554632621506, 37.27215665082136, 36.671864335735634, 37.1233868052562, 36.56047577162583, 40.20258624354997, 40.96803622568646, 41.03458915154138, 44.344934940338135, 44.43310369551182, 44.636348474770784, 41.903934828937054, 42.173523508012295, 41.700475603342056, 41.42730714877446, 43.206292671461895, 43.19905305405457, 21.148416871825845, 21.218298772970826, 21.39331868539253, 43.206883927186325, 43.623752293487385, 43.7597994202127, 59.16682641704877, 58.76439057042201, 59.20943206859131, 39.44927437106767, 39.24358462790647, 39.25707658628622, 38.45464149862528, 38.54397876560688, 38.817823849618435, 46.184361916035414, 46.21342681720853, 45.99029675498605, 42.32637619972229, 42.78909756243229, 43.13644907809794, 44.49206496650973, 44.00794730583826, 44.66928712918403, 42.67102726424733, 42.334939452509076, 41.529720226923615, 39.113322163621575, 39.2440338085095, 38.67428485552469, 37.71131039659181, 38.108372940371424, 37.68504985670248, 44.10076501220465, 43.72208847105503, 44.2924878038466, 48.68967526654403, 49.071876425916955, 48.640073361496135, 46.18286426955213, 45.66052758445342, 46.16181596492727, 28.47304556146264, 28.354799054563046, 28.535684250295162, 49.80246417721112, 50.54616934185226, 50.61973906618853, 40.15424684683481, 40.650276011476905, 40.416920902828366, 47.77152112498878, 47.317143648862825, 47.35429429262875, 42.95334541161233, 42.592564287285, 42.03692803780237, 51.21145715688665, 50.8660430808862, 51.310515866925314, 49.75395769377549, 50.02094284196694, 48.95682968695958, 44.57168675400317, 44.15716240555048, 44.26140370219946, 42.36424272879958, 42.2522796690464, 41.974697075784206, 38.471429988741875, 38.70727664779406, 37.24362072348595, 37.55254257222016, 37.384976406892136, 37.910559100409344, 40.176588132977486, 40.60542513121254, 40.52196127735078, 46.778625053664044, 46.47954738636811, 46.174088706572846, 42.32033361991246, 42.29520623882611, 42.74974000950654, 48.74782203137873, 48.490315139293656, 49.08373798616229, 48.08718140671651, 47.971873576442405, 47.34189144770305, 30.340273961424828, 30.710043147206306, 29.961474895477295, 48.27889103194077, 48.36992896844943, 48.50495718171199, 37.78027183562517, 37.911033771932125, 37.89963550120592, 37.684599551682666, 37.67916863722105, 37.239270125826195, 53.366157342990235, 53.16020794709523, 53.792339493830994, 21.482362531125546, 21.37737785279751, 20.265986144542694, 50.409589435905204, 50.05226247757672, 50.42910345643757, 39.574317760144666, 39.09152370442946, 39.438998890419796, 42.98576923335591, 43.1055680780361, 43.10819654042521, 19.050497053811938, 18.827606714020163, 18.8084072942535, 56.960538581013665, 56.80417592823504, 57.03500648215412, 45.48300294702251, 45.61525795174141, 45.60625376676519, 43.612258193393544, 43.73957136770089, 43.78519980361064, 41.66154691949487, 41.40525113791227, 41.022324711084366, 50.115597655375794, 50.2198561069866, 50.024514493842915, 40.038741064568356, 40.142124240597084, 40.27495457914968, 42.8855609546105, 42.694822552303464, 42.956520712623984, 41.41555803331235, 40.95778513203064, 41.29332689071694, 36.362534319361046, 36.61686447014411, 36.95053710167606, 40.21176519989967, 40.49188235029578, 40.27279843762517, 47.59502991661428, 47.547375015914426, 47.24218384921549, 46.26552362763323, 45.55913197994232, 45.9639371111989, 43.573253522316605, 45.16157607982555, 44.754613558451325, 45.027603656674415, 43.69088993469873, 45.11795431903252, 42.466163026789815, 42.712001331771404, 42.478647405902535, 57.31397477785747, 57.35995648304622, 57.66076512510578, 56.39295982817809, 56.45015000055234, 56.69916377558063, 49.56980355021854, 49.01737122734387, 49.256117333968476, 38.368281727035836, 38.69751740743716, 37.961860229571656, 37.24574927985668, 37.27647411450744, 37.05483813583851, 50.759848873596624, 50.65671049803494, 50.47449868917464, 44.4678046653668, 45.16107532257834, 45.21655564258495, 31.727670485774667, 31.82922689119974, 32.117512019972, 54.614559729894, 54.240010922153786, 54.33389017482598, 53.61194498340289, 54.70318413774173, 54.88181907186906, 38.542700854440525, 38.53175092240174, 37.801435475548104, 40.443821306029946, 40.3349597553412, 41.03172198745111, 25.791031687209994, 26.019631928453833, 25.988117751354963, 43.82855015496412, 43.99636710683504, 44.69386459949115, 47.053344028691455, 47.16937158505122, 46.54248494903247, 36.675609577447176, 36.57761177420616, 35.37448337674141, 40.72341842204332, 40.64344474673271, 40.72114722430706, 37.71964533627033, 37.308320090174675, 37.42683196812868, 52.19637042035659, 51.18260735770066, 52.13703082998593, 34.89784161870678, 34.564159636696175, 34.98256714393695, 45.39908494055271, 45.59007092565298, 45.74662233889103, 48.099053775270775, 48.70505665739377, 47.46832465132077, 51.12724734346072, 51.74542829270165, 51.71485992024343, 49.67575094103812, 51.27915373444556, 51.44244363903998, 51.76312336077292, 51.619307224949196, 51.630830739935234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1420394736051778, "mean_inference_ms": 0.7011651394194922, "mean_action_processing_ms": 0.09655297452744988, "mean_env_wait_ms": 0.7883208358342345, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 910000, "timesteps_this_iter": 0, "agent_timesteps_total": 2730000, "timers": {"sample_time_ms": 10685.467, "sample_throughput": 467.925, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1981.37, "learn_throughput": 2523.507, "update_time_ms": 9.259}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2611686178923356e-45, "cur_lr": 0.0005000000000000001, "total_loss": 7.205114078521729, "policy_loss": -0.0015534382218309161, "vf_loss": 7.310885810852051, "vf_explained_var": 0.033922511339187625, "kl": 0.00216965665463732, "entropy": 10.421808815002441, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 910000, "num_agent_steps_sampled": 2730000, "num_steps_trained": 910000, "num_agent_steps_trained": 2730000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2496, "training_iteration": 182, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-34-12", "timestamp": 1706232852, "time_this_iter_s": 10.967977285385132, "time_total_s": 1965.3468825817108, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214025309D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1965.3468825817108, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 6.450000000000001, "ram_util_percent": 62.375}}
{"episode_reward_max": 177.14064905606216, "episode_reward_min": 56.6865110620856, "episode_reward_mean": 129.95424434276774, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 18.8084072942535}, "policy_reward_max": {"shared_policy": 59.20943206859131}, "policy_reward_mean": {"shared_policy": 43.318081447589236}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.5558179803192, 143.51088436692947, 123.17823532968758, 117.12377241626382, 112.88997936295343, 110.35572691261767, 122.20521162077782, 133.41438711062048, 125.7779339402914, 127.83265287429093, 63.7600343301892, 130.59043564088643, 177.14064905606216, 117.94993558526036, 115.8164441138506, 138.3880854882299, 128.25192284025252, 133.16929940153196, 126.53568694368002, 117.03164082765576, 113.50473319366571, 132.11534128710656, 146.401625053957, 138.00520781893283, 85.36352886632085, 150.96837258525184, 121.22144376114008, 142.44295906648043, 127.58283773669969, 153.38801610469827, 148.73173022270203, 132.99025286175316, 126.59121947363019, 114.42232736002188, 112.84807807952164, 121.30397454154081, 139.4322611466049, 127.36527986824511, 146.32187515683458, 143.4009464308619, 91.01179200410843, 145.15377718210217, 113.59094110876322, 112.60303831472991, 160.3187047839167, 63.12572652846575, 150.8909553699195, 118.10484035499393, 129.19953385181722, 56.6865110620856, 170.79972099140258, 136.70451466552913, 131.13702936470509, 124.0891227684915, 150.35996825620566, 120.45581988431512, 128.53690421953786, 123.66667005605993, 109.92993589118122, 120.97644598782063, 142.38458878174407, 137.78859271877437, 133.48944316059328, 133.8364479104058, 127.65681176446375, 172.33469638600934, 169.54227360431108, 147.84329211153107, 115.02765936404465, 111.57706153020263, 151.8910580608064, 134.84543563053003, 95.6744093969464, 163.18846082687398, 163.19694819301367, 114.87588725239037, 121.81050304882226, 77.79878136701879, 132.51878186129025, 140.7652005627754, 108.62770472839475, 122.0880103930831, 112.45479739457369, 155.51600860804328, 104.4445683993399, 136.73577820509678, 144.27243508398527, 154.58753555640592, 152.3973483145234, 155.01326132565717, 167.07440909743298, 115.93414939567444, 125.3749039657414, 136.30686190724393, 170.636714942753, 123.59341531991959, 120.40002898126838, 161.05083180963993, 158.262451864779, 105.38418604619798], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [43.489845293263585, 43.17926050225893, 43.88671218479672, 47.6252098828554, 48.094371452927575, 47.79130303114651, 41.25118117158611, 40.733668630321816, 41.193385527779654, 38.885737504810095, 39.116807110607624, 39.1212278008461, 37.85227638591701, 37.76554632621506, 37.27215665082136, 36.671864335735634, 37.1233868052562, 36.56047577162583, 40.20258624354997, 40.96803622568646, 41.03458915154138, 44.344934940338135, 44.43310369551182, 44.636348474770784, 41.903934828937054, 42.173523508012295, 41.700475603342056, 41.42730714877446, 43.206292671461895, 43.19905305405457, 21.148416871825845, 21.218298772970826, 21.39331868539253, 43.206883927186325, 43.623752293487385, 43.7597994202127, 59.16682641704877, 58.76439057042201, 59.20943206859131, 39.44927437106767, 39.24358462790647, 39.25707658628622, 38.45464149862528, 38.54397876560688, 38.817823849618435, 46.184361916035414, 46.21342681720853, 45.99029675498605, 42.32637619972229, 42.78909756243229, 43.13644907809794, 44.49206496650973, 44.00794730583826, 44.66928712918403, 42.67102726424733, 42.334939452509076, 41.529720226923615, 39.113322163621575, 39.2440338085095, 38.67428485552469, 37.71131039659181, 38.108372940371424, 37.68504985670248, 44.10076501220465, 43.72208847105503, 44.2924878038466, 48.68967526654403, 49.071876425916955, 48.640073361496135, 46.18286426955213, 45.66052758445342, 46.16181596492727, 28.47304556146264, 28.354799054563046, 28.535684250295162, 49.80246417721112, 50.54616934185226, 50.61973906618853, 40.15424684683481, 40.650276011476905, 40.416920902828366, 47.77152112498878, 47.317143648862825, 47.35429429262875, 42.95334541161233, 42.592564287285, 42.03692803780237, 51.21145715688665, 50.8660430808862, 51.310515866925314, 49.75395769377549, 50.02094284196694, 48.95682968695958, 44.57168675400317, 44.15716240555048, 44.26140370219946, 42.36424272879958, 42.2522796690464, 41.974697075784206, 38.471429988741875, 38.70727664779406, 37.24362072348595, 37.55254257222016, 37.384976406892136, 37.910559100409344, 40.176588132977486, 40.60542513121254, 40.52196127735078, 46.778625053664044, 46.47954738636811, 46.174088706572846, 42.32033361991246, 42.29520623882611, 42.74974000950654, 48.74782203137873, 48.490315139293656, 49.08373798616229, 48.08718140671651, 47.971873576442405, 47.34189144770305, 30.340273961424828, 30.710043147206306, 29.961474895477295, 48.27889103194077, 48.36992896844943, 48.50495718171199, 37.78027183562517, 37.911033771932125, 37.89963550120592, 37.684599551682666, 37.67916863722105, 37.239270125826195, 53.366157342990235, 53.16020794709523, 53.792339493830994, 21.482362531125546, 21.37737785279751, 20.265986144542694, 50.409589435905204, 50.05226247757672, 50.42910345643757, 39.574317760144666, 39.09152370442946, 39.438998890419796, 42.98576923335591, 43.1055680780361, 43.10819654042521, 19.050497053811938, 18.827606714020163, 18.8084072942535, 56.960538581013665, 56.80417592823504, 57.03500648215412, 45.48300294702251, 45.61525795174141, 45.60625376676519, 43.612258193393544, 43.73957136770089, 43.78519980361064, 41.66154691949487, 41.40525113791227, 41.022324711084366, 50.115597655375794, 50.2198561069866, 50.024514493842915, 40.038741064568356, 40.142124240597084, 40.27495457914968, 42.8855609546105, 42.694822552303464, 42.956520712623984, 41.41555803331235, 40.95778513203064, 41.29332689071694, 36.362534319361046, 36.61686447014411, 36.95053710167606, 40.21176519989967, 40.49188235029578, 40.27279843762517, 47.59502991661428, 47.547375015914426, 47.24218384921549, 46.26552362763323, 45.55913197994232, 45.9639371111989, 43.573253522316605, 45.16157607982555, 44.754613558451325, 45.027603656674415, 43.69088993469873, 45.11795431903252, 42.466163026789815, 42.712001331771404, 42.478647405902535, 57.31397477785747, 57.35995648304622, 57.66076512510578, 56.39295982817809, 56.45015000055234, 56.69916377558063, 49.56980355021854, 49.01737122734387, 49.256117333968476, 38.368281727035836, 38.69751740743716, 37.961860229571656, 37.24574927985668, 37.27647411450744, 37.05483813583851, 50.759848873596624, 50.65671049803494, 50.47449868917464, 44.4678046653668, 45.16107532257834, 45.21655564258495, 31.727670485774667, 31.82922689119974, 32.117512019972, 54.614559729894, 54.240010922153786, 54.33389017482598, 53.61194498340289, 54.70318413774173, 54.88181907186906, 38.542700854440525, 38.53175092240174, 37.801435475548104, 40.443821306029946, 40.3349597553412, 41.03172198745111, 25.791031687209994, 26.019631928453833, 25.988117751354963, 43.82855015496412, 43.99636710683504, 44.69386459949115, 47.053344028691455, 47.16937158505122, 46.54248494903247, 36.675609577447176, 36.57761177420616, 35.37448337674141, 40.72341842204332, 40.64344474673271, 40.72114722430706, 37.71964533627033, 37.308320090174675, 37.42683196812868, 52.19637042035659, 51.18260735770066, 52.13703082998593, 34.89784161870678, 34.564159636696175, 34.98256714393695, 45.39908494055271, 45.59007092565298, 45.74662233889103, 48.099053775270775, 48.70505665739377, 47.46832465132077, 51.12724734346072, 51.74542829270165, 51.71485992024343, 49.67575094103812, 51.27915373444556, 51.44244363903998, 51.76312336077292, 51.619307224949196, 51.630830739935234, 56.0405684535702, 55.804858831067875, 55.228981812795, 38.80779195452729, 38.65007126579681, 38.47628617535034, 41.37026520073414, 41.82541811466217, 42.17922065034509, 45.38272787133852, 45.58552865187326, 45.33860538403192, 56.63132970035075, 57.140761174261556, 56.86462406814097, 40.87089650332928, 41.27561567351222, 41.44690314307809, 40.06962256754437, 40.11719001705447, 40.21321639666954, 53.6347103441755, 53.692916962007686, 53.723204503456756, 52.86808623497684, 52.72711137806375, 52.667254251738385, 35.25705459403494, 34.94579715530077, 35.181334296862275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14203987386452685, "mean_inference_ms": 0.7012347787593957, "mean_action_processing_ms": 0.09655835465826655, "mean_env_wait_ms": 0.7882509174180667, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 915000, "timesteps_this_iter": 0, "agent_timesteps_total": 2745000, "timers": {"sample_time_ms": 10707.08, "sample_throughput": 466.981, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1990.541, "learn_throughput": 2511.88, "update_time_ms": 9.36}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.305843089461678e-46, "cur_lr": 0.0005000000000000001, "total_loss": 8.997146701812744, "policy_loss": -0.0013296556309238205, "vf_loss": 9.10334062576294, "vf_explained_var": 0.01852477788925171, "kl": 0.0026856693788941738, "entropy": 10.48641004562378, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 915000, "num_agent_steps_sampled": 2745000, "num_steps_trained": 915000, "num_agent_steps_trained": 2745000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2506, "training_iteration": 183, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-34-23", "timestamp": 1706232863, "time_this_iter_s": 10.758153915405273, "time_total_s": 1976.105036497116, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402530550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1976.105036497116, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 5.8533333333333335, "ram_util_percent": 62.39999999999999}}
{"episode_reward_max": 177.14064905606216, "episode_reward_min": -208.9071680381894, "episode_reward_mean": 126.18705073203292, "episode_len_mean": 499.61, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.19345593452454}, "policy_reward_max": {"shared_policy": 59.20943206859131}, "policy_reward_mean": {"shared_policy": 42.06235024401096}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.7600343301892, 130.59043564088643, 177.14064905606216, 117.94993558526036, 115.8164441138506, 138.3880854882299, 128.25192284025252, 133.16929940153196, 126.53568694368002, 117.03164082765576, 113.50473319366571, 132.11534128710656, 146.401625053957, 138.00520781893283, 85.36352886632085, 150.96837258525184, 121.22144376114008, 142.44295906648043, 127.58283773669969, 153.38801610469827, 148.73173022270203, 132.99025286175316, 126.59121947363019, 114.42232736002188, 112.84807807952164, 121.30397454154081, 139.4322611466049, 127.36527986824511, 146.32187515683458, 143.4009464308619, 91.01179200410843, 145.15377718210217, 113.59094110876322, 112.60303831472991, 160.3187047839167, 63.12572652846575, 150.8909553699195, 118.10484035499393, 129.19953385181722, 56.6865110620856, 170.79972099140258, 136.70451466552913, 131.13702936470509, 124.0891227684915, 150.35996825620566, 120.45581988431512, 128.53690421953786, 123.66667005605993, 109.92993589118122, 120.97644598782063, 142.38458878174407, 137.78859271877437, 133.48944316059328, 133.8364479104058, 127.65681176446375, 172.33469638600934, 169.54227360431108, 147.84329211153107, 115.02765936404465, 111.57706153020263, 151.8910580608064, 134.84543563053003, 95.6744093969464, 163.18846082687398, 163.19694819301367, 114.87588725239037, 121.81050304882226, 77.79878136701879, 132.51878186129025, 140.7652005627754, 108.62770472839475, 122.0880103930831, 112.45479739457369, 155.51600860804328, 104.4445683993399, 136.73577820509678, 144.27243508398527, 154.58753555640592, 152.3973483145234, 155.01326132565717, 167.07440909743298, 115.93414939567444, 125.3749039657414, 136.30686190724393, 170.636714942753, 123.59341531991959, 120.40002898126838, 161.05083180963993, 158.262451864779, 105.38418604619798, -208.9071680381894, 119.72441890090703, 125.83370623365042, 167.1234822794796, 113.28220886489723, 128.12238762527704, 97.42183430120346, 159.1254272796212, 79.14176699891684, 89.25717639550567], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 461, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [21.148416871825845, 21.218298772970826, 21.39331868539253, 43.206883927186325, 43.623752293487385, 43.7597994202127, 59.16682641704877, 58.76439057042201, 59.20943206859131, 39.44927437106767, 39.24358462790647, 39.25707658628622, 38.45464149862528, 38.54397876560688, 38.817823849618435, 46.184361916035414, 46.21342681720853, 45.99029675498605, 42.32637619972229, 42.78909756243229, 43.13644907809794, 44.49206496650973, 44.00794730583826, 44.66928712918403, 42.67102726424733, 42.334939452509076, 41.529720226923615, 39.113322163621575, 39.2440338085095, 38.67428485552469, 37.71131039659181, 38.108372940371424, 37.68504985670248, 44.10076501220465, 43.72208847105503, 44.2924878038466, 48.68967526654403, 49.071876425916955, 48.640073361496135, 46.18286426955213, 45.66052758445342, 46.16181596492727, 28.47304556146264, 28.354799054563046, 28.535684250295162, 49.80246417721112, 50.54616934185226, 50.61973906618853, 40.15424684683481, 40.650276011476905, 40.416920902828366, 47.77152112498878, 47.317143648862825, 47.35429429262875, 42.95334541161233, 42.592564287285, 42.03692803780237, 51.21145715688665, 50.8660430808862, 51.310515866925314, 49.75395769377549, 50.02094284196694, 48.95682968695958, 44.57168675400317, 44.15716240555048, 44.26140370219946, 42.36424272879958, 42.2522796690464, 41.974697075784206, 38.471429988741875, 38.70727664779406, 37.24362072348595, 37.55254257222016, 37.384976406892136, 37.910559100409344, 40.176588132977486, 40.60542513121254, 40.52196127735078, 46.778625053664044, 46.47954738636811, 46.174088706572846, 42.32033361991246, 42.29520623882611, 42.74974000950654, 48.74782203137873, 48.490315139293656, 49.08373798616229, 48.08718140671651, 47.971873576442405, 47.34189144770305, 30.340273961424828, 30.710043147206306, 29.961474895477295, 48.27889103194077, 48.36992896844943, 48.50495718171199, 37.78027183562517, 37.911033771932125, 37.89963550120592, 37.684599551682666, 37.67916863722105, 37.239270125826195, 53.366157342990235, 53.16020794709523, 53.792339493830994, 21.482362531125546, 21.37737785279751, 20.265986144542694, 50.409589435905204, 50.05226247757672, 50.42910345643757, 39.574317760144666, 39.09152370442946, 39.438998890419796, 42.98576923335591, 43.1055680780361, 43.10819654042521, 19.050497053811938, 18.827606714020163, 18.8084072942535, 56.960538581013665, 56.80417592823504, 57.03500648215412, 45.48300294702251, 45.61525795174141, 45.60625376676519, 43.612258193393544, 43.73957136770089, 43.78519980361064, 41.66154691949487, 41.40525113791227, 41.022324711084366, 50.115597655375794, 50.2198561069866, 50.024514493842915, 40.038741064568356, 40.142124240597084, 40.27495457914968, 42.8855609546105, 42.694822552303464, 42.956520712623984, 41.41555803331235, 40.95778513203064, 41.29332689071694, 36.362534319361046, 36.61686447014411, 36.95053710167606, 40.21176519989967, 40.49188235029578, 40.27279843762517, 47.59502991661428, 47.547375015914426, 47.24218384921549, 46.26552362763323, 45.55913197994232, 45.9639371111989, 43.573253522316605, 45.16157607982555, 44.754613558451325, 45.027603656674415, 43.69088993469873, 45.11795431903252, 42.466163026789815, 42.712001331771404, 42.478647405902535, 57.31397477785747, 57.35995648304622, 57.66076512510578, 56.39295982817809, 56.45015000055234, 56.69916377558063, 49.56980355021854, 49.01737122734387, 49.256117333968476, 38.368281727035836, 38.69751740743716, 37.961860229571656, 37.24574927985668, 37.27647411450744, 37.05483813583851, 50.759848873596624, 50.65671049803494, 50.47449868917464, 44.4678046653668, 45.16107532257834, 45.21655564258495, 31.727670485774667, 31.82922689119974, 32.117512019972, 54.614559729894, 54.240010922153786, 54.33389017482598, 53.61194498340289, 54.70318413774173, 54.88181907186906, 38.542700854440525, 38.53175092240174, 37.801435475548104, 40.443821306029946, 40.3349597553412, 41.03172198745111, 25.791031687209994, 26.019631928453833, 25.988117751354963, 43.82855015496412, 43.99636710683504, 44.69386459949115, 47.053344028691455, 47.16937158505122, 46.54248494903247, 36.675609577447176, 36.57761177420616, 35.37448337674141, 40.72341842204332, 40.64344474673271, 40.72114722430706, 37.71964533627033, 37.308320090174675, 37.42683196812868, 52.19637042035659, 51.18260735770066, 52.13703082998593, 34.89784161870678, 34.564159636696175, 34.98256714393695, 45.39908494055271, 45.59007092565298, 45.74662233889103, 48.099053775270775, 48.70505665739377, 47.46832465132077, 51.12724734346072, 51.74542829270165, 51.71485992024343, 49.67575094103812, 51.27915373444556, 51.44244363903998, 51.76312336077292, 51.619307224949196, 51.630830739935234, 56.0405684535702, 55.804858831067875, 55.228981812795, 38.80779195452729, 38.65007126579681, 38.47628617535034, 41.37026520073414, 41.82541811466217, 42.17922065034509, 45.38272787133852, 45.58552865187326, 45.33860538403192, 56.63132970035075, 57.140761174261556, 56.86462406814097, 40.87089650332928, 41.27561567351222, 41.44690314307809, 40.06962256754437, 40.11719001705447, 40.21321639666954, 53.6347103441755, 53.692916962007686, 53.723204503456756, 52.86808623497684, 52.72711137806375, 52.667254251738385, 35.25705459403494, 34.94579715530077, 35.181334296862275, -81.19345593452454, -63.891662165522575, -63.8220499381423, 39.84886090209086, 40.03421741475661, 39.84134058405955, 41.98719441021481, 42.15692442903915, 41.689587394396455, 55.197936624288545, 55.802041396498666, 56.12350425869225, 38.03562877328173, 37.73074863354364, 37.51583145807186, 42.57577535510063, 42.78369624912739, 42.76291602104902, 32.54294278721014, 32.05765994886556, 32.82123156512776, 53.27546278387307, 52.388945952057824, 53.46101854369043, 26.142516704897076, 26.485527000079543, 26.513723293940217, 29.896465564146638, 29.908358776941895, 29.452352054417133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14204449046403214, "mean_inference_ms": 0.7013170279848275, "mean_action_processing_ms": 0.09656466251583476, "mean_env_wait_ms": 0.7881912106560691, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 920000, "timesteps_this_iter": 0, "agent_timesteps_total": 2760000, "timers": {"sample_time_ms": 10740.403, "sample_throughput": 465.532, "load_time_ms": 0.101, "load_throughput": 49519527.745, "learn_time_ms": 1997.802, "learn_throughput": 2502.75, "update_time_ms": 9.192}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.152921544730839e-46, "cur_lr": 0.0005000000000000001, "total_loss": 126.51223602294922, "policy_loss": -0.0018433588009607149, "vf_loss": 126.61857757568359, "vf_explained_var": 0.04332567453384399, "kl": 0.0037884122110475303, "entropy": 10.449845218658448, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 920000, "num_agent_steps_sampled": 2760000, "num_steps_trained": 920000, "num_agent_steps_trained": 2760000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2516, "training_iteration": 184, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-34-34", "timestamp": 1706232874, "time_this_iter_s": 10.719758033752441, "time_total_s": 1986.8247945308685, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021402530790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1986.8247945308685, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 5.073333333333334, "ram_util_percent": 62.40666666666666}}
{"episode_reward_max": 172.33469638600934, "episode_reward_min": -208.9071680381894, "episode_reward_mean": 126.55694527429671, "episode_len_mean": 499.61, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.19345593452454}, "policy_reward_max": {"shared_policy": 57.66076512510578}, "policy_reward_mean": {"shared_policy": 42.18564842476557}, "custom_metrics": {}, "hist_stats": {"episode_reward": [113.50473319366571, 132.11534128710656, 146.401625053957, 138.00520781893283, 85.36352886632085, 150.96837258525184, 121.22144376114008, 142.44295906648043, 127.58283773669969, 153.38801610469827, 148.73173022270203, 132.99025286175316, 126.59121947363019, 114.42232736002188, 112.84807807952164, 121.30397454154081, 139.4322611466049, 127.36527986824511, 146.32187515683458, 143.4009464308619, 91.01179200410843, 145.15377718210217, 113.59094110876322, 112.60303831472991, 160.3187047839167, 63.12572652846575, 150.8909553699195, 118.10484035499393, 129.19953385181722, 56.6865110620856, 170.79972099140258, 136.70451466552913, 131.13702936470509, 124.0891227684915, 150.35996825620566, 120.45581988431512, 128.53690421953786, 123.66667005605993, 109.92993589118122, 120.97644598782063, 142.38458878174407, 137.78859271877437, 133.48944316059328, 133.8364479104058, 127.65681176446375, 172.33469638600934, 169.54227360431108, 147.84329211153107, 115.02765936404465, 111.57706153020263, 151.8910580608064, 134.84543563053003, 95.6744093969464, 163.18846082687398, 163.19694819301367, 114.87588725239037, 121.81050304882226, 77.79878136701879, 132.51878186129025, 140.7652005627754, 108.62770472839475, 122.0880103930831, 112.45479739457369, 155.51600860804328, 104.4445683993399, 136.73577820509678, 144.27243508398527, 154.58753555640592, 152.3973483145234, 155.01326132565717, 167.07440909743298, 115.93414939567444, 125.3749039657414, 136.30686190724393, 170.636714942753, 123.59341531991959, 120.40002898126838, 161.05083180963993, 158.262451864779, 105.38418604619798, -208.9071680381894, 119.72441890090703, 125.83370623365042, 167.1234822794796, 113.28220886489723, 128.12238762527704, 97.42183430120346, 159.1254272796212, 79.14176699891684, 89.25717639550567, 149.56714747473598, 108.96165432222186, 131.7435516715051, 131.25479070097185, 108.18398344703019, 151.2809245213869, 101.8785449564457, 154.9553985632955, 154.30777625367094, 93.48981654271482], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 461, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [37.71131039659181, 38.108372940371424, 37.68504985670248, 44.10076501220465, 43.72208847105503, 44.2924878038466, 48.68967526654403, 49.071876425916955, 48.640073361496135, 46.18286426955213, 45.66052758445342, 46.16181596492727, 28.47304556146264, 28.354799054563046, 28.535684250295162, 49.80246417721112, 50.54616934185226, 50.61973906618853, 40.15424684683481, 40.650276011476905, 40.416920902828366, 47.77152112498878, 47.317143648862825, 47.35429429262875, 42.95334541161233, 42.592564287285, 42.03692803780237, 51.21145715688665, 50.8660430808862, 51.310515866925314, 49.75395769377549, 50.02094284196694, 48.95682968695958, 44.57168675400317, 44.15716240555048, 44.26140370219946, 42.36424272879958, 42.2522796690464, 41.974697075784206, 38.471429988741875, 38.70727664779406, 37.24362072348595, 37.55254257222016, 37.384976406892136, 37.910559100409344, 40.176588132977486, 40.60542513121254, 40.52196127735078, 46.778625053664044, 46.47954738636811, 46.174088706572846, 42.32033361991246, 42.29520623882611, 42.74974000950654, 48.74782203137873, 48.490315139293656, 49.08373798616229, 48.08718140671651, 47.971873576442405, 47.34189144770305, 30.340273961424828, 30.710043147206306, 29.961474895477295, 48.27889103194077, 48.36992896844943, 48.50495718171199, 37.78027183562517, 37.911033771932125, 37.89963550120592, 37.684599551682666, 37.67916863722105, 37.239270125826195, 53.366157342990235, 53.16020794709523, 53.792339493830994, 21.482362531125546, 21.37737785279751, 20.265986144542694, 50.409589435905204, 50.05226247757672, 50.42910345643757, 39.574317760144666, 39.09152370442946, 39.438998890419796, 42.98576923335591, 43.1055680780361, 43.10819654042521, 19.050497053811938, 18.827606714020163, 18.8084072942535, 56.960538581013665, 56.80417592823504, 57.03500648215412, 45.48300294702251, 45.61525795174141, 45.60625376676519, 43.612258193393544, 43.73957136770089, 43.78519980361064, 41.66154691949487, 41.40525113791227, 41.022324711084366, 50.115597655375794, 50.2198561069866, 50.024514493842915, 40.038741064568356, 40.142124240597084, 40.27495457914968, 42.8855609546105, 42.694822552303464, 42.956520712623984, 41.41555803331235, 40.95778513203064, 41.29332689071694, 36.362534319361046, 36.61686447014411, 36.95053710167606, 40.21176519989967, 40.49188235029578, 40.27279843762517, 47.59502991661428, 47.547375015914426, 47.24218384921549, 46.26552362763323, 45.55913197994232, 45.9639371111989, 43.573253522316605, 45.16157607982555, 44.754613558451325, 45.027603656674415, 43.69088993469873, 45.11795431903252, 42.466163026789815, 42.712001331771404, 42.478647405902535, 57.31397477785747, 57.35995648304622, 57.66076512510578, 56.39295982817809, 56.45015000055234, 56.69916377558063, 49.56980355021854, 49.01737122734387, 49.256117333968476, 38.368281727035836, 38.69751740743716, 37.961860229571656, 37.24574927985668, 37.27647411450744, 37.05483813583851, 50.759848873596624, 50.65671049803494, 50.47449868917464, 44.4678046653668, 45.16107532257834, 45.21655564258495, 31.727670485774667, 31.82922689119974, 32.117512019972, 54.614559729894, 54.240010922153786, 54.33389017482598, 53.61194498340289, 54.70318413774173, 54.88181907186906, 38.542700854440525, 38.53175092240174, 37.801435475548104, 40.443821306029946, 40.3349597553412, 41.03172198745111, 25.791031687209994, 26.019631928453833, 25.988117751354963, 43.82855015496412, 43.99636710683504, 44.69386459949115, 47.053344028691455, 47.16937158505122, 46.54248494903247, 36.675609577447176, 36.57761177420616, 35.37448337674141, 40.72341842204332, 40.64344474673271, 40.72114722430706, 37.71964533627033, 37.308320090174675, 37.42683196812868, 52.19637042035659, 51.18260735770066, 52.13703082998593, 34.89784161870678, 34.564159636696175, 34.98256714393695, 45.39908494055271, 45.59007092565298, 45.74662233889103, 48.099053775270775, 48.70505665739377, 47.46832465132077, 51.12724734346072, 51.74542829270165, 51.71485992024343, 49.67575094103812, 51.27915373444556, 51.44244363903998, 51.76312336077292, 51.619307224949196, 51.630830739935234, 56.0405684535702, 55.804858831067875, 55.228981812795, 38.80779195452729, 38.65007126579681, 38.47628617535034, 41.37026520073414, 41.82541811466217, 42.17922065034509, 45.38272787133852, 45.58552865187326, 45.33860538403192, 56.63132970035075, 57.140761174261556, 56.86462406814097, 40.87089650332928, 41.27561567351222, 41.44690314307809, 40.06962256754437, 40.11719001705447, 40.21321639666954, 53.6347103441755, 53.692916962007686, 53.723204503456756, 52.86808623497684, 52.72711137806375, 52.667254251738385, 35.25705459403494, 34.94579715530077, 35.181334296862275, -81.19345593452454, -63.891662165522575, -63.8220499381423, 39.84886090209086, 40.03421741475661, 39.84134058405955, 41.98719441021481, 42.15692442903915, 41.689587394396455, 55.197936624288545, 55.802041396498666, 56.12350425869225, 38.03562877328173, 37.73074863354364, 37.51583145807186, 42.57577535510063, 42.78369624912739, 42.76291602104902, 32.54294278721014, 32.05765994886556, 32.82123156512776, 53.27546278387307, 52.388945952057824, 53.46101854369043, 26.142516704897076, 26.485527000079543, 26.513723293940217, 29.896465564146638, 29.908358776941895, 29.452352054417133, 49.87334588542579, 49.919082857668386, 49.774718731641755, 36.36259400223692, 36.41825893831749, 36.18080138166745, 44.0675021186471, 43.70976737141609, 43.966282181441784, 43.824218230942876, 43.74197037766376, 43.688602092365414, 36.30350571870804, 35.41840475797653, 36.462072970345616, 50.70176940162976, 50.031518076856926, 50.54763704289992, 34.27348127216101, 33.33236300945282, 34.27270067483187, 51.98113638038437, 51.35857076446216, 51.61569141844909, 51.57794840385516, 51.1592065145572, 51.57062133525808, 30.633089517553643, 31.308700454731778, 31.5480265704294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1420523559584389, "mean_inference_ms": 0.7014491416082995, "mean_action_processing_ms": 0.09657222254268229, "mean_env_wait_ms": 0.7881741493002802, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 925000, "timesteps_this_iter": 0, "agent_timesteps_total": 2775000, "timers": {"sample_time_ms": 10835.673, "sample_throughput": 461.439, "load_time_ms": 0.201, "load_throughput": 24865449.372, "learn_time_ms": 2007.926, "learn_throughput": 2490.131, "update_time_ms": 9.186}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5764607723654194e-46, "cur_lr": 0.0005000000000000001, "total_loss": 8.02530312538147, "policy_loss": -0.0011110789450995639, "vf_loss": 8.131525897979737, "vf_explained_var": -0.013920223712921143, "kl": 0.002139301551557555, "entropy": 10.511181735992432, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 925000, "num_agent_steps_sampled": 2775000, "num_steps_trained": 925000, "num_agent_steps_trained": 2775000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2526, "training_iteration": 185, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-34-45", "timestamp": 1706232885, "time_this_iter_s": 11.30987811088562, "time_total_s": 1998.1346726417542, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214018EE820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1998.1346726417542, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 7.83125, "ram_util_percent": 62.487500000000004}}
{"episode_reward_max": 172.33469638600934, "episode_reward_min": -208.9071680381894, "episode_reward_mean": 127.54941859396531, "episode_len_mean": 499.61, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.19345593452454}, "policy_reward_max": {"shared_policy": 57.85890359307329}, "policy_reward_mean": {"shared_policy": 42.51647286465509}, "custom_metrics": {}, "hist_stats": {"episode_reward": [148.73173022270203, 132.99025286175316, 126.59121947363019, 114.42232736002188, 112.84807807952164, 121.30397454154081, 139.4322611466049, 127.36527986824511, 146.32187515683458, 143.4009464308619, 91.01179200410843, 145.15377718210217, 113.59094110876322, 112.60303831472991, 160.3187047839167, 63.12572652846575, 150.8909553699195, 118.10484035499393, 129.19953385181722, 56.6865110620856, 170.79972099140258, 136.70451466552913, 131.13702936470509, 124.0891227684915, 150.35996825620566, 120.45581988431512, 128.53690421953786, 123.66667005605993, 109.92993589118122, 120.97644598782063, 142.38458878174407, 137.78859271877437, 133.48944316059328, 133.8364479104058, 127.65681176446375, 172.33469638600934, 169.54227360431108, 147.84329211153107, 115.02765936404465, 111.57706153020263, 151.8910580608064, 134.84543563053003, 95.6744093969464, 163.18846082687398, 163.19694819301367, 114.87588725239037, 121.81050304882226, 77.79878136701879, 132.51878186129025, 140.7652005627754, 108.62770472839475, 122.0880103930831, 112.45479739457369, 155.51600860804328, 104.4445683993399, 136.73577820509678, 144.27243508398527, 154.58753555640592, 152.3973483145234, 155.01326132565717, 167.07440909743298, 115.93414939567444, 125.3749039657414, 136.30686190724393, 170.636714942753, 123.59341531991959, 120.40002898126838, 161.05083180963993, 158.262451864779, 105.38418604619798, -208.9071680381894, 119.72441890090703, 125.83370623365042, 167.1234822794796, 113.28220886489723, 128.12238762527704, 97.42183430120346, 159.1254272796212, 79.14176699891684, 89.25717639550567, 149.56714747473598, 108.96165432222186, 131.7435516715051, 131.25479070097185, 108.18398344703019, 151.2809245213869, 101.8785449564457, 154.9553985632955, 154.30777625367094, 93.48981654271482, 138.4643217418341, 133.24109837226598, 120.44891484826802, 121.85287006944417, 127.8739700920232, 133.08537671994418, 170.19483866542575, 158.822721862234, 134.24329464137546, 172.0139904282987], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 461, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [49.75395769377549, 50.02094284196694, 48.95682968695958, 44.57168675400317, 44.15716240555048, 44.26140370219946, 42.36424272879958, 42.2522796690464, 41.974697075784206, 38.471429988741875, 38.70727664779406, 37.24362072348595, 37.55254257222016, 37.384976406892136, 37.910559100409344, 40.176588132977486, 40.60542513121254, 40.52196127735078, 46.778625053664044, 46.47954738636811, 46.174088706572846, 42.32033361991246, 42.29520623882611, 42.74974000950654, 48.74782203137873, 48.490315139293656, 49.08373798616229, 48.08718140671651, 47.971873576442405, 47.34189144770305, 30.340273961424828, 30.710043147206306, 29.961474895477295, 48.27889103194077, 48.36992896844943, 48.50495718171199, 37.78027183562517, 37.911033771932125, 37.89963550120592, 37.684599551682666, 37.67916863722105, 37.239270125826195, 53.366157342990235, 53.16020794709523, 53.792339493830994, 21.482362531125546, 21.37737785279751, 20.265986144542694, 50.409589435905204, 50.05226247757672, 50.42910345643757, 39.574317760144666, 39.09152370442946, 39.438998890419796, 42.98576923335591, 43.1055680780361, 43.10819654042521, 19.050497053811938, 18.827606714020163, 18.8084072942535, 56.960538581013665, 56.80417592823504, 57.03500648215412, 45.48300294702251, 45.61525795174141, 45.60625376676519, 43.612258193393544, 43.73957136770089, 43.78519980361064, 41.66154691949487, 41.40525113791227, 41.022324711084366, 50.115597655375794, 50.2198561069866, 50.024514493842915, 40.038741064568356, 40.142124240597084, 40.27495457914968, 42.8855609546105, 42.694822552303464, 42.956520712623984, 41.41555803331235, 40.95778513203064, 41.29332689071694, 36.362534319361046, 36.61686447014411, 36.95053710167606, 40.21176519989967, 40.49188235029578, 40.27279843762517, 47.59502991661428, 47.547375015914426, 47.24218384921549, 46.26552362763323, 45.55913197994232, 45.9639371111989, 43.573253522316605, 45.16157607982555, 44.754613558451325, 45.027603656674415, 43.69088993469873, 45.11795431903252, 42.466163026789815, 42.712001331771404, 42.478647405902535, 57.31397477785747, 57.35995648304622, 57.66076512510578, 56.39295982817809, 56.45015000055234, 56.69916377558063, 49.56980355021854, 49.01737122734387, 49.256117333968476, 38.368281727035836, 38.69751740743716, 37.961860229571656, 37.24574927985668, 37.27647411450744, 37.05483813583851, 50.759848873596624, 50.65671049803494, 50.47449868917464, 44.4678046653668, 45.16107532257834, 45.21655564258495, 31.727670485774667, 31.82922689119974, 32.117512019972, 54.614559729894, 54.240010922153786, 54.33389017482598, 53.61194498340289, 54.70318413774173, 54.88181907186906, 38.542700854440525, 38.53175092240174, 37.801435475548104, 40.443821306029946, 40.3349597553412, 41.03172198745111, 25.791031687209994, 26.019631928453833, 25.988117751354963, 43.82855015496412, 43.99636710683504, 44.69386459949115, 47.053344028691455, 47.16937158505122, 46.54248494903247, 36.675609577447176, 36.57761177420616, 35.37448337674141, 40.72341842204332, 40.64344474673271, 40.72114722430706, 37.71964533627033, 37.308320090174675, 37.42683196812868, 52.19637042035659, 51.18260735770066, 52.13703082998593, 34.89784161870678, 34.564159636696175, 34.98256714393695, 45.39908494055271, 45.59007092565298, 45.74662233889103, 48.099053775270775, 48.70505665739377, 47.46832465132077, 51.12724734346072, 51.74542829270165, 51.71485992024343, 49.67575094103812, 51.27915373444556, 51.44244363903998, 51.76312336077292, 51.619307224949196, 51.630830739935234, 56.0405684535702, 55.804858831067875, 55.228981812795, 38.80779195452729, 38.65007126579681, 38.47628617535034, 41.37026520073414, 41.82541811466217, 42.17922065034509, 45.38272787133852, 45.58552865187326, 45.33860538403192, 56.63132970035075, 57.140761174261556, 56.86462406814097, 40.87089650332928, 41.27561567351222, 41.44690314307809, 40.06962256754437, 40.11719001705447, 40.21321639666954, 53.6347103441755, 53.692916962007686, 53.723204503456756, 52.86808623497684, 52.72711137806375, 52.667254251738385, 35.25705459403494, 34.94579715530077, 35.181334296862275, -81.19345593452454, -63.891662165522575, -63.8220499381423, 39.84886090209086, 40.03421741475661, 39.84134058405955, 41.98719441021481, 42.15692442903915, 41.689587394396455, 55.197936624288545, 55.802041396498666, 56.12350425869225, 38.03562877328173, 37.73074863354364, 37.51583145807186, 42.57577535510063, 42.78369624912739, 42.76291602104902, 32.54294278721014, 32.05765994886556, 32.82123156512776, 53.27546278387307, 52.388945952057824, 53.46101854369043, 26.142516704897076, 26.485527000079543, 26.513723293940217, 29.896465564146638, 29.908358776941895, 29.452352054417133, 49.87334588542579, 49.919082857668386, 49.774718731641755, 36.36259400223692, 36.41825893831749, 36.18080138166745, 44.0675021186471, 43.70976737141609, 43.966282181441784, 43.824218230942876, 43.74197037766376, 43.688602092365414, 36.30350571870804, 35.41840475797653, 36.462072970345616, 50.70176940162976, 50.031518076856926, 50.54763704289992, 34.27348127216101, 33.33236300945282, 34.27270067483187, 51.98113638038437, 51.35857076446216, 51.61569141844909, 51.57794840385516, 51.1592065145572, 51.57062133525808, 30.633089517553643, 31.308700454731778, 31.5480265704294, 45.83911143740018, 46.36723205012579, 46.2579782543083, 43.87299330532551, 44.82961237989366, 44.53849268704653, 40.57910817613204, 40.4830940713485, 39.386712600787476, 39.85057949026425, 41.01837520425518, 40.983915374924734, 42.28266144792238, 42.847729404826765, 42.743579239274055, 44.30192418769002, 44.22518803179264, 44.55826450046152, 56.77917427817981, 56.7989962125818, 56.616668174664184, 53.24760177327941, 53.224157827595874, 52.3509622613589, 44.73498687396446, 44.755565638343484, 44.75274212906757, 57.85890359307329, 56.98634145657222, 57.16874537865321]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14205939710133364, "mean_inference_ms": 0.7015964900362244, "mean_action_processing_ms": 0.09658069441905864, "mean_env_wait_ms": 0.788164307354179, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 930000, "timesteps_this_iter": 0, "agent_timesteps_total": 2790000, "timers": {"sample_time_ms": 10864.652, "sample_throughput": 460.208, "load_time_ms": 0.201, "load_throughput": 24865449.372, "learn_time_ms": 2014.086, "learn_throughput": 2482.515, "update_time_ms": 9.232}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.882303861827097e-47, "cur_lr": 0.0005000000000000001, "total_loss": 9.77108449935913, "policy_loss": -0.0005597806433717434, "vf_loss": 9.875786018371581, "vf_explained_var": 0.021324771642684936, "kl": 0.0022616058413914685, "entropy": 10.414164829254151, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 930000, "num_agent_steps_sampled": 2790000, "num_steps_trained": 930000, "num_agent_steps_trained": 2790000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2536, "training_iteration": 186, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-34-56", "timestamp": 1706232896, "time_this_iter_s": 10.424275398254395, "time_total_s": 2008.5589480400085, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140239E4C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2008.5589480400085, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 6.866666666666666, "ram_util_percent": 62.359999999999985}}
{"episode_reward_max": 172.33469638600934, "episode_reward_min": -208.9071680381894, "episode_reward_mean": 127.67695151360658, "episode_len_mean": 499.61, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.19345593452454}, "policy_reward_max": {"shared_policy": 57.85890359307329}, "policy_reward_mean": {"shared_policy": 42.55898383786885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.01179200410843, 145.15377718210217, 113.59094110876322, 112.60303831472991, 160.3187047839167, 63.12572652846575, 150.8909553699195, 118.10484035499393, 129.19953385181722, 56.6865110620856, 170.79972099140258, 136.70451466552913, 131.13702936470509, 124.0891227684915, 150.35996825620566, 120.45581988431512, 128.53690421953786, 123.66667005605993, 109.92993589118122, 120.97644598782063, 142.38458878174407, 137.78859271877437, 133.48944316059328, 133.8364479104058, 127.65681176446375, 172.33469638600934, 169.54227360431108, 147.84329211153107, 115.02765936404465, 111.57706153020263, 151.8910580608064, 134.84543563053003, 95.6744093969464, 163.18846082687398, 163.19694819301367, 114.87588725239037, 121.81050304882226, 77.79878136701879, 132.51878186129025, 140.7652005627754, 108.62770472839475, 122.0880103930831, 112.45479739457369, 155.51600860804328, 104.4445683993399, 136.73577820509678, 144.27243508398527, 154.58753555640592, 152.3973483145234, 155.01326132565717, 167.07440909743298, 115.93414939567444, 125.3749039657414, 136.30686190724393, 170.636714942753, 123.59341531991959, 120.40002898126838, 161.05083180963993, 158.262451864779, 105.38418604619798, -208.9071680381894, 119.72441890090703, 125.83370623365042, 167.1234822794796, 113.28220886489723, 128.12238762527704, 97.42183430120346, 159.1254272796212, 79.14176699891684, 89.25717639550567, 149.56714747473598, 108.96165432222186, 131.7435516715051, 131.25479070097185, 108.18398344703019, 151.2809245213869, 101.8785449564457, 154.9553985632955, 154.30777625367094, 93.48981654271482, 138.4643217418341, 133.24109837226598, 120.44891484826802, 121.85287006944417, 127.8739700920232, 133.08537671994418, 170.19483866542575, 158.822721862234, 134.24329464137546, 172.0139904282987, 129.96277204900983, 119.90983150526881, 92.8483328106813, 131.15271588414913, 155.69067961408265, 162.84283413738007, 112.32746344432235, 157.46051509678352, 152.13209614902743, 111.83399641513823], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 461, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [30.340273961424828, 30.710043147206306, 29.961474895477295, 48.27889103194077, 48.36992896844943, 48.50495718171199, 37.78027183562517, 37.911033771932125, 37.89963550120592, 37.684599551682666, 37.67916863722105, 37.239270125826195, 53.366157342990235, 53.16020794709523, 53.792339493830994, 21.482362531125546, 21.37737785279751, 20.265986144542694, 50.409589435905204, 50.05226247757672, 50.42910345643757, 39.574317760144666, 39.09152370442946, 39.438998890419796, 42.98576923335591, 43.1055680780361, 43.10819654042521, 19.050497053811938, 18.827606714020163, 18.8084072942535, 56.960538581013665, 56.80417592823504, 57.03500648215412, 45.48300294702251, 45.61525795174141, 45.60625376676519, 43.612258193393544, 43.73957136770089, 43.78519980361064, 41.66154691949487, 41.40525113791227, 41.022324711084366, 50.115597655375794, 50.2198561069866, 50.024514493842915, 40.038741064568356, 40.142124240597084, 40.27495457914968, 42.8855609546105, 42.694822552303464, 42.956520712623984, 41.41555803331235, 40.95778513203064, 41.29332689071694, 36.362534319361046, 36.61686447014411, 36.95053710167606, 40.21176519989967, 40.49188235029578, 40.27279843762517, 47.59502991661428, 47.547375015914426, 47.24218384921549, 46.26552362763323, 45.55913197994232, 45.9639371111989, 43.573253522316605, 45.16157607982555, 44.754613558451325, 45.027603656674415, 43.69088993469873, 45.11795431903252, 42.466163026789815, 42.712001331771404, 42.478647405902535, 57.31397477785747, 57.35995648304622, 57.66076512510578, 56.39295982817809, 56.45015000055234, 56.69916377558063, 49.56980355021854, 49.01737122734387, 49.256117333968476, 38.368281727035836, 38.69751740743716, 37.961860229571656, 37.24574927985668, 37.27647411450744, 37.05483813583851, 50.759848873596624, 50.65671049803494, 50.47449868917464, 44.4678046653668, 45.16107532257834, 45.21655564258495, 31.727670485774667, 31.82922689119974, 32.117512019972, 54.614559729894, 54.240010922153786, 54.33389017482598, 53.61194498340289, 54.70318413774173, 54.88181907186906, 38.542700854440525, 38.53175092240174, 37.801435475548104, 40.443821306029946, 40.3349597553412, 41.03172198745111, 25.791031687209994, 26.019631928453833, 25.988117751354963, 43.82855015496412, 43.99636710683504, 44.69386459949115, 47.053344028691455, 47.16937158505122, 46.54248494903247, 36.675609577447176, 36.57761177420616, 35.37448337674141, 40.72341842204332, 40.64344474673271, 40.72114722430706, 37.71964533627033, 37.308320090174675, 37.42683196812868, 52.19637042035659, 51.18260735770066, 52.13703082998593, 34.89784161870678, 34.564159636696175, 34.98256714393695, 45.39908494055271, 45.59007092565298, 45.74662233889103, 48.099053775270775, 48.70505665739377, 47.46832465132077, 51.12724734346072, 51.74542829270165, 51.71485992024343, 49.67575094103812, 51.27915373444556, 51.44244363903998, 51.76312336077292, 51.619307224949196, 51.630830739935234, 56.0405684535702, 55.804858831067875, 55.228981812795, 38.80779195452729, 38.65007126579681, 38.47628617535034, 41.37026520073414, 41.82541811466217, 42.17922065034509, 45.38272787133852, 45.58552865187326, 45.33860538403192, 56.63132970035075, 57.140761174261556, 56.86462406814097, 40.87089650332928, 41.27561567351222, 41.44690314307809, 40.06962256754437, 40.11719001705447, 40.21321639666954, 53.6347103441755, 53.692916962007686, 53.723204503456756, 52.86808623497684, 52.72711137806375, 52.667254251738385, 35.25705459403494, 34.94579715530077, 35.181334296862275, -81.19345593452454, -63.891662165522575, -63.8220499381423, 39.84886090209086, 40.03421741475661, 39.84134058405955, 41.98719441021481, 42.15692442903915, 41.689587394396455, 55.197936624288545, 55.802041396498666, 56.12350425869225, 38.03562877328173, 37.73074863354364, 37.51583145807186, 42.57577535510063, 42.78369624912739, 42.76291602104902, 32.54294278721014, 32.05765994886556, 32.82123156512776, 53.27546278387307, 52.388945952057824, 53.46101854369043, 26.142516704897076, 26.485527000079543, 26.513723293940217, 29.896465564146638, 29.908358776941895, 29.452352054417133, 49.87334588542579, 49.919082857668386, 49.774718731641755, 36.36259400223692, 36.41825893831749, 36.18080138166745, 44.0675021186471, 43.70976737141609, 43.966282181441784, 43.824218230942876, 43.74197037766376, 43.688602092365414, 36.30350571870804, 35.41840475797653, 36.462072970345616, 50.70176940162976, 50.031518076856926, 50.54763704289992, 34.27348127216101, 33.33236300945282, 34.27270067483187, 51.98113638038437, 51.35857076446216, 51.61569141844909, 51.57794840385516, 51.1592065145572, 51.57062133525808, 30.633089517553643, 31.308700454731778, 31.5480265704294, 45.83911143740018, 46.36723205012579, 46.2579782543083, 43.87299330532551, 44.82961237989366, 44.53849268704653, 40.57910817613204, 40.4830940713485, 39.386712600787476, 39.85057949026425, 41.01837520425518, 40.983915374924734, 42.28266144792238, 42.847729404826765, 42.743579239274055, 44.30192418769002, 44.22518803179264, 44.55826450046152, 56.77917427817981, 56.7989962125818, 56.616668174664184, 53.24760177327941, 53.224157827595874, 52.3509622613589, 44.73498687396446, 44.755565638343484, 44.75274212906757, 57.85890359307329, 56.98634145657222, 57.16874537865321, 43.35204831386605, 43.390510874489934, 43.22021286065379, 40.11421670392156, 39.94876782596111, 39.84684697538614, 30.76839932550986, 30.9239757930239, 31.15595769214754, 43.54785990466674, 43.62572823216517, 43.97912774731715, 52.3200455829501, 50.570036411285386, 52.80059761984738, 54.371722915520266, 54.0572992687424, 54.413811953117445, 37.373935364186764, 37.31629275530577, 37.63723532482982, 52.56337230652569, 52.54019600898026, 52.35694678127764, 50.798765957355485, 50.99280168861149, 50.34052850306033, 37.22601168354352, 37.43797053148349, 37.170014200111225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14206412817947153, "mean_inference_ms": 0.7017463134960112, "mean_action_processing_ms": 0.09658740055491785, "mean_env_wait_ms": 0.7881606370633719, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 935000, "timesteps_this_iter": 0, "agent_timesteps_total": 2805000, "timers": {"sample_time_ms": 10876.054, "sample_throughput": 459.726, "load_time_ms": 0.301, "load_throughput": 16608473.905, "learn_time_ms": 2001.922, "learn_throughput": 2497.6, "update_time_ms": 9.131}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.9411519309135486e-47, "cur_lr": 0.0005000000000000001, "total_loss": 8.712351322174072, "policy_loss": -0.00025857496296519675, "vf_loss": 8.818651866912841, "vf_explained_var": 0.004067212343215942, "kl": 0.003428694396333144, "entropy": 10.604174423217774, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 935000, "num_agent_steps_sampled": 2805000, "num_steps_trained": 935000, "num_agent_steps_trained": 2805000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2546, "training_iteration": 187, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-35-06", "timestamp": 1706232906, "time_this_iter_s": 10.72360610961914, "time_total_s": 2019.2825541496277, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401A7A3A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2019.2825541496277, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 6.640000000000001, "ram_util_percent": 62.37999999999999}}
{"episode_reward_max": 172.33469638600934, "episode_reward_min": -208.9071680381894, "episode_reward_mean": 129.0185773263448, "episode_len_mean": 499.61, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.19345593452454}, "policy_reward_max": {"shared_policy": 57.85890359307329}, "policy_reward_mean": {"shared_policy": 43.00619244211493}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.79972099140258, 136.70451466552913, 131.13702936470509, 124.0891227684915, 150.35996825620566, 120.45581988431512, 128.53690421953786, 123.66667005605993, 109.92993589118122, 120.97644598782063, 142.38458878174407, 137.78859271877437, 133.48944316059328, 133.8364479104058, 127.65681176446375, 172.33469638600934, 169.54227360431108, 147.84329211153107, 115.02765936404465, 111.57706153020263, 151.8910580608064, 134.84543563053003, 95.6744093969464, 163.18846082687398, 163.19694819301367, 114.87588725239037, 121.81050304882226, 77.79878136701879, 132.51878186129025, 140.7652005627754, 108.62770472839475, 122.0880103930831, 112.45479739457369, 155.51600860804328, 104.4445683993399, 136.73577820509678, 144.27243508398527, 154.58753555640592, 152.3973483145234, 155.01326132565717, 167.07440909743298, 115.93414939567444, 125.3749039657414, 136.30686190724393, 170.636714942753, 123.59341531991959, 120.40002898126838, 161.05083180963993, 158.262451864779, 105.38418604619798, -208.9071680381894, 119.72441890090703, 125.83370623365042, 167.1234822794796, 113.28220886489723, 128.12238762527704, 97.42183430120346, 159.1254272796212, 79.14176699891684, 89.25717639550567, 149.56714747473598, 108.96165432222186, 131.7435516715051, 131.25479070097185, 108.18398344703019, 151.2809245213869, 101.8785449564457, 154.9553985632955, 154.30777625367094, 93.48981654271482, 138.4643217418341, 133.24109837226598, 120.44891484826802, 121.85287006944417, 127.8739700920232, 133.08537671994418, 170.19483866542575, 158.822721862234, 134.24329464137546, 172.0139904282987, 129.96277204900983, 119.90983150526881, 92.8483328106813, 131.15271588414913, 155.69067961408265, 162.84283413738007, 112.32746344432235, 157.46051509678352, 152.13209614902743, 111.83399641513823, 117.71244540205223, 114.24330548383296, 138.98587009310722, 134.63148179743428, 121.63496644049883, 112.32441811915487, 168.69753722101444, 116.54420237243174, 131.48476827889698, 118.589406626299], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 461, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [56.960538581013665, 56.80417592823504, 57.03500648215412, 45.48300294702251, 45.61525795174141, 45.60625376676519, 43.612258193393544, 43.73957136770089, 43.78519980361064, 41.66154691949487, 41.40525113791227, 41.022324711084366, 50.115597655375794, 50.2198561069866, 50.024514493842915, 40.038741064568356, 40.142124240597084, 40.27495457914968, 42.8855609546105, 42.694822552303464, 42.956520712623984, 41.41555803331235, 40.95778513203064, 41.29332689071694, 36.362534319361046, 36.61686447014411, 36.95053710167606, 40.21176519989967, 40.49188235029578, 40.27279843762517, 47.59502991661428, 47.547375015914426, 47.24218384921549, 46.26552362763323, 45.55913197994232, 45.9639371111989, 43.573253522316605, 45.16157607982555, 44.754613558451325, 45.027603656674415, 43.69088993469873, 45.11795431903252, 42.466163026789815, 42.712001331771404, 42.478647405902535, 57.31397477785747, 57.35995648304622, 57.66076512510578, 56.39295982817809, 56.45015000055234, 56.69916377558063, 49.56980355021854, 49.01737122734387, 49.256117333968476, 38.368281727035836, 38.69751740743716, 37.961860229571656, 37.24574927985668, 37.27647411450744, 37.05483813583851, 50.759848873596624, 50.65671049803494, 50.47449868917464, 44.4678046653668, 45.16107532257834, 45.21655564258495, 31.727670485774667, 31.82922689119974, 32.117512019972, 54.614559729894, 54.240010922153786, 54.33389017482598, 53.61194498340289, 54.70318413774173, 54.88181907186906, 38.542700854440525, 38.53175092240174, 37.801435475548104, 40.443821306029946, 40.3349597553412, 41.03172198745111, 25.791031687209994, 26.019631928453833, 25.988117751354963, 43.82855015496412, 43.99636710683504, 44.69386459949115, 47.053344028691455, 47.16937158505122, 46.54248494903247, 36.675609577447176, 36.57761177420616, 35.37448337674141, 40.72341842204332, 40.64344474673271, 40.72114722430706, 37.71964533627033, 37.308320090174675, 37.42683196812868, 52.19637042035659, 51.18260735770066, 52.13703082998593, 34.89784161870678, 34.564159636696175, 34.98256714393695, 45.39908494055271, 45.59007092565298, 45.74662233889103, 48.099053775270775, 48.70505665739377, 47.46832465132077, 51.12724734346072, 51.74542829270165, 51.71485992024343, 49.67575094103812, 51.27915373444556, 51.44244363903998, 51.76312336077292, 51.619307224949196, 51.630830739935234, 56.0405684535702, 55.804858831067875, 55.228981812795, 38.80779195452729, 38.65007126579681, 38.47628617535034, 41.37026520073414, 41.82541811466217, 42.17922065034509, 45.38272787133852, 45.58552865187326, 45.33860538403192, 56.63132970035075, 57.140761174261556, 56.86462406814097, 40.87089650332928, 41.27561567351222, 41.44690314307809, 40.06962256754437, 40.11719001705447, 40.21321639666954, 53.6347103441755, 53.692916962007686, 53.723204503456756, 52.86808623497684, 52.72711137806375, 52.667254251738385, 35.25705459403494, 34.94579715530077, 35.181334296862275, -81.19345593452454, -63.891662165522575, -63.8220499381423, 39.84886090209086, 40.03421741475661, 39.84134058405955, 41.98719441021481, 42.15692442903915, 41.689587394396455, 55.197936624288545, 55.802041396498666, 56.12350425869225, 38.03562877328173, 37.73074863354364, 37.51583145807186, 42.57577535510063, 42.78369624912739, 42.76291602104902, 32.54294278721014, 32.05765994886556, 32.82123156512776, 53.27546278387307, 52.388945952057824, 53.46101854369043, 26.142516704897076, 26.485527000079543, 26.513723293940217, 29.896465564146638, 29.908358776941895, 29.452352054417133, 49.87334588542579, 49.919082857668386, 49.774718731641755, 36.36259400223692, 36.41825893831749, 36.18080138166745, 44.0675021186471, 43.70976737141609, 43.966282181441784, 43.824218230942876, 43.74197037766376, 43.688602092365414, 36.30350571870804, 35.41840475797653, 36.462072970345616, 50.70176940162976, 50.031518076856926, 50.54763704289992, 34.27348127216101, 33.33236300945282, 34.27270067483187, 51.98113638038437, 51.35857076446216, 51.61569141844909, 51.57794840385516, 51.1592065145572, 51.57062133525808, 30.633089517553643, 31.308700454731778, 31.5480265704294, 45.83911143740018, 46.36723205012579, 46.2579782543083, 43.87299330532551, 44.82961237989366, 44.53849268704653, 40.57910817613204, 40.4830940713485, 39.386712600787476, 39.85057949026425, 41.01837520425518, 40.983915374924734, 42.28266144792238, 42.847729404826765, 42.743579239274055, 44.30192418769002, 44.22518803179264, 44.55826450046152, 56.77917427817981, 56.7989962125818, 56.616668174664184, 53.24760177327941, 53.224157827595874, 52.3509622613589, 44.73498687396446, 44.755565638343484, 44.75274212906757, 57.85890359307329, 56.98634145657222, 57.16874537865321, 43.35204831386605, 43.390510874489934, 43.22021286065379, 40.11421670392156, 39.94876782596111, 39.84684697538614, 30.76839932550986, 30.9239757930239, 31.15595769214754, 43.54785990466674, 43.62572823216517, 43.97912774731715, 52.3200455829501, 50.570036411285386, 52.80059761984738, 54.371722915520266, 54.0572992687424, 54.413811953117445, 37.373935364186764, 37.31629275530577, 37.63723532482982, 52.56337230652569, 52.54019600898026, 52.35694678127764, 50.798765957355485, 50.99280168861149, 50.34052850306033, 37.22601168354352, 37.43797053148349, 37.170014200111225, 39.089258069793374, 39.22596419105926, 39.39722314119959, 38.02349131554365, 38.2541532907635, 37.965660877525806, 46.44070396323998, 46.45110489924748, 46.094061230619744, 44.8145365367333, 44.551581780115754, 45.26536348058531, 40.41033090651035, 40.704880483448505, 40.51975505053997, 37.78721174877137, 37.65910891070962, 36.87809745967388, 56.17206866542499, 56.2083678568403, 56.31710069874923, 39.028436725338295, 38.75975791116555, 38.756007735927895, 42.95233890414238, 44.52471699565649, 44.00771237909794, 39.643945696453244, 39.81732932167748, 39.128131608168275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14206696044961253, "mean_inference_ms": 0.7018380084194612, "mean_action_processing_ms": 0.09659137196684138, "mean_env_wait_ms": 0.7881175305641883, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 940000, "timesteps_this_iter": 0, "agent_timesteps_total": 2820000, "timers": {"sample_time_ms": 10771.498, "sample_throughput": 464.188, "load_time_ms": 0.301, "load_throughput": 16608473.905, "learn_time_ms": 1992.469, "learn_throughput": 2509.449, "update_time_ms": 9.201}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9705759654567743e-47, "cur_lr": 0.0005000000000000001, "total_loss": 6.23097791671753, "policy_loss": -0.0008414723043717931, "vf_loss": 6.337012815475464, "vf_explained_var": 0.0128079354763031, "kl": 0.0027080115164219705, "entropy": 10.519331550598144, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 940000, "num_agent_steps_sampled": 2820000, "num_steps_trained": 940000, "num_agent_steps_trained": 2820000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2556, "training_iteration": 188, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-35-16", "timestamp": 1706232916, "time_this_iter_s": 10.16058874130249, "time_total_s": 2029.4431428909302, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140234DC10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2029.4431428909302, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 5.22, "ram_util_percent": 62.29999999999999}}
{"episode_reward_max": 172.33469638600934, "episode_reward_min": -208.9071680381894, "episode_reward_mean": 128.9107550449758, "episode_len_mean": 499.61, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.19345593452454}, "policy_reward_max": {"shared_policy": 57.85890359307329}, "policy_reward_mean": {"shared_policy": 42.970251681658596}, "custom_metrics": {}, "hist_stats": {"episode_reward": [142.38458878174407, 137.78859271877437, 133.48944316059328, 133.8364479104058, 127.65681176446375, 172.33469638600934, 169.54227360431108, 147.84329211153107, 115.02765936404465, 111.57706153020263, 151.8910580608064, 134.84543563053003, 95.6744093969464, 163.18846082687398, 163.19694819301367, 114.87588725239037, 121.81050304882226, 77.79878136701879, 132.51878186129025, 140.7652005627754, 108.62770472839475, 122.0880103930831, 112.45479739457369, 155.51600860804328, 104.4445683993399, 136.73577820509678, 144.27243508398527, 154.58753555640592, 152.3973483145234, 155.01326132565717, 167.07440909743298, 115.93414939567444, 125.3749039657414, 136.30686190724393, 170.636714942753, 123.59341531991959, 120.40002898126838, 161.05083180963993, 158.262451864779, 105.38418604619798, -208.9071680381894, 119.72441890090703, 125.83370623365042, 167.1234822794796, 113.28220886489723, 128.12238762527704, 97.42183430120346, 159.1254272796212, 79.14176699891684, 89.25717639550567, 149.56714747473598, 108.96165432222186, 131.7435516715051, 131.25479070097185, 108.18398344703019, 151.2809245213869, 101.8785449564457, 154.9553985632955, 154.30777625367094, 93.48981654271482, 138.4643217418341, 133.24109837226598, 120.44891484826802, 121.85287006944417, 127.8739700920232, 133.08537671994418, 170.19483866542575, 158.822721862234, 134.24329464137546, 172.0139904282987, 129.96277204900983, 119.90983150526881, 92.8483328106813, 131.15271588414913, 155.69067961408265, 162.84283413738007, 112.32746344432235, 157.46051509678352, 152.13209614902743, 111.83399641513823, 117.71244540205223, 114.24330548383296, 138.98587009310722, 134.63148179743428, 121.63496644049883, 112.32441811915487, 168.69753722101444, 116.54420237243174, 131.48476827889698, 118.589406626299, 137.3461300581693, 143.41511983983204, 154.43417840823534, 124.97790260612963, 126.34799319505689, 131.59093887358907, 130.99404416233298, 112.53664133744313, 141.61258278135188, 102.6183726862073], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 461, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [47.59502991661428, 47.547375015914426, 47.24218384921549, 46.26552362763323, 45.55913197994232, 45.9639371111989, 43.573253522316605, 45.16157607982555, 44.754613558451325, 45.027603656674415, 43.69088993469873, 45.11795431903252, 42.466163026789815, 42.712001331771404, 42.478647405902535, 57.31397477785747, 57.35995648304622, 57.66076512510578, 56.39295982817809, 56.45015000055234, 56.69916377558063, 49.56980355021854, 49.01737122734387, 49.256117333968476, 38.368281727035836, 38.69751740743716, 37.961860229571656, 37.24574927985668, 37.27647411450744, 37.05483813583851, 50.759848873596624, 50.65671049803494, 50.47449868917464, 44.4678046653668, 45.16107532257834, 45.21655564258495, 31.727670485774667, 31.82922689119974, 32.117512019972, 54.614559729894, 54.240010922153786, 54.33389017482598, 53.61194498340289, 54.70318413774173, 54.88181907186906, 38.542700854440525, 38.53175092240174, 37.801435475548104, 40.443821306029946, 40.3349597553412, 41.03172198745111, 25.791031687209994, 26.019631928453833, 25.988117751354963, 43.82855015496412, 43.99636710683504, 44.69386459949115, 47.053344028691455, 47.16937158505122, 46.54248494903247, 36.675609577447176, 36.57761177420616, 35.37448337674141, 40.72341842204332, 40.64344474673271, 40.72114722430706, 37.71964533627033, 37.308320090174675, 37.42683196812868, 52.19637042035659, 51.18260735770066, 52.13703082998593, 34.89784161870678, 34.564159636696175, 34.98256714393695, 45.39908494055271, 45.59007092565298, 45.74662233889103, 48.099053775270775, 48.70505665739377, 47.46832465132077, 51.12724734346072, 51.74542829270165, 51.71485992024343, 49.67575094103812, 51.27915373444556, 51.44244363903998, 51.76312336077292, 51.619307224949196, 51.630830739935234, 56.0405684535702, 55.804858831067875, 55.228981812795, 38.80779195452729, 38.65007126579681, 38.47628617535034, 41.37026520073414, 41.82541811466217, 42.17922065034509, 45.38272787133852, 45.58552865187326, 45.33860538403192, 56.63132970035075, 57.140761174261556, 56.86462406814097, 40.87089650332928, 41.27561567351222, 41.44690314307809, 40.06962256754437, 40.11719001705447, 40.21321639666954, 53.6347103441755, 53.692916962007686, 53.723204503456756, 52.86808623497684, 52.72711137806375, 52.667254251738385, 35.25705459403494, 34.94579715530077, 35.181334296862275, -81.19345593452454, -63.891662165522575, -63.8220499381423, 39.84886090209086, 40.03421741475661, 39.84134058405955, 41.98719441021481, 42.15692442903915, 41.689587394396455, 55.197936624288545, 55.802041396498666, 56.12350425869225, 38.03562877328173, 37.73074863354364, 37.51583145807186, 42.57577535510063, 42.78369624912739, 42.76291602104902, 32.54294278721014, 32.05765994886556, 32.82123156512776, 53.27546278387307, 52.388945952057824, 53.46101854369043, 26.142516704897076, 26.485527000079543, 26.513723293940217, 29.896465564146638, 29.908358776941895, 29.452352054417133, 49.87334588542579, 49.919082857668386, 49.774718731641755, 36.36259400223692, 36.41825893831749, 36.18080138166745, 44.0675021186471, 43.70976737141609, 43.966282181441784, 43.824218230942876, 43.74197037766376, 43.688602092365414, 36.30350571870804, 35.41840475797653, 36.462072970345616, 50.70176940162976, 50.031518076856926, 50.54763704289992, 34.27348127216101, 33.33236300945282, 34.27270067483187, 51.98113638038437, 51.35857076446216, 51.61569141844909, 51.57794840385516, 51.1592065145572, 51.57062133525808, 30.633089517553643, 31.308700454731778, 31.5480265704294, 45.83911143740018, 46.36723205012579, 46.2579782543083, 43.87299330532551, 44.82961237989366, 44.53849268704653, 40.57910817613204, 40.4830940713485, 39.386712600787476, 39.85057949026425, 41.01837520425518, 40.983915374924734, 42.28266144792238, 42.847729404826765, 42.743579239274055, 44.30192418769002, 44.22518803179264, 44.55826450046152, 56.77917427817981, 56.7989962125818, 56.616668174664184, 53.24760177327941, 53.224157827595874, 52.3509622613589, 44.73498687396446, 44.755565638343484, 44.75274212906757, 57.85890359307329, 56.98634145657222, 57.16874537865321, 43.35204831386605, 43.390510874489934, 43.22021286065379, 40.11421670392156, 39.94876782596111, 39.84684697538614, 30.76839932550986, 30.9239757930239, 31.15595769214754, 43.54785990466674, 43.62572823216517, 43.97912774731715, 52.3200455829501, 50.570036411285386, 52.80059761984738, 54.371722915520266, 54.0572992687424, 54.413811953117445, 37.373935364186764, 37.31629275530577, 37.63723532482982, 52.56337230652569, 52.54019600898026, 52.35694678127764, 50.798765957355485, 50.99280168861149, 50.34052850306033, 37.22601168354352, 37.43797053148349, 37.170014200111225, 39.089258069793374, 39.22596419105926, 39.39722314119959, 38.02349131554365, 38.2541532907635, 37.965660877525806, 46.44070396323998, 46.45110489924748, 46.094061230619744, 44.8145365367333, 44.551581780115754, 45.26536348058531, 40.41033090651035, 40.704880483448505, 40.51975505053997, 37.78721174877137, 37.65910891070962, 36.87809745967388, 56.17206866542499, 56.2083678568403, 56.31710069874923, 39.028436725338295, 38.75975791116555, 38.756007735927895, 42.95233890414238, 44.52471699565649, 44.00771237909794, 39.643945696453244, 39.81732932167748, 39.128131608168275, 45.70937543114026, 45.610362132390335, 46.026392494638756, 47.4895647962888, 47.80312665303548, 48.12242839050789, 51.69659323121111, 51.33040265242259, 51.40718252460162, 41.29763962825139, 41.90802294885118, 41.77224002902706, 41.898709322015435, 42.26450269172588, 42.18478118131557, 44.149184378484875, 43.87380738059679, 43.56794711450735, 43.746335081756115, 43.76962399482727, 43.478085085749626, 37.24490748842557, 37.63570024756093, 37.65603360145663, 46.98149131983517, 47.501502864994094, 47.129588596522794, 34.36291538923979, 34.49086558818817, 33.764591708779335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1420739343806618, "mean_inference_ms": 0.7019242937216871, "mean_action_processing_ms": 0.09659595565154311, "mean_env_wait_ms": 0.7880786692554935, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 945000, "timesteps_this_iter": 0, "agent_timesteps_total": 2835000, "timers": {"sample_time_ms": 10764.39, "sample_throughput": 464.495, "load_time_ms": 0.401, "load_throughput": 12467463.29, "learn_time_ms": 2000.578, "learn_throughput": 2499.278, "update_time_ms": 9.6}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.852879827283871e-48, "cur_lr": 0.0005000000000000001, "total_loss": 8.902809333801269, "policy_loss": -0.0013692519969469962, "vf_loss": 9.010399627685548, "vf_explained_var": 0.04438983798027039, "kl": 0.002905881439856221, "entropy": 10.622094249725341, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 945000, "num_agent_steps_sampled": 2835000, "num_steps_trained": 945000, "num_agent_steps_trained": 2835000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2566, "training_iteration": 189, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-35-27", "timestamp": 1706232927, "time_this_iter_s": 10.380300045013428, "time_total_s": 2039.8234429359436, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D6ADC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2039.8234429359436, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 5.6428571428571415, "ram_util_percent": 62.35714285714285}}
{"episode_reward_max": 189.95466383546588, "episode_reward_min": -208.9071680381894, "episode_reward_mean": 128.13940516675657, "episode_len_mean": 499.61, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.19345593452454}, "policy_reward_max": {"shared_policy": 63.48271873593329}, "policy_reward_mean": {"shared_policy": 42.71313505558553}, "custom_metrics": {}, "hist_stats": {"episode_reward": [151.8910580608064, 134.84543563053003, 95.6744093969464, 163.18846082687398, 163.19694819301367, 114.87588725239037, 121.81050304882226, 77.79878136701879, 132.51878186129025, 140.7652005627754, 108.62770472839475, 122.0880103930831, 112.45479739457369, 155.51600860804328, 104.4445683993399, 136.73577820509678, 144.27243508398527, 154.58753555640592, 152.3973483145234, 155.01326132565717, 167.07440909743298, 115.93414939567444, 125.3749039657414, 136.30686190724393, 170.636714942753, 123.59341531991959, 120.40002898126838, 161.05083180963993, 158.262451864779, 105.38418604619798, -208.9071680381894, 119.72441890090703, 125.83370623365042, 167.1234822794796, 113.28220886489723, 128.12238762527704, 97.42183430120346, 159.1254272796212, 79.14176699891684, 89.25717639550567, 149.56714747473598, 108.96165432222186, 131.7435516715051, 131.25479070097185, 108.18398344703019, 151.2809245213869, 101.8785449564457, 154.9553985632955, 154.30777625367094, 93.48981654271482, 138.4643217418341, 133.24109837226598, 120.44891484826802, 121.85287006944417, 127.8739700920232, 133.08537671994418, 170.19483866542575, 158.822721862234, 134.24329464137546, 172.0139904282987, 129.96277204900983, 119.90983150526881, 92.8483328106813, 131.15271588414913, 155.69067961408265, 162.84283413738007, 112.32746344432235, 157.46051509678352, 152.13209614902743, 111.83399641513823, 117.71244540205223, 114.24330548383296, 138.98587009310722, 134.63148179743428, 121.63496644049883, 112.32441811915487, 168.69753722101444, 116.54420237243174, 131.48476827889698, 118.589406626299, 137.3461300581693, 143.41511983983204, 154.43417840823534, 124.97790260612963, 126.34799319505689, 131.59093887358907, 130.99404416233298, 112.53664133744313, 141.61258278135188, 102.6183726862073, 118.31988822668791, 134.30372320790764, 149.19723042845757, 133.33677591383434, 120.86192787997425, 107.2725901257945, 134.82933034747845, 147.18719753250502, 79.08255201205608, 189.95466383546588], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 461, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [50.759848873596624, 50.65671049803494, 50.47449868917464, 44.4678046653668, 45.16107532257834, 45.21655564258495, 31.727670485774667, 31.82922689119974, 32.117512019972, 54.614559729894, 54.240010922153786, 54.33389017482598, 53.61194498340289, 54.70318413774173, 54.88181907186906, 38.542700854440525, 38.53175092240174, 37.801435475548104, 40.443821306029946, 40.3349597553412, 41.03172198745111, 25.791031687209994, 26.019631928453833, 25.988117751354963, 43.82855015496412, 43.99636710683504, 44.69386459949115, 47.053344028691455, 47.16937158505122, 46.54248494903247, 36.675609577447176, 36.57761177420616, 35.37448337674141, 40.72341842204332, 40.64344474673271, 40.72114722430706, 37.71964533627033, 37.308320090174675, 37.42683196812868, 52.19637042035659, 51.18260735770066, 52.13703082998593, 34.89784161870678, 34.564159636696175, 34.98256714393695, 45.39908494055271, 45.59007092565298, 45.74662233889103, 48.099053775270775, 48.70505665739377, 47.46832465132077, 51.12724734346072, 51.74542829270165, 51.71485992024343, 49.67575094103812, 51.27915373444556, 51.44244363903998, 51.76312336077292, 51.619307224949196, 51.630830739935234, 56.0405684535702, 55.804858831067875, 55.228981812795, 38.80779195452729, 38.65007126579681, 38.47628617535034, 41.37026520073414, 41.82541811466217, 42.17922065034509, 45.38272787133852, 45.58552865187326, 45.33860538403192, 56.63132970035075, 57.140761174261556, 56.86462406814097, 40.87089650332928, 41.27561567351222, 41.44690314307809, 40.06962256754437, 40.11719001705447, 40.21321639666954, 53.6347103441755, 53.692916962007686, 53.723204503456756, 52.86808623497684, 52.72711137806375, 52.667254251738385, 35.25705459403494, 34.94579715530077, 35.181334296862275, -81.19345593452454, -63.891662165522575, -63.8220499381423, 39.84886090209086, 40.03421741475661, 39.84134058405955, 41.98719441021481, 42.15692442903915, 41.689587394396455, 55.197936624288545, 55.802041396498666, 56.12350425869225, 38.03562877328173, 37.73074863354364, 37.51583145807186, 42.57577535510063, 42.78369624912739, 42.76291602104902, 32.54294278721014, 32.05765994886556, 32.82123156512776, 53.27546278387307, 52.388945952057824, 53.46101854369043, 26.142516704897076, 26.485527000079543, 26.513723293940217, 29.896465564146638, 29.908358776941895, 29.452352054417133, 49.87334588542579, 49.919082857668386, 49.774718731641755, 36.36259400223692, 36.41825893831749, 36.18080138166745, 44.0675021186471, 43.70976737141609, 43.966282181441784, 43.824218230942876, 43.74197037766376, 43.688602092365414, 36.30350571870804, 35.41840475797653, 36.462072970345616, 50.70176940162976, 50.031518076856926, 50.54763704289992, 34.27348127216101, 33.33236300945282, 34.27270067483187, 51.98113638038437, 51.35857076446216, 51.61569141844909, 51.57794840385516, 51.1592065145572, 51.57062133525808, 30.633089517553643, 31.308700454731778, 31.5480265704294, 45.83911143740018, 46.36723205012579, 46.2579782543083, 43.87299330532551, 44.82961237989366, 44.53849268704653, 40.57910817613204, 40.4830940713485, 39.386712600787476, 39.85057949026425, 41.01837520425518, 40.983915374924734, 42.28266144792238, 42.847729404826765, 42.743579239274055, 44.30192418769002, 44.22518803179264, 44.55826450046152, 56.77917427817981, 56.7989962125818, 56.616668174664184, 53.24760177327941, 53.224157827595874, 52.3509622613589, 44.73498687396446, 44.755565638343484, 44.75274212906757, 57.85890359307329, 56.98634145657222, 57.16874537865321, 43.35204831386605, 43.390510874489934, 43.22021286065379, 40.11421670392156, 39.94876782596111, 39.84684697538614, 30.76839932550986, 30.9239757930239, 31.15595769214754, 43.54785990466674, 43.62572823216517, 43.97912774731715, 52.3200455829501, 50.570036411285386, 52.80059761984738, 54.371722915520266, 54.0572992687424, 54.413811953117445, 37.373935364186764, 37.31629275530577, 37.63723532482982, 52.56337230652569, 52.54019600898026, 52.35694678127764, 50.798765957355485, 50.99280168861149, 50.34052850306033, 37.22601168354352, 37.43797053148349, 37.170014200111225, 39.089258069793374, 39.22596419105926, 39.39722314119959, 38.02349131554365, 38.2541532907635, 37.965660877525806, 46.44070396323998, 46.45110489924748, 46.094061230619744, 44.8145365367333, 44.551581780115754, 45.26536348058531, 40.41033090651035, 40.704880483448505, 40.51975505053997, 37.78721174877137, 37.65910891070962, 36.87809745967388, 56.17206866542499, 56.2083678568403, 56.31710069874923, 39.028436725338295, 38.75975791116555, 38.756007735927895, 42.95233890414238, 44.52471699565649, 44.00771237909794, 39.643945696453244, 39.81732932167748, 39.128131608168275, 45.70937543114026, 45.610362132390335, 46.026392494638756, 47.4895647962888, 47.80312665303548, 48.12242839050789, 51.69659323121111, 51.33040265242259, 51.40718252460162, 41.29763962825139, 41.90802294885118, 41.77224002902706, 41.898709322015435, 42.26450269172588, 42.18478118131557, 44.149184378484875, 43.87380738059679, 43.56794711450735, 43.746335081756115, 43.76962399482727, 43.478085085749626, 37.24490748842557, 37.63570024756093, 37.65603360145663, 46.98149131983517, 47.501502864994094, 47.129588596522794, 34.36291538923979, 34.49086558818817, 33.764591708779335, 39.592938758432865, 39.23985302448273, 39.487096443772316, 44.991700719421104, 44.26306441922982, 45.04895806925681, 49.71249297757943, 49.657303546865776, 49.82743390401204, 44.34806993107, 44.48748705784479, 44.501218924919755, 40.16381182521582, 40.066482841968536, 40.63163321278989, 35.7083228851358, 35.54501252869764, 36.019254711961054, 45.046297043561935, 44.86037417501211, 44.92265912890434, 48.788118178645774, 49.028121384481594, 49.37095796937744, 26.466078045467526, 26.325610200564057, 26.2908637660245, 63.213870048522935, 63.48271873593329, 63.25807505100964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14208563585227124, "mean_inference_ms": 0.7020202398761112, "mean_action_processing_ms": 0.09659808766442073, "mean_env_wait_ms": 0.7880448075861601, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 950000, "timesteps_this_iter": 0, "agent_timesteps_total": 2850000, "timers": {"sample_time_ms": 10787.55, "sample_throughput": 463.497, "load_time_ms": 0.401, "load_throughput": 12467463.29, "learn_time_ms": 2004.344, "learn_throughput": 2494.581, "update_time_ms": 9.8}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.926439913641936e-48, "cur_lr": 0.0005000000000000001, "total_loss": 7.719930839538574, "policy_loss": -0.00033177207462724566, "vf_loss": 7.825987148284912, "vf_explained_var": -0.01782968044281006, "kl": 0.004135028924845913, "entropy": 10.572462463378907, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 950000, "num_agent_steps_sampled": 2850000, "num_steps_trained": 950000, "num_agent_steps_trained": 2850000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2576, "training_iteration": 190, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-35-37", "timestamp": 1706232937, "time_this_iter_s": 10.506167888641357, "time_total_s": 2050.329610824585, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D2D940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2050.329610824585, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 7.6800000000000015, "ram_util_percent": 62.35333333333333}}
{"episode_reward_max": 189.95466383546588, "episode_reward_min": -208.9071680381894, "episode_reward_mean": 128.39846122134836, "episode_len_mean": 499.61, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.19345593452454}, "policy_reward_max": {"shared_policy": 63.48271873593329}, "policy_reward_mean": {"shared_policy": 42.79948707378278}, "custom_metrics": {}, "hist_stats": {"episode_reward": [108.62770472839475, 122.0880103930831, 112.45479739457369, 155.51600860804328, 104.4445683993399, 136.73577820509678, 144.27243508398527, 154.58753555640592, 152.3973483145234, 155.01326132565717, 167.07440909743298, 115.93414939567444, 125.3749039657414, 136.30686190724393, 170.636714942753, 123.59341531991959, 120.40002898126838, 161.05083180963993, 158.262451864779, 105.38418604619798, -208.9071680381894, 119.72441890090703, 125.83370623365042, 167.1234822794796, 113.28220886489723, 128.12238762527704, 97.42183430120346, 159.1254272796212, 79.14176699891684, 89.25717639550567, 149.56714747473598, 108.96165432222186, 131.7435516715051, 131.25479070097185, 108.18398344703019, 151.2809245213869, 101.8785449564457, 154.9553985632955, 154.30777625367094, 93.48981654271482, 138.4643217418341, 133.24109837226598, 120.44891484826802, 121.85287006944417, 127.8739700920232, 133.08537671994418, 170.19483866542575, 158.822721862234, 134.24329464137546, 172.0139904282987, 129.96277204900983, 119.90983150526881, 92.8483328106813, 131.15271588414913, 155.69067961408265, 162.84283413738007, 112.32746344432235, 157.46051509678352, 152.13209614902743, 111.83399641513823, 117.71244540205223, 114.24330548383296, 138.98587009310722, 134.63148179743428, 121.63496644049883, 112.32441811915487, 168.69753722101444, 116.54420237243174, 131.48476827889698, 118.589406626299, 137.3461300581693, 143.41511983983204, 154.43417840823534, 124.97790260612963, 126.34799319505689, 131.59093887358907, 130.99404416233298, 112.53664133744313, 141.61258278135188, 102.6183726862073, 118.31988822668791, 134.30372320790764, 149.19723042845757, 133.33677591383434, 120.86192787997425, 107.2725901257945, 134.82933034747845, 147.18719753250502, 79.08255201205608, 189.95466383546588, 123.56300545856355, 133.55617113597688, 123.85940319066867, 148.2975862468592, 134.30356605350954, 140.27122129499924, 138.7998137511314, 108.75050289562202, 129.04755192622537, 142.02224970608978], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 461, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [36.675609577447176, 36.57761177420616, 35.37448337674141, 40.72341842204332, 40.64344474673271, 40.72114722430706, 37.71964533627033, 37.308320090174675, 37.42683196812868, 52.19637042035659, 51.18260735770066, 52.13703082998593, 34.89784161870678, 34.564159636696175, 34.98256714393695, 45.39908494055271, 45.59007092565298, 45.74662233889103, 48.099053775270775, 48.70505665739377, 47.46832465132077, 51.12724734346072, 51.74542829270165, 51.71485992024343, 49.67575094103812, 51.27915373444556, 51.44244363903998, 51.76312336077292, 51.619307224949196, 51.630830739935234, 56.0405684535702, 55.804858831067875, 55.228981812795, 38.80779195452729, 38.65007126579681, 38.47628617535034, 41.37026520073414, 41.82541811466217, 42.17922065034509, 45.38272787133852, 45.58552865187326, 45.33860538403192, 56.63132970035075, 57.140761174261556, 56.86462406814097, 40.87089650332928, 41.27561567351222, 41.44690314307809, 40.06962256754437, 40.11719001705447, 40.21321639666954, 53.6347103441755, 53.692916962007686, 53.723204503456756, 52.86808623497684, 52.72711137806375, 52.667254251738385, 35.25705459403494, 34.94579715530077, 35.181334296862275, -81.19345593452454, -63.891662165522575, -63.8220499381423, 39.84886090209086, 40.03421741475661, 39.84134058405955, 41.98719441021481, 42.15692442903915, 41.689587394396455, 55.197936624288545, 55.802041396498666, 56.12350425869225, 38.03562877328173, 37.73074863354364, 37.51583145807186, 42.57577535510063, 42.78369624912739, 42.76291602104902, 32.54294278721014, 32.05765994886556, 32.82123156512776, 53.27546278387307, 52.388945952057824, 53.46101854369043, 26.142516704897076, 26.485527000079543, 26.513723293940217, 29.896465564146638, 29.908358776941895, 29.452352054417133, 49.87334588542579, 49.919082857668386, 49.774718731641755, 36.36259400223692, 36.41825893831749, 36.18080138166745, 44.0675021186471, 43.70976737141609, 43.966282181441784, 43.824218230942876, 43.74197037766376, 43.688602092365414, 36.30350571870804, 35.41840475797653, 36.462072970345616, 50.70176940162976, 50.031518076856926, 50.54763704289992, 34.27348127216101, 33.33236300945282, 34.27270067483187, 51.98113638038437, 51.35857076446216, 51.61569141844909, 51.57794840385516, 51.1592065145572, 51.57062133525808, 30.633089517553643, 31.308700454731778, 31.5480265704294, 45.83911143740018, 46.36723205012579, 46.2579782543083, 43.87299330532551, 44.82961237989366, 44.53849268704653, 40.57910817613204, 40.4830940713485, 39.386712600787476, 39.85057949026425, 41.01837520425518, 40.983915374924734, 42.28266144792238, 42.847729404826765, 42.743579239274055, 44.30192418769002, 44.22518803179264, 44.55826450046152, 56.77917427817981, 56.7989962125818, 56.616668174664184, 53.24760177327941, 53.224157827595874, 52.3509622613589, 44.73498687396446, 44.755565638343484, 44.75274212906757, 57.85890359307329, 56.98634145657222, 57.16874537865321, 43.35204831386605, 43.390510874489934, 43.22021286065379, 40.11421670392156, 39.94876782596111, 39.84684697538614, 30.76839932550986, 30.9239757930239, 31.15595769214754, 43.54785990466674, 43.62572823216517, 43.97912774731715, 52.3200455829501, 50.570036411285386, 52.80059761984738, 54.371722915520266, 54.0572992687424, 54.413811953117445, 37.373935364186764, 37.31629275530577, 37.63723532482982, 52.56337230652569, 52.54019600898026, 52.35694678127764, 50.798765957355485, 50.99280168861149, 50.34052850306033, 37.22601168354352, 37.43797053148349, 37.170014200111225, 39.089258069793374, 39.22596419105926, 39.39722314119959, 38.02349131554365, 38.2541532907635, 37.965660877525806, 46.44070396323998, 46.45110489924748, 46.094061230619744, 44.8145365367333, 44.551581780115754, 45.26536348058531, 40.41033090651035, 40.704880483448505, 40.51975505053997, 37.78721174877137, 37.65910891070962, 36.87809745967388, 56.17206866542499, 56.2083678568403, 56.31710069874923, 39.028436725338295, 38.75975791116555, 38.756007735927895, 42.95233890414238, 44.52471699565649, 44.00771237909794, 39.643945696453244, 39.81732932167748, 39.128131608168275, 45.70937543114026, 45.610362132390335, 46.026392494638756, 47.4895647962888, 47.80312665303548, 48.12242839050789, 51.69659323121111, 51.33040265242259, 51.40718252460162, 41.29763962825139, 41.90802294885118, 41.77224002902706, 41.898709322015435, 42.26450269172588, 42.18478118131557, 44.149184378484875, 43.87380738059679, 43.56794711450735, 43.746335081756115, 43.76962399482727, 43.478085085749626, 37.24490748842557, 37.63570024756093, 37.65603360145663, 46.98149131983517, 47.501502864994094, 47.129588596522794, 34.36291538923979, 34.49086558818817, 33.764591708779335, 39.592938758432865, 39.23985302448273, 39.487096443772316, 44.991700719421104, 44.26306441922982, 45.04895806925681, 49.71249297757943, 49.657303546865776, 49.82743390401204, 44.34806993107, 44.48748705784479, 44.501218924919755, 40.16381182521582, 40.066482841968536, 40.63163321278989, 35.7083228851358, 35.54501252869764, 36.019254711961054, 45.046297043561935, 44.86037417501211, 44.92265912890434, 48.788118178645774, 49.028121384481594, 49.37095796937744, 26.466078045467526, 26.325610200564057, 26.2908637660245, 63.213870048522935, 63.48271873593329, 63.25807505100964, 40.85074474414189, 41.249668945868805, 41.462591768552855, 44.37559834122658, 44.74157820828259, 44.43899458646774, 40.76064956188202, 41.66836957028136, 41.4303840585053, 49.369392973681286, 49.61610077771668, 49.3120924954613, 44.906556787590176, 44.517039279143006, 44.8799699867765, 47.04407709588607, 46.41728489597638, 46.80985930313666, 46.456907896945864, 46.252089629570634, 46.09081622461477, 36.17743326226869, 35.78680274883905, 36.786266884514276, 43.26603994021812, 43.022290303061396, 42.75922168294588, 47.294005530575916, 47.3513590755562, 47.37688509995739]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14208807597836481, "mean_inference_ms": 0.7020861464527667, "mean_action_processing_ms": 0.09659759361865204, "mean_env_wait_ms": 0.7879833214602047, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 955000, "timesteps_this_iter": 0, "agent_timesteps_total": 2865000, "timers": {"sample_time_ms": 10728.19, "sample_throughput": 466.062, "load_time_ms": 0.401, "load_throughput": 12467463.29, "learn_time_ms": 2004.722, "learn_throughput": 2494.111, "update_time_ms": 9.846}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.463219956820968e-48, "cur_lr": 0.0005000000000000001, "total_loss": 7.601967906951904, "policy_loss": -0.0016018221459987991, "vf_loss": 7.708376121520996, "vf_explained_var": -0.0063944578170776365, "kl": 0.0034736823291109157, "entropy": 10.480649662017822, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 955000, "num_agent_steps_sampled": 2865000, "num_steps_trained": 955000, "num_agent_steps_trained": 2865000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2586, "training_iteration": 191, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-35-48", "timestamp": 1706232948, "time_this_iter_s": 10.969038724899292, "time_total_s": 2061.2986495494843, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D6A790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2061.2986495494843, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 7.1625, "ram_util_percent": 62.493750000000006}}
{"episode_reward_max": 189.95466383546588, "episode_reward_min": -208.9071680381894, "episode_reward_mean": 128.1213896974538, "episode_len_mean": 499.61, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.19345593452454}, "policy_reward_max": {"shared_policy": 63.48271873593329}, "policy_reward_mean": {"shared_policy": 42.70712989915126}, "custom_metrics": {}, "hist_stats": {"episode_reward": [167.07440909743298, 115.93414939567444, 125.3749039657414, 136.30686190724393, 170.636714942753, 123.59341531991959, 120.40002898126838, 161.05083180963993, 158.262451864779, 105.38418604619798, -208.9071680381894, 119.72441890090703, 125.83370623365042, 167.1234822794796, 113.28220886489723, 128.12238762527704, 97.42183430120346, 159.1254272796212, 79.14176699891684, 89.25717639550567, 149.56714747473598, 108.96165432222186, 131.7435516715051, 131.25479070097185, 108.18398344703019, 151.2809245213869, 101.8785449564457, 154.9553985632955, 154.30777625367094, 93.48981654271482, 138.4643217418341, 133.24109837226598, 120.44891484826802, 121.85287006944417, 127.8739700920232, 133.08537671994418, 170.19483866542575, 158.822721862234, 134.24329464137546, 172.0139904282987, 129.96277204900983, 119.90983150526881, 92.8483328106813, 131.15271588414913, 155.69067961408265, 162.84283413738007, 112.32746344432235, 157.46051509678352, 152.13209614902743, 111.83399641513823, 117.71244540205223, 114.24330548383296, 138.98587009310722, 134.63148179743428, 121.63496644049883, 112.32441811915487, 168.69753722101444, 116.54420237243174, 131.48476827889698, 118.589406626299, 137.3461300581693, 143.41511983983204, 154.43417840823534, 124.97790260612963, 126.34799319505689, 131.59093887358907, 130.99404416233298, 112.53664133744313, 141.61258278135188, 102.6183726862073, 118.31988822668791, 134.30372320790764, 149.19723042845757, 133.33677591383434, 120.86192787997425, 107.2725901257945, 134.82933034747845, 147.18719753250502, 79.08255201205608, 189.95466383546588, 123.56300545856355, 133.55617113597688, 123.85940319066867, 148.2975862468592, 134.30356605350954, 140.27122129499924, 138.7998137511314, 108.75050289562202, 129.04755192622537, 142.02224970608978, 127.80303195491432, 129.94338257610804, 131.32020952180022, 134.6042949929832, 134.6372993811965, 134.92680725455295, 76.45595247671007, 149.21390822343534, 159.42847852036323, 140.0969307175841], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 461, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [56.0405684535702, 55.804858831067875, 55.228981812795, 38.80779195452729, 38.65007126579681, 38.47628617535034, 41.37026520073414, 41.82541811466217, 42.17922065034509, 45.38272787133852, 45.58552865187326, 45.33860538403192, 56.63132970035075, 57.140761174261556, 56.86462406814097, 40.87089650332928, 41.27561567351222, 41.44690314307809, 40.06962256754437, 40.11719001705447, 40.21321639666954, 53.6347103441755, 53.692916962007686, 53.723204503456756, 52.86808623497684, 52.72711137806375, 52.667254251738385, 35.25705459403494, 34.94579715530077, 35.181334296862275, -81.19345593452454, -63.891662165522575, -63.8220499381423, 39.84886090209086, 40.03421741475661, 39.84134058405955, 41.98719441021481, 42.15692442903915, 41.689587394396455, 55.197936624288545, 55.802041396498666, 56.12350425869225, 38.03562877328173, 37.73074863354364, 37.51583145807186, 42.57577535510063, 42.78369624912739, 42.76291602104902, 32.54294278721014, 32.05765994886556, 32.82123156512776, 53.27546278387307, 52.388945952057824, 53.46101854369043, 26.142516704897076, 26.485527000079543, 26.513723293940217, 29.896465564146638, 29.908358776941895, 29.452352054417133, 49.87334588542579, 49.919082857668386, 49.774718731641755, 36.36259400223692, 36.41825893831749, 36.18080138166745, 44.0675021186471, 43.70976737141609, 43.966282181441784, 43.824218230942876, 43.74197037766376, 43.688602092365414, 36.30350571870804, 35.41840475797653, 36.462072970345616, 50.70176940162976, 50.031518076856926, 50.54763704289992, 34.27348127216101, 33.33236300945282, 34.27270067483187, 51.98113638038437, 51.35857076446216, 51.61569141844909, 51.57794840385516, 51.1592065145572, 51.57062133525808, 30.633089517553643, 31.308700454731778, 31.5480265704294, 45.83911143740018, 46.36723205012579, 46.2579782543083, 43.87299330532551, 44.82961237989366, 44.53849268704653, 40.57910817613204, 40.4830940713485, 39.386712600787476, 39.85057949026425, 41.01837520425518, 40.983915374924734, 42.28266144792238, 42.847729404826765, 42.743579239274055, 44.30192418769002, 44.22518803179264, 44.55826450046152, 56.77917427817981, 56.7989962125818, 56.616668174664184, 53.24760177327941, 53.224157827595874, 52.3509622613589, 44.73498687396446, 44.755565638343484, 44.75274212906757, 57.85890359307329, 56.98634145657222, 57.16874537865321, 43.35204831386605, 43.390510874489934, 43.22021286065379, 40.11421670392156, 39.94876782596111, 39.84684697538614, 30.76839932550986, 30.9239757930239, 31.15595769214754, 43.54785990466674, 43.62572823216517, 43.97912774731715, 52.3200455829501, 50.570036411285386, 52.80059761984738, 54.371722915520266, 54.0572992687424, 54.413811953117445, 37.373935364186764, 37.31629275530577, 37.63723532482982, 52.56337230652569, 52.54019600898026, 52.35694678127764, 50.798765957355485, 50.99280168861149, 50.34052850306033, 37.22601168354352, 37.43797053148349, 37.170014200111225, 39.089258069793374, 39.22596419105926, 39.39722314119959, 38.02349131554365, 38.2541532907635, 37.965660877525806, 46.44070396323998, 46.45110489924748, 46.094061230619744, 44.8145365367333, 44.551581780115754, 45.26536348058531, 40.41033090651035, 40.704880483448505, 40.51975505053997, 37.78721174877137, 37.65910891070962, 36.87809745967388, 56.17206866542499, 56.2083678568403, 56.31710069874923, 39.028436725338295, 38.75975791116555, 38.756007735927895, 42.95233890414238, 44.52471699565649, 44.00771237909794, 39.643945696453244, 39.81732932167748, 39.128131608168275, 45.70937543114026, 45.610362132390335, 46.026392494638756, 47.4895647962888, 47.80312665303548, 48.12242839050789, 51.69659323121111, 51.33040265242259, 51.40718252460162, 41.29763962825139, 41.90802294885118, 41.77224002902706, 41.898709322015435, 42.26450269172588, 42.18478118131557, 44.149184378484875, 43.87380738059679, 43.56794711450735, 43.746335081756115, 43.76962399482727, 43.478085085749626, 37.24490748842557, 37.63570024756093, 37.65603360145663, 46.98149131983517, 47.501502864994094, 47.129588596522794, 34.36291538923979, 34.49086558818817, 33.764591708779335, 39.592938758432865, 39.23985302448273, 39.487096443772316, 44.991700719421104, 44.26306441922982, 45.04895806925681, 49.71249297757943, 49.657303546865776, 49.82743390401204, 44.34806993107, 44.48748705784479, 44.501218924919755, 40.16381182521582, 40.066482841968536, 40.63163321278989, 35.7083228851358, 35.54501252869764, 36.019254711961054, 45.046297043561935, 44.86037417501211, 44.92265912890434, 48.788118178645774, 49.028121384481594, 49.37095796937744, 26.466078045467526, 26.325610200564057, 26.2908637660245, 63.213870048522935, 63.48271873593329, 63.25807505100964, 40.85074474414189, 41.249668945868805, 41.462591768552855, 44.37559834122658, 44.74157820828259, 44.43899458646774, 40.76064956188202, 41.66836957028136, 41.4303840585053, 49.369392973681286, 49.61610077771668, 49.3120924954613, 44.906556787590176, 44.517039279143006, 44.8799699867765, 47.04407709588607, 46.41728489597638, 46.80985930313666, 46.456907896945864, 46.252089629570634, 46.09081622461477, 36.17743326226869, 35.78680274883905, 36.786266884514276, 43.26603994021812, 43.022290303061396, 42.75922168294588, 47.294005530575916, 47.3513590755562, 47.37688509995739, 42.52958694597085, 42.519418244560555, 42.754026764382914, 43.38312968115011, 43.69729496041933, 42.862957934538514, 44.108992610126734, 43.9268234372139, 43.28439347445965, 44.9847702011466, 44.86744646728039, 44.75207832455635, 44.771659304698304, 44.92256554340322, 44.94307453309496, 44.58390408754349, 45.04737598448992, 45.295527182519436, 25.092890997727707, 25.576111552615956, 25.786949926366404, 49.5506475592653, 49.67183400938909, 49.99142665478091, 52.853360792001084, 53.490234316637114, 53.08488341172536, 46.96307486559574, 46.664369878669575, 46.46948597331841]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14208669300975038, "mean_inference_ms": 0.7021137589791544, "mean_action_processing_ms": 0.09659399438641544, "mean_env_wait_ms": 0.7878912823201474, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 960000, "timesteps_this_iter": 0, "agent_timesteps_total": 2880000, "timers": {"sample_time_ms": 10654.22, "sample_throughput": 469.298, "load_time_ms": 0.501, "load_throughput": 9980259.839, "learn_time_ms": 1998.953, "learn_throughput": 2501.31, "update_time_ms": 9.746}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.231609978410484e-48, "cur_lr": 0.0005000000000000001, "total_loss": 7.6050696849823, "policy_loss": -0.0009734622974802321, "vf_loss": 7.711900997161865, "vf_explained_var": 0.015069741010665893, "kl": 0.002340909821268742, "entropy": 10.58578863143921, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 960000, "num_agent_steps_sampled": 2880000, "num_steps_trained": 960000, "num_agent_steps_trained": 2880000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2596, "training_iteration": 192, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-35-59", "timestamp": 1706232959, "time_this_iter_s": 10.198581457138062, "time_total_s": 2071.4972310066223, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002146F7AC4C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2071.4972310066223, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 5.271428571428571, "ram_util_percent": 62.5}}
{"episode_reward_max": 189.95466383546588, "episode_reward_min": -208.9071680381894, "episode_reward_mean": 126.96938734035717, "episode_len_mean": 499.61, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.19345593452454}, "policy_reward_max": {"shared_policy": 63.48271873593329}, "policy_reward_mean": {"shared_policy": 42.32312911345238}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-208.9071680381894, 119.72441890090703, 125.83370623365042, 167.1234822794796, 113.28220886489723, 128.12238762527704, 97.42183430120346, 159.1254272796212, 79.14176699891684, 89.25717639550567, 149.56714747473598, 108.96165432222186, 131.7435516715051, 131.25479070097185, 108.18398344703019, 151.2809245213869, 101.8785449564457, 154.9553985632955, 154.30777625367094, 93.48981654271482, 138.4643217418341, 133.24109837226598, 120.44891484826802, 121.85287006944417, 127.8739700920232, 133.08537671994418, 170.19483866542575, 158.822721862234, 134.24329464137546, 172.0139904282987, 129.96277204900983, 119.90983150526881, 92.8483328106813, 131.15271588414913, 155.69067961408265, 162.84283413738007, 112.32746344432235, 157.46051509678352, 152.13209614902743, 111.83399641513823, 117.71244540205223, 114.24330548383296, 138.98587009310722, 134.63148179743428, 121.63496644049883, 112.32441811915487, 168.69753722101444, 116.54420237243174, 131.48476827889698, 118.589406626299, 137.3461300581693, 143.41511983983204, 154.43417840823534, 124.97790260612963, 126.34799319505689, 131.59093887358907, 130.99404416233298, 112.53664133744313, 141.61258278135188, 102.6183726862073, 118.31988822668791, 134.30372320790764, 149.19723042845757, 133.33677591383434, 120.86192787997425, 107.2725901257945, 134.82933034747845, 147.18719753250502, 79.08255201205608, 189.95466383546588, 123.56300545856355, 133.55617113597688, 123.85940319066867, 148.2975862468592, 134.30356605350954, 140.27122129499924, 138.7998137511314, 108.75050289562202, 129.04755192622537, 142.02224970608978, 127.80303195491432, 129.94338257610804, 131.32020952180022, 134.6042949929832, 134.6372993811965, 134.92680725455295, 76.45595247671007, 149.21390822343534, 159.42847852036323, 140.0969307175841, 145.7157351835632, 104.40288196119943, 95.92701550200582, 127.63511195266616, 167.74844400957198, 132.67585531622143, 117.37669446505606, 124.96460132300854, 119.9158586412668, 132.45551926642656], "episode_lengths": [461, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-81.19345593452454, -63.891662165522575, -63.8220499381423, 39.84886090209086, 40.03421741475661, 39.84134058405955, 41.98719441021481, 42.15692442903915, 41.689587394396455, 55.197936624288545, 55.802041396498666, 56.12350425869225, 38.03562877328173, 37.73074863354364, 37.51583145807186, 42.57577535510063, 42.78369624912739, 42.76291602104902, 32.54294278721014, 32.05765994886556, 32.82123156512776, 53.27546278387307, 52.388945952057824, 53.46101854369043, 26.142516704897076, 26.485527000079543, 26.513723293940217, 29.896465564146638, 29.908358776941895, 29.452352054417133, 49.87334588542579, 49.919082857668386, 49.774718731641755, 36.36259400223692, 36.41825893831749, 36.18080138166745, 44.0675021186471, 43.70976737141609, 43.966282181441784, 43.824218230942876, 43.74197037766376, 43.688602092365414, 36.30350571870804, 35.41840475797653, 36.462072970345616, 50.70176940162976, 50.031518076856926, 50.54763704289992, 34.27348127216101, 33.33236300945282, 34.27270067483187, 51.98113638038437, 51.35857076446216, 51.61569141844909, 51.57794840385516, 51.1592065145572, 51.57062133525808, 30.633089517553643, 31.308700454731778, 31.5480265704294, 45.83911143740018, 46.36723205012579, 46.2579782543083, 43.87299330532551, 44.82961237989366, 44.53849268704653, 40.57910817613204, 40.4830940713485, 39.386712600787476, 39.85057949026425, 41.01837520425518, 40.983915374924734, 42.28266144792238, 42.847729404826765, 42.743579239274055, 44.30192418769002, 44.22518803179264, 44.55826450046152, 56.77917427817981, 56.7989962125818, 56.616668174664184, 53.24760177327941, 53.224157827595874, 52.3509622613589, 44.73498687396446, 44.755565638343484, 44.75274212906757, 57.85890359307329, 56.98634145657222, 57.16874537865321, 43.35204831386605, 43.390510874489934, 43.22021286065379, 40.11421670392156, 39.94876782596111, 39.84684697538614, 30.76839932550986, 30.9239757930239, 31.15595769214754, 43.54785990466674, 43.62572823216517, 43.97912774731715, 52.3200455829501, 50.570036411285386, 52.80059761984738, 54.371722915520266, 54.0572992687424, 54.413811953117445, 37.373935364186764, 37.31629275530577, 37.63723532482982, 52.56337230652569, 52.54019600898026, 52.35694678127764, 50.798765957355485, 50.99280168861149, 50.34052850306033, 37.22601168354352, 37.43797053148349, 37.170014200111225, 39.089258069793374, 39.22596419105926, 39.39722314119959, 38.02349131554365, 38.2541532907635, 37.965660877525806, 46.44070396323998, 46.45110489924748, 46.094061230619744, 44.8145365367333, 44.551581780115754, 45.26536348058531, 40.41033090651035, 40.704880483448505, 40.51975505053997, 37.78721174877137, 37.65910891070962, 36.87809745967388, 56.17206866542499, 56.2083678568403, 56.31710069874923, 39.028436725338295, 38.75975791116555, 38.756007735927895, 42.95233890414238, 44.52471699565649, 44.00771237909794, 39.643945696453244, 39.81732932167748, 39.128131608168275, 45.70937543114026, 45.610362132390335, 46.026392494638756, 47.4895647962888, 47.80312665303548, 48.12242839050789, 51.69659323121111, 51.33040265242259, 51.40718252460162, 41.29763962825139, 41.90802294885118, 41.77224002902706, 41.898709322015435, 42.26450269172588, 42.18478118131557, 44.149184378484875, 43.87380738059679, 43.56794711450735, 43.746335081756115, 43.76962399482727, 43.478085085749626, 37.24490748842557, 37.63570024756093, 37.65603360145663, 46.98149131983517, 47.501502864994094, 47.129588596522794, 34.36291538923979, 34.49086558818817, 33.764591708779335, 39.592938758432865, 39.23985302448273, 39.487096443772316, 44.991700719421104, 44.26306441922982, 45.04895806925681, 49.71249297757943, 49.657303546865776, 49.82743390401204, 44.34806993107, 44.48748705784479, 44.501218924919755, 40.16381182521582, 40.066482841968536, 40.63163321278989, 35.7083228851358, 35.54501252869764, 36.019254711961054, 45.046297043561935, 44.86037417501211, 44.92265912890434, 48.788118178645774, 49.028121384481594, 49.37095796937744, 26.466078045467526, 26.325610200564057, 26.2908637660245, 63.213870048522935, 63.48271873593329, 63.25807505100964, 40.85074474414189, 41.249668945868805, 41.462591768552855, 44.37559834122658, 44.74157820828259, 44.43899458646774, 40.76064956188202, 41.66836957028136, 41.4303840585053, 49.369392973681286, 49.61610077771668, 49.3120924954613, 44.906556787590176, 44.517039279143006, 44.8799699867765, 47.04407709588607, 46.41728489597638, 46.80985930313666, 46.456907896945864, 46.252089629570634, 46.09081622461477, 36.17743326226869, 35.78680274883905, 36.786266884514276, 43.26603994021812, 43.022290303061396, 42.75922168294588, 47.294005530575916, 47.3513590755562, 47.37688509995739, 42.52958694597085, 42.519418244560555, 42.754026764382914, 43.38312968115011, 43.69729496041933, 42.862957934538514, 44.108992610126734, 43.9268234372139, 43.28439347445965, 44.9847702011466, 44.86744646728039, 44.75207832455635, 44.771659304698304, 44.92256554340322, 44.94307453309496, 44.58390408754349, 45.04737598448992, 45.295527182519436, 25.092890997727707, 25.576111552615956, 25.786949926366404, 49.5506475592653, 49.67183400938909, 49.99142665478091, 52.853360792001084, 53.490234316637114, 53.08488341172536, 46.96307486559574, 46.664369878669575, 46.46948597331841, 48.935491938299194, 48.366115982333824, 48.41412726293008, 34.65036565313736, 34.72132274756828, 35.03119356049379, 32.279105961322784, 31.126484006643295, 32.521425534039736, 43.087346768627555, 41.3954983750979, 43.15226680894071, 56.120939467102275, 55.8857141882181, 55.74179035425185, 44.46888583650191, 44.39684561391671, 43.81012386580308, 39.11410711705685, 38.918781504034996, 39.34380584396422, 41.60668157041073, 41.67879894375801, 41.6791208088398, 40.39225317041078, 39.590418259302766, 39.933187211553246, 44.3543214276433, 43.98048835992813, 44.12070947885513]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1420825179328024, "mean_inference_ms": 0.7021113346769358, "mean_action_processing_ms": 0.09658846958915454, "mean_env_wait_ms": 0.7877828882405634, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 965000, "timesteps_this_iter": 0, "agent_timesteps_total": 2895000, "timers": {"sample_time_ms": 10599.272, "sample_throughput": 471.731, "load_time_ms": 0.6, "load_throughput": 8333937.371, "learn_time_ms": 2005.526, "learn_throughput": 2493.111, "update_time_ms": 9.71}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.15804989205242e-49, "cur_lr": 0.0005000000000000001, "total_loss": 9.056413555145264, "policy_loss": -0.0006722025236996388, "vf_loss": 9.160857200622559, "vf_explained_var": 0.024299240112304686, "kl": 0.002937840030114739, "entropy": 10.377159309387206, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 965000, "num_agent_steps_sampled": 2895000, "num_steps_trained": 965000, "num_agent_steps_trained": 2895000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2606, "training_iteration": 193, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-36-09", "timestamp": 1706232969, "time_this_iter_s": 10.328723669052124, "time_total_s": 2081.8259546756744, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002146F566430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2081.8259546756744, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 6.5, "ram_util_percent": 62.446666666666665}}
{"episode_reward_max": 189.95466383546588, "episode_reward_min": 76.45595247671007, "episode_reward_mean": 131.56395658311357, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 25.092890997727707}, "policy_reward_max": {"shared_policy": 63.48271873593329}, "policy_reward_mean": {"shared_policy": 43.85465219437118}, "custom_metrics": {}, "hist_stats": {"episode_reward": [149.56714747473598, 108.96165432222186, 131.7435516715051, 131.25479070097185, 108.18398344703019, 151.2809245213869, 101.8785449564457, 154.9553985632955, 154.30777625367094, 93.48981654271482, 138.4643217418341, 133.24109837226598, 120.44891484826802, 121.85287006944417, 127.8739700920232, 133.08537671994418, 170.19483866542575, 158.822721862234, 134.24329464137546, 172.0139904282987, 129.96277204900983, 119.90983150526881, 92.8483328106813, 131.15271588414913, 155.69067961408265, 162.84283413738007, 112.32746344432235, 157.46051509678352, 152.13209614902743, 111.83399641513823, 117.71244540205223, 114.24330548383296, 138.98587009310722, 134.63148179743428, 121.63496644049883, 112.32441811915487, 168.69753722101444, 116.54420237243174, 131.48476827889698, 118.589406626299, 137.3461300581693, 143.41511983983204, 154.43417840823534, 124.97790260612963, 126.34799319505689, 131.59093887358907, 130.99404416233298, 112.53664133744313, 141.61258278135188, 102.6183726862073, 118.31988822668791, 134.30372320790764, 149.19723042845757, 133.33677591383434, 120.86192787997425, 107.2725901257945, 134.82933034747845, 147.18719753250502, 79.08255201205608, 189.95466383546588, 123.56300545856355, 133.55617113597688, 123.85940319066867, 148.2975862468592, 134.30356605350954, 140.27122129499924, 138.7998137511314, 108.75050289562202, 129.04755192622537, 142.02224970608978, 127.80303195491432, 129.94338257610804, 131.32020952180022, 134.6042949929832, 134.6372993811965, 134.92680725455295, 76.45595247671007, 149.21390822343534, 159.42847852036323, 140.0969307175841, 145.7157351835632, 104.40288196119943, 95.92701550200582, 127.63511195266616, 167.74844400957198, 132.67585531622143, 117.37669446505606, 124.96460132300854, 119.9158586412668, 132.45551926642656, 83.3000676333904, 126.06713104993102, 154.28122933767722, 100.44621223956345, 155.01471970602867, 151.246286400128, 151.55713333189485, 124.90888955816627, 142.98697722703173, 139.77351863309735], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [49.87334588542579, 49.919082857668386, 49.774718731641755, 36.36259400223692, 36.41825893831749, 36.18080138166745, 44.0675021186471, 43.70976737141609, 43.966282181441784, 43.824218230942876, 43.74197037766376, 43.688602092365414, 36.30350571870804, 35.41840475797653, 36.462072970345616, 50.70176940162976, 50.031518076856926, 50.54763704289992, 34.27348127216101, 33.33236300945282, 34.27270067483187, 51.98113638038437, 51.35857076446216, 51.61569141844909, 51.57794840385516, 51.1592065145572, 51.57062133525808, 30.633089517553643, 31.308700454731778, 31.5480265704294, 45.83911143740018, 46.36723205012579, 46.2579782543083, 43.87299330532551, 44.82961237989366, 44.53849268704653, 40.57910817613204, 40.4830940713485, 39.386712600787476, 39.85057949026425, 41.01837520425518, 40.983915374924734, 42.28266144792238, 42.847729404826765, 42.743579239274055, 44.30192418769002, 44.22518803179264, 44.55826450046152, 56.77917427817981, 56.7989962125818, 56.616668174664184, 53.24760177327941, 53.224157827595874, 52.3509622613589, 44.73498687396446, 44.755565638343484, 44.75274212906757, 57.85890359307329, 56.98634145657222, 57.16874537865321, 43.35204831386605, 43.390510874489934, 43.22021286065379, 40.11421670392156, 39.94876782596111, 39.84684697538614, 30.76839932550986, 30.9239757930239, 31.15595769214754, 43.54785990466674, 43.62572823216517, 43.97912774731715, 52.3200455829501, 50.570036411285386, 52.80059761984738, 54.371722915520266, 54.0572992687424, 54.413811953117445, 37.373935364186764, 37.31629275530577, 37.63723532482982, 52.56337230652569, 52.54019600898026, 52.35694678127764, 50.798765957355485, 50.99280168861149, 50.34052850306033, 37.22601168354352, 37.43797053148349, 37.170014200111225, 39.089258069793374, 39.22596419105926, 39.39722314119959, 38.02349131554365, 38.2541532907635, 37.965660877525806, 46.44070396323998, 46.45110489924748, 46.094061230619744, 44.8145365367333, 44.551581780115754, 45.26536348058531, 40.41033090651035, 40.704880483448505, 40.51975505053997, 37.78721174877137, 37.65910891070962, 36.87809745967388, 56.17206866542499, 56.2083678568403, 56.31710069874923, 39.028436725338295, 38.75975791116555, 38.756007735927895, 42.95233890414238, 44.52471699565649, 44.00771237909794, 39.643945696453244, 39.81732932167748, 39.128131608168275, 45.70937543114026, 45.610362132390335, 46.026392494638756, 47.4895647962888, 47.80312665303548, 48.12242839050789, 51.69659323121111, 51.33040265242259, 51.40718252460162, 41.29763962825139, 41.90802294885118, 41.77224002902706, 41.898709322015435, 42.26450269172588, 42.18478118131557, 44.149184378484875, 43.87380738059679, 43.56794711450735, 43.746335081756115, 43.76962399482727, 43.478085085749626, 37.24490748842557, 37.63570024756093, 37.65603360145663, 46.98149131983517, 47.501502864994094, 47.129588596522794, 34.36291538923979, 34.49086558818817, 33.764591708779335, 39.592938758432865, 39.23985302448273, 39.487096443772316, 44.991700719421104, 44.26306441922982, 45.04895806925681, 49.71249297757943, 49.657303546865776, 49.82743390401204, 44.34806993107, 44.48748705784479, 44.501218924919755, 40.16381182521582, 40.066482841968536, 40.63163321278989, 35.7083228851358, 35.54501252869764, 36.019254711961054, 45.046297043561935, 44.86037417501211, 44.92265912890434, 48.788118178645774, 49.028121384481594, 49.37095796937744, 26.466078045467526, 26.325610200564057, 26.2908637660245, 63.213870048522935, 63.48271873593329, 63.25807505100964, 40.85074474414189, 41.249668945868805, 41.462591768552855, 44.37559834122658, 44.74157820828259, 44.43899458646774, 40.76064956188202, 41.66836957028136, 41.4303840585053, 49.369392973681286, 49.61610077771668, 49.3120924954613, 44.906556787590176, 44.517039279143006, 44.8799699867765, 47.04407709588607, 46.41728489597638, 46.80985930313666, 46.456907896945864, 46.252089629570634, 46.09081622461477, 36.17743326226869, 35.78680274883905, 36.786266884514276, 43.26603994021812, 43.022290303061396, 42.75922168294588, 47.294005530575916, 47.3513590755562, 47.37688509995739, 42.52958694597085, 42.519418244560555, 42.754026764382914, 43.38312968115011, 43.69729496041933, 42.862957934538514, 44.108992610126734, 43.9268234372139, 43.28439347445965, 44.9847702011466, 44.86744646728039, 44.75207832455635, 44.771659304698304, 44.92256554340322, 44.94307453309496, 44.58390408754349, 45.04737598448992, 45.295527182519436, 25.092890997727707, 25.576111552615956, 25.786949926366404, 49.5506475592653, 49.67183400938909, 49.99142665478091, 52.853360792001084, 53.490234316637114, 53.08488341172536, 46.96307486559574, 46.664369878669575, 46.46948597331841, 48.935491938299194, 48.366115982333824, 48.41412726293008, 34.65036565313736, 34.72132274756828, 35.03119356049379, 32.279105961322784, 31.126484006643295, 32.521425534039736, 43.087346768627555, 41.3954983750979, 43.15226680894071, 56.120939467102275, 55.8857141882181, 55.74179035425185, 44.46888583650191, 44.39684561391671, 43.81012386580308, 39.11410711705685, 38.918781504034996, 39.34380584396422, 41.60668157041073, 41.67879894375801, 41.6791208088398, 40.39225317041078, 39.590418259302766, 39.933187211553246, 44.3543214276433, 43.98048835992813, 44.12070947885513, 27.87546048561731, 27.937208438913018, 27.48739870886007, 42.080860945085675, 42.03666907424727, 41.949601030598075, 51.64430607669054, 51.187693342566476, 51.4492299184203, 33.1633734156688, 33.44827579458554, 33.83456302930911, 51.52218962212403, 51.983566285421446, 51.50896379848321, 50.26060381283362, 50.33561301728089, 50.65006957001363, 50.74990768730639, 50.31566385924815, 50.491561785340295, 40.775815933942795, 42.4958172403276, 41.637256383895874, 47.339778199791894, 47.65304613113402, 47.99415289610623, 46.347647204995155, 46.757310412824154, 46.6685610152781]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1420797263923176, "mean_inference_ms": 0.702113310244981, "mean_action_processing_ms": 0.09658540729812044, "mean_env_wait_ms": 0.7876609102431372, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 970000, "timesteps_this_iter": 0, "agent_timesteps_total": 2910000, "timers": {"sample_time_ms": 10600.963, "sample_throughput": 471.655, "load_time_ms": 0.499, "load_throughput": 10020316.308, "learn_time_ms": 2011.962, "learn_throughput": 2485.136, "update_time_ms": 9.809}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.07902494602621e-49, "cur_lr": 0.0005000000000000001, "total_loss": 7.079501056671143, "policy_loss": 0.001087900997833735, "vf_loss": 7.184727621078491, "vf_explained_var": 0.06185861229896546, "kl": 0.015364404395278156, "entropy": 10.631445789337159, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 970000, "num_agent_steps_sampled": 2910000, "num_steps_trained": 970000, "num_agent_steps_trained": 2910000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2616, "training_iteration": 194, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-36-20", "timestamp": 1706232980, "time_this_iter_s": 10.731829166412354, "time_total_s": 2092.557783842087, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D62EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2092.557783842087, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 62.52666666666667}}
{"episode_reward_max": 189.95466383546588, "episode_reward_min": 42.95720010623336, "episode_reward_mean": 130.94845729314642, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 14.15482546389103}, "policy_reward_max": {"shared_policy": 63.48271873593329}, "policy_reward_mean": {"shared_policy": 43.64948576438214}, "custom_metrics": {}, "hist_stats": {"episode_reward": [138.4643217418341, 133.24109837226598, 120.44891484826802, 121.85287006944417, 127.8739700920232, 133.08537671994418, 170.19483866542575, 158.822721862234, 134.24329464137546, 172.0139904282987, 129.96277204900983, 119.90983150526881, 92.8483328106813, 131.15271588414913, 155.69067961408265, 162.84283413738007, 112.32746344432235, 157.46051509678352, 152.13209614902743, 111.83399641513823, 117.71244540205223, 114.24330548383296, 138.98587009310722, 134.63148179743428, 121.63496644049883, 112.32441811915487, 168.69753722101444, 116.54420237243174, 131.48476827889698, 118.589406626299, 137.3461300581693, 143.41511983983204, 154.43417840823534, 124.97790260612963, 126.34799319505689, 131.59093887358907, 130.99404416233298, 112.53664133744313, 141.61258278135188, 102.6183726862073, 118.31988822668791, 134.30372320790764, 149.19723042845757, 133.33677591383434, 120.86192787997425, 107.2725901257945, 134.82933034747845, 147.18719753250502, 79.08255201205608, 189.95466383546588, 123.56300545856355, 133.55617113597688, 123.85940319066867, 148.2975862468592, 134.30356605350954, 140.27122129499924, 138.7998137511314, 108.75050289562202, 129.04755192622537, 142.02224970608978, 127.80303195491432, 129.94338257610804, 131.32020952180022, 134.6042949929832, 134.6372993811965, 134.92680725455295, 76.45595247671007, 149.21390822343534, 159.42847852036323, 140.0969307175841, 145.7157351835632, 104.40288196119943, 95.92701550200582, 127.63511195266616, 167.74844400957198, 132.67585531622143, 117.37669446505606, 124.96460132300854, 119.9158586412668, 132.45551926642656, 83.3000676333904, 126.06713104993102, 154.28122933767722, 100.44621223956345, 155.01471970602867, 151.246286400128, 151.55713333189485, 124.90888955816627, 142.98697722703173, 139.77351863309735, 159.2015685010702, 129.2590106204151, 151.1259272769092, 129.031273657456, 73.41102865338324, 127.10379829257724, 140.02366589941127, 129.2502926290035, 42.95720010623336, 142.70989382080734], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [45.83911143740018, 46.36723205012579, 46.2579782543083, 43.87299330532551, 44.82961237989366, 44.53849268704653, 40.57910817613204, 40.4830940713485, 39.386712600787476, 39.85057949026425, 41.01837520425518, 40.983915374924734, 42.28266144792238, 42.847729404826765, 42.743579239274055, 44.30192418769002, 44.22518803179264, 44.55826450046152, 56.77917427817981, 56.7989962125818, 56.616668174664184, 53.24760177327941, 53.224157827595874, 52.3509622613589, 44.73498687396446, 44.755565638343484, 44.75274212906757, 57.85890359307329, 56.98634145657222, 57.16874537865321, 43.35204831386605, 43.390510874489934, 43.22021286065379, 40.11421670392156, 39.94876782596111, 39.84684697538614, 30.76839932550986, 30.9239757930239, 31.15595769214754, 43.54785990466674, 43.62572823216517, 43.97912774731715, 52.3200455829501, 50.570036411285386, 52.80059761984738, 54.371722915520266, 54.0572992687424, 54.413811953117445, 37.373935364186764, 37.31629275530577, 37.63723532482982, 52.56337230652569, 52.54019600898026, 52.35694678127764, 50.798765957355485, 50.99280168861149, 50.34052850306033, 37.22601168354352, 37.43797053148349, 37.170014200111225, 39.089258069793374, 39.22596419105926, 39.39722314119959, 38.02349131554365, 38.2541532907635, 37.965660877525806, 46.44070396323998, 46.45110489924748, 46.094061230619744, 44.8145365367333, 44.551581780115754, 45.26536348058531, 40.41033090651035, 40.704880483448505, 40.51975505053997, 37.78721174877137, 37.65910891070962, 36.87809745967388, 56.17206866542499, 56.2083678568403, 56.31710069874923, 39.028436725338295, 38.75975791116555, 38.756007735927895, 42.95233890414238, 44.52471699565649, 44.00771237909794, 39.643945696453244, 39.81732932167748, 39.128131608168275, 45.70937543114026, 45.610362132390335, 46.026392494638756, 47.4895647962888, 47.80312665303548, 48.12242839050789, 51.69659323121111, 51.33040265242259, 51.40718252460162, 41.29763962825139, 41.90802294885118, 41.77224002902706, 41.898709322015435, 42.26450269172588, 42.18478118131557, 44.149184378484875, 43.87380738059679, 43.56794711450735, 43.746335081756115, 43.76962399482727, 43.478085085749626, 37.24490748842557, 37.63570024756093, 37.65603360145663, 46.98149131983517, 47.501502864994094, 47.129588596522794, 34.36291538923979, 34.49086558818817, 33.764591708779335, 39.592938758432865, 39.23985302448273, 39.487096443772316, 44.991700719421104, 44.26306441922982, 45.04895806925681, 49.71249297757943, 49.657303546865776, 49.82743390401204, 44.34806993107, 44.48748705784479, 44.501218924919755, 40.16381182521582, 40.066482841968536, 40.63163321278989, 35.7083228851358, 35.54501252869764, 36.019254711961054, 45.046297043561935, 44.86037417501211, 44.92265912890434, 48.788118178645774, 49.028121384481594, 49.37095796937744, 26.466078045467526, 26.325610200564057, 26.2908637660245, 63.213870048522935, 63.48271873593329, 63.25807505100964, 40.85074474414189, 41.249668945868805, 41.462591768552855, 44.37559834122658, 44.74157820828259, 44.43899458646774, 40.76064956188202, 41.66836957028136, 41.4303840585053, 49.369392973681286, 49.61610077771668, 49.3120924954613, 44.906556787590176, 44.517039279143006, 44.8799699867765, 47.04407709588607, 46.41728489597638, 46.80985930313666, 46.456907896945864, 46.252089629570634, 46.09081622461477, 36.17743326226869, 35.78680274883905, 36.786266884514276, 43.26603994021812, 43.022290303061396, 42.75922168294588, 47.294005530575916, 47.3513590755562, 47.37688509995739, 42.52958694597085, 42.519418244560555, 42.754026764382914, 43.38312968115011, 43.69729496041933, 42.862957934538514, 44.108992610126734, 43.9268234372139, 43.28439347445965, 44.9847702011466, 44.86744646728039, 44.75207832455635, 44.771659304698304, 44.92256554340322, 44.94307453309496, 44.58390408754349, 45.04737598448992, 45.295527182519436, 25.092890997727707, 25.576111552615956, 25.786949926366404, 49.5506475592653, 49.67183400938909, 49.99142665478091, 52.853360792001084, 53.490234316637114, 53.08488341172536, 46.96307486559574, 46.664369878669575, 46.46948597331841, 48.935491938299194, 48.366115982333824, 48.41412726293008, 34.65036565313736, 34.72132274756828, 35.03119356049379, 32.279105961322784, 31.126484006643295, 32.521425534039736, 43.087346768627555, 41.3954983750979, 43.15226680894071, 56.120939467102275, 55.8857141882181, 55.74179035425185, 44.46888583650191, 44.39684561391671, 43.81012386580308, 39.11410711705685, 38.918781504034996, 39.34380584396422, 41.60668157041073, 41.67879894375801, 41.6791208088398, 40.39225317041078, 39.590418259302766, 39.933187211553246, 44.3543214276433, 43.98048835992813, 44.12070947885513, 27.87546048561731, 27.937208438913018, 27.48739870886007, 42.080860945085675, 42.03666907424727, 41.949601030598075, 51.64430607669054, 51.187693342566476, 51.4492299184203, 33.1633734156688, 33.44827579458554, 33.83456302930911, 51.52218962212403, 51.983566285421446, 51.50896379848321, 50.26060381283362, 50.33561301728089, 50.65006957001363, 50.74990768730639, 50.31566385924815, 50.491561785340295, 40.775815933942795, 42.4958172403276, 41.637256383895874, 47.339778199791894, 47.65304613113402, 47.99415289610623, 46.347647204995155, 46.757310412824154, 46.6685610152781, 53.1290434723099, 52.81601064403851, 53.25651438472171, 43.32729507920642, 43.3199199916174, 42.61179554959138, 50.62346530705689, 50.46818123757838, 50.03428073227404, 42.8436478972435, 43.26609463430941, 42.92153112590313, 24.275092025597885, 24.61679722120364, 24.519139406581715, 42.32769353191057, 42.3937629337112, 42.38234182695547, 46.76666647071639, 46.37030647943416, 46.886692949260265, 43.11678887034455, 42.95372063914934, 43.17978311950961, 14.15482546389103, 14.417977856472135, 14.384396785870194, 47.128009691834436, 47.83084200508891, 47.75104212388395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14207237965911867, "mean_inference_ms": 0.7020932275745095, "mean_action_processing_ms": 0.0965799217063943, "mean_env_wait_ms": 0.7875341754487433, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 975000, "timesteps_this_iter": 0, "agent_timesteps_total": 2925000, "timers": {"sample_time_ms": 10577.428, "sample_throughput": 472.705, "load_time_ms": 0.499, "load_throughput": 10029421.33, "learn_time_ms": 2025.406, "learn_throughput": 2468.641, "update_time_ms": 9.816}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.07902494602621e-49, "cur_lr": 0.0005000000000000001, "total_loss": 7.56095404624939, "policy_loss": -0.000405402816892364, "vf_loss": 7.666800928115845, "vf_explained_var": 0.019804638624191285, "kl": 0.003117595368584756, "entropy": 10.544139289855957, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 975000, "num_agent_steps_sampled": 2925000, "num_steps_trained": 975000, "num_agent_steps_trained": 2925000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2626, "training_iteration": 195, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-36-31", "timestamp": 1706232991, "time_this_iter_s": 11.151846647262573, "time_total_s": 2103.7096304893494, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D29940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2103.7096304893494, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 6.80625, "ram_util_percent": 62.73125}}
{"episode_reward_max": 189.95466383546588, "episode_reward_min": 42.95720010623336, "episode_reward_mean": 130.56418216288264, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 14.15482546389103}, "policy_reward_max": {"shared_policy": 63.48271873593329}, "policy_reward_mean": {"shared_policy": 43.521394054294205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [129.96277204900983, 119.90983150526881, 92.8483328106813, 131.15271588414913, 155.69067961408265, 162.84283413738007, 112.32746344432235, 157.46051509678352, 152.13209614902743, 111.83399641513823, 117.71244540205223, 114.24330548383296, 138.98587009310722, 134.63148179743428, 121.63496644049883, 112.32441811915487, 168.69753722101444, 116.54420237243174, 131.48476827889698, 118.589406626299, 137.3461300581693, 143.41511983983204, 154.43417840823534, 124.97790260612963, 126.34799319505689, 131.59093887358907, 130.99404416233298, 112.53664133744313, 141.61258278135188, 102.6183726862073, 118.31988822668791, 134.30372320790764, 149.19723042845757, 133.33677591383434, 120.86192787997425, 107.2725901257945, 134.82933034747845, 147.18719753250502, 79.08255201205608, 189.95466383546588, 123.56300545856355, 133.55617113597688, 123.85940319066867, 148.2975862468592, 134.30356605350954, 140.27122129499924, 138.7998137511314, 108.75050289562202, 129.04755192622537, 142.02224970608978, 127.80303195491432, 129.94338257610804, 131.32020952180022, 134.6042949929832, 134.6372993811965, 134.92680725455295, 76.45595247671007, 149.21390822343534, 159.42847852036323, 140.0969307175841, 145.7157351835632, 104.40288196119943, 95.92701550200582, 127.63511195266616, 167.74844400957198, 132.67585531622143, 117.37669446505606, 124.96460132300854, 119.9158586412668, 132.45551926642656, 83.3000676333904, 126.06713104993102, 154.28122933767722, 100.44621223956345, 155.01471970602867, 151.246286400128, 151.55713333189485, 124.90888955816627, 142.98697722703173, 139.77351863309735, 159.2015685010702, 129.2590106204151, 151.1259272769092, 129.031273657456, 73.41102865338324, 127.10379829257724, 140.02366589941127, 129.2502926290035, 42.95720010623336, 142.70989382080734, 128.5243718847632, 161.3348568947985, 139.78516951948433, 136.48205887526274, 145.3995101079345, 168.998105184175, 134.38617460615933, 153.95438531413657, 52.23913320526478, 150.71011882275343], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [43.35204831386605, 43.390510874489934, 43.22021286065379, 40.11421670392156, 39.94876782596111, 39.84684697538614, 30.76839932550986, 30.9239757930239, 31.15595769214754, 43.54785990466674, 43.62572823216517, 43.97912774731715, 52.3200455829501, 50.570036411285386, 52.80059761984738, 54.371722915520266, 54.0572992687424, 54.413811953117445, 37.373935364186764, 37.31629275530577, 37.63723532482982, 52.56337230652569, 52.54019600898026, 52.35694678127764, 50.798765957355485, 50.99280168861149, 50.34052850306033, 37.22601168354352, 37.43797053148349, 37.170014200111225, 39.089258069793374, 39.22596419105926, 39.39722314119959, 38.02349131554365, 38.2541532907635, 37.965660877525806, 46.44070396323998, 46.45110489924748, 46.094061230619744, 44.8145365367333, 44.551581780115754, 45.26536348058531, 40.41033090651035, 40.704880483448505, 40.51975505053997, 37.78721174877137, 37.65910891070962, 36.87809745967388, 56.17206866542499, 56.2083678568403, 56.31710069874923, 39.028436725338295, 38.75975791116555, 38.756007735927895, 42.95233890414238, 44.52471699565649, 44.00771237909794, 39.643945696453244, 39.81732932167748, 39.128131608168275, 45.70937543114026, 45.610362132390335, 46.026392494638756, 47.4895647962888, 47.80312665303548, 48.12242839050789, 51.69659323121111, 51.33040265242259, 51.40718252460162, 41.29763962825139, 41.90802294885118, 41.77224002902706, 41.898709322015435, 42.26450269172588, 42.18478118131557, 44.149184378484875, 43.87380738059679, 43.56794711450735, 43.746335081756115, 43.76962399482727, 43.478085085749626, 37.24490748842557, 37.63570024756093, 37.65603360145663, 46.98149131983517, 47.501502864994094, 47.129588596522794, 34.36291538923979, 34.49086558818817, 33.764591708779335, 39.592938758432865, 39.23985302448273, 39.487096443772316, 44.991700719421104, 44.26306441922982, 45.04895806925681, 49.71249297757943, 49.657303546865776, 49.82743390401204, 44.34806993107, 44.48748705784479, 44.501218924919755, 40.16381182521582, 40.066482841968536, 40.63163321278989, 35.7083228851358, 35.54501252869764, 36.019254711961054, 45.046297043561935, 44.86037417501211, 44.92265912890434, 48.788118178645774, 49.028121384481594, 49.37095796937744, 26.466078045467526, 26.325610200564057, 26.2908637660245, 63.213870048522935, 63.48271873593329, 63.25807505100964, 40.85074474414189, 41.249668945868805, 41.462591768552855, 44.37559834122658, 44.74157820828259, 44.43899458646774, 40.76064956188202, 41.66836957028136, 41.4303840585053, 49.369392973681286, 49.61610077771668, 49.3120924954613, 44.906556787590176, 44.517039279143006, 44.8799699867765, 47.04407709588607, 46.41728489597638, 46.80985930313666, 46.456907896945864, 46.252089629570634, 46.09081622461477, 36.17743326226869, 35.78680274883905, 36.786266884514276, 43.26603994021812, 43.022290303061396, 42.75922168294588, 47.294005530575916, 47.3513590755562, 47.37688509995739, 42.52958694597085, 42.519418244560555, 42.754026764382914, 43.38312968115011, 43.69729496041933, 42.862957934538514, 44.108992610126734, 43.9268234372139, 43.28439347445965, 44.9847702011466, 44.86744646728039, 44.75207832455635, 44.771659304698304, 44.92256554340322, 44.94307453309496, 44.58390408754349, 45.04737598448992, 45.295527182519436, 25.092890997727707, 25.576111552615956, 25.786949926366404, 49.5506475592653, 49.67183400938909, 49.99142665478091, 52.853360792001084, 53.490234316637114, 53.08488341172536, 46.96307486559574, 46.664369878669575, 46.46948597331841, 48.935491938299194, 48.366115982333824, 48.41412726293008, 34.65036565313736, 34.72132274756828, 35.03119356049379, 32.279105961322784, 31.126484006643295, 32.521425534039736, 43.087346768627555, 41.3954983750979, 43.15226680894071, 56.120939467102275, 55.8857141882181, 55.74179035425185, 44.46888583650191, 44.39684561391671, 43.81012386580308, 39.11410711705685, 38.918781504034996, 39.34380584396422, 41.60668157041073, 41.67879894375801, 41.6791208088398, 40.39225317041078, 39.590418259302766, 39.933187211553246, 44.3543214276433, 43.98048835992813, 44.12070947885513, 27.87546048561731, 27.937208438913018, 27.48739870886007, 42.080860945085675, 42.03666907424727, 41.949601030598075, 51.64430607669054, 51.187693342566476, 51.4492299184203, 33.1633734156688, 33.44827579458554, 33.83456302930911, 51.52218962212403, 51.983566285421446, 51.50896379848321, 50.26060381283362, 50.33561301728089, 50.65006957001363, 50.74990768730639, 50.31566385924815, 50.491561785340295, 40.775815933942795, 42.4958172403276, 41.637256383895874, 47.339778199791894, 47.65304613113402, 47.99415289610623, 46.347647204995155, 46.757310412824154, 46.6685610152781, 53.1290434723099, 52.81601064403851, 53.25651438472171, 43.32729507920642, 43.3199199916174, 42.61179554959138, 50.62346530705689, 50.46818123757838, 50.03428073227404, 42.8436478972435, 43.26609463430941, 42.92153112590313, 24.275092025597885, 24.61679722120364, 24.519139406581715, 42.32769353191057, 42.3937629337112, 42.38234182695547, 46.76666647071639, 46.37030647943416, 46.886692949260265, 43.11678887034455, 42.95372063914934, 43.17978311950961, 14.15482546389103, 14.417977856472135, 14.384396785870194, 47.128009691834436, 47.83084200508891, 47.75104212388395, 42.61164029935995, 42.96612152705589, 42.946610058347375, 53.37909870843093, 53.975415481875345, 53.980342704492315, 46.585903008778885, 46.73839176942904, 46.4608747412761, 45.56667411079009, 45.539353167017296, 45.37603159745534, 47.993097687760994, 48.76368743429582, 48.64272498587768, 55.800789460539804, 56.52476943656801, 56.67254628706722, 44.732926696538925, 45.497519033029675, 44.15572887659073, 51.39755268891652, 51.05687358727057, 51.49995903794964, 17.540396210427076, 17.481001746530325, 17.217735248307378, 49.98150132596491, 50.416774004697785, 50.31184349209069]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14207283286044892, "mean_inference_ms": 0.7021150384647236, "mean_action_processing_ms": 0.096581436633074, "mean_env_wait_ms": 0.7874397131924578, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 980000, "timesteps_this_iter": 0, "agent_timesteps_total": 2940000, "timers": {"sample_time_ms": 10677.464, "sample_throughput": 468.276, "load_time_ms": 0.499, "load_throughput": 10029421.33, "learn_time_ms": 2081.31, "learn_throughput": 2402.333, "update_time_ms": 9.771}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.539512473013105e-49, "cur_lr": 0.0005000000000000001, "total_loss": 8.498535442352296, "policy_loss": -0.0007090306190870698, "vf_loss": 8.602817916870118, "vf_explained_var": 0.01189989447593689, "kl": 0.002559907542361334, "entropy": 10.357334804534911, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 980000, "num_agent_steps_sampled": 2940000, "num_steps_trained": 980000, "num_agent_steps_trained": 2940000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2636, "training_iteration": 196, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-36-43", "timestamp": 1706233003, "time_this_iter_s": 11.84524655342102, "time_total_s": 2115.5548770427704, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D620D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2115.5548770427704, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 6.775, "ram_util_percent": 63.51875}}
{"episode_reward_max": 189.95466383546588, "episode_reward_min": 42.95720010623336, "episode_reward_mean": 131.55206175615837, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 14.15482546389103}, "policy_reward_max": {"shared_policy": 63.48271873593329}, "policy_reward_mean": {"shared_policy": 43.85068725205278}, "custom_metrics": {}, "hist_stats": {"episode_reward": [117.71244540205223, 114.24330548383296, 138.98587009310722, 134.63148179743428, 121.63496644049883, 112.32441811915487, 168.69753722101444, 116.54420237243174, 131.48476827889698, 118.589406626299, 137.3461300581693, 143.41511983983204, 154.43417840823534, 124.97790260612963, 126.34799319505689, 131.59093887358907, 130.99404416233298, 112.53664133744313, 141.61258278135188, 102.6183726862073, 118.31988822668791, 134.30372320790764, 149.19723042845757, 133.33677591383434, 120.86192787997425, 107.2725901257945, 134.82933034747845, 147.18719753250502, 79.08255201205608, 189.95466383546588, 123.56300545856355, 133.55617113597688, 123.85940319066867, 148.2975862468592, 134.30356605350954, 140.27122129499924, 138.7998137511314, 108.75050289562202, 129.04755192622537, 142.02224970608978, 127.80303195491432, 129.94338257610804, 131.32020952180022, 134.6042949929832, 134.6372993811965, 134.92680725455295, 76.45595247671007, 149.21390822343534, 159.42847852036323, 140.0969307175841, 145.7157351835632, 104.40288196119943, 95.92701550200582, 127.63511195266616, 167.74844400957198, 132.67585531622143, 117.37669446505606, 124.96460132300854, 119.9158586412668, 132.45551926642656, 83.3000676333904, 126.06713104993102, 154.28122933767722, 100.44621223956345, 155.01471970602867, 151.246286400128, 151.55713333189485, 124.90888955816627, 142.98697722703173, 139.77351863309735, 159.2015685010702, 129.2590106204151, 151.1259272769092, 129.031273657456, 73.41102865338324, 127.10379829257724, 140.02366589941127, 129.2502926290035, 42.95720010623336, 142.70989382080734, 128.5243718847632, 161.3348568947985, 139.78516951948433, 136.48205887526274, 145.3995101079345, 168.998105184175, 134.38617460615933, 153.95438531413657, 52.23913320526478, 150.71011882275343, 151.54144522082078, 173.45357296057043, 139.14259955869025, 129.11053825542336, 137.1999550219626, 116.90825531631705, 136.4049230143427, 167.9589033597151, 130.79514850489792, 142.43385522067544], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [39.089258069793374, 39.22596419105926, 39.39722314119959, 38.02349131554365, 38.2541532907635, 37.965660877525806, 46.44070396323998, 46.45110489924748, 46.094061230619744, 44.8145365367333, 44.551581780115754, 45.26536348058531, 40.41033090651035, 40.704880483448505, 40.51975505053997, 37.78721174877137, 37.65910891070962, 36.87809745967388, 56.17206866542499, 56.2083678568403, 56.31710069874923, 39.028436725338295, 38.75975791116555, 38.756007735927895, 42.95233890414238, 44.52471699565649, 44.00771237909794, 39.643945696453244, 39.81732932167748, 39.128131608168275, 45.70937543114026, 45.610362132390335, 46.026392494638756, 47.4895647962888, 47.80312665303548, 48.12242839050789, 51.69659323121111, 51.33040265242259, 51.40718252460162, 41.29763962825139, 41.90802294885118, 41.77224002902706, 41.898709322015435, 42.26450269172588, 42.18478118131557, 44.149184378484875, 43.87380738059679, 43.56794711450735, 43.746335081756115, 43.76962399482727, 43.478085085749626, 37.24490748842557, 37.63570024756093, 37.65603360145663, 46.98149131983517, 47.501502864994094, 47.129588596522794, 34.36291538923979, 34.49086558818817, 33.764591708779335, 39.592938758432865, 39.23985302448273, 39.487096443772316, 44.991700719421104, 44.26306441922982, 45.04895806925681, 49.71249297757943, 49.657303546865776, 49.82743390401204, 44.34806993107, 44.48748705784479, 44.501218924919755, 40.16381182521582, 40.066482841968536, 40.63163321278989, 35.7083228851358, 35.54501252869764, 36.019254711961054, 45.046297043561935, 44.86037417501211, 44.92265912890434, 48.788118178645774, 49.028121384481594, 49.37095796937744, 26.466078045467526, 26.325610200564057, 26.2908637660245, 63.213870048522935, 63.48271873593329, 63.25807505100964, 40.85074474414189, 41.249668945868805, 41.462591768552855, 44.37559834122658, 44.74157820828259, 44.43899458646774, 40.76064956188202, 41.66836957028136, 41.4303840585053, 49.369392973681286, 49.61610077771668, 49.3120924954613, 44.906556787590176, 44.517039279143006, 44.8799699867765, 47.04407709588607, 46.41728489597638, 46.80985930313666, 46.456907896945864, 46.252089629570634, 46.09081622461477, 36.17743326226869, 35.78680274883905, 36.786266884514276, 43.26603994021812, 43.022290303061396, 42.75922168294588, 47.294005530575916, 47.3513590755562, 47.37688509995739, 42.52958694597085, 42.519418244560555, 42.754026764382914, 43.38312968115011, 43.69729496041933, 42.862957934538514, 44.108992610126734, 43.9268234372139, 43.28439347445965, 44.9847702011466, 44.86744646728039, 44.75207832455635, 44.771659304698304, 44.92256554340322, 44.94307453309496, 44.58390408754349, 45.04737598448992, 45.295527182519436, 25.092890997727707, 25.576111552615956, 25.786949926366404, 49.5506475592653, 49.67183400938909, 49.99142665478091, 52.853360792001084, 53.490234316637114, 53.08488341172536, 46.96307486559574, 46.664369878669575, 46.46948597331841, 48.935491938299194, 48.366115982333824, 48.41412726293008, 34.65036565313736, 34.72132274756828, 35.03119356049379, 32.279105961322784, 31.126484006643295, 32.521425534039736, 43.087346768627555, 41.3954983750979, 43.15226680894071, 56.120939467102275, 55.8857141882181, 55.74179035425185, 44.46888583650191, 44.39684561391671, 43.81012386580308, 39.11410711705685, 38.918781504034996, 39.34380584396422, 41.60668157041073, 41.67879894375801, 41.6791208088398, 40.39225317041078, 39.590418259302766, 39.933187211553246, 44.3543214276433, 43.98048835992813, 44.12070947885513, 27.87546048561731, 27.937208438913018, 27.48739870886007, 42.080860945085675, 42.03666907424727, 41.949601030598075, 51.64430607669054, 51.187693342566476, 51.4492299184203, 33.1633734156688, 33.44827579458554, 33.83456302930911, 51.52218962212403, 51.983566285421446, 51.50896379848321, 50.26060381283362, 50.33561301728089, 50.65006957001363, 50.74990768730639, 50.31566385924815, 50.491561785340295, 40.775815933942795, 42.4958172403276, 41.637256383895874, 47.339778199791894, 47.65304613113402, 47.99415289610623, 46.347647204995155, 46.757310412824154, 46.6685610152781, 53.1290434723099, 52.81601064403851, 53.25651438472171, 43.32729507920642, 43.3199199916174, 42.61179554959138, 50.62346530705689, 50.46818123757838, 50.03428073227404, 42.8436478972435, 43.26609463430941, 42.92153112590313, 24.275092025597885, 24.61679722120364, 24.519139406581715, 42.32769353191057, 42.3937629337112, 42.38234182695547, 46.76666647071639, 46.37030647943416, 46.886692949260265, 43.11678887034455, 42.95372063914934, 43.17978311950961, 14.15482546389103, 14.417977856472135, 14.384396785870194, 47.128009691834436, 47.83084200508891, 47.75104212388395, 42.61164029935995, 42.96612152705589, 42.946610058347375, 53.37909870843093, 53.975415481875345, 53.980342704492315, 46.585903008778885, 46.73839176942904, 46.4608747412761, 45.56667411079009, 45.539353167017296, 45.37603159745534, 47.993097687760994, 48.76368743429582, 48.64272498587768, 55.800789460539804, 56.52476943656801, 56.67254628706722, 44.732926696538925, 45.497519033029675, 44.15572887659073, 51.39755268891652, 51.05687358727057, 51.49995903794964, 17.540396210427076, 17.481001746530325, 17.217735248307378, 49.98150132596491, 50.416774004697785, 50.31184349209069, 50.478339005261645, 50.44721090793608, 50.615895307622836, 58.06588764302431, 57.446706071495996, 57.940979246050105, 45.744421035051346, 46.750438219169155, 46.64774030447006, 43.801580768078566, 43.84128701686859, 41.46767047047615, 45.78614671031633, 45.327056164542824, 46.08675214710334, 38.84854662666717, 39.025117638210446, 39.034591051439435, 45.510733562211186, 45.59653046230474, 45.29765898982683, 56.57258845726027, 55.02132827043532, 56.36498663201927, 43.51742198566595, 43.86126854332784, 43.41645797590414, 47.5783407576382, 47.37378475069998, 47.48172971233724]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14208609590698618, "mean_inference_ms": 0.7021994762775949, "mean_action_processing_ms": 0.09659360715661414, "mean_env_wait_ms": 0.787387021037391, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 985000, "timesteps_this_iter": 0, "agent_timesteps_total": 2955000, "timers": {"sample_time_ms": 10860.095, "sample_throughput": 460.401, "load_time_ms": 0.399, "load_throughput": 12545026.021, "learn_time_ms": 2133.632, "learn_throughput": 2343.421, "update_time_ms": 9.971}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.697562365065525e-50, "cur_lr": 0.0005000000000000001, "total_loss": 9.64555025100708, "policy_loss": -0.0011817502665318002, "vf_loss": 9.749546718597411, "vf_explained_var": 0.009207212924957275, "kl": 0.003080457146332492, "entropy": 10.281481742858887, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 985000, "num_agent_steps_sampled": 2955000, "num_steps_trained": 985000, "num_agent_steps_trained": 2955000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2646, "training_iteration": 197, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-36-55", "timestamp": 1706233015, "time_this_iter_s": 12.518177270889282, "time_total_s": 2128.0730543136597, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401A7A670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2128.0730543136597, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 6.633333333333334, "ram_util_percent": 63.98888888888889}}
{"episode_reward_max": 189.95466383546588, "episode_reward_min": 42.95720010623336, "episode_reward_mean": 132.6797819818422, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 14.15482546389103}, "policy_reward_max": {"shared_policy": 63.48271873593329}, "policy_reward_mean": {"shared_policy": 44.226593993947404}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.3461300581693, 143.41511983983204, 154.43417840823534, 124.97790260612963, 126.34799319505689, 131.59093887358907, 130.99404416233298, 112.53664133744313, 141.61258278135188, 102.6183726862073, 118.31988822668791, 134.30372320790764, 149.19723042845757, 133.33677591383434, 120.86192787997425, 107.2725901257945, 134.82933034747845, 147.18719753250502, 79.08255201205608, 189.95466383546588, 123.56300545856355, 133.55617113597688, 123.85940319066867, 148.2975862468592, 134.30356605350954, 140.27122129499924, 138.7998137511314, 108.75050289562202, 129.04755192622537, 142.02224970608978, 127.80303195491432, 129.94338257610804, 131.32020952180022, 134.6042949929832, 134.6372993811965, 134.92680725455295, 76.45595247671007, 149.21390822343534, 159.42847852036323, 140.0969307175841, 145.7157351835632, 104.40288196119943, 95.92701550200582, 127.63511195266616, 167.74844400957198, 132.67585531622143, 117.37669446505606, 124.96460132300854, 119.9158586412668, 132.45551926642656, 83.3000676333904, 126.06713104993102, 154.28122933767722, 100.44621223956345, 155.01471970602867, 151.246286400128, 151.55713333189485, 124.90888955816627, 142.98697722703173, 139.77351863309735, 159.2015685010702, 129.2590106204151, 151.1259272769092, 129.031273657456, 73.41102865338324, 127.10379829257724, 140.02366589941127, 129.2502926290035, 42.95720010623336, 142.70989382080734, 128.5243718847632, 161.3348568947985, 139.78516951948433, 136.48205887526274, 145.3995101079345, 168.998105184175, 134.38617460615933, 153.95438531413657, 52.23913320526478, 150.71011882275343, 151.54144522082078, 173.45357296057043, 139.14259955869025, 129.11053825542336, 137.1999550219626, 116.90825531631705, 136.4049230143427, 167.9589033597151, 130.79514850489792, 142.43385522067544, 140.89192412607386, 143.68556541576973, 106.5472333235666, 142.35320264846064, 165.96796388272176, 144.05486187152556, 118.65253120311533, 131.97817603684956, 133.03345322981485, 160.45551266521227], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [45.70937543114026, 45.610362132390335, 46.026392494638756, 47.4895647962888, 47.80312665303548, 48.12242839050789, 51.69659323121111, 51.33040265242259, 51.40718252460162, 41.29763962825139, 41.90802294885118, 41.77224002902706, 41.898709322015435, 42.26450269172588, 42.18478118131557, 44.149184378484875, 43.87380738059679, 43.56794711450735, 43.746335081756115, 43.76962399482727, 43.478085085749626, 37.24490748842557, 37.63570024756093, 37.65603360145663, 46.98149131983517, 47.501502864994094, 47.129588596522794, 34.36291538923979, 34.49086558818817, 33.764591708779335, 39.592938758432865, 39.23985302448273, 39.487096443772316, 44.991700719421104, 44.26306441922982, 45.04895806925681, 49.71249297757943, 49.657303546865776, 49.82743390401204, 44.34806993107, 44.48748705784479, 44.501218924919755, 40.16381182521582, 40.066482841968536, 40.63163321278989, 35.7083228851358, 35.54501252869764, 36.019254711961054, 45.046297043561935, 44.86037417501211, 44.92265912890434, 48.788118178645774, 49.028121384481594, 49.37095796937744, 26.466078045467526, 26.325610200564057, 26.2908637660245, 63.213870048522935, 63.48271873593329, 63.25807505100964, 40.85074474414189, 41.249668945868805, 41.462591768552855, 44.37559834122658, 44.74157820828259, 44.43899458646774, 40.76064956188202, 41.66836957028136, 41.4303840585053, 49.369392973681286, 49.61610077771668, 49.3120924954613, 44.906556787590176, 44.517039279143006, 44.8799699867765, 47.04407709588607, 46.41728489597638, 46.80985930313666, 46.456907896945864, 46.252089629570634, 46.09081622461477, 36.17743326226869, 35.78680274883905, 36.786266884514276, 43.26603994021812, 43.022290303061396, 42.75922168294588, 47.294005530575916, 47.3513590755562, 47.37688509995739, 42.52958694597085, 42.519418244560555, 42.754026764382914, 43.38312968115011, 43.69729496041933, 42.862957934538514, 44.108992610126734, 43.9268234372139, 43.28439347445965, 44.9847702011466, 44.86744646728039, 44.75207832455635, 44.771659304698304, 44.92256554340322, 44.94307453309496, 44.58390408754349, 45.04737598448992, 45.295527182519436, 25.092890997727707, 25.576111552615956, 25.786949926366404, 49.5506475592653, 49.67183400938909, 49.99142665478091, 52.853360792001084, 53.490234316637114, 53.08488341172536, 46.96307486559574, 46.664369878669575, 46.46948597331841, 48.935491938299194, 48.366115982333824, 48.41412726293008, 34.65036565313736, 34.72132274756828, 35.03119356049379, 32.279105961322784, 31.126484006643295, 32.521425534039736, 43.087346768627555, 41.3954983750979, 43.15226680894071, 56.120939467102275, 55.8857141882181, 55.74179035425185, 44.46888583650191, 44.39684561391671, 43.81012386580308, 39.11410711705685, 38.918781504034996, 39.34380584396422, 41.60668157041073, 41.67879894375801, 41.6791208088398, 40.39225317041078, 39.590418259302766, 39.933187211553246, 44.3543214276433, 43.98048835992813, 44.12070947885513, 27.87546048561731, 27.937208438913018, 27.48739870886007, 42.080860945085675, 42.03666907424727, 41.949601030598075, 51.64430607669054, 51.187693342566476, 51.4492299184203, 33.1633734156688, 33.44827579458554, 33.83456302930911, 51.52218962212403, 51.983566285421446, 51.50896379848321, 50.26060381283362, 50.33561301728089, 50.65006957001363, 50.74990768730639, 50.31566385924815, 50.491561785340295, 40.775815933942795, 42.4958172403276, 41.637256383895874, 47.339778199791894, 47.65304613113402, 47.99415289610623, 46.347647204995155, 46.757310412824154, 46.6685610152781, 53.1290434723099, 52.81601064403851, 53.25651438472171, 43.32729507920642, 43.3199199916174, 42.61179554959138, 50.62346530705689, 50.46818123757838, 50.03428073227404, 42.8436478972435, 43.26609463430941, 42.92153112590313, 24.275092025597885, 24.61679722120364, 24.519139406581715, 42.32769353191057, 42.3937629337112, 42.38234182695547, 46.76666647071639, 46.37030647943416, 46.886692949260265, 43.11678887034455, 42.95372063914934, 43.17978311950961, 14.15482546389103, 14.417977856472135, 14.384396785870194, 47.128009691834436, 47.83084200508891, 47.75104212388395, 42.61164029935995, 42.96612152705589, 42.946610058347375, 53.37909870843093, 53.975415481875345, 53.980342704492315, 46.585903008778885, 46.73839176942904, 46.4608747412761, 45.56667411079009, 45.539353167017296, 45.37603159745534, 47.993097687760994, 48.76368743429582, 48.64272498587768, 55.800789460539804, 56.52476943656801, 56.67254628706722, 44.732926696538925, 45.497519033029675, 44.15572887659073, 51.39755268891652, 51.05687358727057, 51.49995903794964, 17.540396210427076, 17.481001746530325, 17.217735248307378, 49.98150132596491, 50.416774004697785, 50.31184349209069, 50.478339005261645, 50.44721090793608, 50.615895307622836, 58.06588764302431, 57.446706071495996, 57.940979246050105, 45.744421035051346, 46.750438219169155, 46.64774030447006, 43.801580768078566, 43.84128701686859, 41.46767047047615, 45.78614671031633, 45.327056164542824, 46.08675214710334, 38.84854662666717, 39.025117638210446, 39.034591051439435, 45.510733562211186, 45.59653046230474, 45.29765898982683, 56.57258845726027, 55.02132827043532, 56.36498663201927, 43.51742198566595, 43.86126854332784, 43.41645797590414, 47.5783407576382, 47.37378475069998, 47.48172971233724, 47.14412745647131, 46.89672210812567, 46.85107456147669, 47.84806546817224, 48.04451434935133, 47.79298559824626, 35.65599152849366, 35.42896884058912, 35.46227295448382, 46.973631749550506, 47.68429412009816, 47.695276778812215, 55.45206027105449, 55.69878526497631, 54.81711834669112, 48.27447059315939, 48.14344249417384, 47.6369487841924, 39.42391837636629, 39.450866418580205, 39.77774640816884, 44.049687139069036, 44.14759833862384, 43.78089055915673, 44.391852165261895, 44.42226008946696, 44.219340975085885, 53.68112098425625, 53.72799322009085, 53.04639846086501]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14209228730679924, "mean_inference_ms": 0.7022931595826573, "mean_action_processing_ms": 0.09660706868065555, "mean_env_wait_ms": 0.7873364979111305, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 990000, "timesteps_this_iter": 0, "agent_timesteps_total": 2970000, "timers": {"sample_time_ms": 10915.416, "sample_throughput": 458.068, "load_time_ms": 0.399, "load_throughput": 12545026.021, "learn_time_ms": 2134.5, "learn_throughput": 2342.469, "update_time_ms": 9.896}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.8487811825327623e-50, "cur_lr": 0.0005000000000000001, "total_loss": 7.205874967575073, "policy_loss": -0.001921898975810038, "vf_loss": 7.311915731430053, "vf_explained_var": 0.027045071125030518, "kl": 0.00349823755683233, "entropy": 10.411913967132568, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 990000, "num_agent_steps_sampled": 2970000, "num_steps_trained": 990000, "num_agent_steps_trained": 2970000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2656, "training_iteration": 198, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-37-06", "timestamp": 1706233026, "time_this_iter_s": 10.203716516494751, "time_total_s": 2138.2767708301544, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140239E9D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2138.2767708301544, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 5.271428571428572, "ram_util_percent": 63.785714285714285}}
{"episode_reward_max": 189.95466383546588, "episode_reward_min": 42.95720010623336, "episode_reward_mean": 134.46662062834076, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 14.15482546389103}, "policy_reward_max": {"shared_policy": 63.48271873593329}, "policy_reward_mean": {"shared_policy": 44.822206876113576}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.31988822668791, 134.30372320790764, 149.19723042845757, 133.33677591383434, 120.86192787997425, 107.2725901257945, 134.82933034747845, 147.18719753250502, 79.08255201205608, 189.95466383546588, 123.56300545856355, 133.55617113597688, 123.85940319066867, 148.2975862468592, 134.30356605350954, 140.27122129499924, 138.7998137511314, 108.75050289562202, 129.04755192622537, 142.02224970608978, 127.80303195491432, 129.94338257610804, 131.32020952180022, 134.6042949929832, 134.6372993811965, 134.92680725455295, 76.45595247671007, 149.21390822343534, 159.42847852036323, 140.0969307175841, 145.7157351835632, 104.40288196119943, 95.92701550200582, 127.63511195266616, 167.74844400957198, 132.67585531622143, 117.37669446505606, 124.96460132300854, 119.9158586412668, 132.45551926642656, 83.3000676333904, 126.06713104993102, 154.28122933767722, 100.44621223956345, 155.01471970602867, 151.246286400128, 151.55713333189485, 124.90888955816627, 142.98697722703173, 139.77351863309735, 159.2015685010702, 129.2590106204151, 151.1259272769092, 129.031273657456, 73.41102865338324, 127.10379829257724, 140.02366589941127, 129.2502926290035, 42.95720010623336, 142.70989382080734, 128.5243718847632, 161.3348568947985, 139.78516951948433, 136.48205887526274, 145.3995101079345, 168.998105184175, 134.38617460615933, 153.95438531413657, 52.23913320526478, 150.71011882275343, 151.54144522082078, 173.45357296057043, 139.14259955869025, 129.11053825542336, 137.1999550219626, 116.90825531631705, 136.4049230143427, 167.9589033597151, 130.79514850489792, 142.43385522067544, 140.89192412607386, 143.68556541576973, 106.5472333235666, 142.35320264846064, 165.96796388272176, 144.05486187152556, 118.65253120311533, 131.97817603684956, 133.03345322981485, 160.45551266521227, 150.98142987117177, 140.17328649014257, 179.247735440731, 156.81321851909155, 131.39990808069695, 113.74827790725973, 160.1274534016845, 131.61492246668791, 160.2906728945673, 160.16086352616506], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [39.592938758432865, 39.23985302448273, 39.487096443772316, 44.991700719421104, 44.26306441922982, 45.04895806925681, 49.71249297757943, 49.657303546865776, 49.82743390401204, 44.34806993107, 44.48748705784479, 44.501218924919755, 40.16381182521582, 40.066482841968536, 40.63163321278989, 35.7083228851358, 35.54501252869764, 36.019254711961054, 45.046297043561935, 44.86037417501211, 44.92265912890434, 48.788118178645774, 49.028121384481594, 49.37095796937744, 26.466078045467526, 26.325610200564057, 26.2908637660245, 63.213870048522935, 63.48271873593329, 63.25807505100964, 40.85074474414189, 41.249668945868805, 41.462591768552855, 44.37559834122658, 44.74157820828259, 44.43899458646774, 40.76064956188202, 41.66836957028136, 41.4303840585053, 49.369392973681286, 49.61610077771668, 49.3120924954613, 44.906556787590176, 44.517039279143006, 44.8799699867765, 47.04407709588607, 46.41728489597638, 46.80985930313666, 46.456907896945864, 46.252089629570634, 46.09081622461477, 36.17743326226869, 35.78680274883905, 36.786266884514276, 43.26603994021812, 43.022290303061396, 42.75922168294588, 47.294005530575916, 47.3513590755562, 47.37688509995739, 42.52958694597085, 42.519418244560555, 42.754026764382914, 43.38312968115011, 43.69729496041933, 42.862957934538514, 44.108992610126734, 43.9268234372139, 43.28439347445965, 44.9847702011466, 44.86744646728039, 44.75207832455635, 44.771659304698304, 44.92256554340322, 44.94307453309496, 44.58390408754349, 45.04737598448992, 45.295527182519436, 25.092890997727707, 25.576111552615956, 25.786949926366404, 49.5506475592653, 49.67183400938909, 49.99142665478091, 52.853360792001084, 53.490234316637114, 53.08488341172536, 46.96307486559574, 46.664369878669575, 46.46948597331841, 48.935491938299194, 48.366115982333824, 48.41412726293008, 34.65036565313736, 34.72132274756828, 35.03119356049379, 32.279105961322784, 31.126484006643295, 32.521425534039736, 43.087346768627555, 41.3954983750979, 43.15226680894071, 56.120939467102275, 55.8857141882181, 55.74179035425185, 44.46888583650191, 44.39684561391671, 43.81012386580308, 39.11410711705685, 38.918781504034996, 39.34380584396422, 41.60668157041073, 41.67879894375801, 41.6791208088398, 40.39225317041078, 39.590418259302766, 39.933187211553246, 44.3543214276433, 43.98048835992813, 44.12070947885513, 27.87546048561731, 27.937208438913018, 27.48739870886007, 42.080860945085675, 42.03666907424727, 41.949601030598075, 51.64430607669054, 51.187693342566476, 51.4492299184203, 33.1633734156688, 33.44827579458554, 33.83456302930911, 51.52218962212403, 51.983566285421446, 51.50896379848321, 50.26060381283362, 50.33561301728089, 50.65006957001363, 50.74990768730639, 50.31566385924815, 50.491561785340295, 40.775815933942795, 42.4958172403276, 41.637256383895874, 47.339778199791894, 47.65304613113402, 47.99415289610623, 46.347647204995155, 46.757310412824154, 46.6685610152781, 53.1290434723099, 52.81601064403851, 53.25651438472171, 43.32729507920642, 43.3199199916174, 42.61179554959138, 50.62346530705689, 50.46818123757838, 50.03428073227404, 42.8436478972435, 43.26609463430941, 42.92153112590313, 24.275092025597885, 24.61679722120364, 24.519139406581715, 42.32769353191057, 42.3937629337112, 42.38234182695547, 46.76666647071639, 46.37030647943416, 46.886692949260265, 43.11678887034455, 42.95372063914934, 43.17978311950961, 14.15482546389103, 14.417977856472135, 14.384396785870194, 47.128009691834436, 47.83084200508891, 47.75104212388395, 42.61164029935995, 42.96612152705589, 42.946610058347375, 53.37909870843093, 53.975415481875345, 53.980342704492315, 46.585903008778885, 46.73839176942904, 46.4608747412761, 45.56667411079009, 45.539353167017296, 45.37603159745534, 47.993097687760994, 48.76368743429582, 48.64272498587768, 55.800789460539804, 56.52476943656801, 56.67254628706722, 44.732926696538925, 45.497519033029675, 44.15572887659073, 51.39755268891652, 51.05687358727057, 51.49995903794964, 17.540396210427076, 17.481001746530325, 17.217735248307378, 49.98150132596491, 50.416774004697785, 50.31184349209069, 50.478339005261645, 50.44721090793608, 50.615895307622836, 58.06588764302431, 57.446706071495996, 57.940979246050105, 45.744421035051346, 46.750438219169155, 46.64774030447006, 43.801580768078566, 43.84128701686859, 41.46767047047615, 45.78614671031633, 45.327056164542824, 46.08675214710334, 38.84854662666717, 39.025117638210446, 39.034591051439435, 45.510733562211186, 45.59653046230474, 45.29765898982683, 56.57258845726027, 55.02132827043532, 56.36498663201927, 43.51742198566595, 43.86126854332784, 43.41645797590414, 47.5783407576382, 47.37378475069998, 47.48172971233724, 47.14412745647131, 46.89672210812567, 46.85107456147669, 47.84806546817224, 48.04451434935133, 47.79298559824626, 35.65599152849366, 35.42896884058912, 35.46227295448382, 46.973631749550506, 47.68429412009816, 47.695276778812215, 55.45206027105449, 55.69878526497631, 54.81711834669112, 48.27447059315939, 48.14344249417384, 47.6369487841924, 39.42391837636629, 39.450866418580205, 39.77774640816884, 44.049687139069036, 44.14759833862384, 43.78089055915673, 44.391852165261895, 44.42226008946696, 44.219340975085885, 53.68112098425625, 53.72799322009085, 53.04639846086501, 50.3845467666785, 50.28265890354912, 50.31422420094411, 46.77031701803206, 46.43824046850203, 46.96472900360821, 59.62733348210652, 59.900849921007946, 59.719552037616566, 52.20150214930375, 52.29691145320733, 52.31480491658051, 43.922675908853606, 43.81834978734453, 43.65888238449891, 37.49494888881841, 38.24728708310673, 38.00604193533459, 53.38911649088065, 53.280062044660255, 53.45827486614387, 43.754975994427994, 44.071251981270805, 43.788694490989045, 53.48762044807275, 53.356387337048844, 53.44666510944565, 53.18933554490407, 53.91026121129592, 53.061266769965485]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14209622060995286, "mean_inference_ms": 0.7023917961900733, "mean_action_processing_ms": 0.0966184162835756, "mean_env_wait_ms": 0.7872908311057634, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 995000, "timesteps_this_iter": 0, "agent_timesteps_total": 2985000, "timers": {"sample_time_ms": 10919.888, "sample_throughput": 457.88, "load_time_ms": 0.299, "load_throughput": 16746402.619, "learn_time_ms": 2124.979, "learn_throughput": 2352.965, "update_time_ms": 9.568}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9243905912663812e-50, "cur_lr": 0.0005000000000000001, "total_loss": 10.144003009796142, "policy_loss": -0.0015312207789191846, "vf_loss": 10.25091028213501, "vf_explained_var": 0.06491848826408386, "kl": 0.002534196426915163, "entropy": 10.537621402740479, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 995000, "num_agent_steps_sampled": 2985000, "num_steps_trained": 995000, "num_agent_steps_trained": 2985000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2666, "training_iteration": 199, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-37-16", "timestamp": 1706233036, "time_this_iter_s": 10.316570520401001, "time_total_s": 2148.5933413505554, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401A96B80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2148.5933413505554, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 6.946666666666667, "ram_util_percent": 63.44666666666667}}
{"episode_reward_max": 179.247735440731, "episode_reward_min": 42.95720010623336, "episode_reward_mean": 136.0332117130555, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 14.15482546389103}, "policy_reward_max": {"shared_policy": 59.900849921007946}, "policy_reward_mean": {"shared_policy": 45.344403904351836}, "custom_metrics": {}, "hist_stats": {"episode_reward": [123.56300545856355, 133.55617113597688, 123.85940319066867, 148.2975862468592, 134.30356605350954, 140.27122129499924, 138.7998137511314, 108.75050289562202, 129.04755192622537, 142.02224970608978, 127.80303195491432, 129.94338257610804, 131.32020952180022, 134.6042949929832, 134.6372993811965, 134.92680725455295, 76.45595247671007, 149.21390822343534, 159.42847852036323, 140.0969307175841, 145.7157351835632, 104.40288196119943, 95.92701550200582, 127.63511195266616, 167.74844400957198, 132.67585531622143, 117.37669446505606, 124.96460132300854, 119.9158586412668, 132.45551926642656, 83.3000676333904, 126.06713104993102, 154.28122933767722, 100.44621223956345, 155.01471970602867, 151.246286400128, 151.55713333189485, 124.90888955816627, 142.98697722703173, 139.77351863309735, 159.2015685010702, 129.2590106204151, 151.1259272769092, 129.031273657456, 73.41102865338324, 127.10379829257724, 140.02366589941127, 129.2502926290035, 42.95720010623336, 142.70989382080734, 128.5243718847632, 161.3348568947985, 139.78516951948433, 136.48205887526274, 145.3995101079345, 168.998105184175, 134.38617460615933, 153.95438531413657, 52.23913320526478, 150.71011882275343, 151.54144522082078, 173.45357296057043, 139.14259955869025, 129.11053825542336, 137.1999550219626, 116.90825531631705, 136.4049230143427, 167.9589033597151, 130.79514850489792, 142.43385522067544, 140.89192412607386, 143.68556541576973, 106.5472333235666, 142.35320264846064, 165.96796388272176, 144.05486187152556, 118.65253120311533, 131.97817603684956, 133.03345322981485, 160.45551266521227, 150.98142987117177, 140.17328649014257, 179.247735440731, 156.81321851909155, 131.39990808069695, 113.74827790725973, 160.1274534016845, 131.61492246668791, 160.2906728945673, 160.16086352616506, 156.5218183249235, 148.5767946168784, 138.62112047616424, 93.93999914824961, 135.28316308092315, 173.56800982542353, 161.4691158495844, 141.35006142407659, 175.91210791096105, 145.76279732445258], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [40.85074474414189, 41.249668945868805, 41.462591768552855, 44.37559834122658, 44.74157820828259, 44.43899458646774, 40.76064956188202, 41.66836957028136, 41.4303840585053, 49.369392973681286, 49.61610077771668, 49.3120924954613, 44.906556787590176, 44.517039279143006, 44.8799699867765, 47.04407709588607, 46.41728489597638, 46.80985930313666, 46.456907896945864, 46.252089629570634, 46.09081622461477, 36.17743326226869, 35.78680274883905, 36.786266884514276, 43.26603994021812, 43.022290303061396, 42.75922168294588, 47.294005530575916, 47.3513590755562, 47.37688509995739, 42.52958694597085, 42.519418244560555, 42.754026764382914, 43.38312968115011, 43.69729496041933, 42.862957934538514, 44.108992610126734, 43.9268234372139, 43.28439347445965, 44.9847702011466, 44.86744646728039, 44.75207832455635, 44.771659304698304, 44.92256554340322, 44.94307453309496, 44.58390408754349, 45.04737598448992, 45.295527182519436, 25.092890997727707, 25.576111552615956, 25.786949926366404, 49.5506475592653, 49.67183400938909, 49.99142665478091, 52.853360792001084, 53.490234316637114, 53.08488341172536, 46.96307486559574, 46.664369878669575, 46.46948597331841, 48.935491938299194, 48.366115982333824, 48.41412726293008, 34.65036565313736, 34.72132274756828, 35.03119356049379, 32.279105961322784, 31.126484006643295, 32.521425534039736, 43.087346768627555, 41.3954983750979, 43.15226680894071, 56.120939467102275, 55.8857141882181, 55.74179035425185, 44.46888583650191, 44.39684561391671, 43.81012386580308, 39.11410711705685, 38.918781504034996, 39.34380584396422, 41.60668157041073, 41.67879894375801, 41.6791208088398, 40.39225317041078, 39.590418259302766, 39.933187211553246, 44.3543214276433, 43.98048835992813, 44.12070947885513, 27.87546048561731, 27.937208438913018, 27.48739870886007, 42.080860945085675, 42.03666907424727, 41.949601030598075, 51.64430607669054, 51.187693342566476, 51.4492299184203, 33.1633734156688, 33.44827579458554, 33.83456302930911, 51.52218962212403, 51.983566285421446, 51.50896379848321, 50.26060381283362, 50.33561301728089, 50.65006957001363, 50.74990768730639, 50.31566385924815, 50.491561785340295, 40.775815933942795, 42.4958172403276, 41.637256383895874, 47.339778199791894, 47.65304613113402, 47.99415289610623, 46.347647204995155, 46.757310412824154, 46.6685610152781, 53.1290434723099, 52.81601064403851, 53.25651438472171, 43.32729507920642, 43.3199199916174, 42.61179554959138, 50.62346530705689, 50.46818123757838, 50.03428073227404, 42.8436478972435, 43.26609463430941, 42.92153112590313, 24.275092025597885, 24.61679722120364, 24.519139406581715, 42.32769353191057, 42.3937629337112, 42.38234182695547, 46.76666647071639, 46.37030647943416, 46.886692949260265, 43.11678887034455, 42.95372063914934, 43.17978311950961, 14.15482546389103, 14.417977856472135, 14.384396785870194, 47.128009691834436, 47.83084200508891, 47.75104212388395, 42.61164029935995, 42.96612152705589, 42.946610058347375, 53.37909870843093, 53.975415481875345, 53.980342704492315, 46.585903008778885, 46.73839176942904, 46.4608747412761, 45.56667411079009, 45.539353167017296, 45.37603159745534, 47.993097687760994, 48.76368743429582, 48.64272498587768, 55.800789460539804, 56.52476943656801, 56.67254628706722, 44.732926696538925, 45.497519033029675, 44.15572887659073, 51.39755268891652, 51.05687358727057, 51.49995903794964, 17.540396210427076, 17.481001746530325, 17.217735248307378, 49.98150132596491, 50.416774004697785, 50.31184349209069, 50.478339005261645, 50.44721090793608, 50.615895307622836, 58.06588764302431, 57.446706071495996, 57.940979246050105, 45.744421035051346, 46.750438219169155, 46.64774030447006, 43.801580768078566, 43.84128701686859, 41.46767047047615, 45.78614671031633, 45.327056164542824, 46.08675214710334, 38.84854662666717, 39.025117638210446, 39.034591051439435, 45.510733562211186, 45.59653046230474, 45.29765898982683, 56.57258845726027, 55.02132827043532, 56.36498663201927, 43.51742198566595, 43.86126854332784, 43.41645797590414, 47.5783407576382, 47.37378475069998, 47.48172971233724, 47.14412745647131, 46.89672210812567, 46.85107456147669, 47.84806546817224, 48.04451434935133, 47.79298559824626, 35.65599152849366, 35.42896884058912, 35.46227295448382, 46.973631749550506, 47.68429412009816, 47.695276778812215, 55.45206027105449, 55.69878526497631, 54.81711834669112, 48.27447059315939, 48.14344249417384, 47.6369487841924, 39.42391837636629, 39.450866418580205, 39.77774640816884, 44.049687139069036, 44.14759833862384, 43.78089055915673, 44.391852165261895, 44.42226008946696, 44.219340975085885, 53.68112098425625, 53.72799322009085, 53.04639846086501, 50.3845467666785, 50.28265890354912, 50.31422420094411, 46.77031701803206, 46.43824046850203, 46.96472900360821, 59.62733348210652, 59.900849921007946, 59.719552037616566, 52.20150214930375, 52.29691145320733, 52.31480491658051, 43.922675908853606, 43.81834978734453, 43.65888238449891, 37.49494888881841, 38.24728708310673, 38.00604193533459, 53.38911649088065, 53.280062044660255, 53.45827486614387, 43.754975994427994, 44.071251981270805, 43.788694490989045, 53.48762044807275, 53.356387337048844, 53.44666510944565, 53.18933554490407, 53.91026121129592, 53.061266769965485, 52.810700654983506, 50.96816164255141, 52.74295602738856, 49.43762404719989, 49.861583280066654, 49.2775872896115, 46.440918003208935, 46.286355908960104, 45.893846563994884, 29.7079240878423, 32.08095375200112, 32.15112130840619, 45.34454306680709, 45.28661076538265, 44.65200924873352, 57.31546507775782, 58.228706145659075, 58.02383860200642, 53.939417765786246, 53.63898496826489, 53.89071311553319, 47.063923284411416, 47.123388621956096, 47.162749517709, 58.6696018129587, 58.52419766038655, 58.71830843761562, 48.731735396975026, 48.51883538936575, 48.51222653811176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14209237633168775, "mean_inference_ms": 0.702487122358935, "mean_action_processing_ms": 0.096629127314368, "mean_env_wait_ms": 0.7872463896256344, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1000000, "timesteps_this_iter": 0, "agent_timesteps_total": 3000000, "timers": {"sample_time_ms": 10897.518, "sample_throughput": 458.82, "load_time_ms": 0.299, "load_throughput": 16746402.619, "learn_time_ms": 2106.673, "learn_throughput": 2373.411, "update_time_ms": 9.166}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.621952956331906e-51, "cur_lr": 0.0005000000000000001, "total_loss": 8.20724105834961, "policy_loss": 0.001488713073792347, "vf_loss": 8.308983325958252, "vf_explained_var": 0.0841050922870636, "kl": 0.013915021251942827, "entropy": 10.323102760314942, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1000000, "num_agent_steps_sampled": 3000000, "num_steps_trained": 1000000, "num_agent_steps_trained": 3000000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 183.5269933212548, "episode_reward_min": 100.38712076842783, "episode_reward_mean": 139.45409672111273, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 32.88697225352128}, "policy_reward_max": {"shared_policy": 61.479056596135095}, "policy_reward_mean": {"shared_policy": 46.48469890703756}, "custom_metrics": {}, "hist_stats": {"episode_reward": [124.38447751291093, 146.07428751140836, 100.38712076842783, 136.16834665834904, 137.13034274335953, 132.1642305590213, 134.15305241942417, 142.75349676050237, 183.5269933212548, 157.79861895646897], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [41.2959161872665, 41.504489249239356, 41.58407207640508, 48.62976347158353, 48.68388182545702, 48.76064221436779, 32.88697225352128, 33.67712437485655, 33.82302414005001, 45.5066608240207, 45.570923422773674, 45.09076241155465, 45.31901450455189, 46.0940058818087, 45.71732235699892, 43.30186544855435, 44.20119575162728, 44.66116935883959, 44.50491152703762, 44.917811173945665, 44.73032971844077, 47.15015649298827, 48.06854553955297, 47.53479472796123, 60.82274321218331, 61.22519351293643, 61.479056596135095, 52.874001501438514, 52.81458062989016, 52.11003682514031]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1298371209978295, "mean_inference_ms": 0.708785935219206, "mean_action_processing_ms": 0.09746784081186652, "mean_env_wait_ms": 0.7822658750636722, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 2676, "training_iteration": 200, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-37-34", "timestamp": 1706233054, "time_this_iter_s": 18.365349769592285, "time_total_s": 2166.9586911201477, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140234DF70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2166.9586911201477, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 5.000000000000001, "ram_util_percent": 63.39999999999999}}
{"episode_reward_max": 193.52775999903713, "episode_reward_min": 42.95720010623336, "episode_reward_mean": 138.52728927392397, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 14.15482546389103}, "policy_reward_max": {"shared_policy": 64.9351534359157}, "policy_reward_mean": {"shared_policy": 46.17576309130798}, "custom_metrics": {}, "hist_stats": {"episode_reward": [127.80303195491432, 129.94338257610804, 131.32020952180022, 134.6042949929832, 134.6372993811965, 134.92680725455295, 76.45595247671007, 149.21390822343534, 159.42847852036323, 140.0969307175841, 145.7157351835632, 104.40288196119943, 95.92701550200582, 127.63511195266616, 167.74844400957198, 132.67585531622143, 117.37669446505606, 124.96460132300854, 119.9158586412668, 132.45551926642656, 83.3000676333904, 126.06713104993102, 154.28122933767722, 100.44621223956345, 155.01471970602867, 151.246286400128, 151.55713333189485, 124.90888955816627, 142.98697722703173, 139.77351863309735, 159.2015685010702, 129.2590106204151, 151.1259272769092, 129.031273657456, 73.41102865338324, 127.10379829257724, 140.02366589941127, 129.2502926290035, 42.95720010623336, 142.70989382080734, 128.5243718847632, 161.3348568947985, 139.78516951948433, 136.48205887526274, 145.3995101079345, 168.998105184175, 134.38617460615933, 153.95438531413657, 52.23913320526478, 150.71011882275343, 151.54144522082078, 173.45357296057043, 139.14259955869025, 129.11053825542336, 137.1999550219626, 116.90825531631705, 136.4049230143427, 167.9589033597151, 130.79514850489792, 142.43385522067544, 140.89192412607386, 143.68556541576973, 106.5472333235666, 142.35320264846064, 165.96796388272176, 144.05486187152556, 118.65253120311533, 131.97817603684956, 133.03345322981485, 160.45551266521227, 150.98142987117177, 140.17328649014257, 179.247735440731, 156.81321851909155, 131.39990808069695, 113.74827790725973, 160.1274534016845, 131.61492246668791, 160.2906728945673, 160.16086352616506, 156.5218183249235, 148.5767946168784, 138.62112047616424, 93.93999914824961, 135.28316308092315, 173.56800982542353, 161.4691158495844, 141.35006142407659, 175.91210791096105, 145.76279732445258, 158.1017343178391, 171.92538037896168, 156.2301813773811, 129.2710543498397, 190.16997329704446, 144.48950925469404, 145.8820608672685, 193.52775999903713, 130.7333938004448, 151.54778010398178], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [42.52958694597085, 42.519418244560555, 42.754026764382914, 43.38312968115011, 43.69729496041933, 42.862957934538514, 44.108992610126734, 43.9268234372139, 43.28439347445965, 44.9847702011466, 44.86744646728039, 44.75207832455635, 44.771659304698304, 44.92256554340322, 44.94307453309496, 44.58390408754349, 45.04737598448992, 45.295527182519436, 25.092890997727707, 25.576111552615956, 25.786949926366404, 49.5506475592653, 49.67183400938909, 49.99142665478091, 52.853360792001084, 53.490234316637114, 53.08488341172536, 46.96307486559574, 46.664369878669575, 46.46948597331841, 48.935491938299194, 48.366115982333824, 48.41412726293008, 34.65036565313736, 34.72132274756828, 35.03119356049379, 32.279105961322784, 31.126484006643295, 32.521425534039736, 43.087346768627555, 41.3954983750979, 43.15226680894071, 56.120939467102275, 55.8857141882181, 55.74179035425185, 44.46888583650191, 44.39684561391671, 43.81012386580308, 39.11410711705685, 38.918781504034996, 39.34380584396422, 41.60668157041073, 41.67879894375801, 41.6791208088398, 40.39225317041078, 39.590418259302766, 39.933187211553246, 44.3543214276433, 43.98048835992813, 44.12070947885513, 27.87546048561731, 27.937208438913018, 27.48739870886007, 42.080860945085675, 42.03666907424727, 41.949601030598075, 51.64430607669054, 51.187693342566476, 51.4492299184203, 33.1633734156688, 33.44827579458554, 33.83456302930911, 51.52218962212403, 51.983566285421446, 51.50896379848321, 50.26060381283362, 50.33561301728089, 50.65006957001363, 50.74990768730639, 50.31566385924815, 50.491561785340295, 40.775815933942795, 42.4958172403276, 41.637256383895874, 47.339778199791894, 47.65304613113402, 47.99415289610623, 46.347647204995155, 46.757310412824154, 46.6685610152781, 53.1290434723099, 52.81601064403851, 53.25651438472171, 43.32729507920642, 43.3199199916174, 42.61179554959138, 50.62346530705689, 50.46818123757838, 50.03428073227404, 42.8436478972435, 43.26609463430941, 42.92153112590313, 24.275092025597885, 24.61679722120364, 24.519139406581715, 42.32769353191057, 42.3937629337112, 42.38234182695547, 46.76666647071639, 46.37030647943416, 46.886692949260265, 43.11678887034455, 42.95372063914934, 43.17978311950961, 14.15482546389103, 14.417977856472135, 14.384396785870194, 47.128009691834436, 47.83084200508891, 47.75104212388395, 42.61164029935995, 42.96612152705589, 42.946610058347375, 53.37909870843093, 53.975415481875345, 53.980342704492315, 46.585903008778885, 46.73839176942904, 46.4608747412761, 45.56667411079009, 45.539353167017296, 45.37603159745534, 47.993097687760994, 48.76368743429582, 48.64272498587768, 55.800789460539804, 56.52476943656801, 56.67254628706722, 44.732926696538925, 45.497519033029675, 44.15572887659073, 51.39755268891652, 51.05687358727057, 51.49995903794964, 17.540396210427076, 17.481001746530325, 17.217735248307378, 49.98150132596491, 50.416774004697785, 50.31184349209069, 50.478339005261645, 50.44721090793608, 50.615895307622836, 58.06588764302431, 57.446706071495996, 57.940979246050105, 45.744421035051346, 46.750438219169155, 46.64774030447006, 43.801580768078566, 43.84128701686859, 41.46767047047615, 45.78614671031633, 45.327056164542824, 46.08675214710334, 38.84854662666717, 39.025117638210446, 39.034591051439435, 45.510733562211186, 45.59653046230474, 45.29765898982683, 56.57258845726027, 55.02132827043532, 56.36498663201927, 43.51742198566595, 43.86126854332784, 43.41645797590414, 47.5783407576382, 47.37378475069998, 47.48172971233724, 47.14412745647131, 46.89672210812567, 46.85107456147669, 47.84806546817224, 48.04451434935133, 47.79298559824626, 35.65599152849366, 35.42896884058912, 35.46227295448382, 46.973631749550506, 47.68429412009816, 47.695276778812215, 55.45206027105449, 55.69878526497631, 54.81711834669112, 48.27447059315939, 48.14344249417384, 47.6369487841924, 39.42391837636629, 39.450866418580205, 39.77774640816884, 44.049687139069036, 44.14759833862384, 43.78089055915673, 44.391852165261895, 44.42226008946696, 44.219340975085885, 53.68112098425625, 53.72799322009085, 53.04639846086501, 50.3845467666785, 50.28265890354912, 50.31422420094411, 46.77031701803206, 46.43824046850203, 46.96472900360821, 59.62733348210652, 59.900849921007946, 59.719552037616566, 52.20150214930375, 52.29691145320733, 52.31480491658051, 43.922675908853606, 43.81834978734453, 43.65888238449891, 37.49494888881841, 38.24728708310673, 38.00604193533459, 53.38911649088065, 53.280062044660255, 53.45827486614387, 43.754975994427994, 44.071251981270805, 43.788694490989045, 53.48762044807275, 53.356387337048844, 53.44666510944565, 53.18933554490407, 53.91026121129592, 53.061266769965485, 52.810700654983506, 50.96816164255141, 52.74295602738856, 49.43762404719989, 49.861583280066654, 49.2775872896115, 46.440918003208935, 46.286355908960104, 45.893846563994884, 29.7079240878423, 32.08095375200112, 32.15112130840619, 45.34454306680709, 45.28661076538265, 44.65200924873352, 57.31546507775782, 58.228706145659075, 58.02383860200642, 53.939417765786246, 53.63898496826489, 53.89071311553319, 47.063923284411416, 47.123388621956096, 47.162749517709, 58.6696018129587, 58.52419766038655, 58.71830843761562, 48.731735396975026, 48.51883538936575, 48.51222653811176, 52.631924904882894, 52.661073997616754, 52.808735415339456, 57.16874753435452, 57.826438670357064, 56.93019417424996, 51.95684054121374, 52.15745854377745, 52.115882292389855, 43.018254801630974, 43.42753482609987, 42.82526472210884, 63.04709182679652, 63.71577624790369, 63.407105222344384, 47.33273007472356, 48.534438438092664, 48.62234074187775, 48.52506063630183, 48.26945636173089, 49.08754386923586, 64.9351534359157, 64.8441711552441, 63.748435407876954, 43.66484340031941, 43.285621253152684, 43.78292914697279, 49.922896037499115, 50.396574149529144, 51.22830991695325]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14208421145271227, "mean_inference_ms": 0.7025534698462, "mean_action_processing_ms": 0.09663692225706118, "mean_env_wait_ms": 0.7871872727044876, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1005000, "timesteps_this_iter": 0, "agent_timesteps_total": 3015000, "timers": {"sample_time_ms": 11646.542, "sample_throughput": 429.312, "load_time_ms": 0.299, "load_throughput": 16746402.619, "learn_time_ms": 2093.759, "learn_throughput": 2388.05, "update_time_ms": 8.99}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.621952956331906e-51, "cur_lr": 0.0005000000000000001, "total_loss": 12.090609073638916, "policy_loss": 0.0005668421953590741, "vf_loss": 12.192238044738769, "vf_explained_var": 0.05796624422073364, "kl": 0.005066771851907683, "entropy": 10.21958532333374, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1005000, "num_agent_steps_sampled": 3015000, "num_steps_trained": 1005000, "num_agent_steps_trained": 3015000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2686, "training_iteration": 201, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-37-45", "timestamp": 1706233065, "time_this_iter_s": 10.344598293304443, "time_total_s": 2177.303289413452, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D8C5E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2177.303289413452, "timesteps_since_restore": 0, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 6.88, "ram_util_percent": 63.446666666666665}}
{"episode_reward_max": 193.52775999903713, "episode_reward_min": 42.95720010623336, "episode_reward_mean": 140.360164298421, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 14.15482546389103}, "policy_reward_max": {"shared_policy": 64.9351534359157}, "policy_reward_mean": {"shared_policy": 46.78672143280699}, "custom_metrics": {}, "hist_stats": {"episode_reward": [145.7157351835632, 104.40288196119943, 95.92701550200582, 127.63511195266616, 167.74844400957198, 132.67585531622143, 117.37669446505606, 124.96460132300854, 119.9158586412668, 132.45551926642656, 83.3000676333904, 126.06713104993102, 154.28122933767722, 100.44621223956345, 155.01471970602867, 151.246286400128, 151.55713333189485, 124.90888955816627, 142.98697722703173, 139.77351863309735, 159.2015685010702, 129.2590106204151, 151.1259272769092, 129.031273657456, 73.41102865338324, 127.10379829257724, 140.02366589941127, 129.2502926290035, 42.95720010623336, 142.70989382080734, 128.5243718847632, 161.3348568947985, 139.78516951948433, 136.48205887526274, 145.3995101079345, 168.998105184175, 134.38617460615933, 153.95438531413657, 52.23913320526478, 150.71011882275343, 151.54144522082078, 173.45357296057043, 139.14259955869025, 129.11053825542336, 137.1999550219626, 116.90825531631705, 136.4049230143427, 167.9589033597151, 130.79514850489792, 142.43385522067544, 140.89192412607386, 143.68556541576973, 106.5472333235666, 142.35320264846064, 165.96796388272176, 144.05486187152556, 118.65253120311533, 131.97817603684956, 133.03345322981485, 160.45551266521227, 150.98142987117177, 140.17328649014257, 179.247735440731, 156.81321851909155, 131.39990808069695, 113.74827790725973, 160.1274534016845, 131.61492246668791, 160.2906728945673, 160.16086352616506, 156.5218183249235, 148.5767946168784, 138.62112047616424, 93.93999914824961, 135.28316308092315, 173.56800982542353, 161.4691158495844, 141.35006142407659, 175.91210791096105, 145.76279732445258, 158.1017343178391, 171.92538037896168, 156.2301813773811, 129.2710543498397, 190.16997329704446, 144.48950925469404, 145.8820608672685, 193.52775999903713, 130.7333938004448, 151.54778010398178, 147.29928637715034, 157.8481783568859, 142.07478412054502, 136.27818281948583, 135.85134034603828, 178.5348838195203, 98.94072666042484, 177.5026169172483, 164.85778250545258, 162.53001614660008], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [48.935491938299194, 48.366115982333824, 48.41412726293008, 34.65036565313736, 34.72132274756828, 35.03119356049379, 32.279105961322784, 31.126484006643295, 32.521425534039736, 43.087346768627555, 41.3954983750979, 43.15226680894071, 56.120939467102275, 55.8857141882181, 55.74179035425185, 44.46888583650191, 44.39684561391671, 43.81012386580308, 39.11410711705685, 38.918781504034996, 39.34380584396422, 41.60668157041073, 41.67879894375801, 41.6791208088398, 40.39225317041078, 39.590418259302766, 39.933187211553246, 44.3543214276433, 43.98048835992813, 44.12070947885513, 27.87546048561731, 27.937208438913018, 27.48739870886007, 42.080860945085675, 42.03666907424727, 41.949601030598075, 51.64430607669054, 51.187693342566476, 51.4492299184203, 33.1633734156688, 33.44827579458554, 33.83456302930911, 51.52218962212403, 51.983566285421446, 51.50896379848321, 50.26060381283362, 50.33561301728089, 50.65006957001363, 50.74990768730639, 50.31566385924815, 50.491561785340295, 40.775815933942795, 42.4958172403276, 41.637256383895874, 47.339778199791894, 47.65304613113402, 47.99415289610623, 46.347647204995155, 46.757310412824154, 46.6685610152781, 53.1290434723099, 52.81601064403851, 53.25651438472171, 43.32729507920642, 43.3199199916174, 42.61179554959138, 50.62346530705689, 50.46818123757838, 50.03428073227404, 42.8436478972435, 43.26609463430941, 42.92153112590313, 24.275092025597885, 24.61679722120364, 24.519139406581715, 42.32769353191057, 42.3937629337112, 42.38234182695547, 46.76666647071639, 46.37030647943416, 46.886692949260265, 43.11678887034455, 42.95372063914934, 43.17978311950961, 14.15482546389103, 14.417977856472135, 14.384396785870194, 47.128009691834436, 47.83084200508891, 47.75104212388395, 42.61164029935995, 42.96612152705589, 42.946610058347375, 53.37909870843093, 53.975415481875345, 53.980342704492315, 46.585903008778885, 46.73839176942904, 46.4608747412761, 45.56667411079009, 45.539353167017296, 45.37603159745534, 47.993097687760994, 48.76368743429582, 48.64272498587768, 55.800789460539804, 56.52476943656801, 56.67254628706722, 44.732926696538925, 45.497519033029675, 44.15572887659073, 51.39755268891652, 51.05687358727057, 51.49995903794964, 17.540396210427076, 17.481001746530325, 17.217735248307378, 49.98150132596491, 50.416774004697785, 50.31184349209069, 50.478339005261645, 50.44721090793608, 50.615895307622836, 58.06588764302431, 57.446706071495996, 57.940979246050105, 45.744421035051346, 46.750438219169155, 46.64774030447006, 43.801580768078566, 43.84128701686859, 41.46767047047615, 45.78614671031633, 45.327056164542824, 46.08675214710334, 38.84854662666717, 39.025117638210446, 39.034591051439435, 45.510733562211186, 45.59653046230474, 45.29765898982683, 56.57258845726027, 55.02132827043532, 56.36498663201927, 43.51742198566595, 43.86126854332784, 43.41645797590414, 47.5783407576382, 47.37378475069998, 47.48172971233724, 47.14412745647131, 46.89672210812567, 46.85107456147669, 47.84806546817224, 48.04451434935133, 47.79298559824626, 35.65599152849366, 35.42896884058912, 35.46227295448382, 46.973631749550506, 47.68429412009816, 47.695276778812215, 55.45206027105449, 55.69878526497631, 54.81711834669112, 48.27447059315939, 48.14344249417384, 47.6369487841924, 39.42391837636629, 39.450866418580205, 39.77774640816884, 44.049687139069036, 44.14759833862384, 43.78089055915673, 44.391852165261895, 44.42226008946696, 44.219340975085885, 53.68112098425625, 53.72799322009085, 53.04639846086501, 50.3845467666785, 50.28265890354912, 50.31422420094411, 46.77031701803206, 46.43824046850203, 46.96472900360821, 59.62733348210652, 59.900849921007946, 59.719552037616566, 52.20150214930375, 52.29691145320733, 52.31480491658051, 43.922675908853606, 43.81834978734453, 43.65888238449891, 37.49494888881841, 38.24728708310673, 38.00604193533459, 53.38911649088065, 53.280062044660255, 53.45827486614387, 43.754975994427994, 44.071251981270805, 43.788694490989045, 53.48762044807275, 53.356387337048844, 53.44666510944565, 53.18933554490407, 53.91026121129592, 53.061266769965485, 52.810700654983506, 50.96816164255141, 52.74295602738856, 49.43762404719989, 49.861583280066654, 49.2775872896115, 46.440918003208935, 46.286355908960104, 45.893846563994884, 29.7079240878423, 32.08095375200112, 32.15112130840619, 45.34454306680709, 45.28661076538265, 44.65200924873352, 57.31546507775782, 58.228706145659075, 58.02383860200642, 53.939417765786246, 53.63898496826489, 53.89071311553319, 47.063923284411416, 47.123388621956096, 47.162749517709, 58.6696018129587, 58.52419766038655, 58.71830843761562, 48.731735396975026, 48.51883538936575, 48.51222653811176, 52.631924904882894, 52.661073997616754, 52.808735415339456, 57.16874753435452, 57.826438670357064, 56.93019417424996, 51.95684054121374, 52.15745854377745, 52.115882292389855, 43.018254801630974, 43.42753482609987, 42.82526472210884, 63.04709182679652, 63.71577624790369, 63.407105222344384, 47.33273007472356, 48.534438438092664, 48.62234074187775, 48.52506063630183, 48.26945636173089, 49.08754386923586, 64.9351534359157, 64.8441711552441, 63.748435407876954, 43.66484340031941, 43.285621253152684, 43.78292914697279, 49.922896037499115, 50.396574149529144, 51.22830991695325, 48.72185484071572, 49.132195604344204, 49.445235932090625, 52.66625899324815, 52.35273584226768, 52.8291835213701, 47.37583203117053, 47.694653839493796, 47.00429824988048, 45.595379680395126, 45.35823492705822, 45.32456821203232, 45.53495518739024, 44.92004750172296, 45.39633765692511, 59.58819483717282, 59.32820306469996, 59.618485917647675, 33.06485597346909, 32.8689379543066, 33.00693273264915, 58.764604881405816, 59.60459853475912, 59.13341350108384, 54.99717502792676, 54.9528645624717, 54.90774291505416, 53.54580860336621, 54.68495361258586, 54.29925393064816]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14208694198040292, "mean_inference_ms": 0.7026304134422687, "mean_action_processing_ms": 0.09664359409641364, "mean_env_wait_ms": 0.7871464684339586, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1010000, "timesteps_this_iter": 0, "agent_timesteps_total": 3030000, "timers": {"sample_time_ms": 11674.34, "sample_throughput": 428.29, "load_time_ms": 0.199, "load_throughput": 25172872.404, "learn_time_ms": 2090.651, "learn_throughput": 2391.6, "update_time_ms": 9.14}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.621952956331906e-51, "cur_lr": 0.0005000000000000001, "total_loss": 10.425487041473389, "policy_loss": -0.000449984834269479, "vf_loss": 10.529366493225098, "vf_explained_var": 0.05968877673149109, "kl": 0.004513205937166283, "entropy": 10.343000221252442, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1010000, "num_agent_steps_sampled": 3030000, "num_steps_trained": 1010000, "num_agent_steps_trained": 3030000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2696, "training_iteration": 202, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-37-55", "timestamp": 1706233075, "time_this_iter_s": 10.539815902709961, "time_total_s": 2187.843105316162, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002146F7AC430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2187.843105316162, "timesteps_since_restore": 0, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 5.557142857142856, "ram_util_percent": 63.478571428571435}}
{"episode_reward_max": 193.52775999903713, "episode_reward_min": 42.95720010623336, "episode_reward_mean": 140.78330888111142, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 14.15482546389103}, "policy_reward_max": {"shared_policy": 64.9351534359157}, "policy_reward_mean": {"shared_policy": 46.92776962703714}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.3000676333904, 126.06713104993102, 154.28122933767722, 100.44621223956345, 155.01471970602867, 151.246286400128, 151.55713333189485, 124.90888955816627, 142.98697722703173, 139.77351863309735, 159.2015685010702, 129.2590106204151, 151.1259272769092, 129.031273657456, 73.41102865338324, 127.10379829257724, 140.02366589941127, 129.2502926290035, 42.95720010623336, 142.70989382080734, 128.5243718847632, 161.3348568947985, 139.78516951948433, 136.48205887526274, 145.3995101079345, 168.998105184175, 134.38617460615933, 153.95438531413657, 52.23913320526478, 150.71011882275343, 151.54144522082078, 173.45357296057043, 139.14259955869025, 129.11053825542336, 137.1999550219626, 116.90825531631705, 136.4049230143427, 167.9589033597151, 130.79514850489792, 142.43385522067544, 140.89192412607386, 143.68556541576973, 106.5472333235666, 142.35320264846064, 165.96796388272176, 144.05486187152556, 118.65253120311533, 131.97817603684956, 133.03345322981485, 160.45551266521227, 150.98142987117177, 140.17328649014257, 179.247735440731, 156.81321851909155, 131.39990808069695, 113.74827790725973, 160.1274534016845, 131.61492246668791, 160.2906728945673, 160.16086352616506, 156.5218183249235, 148.5767946168784, 138.62112047616424, 93.93999914824961, 135.28316308092315, 173.56800982542353, 161.4691158495844, 141.35006142407659, 175.91210791096105, 145.76279732445258, 158.1017343178391, 171.92538037896168, 156.2301813773811, 129.2710543498397, 190.16997329704446, 144.48950925469404, 145.8820608672685, 193.52775999903713, 130.7333938004448, 151.54778010398178, 147.29928637715034, 157.8481783568859, 142.07478412054502, 136.27818281948583, 135.85134034603828, 178.5348838195203, 98.94072666042484, 177.5026169172483, 164.85778250545258, 162.53001614660008, 147.78048255667085, 148.451304525137, 131.35638422518986, 141.1409359164534, 146.53087410703307, 117.8588923513889, 150.4583768881858, 133.2755774222314, 43.20834509283304, 151.07100280490693], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [27.87546048561731, 27.937208438913018, 27.48739870886007, 42.080860945085675, 42.03666907424727, 41.949601030598075, 51.64430607669054, 51.187693342566476, 51.4492299184203, 33.1633734156688, 33.44827579458554, 33.83456302930911, 51.52218962212403, 51.983566285421446, 51.50896379848321, 50.26060381283362, 50.33561301728089, 50.65006957001363, 50.74990768730639, 50.31566385924815, 50.491561785340295, 40.775815933942795, 42.4958172403276, 41.637256383895874, 47.339778199791894, 47.65304613113402, 47.99415289610623, 46.347647204995155, 46.757310412824154, 46.6685610152781, 53.1290434723099, 52.81601064403851, 53.25651438472171, 43.32729507920642, 43.3199199916174, 42.61179554959138, 50.62346530705689, 50.46818123757838, 50.03428073227404, 42.8436478972435, 43.26609463430941, 42.92153112590313, 24.275092025597885, 24.61679722120364, 24.519139406581715, 42.32769353191057, 42.3937629337112, 42.38234182695547, 46.76666647071639, 46.37030647943416, 46.886692949260265, 43.11678887034455, 42.95372063914934, 43.17978311950961, 14.15482546389103, 14.417977856472135, 14.384396785870194, 47.128009691834436, 47.83084200508891, 47.75104212388395, 42.61164029935995, 42.96612152705589, 42.946610058347375, 53.37909870843093, 53.975415481875345, 53.980342704492315, 46.585903008778885, 46.73839176942904, 46.4608747412761, 45.56667411079009, 45.539353167017296, 45.37603159745534, 47.993097687760994, 48.76368743429582, 48.64272498587768, 55.800789460539804, 56.52476943656801, 56.67254628706722, 44.732926696538925, 45.497519033029675, 44.15572887659073, 51.39755268891652, 51.05687358727057, 51.49995903794964, 17.540396210427076, 17.481001746530325, 17.217735248307378, 49.98150132596491, 50.416774004697785, 50.31184349209069, 50.478339005261645, 50.44721090793608, 50.615895307622836, 58.06588764302431, 57.446706071495996, 57.940979246050105, 45.744421035051346, 46.750438219169155, 46.64774030447006, 43.801580768078566, 43.84128701686859, 41.46767047047615, 45.78614671031633, 45.327056164542824, 46.08675214710334, 38.84854662666717, 39.025117638210446, 39.034591051439435, 45.510733562211186, 45.59653046230474, 45.29765898982683, 56.57258845726027, 55.02132827043532, 56.36498663201927, 43.51742198566595, 43.86126854332784, 43.41645797590414, 47.5783407576382, 47.37378475069998, 47.48172971233724, 47.14412745647131, 46.89672210812567, 46.85107456147669, 47.84806546817224, 48.04451434935133, 47.79298559824626, 35.65599152849366, 35.42896884058912, 35.46227295448382, 46.973631749550506, 47.68429412009816, 47.695276778812215, 55.45206027105449, 55.69878526497631, 54.81711834669112, 48.27447059315939, 48.14344249417384, 47.6369487841924, 39.42391837636629, 39.450866418580205, 39.77774640816884, 44.049687139069036, 44.14759833862384, 43.78089055915673, 44.391852165261895, 44.42226008946696, 44.219340975085885, 53.68112098425625, 53.72799322009085, 53.04639846086501, 50.3845467666785, 50.28265890354912, 50.31422420094411, 46.77031701803206, 46.43824046850203, 46.96472900360821, 59.62733348210652, 59.900849921007946, 59.719552037616566, 52.20150214930375, 52.29691145320733, 52.31480491658051, 43.922675908853606, 43.81834978734453, 43.65888238449891, 37.49494888881841, 38.24728708310673, 38.00604193533459, 53.38911649088065, 53.280062044660255, 53.45827486614387, 43.754975994427994, 44.071251981270805, 43.788694490989045, 53.48762044807275, 53.356387337048844, 53.44666510944565, 53.18933554490407, 53.91026121129592, 53.061266769965485, 52.810700654983506, 50.96816164255141, 52.74295602738856, 49.43762404719989, 49.861583280066654, 49.2775872896115, 46.440918003208935, 46.286355908960104, 45.893846563994884, 29.7079240878423, 32.08095375200112, 32.15112130840619, 45.34454306680709, 45.28661076538265, 44.65200924873352, 57.31546507775782, 58.228706145659075, 58.02383860200642, 53.939417765786246, 53.63898496826489, 53.89071311553319, 47.063923284411416, 47.123388621956096, 47.162749517709, 58.6696018129587, 58.52419766038655, 58.71830843761562, 48.731735396975026, 48.51883538936575, 48.51222653811176, 52.631924904882894, 52.661073997616754, 52.808735415339456, 57.16874753435452, 57.826438670357064, 56.93019417424996, 51.95684054121374, 52.15745854377745, 52.115882292389855, 43.018254801630974, 43.42753482609987, 42.82526472210884, 63.04709182679652, 63.71577624790369, 63.407105222344384, 47.33273007472356, 48.534438438092664, 48.62234074187775, 48.52506063630183, 48.26945636173089, 49.08754386923586, 64.9351534359157, 64.8441711552441, 63.748435407876954, 43.66484340031941, 43.285621253152684, 43.78292914697279, 49.922896037499115, 50.396574149529144, 51.22830991695325, 48.72185484071572, 49.132195604344204, 49.445235932090625, 52.66625899324815, 52.35273584226768, 52.8291835213701, 47.37583203117053, 47.694653839493796, 47.00429824988048, 45.595379680395126, 45.35823492705822, 45.32456821203232, 45.53495518739024, 44.92004750172296, 45.39633765692511, 59.58819483717282, 59.32820306469996, 59.618485917647675, 33.06485597346909, 32.8689379543066, 33.00693273264915, 58.764604881405816, 59.60459853475912, 59.13341350108384, 54.99717502792676, 54.9528645624717, 54.90774291505416, 53.54580860336621, 54.68495361258586, 54.29925393064816, 49.36667654414971, 49.7133217913409, 48.700484221180275, 49.49081129580735, 49.5092809870839, 49.45121224224566, 43.92933089037736, 43.60865957786639, 43.81839375694592, 46.64748863379161, 47.05425635973613, 47.439190922925874, 49.007938748225556, 48.535141266882405, 48.98779409192501, 38.85445568958917, 39.436714763442666, 39.567721898357064, 50.074817841251686, 50.26974531387289, 50.11381373306115, 44.30621711413065, 44.84526131177941, 44.12409899632135, 14.238050155341625, 14.484244421124458, 14.486050516366959, 50.26167823125918, 50.21767718841632, 50.591647385231525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14208490009548957, "mean_inference_ms": 0.7027516559501202, "mean_action_processing_ms": 0.09665406777232027, "mean_env_wait_ms": 0.78712884570179, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1015000, "timesteps_this_iter": 0, "agent_timesteps_total": 3045000, "timers": {"sample_time_ms": 11736.431, "sample_throughput": 426.024, "load_time_ms": 0.1, "load_throughput": 50171100.478, "learn_time_ms": 2074.275, "learn_throughput": 2410.481, "update_time_ms": 9.174}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.810976478165953e-51, "cur_lr": 0.0005000000000000001, "total_loss": 11.419424533843994, "policy_loss": -0.001623805951331736, "vf_loss": 11.5243896484375, "vf_explained_var": -0.010079169273376464, "kl": 0.0032221808098821954, "entropy": 10.334128665924073, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1015000, "num_agent_steps_sampled": 3045000, "num_steps_trained": 1015000, "num_agent_steps_trained": 3045000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2706, "training_iteration": 203, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-38-06", "timestamp": 1706233086, "time_this_iter_s": 10.820136785507202, "time_total_s": 2198.6632421016693, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002146F566430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2198.6632421016693, "timesteps_since_restore": 0, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 7.66875, "ram_util_percent": 63.41875}}
{"episode_reward_max": 193.52775999903713, "episode_reward_min": 42.95720010623336, "episode_reward_mean": 143.1559311403762, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 14.15482546389103}, "policy_reward_max": {"shared_policy": 64.9351534359157}, "policy_reward_mean": {"shared_policy": 47.71864371345872}, "custom_metrics": {}, "hist_stats": {"episode_reward": [159.2015685010702, 129.2590106204151, 151.1259272769092, 129.031273657456, 73.41102865338324, 127.10379829257724, 140.02366589941127, 129.2502926290035, 42.95720010623336, 142.70989382080734, 128.5243718847632, 161.3348568947985, 139.78516951948433, 136.48205887526274, 145.3995101079345, 168.998105184175, 134.38617460615933, 153.95438531413657, 52.23913320526478, 150.71011882275343, 151.54144522082078, 173.45357296057043, 139.14259955869025, 129.11053825542336, 137.1999550219626, 116.90825531631705, 136.4049230143427, 167.9589033597151, 130.79514850489792, 142.43385522067544, 140.89192412607386, 143.68556541576973, 106.5472333235666, 142.35320264846064, 165.96796388272176, 144.05486187152556, 118.65253120311533, 131.97817603684956, 133.03345322981485, 160.45551266521227, 150.98142987117177, 140.17328649014257, 179.247735440731, 156.81321851909155, 131.39990808069695, 113.74827790725973, 160.1274534016845, 131.61492246668791, 160.2906728945673, 160.16086352616506, 156.5218183249235, 148.5767946168784, 138.62112047616424, 93.93999914824961, 135.28316308092315, 173.56800982542353, 161.4691158495844, 141.35006142407659, 175.91210791096105, 145.76279732445258, 158.1017343178391, 171.92538037896168, 156.2301813773811, 129.2710543498397, 190.16997329704446, 144.48950925469404, 145.8820608672685, 193.52775999903713, 130.7333938004448, 151.54778010398178, 147.29928637715034, 157.8481783568859, 142.07478412054502, 136.27818281948583, 135.85134034603828, 178.5348838195203, 98.94072666042484, 177.5026169172483, 164.85778250545258, 162.53001614660008, 147.78048255667085, 148.451304525137, 131.35638422518986, 141.1409359164534, 146.53087410703307, 117.8588923513889, 150.4583768881858, 133.2755774222314, 43.20834509283304, 151.07100280490693, 135.77129130065435, 159.5929963886737, 192.46479861438306, 167.67480101063836, 161.35805594921106, 127.98031201167029, 169.0949629261158, 156.11376272895717, 164.3573297336699, 132.43608037941152], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [53.1290434723099, 52.81601064403851, 53.25651438472171, 43.32729507920642, 43.3199199916174, 42.61179554959138, 50.62346530705689, 50.46818123757838, 50.03428073227404, 42.8436478972435, 43.26609463430941, 42.92153112590313, 24.275092025597885, 24.61679722120364, 24.519139406581715, 42.32769353191057, 42.3937629337112, 42.38234182695547, 46.76666647071639, 46.37030647943416, 46.886692949260265, 43.11678887034455, 42.95372063914934, 43.17978311950961, 14.15482546389103, 14.417977856472135, 14.384396785870194, 47.128009691834436, 47.83084200508891, 47.75104212388395, 42.61164029935995, 42.96612152705589, 42.946610058347375, 53.37909870843093, 53.975415481875345, 53.980342704492315, 46.585903008778885, 46.73839176942904, 46.4608747412761, 45.56667411079009, 45.539353167017296, 45.37603159745534, 47.993097687760994, 48.76368743429582, 48.64272498587768, 55.800789460539804, 56.52476943656801, 56.67254628706722, 44.732926696538925, 45.497519033029675, 44.15572887659073, 51.39755268891652, 51.05687358727057, 51.49995903794964, 17.540396210427076, 17.481001746530325, 17.217735248307378, 49.98150132596491, 50.416774004697785, 50.31184349209069, 50.478339005261645, 50.44721090793608, 50.615895307622836, 58.06588764302431, 57.446706071495996, 57.940979246050105, 45.744421035051346, 46.750438219169155, 46.64774030447006, 43.801580768078566, 43.84128701686859, 41.46767047047615, 45.78614671031633, 45.327056164542824, 46.08675214710334, 38.84854662666717, 39.025117638210446, 39.034591051439435, 45.510733562211186, 45.59653046230474, 45.29765898982683, 56.57258845726027, 55.02132827043532, 56.36498663201927, 43.51742198566595, 43.86126854332784, 43.41645797590414, 47.5783407576382, 47.37378475069998, 47.48172971233724, 47.14412745647131, 46.89672210812567, 46.85107456147669, 47.84806546817224, 48.04451434935133, 47.79298559824626, 35.65599152849366, 35.42896884058912, 35.46227295448382, 46.973631749550506, 47.68429412009816, 47.695276778812215, 55.45206027105449, 55.69878526497631, 54.81711834669112, 48.27447059315939, 48.14344249417384, 47.6369487841924, 39.42391837636629, 39.450866418580205, 39.77774640816884, 44.049687139069036, 44.14759833862384, 43.78089055915673, 44.391852165261895, 44.42226008946696, 44.219340975085885, 53.68112098425625, 53.72799322009085, 53.04639846086501, 50.3845467666785, 50.28265890354912, 50.31422420094411, 46.77031701803206, 46.43824046850203, 46.96472900360821, 59.62733348210652, 59.900849921007946, 59.719552037616566, 52.20150214930375, 52.29691145320733, 52.31480491658051, 43.922675908853606, 43.81834978734453, 43.65888238449891, 37.49494888881841, 38.24728708310673, 38.00604193533459, 53.38911649088065, 53.280062044660255, 53.45827486614387, 43.754975994427994, 44.071251981270805, 43.788694490989045, 53.48762044807275, 53.356387337048844, 53.44666510944565, 53.18933554490407, 53.91026121129592, 53.061266769965485, 52.810700654983506, 50.96816164255141, 52.74295602738856, 49.43762404719989, 49.861583280066654, 49.2775872896115, 46.440918003208935, 46.286355908960104, 45.893846563994884, 29.7079240878423, 32.08095375200112, 32.15112130840619, 45.34454306680709, 45.28661076538265, 44.65200924873352, 57.31546507775782, 58.228706145659075, 58.02383860200642, 53.939417765786246, 53.63898496826489, 53.89071311553319, 47.063923284411416, 47.123388621956096, 47.162749517709, 58.6696018129587, 58.52419766038655, 58.71830843761562, 48.731735396975026, 48.51883538936575, 48.51222653811176, 52.631924904882894, 52.661073997616754, 52.808735415339456, 57.16874753435452, 57.826438670357064, 56.93019417424996, 51.95684054121374, 52.15745854377745, 52.115882292389855, 43.018254801630974, 43.42753482609987, 42.82526472210884, 63.04709182679652, 63.71577624790369, 63.407105222344384, 47.33273007472356, 48.534438438092664, 48.62234074187775, 48.52506063630183, 48.26945636173089, 49.08754386923586, 64.9351534359157, 64.8441711552441, 63.748435407876954, 43.66484340031941, 43.285621253152684, 43.78292914697279, 49.922896037499115, 50.396574149529144, 51.22830991695325, 48.72185484071572, 49.132195604344204, 49.445235932090625, 52.66625899324815, 52.35273584226768, 52.8291835213701, 47.37583203117053, 47.694653839493796, 47.00429824988048, 45.595379680395126, 45.35823492705822, 45.32456821203232, 45.53495518739024, 44.92004750172296, 45.39633765692511, 59.58819483717282, 59.32820306469996, 59.618485917647675, 33.06485597346909, 32.8689379543066, 33.00693273264915, 58.764604881405816, 59.60459853475912, 59.13341350108384, 54.99717502792676, 54.9528645624717, 54.90774291505416, 53.54580860336621, 54.68495361258586, 54.29925393064816, 49.36667654414971, 49.7133217913409, 48.700484221180275, 49.49081129580735, 49.5092809870839, 49.45121224224566, 43.92933089037736, 43.60865957786639, 43.81839375694592, 46.64748863379161, 47.05425635973613, 47.439190922925874, 49.007938748225556, 48.535141266882405, 48.98779409192501, 38.85445568958917, 39.436714763442666, 39.567721898357064, 50.074817841251686, 50.26974531387289, 50.11381373306115, 44.30621711413065, 44.84526131177941, 44.12409899632135, 14.238050155341625, 14.484244421124458, 14.486050516366959, 50.26167823125918, 50.21767718841632, 50.591647385231525, 45.286660370727375, 45.33531210323174, 45.14931882669528, 53.214313251276806, 53.25218783070643, 53.12649530669053, 63.91856799523036, 64.44941441218059, 64.09681620697181, 55.93400814135869, 55.79868656148513, 55.942106307794646, 53.92245562498768, 53.97060675298174, 53.46499357124169, 42.67811723301807, 42.905528666606784, 42.39666611204544, 56.83672233065589, 56.03479069471358, 56.22344990074633, 50.97340205311774, 52.29660344868897, 52.843757227150476, 54.97521275530259, 54.91503869990508, 54.4670782784621, 44.0365038315455, 44.13219806427756, 44.26737848358849]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14208142662774084, "mean_inference_ms": 0.7028671319510756, "mean_action_processing_ms": 0.09666519812386057, "mean_env_wait_ms": 0.7871228267915708, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1020000, "timesteps_this_iter": 0, "agent_timesteps_total": 3060000, "timers": {"sample_time_ms": 11725.302, "sample_throughput": 426.428, "load_time_ms": 0.1, "load_throughput": 50171100.478, "learn_time_ms": 2057.171, "learn_throughput": 2430.522, "update_time_ms": 9.974}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4054882390829764e-51, "cur_lr": 0.0005000000000000001, "total_loss": 8.573080348968507, "policy_loss": -0.001458187468017691, "vf_loss": 8.679061794281006, "vf_explained_var": 0.10732887387275696, "kl": 0.003789199353254244, "entropy": 10.452330493927002, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1020000, "num_agent_steps_sampled": 3060000, "num_steps_trained": 1020000, "num_agent_steps_trained": 3060000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2716, "training_iteration": 204, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-38-17", "timestamp": 1706233097, "time_this_iter_s": 10.62746000289917, "time_total_s": 2209.2907021045685, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002140234D9D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2209.2907021045685, "timesteps_since_restore": 0, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 9.1, "ram_util_percent": 63.080000000000005}}
{"episode_reward_max": 198.15649290382848, "episode_reward_min": -237.39492137311026, "episode_reward_mean": 139.0129379857643, "episode_len_mean": 497.69, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -90.53100256125133}, "policy_reward_max": {"shared_policy": 66.64594060679276}, "policy_reward_mean": {"shared_policy": 46.33764599525477}, "custom_metrics": {}, "hist_stats": {"episode_reward": [128.5243718847632, 161.3348568947985, 139.78516951948433, 136.48205887526274, 145.3995101079345, 168.998105184175, 134.38617460615933, 153.95438531413657, 52.23913320526478, 150.71011882275343, 151.54144522082078, 173.45357296057043, 139.14259955869025, 129.11053825542336, 137.1999550219626, 116.90825531631705, 136.4049230143427, 167.9589033597151, 130.79514850489792, 142.43385522067544, 140.89192412607386, 143.68556541576973, 106.5472333235666, 142.35320264846064, 165.96796388272176, 144.05486187152556, 118.65253120311533, 131.97817603684956, 133.03345322981485, 160.45551266521227, 150.98142987117177, 140.17328649014257, 179.247735440731, 156.81321851909155, 131.39990808069695, 113.74827790725973, 160.1274534016845, 131.61492246668791, 160.2906728945673, 160.16086352616506, 156.5218183249235, 148.5767946168784, 138.62112047616424, 93.93999914824961, 135.28316308092315, 173.56800982542353, 161.4691158495844, 141.35006142407659, 175.91210791096105, 145.76279732445258, 158.1017343178391, 171.92538037896168, 156.2301813773811, 129.2710543498397, 190.16997329704446, 144.48950925469404, 145.8820608672685, 193.52775999903713, 130.7333938004448, 151.54778010398178, 147.29928637715034, 157.8481783568859, 142.07478412054502, 136.27818281948583, 135.85134034603828, 178.5348838195203, 98.94072666042484, 177.5026169172483, 164.85778250545258, 162.53001614660008, 147.78048255667085, 148.451304525137, 131.35638422518986, 141.1409359164534, 146.53087410703307, 117.8588923513889, 150.4583768881858, 133.2755774222314, 43.20834509283304, 151.07100280490693, 135.77129130065435, 159.5929963886737, 192.46479861438306, 167.67480101063836, 161.35805594921106, 127.98031201167029, 169.0949629261158, 156.11376272895717, 164.3573297336699, 132.43608037941152, 159.902284549549, -237.39492137311026, 147.77160128974322, 145.24098598212015, 140.1610395982861, 138.34282051026807, 114.57653317227957, 172.76657640933956, -169.74906904622912, 198.15649290382848], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 269, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [42.61164029935995, 42.96612152705589, 42.946610058347375, 53.37909870843093, 53.975415481875345, 53.980342704492315, 46.585903008778885, 46.73839176942904, 46.4608747412761, 45.56667411079009, 45.539353167017296, 45.37603159745534, 47.993097687760994, 48.76368743429582, 48.64272498587768, 55.800789460539804, 56.52476943656801, 56.67254628706722, 44.732926696538925, 45.497519033029675, 44.15572887659073, 51.39755268891652, 51.05687358727057, 51.49995903794964, 17.540396210427076, 17.481001746530325, 17.217735248307378, 49.98150132596491, 50.416774004697785, 50.31184349209069, 50.478339005261645, 50.44721090793608, 50.615895307622836, 58.06588764302431, 57.446706071495996, 57.940979246050105, 45.744421035051346, 46.750438219169155, 46.64774030447006, 43.801580768078566, 43.84128701686859, 41.46767047047615, 45.78614671031633, 45.327056164542824, 46.08675214710334, 38.84854662666717, 39.025117638210446, 39.034591051439435, 45.510733562211186, 45.59653046230474, 45.29765898982683, 56.57258845726027, 55.02132827043532, 56.36498663201927, 43.51742198566595, 43.86126854332784, 43.41645797590414, 47.5783407576382, 47.37378475069998, 47.48172971233724, 47.14412745647131, 46.89672210812567, 46.85107456147669, 47.84806546817224, 48.04451434935133, 47.79298559824626, 35.65599152849366, 35.42896884058912, 35.46227295448382, 46.973631749550506, 47.68429412009816, 47.695276778812215, 55.45206027105449, 55.69878526497631, 54.81711834669112, 48.27447059315939, 48.14344249417384, 47.6369487841924, 39.42391837636629, 39.450866418580205, 39.77774640816884, 44.049687139069036, 44.14759833862384, 43.78089055915673, 44.391852165261895, 44.42226008946696, 44.219340975085885, 53.68112098425625, 53.72799322009085, 53.04639846086501, 50.3845467666785, 50.28265890354912, 50.31422420094411, 46.77031701803206, 46.43824046850203, 46.96472900360821, 59.62733348210652, 59.900849921007946, 59.719552037616566, 52.20150214930375, 52.29691145320733, 52.31480491658051, 43.922675908853606, 43.81834978734453, 43.65888238449891, 37.49494888881841, 38.24728708310673, 38.00604193533459, 53.38911649088065, 53.280062044660255, 53.45827486614387, 43.754975994427994, 44.071251981270805, 43.788694490989045, 53.48762044807275, 53.356387337048844, 53.44666510944565, 53.18933554490407, 53.91026121129592, 53.061266769965485, 52.810700654983506, 50.96816164255141, 52.74295602738856, 49.43762404719989, 49.861583280066654, 49.2775872896115, 46.440918003208935, 46.286355908960104, 45.893846563994884, 29.7079240878423, 32.08095375200112, 32.15112130840619, 45.34454306680709, 45.28661076538265, 44.65200924873352, 57.31546507775782, 58.228706145659075, 58.02383860200642, 53.939417765786246, 53.63898496826489, 53.89071311553319, 47.063923284411416, 47.123388621956096, 47.162749517709, 58.6696018129587, 58.52419766038655, 58.71830843761562, 48.731735396975026, 48.51883538936575, 48.51222653811176, 52.631924904882894, 52.661073997616754, 52.808735415339456, 57.16874753435452, 57.826438670357064, 56.93019417424996, 51.95684054121374, 52.15745854377745, 52.115882292389855, 43.018254801630974, 43.42753482609987, 42.82526472210884, 63.04709182679652, 63.71577624790369, 63.407105222344384, 47.33273007472356, 48.534438438092664, 48.62234074187775, 48.52506063630183, 48.26945636173089, 49.08754386923586, 64.9351534359157, 64.8441711552441, 63.748435407876954, 43.66484340031941, 43.285621253152684, 43.78292914697279, 49.922896037499115, 50.396574149529144, 51.22830991695325, 48.72185484071572, 49.132195604344204, 49.445235932090625, 52.66625899324815, 52.35273584226768, 52.8291835213701, 47.37583203117053, 47.694653839493796, 47.00429824988048, 45.595379680395126, 45.35823492705822, 45.32456821203232, 45.53495518739024, 44.92004750172296, 45.39633765692511, 59.58819483717282, 59.32820306469996, 59.618485917647675, 33.06485597346909, 32.8689379543066, 33.00693273264915, 58.764604881405816, 59.60459853475912, 59.13341350108384, 54.99717502792676, 54.9528645624717, 54.90774291505416, 53.54580860336621, 54.68495361258586, 54.29925393064816, 49.36667654414971, 49.7133217913409, 48.700484221180275, 49.49081129580735, 49.5092809870839, 49.45121224224566, 43.92933089037736, 43.60865957786639, 43.81839375694592, 46.64748863379161, 47.05425635973613, 47.439190922925874, 49.007938748225556, 48.535141266882405, 48.98779409192501, 38.85445568958917, 39.436714763442666, 39.567721898357064, 50.074817841251686, 50.26974531387289, 50.11381373306115, 44.30621711413065, 44.84526131177941, 44.12409899632135, 14.238050155341625, 14.484244421124458, 14.486050516366959, 50.26167823125918, 50.21767718841632, 50.591647385231525, 45.286660370727375, 45.33531210323174, 45.14931882669528, 53.214313251276806, 53.25218783070643, 53.12649530669053, 63.91856799523036, 64.44941441218059, 64.09681620697181, 55.93400814135869, 55.79868656148513, 55.942106307794646, 53.92245562498768, 53.97060675298174, 53.46499357124169, 42.67811723301807, 42.905528666606784, 42.39666611204544, 56.83672233065589, 56.03479069471358, 56.22344990074633, 50.97340205311774, 52.29660344868897, 52.843757227150476, 54.97521275530259, 54.91503869990508, 54.4670782784621, 44.0365038315455, 44.13219806427756, 44.26737848358849, 52.582384069760636, 53.76569482622047, 53.554205653568104, -90.53100256125133, -72.72941716589655, -74.1345016459624, 49.45686849703391, 49.91570223642823, 48.3990305562814, 48.06573705375193, 48.72669422626494, 48.448554702103124, 46.8733341222008, 46.34078513582547, 46.946920340259865, 46.12125464777151, 45.98605782787004, 46.23550803462663, 38.53879807392755, 37.45683295528093, 38.580902143071086, 57.560740510622665, 57.796029920379326, 57.40980597833793, -66.2181759874026, -52.08643386761348, -51.444459191213056, 65.28567030032475, 66.22488199671109, 66.64594060679276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.142078797731937, "mean_inference_ms": 0.7029600835851312, "mean_action_processing_ms": 0.09667618330938955, "mean_env_wait_ms": 0.7871036553448701, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1025000, "timesteps_this_iter": 0, "agent_timesteps_total": 3075000, "timers": {"sample_time_ms": 11676.562, "sample_throughput": 428.208, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 2035.501, "learn_throughput": 2456.398, "update_time_ms": 10.102}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2027441195414882e-51, "cur_lr": 0.0005000000000000001, "total_loss": 227.3296875, "policy_loss": -0.0018821249953528962, "vf_loss": 227.43648223876954, "vf_explained_var": 0.08506717681884765, "kl": 0.0038765729987637844, "entropy": 10.491158485412598, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1025000, "num_agent_steps_sampled": 3075000, "num_steps_trained": 1025000, "num_agent_steps_trained": 3075000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2726, "training_iteration": 205, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-38-28", "timestamp": 1706233108, "time_this_iter_s": 10.599912166595459, "time_total_s": 2219.890614271164, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x000002146F7DD1F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2219.890614271164, "timesteps_since_restore": 0, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 5.626666666666666, "ram_util_percent": 63.286666666666676}}
{"episode_reward_max": 198.15649290382848, "episode_reward_min": -303.14409980177885, "episode_reward_mean": 132.97091228097995, "episode_len_mean": 495.24, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -123.3369172414144}, "policy_reward_max": {"shared_policy": 66.64594060679276}, "policy_reward_mean": {"shared_policy": 44.32363742699332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [151.54144522082078, 173.45357296057043, 139.14259955869025, 129.11053825542336, 137.1999550219626, 116.90825531631705, 136.4049230143427, 167.9589033597151, 130.79514850489792, 142.43385522067544, 140.89192412607386, 143.68556541576973, 106.5472333235666, 142.35320264846064, 165.96796388272176, 144.05486187152556, 118.65253120311533, 131.97817603684956, 133.03345322981485, 160.45551266521227, 150.98142987117177, 140.17328649014257, 179.247735440731, 156.81321851909155, 131.39990808069695, 113.74827790725973, 160.1274534016845, 131.61492246668791, 160.2906728945673, 160.16086352616506, 156.5218183249235, 148.5767946168784, 138.62112047616424, 93.93999914824961, 135.28316308092315, 173.56800982542353, 161.4691158495844, 141.35006142407659, 175.91210791096105, 145.76279732445258, 158.1017343178391, 171.92538037896168, 156.2301813773811, 129.2710543498397, 190.16997329704446, 144.48950925469404, 145.8820608672685, 193.52775999903713, 130.7333938004448, 151.54778010398178, 147.29928637715034, 157.8481783568859, 142.07478412054502, 136.27818281948583, 135.85134034603828, 178.5348838195203, 98.94072666042484, 177.5026169172483, 164.85778250545258, 162.53001614660008, 147.78048255667085, 148.451304525137, 131.35638422518986, 141.1409359164534, 146.53087410703307, 117.8588923513889, 150.4583768881858, 133.2755774222314, 43.20834509283304, 151.07100280490693, 135.77129130065435, 159.5929963886737, 192.46479861438306, 167.67480101063836, 161.35805594921106, 127.98031201167029, 169.0949629261158, 156.11376272895717, 164.3573297336699, 132.43608037941152, 159.902284549549, -237.39492137311026, 147.77160128974322, 145.24098598212015, 140.1610395982861, 138.34282051026807, 114.57653317227957, 172.76657640933956, -169.74906904622912, 198.15649290382848, -303.14409980177885, 169.1129079684615, 148.69400612451176, -188.61855825781822, 156.65967021509996, 182.00981211010358, 175.1019122926515, 183.7064786124975, 141.75946228764917, 102.32972238492219], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 269, 500, 500, 500, 500, 500, 500, 500, 500, 321, 500, 500, 434, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [50.478339005261645, 50.44721090793608, 50.615895307622836, 58.06588764302431, 57.446706071495996, 57.940979246050105, 45.744421035051346, 46.750438219169155, 46.64774030447006, 43.801580768078566, 43.84128701686859, 41.46767047047615, 45.78614671031633, 45.327056164542824, 46.08675214710334, 38.84854662666717, 39.025117638210446, 39.034591051439435, 45.510733562211186, 45.59653046230474, 45.29765898982683, 56.57258845726027, 55.02132827043532, 56.36498663201927, 43.51742198566595, 43.86126854332784, 43.41645797590414, 47.5783407576382, 47.37378475069998, 47.48172971233724, 47.14412745647131, 46.89672210812567, 46.85107456147669, 47.84806546817224, 48.04451434935133, 47.79298559824626, 35.65599152849366, 35.42896884058912, 35.46227295448382, 46.973631749550506, 47.68429412009816, 47.695276778812215, 55.45206027105449, 55.69878526497631, 54.81711834669112, 48.27447059315939, 48.14344249417384, 47.6369487841924, 39.42391837636629, 39.450866418580205, 39.77774640816884, 44.049687139069036, 44.14759833862384, 43.78089055915673, 44.391852165261895, 44.42226008946696, 44.219340975085885, 53.68112098425625, 53.72799322009085, 53.04639846086501, 50.3845467666785, 50.28265890354912, 50.31422420094411, 46.77031701803206, 46.43824046850203, 46.96472900360821, 59.62733348210652, 59.900849921007946, 59.719552037616566, 52.20150214930375, 52.29691145320733, 52.31480491658051, 43.922675908853606, 43.81834978734453, 43.65888238449891, 37.49494888881841, 38.24728708310673, 38.00604193533459, 53.38911649088065, 53.280062044660255, 53.45827486614387, 43.754975994427994, 44.071251981270805, 43.788694490989045, 53.48762044807275, 53.356387337048844, 53.44666510944565, 53.18933554490407, 53.91026121129592, 53.061266769965485, 52.810700654983506, 50.96816164255141, 52.74295602738856, 49.43762404719989, 49.861583280066654, 49.2775872896115, 46.440918003208935, 46.286355908960104, 45.893846563994884, 29.7079240878423, 32.08095375200112, 32.15112130840619, 45.34454306680709, 45.28661076538265, 44.65200924873352, 57.31546507775782, 58.228706145659075, 58.02383860200642, 53.939417765786246, 53.63898496826489, 53.89071311553319, 47.063923284411416, 47.123388621956096, 47.162749517709, 58.6696018129587, 58.52419766038655, 58.71830843761562, 48.731735396975026, 48.51883538936575, 48.51222653811176, 52.631924904882894, 52.661073997616754, 52.808735415339456, 57.16874753435452, 57.826438670357064, 56.93019417424996, 51.95684054121374, 52.15745854377745, 52.115882292389855, 43.018254801630974, 43.42753482609987, 42.82526472210884, 63.04709182679652, 63.71577624790369, 63.407105222344384, 47.33273007472356, 48.534438438092664, 48.62234074187775, 48.52506063630183, 48.26945636173089, 49.08754386923586, 64.9351534359157, 64.8441711552441, 63.748435407876954, 43.66484340031941, 43.285621253152684, 43.78292914697279, 49.922896037499115, 50.396574149529144, 51.22830991695325, 48.72185484071572, 49.132195604344204, 49.445235932090625, 52.66625899324815, 52.35273584226768, 52.8291835213701, 47.37583203117053, 47.694653839493796, 47.00429824988048, 45.595379680395126, 45.35823492705822, 45.32456821203232, 45.53495518739024, 44.92004750172296, 45.39633765692511, 59.58819483717282, 59.32820306469996, 59.618485917647675, 33.06485597346909, 32.8689379543066, 33.00693273264915, 58.764604881405816, 59.60459853475912, 59.13341350108384, 54.99717502792676, 54.9528645624717, 54.90774291505416, 53.54580860336621, 54.68495361258586, 54.29925393064816, 49.36667654414971, 49.7133217913409, 48.700484221180275, 49.49081129580735, 49.5092809870839, 49.45121224224566, 43.92933089037736, 43.60865957786639, 43.81839375694592, 46.64748863379161, 47.05425635973613, 47.439190922925874, 49.007938748225556, 48.535141266882405, 48.98779409192501, 38.85445568958917, 39.436714763442666, 39.567721898357064, 50.074817841251686, 50.26974531387289, 50.11381373306115, 44.30621711413065, 44.84526131177941, 44.12409899632135, 14.238050155341625, 14.484244421124458, 14.486050516366959, 50.26167823125918, 50.21767718841632, 50.591647385231525, 45.286660370727375, 45.33531210323174, 45.14931882669528, 53.214313251276806, 53.25218783070643, 53.12649530669053, 63.91856799523036, 64.44941441218059, 64.09681620697181, 55.93400814135869, 55.79868656148513, 55.942106307794646, 53.92245562498768, 53.97060675298174, 53.46499357124169, 42.67811723301807, 42.905528666606784, 42.39666611204544, 56.83672233065589, 56.03479069471358, 56.22344990074633, 50.97340205311774, 52.29660344868897, 52.843757227150476, 54.97521275530259, 54.91503869990508, 54.4670782784621, 44.0365038315455, 44.13219806427756, 44.26737848358849, 52.582384069760636, 53.76569482622047, 53.554205653568104, -90.53100256125133, -72.72941716589655, -74.1345016459624, 49.45686849703391, 49.91570223642823, 48.3990305562814, 48.06573705375193, 48.72669422626494, 48.448554702103124, 46.8733341222008, 46.34078513582547, 46.946920340259865, 46.12125464777151, 45.98605782787004, 46.23550803462663, 38.53879807392755, 37.45683295528093, 38.580902143071086, 57.560740510622665, 57.796029920379326, 57.40980597833793, -66.2181759874026, -52.08643386761348, -51.444459191213056, 65.28567030032475, 66.22488199671109, 66.64594060679276, -123.3369172414144, -90.25517277916273, -89.55200978120169, 56.36825168629487, 56.65411917616923, 56.0905371059974, 49.694974026332304, 49.88222593876223, 49.11680615941684, -62.74901305139065, -62.925712659955025, -62.94383254647255, 52.378060117363916, 52.72033813223241, 51.56127196550368, 60.44881253689526, 60.988901161588714, 60.57209841161965, 58.32913256436585, 58.37391704507171, 58.39886268321423, 61.561216937378035, 61.24482396245001, 60.90043771266936, 47.19143724876146, 47.29655955328296, 47.271465485605106, 34.39695310251166, 34.226084285726145, 33.70668499668439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14206586599271007, "mean_inference_ms": 0.7030001975414111, "mean_action_processing_ms": 0.09668561610819194, "mean_env_wait_ms": 0.7870551058905073, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1030000, "timesteps_this_iter": 0, "agent_timesteps_total": 3090000, "timers": {"sample_time_ms": 11561.229, "sample_throughput": 432.48, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1970.589, "learn_throughput": 2537.313, "update_time_ms": 9.994}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.013720597707441e-52, "cur_lr": 0.0005000000000000001, "total_loss": 233.88463745117187, "policy_loss": 0.022940245342169874, "vf_loss": 233.96451416015626, "vf_explained_var": 0.1347339332103729, "kl": 4251.198132324573, "entropy": 10.281152153015137, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1030000, "num_agent_steps_sampled": 3090000, "num_steps_trained": 1030000, "num_agent_steps_trained": 3090000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2736, "training_iteration": 206, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-38-38", "timestamp": 1706233118, "time_this_iter_s": 10.260069608688354, "time_total_s": 2230.1506838798523, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x00000214018EEAF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2230.1506838798523, "timesteps_since_restore": 0, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 7.664285714285712, "ram_util_percent": 63.107142857142875}}
{"episode_reward_max": 198.15649290382848, "episode_reward_min": -303.14409980177885, "episode_reward_mean": 134.4825786869609, "episode_len_mean": 495.24, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -123.3369172414144}, "policy_reward_max": {"shared_policy": 66.64594060679276}, "policy_reward_mean": {"shared_policy": 44.82752622898697}, "custom_metrics": {}, "hist_stats": {"episode_reward": [140.89192412607386, 143.68556541576973, 106.5472333235666, 142.35320264846064, 165.96796388272176, 144.05486187152556, 118.65253120311533, 131.97817603684956, 133.03345322981485, 160.45551266521227, 150.98142987117177, 140.17328649014257, 179.247735440731, 156.81321851909155, 131.39990808069695, 113.74827790725973, 160.1274534016845, 131.61492246668791, 160.2906728945673, 160.16086352616506, 156.5218183249235, 148.5767946168784, 138.62112047616424, 93.93999914824961, 135.28316308092315, 173.56800982542353, 161.4691158495844, 141.35006142407659, 175.91210791096105, 145.76279732445258, 158.1017343178391, 171.92538037896168, 156.2301813773811, 129.2710543498397, 190.16997329704446, 144.48950925469404, 145.8820608672685, 193.52775999903713, 130.7333938004448, 151.54778010398178, 147.29928637715034, 157.8481783568859, 142.07478412054502, 136.27818281948583, 135.85134034603828, 178.5348838195203, 98.94072666042484, 177.5026169172483, 164.85778250545258, 162.53001614660008, 147.78048255667085, 148.451304525137, 131.35638422518986, 141.1409359164534, 146.53087410703307, 117.8588923513889, 150.4583768881858, 133.2755774222314, 43.20834509283304, 151.07100280490693, 135.77129130065435, 159.5929963886737, 192.46479861438306, 167.67480101063836, 161.35805594921106, 127.98031201167029, 169.0949629261158, 156.11376272895717, 164.3573297336699, 132.43608037941152, 159.902284549549, -237.39492137311026, 147.77160128974322, 145.24098598212015, 140.1610395982861, 138.34282051026807, 114.57653317227957, 172.76657640933956, -169.74906904622912, 198.15649290382848, -303.14409980177885, 169.1129079684615, 148.69400612451176, -188.61855825781822, 156.65967021509996, 182.00981211010358, 175.1019122926515, 183.7064786124975, 141.75946228764917, 102.32972238492219, 185.9230515733361, 173.0388875082135, 146.27035249210897, 158.32874578516925, 181.872730286326, 154.1982351448386, 135.57404015213234, 146.5567626273258, 170.2939981520176, 124.05903331004082], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 269, 500, 500, 500, 500, 500, 500, 500, 500, 321, 500, 500, 434, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [47.14412745647131, 46.89672210812567, 46.85107456147669, 47.84806546817224, 48.04451434935133, 47.79298559824626, 35.65599152849366, 35.42896884058912, 35.46227295448382, 46.973631749550506, 47.68429412009816, 47.695276778812215, 55.45206027105449, 55.69878526497631, 54.81711834669112, 48.27447059315939, 48.14344249417384, 47.6369487841924, 39.42391837636629, 39.450866418580205, 39.77774640816884, 44.049687139069036, 44.14759833862384, 43.78089055915673, 44.391852165261895, 44.42226008946696, 44.219340975085885, 53.68112098425625, 53.72799322009085, 53.04639846086501, 50.3845467666785, 50.28265890354912, 50.31422420094411, 46.77031701803206, 46.43824046850203, 46.96472900360821, 59.62733348210652, 59.900849921007946, 59.719552037616566, 52.20150214930375, 52.29691145320733, 52.31480491658051, 43.922675908853606, 43.81834978734453, 43.65888238449891, 37.49494888881841, 38.24728708310673, 38.00604193533459, 53.38911649088065, 53.280062044660255, 53.45827486614387, 43.754975994427994, 44.071251981270805, 43.788694490989045, 53.48762044807275, 53.356387337048844, 53.44666510944565, 53.18933554490407, 53.91026121129592, 53.061266769965485, 52.810700654983506, 50.96816164255141, 52.74295602738856, 49.43762404719989, 49.861583280066654, 49.2775872896115, 46.440918003208935, 46.286355908960104, 45.893846563994884, 29.7079240878423, 32.08095375200112, 32.15112130840619, 45.34454306680709, 45.28661076538265, 44.65200924873352, 57.31546507775782, 58.228706145659075, 58.02383860200642, 53.939417765786246, 53.63898496826489, 53.89071311553319, 47.063923284411416, 47.123388621956096, 47.162749517709, 58.6696018129587, 58.52419766038655, 58.71830843761562, 48.731735396975026, 48.51883538936575, 48.51222653811176, 52.631924904882894, 52.661073997616754, 52.808735415339456, 57.16874753435452, 57.826438670357064, 56.93019417424996, 51.95684054121374, 52.15745854377745, 52.115882292389855, 43.018254801630974, 43.42753482609987, 42.82526472210884, 63.04709182679652, 63.71577624790369, 63.407105222344384, 47.33273007472356, 48.534438438092664, 48.62234074187775, 48.52506063630183, 48.26945636173089, 49.08754386923586, 64.9351534359157, 64.8441711552441, 63.748435407876954, 43.66484340031941, 43.285621253152684, 43.78292914697279, 49.922896037499115, 50.396574149529144, 51.22830991695325, 48.72185484071572, 49.132195604344204, 49.445235932090625, 52.66625899324815, 52.35273584226768, 52.8291835213701, 47.37583203117053, 47.694653839493796, 47.00429824988048, 45.595379680395126, 45.35823492705822, 45.32456821203232, 45.53495518739024, 44.92004750172296, 45.39633765692511, 59.58819483717282, 59.32820306469996, 59.618485917647675, 33.06485597346909, 32.8689379543066, 33.00693273264915, 58.764604881405816, 59.60459853475912, 59.13341350108384, 54.99717502792676, 54.9528645624717, 54.90774291505416, 53.54580860336621, 54.68495361258586, 54.29925393064816, 49.36667654414971, 49.7133217913409, 48.700484221180275, 49.49081129580735, 49.5092809870839, 49.45121224224566, 43.92933089037736, 43.60865957786639, 43.81839375694592, 46.64748863379161, 47.05425635973613, 47.439190922925874, 49.007938748225556, 48.535141266882405, 48.98779409192501, 38.85445568958917, 39.436714763442666, 39.567721898357064, 50.074817841251686, 50.26974531387289, 50.11381373306115, 44.30621711413065, 44.84526131177941, 44.12409899632135, 14.238050155341625, 14.484244421124458, 14.486050516366959, 50.26167823125918, 50.21767718841632, 50.591647385231525, 45.286660370727375, 45.33531210323174, 45.14931882669528, 53.214313251276806, 53.25218783070643, 53.12649530669053, 63.91856799523036, 64.44941441218059, 64.09681620697181, 55.93400814135869, 55.79868656148513, 55.942106307794646, 53.92245562498768, 53.97060675298174, 53.46499357124169, 42.67811723301807, 42.905528666606784, 42.39666611204544, 56.83672233065589, 56.03479069471358, 56.22344990074633, 50.97340205311774, 52.29660344868897, 52.843757227150476, 54.97521275530259, 54.91503869990508, 54.4670782784621, 44.0365038315455, 44.13219806427756, 44.26737848358849, 52.582384069760636, 53.76569482622047, 53.554205653568104, -90.53100256125133, -72.72941716589655, -74.1345016459624, 49.45686849703391, 49.91570223642823, 48.3990305562814, 48.06573705375193, 48.72669422626494, 48.448554702103124, 46.8733341222008, 46.34078513582547, 46.946920340259865, 46.12125464777151, 45.98605782787004, 46.23550803462663, 38.53879807392755, 37.45683295528093, 38.580902143071086, 57.560740510622665, 57.796029920379326, 57.40980597833793, -66.2181759874026, -52.08643386761348, -51.444459191213056, 65.28567030032475, 66.22488199671109, 66.64594060679276, -123.3369172414144, -90.25517277916273, -89.55200978120169, 56.36825168629487, 56.65411917616923, 56.0905371059974, 49.694974026332304, 49.88222593876223, 49.11680615941684, -62.74901305139065, -62.925712659955025, -62.94383254647255, 52.378060117363916, 52.72033813223241, 51.56127196550368, 60.44881253689526, 60.988901161588714, 60.57209841161965, 58.32913256436585, 58.37391704507171, 58.39886268321423, 61.561216937378035, 61.24482396245001, 60.90043771266936, 47.19143724876146, 47.29655955328296, 47.271465485605106, 34.39695310251166, 34.226084285726145, 33.70668499668439, 61.95325314998625, 62.07662038505076, 61.89317803829907, 58.11384185403584, 57.24887605011462, 57.67616960406302, 49.0660057812929, 48.11960196495055, 49.08474474586545, 52.4013054172198, 53.01398964008938, 52.91345072786014, 60.70436539702739, 60.5499723913769, 60.61839249792199, 51.411892421543584, 51.001831799745545, 51.78451092354952, 45.44762084881464, 44.94343894223371, 45.182980361084134, 48.47581967959802, 49.05907695895682, 49.021865988771125, 56.81818164636691, 56.774412167569, 56.70140433808167, 40.86093311508496, 41.90157924157877, 41.29652095337708]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14203482389514882, "mean_inference_ms": 0.7029485397458234, "mean_action_processing_ms": 0.09668272487643174, "mean_env_wait_ms": 0.7869415421193203, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1035000, "timesteps_this_iter": 0, "agent_timesteps_total": 3105000, "timers": {"sample_time_ms": 11307.675, "sample_throughput": 442.178, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1909.555, "learn_throughput": 2618.411, "update_time_ms": 9.915}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.020580896561161e-52, "cur_lr": 0.0005000000000000001, "total_loss": 23.459133338928222, "policy_loss": 0.011950260681261681, "vf_loss": 23.54947624206543, "vf_explained_var": -0.5739055395126342, "kl": 0.010112420003916744, "entropy": 10.22951011657715, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1035000, "num_agent_steps_sampled": 3105000, "num_steps_trained": 1035000, "num_agent_steps_trained": 3105000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2746, "training_iteration": 207, "trial_id": "6ac16_00000", "experiment_id": "65b92e88543a47bea7c24e731909f2d9", "date": "2024-01-26_02-38-48", "timestamp": 1706233128, "time_this_iter_s": 10.01704478263855, "time_total_s": 2240.167728662491, "pid": 30608, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x0000021401D6ADC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2240.167728662491, "timesteps_since_restore": 0, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 5.92, "ram_util_percent": 63.106666666666676}}
