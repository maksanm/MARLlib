{"episode_reward_max": -270.22562620043755, "episode_reward_min": -340.0448747873306, "episode_reward_mean": -309.38057254273656, "episode_len_mean": 67.61818181818182, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {"shared_policy": -119.89297044277191}, "policy_reward_max": {"shared_policy": -85.37486631671588}, "policy_reward_mean": {"shared_policy": -103.12685751424551}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275.3483860641718, -329.5175867974758, -288.2998612523079, -294.8833803832531, -300.42764976620674, -304.3740188777447, -295.96375239640474, -306.5843797773123, -317.1299671828747, -297.14870761334896, -309.6169719994068, -318.8706151843071, -295.1581623852253, -314.0778402388096, -323.0351872295141, -302.76294467598206, -322.37791213393217, -332.897242218256, -329.54899793863297, -303.574099868536, -321.15903309732676, -296.3175992583856, -270.22562620043755, -331.95364263653755, -306.5944525077939, -317.7715918123722, -314.5165340900421, -321.76351431012154, -308.3183582425118, -340.0448747873306, -307.27419028803706, -316.99436466395855, -298.8261038857745, -303.3529113680124, -317.9316900372505, -312.9821960926056, -297.36321000754833, -321.37240076065063, -312.38256257772446, -298.4374743103981, -319.305098682642, -322.74100264906883, -292.89634254574776, -293.05287032574415, -305.9546881020069, -306.9704612791538, -311.3480332195759, -306.8886061683297, -312.3522487282753, -294.90054040402174, -331.84285765886307, -296.42435179650784, -321.8704301416874, -300.01052386593074, -322.1934393644333], "episode_lengths": [108, 46, 72, 68, 49, 93, 106, 64, 58, 89, 56, 58, 68, 50, 48, 61, 54, 95, 58, 60, 54, 61, 82, 70, 67, 55, 91, 58, 64, 56, 58, 66, 57, 68, 63, 78, 66, 69, 82, 83, 69, 70, 71, 66, 52, 76, 85, 53, 103, 76, 65, 67, 39, 65, 53], "policy_shared_policy_reward": [-100.64415568113327, -87.28313797712326, -87.42109240591526, -117.78313928842545, -105.34994521737099, -106.38450229167938, -92.99214040239653, -91.76507731278738, -103.54264353712401, -94.04289439320564, -96.07704997062683, -104.76343601942062, -107.98608750104904, -96.54647201299667, -95.89509025216103, -98.04708663622539, -97.86906246344249, -108.45786977807681, -95.3901066929102, -105.56154052913189, -95.01210517436266, -99.9614032705625, -97.84363824625811, -108.7793382604917, -102.93951058387756, -100.6394017636776, -113.55105483531952, -93.80652257303397, -94.78853092590968, -108.55365411440532, -97.42133103807768, -111.74133129914603, -100.45430966218314, -100.12716833750407, -101.95579204956691, -116.78765479723613, -94.57290355364482, -94.89211429158847, -105.69314453999202, -100.63319318493208, -99.59679224093756, -113.84785481293997, -104.04754162828128, -116.2204571167628, -102.76718848447005, -110.3570062716802, -96.02110934009156, -96.38482906421027, -102.64819692571959, -114.27044834693274, -105.45926686127981, -106.78505815068881, -118.33741850654285, -107.77476556102435, -104.95130789279938, -106.88474667072296, -117.71294337511063, -97.8256641427676, -97.52356276909511, -108.22487295667331, -101.85430029779673, -115.66071337461472, -103.64401942491531, -106.6414713660876, -95.30205784241359, -94.37407004988442, -85.37486631671588, -97.53072086970012, -87.32003901402156, -118.128624300162, -107.4319285551707, -106.39308978120486, -96.60168429960808, -110.50747426350912, -99.48529394467673, -100.7461733520031, -100.05012387037277, -116.97529458999634, -111.04138022661209, -101.29842764139175, -102.17672622203827, -101.79662000139555, -115.96691366036734, -103.99998064835867, -109.71886809666952, -98.98283283909163, -99.61665730675062, -119.49517397085826, -109.34622732798259, -111.20347348848979, -99.04928740362327, -110.07079813877742, -98.15410474563639, -99.91029860824347, -99.84668316692114, -117.23738288879395, -108.09930042425792, -94.26569229344993, -96.46111116806667, -97.10511276125908, -110.02419346570969, -96.22360514104366, -102.00740073124568, -114.07956097523372, -101.84472833077113, -112.24427278836569, -100.04816692074141, -100.68975638349852, -94.62954227626324, -96.72092002630234, -106.01274770498276, -101.88503183921179, -115.64672358830771, -103.84064533313116, -99.92278281847636, -100.70084784428279, -111.75893191496532, -95.50936249891917, -95.8495881954829, -107.07852361599605, -113.31979578733444, -103.92711764574051, -102.05818524956703, -115.36753795544307, -103.09830106298129, -104.27516363064449, -94.32745480537415, -104.99972948431969, -93.56915825605392, -93.57151529192924, -93.26754602044821, -106.2138090133667, -99.74900843699774, -101.26649992664656, -104.93917973836264, -98.63433116674423, -109.14583751559258, -99.19029259681702, -99.36466012398402, -111.80389497677486, -100.17947811881702, -98.57731710871062, -111.07652958234152, -97.2347594772776, -111.5070429444313, -100.63616499304771, -100.20904079079628, -107.10026280085246, -93.32370814929406, -94.47656945387523, -119.89297044277191, -106.18425068259239, -105.76563653349876, -105.94598708550136, -94.74774857858817, -95.73061613241832, -103.41062358021736, -103.58394688367844, -114.8758596777916, -107.57493714491527, -97.38710264364879, -95.0484840773667, -102.47309676806132, -105.20256570974986, -114.51777688662212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15237792999206662, "mean_inference_ms": 0.6305909247650163, "mean_action_processing_ms": 0.08898470973259003, "mean_env_wait_ms": 0.7499217814011313, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 5000, "timesteps_this_iter": 0, "agent_timesteps_total": 15000, "timers": {"sample_time_ms": 8222.792, "sample_throughput": 608.066, "load_time_ms": 1.0, "load_throughput": 5001554.973, "learn_time_ms": 1469.784, "learn_throughput": 3401.86, "update_time_ms": 7.105}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005000000000000001, "total_loss": 4257.086865234375, "policy_loss": -0.004310993206885971, "vf_loss": 4257.147412109375, "vf_explained_var": 0.0003879964351654053, "kl": 0.003157606185413956, "entropy": 5.693973970413208, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 5000, "num_agent_steps_sampled": 15000, "num_steps_trained": 5000, "num_agent_steps_trained": 15000}, "done": false, "episodes_total": 55, "training_iteration": 1, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-09-24", "timestamp": 1706227764, "time_this_iter_s": 9.686388492584229, "time_total_s": 9.686388492584229, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282577550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9.686388492584229, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 7.692857142857143, "ram_util_percent": 51.942857142857136}}
{"episode_reward_max": 12.893787689507008, "episode_reward_min": -620.0957633256912, "episode_reward_mean": -304.851350682975, "episode_len_mean": 79.92, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {"shared_policy": -213.05576050281525}, "policy_reward_max": {"shared_policy": 4.623246103525162}, "policy_reward_mean": {"shared_policy": -101.61711689432501}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-329.54899793863297, -303.574099868536, -321.15903309732676, -296.3175992583856, -270.22562620043755, -331.95364263653755, -306.5944525077939, -317.7715918123722, -314.5165340900421, -321.76351431012154, -308.3183582425118, -340.0448747873306, -307.27419028803706, -316.99436466395855, -298.8261038857745, -303.3529113680124, -317.9316900372505, -312.9821960926056, -297.36321000754833, -321.37240076065063, -312.38256257772446, -298.4374743103981, -319.305098682642, -322.74100264906883, -292.89634254574776, -293.05287032574415, -305.9546881020069, -306.9704612791538, -311.3480332195759, -306.8886061683297, -312.3522487282753, -294.90054040402174, -331.84285765886307, -296.42435179650784, -321.8704301416874, -300.01052386593074, -322.1934393644333, -21.965326271951213, -310.2605205476284, -285.75436504185205, -333.5405665114522, -289.93689969182014, -314.7225683480501, -14.206966832280159, -300.48438051342964, -339.4912344217301, -306.5374887883663, -325.07593619823456, -293.31937927007675, -324.6343944072724, -316.94062392413616, -319.6289569139481, -318.300380319357, -289.8758981227875, 12.893787689507008, -295.49264197051525, -309.6506014764309, -308.955572552979, -316.30392101965845, -620.0957633256912, -309.55456563830376, -329.737599670887, -285.24908798933035, -292.8270397633314, -304.36340211331844, -320.1652705967427, -316.6515556573868, -330.8806755542755, -305.5917024314404, -312.8626089366153, -325.73086708784103, -319.30473577976227, -317.56351017951965, -304.3504383265972, -322.26332741975784, -289.8152928473428, -314.362831056118, -304.6843977570534, -314.54168355837464, -335.34942331910133, -298.3088563038036, -313.00761891901493, -314.0378160122782, -316.3149949014187, -295.43260511755943, -315.62562792003155, -298.5294545888901, -320.1942197084427, -304.7202880829573, -316.594106644392, -303.88903507590294, -305.5668762922287, -302.30594079196453, -309.358001653105, -329.6005742549896, -314.6779725551605, -311.91384809464216, -294.3814444169402, -334.8027064874768, -300.2855423390866], "episode_lengths": [58, 60, 54, 61, 82, 70, 67, 55, 91, 58, 64, 56, 58, 66, 57, 68, 63, 78, 66, 69, 82, 83, 69, 70, 71, 66, 52, 76, 85, 53, 103, 76, 65, 67, 39, 65, 53, 500, 46, 66, 68, 99, 66, 500, 69, 93, 70, 67, 62, 84, 54, 75, 56, 70, 500, 70, 68, 72, 82, 96, 67, 59, 66, 59, 86, 66, 82, 71, 69, 73, 64, 63, 53, 58, 84, 69, 71, 60, 51, 56, 68, 68, 60, 55, 74, 61, 79, 57, 55, 48, 56, 53, 66, 85, 58, 60, 59, 74, 55, 65], "policy_shared_policy_reward": [-104.95130789279938, -106.88474667072296, -117.71294337511063, -97.8256641427676, -97.52356276909511, -108.22487295667331, -101.85430029779673, -115.66071337461472, -103.64401942491531, -106.6414713660876, -95.30205784241359, -94.37407004988442, -85.37486631671588, -97.53072086970012, -87.32003901402156, -118.128624300162, -107.4319285551707, -106.39308978120486, -96.60168429960808, -110.50747426350912, -99.48529394467673, -100.7461733520031, -100.05012387037277, -116.97529458999634, -111.04138022661209, -101.29842764139175, -102.17672622203827, -101.79662000139555, -115.96691366036734, -103.99998064835867, -109.71886809666952, -98.98283283909163, -99.61665730675062, -119.49517397085826, -109.34622732798259, -111.20347348848979, -99.04928740362327, -110.07079813877742, -98.15410474563639, -99.91029860824347, -99.84668316692114, -117.23738288879395, -108.09930042425792, -94.26569229344993, -96.46111116806667, -97.10511276125908, -110.02419346570969, -96.22360514104366, -102.00740073124568, -114.07956097523372, -101.84472833077113, -112.24427278836569, -100.04816692074141, -100.68975638349852, -94.62954227626324, -96.72092002630234, -106.01274770498276, -101.88503183921179, -115.64672358830771, -103.84064533313116, -99.92278281847636, -100.70084784428279, -111.75893191496532, -95.50936249891917, -95.8495881954829, -107.07852361599605, -113.31979578733444, -103.92711764574051, -102.05818524956703, -115.36753795544307, -103.09830106298129, -104.27516363064449, -94.32745480537415, -104.99972948431969, -93.56915825605392, -93.57151529192924, -93.26754602044821, -106.2138090133667, -99.74900843699774, -101.26649992664656, -104.93917973836264, -98.63433116674423, -109.14583751559258, -99.19029259681702, -99.36466012398402, -111.80389497677486, -100.17947811881702, -98.57731710871062, -111.07652958234152, -97.2347594772776, -111.5070429444313, -100.63616499304771, -100.20904079079628, -107.10026280085246, -93.32370814929406, -94.47656945387523, -119.89297044277191, -106.18425068259239, -105.76563653349876, -105.94598708550136, -94.74774857858817, -95.73061613241832, -103.41062358021736, -103.58394688367844, -114.8758596777916, -107.57493714491527, -97.38710264364879, -95.0484840773667, -102.47309676806132, -105.20256570974986, -114.51777688662212, -7.0724590296546666, -7.373645062247917, -7.519222180048629, -98.3417800962925, -111.92614817619324, -99.99259227514267, -92.68139191468558, -90.6229235281547, -102.45004959901175, -104.26034858574471, -106.55332299073538, -122.72689493497214, -92.31936196486156, -103.8493978480498, -93.7681398789088, -113.85268922646841, -100.06692815323672, -100.80295096834502, -4.6717772632837296, -4.5005519688129425, -5.034637600183487, -97.6299314002196, -95.88998300830524, -106.96446610490482, -121.4140330751737, -108.9445193608602, -109.13268198569617, -108.88326146205267, -98.06064837177595, -99.59357895453772, -114.7684528529644, -105.31687951087952, -104.99060383439064, -100.98656113942465, -95.8732921977838, -96.45952593286833, -104.29370792706808, -104.5742988785108, -115.76638760169348, -101.39310748378436, -114.39967588583629, -101.14784055451553, -113.09908052285513, -102.63978083928427, -103.89009555180868, -113.38226826985678, -103.0733582576116, -101.84475379188856, -103.70796295007071, -93.28806983431181, -92.87986533840498, 4.329767994582653, 4.623246103525162, 3.940773591399193, -105.96029062072436, -95.74973274270694, -93.78261860708396, -100.48152075211208, -98.5404533247153, -110.62862739960353, -99.74143499135971, -111.24390864372253, -97.97022891789675, -113.72611832618713, -100.13689059577882, -102.44091209769249, -203.36573386192322, -203.67426896095276, -213.05576050281525, -98.88244711359343, -110.9105850060781, -99.76153351863226, -116.17268687486649, -105.25454199314117, -108.31037080287933, -102.60110463698706, -91.18951011200747, -91.45847324033579, -94.8355498512586, -105.31104322274527, -92.68044668932757, -98.214636216561, -109.08330313364665, -97.0654627631108, -103.2105017801126, -114.28515191872916, -102.66961689790091, -111.99866286913554, -101.57403908173244, -103.07885370651881, -105.6031001408895, -119.27219994862875, -106.0053754647573, -96.3923254509767, -109.33894320329031, -99.86043377717337, -99.94198921322823, -98.34666728693992, -114.57395243644714, -119.13888017336528, -103.72195372978847, -102.8700331846873, -101.7310599386692, -115.73793017864227, -101.83574566245079, -113.5875712633133, -102.22727197408676, -101.7486669421196, -97.61072409152985, -98.03779718279839, -108.70191705226898, -103.48195558786392, -103.58063673973083, -115.20073509216309, -91.23886867581557, -93.51895059148471, -105.05747358004253, -101.15408940116565, -112.90844408671062, -100.30029756824176, -108.28983253240585, -97.5002304315567, -98.89433479309082, -101.57857203483582, -113.21861082315445, -99.74450070038438, -109.49648823340735, -106.9448960920175, -118.90803899367651, -96.38576496640842, -94.86846256783853, -107.05462876955669, -113.09889656305313, -100.94924283027649, -98.95947952568531, -99.86667651372652, -112.93742666641872, -101.23371283213298, -101.11971072355907, -100.6406388382117, -114.55464533964793, -95.01005430022876, -105.58808002869289, -94.8344707886378, -100.50009314715862, -113.0645654797554, -102.06096929311752, -96.10515439510345, -106.32124388217926, -96.10305631160736, -103.06561253468196, -102.51373640696208, -114.61487076679866, -96.49163842697939, -110.49107857545218, -97.73757108052573, -100.55911553899448, -98.90455094973247, -117.13044015566508, -99.33709907531738, -96.07593688368797, -108.47599911689758, -98.64617324868838, -108.63145164648692, -98.2892513970534, -107.48233602444331, -96.02880069116752, -98.79480407635371, -110.58505591750145, -100.38583499193192, -98.38711074367166, -107.40706648429236, -117.0097893079122, -105.1837184627851, -100.4577755133311, -113.58173422018687, -100.63846282164256, -99.25199154267709, -100.19951484600703, -112.46234170595805, -94.72698400417964, -106.30440692106883, -93.35005349169175, -119.87612974643707, -105.20009905844927, -109.72647768259048, -96.53750549753508, -107.45720144112906, -96.29083540042242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15927024028935632, "mean_inference_ms": 0.6434312090126878, "mean_action_processing_ms": 0.08836369480036144, "mean_env_wait_ms": 0.7538762913262052, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 10000, "timesteps_this_iter": 0, "agent_timesteps_total": 30000, "timers": {"sample_time_ms": 9132.602, "sample_throughput": 547.489, "load_time_ms": 0.5, "load_throughput": 10003109.945, "learn_time_ms": 1494.335, "learn_throughput": 3345.971, "update_time_ms": 7.053}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005000000000000001, "total_loss": 4631.478564453125, "policy_loss": -0.003266423934415741, "vf_loss": 4631.53896484375, "vf_explained_var": 0.0018704235553741455, "kl": 0.00317809076805159, "entropy": 5.735112094879151, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 10000, "num_agent_steps_sampled": 30000, "num_steps_trained": 10000, "num_agent_steps_trained": 30000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 118, "training_iteration": 2, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-09-34", "timestamp": 1706227774, "time_this_iter_s": 10.060214519500732, "time_total_s": 19.74660301208496, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282306CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19.74660301208496, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 6.328571428571428, "ram_util_percent": 52.192857142857164}}
{"episode_reward_max": 10.049931753426762, "episode_reward_min": -611.5478728711605, "episode_reward_mean": -314.3612053159345, "episode_len_mean": 72.12, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {"shared_policy": -212.38277872403467}, "policy_reward_max": {"shared_policy": 3.580984278271586}, "policy_reward_mean": {"shared_policy": -104.78706843864484}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-330.8806755542755, -305.5917024314404, -312.8626089366153, -325.73086708784103, -319.30473577976227, -317.56351017951965, -304.3504383265972, -322.26332741975784, -289.8152928473428, -314.362831056118, -304.6843977570534, -314.54168355837464, -335.34942331910133, -298.3088563038036, -313.00761891901493, -314.0378160122782, -316.3149949014187, -295.43260511755943, -315.62562792003155, -298.5294545888901, -320.1942197084427, -304.7202880829573, -316.594106644392, -303.88903507590294, -305.5668762922287, -302.30594079196453, -309.358001653105, -329.6005742549896, -314.6779725551605, -311.91384809464216, -294.3814444169402, -334.8027064874768, -300.2855423390866, -317.9279890060425, -320.20115423202515, -292.52017126977444, -304.7356653809548, -310.3360265791416, -314.0560301244259, -306.8588844239712, -330.64110228419304, -299.4226147979498, -318.6111552119255, -327.27020516991615, -316.03357914835215, -611.5478728711605, -342.04515524208546, -326.00329189002514, -298.1209874153137, -350.3157165646553, -307.40273778885603, -354.70794174075127, -300.92535773292184, -311.05472537875175, -329.4196348786354, -331.656268671155, -316.7974351942539, -320.16908526420593, -329.13940711319447, -330.9406732916832, -323.90544598549604, -303.88706865906715, -308.2583003677428, -296.922344237566, -312.4351418465376, -315.2369784116745, -313.30139711499214, -313.3262405991554, -288.5540036484599, -323.3116344809532, -312.9919677078724, -313.505244826898, -322.7841500118375, -325.2292667329312, -310.9069336652756, -335.03910169005394, -324.71676356345415, -319.1215547323227, -329.1304027438164, -344.6841793358326, -290.6296048760414, -324.97439953684807, -291.6454891562462, -312.1107616610825, -307.4853267520666, -327.20834735035896, 10.049931753426762, -338.6503785848618, -318.35538002848625, -315.73728666454554, -305.0860016196966, -324.8184109479189, -286.9518384337425, -307.53209954500204, -316.92902252078056, -320.6938500702381, -303.11076049506664, -290.27875420451164, -283.3338154554367, -327.68092200160027], "episode_lengths": [71, 69, 73, 64, 63, 53, 58, 84, 69, 71, 60, 51, 56, 68, 68, 60, 55, 74, 61, 79, 57, 55, 48, 56, 53, 66, 85, 58, 60, 59, 74, 55, 65, 53, 80, 81, 58, 64, 71, 62, 58, 65, 60, 75, 70, 74, 121, 74, 83, 90, 59, 118, 70, 60, 95, 65, 59, 51, 60, 60, 66, 73, 55, 76, 48, 72, 61, 69, 68, 44, 46, 94, 71, 60, 65, 68, 89, 119, 55, 82, 61, 117, 63, 58, 80, 60, 500, 58, 65, 113, 59, 55, 77, 54, 41, 57, 78, 62, 87, 52], "policy_shared_policy_reward": [-105.6031001408895, -119.27219994862875, -106.0053754647573, -96.3923254509767, -109.33894320329031, -99.86043377717337, -99.94198921322823, -98.34666728693992, -114.57395243644714, -119.13888017336528, -103.72195372978847, -102.8700331846873, -101.7310599386692, -115.73793017864227, -101.83574566245079, -113.5875712633133, -102.22727197408676, -101.7486669421196, -97.61072409152985, -98.03779718279839, -108.70191705226898, -103.48195558786392, -103.58063673973083, -115.20073509216309, -91.23886867581557, -93.51895059148471, -105.05747358004253, -101.15408940116565, -112.90844408671062, -100.30029756824176, -108.28983253240585, -97.5002304315567, -98.89433479309082, -101.57857203483582, -113.21861082315445, -99.74450070038438, -109.49648823340735, -106.9448960920175, -118.90803899367651, -96.38576496640842, -94.86846256783853, -107.05462876955669, -113.09889656305313, -100.94924283027649, -98.95947952568531, -99.86667651372652, -112.93742666641872, -101.23371283213298, -101.11971072355907, -100.6406388382117, -114.55464533964793, -95.01005430022876, -105.58808002869289, -94.8344707886378, -100.50009314715862, -113.0645654797554, -102.06096929311752, -96.10515439510345, -106.32124388217926, -96.10305631160736, -103.06561253468196, -102.51373640696208, -114.61487076679866, -96.49163842697939, -110.49107857545218, -97.73757108052573, -100.55911553899448, -98.90455094973247, -117.13044015566508, -99.33709907531738, -96.07593688368797, -108.47599911689758, -98.64617324868838, -108.63145164648692, -98.2892513970534, -107.48233602444331, -96.02880069116752, -98.79480407635371, -110.58505591750145, -100.38583499193192, -98.38711074367166, -107.40706648429236, -117.0097893079122, -105.1837184627851, -100.4577755133311, -113.58173422018687, -100.63846282164256, -99.25199154267709, -100.19951484600703, -112.46234170595805, -94.72698400417964, -106.30440692106883, -93.35005349169175, -119.87612974643707, -105.20009905844927, -109.72647768259048, -96.53750549753508, -107.45720144112906, -96.29083540042242, -113.19604235887527, -101.7627699971199, -102.9691766500473, -102.48401618003845, -104.08586284518242, -113.63127520680428, -104.39627079168956, -93.70896285275619, -94.4149376253287, -109.05324908097586, -96.20869698127112, -99.4737193187078, -99.19057419896126, -111.11656165122986, -100.0288907289505, -99.59662210941315, -113.3037720322609, -101.15563598275185, -109.13789144158363, -97.96729391813278, -99.75369906425476, -106.79144847393036, -118.16236484050751, -105.68728896975517, -97.75883734226227, -94.73726592957973, -106.92651152610779, -100.22195688883464, -113.49449596802394, -104.89470235506694, -116.29662493864696, -105.09896303216617, -105.87461719910304, -102.55429312586784, -113.22276920080185, -100.25651682168245, -212.38277872403467, -200.10363971193635, -199.0614544351896, -109.98950622975826, -111.10902115702629, -120.9466278553009, -104.09642256299655, -103.39920401076476, -118.50766531626384, -96.43688648939133, -106.02247178554535, -95.66162914037704, -110.2438763777415, -111.6718418399493, -128.39999834696454, -110.45575428009033, -98.67363366484642, -98.27334984391928, -115.28988620638847, -113.86094129085541, -125.55711424350739, -95.84583674247067, -107.93893898526828, -97.1405820051829, -100.37901586294174, -111.46560972929001, -99.21009978652, -106.67004404465358, -117.06704256931941, -105.68254826466243, -119.12612241506577, -105.39615799486637, -107.13398826122284, -100.46244260668755, -102.12215971946716, -114.21283286809921, -103.12383562326431, -102.75387793779373, -114.29137170314789, -104.50614759822687, -105.3762072523435, -119.25705226262411, -101.87160549561183, -104.36810580889384, -124.70096198717754, -104.60021697481474, -115.88904478152594, -103.41618422915539, -99.78610849380493, -108.0447787642479, -96.05618140101433, -111.54659152030945, -97.82554777339101, -98.88616107404232, -105.92817350228628, -95.4080080886682, -95.58616264661154, -101.40411887566249, -112.38832567135493, -98.64269729952018, -112.49136066436768, -101.41409641504288, -101.33152133226395, -111.13073120514552, -100.53976352016132, -101.63090238968532, -101.64350463946661, -100.69584264357886, -110.98689331610998, -91.5355914955338, -92.11861868699393, -104.89979346593222, -104.07559498151144, -103.00383045276007, -116.23220904668173, -101.06512687603633, -112.21676609913509, -99.71007473270099, -112.44512177507083, -100.9090512941281, -100.15107175769906, -115.45214296380679, -103.92122835914294, -103.41077868888776, -117.4669893582662, -104.83972122271857, -102.9225561519464, -98.66752300659816, -111.39777485529582, -100.8416358033816, -105.89376047253609, -109.01679903268814, -120.12854218482971, -117.97742323080699, -103.88414294521014, -102.85519738743703, -101.77363726496696, -102.79810431599617, -114.54981315135956, -117.2019052306811, -104.59643212954204, -107.33206538359325, -123.65068010489146, -110.5990100602309, -110.43448917071025, -92.19782768686613, -93.78808676203093, -104.64369042714438, -102.03856280446053, -104.45033198595047, -118.48550474643707, -94.08869335055351, -93.56201702356339, -103.99477878212929, -99.54926925897598, -99.22690917924047, -113.33458322286606, -110.18539041280746, -97.70982883870602, -99.59010750055313, -104.97488872210185, -117.45035723845164, -104.78310138980548, 3.1063132087389533, 3.3626342664162223, 3.580984278271586, -108.49335660537085, -109.3204559882482, -120.83656599124274, -112.10028475522995, -102.92238584160805, -103.33270943164825, -100.87695819884539, -112.65043491125107, -102.20989355444908, -109.38614654541016, -97.54690493643284, -98.15295013785362, -116.27488990624747, -104.49164715905985, -104.0518738826116, -91.49348003168902, -91.91535917421183, -103.5429992278417, -97.86631958683333, -97.98798876007399, -111.6777911980947, -113.22647392749786, -100.6911350786686, -103.0114135146141, -114.59578613440196, -103.27986041704814, -102.81820351878802, -108.8741818467776, -96.49587419132392, -97.74070445696513, -94.4771782954534, -92.27698116501173, -103.52459474404654, -91.01383223136267, -90.7414872845014, -101.57849593957266, -116.06375058492026, -104.76476525266966, -106.85240616401038]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16154595749027426, "mean_inference_ms": 0.6474725532108505, "mean_action_processing_ms": 0.09029513097004103, "mean_env_wait_ms": 0.760845709483643, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 15000, "timesteps_this_iter": 0, "agent_timesteps_total": 45000, "timers": {"sample_time_ms": 9339.5, "sample_throughput": 535.361, "load_time_ms": 0.333, "load_throughput": 15004664.918, "learn_time_ms": 1504.735, "learn_throughput": 3322.845, "update_time_ms": 7.035}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 0.0005000000000000001, "total_loss": 5003.499267578125, "policy_loss": -0.0025903779192049114, "vf_loss": 5003.559423828125, "vf_explained_var": -0.002162313461303711, "kl": 0.0032221203669909647, "entropy": 5.7693568706512455, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 15000, "num_agent_steps_sampled": 45000, "num_steps_trained": 15000, "num_agent_steps_trained": 45000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 185, "training_iteration": 3, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-09-44", "timestamp": 1706227784, "time_this_iter_s": 9.73309874534607, "time_total_s": 29.47970175743103, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020280834A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 29.47970175743103, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 7.178571428571429, "ram_util_percent": 52.21428571428572}}
{"episode_reward_max": 10.049931753426762, "episode_reward_min": -611.5478728711605, "episode_reward_mean": -306.81082407606186, "episode_len_mean": 86.92, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {"shared_policy": -212.38277872403467}, "policy_reward_max": {"shared_policy": 3.580984278271586}, "policy_reward_mean": {"shared_policy": -102.2702746920206}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-611.5478728711605, -342.04515524208546, -326.00329189002514, -298.1209874153137, -350.3157165646553, -307.40273778885603, -354.70794174075127, -300.92535773292184, -311.05472537875175, -329.4196348786354, -331.656268671155, -316.7974351942539, -320.16908526420593, -329.13940711319447, -330.9406732916832, -323.90544598549604, -303.88706865906715, -308.2583003677428, -296.922344237566, -312.4351418465376, -315.2369784116745, -313.30139711499214, -313.3262405991554, -288.5540036484599, -323.3116344809532, -312.9919677078724, -313.505244826898, -322.7841500118375, -325.2292667329312, -310.9069336652756, -335.03910169005394, -324.71676356345415, -319.1215547323227, -329.1304027438164, -344.6841793358326, -290.6296048760414, -324.97439953684807, -291.6454891562462, -312.1107616610825, -307.4853267520666, -327.20834735035896, 10.049931753426762, -338.6503785848618, -318.35538002848625, -315.73728666454554, -305.0860016196966, -324.8184109479189, -286.9518384337425, -307.53209954500204, -316.92902252078056, -320.6938500702381, -303.11076049506664, -290.27875420451164, -283.3338154554367, -327.68092200160027, -320.7053957283497, -332.64882546663284, -321.0863059908152, -304.77877098321915, -320.8324889242649, -288.38231164216995, -334.33555609732866, -314.5631607696414, -294.56781582534313, -315.6804514452815, -292.99257300049067, -294.03763706982136, -95.9658883363009, -327.6771951615811, -307.48943907709327, -318.49345963820815, -294.72805516421795, -310.5228596329689, -300.4411605671048, -307.570115365088, -316.0387978851795, -323.89520290493965, -317.3467648625374, -10.855832569301157, -314.75325314700603, -323.774920463562, -300.0684613585472, -297.4821013882757, -314.0984544083476, -327.48907616734505, -313.7262929677963, -312.5447923541069, -316.6290847659111, -306.1618079394102, -305.1897271387279, -310.8381746560335, -38.96021324396136, -304.4099381789565, -333.80195109546185, -302.1993256509304, -325.5727513432503, -329.90973711013794, -314.60431638360023, -323.24182108044624, -319.3332131057978], "episode_lengths": [74, 121, 74, 83, 90, 59, 118, 70, 60, 95, 65, 59, 51, 60, 60, 66, 73, 55, 76, 48, 72, 61, 69, 68, 44, 46, 94, 71, 60, 65, 68, 89, 119, 55, 82, 61, 117, 63, 58, 80, 60, 500, 58, 65, 113, 59, 55, 77, 54, 41, 57, 78, 62, 87, 52, 58, 59, 45, 93, 38, 85, 77, 69, 63, 63, 68, 70, 500, 116, 54, 68, 71, 81, 100, 79, 68, 48, 58, 500, 70, 71, 61, 98, 101, 54, 63, 60, 72, 57, 48, 57, 500, 67, 64, 63, 73, 53, 57, 93, 62], "policy_shared_policy_reward": [-212.38277872403467, -200.10363971193635, -199.0614544351896, -109.98950622975826, -111.10902115702629, -120.9466278553009, -104.09642256299655, -103.39920401076476, -118.50766531626384, -96.43688648939133, -106.02247178554535, -95.66162914037704, -110.2438763777415, -111.6718418399493, -128.39999834696454, -110.45575428009033, -98.67363366484642, -98.27334984391928, -115.28988620638847, -113.86094129085541, -125.55711424350739, -95.84583674247067, -107.93893898526828, -97.1405820051829, -100.37901586294174, -111.46560972929001, -99.21009978652, -106.67004404465358, -117.06704256931941, -105.68254826466243, -119.12612241506577, -105.39615799486637, -107.13398826122284, -100.46244260668755, -102.12215971946716, -114.21283286809921, -103.12383562326431, -102.75387793779373, -114.29137170314789, -104.50614759822687, -105.3762072523435, -119.25705226262411, -101.87160549561183, -104.36810580889384, -124.70096198717754, -104.60021697481474, -115.88904478152594, -103.41618422915539, -99.78610849380493, -108.0447787642479, -96.05618140101433, -111.54659152030945, -97.82554777339101, -98.88616107404232, -105.92817350228628, -95.4080080886682, -95.58616264661154, -101.40411887566249, -112.38832567135493, -98.64269729952018, -112.49136066436768, -101.41409641504288, -101.33152133226395, -111.13073120514552, -100.53976352016132, -101.63090238968532, -101.64350463946661, -100.69584264357886, -110.98689331610998, -91.5355914955338, -92.11861868699393, -104.89979346593222, -104.07559498151144, -103.00383045276007, -116.23220904668173, -101.06512687603633, -112.21676609913509, -99.71007473270099, -112.44512177507083, -100.9090512941281, -100.15107175769906, -115.45214296380679, -103.92122835914294, -103.41077868888776, -117.4669893582662, -104.83972122271857, -102.9225561519464, -98.66752300659816, -111.39777485529582, -100.8416358033816, -105.89376047253609, -109.01679903268814, -120.12854218482971, -117.97742323080699, -103.88414294521014, -102.85519738743703, -101.77363726496696, -102.79810431599617, -114.54981315135956, -117.2019052306811, -104.59643212954204, -107.33206538359325, -123.65068010489146, -110.5990100602309, -110.43448917071025, -92.19782768686613, -93.78808676203093, -104.64369042714438, -102.03856280446053, -104.45033198595047, -118.48550474643707, -94.08869335055351, -93.56201702356339, -103.99477878212929, -99.54926925897598, -99.22690917924047, -113.33458322286606, -110.18539041280746, -97.70982883870602, -99.59010750055313, -104.97488872210185, -117.45035723845164, -104.78310138980548, 3.1063132087389533, 3.3626342664162223, 3.580984278271586, -108.49335660537085, -109.3204559882482, -120.83656599124274, -112.10028475522995, -102.92238584160805, -103.33270943164825, -100.87695819884539, -112.65043491125107, -102.20989355444908, -109.38614654541016, -97.54690493643284, -98.15295013785362, -116.27488990624747, -104.49164715905985, -104.0518738826116, -91.49348003168902, -91.91535917421183, -103.5429992278417, -97.86631958683333, -97.98798876007399, -111.6777911980947, -113.22647392749786, -100.6911350786686, -103.0114135146141, -114.59578613440196, -103.27986041704814, -102.81820351878802, -108.8741818467776, -96.49587419132392, -97.74070445696513, -94.4771782954534, -92.27698116501173, -103.52459474404654, -91.01383223136267, -90.7414872845014, -101.57849593957266, -116.06375058492026, -104.76476525266966, -106.85240616401038, -102.39020668466887, -114.47078295548758, -103.84440608819327, -107.25746178627014, -117.92820984125137, -107.46315383911133, -103.60179462035498, -117.08982535203299, -100.39468601842722, -96.5438819527626, -98.35804319381714, -109.8768458366394, -103.15374685327212, -115.08840082089107, -102.59034125010173, -92.03180100520453, -92.90800746281943, -103.44250317414603, -108.97862976789474, -119.727508187294, -105.62941814213991, -102.47412586212158, -99.71987759321928, -112.36915731430054, -93.97968634217978, -106.7144410610199, -93.87368842214346, -100.39217650145292, -112.92057710886002, -102.36769783496857, -106.89023152987163, -93.28191974262397, -92.82042172799508, -94.761359055837, -105.91162260373434, -93.36465541025004, -31.967087966700397, -32.04058470328649, -31.95821566631397, -116.85311191280684, -105.1867356201013, -105.63734762867293, -99.20165268580119, -97.13028924357302, -111.15749714771907, -113.54139826695125, -100.64186481262247, -104.31019655863444, -105.67958293358485, -95.35417822996776, -93.69429400066535, -98.14600982268652, -112.6723367770513, -99.70451303323111, -108.49015311400096, -96.2281071494023, -95.72290030370156, -97.47020615885656, -111.06067935625713, -99.03922984997432, -112.21224812666576, -100.07541818420093, -103.75113157431285, -113.57792934775352, -104.67091983556747, -105.64635372161865, -115.42689136664073, -101.66639975706737, -100.2534737388293, -3.751359601815551, -3.4921112855275567, -3.612361681958049, -102.01985614498457, -100.59975514312586, -112.13364185889563, -103.95391138394675, -114.6900397737821, -105.13096930583319, -108.2051264444987, -96.66279576222102, -95.2005391518275, -108.64743467171988, -93.97928982724747, -94.8553768893083, -101.13282145063083, -100.47714230666558, -112.48849065105121, -105.12624658147494, -117.17021367947261, -105.1926159063975, -101.37263341744742, -100.70373191436133, -111.64992763598761, -100.63459224502246, -100.48672474424045, -111.42347536484401, -102.003372301658, -100.22831349571547, -114.39739896853766, -109.92348778247833, -97.57257814705372, -98.66574200987816, -97.40513291954994, -96.11969868466258, -111.66489553451538, -99.49301940202713, -112.22634416818619, -99.1188110858202, -12.377001044650882, -12.263790888090938, -14.319421311219543, -96.92065699150166, -109.93614019950232, -97.55314098795256, -120.06498020887375, -106.37431208789349, -107.36265879869461, -96.39602664113045, -108.68268656730652, -97.12061244249344, -103.76130268971126, -107.21138910452525, -114.60005954901378, -117.6099862655004, -106.70452525218329, -105.59522559245428, -113.06793795029323, -101.47589341799419, -100.06048501531284, -104.25014038880667, -103.63007759054503, -115.36160310109457, -101.55672127505144, -115.65306605895361, -102.12342577179274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15549991690745993, "mean_inference_ms": 0.6398491731171884, "mean_action_processing_ms": 0.09197842069880684, "mean_env_wait_ms": 0.7545873459179887, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 20000, "timesteps_this_iter": 0, "agent_timesteps_total": 60000, "timers": {"sample_time_ms": 9384.352, "sample_throughput": 532.802, "load_time_ms": 0.25, "load_throughput": 20006219.89, "learn_time_ms": 1500.849, "learn_throughput": 3331.447, "update_time_ms": 7.026}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 0.0005000000000000001, "total_loss": 2878.109375, "policy_loss": -0.002711856118395417, "vf_loss": 2878.16904296875, "vf_explained_var": 0.012757760286331177, "kl": 0.003690270515654193, "entropy": 5.699891853332519, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 20000, "num_agent_steps_sampled": 60000, "num_steps_trained": 20000, "num_agent_steps_trained": 60000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 230, "training_iteration": 4, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-09-53", "timestamp": 1706227793, "time_this_iter_s": 9.455934286117554, "time_total_s": 38.935636043548584, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282492C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38.935636043548584, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 5.984615384615385, "ram_util_percent": 52.25384615384616}}
{"episode_reward_max": 10.049931753426762, "episode_reward_min": -344.6841793358326, "episode_reward_mean": -283.90471395220027, "episode_len_mean": 111.62, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"shared_policy": -123.65068010489146}, "policy_reward_max": {"shared_policy": 3.580984278271586}, "policy_reward_mean": {"shared_policy": -94.63490465073342}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-329.1304027438164, -344.6841793358326, -290.6296048760414, -324.97439953684807, -291.6454891562462, -312.1107616610825, -307.4853267520666, -327.20834735035896, 10.049931753426762, -338.6503785848618, -318.35538002848625, -315.73728666454554, -305.0860016196966, -324.8184109479189, -286.9518384337425, -307.53209954500204, -316.92902252078056, -320.6938500702381, -303.11076049506664, -290.27875420451164, -283.3338154554367, -327.68092200160027, -320.7053957283497, -332.64882546663284, -321.0863059908152, -304.77877098321915, -320.8324889242649, -288.38231164216995, -334.33555609732866, -314.5631607696414, -294.56781582534313, -315.6804514452815, -292.99257300049067, -294.03763706982136, -95.9658883363009, -327.6771951615811, -307.48943907709327, -318.49345963820815, -294.72805516421795, -310.5228596329689, -300.4411605671048, -307.570115365088, -316.0387978851795, -323.89520290493965, -317.3467648625374, -10.855832569301157, -314.75325314700603, -323.774920463562, -300.0684613585472, -297.4821013882757, -314.0984544083476, -327.48907616734505, -313.7262929677963, -312.5447923541069, -316.6290847659111, -306.1618079394102, -305.1897271387279, -310.8381746560335, -38.96021324396136, -304.4099381789565, -333.80195109546185, -302.1993256509304, -325.5727513432503, -329.90973711013794, -314.60431638360023, -323.24182108044624, -319.3332131057978, -25.340163521468654, -289.7144491821528, -315.27855038642883, -297.14705933630466, -24.97130151093009, 7.629246279597254, -37.723242633044734, -314.8053829818964, -3.095578670501723, -309.680322855711, -313.1780881881714, -325.23156905174255, -312.3358137011528, -330.3975915014744, -308.90535593032837, -322.06200526654726, -33.14217545464636, -307.34182289242744, -305.0105592310429, -295.1368288993836, -322.73457868397236, -315.116676017642, -312.9480297714472, -334.01195496320724, -285.5425685495138, -328.92314034700394, -311.4754884839058, -318.6856312453747, -311.3646858930588, -318.1888539046049, -302.929479252547, -311.4612970463932, -296.81781785935163], "episode_lengths": [55, 82, 61, 117, 63, 58, 80, 60, 500, 58, 65, 113, 59, 55, 77, 54, 41, 57, 78, 62, 87, 52, 58, 59, 45, 93, 38, 85, 77, 69, 63, 63, 68, 70, 500, 116, 54, 68, 71, 81, 100, 79, 68, 48, 58, 500, 70, 71, 61, 98, 101, 54, 63, 60, 72, 57, 48, 57, 500, 67, 64, 63, 73, 53, 57, 93, 62, 500, 108, 52, 57, 500, 500, 500, 50, 500, 102, 68, 73, 55, 120, 67, 65, 500, 59, 68, 58, 60, 58, 65, 69, 76, 63, 62, 68, 81, 65, 62, 59, 63], "policy_shared_policy_reward": [-117.2019052306811, -104.59643212954204, -107.33206538359325, -123.65068010489146, -110.5990100602309, -110.43448917071025, -92.19782768686613, -93.78808676203093, -104.64369042714438, -102.03856280446053, -104.45033198595047, -118.48550474643707, -94.08869335055351, -93.56201702356339, -103.99477878212929, -99.54926925897598, -99.22690917924047, -113.33458322286606, -110.18539041280746, -97.70982883870602, -99.59010750055313, -104.97488872210185, -117.45035723845164, -104.78310138980548, 3.1063132087389533, 3.3626342664162223, 3.580984278271586, -108.49335660537085, -109.3204559882482, -120.83656599124274, -112.10028475522995, -102.92238584160805, -103.33270943164825, -100.87695819884539, -112.65043491125107, -102.20989355444908, -109.38614654541016, -97.54690493643284, -98.15295013785362, -116.27488990624747, -104.49164715905985, -104.0518738826116, -91.49348003168902, -91.91535917421183, -103.5429992278417, -97.86631958683333, -97.98798876007399, -111.6777911980947, -113.22647392749786, -100.6911350786686, -103.0114135146141, -114.59578613440196, -103.27986041704814, -102.81820351878802, -108.8741818467776, -96.49587419132392, -97.74070445696513, -94.4771782954534, -92.27698116501173, -103.52459474404654, -91.01383223136267, -90.7414872845014, -101.57849593957266, -116.06375058492026, -104.76476525266966, -106.85240616401038, -102.39020668466887, -114.47078295548758, -103.84440608819327, -107.25746178627014, -117.92820984125137, -107.46315383911133, -103.60179462035498, -117.08982535203299, -100.39468601842722, -96.5438819527626, -98.35804319381714, -109.8768458366394, -103.15374685327212, -115.08840082089107, -102.59034125010173, -92.03180100520453, -92.90800746281943, -103.44250317414603, -108.97862976789474, -119.727508187294, -105.62941814213991, -102.47412586212158, -99.71987759321928, -112.36915731430054, -93.97968634217978, -106.7144410610199, -93.87368842214346, -100.39217650145292, -112.92057710886002, -102.36769783496857, -106.89023152987163, -93.28191974262397, -92.82042172799508, -94.761359055837, -105.91162260373434, -93.36465541025004, -31.967087966700397, -32.04058470328649, -31.95821566631397, -116.85311191280684, -105.1867356201013, -105.63734762867293, -99.20165268580119, -97.13028924357302, -111.15749714771907, -113.54139826695125, -100.64186481262247, -104.31019655863444, -105.67958293358485, -95.35417822996776, -93.69429400066535, -98.14600982268652, -112.6723367770513, -99.70451303323111, -108.49015311400096, -96.2281071494023, -95.72290030370156, -97.47020615885656, -111.06067935625713, -99.03922984997432, -112.21224812666576, -100.07541818420093, -103.75113157431285, -113.57792934775352, -104.67091983556747, -105.64635372161865, -115.42689136664073, -101.66639975706737, -100.2534737388293, -3.751359601815551, -3.4921112855275567, -3.612361681958049, -102.01985614498457, -100.59975514312586, -112.13364185889563, -103.95391138394675, -114.6900397737821, -105.13096930583319, -108.2051264444987, -96.66279576222102, -95.2005391518275, -108.64743467171988, -93.97928982724747, -94.8553768893083, -101.13282145063083, -100.47714230666558, -112.48849065105121, -105.12624658147494, -117.17021367947261, -105.1926159063975, -101.37263341744742, -100.70373191436133, -111.64992763598761, -100.63459224502246, -100.48672474424045, -111.42347536484401, -102.003372301658, -100.22831349571547, -114.39739896853766, -109.92348778247833, -97.57257814705372, -98.66574200987816, -97.40513291954994, -96.11969868466258, -111.66489553451538, -99.49301940202713, -112.22634416818619, -99.1188110858202, -12.377001044650882, -12.263790888090938, -14.319421311219543, -96.92065699150166, -109.93614019950232, -97.55314098795256, -120.06498020887375, -106.37431208789349, -107.36265879869461, -96.39602664113045, -108.68268656730652, -97.12061244249344, -103.76130268971126, -107.21138910452525, -114.60005954901378, -117.6099862655004, -106.70452525218329, -105.59522559245428, -113.06793795029323, -101.47589341799419, -100.06048501531284, -104.25014038880667, -103.63007759054503, -115.36160310109457, -101.55672127505144, -115.65306605895361, -102.12342577179274, -8.036187800268337, -8.78860066334407, -8.515375057856247, -93.46869843204817, -91.92150348921618, -104.32424726088843, -99.63376194238663, -114.19999659061432, -101.44479185342789, -106.85780290762584, -95.26950720945995, -95.0197492192189, -8.793920834859222, -8.26201777656874, -7.915362899502128, 2.2636098215977256, 2.730537521342427, 2.6350989366571014, -12.200218858818218, -12.875988865892097, -12.647034908334419, -112.14850260814032, -101.12181774278483, -101.53506263097128, -0.7689586306611744, -0.9014297301570622, -1.4251903096834866, -112.33333210150401, -98.816407682995, -98.53058307121198, -100.86185811956724, -112.52381398280463, -99.79241608579954, -104.99212690194449, -115.80138378341994, -104.43805836637816, -100.50797603527705, -112.75130353371303, -99.07653413216273, -106.46498975157738, -107.66322356462479, -116.26937818527222, -109.39150412877402, -99.61598505576453, -99.89786674578986, -105.7869008978208, -101.98783427973589, -114.28727008899054, -11.159334885577366, -11.10547810296218, -10.877362466106817, -97.2566027144591, -110.11921368042628, -99.96600649754207, -97.80334009726843, -110.32178922494253, -96.88542990883192, -100.18956448634466, -97.21708859999976, -97.73017581303915, -102.40276038149993, -104.16708223025005, -116.1647360722224, -113.29694161812465, -99.60826876262824, -102.21146563688914, -110.90448609987895, -99.33624982337157, -102.70729384819667, -120.43416837851207, -106.66985596219699, -106.9079306224982, -90.33645882705848, -92.32476762930553, -102.88134209314983, -107.1025695502758, -107.22472807765007, -114.59584271907806, -101.11677893002829, -100.43361880381903, -109.9250907500585, -103.56730826695761, -113.62962939341864, -101.48869358499846, -100.71785072485606, -110.43998668591182, -100.20684848229091, -103.12285059690475, -114.51043212413788, -100.55557118356228, -108.27234137058258, -96.0163992755115, -98.64073860645294, -111.35617055495581, -98.81140253071985, -101.29372396071753, -94.81764205545187, -107.14749497175217, -94.8526808321476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15185044560449462, "mean_inference_ms": 0.6313007071020511, "mean_action_processing_ms": 0.091366993431214, "mean_env_wait_ms": 0.7548215896644015, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 25000, "timesteps_this_iter": 0, "agent_timesteps_total": 75000, "timers": {"sample_time_ms": 9419.12, "sample_throughput": 530.835, "load_time_ms": 0.2, "load_throughput": 25007774.863, "learn_time_ms": 1498.636, "learn_throughput": 3336.368, "update_time_ms": 7.038}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0125, "cur_lr": 0.0005000000000000001, "total_loss": 1747.8046752929688, "policy_loss": -0.003023842183548808, "vf_loss": 1747.8644897460938, "vf_explained_var": 0.018926000595092772, "kl": 0.003100358071243037, "entropy": 5.685691881179809, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 25000, "num_agent_steps_sampled": 75000, "num_steps_trained": 25000, "num_agent_steps_trained": 75000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 263, "training_iteration": 5, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-10-03", "timestamp": 1706227803, "time_this_iter_s": 9.53130316734314, "time_total_s": 48.466939210891724, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020280834F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 48.466939210891724, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 6.257142857142857, "ram_util_percent": 52.29285714285713}}
{"episode_reward_max": 7.629246279597254, "episode_reward_min": -334.01195496320724, "episode_reward_mean": -285.9758904644288, "episode_len_mean": 104.62, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {"shared_policy": -120.51556030909221}, "policy_reward_max": {"shared_policy": 2.730537521342427}, "policy_reward_mean": {"shared_policy": -95.32529682147627}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-325.5727513432503, -329.90973711013794, -314.60431638360023, -323.24182108044624, -319.3332131057978, -25.340163521468654, -289.7144491821528, -315.27855038642883, -297.14705933630466, -24.97130151093009, 7.629246279597254, -37.723242633044734, -314.8053829818964, -3.095578670501723, -309.680322855711, -313.1780881881714, -325.23156905174255, -312.3358137011528, -330.3975915014744, -308.90535593032837, -322.06200526654726, -33.14217545464636, -307.34182289242744, -305.0105592310429, -295.1368288993836, -322.73457868397236, -315.116676017642, -312.9480297714472, -334.01195496320724, -285.5425685495138, -328.92314034700394, -311.4754884839058, -318.6856312453747, -311.3646858930588, -318.1888539046049, -302.929479252547, -311.4612970463932, -296.81781785935163, -305.1602151840925, -306.7729849629104, -318.95960915088654, -312.95894449204206, -310.8626048564911, -305.8270085975528, -314.22380471229553, -299.78040847182274, -294.4435100331903, -294.7955594882369, -311.8525316119194, -310.0524917989969, -325.5867794454098, -314.8760638833046, -311.9060917794705, -331.0594642460346, -324.4890356063843, -315.2170982249081, -306.8061457872391, -316.74146093428135, -292.1058929860592, -327.08637660741806, -290.4763519912958, -329.78421050310135, -313.14689191430807, -11.377294853329673, -309.02920213341713, -320.51098704338074, -333.36263120174414, -290.26639437675476, -295.9101207256317, -332.58039167523384, -322.45423614978796, -311.5050518140197, -14.087369859218626, -302.96918726712465, -290.64533776044846, -310.48957988619804, -304.26038022339344, -309.29915368556976, -333.03715988993645, -308.1519015729428, -320.9083315730095, -327.21824946440756, -305.29440627992153, -302.55792128294706, -310.915390715003, -296.3280387073755, -310.2207341492176, -316.49997305125, -332.6355165541172, -302.42557153105736, -311.2845703661442, -312.15204361081123, -314.388069704175, -306.84374502301216, -34.069007724523544, -320.7515043541789, -316.87074814736843, -322.0561794638634, -294.47487000748515, -309.055601388216], "episode_lengths": [73, 53, 57, 93, 62, 500, 108, 52, 57, 500, 500, 500, 50, 500, 102, 68, 73, 55, 120, 67, 65, 500, 59, 68, 58, 60, 58, 65, 69, 76, 63, 62, 68, 81, 65, 62, 59, 63, 80, 62, 63, 55, 70, 53, 69, 80, 53, 60, 40, 72, 76, 64, 71, 57, 67, 65, 58, 51, 57, 57, 70, 58, 58, 500, 55, 52, 64, 61, 68, 46, 69, 62, 500, 53, 73, 66, 53, 60, 69, 86, 69, 55, 58, 82, 71, 67, 49, 49, 66, 52, 60, 94, 49, 80, 500, 78, 64, 67, 81, 77], "policy_shared_policy_reward": [-103.76130268971126, -107.21138910452525, -114.60005954901378, -117.6099862655004, -106.70452525218329, -105.59522559245428, -113.06793795029323, -101.47589341799419, -100.06048501531284, -104.25014038880667, -103.63007759054503, -115.36160310109457, -101.55672127505144, -115.65306605895361, -102.12342577179274, -8.036187800268337, -8.78860066334407, -8.515375057856247, -93.46869843204817, -91.92150348921618, -104.32424726088843, -99.63376194238663, -114.19999659061432, -101.44479185342789, -106.85780290762584, -95.26950720945995, -95.0197492192189, -8.793920834859222, -8.26201777656874, -7.915362899502128, 2.2636098215977256, 2.730537521342427, 2.6350989366571014, -12.200218858818218, -12.875988865892097, -12.647034908334419, -112.14850260814032, -101.12181774278483, -101.53506263097128, -0.7689586306611744, -0.9014297301570622, -1.4251903096834866, -112.33333210150401, -98.816407682995, -98.53058307121198, -100.86185811956724, -112.52381398280463, -99.79241608579954, -104.99212690194449, -115.80138378341994, -104.43805836637816, -100.50797603527705, -112.75130353371303, -99.07653413216273, -106.46498975157738, -107.66322356462479, -116.26937818527222, -109.39150412877402, -99.61598505576453, -99.89786674578986, -105.7869008978208, -101.98783427973589, -114.28727008899054, -11.159334885577366, -11.10547810296218, -10.877362466106817, -97.2566027144591, -110.11921368042628, -99.96600649754207, -97.80334009726843, -110.32178922494253, -96.88542990883192, -100.18956448634466, -97.21708859999976, -97.73017581303915, -102.40276038149993, -104.16708223025005, -116.1647360722224, -113.29694161812465, -99.60826876262824, -102.21146563688914, -110.90448609987895, -99.33624982337157, -102.70729384819667, -120.43416837851207, -106.66985596219699, -106.9079306224982, -90.33645882705848, -92.32476762930553, -102.88134209314983, -107.1025695502758, -107.22472807765007, -114.59584271907806, -101.11677893002829, -100.43361880381903, -109.9250907500585, -103.56730826695761, -113.62962939341864, -101.48869358499846, -100.71785072485606, -110.43998668591182, -100.20684848229091, -103.12285059690475, -114.51043212413788, -100.55557118356228, -108.27234137058258, -96.0163992755115, -98.64073860645294, -111.35617055495581, -98.81140253071985, -101.29372396071753, -94.81764205545187, -107.14749497175217, -94.8526808321476, -97.57592195769152, -98.35396381219229, -109.23032941420874, -100.28998498121898, -96.6503146501879, -109.83268533150355, -101.13335555791855, -114.4398204088211, -103.38643318414688, -113.47454178333282, -99.97946317493916, -99.50493953377008, -100.5673597852389, -110.12089745203654, -100.17434761921565, -97.45323583483696, -110.67110031843185, -97.70267244428396, -112.17775948842367, -101.02166362603506, -101.02438159783682, -95.57566916942596, -108.24297732114792, -95.96176198124886, -106.55205770333609, -94.26847509046397, -93.62297723939022, -106.04051884015402, -94.02407988657555, -94.73096076150736, -100.53714529673259, -112.1822799841563, -99.13310633103053, -110.77661201357841, -99.36363458633423, -99.91224519908428, -103.09986383716266, -105.32295988003413, -117.163955728213, -112.29735736052196, -101.0263875524203, -101.55231897036235, -99.58522515495619, -111.91526683171591, -100.40559979279837, -114.77521634101868, -102.53199598193169, -113.75225192308426, -103.95702769358954, -115.45245369275412, -105.07955422004065, -100.30990445489685, -112.89293132225673, -102.01426244775455, -110.46260571479797, -97.94632053375244, -98.39721953868866, -101.19759060442448, -113.41316848993301, -102.13070183992386, -94.62963847319286, -104.90280477205913, -92.57344974080722, -103.42903516689937, -105.44518045584361, -118.2121609846751, -104.30030433336894, -93.75960437456767, -92.41644328335921, -115.80382919311523, -100.6355739235878, -113.34480738639832, -100.52850342790286, -113.41684035460155, -99.20154813180368, -4.082355389992401, -3.720479274789497, -3.574460188547775, -99.21861888468266, -99.11165417730808, -110.69892907142639, -104.01525487502417, -115.080097814401, -101.4156343539556, -106.82861169179282, -119.75616117318472, -106.77785833676657, -103.76222413778305, -93.53032004833221, -92.9738501906395, -94.40351703763008, -106.33842819929123, -95.1681754887104, -105.15399462978046, -107.28455118338267, -120.14184586207072, -102.56859262784323, -114.55589761336645, -105.32974590857825, -111.84301495552063, -100.09831853210926, -99.56371832638979, -4.841002364953368, -4.7600094502170975, -4.48635804404816, -98.63128489255905, -96.04725102335215, -108.29065135121346, -92.18922865390778, -94.22246468067169, -104.23364442586899, -98.55447282393774, -112.51737435658774, -99.41773270567259, -98.51409247517586, -97.01235531270504, -108.73393243551254, -112.16037392616272, -97.68761962652206, -99.45116013288498, -107.4891663591067, -105.03243322173755, -120.51556030909221, -109.65412559111914, -101.28252985080084, -97.21524613102278, -104.33599362770717, -102.52732108036678, -114.04501686493556, -119.69511616230011, -103.15981310047209, -104.36332020163536, -98.06024474898975, -109.91363821427028, -97.32052331666152, -96.36534460633993, -108.39167904853821, -97.80089762806892, -99.92854749659698, -111.61067841450374, -99.37616480390231, -94.57578271130721, -95.26645175615947, -106.48580423990886, -101.27360347906749, -109.99359462658565, -98.95353604356448, -100.42816635221243, -103.7331673502922, -112.33863934874535, -106.31898354490599, -108.20728715260825, -118.109245856603, -96.85955200344324, -96.71252470463514, -108.85349482297897, -98.81681277354559, -97.74697034557661, -114.720787247022, -100.10303987562656, -111.73377028107643, -100.31523345410824, -100.29560507833958, -113.06838148832321, -101.0240831375122, -110.17913909753165, -98.28417377670607, -98.38043214877447, -11.489385917782784, -11.386030904948711, -11.19359090179205, -100.05462099363407, -114.53655489285788, -106.16032846768698, -102.10143937667212, -114.13694097598395, -100.6323677947124, -114.44733951489131, -102.18542102972667, -105.4234189192454, -108.64041936397552, -93.09577272087336, -92.73867792263627, -100.68329052130382, -110.26749835411708, -98.10481251279514]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14812847598544576, "mean_inference_ms": 0.6277398443750706, "mean_action_processing_ms": 0.09190413870125905, "mean_env_wait_ms": 0.7566530398733099, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 30000, "timesteps_this_iter": 0, "agent_timesteps_total": 90000, "timers": {"sample_time_ms": 9445.761, "sample_throughput": 529.338, "load_time_ms": 0.167, "load_throughput": 30009329.835, "learn_time_ms": 1497.225, "learn_throughput": 3339.511, "update_time_ms": 7.031}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005000000000000001, "total_loss": 3708.827734375, "policy_loss": -0.003039763622597391, "vf_loss": 3708.8891845703124, "vf_explained_var": 0.015015488862991333, "kl": 0.003457352171245664, "entropy": 5.823833751678467, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 30000, "num_agent_steps_sampled": 90000, "num_steps_trained": 30000, "num_agent_steps_trained": 90000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 325, "training_iteration": 6, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-10-13", "timestamp": 1706227813, "time_this_iter_s": 9.554844379425049, "time_total_s": 58.02178359031677, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202821C6700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 58.02178359031677, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 6.307692307692308, "ram_util_percent": 52.3076923076923}}
{"episode_reward_max": -14.334181696176543, "episode_reward_min": -606.9441530406475, "episode_reward_mean": -305.3850179635803, "episode_len_mean": 79.69, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {"shared_policy": -212.6546493768692}, "policy_reward_max": {"shared_policy": -4.71293854216735}, "policy_reward_mean": {"shared_policy": -101.7950059878601}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-310.48957988619804, -304.26038022339344, -309.29915368556976, -333.03715988993645, -308.1519015729428, -320.9083315730095, -327.21824946440756, -305.29440627992153, -302.55792128294706, -310.915390715003, -296.3280387073755, -310.2207341492176, -316.49997305125, -332.6355165541172, -302.42557153105736, -311.2845703661442, -312.15204361081123, -314.388069704175, -306.84374502301216, -34.069007724523544, -320.7515043541789, -316.87074814736843, -322.0561794638634, -294.47487000748515, -309.055601388216, -309.8207134306431, -306.14721758291125, -301.81565942801535, -313.1348641216755, -308.39695030450827, -315.10350865498185, -329.9642657339573, -292.48075760900974, -321.8484999835491, -303.9980544708669, -292.3686445057392, -312.79134748131037, -329.5563347041607, -298.6880087181926, -300.6223499029875, -94.13949581980717, -308.00966921448713, -312.77861481904984, -311.35997487977147, -330.73237347602844, -327.16767606139183, -312.9859613031149, -317.9879990071058, -313.4925413057208, -294.6010580956936, -284.12106178700924, -297.76718232035637, -282.37732392549515, -305.3279418051243, -321.5553257763386, -320.35266092419624, -296.0328203588724, -319.27832689881325, -298.39186269044876, -291.8396809771657, -298.9062491208315, -311.982094347477, -320.37697815895086, -317.24605456739664, -311.8946807458997, -293.05465939641, -303.57245925068855, -305.82307520508766, -299.75663459300995, -318.06970132887363, -14.334181696176543, -316.1807663291693, -307.410110861063, -289.75199325382715, -305.41797398775816, -291.8345818966627, -334.5168414711953, -286.0223675817251, -314.30398762226105, -606.9441530406475, -295.28493501245975, -304.5934243798256, -330.3954758942127, -318.7131388261914, -306.26527857780457, -324.2746698856354, -317.09915122389793, -293.65703214146197, -332.4547582268715, -329.93448985368013, -328.73246033489704, -321.0662216246128, -317.3172821700573, -324.8027823269368, -306.23577277362347, -312.7672192454338, -306.0244437456131, -301.52045553922653, -312.23140402138233, -298.5064796644692], "episode_lengths": [66, 53, 60, 69, 86, 69, 55, 58, 82, 71, 67, 49, 49, 66, 52, 60, 94, 49, 80, 500, 78, 64, 67, 81, 77, 67, 49, 63, 61, 58, 53, 63, 85, 79, 71, 80, 59, 56, 69, 65, 500, 64, 79, 58, 85, 96, 72, 78, 84, 72, 83, 65, 72, 63, 61, 55, 81, 60, 61, 85, 47, 57, 51, 40, 46, 67, 61, 65, 65, 76, 500, 64, 61, 64, 67, 72, 59, 65, 55, 64, 52, 78, 77, 56, 63, 53, 61, 84, 76, 101, 50, 55, 77, 55, 84, 84, 67, 78, 56, 62], "policy_shared_policy_reward": [-98.55447282393774, -112.51737435658774, -99.41773270567259, -98.51409247517586, -97.01235531270504, -108.73393243551254, -112.16037392616272, -97.68761962652206, -99.45116013288498, -107.4891663591067, -105.03243322173755, -120.51556030909221, -109.65412559111914, -101.28252985080084, -97.21524613102278, -104.33599362770717, -102.52732108036678, -114.04501686493556, -119.69511616230011, -103.15981310047209, -104.36332020163536, -98.06024474898975, -109.91363821427028, -97.32052331666152, -96.36534460633993, -108.39167904853821, -97.80089762806892, -99.92854749659698, -111.61067841450374, -99.37616480390231, -94.57578271130721, -95.26645175615947, -106.48580423990886, -101.27360347906749, -109.99359462658565, -98.95353604356448, -100.42816635221243, -103.7331673502922, -112.33863934874535, -106.31898354490599, -108.20728715260825, -118.109245856603, -96.85955200344324, -96.71252470463514, -108.85349482297897, -98.81681277354559, -97.74697034557661, -114.720787247022, -100.10303987562656, -111.73377028107643, -100.31523345410824, -100.29560507833958, -113.06838148832321, -101.0240831375122, -110.17913909753165, -98.28417377670607, -98.38043214877447, -11.489385917782784, -11.386030904948711, -11.19359090179205, -100.05462099363407, -114.53655489285788, -106.16032846768698, -102.10143937667212, -114.13694097598395, -100.6323677947124, -114.44733951489131, -102.18542102972667, -105.4234189192454, -108.64041936397552, -93.09577272087336, -92.73867792263627, -100.68329052130382, -110.26749835411708, -98.10481251279514, -110.37247643868129, -98.31754447023074, -101.13069252173106, -97.62643122424683, -110.91098209222159, -97.60980426644286, -108.79730232556662, -96.62075952192149, -96.39759758052728, -105.3510426481565, -103.66288547714552, -104.1209359963735, -110.08392103513083, -99.83016379674277, -98.48286547263464, -114.27145338058472, -101.1650881767273, -99.66696709766984, -114.84546911716461, -114.5207045674324, -100.59809204936028, -104.64641630649567, -92.9889852553606, -94.84535604715347, -115.51837108532588, -103.59594307343166, -102.7341858247916, -95.78239491209388, -109.7034016251564, -98.51225793361664, -93.0752221842607, -105.36969538529715, -93.9237269361814, -111.8493087887764, -101.70941638946533, -99.23262230306864, -117.59082156419754, -106.74910354614258, -105.21640959382057, -107.4320792555809, -95.07970546931028, -96.17622399330139, -96.98611289262772, -95.79902194440365, -107.83721506595612, -30.5745316396157, -32.584965984026596, -30.97999819616477, -109.70197733243307, -99.14840545256934, -99.1592864294847, -113.19759132464728, -100.48530953129134, -99.09571396311125, -98.52902883912127, -98.78836170087258, -114.04258433977763, -118.99140959978104, -105.53202277421951, -106.2089411020279, -107.53263318538666, -116.31342673301697, -103.3216161429882, -101.4134285648664, -111.98749967416128, -99.58503306408724, -115.51257880528769, -101.87598841389021, -100.59943178792795, -101.12508928775787, -99.98460011929274, -112.3828518986702, -94.8301287094752, -94.06572626034419, -105.7052031258742, -104.38130418459575, -91.06472442547481, -88.6750331769387, -106.86913878719012, -95.45378656188647, -95.44425697127978, -89.90113863348961, -90.68013885617256, -101.79604643583298, -112.77489320437114, -96.5776813129584, -95.97536728779475, -114.01973066727321, -102.74411095182101, -104.79148415724437, -115.44681719938914, -102.65268779794376, -102.25315592686336, -95.73186266422272, -94.40387870371342, -105.89707899093628, -101.81571726004283, -102.31628317634265, -115.14632646242778, -96.22287656863531, -96.25068153937659, -105.91830458243689, -106.33158479134242, -93.33533797661464, -92.17275820920865, -96.2345479230086, -106.94183839360873, -95.72986280421416, -98.88321598370871, -113.18075438340506, -99.91812398036322, -100.63024260600409, -114.86269660790762, -104.88403894503912, -101.91208724180858, -114.34900764624278, -100.9849596793453, -99.43213069190583, -111.38216276963553, -101.08038728435835, -94.18795343240103, -106.47791620095572, -92.38878976305327, -97.47158379356067, -96.94529340664546, -109.15558205048244, -97.8047637740771, -97.20501483480136, -110.81329659620921, -96.3297110994657, -97.02426465352377, -106.40265884002051, -115.01055977741878, -101.06097250680129, -101.99816904465358, -4.820393274227783, -4.80084987978141, -4.71293854216735, -103.317962149779, -100.51088073352973, -112.35192344586055, -98.91094467043877, -110.13236439228058, -98.36680179834366, -104.29699780543646, -92.83884646495184, -92.61614898343882, -109.99613787730536, -98.3062633474668, -97.11557276298603, -96.57759821414948, -104.72038930654526, -90.53659437596798, -119.70798005660376, -107.4313129981359, -107.3775484164556, -92.21096019943556, -103.15120424826941, -90.66020313402018, -100.40442615747452, -113.80005449056625, -100.09950697422028, -198.17477142810822, -196.1147322356701, -212.6546493768692, -94.4367360820373, -94.46772863467535, -106.38047029574713, -106.86847563584647, -97.82014097770056, -99.9048077662786, -105.82497456669807, -118.70706939697266, -105.86343193054199, -101.6809154972434, -115.3930236697197, -101.63919965922832, -109.29967869321506, -98.1284007827441, -98.83719910184543, -115.58367311954498, -104.39312070608139, -104.297876060009, -113.60580615202586, -101.42300642530124, -102.07033864657085, -94.50932116309802, -92.99205990570287, -106.15565107266109, -119.47712111473083, -107.16071444749832, -105.81692266464233, -106.09203669428825, -104.83780465275049, -119.00464850664139, -116.08606690168381, -104.55908568203449, -108.08730775117874, -105.69007949034373, -102.4102194706599, -112.96592266360919, -100.9515527834495, -115.39878757794699, -100.96694180866083, -101.5211575527986, -118.93855937321982, -104.34306540091833, -111.09341925382614, -97.12468786537647, -98.01766565442085, -100.63626150290172, -99.28276548782985, -112.84819225470225, -97.60406045118968, -108.54713348547618, -99.87324980894725, -96.7325243552526, -97.45267333587012, -107.33525784810385, -99.4775799115499, -99.66161051889262, -113.09221359093985, -103.51774347821872, -103.87916920582454, -91.10956698042598]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15135623965891537, "mean_inference_ms": 0.632258406904602, "mean_action_processing_ms": 0.09186352812004143, "mean_env_wait_ms": 0.7571884046901317, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 35000, "timesteps_this_iter": 0, "agent_timesteps_total": 105000, "timers": {"sample_time_ms": 9532.974, "sample_throughput": 524.495, "load_time_ms": 0.143, "load_throughput": 35010884.808, "learn_time_ms": 1495.315, "learn_throughput": 3343.778, "update_time_ms": 7.026}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.003125, "cur_lr": 0.0005000000000000001, "total_loss": 4513.906884765625, "policy_loss": -0.0023232844116193975, "vf_loss": 4513.968505859375, "vf_explained_var": -0.004092848300933838, "kl": 0.003051800720278489, "entropy": 5.92438235282898, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 35000, "num_agent_steps_sampled": 105000, "num_steps_trained": 35000, "num_agent_steps_trained": 105000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 400, "training_iteration": 7, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-10-23", "timestamp": 1706227823, "time_this_iter_s": 10.02087116241455, "time_total_s": 68.04265475273132, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028457D3A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 68.04265475273132, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 7.207142857142856, "ram_util_percent": 52.328571428571415}}
{"episode_reward_max": -14.334181696176543, "episode_reward_min": -626.249154895544, "episode_reward_mean": -310.07188246736996, "episode_len_mean": 76.59, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {"shared_policy": -215.4192233880361}, "policy_reward_max": {"shared_policy": -4.71293854216735}, "policy_reward_mean": {"shared_policy": -103.35729415578999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-313.4925413057208, -294.6010580956936, -284.12106178700924, -297.76718232035637, -282.37732392549515, -305.3279418051243, -321.5553257763386, -320.35266092419624, -296.0328203588724, -319.27832689881325, -298.39186269044876, -291.8396809771657, -298.9062491208315, -311.982094347477, -320.37697815895086, -317.24605456739664, -311.8946807458997, -293.05465939641, -303.57245925068855, -305.82307520508766, -299.75663459300995, -318.06970132887363, -14.334181696176543, -316.1807663291693, -307.410110861063, -289.75199325382715, -305.41797398775816, -291.8345818966627, -334.5168414711953, -286.0223675817251, -314.30398762226105, -606.9441530406475, -295.28493501245975, -304.5934243798256, -330.3954758942127, -318.7131388261914, -306.26527857780457, -324.2746698856354, -317.09915122389793, -293.65703214146197, -332.4547582268715, -329.93448985368013, -328.73246033489704, -321.0662216246128, -317.3172821700573, -324.8027823269368, -306.23577277362347, -312.7672192454338, -306.0244437456131, -301.52045553922653, -312.23140402138233, -298.5064796644692, -311.9949830174446, -318.2653567790985, -307.41195228695875, -310.8840073738248, -320.9725714325905, -328.15239641070366, -297.8152608722449, -318.1349940896034, -318.824907541275, -298.9944254681468, -307.22444516420364, -299.0155777521432, -315.64512281119823, -309.4743658006191, -315.85923889279366, -307.5571208000183, -288.65253522992134, -313.86425767838955, -329.42430970072746, -312.5149318575859, -320.41143779456615, -289.145065844059, -305.75845189392567, -626.249154895544, -312.87885069847107, -318.3298718035221, -318.1879832148552, -318.30755861476064, -315.2839121390134, -338.30153603851795, -286.9113204665482, -259.28682270273566, -318.0670779943466, -313.25823989510536, -323.57070399820805, -300.54140432178974, -297.41171512007713, -312.22598361968994, -318.0353919751943, -316.83183947205544, -320.395543307066, -315.32373839616776, -294.8977568298578, -320.9136783685535, -270.2382360622287, -333.78046844899654, -41.18668240308763, -316.3608526699245], "episode_lengths": [84, 72, 83, 65, 72, 63, 61, 55, 81, 60, 61, 85, 47, 57, 51, 40, 46, 67, 61, 65, 65, 76, 500, 64, 61, 64, 67, 72, 59, 65, 55, 64, 52, 78, 77, 56, 63, 53, 61, 84, 76, 101, 50, 55, 77, 55, 84, 84, 67, 78, 56, 62, 60, 53, 69, 59, 59, 66, 76, 113, 70, 62, 55, 73, 52, 41, 72, 52, 60, 45, 69, 68, 57, 64, 54, 63, 89, 71, 55, 49, 84, 207, 78, 96, 82, 67, 52, 67, 71, 105, 49, 72, 78, 73, 55, 59, 102, 79, 500, 50], "policy_shared_policy_reward": [-101.12508928775787, -99.98460011929274, -112.3828518986702, -94.8301287094752, -94.06572626034419, -105.7052031258742, -104.38130418459575, -91.06472442547481, -88.6750331769387, -106.86913878719012, -95.45378656188647, -95.44425697127978, -89.90113863348961, -90.68013885617256, -101.79604643583298, -112.77489320437114, -96.5776813129584, -95.97536728779475, -114.01973066727321, -102.74411095182101, -104.79148415724437, -115.44681719938914, -102.65268779794376, -102.25315592686336, -95.73186266422272, -94.40387870371342, -105.89707899093628, -101.81571726004283, -102.31628317634265, -115.14632646242778, -96.22287656863531, -96.25068153937659, -105.91830458243689, -106.33158479134242, -93.33533797661464, -92.17275820920865, -96.2345479230086, -106.94183839360873, -95.72986280421416, -98.88321598370871, -113.18075438340506, -99.91812398036322, -100.63024260600409, -114.86269660790762, -104.88403894503912, -101.91208724180858, -114.34900764624278, -100.9849596793453, -99.43213069190583, -111.38216276963553, -101.08038728435835, -94.18795343240103, -106.47791620095572, -92.38878976305327, -97.47158379356067, -96.94529340664546, -109.15558205048244, -97.8047637740771, -97.20501483480136, -110.81329659620921, -96.3297110994657, -97.02426465352377, -106.40265884002051, -115.01055977741878, -101.06097250680129, -101.99816904465358, -4.820393274227783, -4.80084987978141, -4.71293854216735, -103.317962149779, -100.51088073352973, -112.35192344586055, -98.91094467043877, -110.13236439228058, -98.36680179834366, -104.29699780543646, -92.83884646495184, -92.61614898343882, -109.99613787730536, -98.3062633474668, -97.11557276298603, -96.57759821414948, -104.72038930654526, -90.53659437596798, -119.70798005660376, -107.4313129981359, -107.3775484164556, -92.21096019943556, -103.15120424826941, -90.66020313402018, -100.40442615747452, -113.80005449056625, -100.09950697422028, -198.17477142810822, -196.1147322356701, -212.6546493768692, -94.4367360820373, -94.46772863467535, -106.38047029574713, -106.86847563584647, -97.82014097770056, -99.9048077662786, -105.82497456669807, -118.70706939697266, -105.86343193054199, -101.6809154972434, -115.3930236697197, -101.63919965922832, -109.29967869321506, -98.1284007827441, -98.83719910184543, -115.58367311954498, -104.39312070608139, -104.297876060009, -113.60580615202586, -101.42300642530124, -102.07033864657085, -94.50932116309802, -92.99205990570287, -106.15565107266109, -119.47712111473083, -107.16071444749832, -105.81692266464233, -106.09203669428825, -104.83780465275049, -119.00464850664139, -116.08606690168381, -104.55908568203449, -108.08730775117874, -105.69007949034373, -102.4102194706599, -112.96592266360919, -100.9515527834495, -115.39878757794699, -100.96694180866083, -101.5211575527986, -118.93855937321982, -104.34306540091833, -111.09341925382614, -97.12468786537647, -98.01766565442085, -100.63626150290172, -99.28276548782985, -112.84819225470225, -97.60406045118968, -108.54713348547618, -99.87324980894725, -96.7325243552526, -97.45267333587012, -107.33525784810385, -99.4775799115499, -99.66161051889262, -113.09221359093985, -103.51774347821872, -103.87916920582454, -91.10956698042598, -98.95676907896996, -99.80142411589622, -113.23678982257843, -114.2308553258578, -100.61233810583751, -103.42216334740321, -97.63195170958838, -110.90744896729788, -98.87255161007246, -113.13790937264761, -99.85089083512625, -97.89520716605088, -115.22928696870804, -102.34724801778793, -103.39603644609451, -118.09525803724925, -105.62782214085262, -104.4293162326018, -106.77377300461134, -95.05361313124499, -95.98787473638853, -113.3679538567861, -101.16232361396155, -103.6047166188558, -102.7851497133573, -102.71352728207907, -113.32623054583868, -107.13092450300853, -95.20674318323533, -96.65675778190295, -98.11290302872658, -110.2160137295723, -98.89552840590477, -95.57512141143283, -107.80322362979254, -95.6372327109178, -100.83503126601379, -113.1282021800677, -101.68188936511676, -112.95458205540976, -97.91219644745192, -98.60758729775748, -113.27897953987122, -100.94344082474709, -101.63681852817535, -100.17591392993927, -97.52501553297043, -109.85619133710861, -94.64263116319975, -97.41145273049673, -96.59845133622488, -100.89963380495708, -113.39043978850047, -99.57418408493201, -117.41977228720984, -106.50352462132773, -105.50101279218993, -99.14147570729256, -99.06483545899391, -114.30862069129944, -114.60940166314444, -101.49054682751498, -104.31148930390677, -105.23494690656662, -92.00223118066788, -91.9078877568245, -110.38746962944667, -98.29551885525386, -97.07546340922515, -203.35927360256514, -215.4192233880361, -207.47065790494284, -101.63879305124283, -99.87451612949371, -111.36554151773453, -102.72678650418918, -113.83811912933986, -101.76496616999309, -101.36771995325884, -101.16573337217173, -115.65452988942465, -101.04552591219544, -115.18985331058502, -102.07217939198017, -102.41273561120033, -112.59729051589966, -100.27388601191342, -108.31948766112328, -117.30192051827908, -112.6801278591156, -92.27719077964625, -91.36985119556388, -103.2642784913381, -84.13987640539806, -93.45177684227626, -81.69516945506136, -103.05112063884735, -106.66884779930115, -108.34710955619812, -99.77551876505217, -101.31294741233191, -112.16977371772131, -117.90546051661174, -102.33180388311546, -103.33343959848087, -110.97852043310802, -94.73096496860187, -94.83191892007987, -95.61959381898245, -95.14810453852019, -106.64401676257452, -100.73923315604529, -100.5235707362493, -110.96317972739539, -100.89338267718753, -102.67820664246878, -114.46380265553793, -101.5992637773355, -113.5586345990499, -101.67394109567007, -102.10094157358012, -115.6336912115415, -102.66091052194437, -112.39716855684917, -101.08615366617839, -101.84041617314021, -97.0499439885219, -99.54093452294669, -98.30687831838927, -115.4656170209249, -103.61124767859778, -101.83681366903087, -87.32353788614273, -97.71542859077454, -85.19926958531141, -106.08588602642219, -109.18793563048045, -118.50664679209392, -13.924015651146576, -13.457589114705726, -13.805077637235328, -114.43746709823608, -100.21580047532916, -101.70758509635925]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1530121117794012, "mean_inference_ms": 0.6325625479158856, "mean_action_processing_ms": 0.09161168559734537, "mean_env_wait_ms": 0.7539158616030693, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 40000, "timesteps_this_iter": 0, "agent_timesteps_total": 120000, "timers": {"sample_time_ms": 9536.435, "sample_throughput": 524.305, "load_time_ms": 0.125, "load_throughput": 40012439.781, "learn_time_ms": 1494.11, "learn_throughput": 3346.475, "update_time_ms": 7.148}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005000000000000001, "total_loss": 2839.4764892578123, "policy_loss": -0.0018106476221575463, "vf_loss": 2839.53623046875, "vf_explained_var": 0.012801986932754517, "kl": 0.0035104064882048014, "entropy": 5.806071186065674, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 40000, "num_agent_steps_sampled": 120000, "num_steps_trained": 40000, "num_agent_steps_trained": 120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 448, "training_iteration": 8, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-10-32", "timestamp": 1706227832, "time_this_iter_s": 9.53626036643982, "time_total_s": 77.57891511917114, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202822183A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 77.57891511917114, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 6.171428571428572, "ram_util_percent": 52.30714285714284}}
{"episode_reward_max": -31.570099584758296, "episode_reward_min": -626.249154895544, "episode_reward_mean": -303.86171201476014, "episode_len_mean": 86.52, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {"shared_policy": -215.4192233880361}, "policy_reward_max": {"shared_policy": -10.274006473521396}, "policy_reward_mean": {"shared_policy": -101.28723733825338}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-310.8840073738248, -320.9725714325905, -328.15239641070366, -297.8152608722449, -318.1349940896034, -318.824907541275, -298.9944254681468, -307.22444516420364, -299.0155777521432, -315.64512281119823, -309.4743658006191, -315.85923889279366, -307.5571208000183, -288.65253522992134, -313.86425767838955, -329.42430970072746, -312.5149318575859, -320.41143779456615, -289.145065844059, -305.75845189392567, -626.249154895544, -312.87885069847107, -318.3298718035221, -318.1879832148552, -318.30755861476064, -315.2839121390134, -338.30153603851795, -286.9113204665482, -259.28682270273566, -318.0670779943466, -313.25823989510536, -323.57070399820805, -300.54140432178974, -297.41171512007713, -312.22598361968994, -318.0353919751943, -316.83183947205544, -320.395543307066, -315.32373839616776, -294.8977568298578, -320.9136783685535, -270.2382360622287, -333.78046844899654, -41.18668240308763, -316.3608526699245, -49.94963737204672, -323.2236529625952, -300.01113370060926, -334.50327429175377, -298.87662848830223, -299.89051717519766, -301.6044066771865, -314.54274266958237, -304.6289385808632, -322.78341022785753, -324.95015424489975, -314.3900995142758, -311.08600510656834, -306.5667557120323, -310.6598592698574, -287.4037478491664, -46.5929898992181, -326.0739215910435, -306.43821081519127, -296.8273912742734, -303.7848661839962, -328.1472476273775, -318.1342195868492, -307.94045527279377, -331.00576081871986, -319.47448974102736, -308.46271672844887, -290.35157330334187, -291.0386581599014, -327.7296022027731, -312.45173993706703, -310.9623503014446, -295.4632345438004, -329.7095100879669, -311.18360713124275, -321.00725468993187, -314.24959018081427, -328.6664356030524, -311.7343091312796, -294.4521808363497, -312.4912780225277, -304.5306244343519, -330.228636816144, -300.5789896994829, -305.02554577589035, -31.570099584758296, -293.9139113128185, -318.5316646695137, -321.3179083764553, -357.7638325691223, -292.2471809312701, -303.6343625225127, -320.3374828696251, -313.1814424544573, -328.7632140815258], "episode_lengths": [59, 59, 66, 76, 113, 70, 62, 55, 73, 52, 41, 72, 52, 60, 45, 69, 68, 57, 64, 54, 63, 89, 71, 55, 49, 84, 207, 78, 96, 82, 67, 52, 67, 71, 105, 49, 72, 78, 73, 55, 59, 102, 79, 500, 50, 500, 88, 64, 58, 80, 65, 49, 77, 91, 45, 66, 71, 70, 62, 79, 87, 500, 59, 65, 72, 65, 80, 41, 77, 75, 52, 51, 150, 64, 53, 80, 67, 77, 67, 64, 59, 76, 61, 73, 69, 54, 65, 78, 71, 64, 500, 59, 62, 55, 62, 89, 57, 66, 39, 62], "policy_shared_policy_reward": [-113.13790937264761, -99.85089083512625, -97.89520716605088, -115.22928696870804, -102.34724801778793, -103.39603644609451, -118.09525803724925, -105.62782214085262, -104.4293162326018, -106.77377300461134, -95.05361313124499, -95.98787473638853, -113.3679538567861, -101.16232361396155, -103.6047166188558, -102.7851497133573, -102.71352728207907, -113.32623054583868, -107.13092450300853, -95.20674318323533, -96.65675778190295, -98.11290302872658, -110.2160137295723, -98.89552840590477, -95.57512141143283, -107.80322362979254, -95.6372327109178, -100.83503126601379, -113.1282021800677, -101.68188936511676, -112.95458205540976, -97.91219644745192, -98.60758729775748, -113.27897953987122, -100.94344082474709, -101.63681852817535, -100.17591392993927, -97.52501553297043, -109.85619133710861, -94.64263116319975, -97.41145273049673, -96.59845133622488, -100.89963380495708, -113.39043978850047, -99.57418408493201, -117.41977228720984, -106.50352462132773, -105.50101279218993, -99.14147570729256, -99.06483545899391, -114.30862069129944, -114.60940166314444, -101.49054682751498, -104.31148930390677, -105.23494690656662, -92.00223118066788, -91.9078877568245, -110.38746962944667, -98.29551885525386, -97.07546340922515, -203.35927360256514, -215.4192233880361, -207.47065790494284, -101.63879305124283, -99.87451612949371, -111.36554151773453, -102.72678650418918, -113.83811912933986, -101.76496616999309, -101.36771995325884, -101.16573337217173, -115.65452988942465, -101.04552591219544, -115.18985331058502, -102.07217939198017, -102.41273561120033, -112.59729051589966, -100.27388601191342, -108.31948766112328, -117.30192051827908, -112.6801278591156, -92.27719077964625, -91.36985119556388, -103.2642784913381, -84.13987640539806, -93.45177684227626, -81.69516945506136, -103.05112063884735, -106.66884779930115, -108.34710955619812, -99.77551876505217, -101.31294741233191, -112.16977371772131, -117.90546051661174, -102.33180388311546, -103.33343959848087, -110.97852043310802, -94.73096496860187, -94.83191892007987, -95.61959381898245, -95.14810453852019, -106.64401676257452, -100.73923315604529, -100.5235707362493, -110.96317972739539, -100.89338267718753, -102.67820664246878, -114.46380265553793, -101.5992637773355, -113.5586345990499, -101.67394109567007, -102.10094157358012, -115.6336912115415, -102.66091052194437, -112.39716855684917, -101.08615366617839, -101.84041617314021, -97.0499439885219, -99.54093452294669, -98.30687831838927, -115.4656170209249, -103.61124767859778, -101.83681366903087, -87.32353788614273, -97.71542859077454, -85.19926958531141, -106.08588602642219, -109.18793563048045, -118.50664679209392, -13.924015651146576, -13.457589114705726, -13.805077637235328, -114.43746709823608, -100.21580047532916, -101.70758509635925, -16.19209059203665, -16.46278201291959, -17.294764767090484, -117.0571676492691, -102.04937607422471, -104.11710923910141, -107.88030495246252, -96.0223396619161, -96.1084890862306, -113.10341776410739, -102.737885872523, -118.6619706551234, -94.86912679672241, -95.21761175990105, -108.78988993167877, -109.85325690110525, -95.811043938001, -94.22621633609137, -96.5608282983303, -108.85621255636215, -96.18736582249403, -100.12305905421576, -101.79529448350272, -112.62438913186392, -111.46917978922527, -97.66961226860683, -95.4901465230311, -104.4023887316386, -101.5295595691229, -116.85146192709605, -104.4831200838089, -116.26411283016205, -104.2029213309288, -99.95905843252937, -113.27093074719112, -101.16011033455531, -99.49138606091341, -111.20083781083426, -100.3937812348207, -97.00979975859325, -99.46500031153361, -110.09195564190547, -100.39831854899725, -100.24712838729224, -110.01441233356795, -92.72050733367603, -103.51578603188197, -91.16745448360841, -14.559852058688804, -14.227309587101146, -17.805828253428146, -102.75310311714809, -103.41385532418887, -119.90696314970653, -108.01260965069136, -98.13633533318838, -100.28926583131155, -94.30281018217406, -93.0077158783873, -109.51686521371207, -99.29646799961726, -96.49932513634364, -107.98907304803531, -106.97865986824036, -103.76453818380833, -117.40404957532883, -112.96734062830608, -102.26887253920238, -102.89800641934077, -100.37971629699072, -97.94533601899943, -109.61540295680365, -106.29709986845653, -118.975787738959, -105.73287321130435, -99.89910621692738, -116.09803088506064, -103.47735263903937, -98.69357549150786, -110.03075905640921, -99.73838218053183, -93.54947254061699, -104.68255639076233, -92.11954437196255, -92.1655915408628, -105.82778257131577, -93.04528404772282, -103.68651341895263, -118.95216588179271, -105.09092290202777, -101.19012788931529, -110.65052540103595, -100.6110866467158, -111.9970665772756, -100.48739685614905, -98.47788686801991, -103.70992900927862, -94.00417091449103, -97.74913462003073, -118.70214726527533, -105.01640509565672, -105.9909577270349, -110.77484399080276, -101.53893262147903, -98.86983051896095, -102.02047063906988, -101.0096937318643, -117.97709031899771, -112.70383915305138, -100.80248466134071, -100.74326636642218, -111.06995697195332, -115.46528206268947, -102.1311965684096, -97.42530548013747, -100.44199496507645, -113.86700868606567, -89.07314733043313, -104.28857183456421, -101.09046167135239, -99.72246298193932, -99.17887502908707, -113.58994001150131, -108.83529188235602, -96.81217873593172, -98.88315381606421, -105.58825749655566, -106.70883368452391, -117.93154563506445, -105.88386198381583, -96.07263160745303, -98.62249610821407, -96.72023364901543, -107.99323806166649, -100.31207406520844, -10.274006473521396, -10.724440301458046, -10.571652809778854, -95.53826665878296, -93.29354366660118, -105.08210098743439, -114.31484085321426, -101.56791460514069, -102.64890921115875, -115.05142343044281, -103.1293837428093, -103.1371012032032, -126.00698284308116, -117.26389996210735, -114.49294976393382, -108.30293174584708, -92.11245428522429, -91.83179490019879, -96.42177454009652, -110.14569443464279, -97.06689354777336, -102.32688264052074, -114.27141890923183, -103.73918131987254, -100.00402340789637, -99.71409412225088, -113.46332492431006, -120.25120174884796, -103.74762213230133, -104.76439020037651]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15187026196239392, "mean_inference_ms": 0.6344777130592442, "mean_action_processing_ms": 0.0924427809329463, "mean_env_wait_ms": 0.7551226326408417, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 45000, "timesteps_this_iter": 0, "agent_timesteps_total": 135000, "timers": {"sample_time_ms": 9539.655, "sample_throughput": 524.128, "load_time_ms": 0.111, "load_throughput": 45013994.753, "learn_time_ms": 1492.65, "learn_throughput": 3349.746, "update_time_ms": 7.131}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0005000000000000001, "total_loss": 2818.1857666015626, "policy_loss": -0.002136186031947533, "vf_loss": 2818.2468017578126, "vf_explained_var": 0.008704787492752076, "kl": 0.003685024770676628, "entropy": 5.890309524536133, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 45000, "num_agent_steps_sampled": 135000, "num_steps_trained": 45000, "num_agent_steps_trained": 135000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 503, "training_iteration": 9, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-10-42", "timestamp": 1706227842, "time_this_iter_s": 9.537743091583252, "time_total_s": 87.1166582107544, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028457FAF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 87.1166582107544, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 7.6, "ram_util_percent": 52.37692307692306}}
{"episode_reward_max": 31.734172999858856, "episode_reward_min": -603.9578071068972, "episode_reward_mean": -300.1059803673171, "episode_len_mean": 88.46, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {"shared_policy": -212.56703114509583}, "policy_reward_max": {"shared_policy": 10.645289793610573}, "policy_reward_mean": {"shared_policy": -100.0353267891057}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-322.78341022785753, -324.95015424489975, -314.3900995142758, -311.08600510656834, -306.5667557120323, -310.6598592698574, -287.4037478491664, -46.5929898992181, -326.0739215910435, -306.43821081519127, -296.8273912742734, -303.7848661839962, -328.1472476273775, -318.1342195868492, -307.94045527279377, -331.00576081871986, -319.47448974102736, -308.46271672844887, -290.35157330334187, -291.0386581599014, -327.7296022027731, -312.45173993706703, -310.9623503014446, -295.4632345438004, -329.7095100879669, -311.18360713124275, -321.00725468993187, -314.24959018081427, -328.6664356030524, -311.7343091312796, -294.4521808363497, -312.4912780225277, -304.5306244343519, -330.228636816144, -300.5789896994829, -305.02554577589035, -31.570099584758296, -293.9139113128185, -318.5316646695137, -321.3179083764553, -357.7638325691223, -292.2471809312701, -303.6343625225127, -320.3374828696251, -313.1814424544573, -328.7632140815258, -305.2432049140334, -326.043320633471, -289.6770743727684, -278.3902624547482, -308.0451386272908, -329.3462933525443, -312.8473995625973, -305.3919859826565, -39.95935015194118, -320.9112558215857, -298.89505415037274, -318.14494644105434, -315.123930003494, -307.2961710393429, -311.39178842306137, -314.603705495596, -317.8180191665888, -314.44773706793785, -317.3280959241092, -312.87588967382914, -316.712143227458, -320.3865340352059, -603.9578071068972, -307.58817099779844, -292.56378668546677, -337.35549026727676, -315.03023926913744, -304.40244099497795, -305.6911258623004, -310.70614781975746, -323.89899419434374, -319.6535146608949, -328.38104930520063, -304.9140662327409, -303.784464597702, -275.4335398674011, -334.0933588072658, -295.79736817255616, -298.4539961563423, -293.182349268347, -310.42626678943634, -321.47230964899063, -286.2717109322548, -300.031351596117, 31.734172999858856, -313.8434632644058, -308.3612168729305, -25.1186544671655, -340.03078055381775, -326.3484956473112, -307.6897484213114, -304.8254957795143, -309.991732776165, -308.31525050103664], "episode_lengths": [45, 66, 71, 70, 62, 79, 87, 500, 59, 65, 72, 65, 80, 41, 77, 75, 52, 51, 150, 64, 53, 80, 67, 77, 67, 64, 59, 76, 61, 73, 69, 54, 65, 78, 71, 64, 500, 59, 62, 55, 62, 89, 57, 66, 39, 62, 63, 58, 48, 72, 44, 58, 63, 74, 500, 55, 50, 46, 72, 81, 80, 53, 48, 112, 55, 49, 67, 73, 65, 83, 67, 71, 75, 71, 60, 59, 50, 54, 82, 62, 65, 64, 90, 74, 57, 84, 68, 67, 75, 71, 500, 42, 75, 500, 60, 58, 107, 61, 73, 75], "policy_shared_policy_reward": [-104.4023887316386, -101.5295595691229, -116.85146192709605, -104.4831200838089, -116.26411283016205, -104.2029213309288, -99.95905843252937, -113.27093074719112, -101.16011033455531, -99.49138606091341, -111.20083781083426, -100.3937812348207, -97.00979975859325, -99.46500031153361, -110.09195564190547, -100.39831854899725, -100.24712838729224, -110.01441233356795, -92.72050733367603, -103.51578603188197, -91.16745448360841, -14.559852058688804, -14.227309587101146, -17.805828253428146, -102.75310311714809, -103.41385532418887, -119.90696314970653, -108.01260965069136, -98.13633533318838, -100.28926583131155, -94.30281018217406, -93.0077158783873, -109.51686521371207, -99.29646799961726, -96.49932513634364, -107.98907304803531, -106.97865986824036, -103.76453818380833, -117.40404957532883, -112.96734062830608, -102.26887253920238, -102.89800641934077, -100.37971629699072, -97.94533601899943, -109.61540295680365, -106.29709986845653, -118.975787738959, -105.73287321130435, -99.89910621692738, -116.09803088506064, -103.47735263903937, -98.69357549150786, -110.03075905640921, -99.73838218053183, -93.54947254061699, -104.68255639076233, -92.11954437196255, -92.1655915408628, -105.82778257131577, -93.04528404772282, -103.68651341895263, -118.95216588179271, -105.09092290202777, -101.19012788931529, -110.65052540103595, -100.6110866467158, -111.9970665772756, -100.48739685614905, -98.47788686801991, -103.70992900927862, -94.00417091449103, -97.74913462003073, -118.70214726527533, -105.01640509565672, -105.9909577270349, -110.77484399080276, -101.53893262147903, -98.86983051896095, -102.02047063906988, -101.0096937318643, -117.97709031899771, -112.70383915305138, -100.80248466134071, -100.74326636642218, -111.06995697195332, -115.46528206268947, -102.1311965684096, -97.42530548013747, -100.44199496507645, -113.86700868606567, -89.07314733043313, -104.28857183456421, -101.09046167135239, -99.72246298193932, -99.17887502908707, -113.58994001150131, -108.83529188235602, -96.81217873593172, -98.88315381606421, -105.58825749655566, -106.70883368452391, -117.93154563506445, -105.88386198381583, -96.07263160745303, -98.62249610821407, -96.72023364901543, -107.99323806166649, -100.31207406520844, -10.274006473521396, -10.724440301458046, -10.571652809778854, -95.53826665878296, -93.29354366660118, -105.08210098743439, -114.31484085321426, -101.56791460514069, -102.64890921115875, -115.05142343044281, -103.1293837428093, -103.1371012032032, -126.00698284308116, -117.26389996210735, -114.49294976393382, -108.30293174584708, -92.11245428522429, -91.83179490019879, -96.42177454009652, -110.14569443464279, -97.06689354777336, -102.32688264052074, -114.27141890923183, -103.73918131987254, -100.00402340789637, -99.71409412225088, -113.46332492431006, -120.25120174884796, -103.74762213230133, -104.76439020037651, -96.23267680654924, -98.68380163113277, -110.32672647635142, -104.02778803060453, -104.40228755275409, -117.61324505011241, -98.36284154653549, -95.82286575436592, -95.49136707186699, -88.33275716503462, -90.64731206496558, -99.41019322474799, -98.90762368341288, -111.19150223334631, -97.94601271053156, -107.22171998023987, -118.59967029094696, -103.52490308135748, -99.6609835823377, -112.61624385913214, -100.57017212112746, -97.2684991558393, -109.51087148984274, -98.61261533697447, -13.69478189945221, -12.846904514357448, -13.417663738131523, -101.7998056014379, -117.66964717706045, -101.44180304308733, -96.24145943919818, -107.55950603882472, -95.09408867234986, -101.72357160846393, -100.8290131042401, -115.59236172835033, -99.3068006100754, -112.51282844940822, -103.30430094401042, -98.33892941474915, -98.70694980025291, -110.25029182434082, -101.60999715328217, -99.0733852982521, -110.7084059715271, -99.99516197045645, -99.73774843414625, -114.87079509099325, -100.8221812794606, -102.7559624115626, -114.2398754755656, -100.65431938568751, -101.05658800403278, -112.73682967821757, -100.09992471709847, -100.15522465854883, -117.07294654846191, -113.10544820626578, -100.76237471898398, -99.00806674857935, -101.29654731353125, -100.92594254513583, -114.48965336879095, -104.4094737370809, -101.92577381928763, -114.05128647883734, -195.70323279500008, -212.56703114509583, -195.68754316680133, -99.5113563934962, -97.99923792729776, -110.0775766770045, -94.05691053469977, -105.73437776168188, -92.77249838908514, -116.25247406959534, -116.5888859629631, -104.51413023471832, -102.49582751592001, -111.27261309822401, -101.26179865499338, -97.25585477550825, -109.1433331569036, -98.00325306256613, -97.41461702436209, -109.38999411463737, -98.88651472330093, -111.59097377459209, -99.0146363178889, -100.10053772727649, -105.72576626141867, -102.48147118774554, -115.6917567451795, -114.4814365108808, -103.16729073723158, -102.00478741278252, -112.62401028474173, -108.13647209604582, -107.62056692441305, -96.79502903173368, -111.15685294071834, -96.96218426028888, -109.02404427528381, -97.20656335353851, -97.5538569688797, -89.06993532180786, -98.1354051232338, -88.22819942235947, -103.97828563799462, -114.31065533061823, -115.80441783865294, -95.50533749659857, -91.98492410158119, -108.30710657437643, -92.3539122886335, -98.72806711991629, -107.37201674779257, -106.45205352703731, -93.08271406466763, -93.6475816766421, -110.2125740547975, -99.18234770496687, -101.031345029672, -116.35598146915436, -102.39111804962158, -102.72521013021469, -93.11817047993343, -90.3495704929034, -102.80396995941798, -95.96272900700569, -97.25089967250824, -106.81772291660309, 10.645289793610573, 10.495556965470314, 10.59332624077797, -113.9702875216802, -99.56538115193447, -100.30779459079108, -109.53997838497162, -99.04903355240822, -99.77220493555069, -8.606900071104377, -8.001228255530208, -8.510526140530914, -108.56195612748465, -121.25112160046896, -110.21770282586417, -117.02653247117996, -105.73273199796677, -103.58923117816448, -94.87796118358771, -105.81111771861713, -107.00066951910655, -97.66270140806834, -110.93392292658488, -96.2288714448611, -99.56001920501392, -111.07760248581569, -99.35411108533542, -97.46602348983288, -100.50495356321335, -110.34427344799042]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15152085022500106, "mean_inference_ms": 0.6311951350615598, "mean_action_processing_ms": 0.09246287766811438, "mean_env_wait_ms": 0.7540088603382915, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 50000, "timesteps_this_iter": 0, "agent_timesteps_total": 150000, "timers": {"sample_time_ms": 9547.056, "sample_throughput": 523.722, "load_time_ms": 0.1, "load_throughput": 50015549.726, "learn_time_ms": 1491.148, "learn_throughput": 3353.122, "update_time_ms": 7.118}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005000000000000001, "total_loss": 2686.681103515625, "policy_loss": -0.002648569336761719, "vf_loss": 2686.7418212890625, "vf_explained_var": 0.008902209997177123, "kl": 0.0031182609709518323, "entropy": 5.803227949142456, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 50000, "num_agent_steps_sampled": 150000, "num_steps_trained": 50000, "num_agent_steps_trained": 150000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 557, "training_iteration": 10, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-10-51", "timestamp": 1706227851, "time_this_iter_s": 9.583836078643799, "time_total_s": 96.7004942893982, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028453C940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 96.7004942893982, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 7.671428571428571, "ram_util_percent": 52.39999999999999}}
{"episode_reward_max": 31.734172999858856, "episode_reward_min": -603.9578071068972, "episode_reward_mean": -291.88678749131736, "episode_len_mean": 98.42, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {"shared_policy": -212.56703114509583}, "policy_reward_max": {"shared_policy": 10.645289793610573}, "policy_reward_mean": {"shared_policy": -97.29559583043913}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-312.8473995625973, -305.3919859826565, -39.95935015194118, -320.9112558215857, -298.89505415037274, -318.14494644105434, -315.123930003494, -307.2961710393429, -311.39178842306137, -314.603705495596, -317.8180191665888, -314.44773706793785, -317.3280959241092, -312.87588967382914, -316.712143227458, -320.3865340352059, -603.9578071068972, -307.58817099779844, -292.56378668546677, -337.35549026727676, -315.03023926913744, -304.40244099497795, -305.6911258623004, -310.70614781975746, -323.89899419434374, -319.6535146608949, -328.38104930520063, -304.9140662327409, -303.784464597702, -275.4335398674011, -334.0933588072658, -295.79736817255616, -298.4539961563423, -293.182349268347, -310.42626678943634, -321.47230964899063, -286.2717109322548, -300.031351596117, 31.734172999858856, -313.8434632644058, -308.3612168729305, -25.1186544671655, -340.03078055381775, -326.3484956473112, -307.6897484213114, -304.8254957795143, -309.991732776165, -308.31525050103664, 10.175096370279775, -286.95756579935556, -307.7534391283989, -306.31049078702927, -328.17531687021255, -308.8311725407839, -8.029084116220503, -314.71060348302126, -318.24052464962006, -317.74341455101967, -320.5575195848942, -285.6897092908621, -304.0499174296856, -297.2345970273018, -307.4955108463764, -324.06295485794544, -333.33293160796165, -290.88345958292484, -288.1938145644963, -312.26442611962557, -306.1482373923063, -302.6913933381438, -311.55226664245134, -332.38732409477234, -314.78538861870766, -301.7921018600464, -303.5048925280571, -281.63030871748924, -309.3491366505623, -303.7208778038621, -312.6278584599495, -297.56383925676346, -305.98370403051376, -35.37493099272251, -327.45959481596947, -318.3038790822029, -297.4495424292982, -329.0708546936512, -296.2517010271549, -306.3371872603893, -299.24430516362196, -302.3200509548187, -319.1588457375765, -318.69289278960787, -5.090827964246287, -324.5405261516571, -319.147367477417, -283.7828323841095, -323.1035944521427, -316.6594403833151, -300.67063826322556, -301.92683056369424], "episode_lengths": [63, 74, 500, 55, 50, 46, 72, 81, 80, 53, 48, 112, 55, 49, 67, 73, 65, 83, 67, 71, 75, 71, 60, 59, 50, 54, 82, 62, 65, 64, 90, 74, 57, 84, 68, 67, 75, 71, 500, 42, 75, 500, 60, 58, 107, 61, 73, 75, 500, 99, 82, 41, 77, 66, 500, 57, 58, 53, 58, 67, 56, 65, 78, 165, 62, 77, 75, 98, 56, 63, 61, 83, 61, 66, 72, 86, 52, 87, 68, 75, 55, 500, 67, 67, 72, 49, 94, 87, 65, 64, 43, 66, 500, 50, 86, 60, 58, 62, 46, 44], "policy_shared_policy_reward": [-99.6609835823377, -112.61624385913214, -100.57017212112746, -97.2684991558393, -109.51087148984274, -98.61261533697447, -13.69478189945221, -12.846904514357448, -13.417663738131523, -101.7998056014379, -117.66964717706045, -101.44180304308733, -96.24145943919818, -107.55950603882472, -95.09408867234986, -101.72357160846393, -100.8290131042401, -115.59236172835033, -99.3068006100754, -112.51282844940822, -103.30430094401042, -98.33892941474915, -98.70694980025291, -110.25029182434082, -101.60999715328217, -99.0733852982521, -110.7084059715271, -99.99516197045645, -99.73774843414625, -114.87079509099325, -100.8221812794606, -102.7559624115626, -114.2398754755656, -100.65431938568751, -101.05658800403278, -112.73682967821757, -100.09992471709847, -100.15522465854883, -117.07294654846191, -113.10544820626578, -100.76237471898398, -99.00806674857935, -101.29654731353125, -100.92594254513583, -114.48965336879095, -104.4094737370809, -101.92577381928763, -114.05128647883734, -195.70323279500008, -212.56703114509583, -195.68754316680133, -99.5113563934962, -97.99923792729776, -110.0775766770045, -94.05691053469977, -105.73437776168188, -92.77249838908514, -116.25247406959534, -116.5888859629631, -104.51413023471832, -102.49582751592001, -111.27261309822401, -101.26179865499338, -97.25585477550825, -109.1433331569036, -98.00325306256613, -97.41461702436209, -109.38999411463737, -98.88651472330093, -111.59097377459209, -99.0146363178889, -100.10053772727649, -105.72576626141867, -102.48147118774554, -115.6917567451795, -114.4814365108808, -103.16729073723158, -102.00478741278252, -112.62401028474173, -108.13647209604582, -107.62056692441305, -96.79502903173368, -111.15685294071834, -96.96218426028888, -109.02404427528381, -97.20656335353851, -97.5538569688797, -89.06993532180786, -98.1354051232338, -88.22819942235947, -103.97828563799462, -114.31065533061823, -115.80441783865294, -95.50533749659857, -91.98492410158119, -108.30710657437643, -92.3539122886335, -98.72806711991629, -107.37201674779257, -106.45205352703731, -93.08271406466763, -93.6475816766421, -110.2125740547975, -99.18234770496687, -101.031345029672, -116.35598146915436, -102.39111804962158, -102.72521013021469, -93.11817047993343, -90.3495704929034, -102.80396995941798, -95.96272900700569, -97.25089967250824, -106.81772291660309, 10.645289793610573, 10.495556965470314, 10.59332624077797, -113.9702875216802, -99.56538115193447, -100.30779459079108, -109.53997838497162, -99.04903355240822, -99.77220493555069, -8.606900071104377, -8.001228255530208, -8.510526140530914, -108.56195612748465, -121.25112160046896, -110.21770282586417, -117.02653247117996, -105.73273199796677, -103.58923117816448, -94.87796118358771, -105.81111771861713, -107.00066951910655, -97.66270140806834, -110.93392292658488, -96.2288714448611, -99.56001920501392, -111.07760248581569, -99.35411108533542, -97.46602348983288, -100.50495356321335, -110.34427344799042, 3.421233264108494, 3.1846220841010364, 3.569241022070244, -92.39915881057581, -103.10869317253432, -91.4497138162454, -99.17259644468626, -98.14041208227476, -110.4404306014379, -103.31714067856471, -100.32266322771709, -102.67068688074748, -103.82542206843695, -105.05223258336386, -119.29766221841177, -110.298055768013, -98.23963715136051, -100.29347962141037, -2.512341720362514, -2.88199404378733, -2.634748352070659, -102.36572968959808, -112.77317690849304, -99.57169688493013, -102.61865157882373, -101.95979524652164, -113.6620778242747, -103.07731451590857, -101.02867232759795, -113.63742770751318, -101.72639179229736, -101.38771894574165, -117.44340884685516, -90.50417779386044, -102.78112357854843, -92.40440791845322, -97.8916340470314, -98.00737598538399, -108.1509073972702, -106.41630047559738, -95.45639047026634, -95.36190608143806, -98.46855589747429, -98.88597005605698, -110.14098489284515, -102.3824230581522, -104.9272221326828, -116.75330966711044, -107.75956890980403, -106.63008905450504, -118.9432736436526, -92.76601326465607, -93.28823600709438, -104.82921031117439, -92.80756615598997, -104.64777477582297, -90.73847363268337, -111.90562999248505, -99.6825454607606, -100.67625066637993, -97.4158246666193, -98.93763980269432, -109.7947729229927, -108.40502069393794, -98.06033046046893, -96.22604218373696, -99.17208150525889, -112.38669522603354, -99.99348991115889, -106.60448127985, -118.84188675880432, -106.94095605611801, -101.87624456485113, -100.73741035660109, -112.17173369725546, -96.05610559384029, -96.81341211001079, -108.92258415619533, -109.66291693846385, -97.28533206383388, -96.55664352575938, -90.17162877321243, -101.26064199209213, -90.19803795218468, -98.21452101071677, -96.85662736495337, -114.27798827489218, -97.36163027584553, -109.68206733465195, -96.67718019336462, -109.99666698773703, -101.38816990454993, -101.24302156766257, -95.78114787737529, -94.34976468483607, -107.43292669455211, -109.70671196778616, -98.32890366514525, -97.94808839758238, -11.69173301756382, -11.973773926496506, -11.709424048662186, -116.79768017927806, -105.143636683623, -105.51827795306842, -114.08875024318695, -102.48347824811935, -101.7316505908966, -107.22450323899588, -96.39995433886847, -93.82508485143384, -116.03478006521861, -105.55861360828082, -107.47746102015178, -94.38009070356688, -107.14677306016287, -94.7248372634252, -98.98091439406078, -97.69460994998614, -109.66166291634242, -96.34007527430853, -96.08654468258223, -106.81768520673117, -97.52292495965958, -96.93658065795898, -107.86054533720016, -114.40806899468105, -102.37021591762702, -102.38056082526843, -100.5090066192206, -102.40734088420868, -115.77654528617859, -1.8460369805494992, -1.5320279772083012, -1.712763006488487, -103.64956310391426, -116.51712721586227, -104.37383583188057, -101.31375332673392, -102.08855470021567, -115.74505945046744, -102.13056854406993, -90.96271134416263, -90.68955249587695, -114.77653686205547, -103.14475763837497, -105.1822999517123, -100.67941496272883, -101.65403830011687, -114.32598712046942, -96.53179149826369, -108.60733505090079, -95.53151171406111, -97.36431953310966, -96.33265129104257, -108.22985973954201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15101217497070474, "mean_inference_ms": 0.6293894875009436, "mean_action_processing_ms": 0.09166795913519556, "mean_env_wait_ms": 0.7539511796418928, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 55000, "timesteps_this_iter": 0, "agent_timesteps_total": 165000, "timers": {"sample_time_ms": 9682.024, "sample_throughput": 516.421, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1493.36, "learn_throughput": 3348.155, "update_time_ms": 7.108}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005000000000000001, "total_loss": 2389.1530029296873, "policy_loss": -0.002701418435474068, "vf_loss": 2389.2138427734376, "vf_explained_var": 0.00690833330154419, "kl": 0.0040054183584304955, "entropy": 5.8111243724823, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 55000, "num_agent_steps_sampled": 165000, "num_steps_trained": 55000, "num_agent_steps_trained": 165000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 609, "training_iteration": 11, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-11-01", "timestamp": 1706227861, "time_this_iter_s": 9.560872316360474, "time_total_s": 106.26136660575867, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202823BE160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 106.26136660575867, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 4.853846153846154, "ram_util_percent": 52.4076923076923}}
{"episode_reward_max": 24.697678804397583, "episode_reward_min": -606.3004482313991, "episode_reward_mean": -297.49145049344514, "episode_len_mean": 92.64, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {"shared_policy": -210.03170329332352}, "policy_reward_max": {"shared_policy": 8.323660619556904}, "policy_reward_mean": {"shared_policy": -99.16381683114838}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-318.24052464962006, -317.74341455101967, -320.5575195848942, -285.6897092908621, -304.0499174296856, -297.2345970273018, -307.4955108463764, -324.06295485794544, -333.33293160796165, -290.88345958292484, -288.1938145644963, -312.26442611962557, -306.1482373923063, -302.6913933381438, -311.55226664245134, -332.38732409477234, -314.78538861870766, -301.7921018600464, -303.5048925280571, -281.63030871748924, -309.3491366505623, -303.7208778038621, -312.6278584599495, -297.56383925676346, -305.98370403051376, -35.37493099272251, -327.45959481596947, -318.3038790822029, -297.4495424292982, -329.0708546936512, -296.2517010271549, -306.3371872603893, -299.24430516362196, -302.3200509548187, -319.1588457375765, -318.69289278960787, -5.090827964246287, -324.5405261516571, -319.147367477417, -283.7828323841095, -323.1035944521427, -316.6594403833151, -300.67063826322556, -301.92683056369424, -290.3436545729637, -330.24134296178823, -319.282185357064, -599.5924556255341, -318.0618016719818, -303.34608267620206, -307.2723875641823, -324.7451579868794, -17.64412267506124, -49.912144646048546, -337.26272171735764, -310.1947285234928, -323.1793827563524, -306.969316393137, -301.3595990333706, -318.4450796544552, -323.74936116114264, -333.86203595995903, 24.697678804397583, -284.47884553670883, -351.1883548796177, -307.390411645174, -4.039244309067755, -301.2781012505293, -319.45187598466873, -310.34763872623444, -311.9780293852091, -299.5389705002308, -299.649039387703, -289.72585072368383, -301.73066087812185, -298.135683581233, -308.93668680265546, -307.33043688535696, -291.86579990386963, -322.0935549438, -321.19331404566765, -304.19793355464935, -328.83425015211105, -282.61935225129133, -606.3004482313991, -306.04562398791313, -309.0328294467181, -312.7841968536377, -310.7237569987774, -298.716650120914, -306.60357800126076, -294.73613131046295, -305.79513174295425, -320.28862950205803, -311.07920992374426, -303.5577947497368, -312.26102724671364, -305.6763300523162, -290.57149162888527, -310.13034999370575], "episode_lengths": [58, 53, 58, 67, 56, 65, 78, 165, 62, 77, 75, 98, 56, 63, 61, 83, 61, 66, 72, 86, 52, 87, 68, 75, 55, 500, 67, 67, 72, 49, 94, 87, 65, 64, 43, 66, 500, 50, 86, 60, 58, 62, 46, 44, 61, 53, 40, 74, 77, 65, 49, 38, 500, 500, 60, 63, 70, 54, 65, 55, 54, 59, 500, 84, 113, 62, 500, 68, 49, 51, 64, 76, 65, 68, 48, 71, 70, 94, 77, 64, 64, 71, 67, 75, 64, 72, 63, 86, 56, 69, 74, 63, 57, 48, 72, 67, 80, 65, 59, 54], "policy_shared_policy_reward": [-102.61865157882373, -101.95979524652164, -113.6620778242747, -103.07731451590857, -101.02867232759795, -113.63742770751318, -101.72639179229736, -101.38771894574165, -117.44340884685516, -90.50417779386044, -102.78112357854843, -92.40440791845322, -97.8916340470314, -98.00737598538399, -108.1509073972702, -106.41630047559738, -95.45639047026634, -95.36190608143806, -98.46855589747429, -98.88597005605698, -110.14098489284515, -102.3824230581522, -104.9272221326828, -116.75330966711044, -107.75956890980403, -106.63008905450504, -118.9432736436526, -92.76601326465607, -93.28823600709438, -104.82921031117439, -92.80756615598997, -104.64777477582297, -90.73847363268337, -111.90562999248505, -99.6825454607606, -100.67625066637993, -97.4158246666193, -98.93763980269432, -109.7947729229927, -108.40502069393794, -98.06033046046893, -96.22604218373696, -99.17208150525889, -112.38669522603354, -99.99348991115889, -106.60448127985, -118.84188675880432, -106.94095605611801, -101.87624456485113, -100.73741035660109, -112.17173369725546, -96.05610559384029, -96.81341211001079, -108.92258415619533, -109.66291693846385, -97.28533206383388, -96.55664352575938, -90.17162877321243, -101.26064199209213, -90.19803795218468, -98.21452101071677, -96.85662736495337, -114.27798827489218, -97.36163027584553, -109.68206733465195, -96.67718019336462, -109.99666698773703, -101.38816990454993, -101.24302156766257, -95.78114787737529, -94.34976468483607, -107.43292669455211, -109.70671196778616, -98.32890366514525, -97.94808839758238, -11.69173301756382, -11.973773926496506, -11.709424048662186, -116.79768017927806, -105.143636683623, -105.51827795306842, -114.08875024318695, -102.48347824811935, -101.7316505908966, -107.22450323899588, -96.39995433886847, -93.82508485143384, -116.03478006521861, -105.55861360828082, -107.47746102015178, -94.38009070356688, -107.14677306016287, -94.7248372634252, -98.98091439406078, -97.69460994998614, -109.66166291634242, -96.34007527430853, -96.08654468258223, -106.81768520673117, -97.52292495965958, -96.93658065795898, -107.86054533720016, -114.40806899468105, -102.37021591762702, -102.38056082526843, -100.5090066192206, -102.40734088420868, -115.77654528617859, -1.8460369805494992, -1.5320279772083012, -1.712763006488487, -103.64956310391426, -116.51712721586227, -104.37383583188057, -101.31375332673392, -102.08855470021567, -115.74505945046744, -102.13056854406993, -90.96271134416263, -90.68955249587695, -114.77653686205547, -103.14475763837497, -105.1822999517123, -100.67941496272883, -101.65403830011687, -114.32598712046942, -96.53179149826369, -108.60733505090079, -95.53151171406111, -97.36431953310966, -96.33265129104257, -108.22985973954201, -93.6122220158577, -103.44748029112816, -93.28395226597786, -118.81492551167807, -106.02370094259581, -105.40271650751433, -101.12615642944972, -100.00476207459967, -118.15126685301463, -206.24456216891608, -196.62764688332877, -196.72024657328924, -101.98961224158606, -113.81613220771155, -102.25605722268423, -108.32774657011032, -98.85677802562714, -96.1615580804646, -98.17895138263702, -109.92214971780777, -99.17128646373749, -103.39291762312254, -116.5318229397138, -104.82041742404303, -5.9139881233374325, -5.674457023541137, -6.05567752818267, -16.446875728666782, -16.80507628619671, -16.660192631185055, -109.85675704479218, -109.51656830310822, -117.88939636945724, -99.22663380702338, -111.00996573766074, -99.95812897880873, -114.72753028074901, -101.92638086775939, -106.52547160784404, -111.0012196302414, -98.03261372447014, -97.93548303842545, -96.242715196684, -96.38887896388769, -108.72800487279892, -103.2810564438502, -100.6524482468764, -114.51157496372859, -117.00597341855368, -102.15612193321189, -104.58726580937704, -121.66057634353638, -106.93009394407272, -105.27136567234993, 8.323660619556904, 8.208069294691086, 8.165948890149593, -101.87073064843814, -91.03676466147105, -91.57135022679965, -123.44997920592627, -110.46538107593855, -117.2729945977529, -96.90124978621802, -112.76407619317374, -97.7250856657823, -1.6202363719542916, -1.4858042051394875, -0.9332037319739754, -109.01924226681392, -95.90536054472129, -96.3534984389941, -113.64808917045593, -102.94679835438728, -102.85698845982552, -111.34325693051021, -98.97727052370708, -100.02711127201717, -99.92625166972479, -112.8006519873937, -99.25112572809061, -95.0663841466109, -107.44032434622447, -97.03226200739543, -97.4115004738172, -95.73974992831549, -106.49778898557028, -104.23039384682974, -92.03193758179745, -93.46351929505667, -96.0940413698554, -108.47306603193283, -97.16355347633362, -106.74691765507063, -95.98772271474203, -95.40104321142039, -97.98953136677544, -111.9106695453326, -99.03648589054744, -110.15400137503943, -98.02263375123343, -99.15380175908408, -92.71283314625423, -93.92857716480891, -105.2243895928065, -104.44695395231247, -114.31486439704895, -103.33173659443855, -115.01021335522334, -102.74534637729327, -103.43775431315105, -100.84930649399757, -100.81159552931786, -102.53703153133392, -115.2223604520162, -105.006940027078, -108.60494967301688, -96.37722941239676, -92.99952538808188, -93.24259745081267, -196.32416396588087, -210.03170329332352, -199.94458097219467, -111.10778196652731, -97.86405219634375, -97.0737898250421, -99.15909351656835, -111.12660197416942, -98.74713395598035, -100.52921497821808, -100.13311231136322, -112.1218695640564, -100.75721740722656, -98.59709277749062, -111.36944681406021, -96.08245526750883, -95.04047588755688, -107.5937189658483, -98.65676178534827, -109.82588990529379, -98.12092631061873, -96.50846407810847, -93.48473117748897, -104.74293605486552, -98.3272743622462, -97.98497293392818, -109.48288444677989, -102.69915554920833, -101.34792704383533, -116.24154690901439, -99.7075543900331, -99.85786180694899, -111.51379372676215, -110.43554029862086, -96.97938851515453, -96.14286593596141, -100.5675623814265, -111.34757707516353, -100.34588779012363, -96.7681579614679, -109.65977631012599, -99.2483957807223, -95.94323880473773, -96.49965427319209, -98.12859855095546, -101.32389217615128, -104.33676660060883, -104.46969121694565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15036885533460087, "mean_inference_ms": 0.6290692835807771, "mean_action_processing_ms": 0.0917197547894099, "mean_env_wait_ms": 0.7540997556293365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 60000, "timesteps_this_iter": 0, "agent_timesteps_total": 180000, "timers": {"sample_time_ms": 9661.775, "sample_throughput": 517.503, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1490.624, "learn_throughput": 3354.301, "update_time_ms": 7.201}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0005000000000000001, "total_loss": 2814.697314453125, "policy_loss": -0.001965785794147834, "vf_loss": 2814.7576171875, "vf_explained_var": 0.006706684827804565, "kl": 0.002834153428559105, "entropy": 5.83603687286377, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 60000, "num_agent_steps_sampled": 180000, "num_steps_trained": 60000, "num_agent_steps_trained": 180000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 665, "training_iteration": 12, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-11-11", "timestamp": 1706227871, "time_this_iter_s": 9.810846090316772, "time_total_s": 116.07221269607544, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202822183A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 116.07221269607544, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 7.092857142857142, "ram_util_percent": 52.49285714285714}}
{"episode_reward_max": 24.697678804397583, "episode_reward_min": -606.3004482313991, "episode_reward_mean": -282.3076820722199, "episode_len_mean": 114.52, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": -210.03170329332352}, "policy_reward_max": {"shared_policy": 8.323660619556904}, "policy_reward_mean": {"shared_policy": -94.10256069073996}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-296.2517010271549, -306.3371872603893, -299.24430516362196, -302.3200509548187, -319.1588457375765, -318.69289278960787, -5.090827964246287, -324.5405261516571, -319.147367477417, -283.7828323841095, -323.1035944521427, -316.6594403833151, -300.67063826322556, -301.92683056369424, -290.3436545729637, -330.24134296178823, -319.282185357064, -599.5924556255341, -318.0618016719818, -303.34608267620206, -307.2723875641823, -324.7451579868794, -17.64412267506124, -49.912144646048546, -337.26272171735764, -310.1947285234928, -323.1793827563524, -306.969316393137, -301.3595990333706, -318.4450796544552, -323.74936116114264, -333.86203595995903, 24.697678804397583, -284.47884553670883, -351.1883548796177, -307.390411645174, -4.039244309067755, -301.2781012505293, -319.45187598466873, -310.34763872623444, -311.9780293852091, -299.5389705002308, -299.649039387703, -289.72585072368383, -301.73066087812185, -298.135683581233, -308.93668680265546, -307.33043688535696, -291.86579990386963, -322.0935549438, -321.19331404566765, -304.19793355464935, -328.83425015211105, -282.61935225129133, -606.3004482313991, -306.04562398791313, -309.0328294467181, -312.7841968536377, -310.7237569987774, -298.716650120914, -306.60357800126076, -294.73613131046295, -305.79513174295425, -320.28862950205803, -311.07920992374426, -303.5577947497368, -312.26102724671364, -305.6763300523162, -290.57149162888527, -310.13034999370575, -314.4072551801801, -298.26798117160797, -61.90013825893403, -290.06859493255615, -293.0642887353897, -297.56251887232065, -30.502138569951086, -320.76137030124664, -269.14102450013166, -304.75503885746, -320.0053748637438, -14.774669192731395, 7.316877715289564, -310.7968169897795, -310.5212308466435, 9.958060659468174, -19.623148225247874, -315.2918155491352, -332.5517751574517, -317.60995295643806, -286.7940193861723, -301.7433894574642, -310.54044987261295, -309.81962148845196, -319.71910202503204, -314.9756157696247, -301.76332396641374, -307.50178664177656, -297.95521669089794, -317.6253493130207], "episode_lengths": [94, 87, 65, 64, 43, 66, 500, 50, 86, 60, 58, 62, 46, 44, 61, 53, 40, 74, 77, 65, 49, 38, 500, 500, 60, 63, 70, 54, 65, 55, 54, 59, 500, 84, 113, 62, 500, 68, 49, 51, 64, 76, 65, 68, 48, 71, 70, 94, 77, 64, 64, 71, 67, 75, 64, 72, 63, 86, 56, 69, 74, 63, 57, 48, 72, 67, 80, 65, 59, 54, 89, 111, 500, 86, 67, 62, 500, 48, 139, 57, 48, 500, 500, 105, 97, 500, 500, 43, 64, 48, 77, 67, 58, 51, 82, 69, 66, 74, 68, 64], "policy_shared_policy_reward": [-94.38009070356688, -107.14677306016287, -94.7248372634252, -98.98091439406078, -97.69460994998614, -109.66166291634242, -96.34007527430853, -96.08654468258223, -106.81768520673117, -97.52292495965958, -96.93658065795898, -107.86054533720016, -114.40806899468105, -102.37021591762702, -102.38056082526843, -100.5090066192206, -102.40734088420868, -115.77654528617859, -1.8460369805494992, -1.5320279772083012, -1.712763006488487, -103.64956310391426, -116.51712721586227, -104.37383583188057, -101.31375332673392, -102.08855470021567, -115.74505945046744, -102.13056854406993, -90.96271134416263, -90.68955249587695, -114.77653686205547, -103.14475763837497, -105.1822999517123, -100.67941496272883, -101.65403830011687, -114.32598712046942, -96.53179149826369, -108.60733505090079, -95.53151171406111, -97.36431953310966, -96.33265129104257, -108.22985973954201, -93.6122220158577, -103.44748029112816, -93.28395226597786, -118.81492551167807, -106.02370094259581, -105.40271650751433, -101.12615642944972, -100.00476207459967, -118.15126685301463, -206.24456216891608, -196.62764688332877, -196.72024657328924, -101.98961224158606, -113.81613220771155, -102.25605722268423, -108.32774657011032, -98.85677802562714, -96.1615580804646, -98.17895138263702, -109.92214971780777, -99.17128646373749, -103.39291762312254, -116.5318229397138, -104.82041742404303, -5.9139881233374325, -5.674457023541137, -6.05567752818267, -16.446875728666782, -16.80507628619671, -16.660192631185055, -109.85675704479218, -109.51656830310822, -117.88939636945724, -99.22663380702338, -111.00996573766074, -99.95812897880873, -114.72753028074901, -101.92638086775939, -106.52547160784404, -111.0012196302414, -98.03261372447014, -97.93548303842545, -96.242715196684, -96.38887896388769, -108.72800487279892, -103.2810564438502, -100.6524482468764, -114.51157496372859, -117.00597341855368, -102.15612193321189, -104.58726580937704, -121.66057634353638, -106.93009394407272, -105.27136567234993, 8.323660619556904, 8.208069294691086, 8.165948890149593, -101.87073064843814, -91.03676466147105, -91.57135022679965, -123.44997920592627, -110.46538107593855, -117.2729945977529, -96.90124978621802, -112.76407619317374, -97.7250856657823, -1.6202363719542916, -1.4858042051394875, -0.9332037319739754, -109.01924226681392, -95.90536054472129, -96.3534984389941, -113.64808917045593, -102.94679835438728, -102.85698845982552, -111.34325693051021, -98.97727052370708, -100.02711127201717, -99.92625166972479, -112.8006519873937, -99.25112572809061, -95.0663841466109, -107.44032434622447, -97.03226200739543, -97.4115004738172, -95.73974992831549, -106.49778898557028, -104.23039384682974, -92.03193758179745, -93.46351929505667, -96.0940413698554, -108.47306603193283, -97.16355347633362, -106.74691765507063, -95.98772271474203, -95.40104321142039, -97.98953136677544, -111.9106695453326, -99.03648589054744, -110.15400137503943, -98.02263375123343, -99.15380175908408, -92.71283314625423, -93.92857716480891, -105.2243895928065, -104.44695395231247, -114.31486439704895, -103.33173659443855, -115.01021335522334, -102.74534637729327, -103.43775431315105, -100.84930649399757, -100.81159552931786, -102.53703153133392, -115.2223604520162, -105.006940027078, -108.60494967301688, -96.37722941239676, -92.99952538808188, -93.24259745081267, -196.32416396588087, -210.03170329332352, -199.94458097219467, -111.10778196652731, -97.86405219634375, -97.0737898250421, -99.15909351656835, -111.12660197416942, -98.74713395598035, -100.52921497821808, -100.13311231136322, -112.1218695640564, -100.75721740722656, -98.59709277749062, -111.36944681406021, -96.08245526750883, -95.04047588755688, -107.5937189658483, -98.65676178534827, -109.82588990529379, -98.12092631061873, -96.50846407810847, -93.48473117748897, -104.74293605486552, -98.3272743622462, -97.98497293392818, -109.48288444677989, -102.69915554920833, -101.34792704383533, -116.24154690901439, -99.7075543900331, -99.85786180694899, -111.51379372676215, -110.43554029862086, -96.97938851515453, -96.14286593596141, -100.5675623814265, -111.34757707516353, -100.34588779012363, -96.7681579614679, -109.65977631012599, -99.2483957807223, -95.94323880473773, -96.49965427319209, -98.12859855095546, -101.32389217615128, -104.33676660060883, -104.46969121694565, -101.69964629411697, -112.52512890100479, -100.18247998505831, -106.60212071736655, -95.79002531369528, -95.87583514054617, -20.664152254660927, -20.622641084094845, -20.613344920178257, -103.50922846794128, -92.19143235683441, -94.36793410778046, -95.02480564514796, -93.34997622172038, -104.68950686852138, -106.72572139898936, -94.92924861858289, -95.90754885474841, -9.905238730212062, -10.116940719385951, -10.479959120353072, -115.35125074783961, -101.96617571512859, -103.44394383827846, -86.87908043464026, -97.31389602025351, -84.94804804523787, -97.33316816886267, -97.03589179118475, -110.38597889741263, -102.19774008293948, -102.37308048208556, -115.43455429871878, -4.700867014626667, -5.032003263632461, -5.041798914472267, 2.460919613639504, 2.492665867010743, 2.3632922346393173, -98.89192883173625, -98.20211824278037, -113.70276991526286, -111.27671559651694, -99.962228735288, -99.28228651483855, 3.2245941758155823, 3.38271751254797, 3.350748971104622, -6.485792698959514, -6.579263548056289, -6.558091978232071, -113.01975945631663, -101.11972893277805, -101.15232716004054, -119.28204472859701, -106.21587466200194, -107.0538557668527, -101.10499987006187, -103.23813730478287, -113.26681578159332, -90.42483609418075, -104.58218995730083, -91.78699333469073, -107.77430999279022, -96.76822680234909, -97.2008526623249, -100.07669420043628, -110.97424120704333, -99.48951446513335, -111.537273367246, -99.17377627392611, -99.10857184727988, -102.08879498640697, -113.8803818623225, -103.7499251763026, -100.87732748190562, -101.64724172155063, -112.45104656616847, -95.93977200860779, -96.51207217077415, -109.31147978703181, -96.81057519962391, -97.79554690917334, -112.89566453297934, -94.60256591439247, -95.11816956102848, -108.23448121547699, -102.17650160193443, -113.40836226940155, -102.04048544168472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14960988003318568, "mean_inference_ms": 0.6268710235456989, "mean_action_processing_ms": 0.09133962165195142, "mean_env_wait_ms": 0.7545692855797013, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 65000, "timesteps_this_iter": 0, "agent_timesteps_total": 195000, "timers": {"sample_time_ms": 9642.477, "sample_throughput": 518.539, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1494.538, "learn_throughput": 3345.516, "update_time_ms": 7.3}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1232.8025268554688, "policy_loss": -0.0030356407050881272, "vf_loss": 1232.8606567382812, "vf_explained_var": 0.00888204574584961, "kl": 0.00452987167518789, "entropy": 5.516251182556152, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 65000, "num_agent_steps_sampled": 195000, "num_steps_trained": 65000, "num_agent_steps_trained": 195000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 695, "training_iteration": 13, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-11-20", "timestamp": 1706227880, "time_this_iter_s": 9.607988834381104, "time_total_s": 125.68020153045654, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282218310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 125.68020153045654, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 6.046153846153847, "ram_util_percent": 52.43846153846153}}
{"episode_reward_max": 9.958060659468174, "episode_reward_min": -617.5229567438364, "episode_reward_mean": -287.8421256636502, "episode_len_mean": 107.02, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {"shared_policy": -214.28700276215875}, "policy_reward_max": {"shared_policy": 3.38271751254797}, "policy_reward_mean": {"shared_policy": -95.94737522121675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-308.93668680265546, -307.33043688535696, -291.86579990386963, -322.0935549438, -321.19331404566765, -304.19793355464935, -328.83425015211105, -282.61935225129133, -606.3004482313991, -306.04562398791313, -309.0328294467181, -312.7841968536377, -310.7237569987774, -298.716650120914, -306.60357800126076, -294.73613131046295, -305.79513174295425, -320.28862950205803, -311.07920992374426, -303.5577947497368, -312.26102724671364, -305.6763300523162, -290.57149162888527, -310.13034999370575, -314.4072551801801, -298.26798117160797, -61.90013825893403, -290.06859493255615, -293.0642887353897, -297.56251887232065, -30.502138569951086, -320.76137030124664, -269.14102450013166, -304.75503885746, -320.0053748637438, -14.774669192731395, 7.316877715289564, -310.7968169897795, -310.5212308466435, 9.958060659468174, -19.623148225247874, -315.2918155491352, -332.5517751574517, -317.60995295643806, -286.7940193861723, -301.7433894574642, -310.54044987261295, -309.81962148845196, -319.71910202503204, -314.9756157696247, -301.76332396641374, -307.50178664177656, -297.95521669089794, -317.6253493130207, -12.418181784451036, -311.83829921484, -311.632876008749, -307.09892419725657, -321.80110299587255, -306.5897706449032, -305.6808853149414, -14.798614814877538, -295.2343257442117, -283.2935856990516, -332.3116408139468, -310.424202054739, -294.8970250226557, -326.30292296409607, -310.07893681898713, -321.64066559076315, -310.9173043570481, -322.5963205397129, -308.88465018570423, -36.23177029192448, -309.82868823409086, -307.6565555334091, -617.5229567438364, -262.3771227039397, -334.0374070703984, -312.26507269684225, -300.34921218454843, -322.96195924282074, -313.29006903618574, -321.0892689153552, -305.36718188226223, -297.8912847042084, -327.2896631658078, -305.3391942083836, -326.7487532198429, -292.2128663510085, -300.100860491395, -292.31850039958954, -310.014098033309, -315.30979710817337, -295.1012498140335, -307.76160031557083, -297.8695823550225, -312.9347891062498, -314.5023358613253, -293.25791420042515], "episode_lengths": [70, 94, 77, 64, 64, 71, 67, 75, 64, 72, 63, 86, 56, 69, 74, 63, 57, 48, 72, 67, 80, 65, 59, 54, 89, 111, 500, 86, 67, 62, 500, 48, 139, 57, 48, 500, 500, 105, 97, 500, 500, 43, 64, 48, 77, 67, 58, 51, 82, 69, 66, 74, 68, 64, 500, 58, 64, 57, 64, 55, 63, 500, 70, 88, 68, 55, 70, 91, 65, 61, 70, 73, 50, 500, 64, 74, 60, 85, 54, 48, 66, 50, 43, 99, 65, 66, 63, 65, 72, 63, 74, 71, 54, 65, 84, 64, 59, 74, 60, 67], "policy_shared_policy_reward": [-97.98953136677544, -111.9106695453326, -99.03648589054744, -110.15400137503943, -98.02263375123343, -99.15380175908408, -92.71283314625423, -93.92857716480891, -105.2243895928065, -104.44695395231247, -114.31486439704895, -103.33173659443855, -115.01021335522334, -102.74534637729327, -103.43775431315105, -100.84930649399757, -100.81159552931786, -102.53703153133392, -115.2223604520162, -105.006940027078, -108.60494967301688, -96.37722941239676, -92.99952538808188, -93.24259745081267, -196.32416396588087, -210.03170329332352, -199.94458097219467, -111.10778196652731, -97.86405219634375, -97.0737898250421, -99.15909351656835, -111.12660197416942, -98.74713395598035, -100.52921497821808, -100.13311231136322, -112.1218695640564, -100.75721740722656, -98.59709277749062, -111.36944681406021, -96.08245526750883, -95.04047588755688, -107.5937189658483, -98.65676178534827, -109.82588990529379, -98.12092631061873, -96.50846407810847, -93.48473117748897, -104.74293605486552, -98.3272743622462, -97.98497293392818, -109.48288444677989, -102.69915554920833, -101.34792704383533, -116.24154690901439, -99.7075543900331, -99.85786180694899, -111.51379372676215, -110.43554029862086, -96.97938851515453, -96.14286593596141, -100.5675623814265, -111.34757707516353, -100.34588779012363, -96.7681579614679, -109.65977631012599, -99.2483957807223, -95.94323880473773, -96.49965427319209, -98.12859855095546, -101.32389217615128, -104.33676660060883, -104.46969121694565, -101.69964629411697, -112.52512890100479, -100.18247998505831, -106.60212071736655, -95.79002531369528, -95.87583514054617, -20.664152254660927, -20.622641084094845, -20.613344920178257, -103.50922846794128, -92.19143235683441, -94.36793410778046, -95.02480564514796, -93.34997622172038, -104.68950686852138, -106.72572139898936, -94.92924861858289, -95.90754885474841, -9.905238730212062, -10.116940719385951, -10.479959120353072, -115.35125074783961, -101.96617571512859, -103.44394383827846, -86.87908043464026, -97.31389602025351, -84.94804804523787, -97.33316816886267, -97.03589179118475, -110.38597889741263, -102.19774008293948, -102.37308048208556, -115.43455429871878, -4.700867014626667, -5.032003263632461, -5.041798914472267, 2.460919613639504, 2.492665867010743, 2.3632922346393173, -98.89192883173625, -98.20211824278037, -113.70276991526286, -111.27671559651694, -99.962228735288, -99.28228651483855, 3.2245941758155823, 3.38271751254797, 3.350748971104622, -6.485792698959514, -6.579263548056289, -6.558091978232071, -113.01975945631663, -101.11972893277805, -101.15232716004054, -119.28204472859701, -106.21587466200194, -107.0538557668527, -101.10499987006187, -103.23813730478287, -113.26681578159332, -90.42483609418075, -104.58218995730083, -91.78699333469073, -107.77430999279022, -96.76822680234909, -97.2008526623249, -100.07669420043628, -110.97424120704333, -99.48951446513335, -111.537273367246, -99.17377627392611, -99.10857184727988, -102.08879498640697, -113.8803818623225, -103.7499251763026, -100.87732748190562, -101.64724172155063, -112.45104656616847, -95.93977200860779, -96.51207217077415, -109.31147978703181, -96.81057519962391, -97.79554690917334, -112.89566453297934, -94.60256591439247, -95.11816956102848, -108.23448121547699, -102.17650160193443, -113.40836226940155, -102.04048544168472, -4.098093894620746, -4.294364427526801, -4.025723462303489, -100.41158672173819, -111.18582363923392, -100.24088885386786, -100.99721731742224, -99.63833915193877, -110.99731953938803, -109.25070333480835, -97.11908332258463, -100.72913753986359, -103.085652222236, -115.03621615966162, -103.6792346139749, -98.22567016879718, -99.25051794449489, -109.11358253161113, -109.83208258946738, -97.95578082402548, -97.89302190144858, -5.218623747428268, -4.874176328380912, -4.705814739068359, -94.3937580883503, -94.47907204180956, -106.36149561405182, -99.00085695584616, -91.35963460927209, -92.9330941339334, -120.2777355114619, -105.48593326906364, -106.5479720334212, -101.50959932804108, -98.7887197136879, -110.12588301301003, -94.30114015936852, -107.15155214071274, -93.44433272257447, -104.53628694017729, -104.23970048626265, -117.52693553765616, -112.55133014917374, -97.90106451883912, -99.62654215097427, -104.8418724735578, -115.25212826331457, -101.54666485389075, -98.74635958687092, -112.16127304236095, -100.00967172781627, -102.65090893705687, -104.92434348662695, -115.02106811602911, -99.62592952450117, -111.46042533715567, -97.79829532404742, -11.952878385782242, -12.006719708442688, -12.272172197699547, -101.70802708466849, -98.48471458752951, -109.63594656189284, -98.35920852422714, -98.73051655292511, -110.56683045625687, -202.4157790144285, -214.28700276215875, -200.82017496724927, -83.9912641942501, -81.89515355601907, -96.4907049536705, -119.7545265754064, -107.17408280571303, -107.10879768927893, -99.41721798821042, -112.51730493704478, -100.33054977158706, -109.13024797042212, -95.83113788565001, -95.38782632847628, -113.09136937061946, -103.3584691087405, -106.5121207634608, -100.37153320014477, -99.99375832825899, -112.92477750778198, -99.3688851321737, -110.47436670462291, -111.24601707855861, -97.00617807110152, -111.9882866938909, -96.37271711726984, -92.06453945239386, -103.2412540515264, -102.58549120028815, -104.25707535942396, -117.08981426556906, -105.94277354081473, -98.37128578623137, -109.75986733039221, -97.20804109176001, -115.49714332818985, -104.97164776921272, -106.27996212244034, -106.35115053256354, -92.7819913973411, -93.0797244211038, -97.21258157491684, -95.58165328204632, -107.30662563443184, -93.24925804138184, -94.40876269340515, -104.66047966480255, -99.94249909122786, -98.58911654849848, -111.48248239358267, -111.33590103189151, -101.07356757918994, -102.90032849709193, -94.24874370296797, -95.06243144472441, -105.79007466634116, -110.16357630491257, -98.58256429433823, -99.01545971632004, -94.5105482240518, -106.62225361665091, -96.73678051431975, -107.47248399009308, -107.71559028824171, -97.74671482791504, -100.67961392303309, -112.66867776711783, -101.15404417117438, -94.33639583985011, -106.0285261074702, -92.89299225310485]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14963135435417158, "mean_inference_ms": 0.6266210726103936, "mean_action_processing_ms": 0.09128249359831649, "mean_env_wait_ms": 0.7530428262465579, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 70000, "timesteps_this_iter": 0, "agent_timesteps_total": 210000, "timers": {"sample_time_ms": 9691.78, "sample_throughput": 515.901, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1495.386, "learn_throughput": 3343.618, "update_time_ms": 7.3}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0005000000000000001, "total_loss": 2169.486181640625, "policy_loss": -0.002437833593389982, "vf_loss": 2169.5462890625, "vf_explained_var": 0.006459468603134155, "kl": 0.003138473021683566, "entropy": 5.76526951789856, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 70000, "num_agent_steps_sampled": 210000, "num_steps_trained": 70000, "num_agent_steps_trained": 210000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 741, "training_iteration": 14, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-11-30", "timestamp": 1706227890, "time_this_iter_s": 9.915997743606567, "time_total_s": 135.5961992740631, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020284575A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 135.5961992740631, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 7.757142857142857, "ram_util_percent": 52.51428571428572}}
{"episode_reward_max": 22.883093615528196, "episode_reward_min": -617.5229567438364, "episode_reward_mean": -287.89149947566216, "episode_len_mean": 101.98, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {"shared_policy": -214.28700276215875}, "policy_reward_max": {"shared_policy": 8.007166830357164}, "policy_reward_mean": {"shared_policy": -95.96383315855404}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-297.95521669089794, -317.6253493130207, -12.418181784451036, -311.83829921484, -311.632876008749, -307.09892419725657, -321.80110299587255, -306.5897706449032, -305.6808853149414, -14.798614814877538, -295.2343257442117, -283.2935856990516, -332.3116408139468, -310.424202054739, -294.8970250226557, -326.30292296409607, -310.07893681898713, -321.64066559076315, -310.9173043570481, -322.5963205397129, -308.88465018570423, -36.23177029192448, -309.82868823409086, -307.6565555334091, -617.5229567438364, -262.3771227039397, -334.0374070703984, -312.26507269684225, -300.34921218454843, -322.96195924282074, -313.29006903618574, -321.0892689153552, -305.36718188226223, -297.8912847042084, -327.2896631658078, -305.3391942083836, -326.7487532198429, -292.2128663510085, -300.100860491395, -292.31850039958954, -310.014098033309, -315.30979710817337, -295.1012498140335, -307.76160031557083, -297.8695823550225, -312.9347891062498, -314.5023358613253, -293.25791420042515, -270.35842797905207, -322.24554289877415, -309.2568460404873, -316.20725320396014, -17.135819025337724, -311.1291301138699, -312.08742095530033, -293.737211227417, -316.2777579212561, -314.59043727070093, -287.09768126904964, -304.1607979387045, -299.685564160347, -306.7505142390728, -314.93426275253296, -307.4683496952057, -306.55554544925695, -313.3314467817545, -325.0903845950961, -320.71501229703426, -324.67517763376236, -307.5908497571946, -294.25843401253223, -307.83083844184875, -3.00506331771615, -301.04922342300415, -303.59636637568474, -324.2232924103737, -308.0212492663414, -312.5345267951489, 12.167575001716614, -309.4924890883267, -314.2731411829591, -299.50547014921904, -342.1497942209244, -311.6424466893077, -320.65287920832634, -305.84719806909567, -318.6891762763262, -311.5811015702784, 4.7693121060728885, -308.6500496864319, -303.08183977007866, -315.18610905855894, -282.7465367652476, -316.3263919502497, 22.883093615528196, -316.91779834777117, -305.040509685874, -305.22717420756817, -314.84726202487946, -315.86157844960695], "episode_lengths": [68, 64, 500, 58, 64, 57, 64, 55, 63, 500, 70, 88, 68, 55, 70, 91, 65, 61, 70, 73, 50, 500, 64, 74, 60, 85, 54, 48, 66, 50, 43, 99, 65, 66, 63, 65, 72, 63, 74, 71, 54, 65, 84, 64, 59, 74, 60, 67, 106, 79, 83, 43, 500, 47, 77, 57, 46, 44, 77, 62, 57, 79, 63, 50, 78, 60, 111, 76, 63, 64, 56, 76, 500, 81, 88, 51, 63, 63, 500, 55, 74, 61, 113, 84, 49, 86, 74, 53, 500, 54, 92, 89, 72, 43, 500, 50, 61, 44, 111, 70], "policy_shared_policy_reward": [-94.60256591439247, -95.11816956102848, -108.23448121547699, -102.17650160193443, -113.40836226940155, -102.04048544168472, -4.098093894620746, -4.294364427526801, -4.025723462303489, -100.41158672173819, -111.18582363923392, -100.24088885386786, -100.99721731742224, -99.63833915193877, -110.99731953938803, -109.25070333480835, -97.11908332258463, -100.72913753986359, -103.085652222236, -115.03621615966162, -103.6792346139749, -98.22567016879718, -99.25051794449489, -109.11358253161113, -109.83208258946738, -97.95578082402548, -97.89302190144858, -5.218623747428268, -4.874176328380912, -4.705814739068359, -94.3937580883503, -94.47907204180956, -106.36149561405182, -99.00085695584616, -91.35963460927209, -92.9330941339334, -120.2777355114619, -105.48593326906364, -106.5479720334212, -101.50959932804108, -98.7887197136879, -110.12588301301003, -94.30114015936852, -107.15155214071274, -93.44433272257447, -104.53628694017729, -104.23970048626265, -117.52693553765616, -112.55133014917374, -97.90106451883912, -99.62654215097427, -104.8418724735578, -115.25212826331457, -101.54666485389075, -98.74635958687092, -112.16127304236095, -100.00967172781627, -102.65090893705687, -104.92434348662695, -115.02106811602911, -99.62592952450117, -111.46042533715567, -97.79829532404742, -11.952878385782242, -12.006719708442688, -12.272172197699547, -101.70802708466849, -98.48471458752951, -109.63594656189284, -98.35920852422714, -98.73051655292511, -110.56683045625687, -202.4157790144285, -214.28700276215875, -200.82017496724927, -83.9912641942501, -81.89515355601907, -96.4907049536705, -119.7545265754064, -107.17408280571303, -107.10879768927893, -99.41721798821042, -112.51730493704478, -100.33054977158706, -109.13024797042212, -95.83113788565001, -95.38782632847628, -113.09136937061946, -103.3584691087405, -106.5121207634608, -100.37153320014477, -99.99375832825899, -112.92477750778198, -99.3688851321737, -110.47436670462291, -111.24601707855861, -97.00617807110152, -111.9882866938909, -96.37271711726984, -92.06453945239386, -103.2412540515264, -102.58549120028815, -104.25707535942396, -117.08981426556906, -105.94277354081473, -98.37128578623137, -109.75986733039221, -97.20804109176001, -115.49714332818985, -104.97164776921272, -106.27996212244034, -106.35115053256354, -92.7819913973411, -93.0797244211038, -97.21258157491684, -95.58165328204632, -107.30662563443184, -93.24925804138184, -94.40876269340515, -104.66047966480255, -99.94249909122786, -98.58911654849848, -111.48248239358267, -111.33590103189151, -101.07356757918994, -102.90032849709193, -94.24874370296797, -95.06243144472441, -105.79007466634116, -110.16357630491257, -98.58256429433823, -99.01545971632004, -94.5105482240518, -106.62225361665091, -96.73678051431975, -107.47248399009308, -107.71559028824171, -97.74671482791504, -100.67961392303309, -112.66867776711783, -101.15404417117438, -94.33639583985011, -106.0285261074702, -92.89299225310485, -86.7365789761146, -96.72704472889504, -86.89480427404246, -102.99628999332587, -104.33153201142947, -114.91772089401881, -98.74401841064295, -110.94390179713568, -99.56892583270869, -113.53843686978023, -99.49838211752164, -103.17043421665828, -5.5703292464216645, -5.792561103900283, -5.772928675015777, -99.84143611292045, -112.57257197300594, -98.71512202794354, -97.00996726254623, -112.24527887503307, -102.83217481772105, -105.9200119972229, -94.17307287454605, -93.64412635564804, -101.52575734257698, -114.54884576797485, -100.20315481070429, -101.5014878809452, -112.79312545061111, -100.29582393914461, -91.61230612297854, -103.5931048889955, -91.89227025707564, -96.81914584338665, -98.13550674915314, -109.2061453461647, -93.97831761837006, -96.08411037921906, -109.62313616275787, -98.1272785961628, -109.54002669453621, -99.0832089483738, -100.58603678146999, -112.68162165085475, -101.66660432020824, -98.34462599953017, -97.74278538425764, -111.3809383114179, -98.12775059541067, -110.60910030206045, -97.8186945517858, -101.86816465854645, -111.63225454092026, -99.83102758228779, -103.29598721116781, -103.95421043038368, -117.84018695354462, -102.8229530553023, -115.37206862370174, -102.51999061803023, -103.44456310073535, -102.09755594531696, -119.13305858771007, -98.31045450766882, -110.71992429097494, -98.56047095855078, -93.88394171496233, -93.7652234931787, -106.60926880439123, -98.68348500132561, -99.32055196166039, -109.82680147886276, -0.7179031794269974, -0.8657581259807046, -1.421402012308448, -109.60013236602148, -95.91638322671255, -95.53270783027014, -109.87297123670578, -97.74024224281311, -95.98315289616585, -102.69735582669577, -103.71009745200476, -117.81583913167319, -97.451181522881, -111.63997753461203, -98.93009020884833, -112.31717767318091, -99.15601374705633, -101.06133537491164, 4.051267236471176, 4.188351437449455, 3.9279563277959824, -112.75982820987701, -98.9872636795044, -97.74539719894528, -99.78772250562906, -113.79285657405853, -100.69256210327148, -96.73570427298546, -95.29868661612272, -107.47107926011086, -108.38426782687506, -122.79681249459586, -110.96871389945349, -99.32605731735627, -111.39803491036098, -100.91835446159045, -102.33834332227707, -102.2873287498951, -116.02720713615417, -97.31511985262236, -109.67037995656332, -98.86169825990996, -113.00960224866867, -101.20552708208561, -104.4740469455719, -101.09438272317252, -111.61832364400229, -98.86839520310363, 1.4494641621907505, 1.5984963377316745, 1.7213516061504635, -97.55562667051952, -110.64033750693004, -100.45408550898235, -110.97071099281311, -96.25272768735886, -95.85840108990669, -99.92913903047642, -113.81041576464972, -101.44655426343283, -88.6292450365921, -101.0269898970922, -93.09030183156332, -101.40245215098064, -114.05525491635005, -100.868684882919, 7.538192383944988, 7.337734401226044, 8.007166830357164, -100.81195423255365, -115.28074709574382, -100.82509701947372, -98.21247366070747, -110.03439557552338, -96.79364044964314, -109.10036657253902, -98.69337458411853, -97.43343305091064, -100.60788178443909, -101.22512662410736, -113.01425361633301, -101.09073170026144, -101.2779593517383, -113.49288739760718]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14938973680598389, "mean_inference_ms": 0.630117957381573, "mean_action_processing_ms": 0.09225855141268431, "mean_env_wait_ms": 0.7566280722733046, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 75000, "timesteps_this_iter": 0, "agent_timesteps_total": 225000, "timers": {"sample_time_ms": 9692.347, "sample_throughput": 515.871, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1495.207, "learn_throughput": 3344.019, "update_time_ms": 7.214}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0005000000000000001, "total_loss": 2109.0232666015627, "policy_loss": -0.0028443562913313515, "vf_loss": 2109.085400390625, "vf_explained_var": 0.009789711236953736, "kl": 0.00501183812448539, "entropy": 5.931561136245728, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 75000, "num_agent_steps_sampled": 225000, "num_steps_trained": 75000, "num_agent_steps_trained": 225000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 793, "training_iteration": 15, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-11-40", "timestamp": 1706227900, "time_this_iter_s": 9.530232429504395, "time_total_s": 145.1264317035675, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282542C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 145.1264317035675, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 6.235714285714287, "ram_util_percent": 52.478571428571435}}
{"episode_reward_max": 22.883093615528196, "episode_reward_min": -386.919694557786, "episode_reward_mean": -286.92532989789265, "episode_len_mean": 106.82, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {"shared_policy": -139.4465363820394}, "policy_reward_max": {"shared_policy": 8.007166830357164}, "policy_reward_mean": {"shared_policy": -95.6417766326309}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-297.8695823550225, -312.9347891062498, -314.5023358613253, -293.25791420042515, -270.35842797905207, -322.24554289877415, -309.2568460404873, -316.20725320396014, -17.135819025337724, -311.1291301138699, -312.08742095530033, -293.737211227417, -316.2777579212561, -314.59043727070093, -287.09768126904964, -304.1607979387045, -299.685564160347, -306.7505142390728, -314.93426275253296, -307.4683496952057, -306.55554544925695, -313.3314467817545, -325.0903845950961, -320.71501229703426, -324.67517763376236, -307.5908497571946, -294.25843401253223, -307.83083844184875, -3.00506331771615, -301.04922342300415, -303.59636637568474, -324.2232924103737, -308.0212492663414, -312.5345267951489, 12.167575001716614, -309.4924890883267, -314.2731411829591, -299.50547014921904, -342.1497942209244, -311.6424466893077, -320.65287920832634, -305.84719806909567, -318.6891762763262, -311.5811015702784, 4.7693121060728885, -308.6500496864319, -303.08183977007866, -315.18610905855894, -282.7465367652476, -316.3263919502497, 22.883093615528196, -316.91779834777117, -305.040509685874, -305.22717420756817, -314.84726202487946, -315.86157844960695, -7.361503697931781, -306.4299546480179, -315.9437557756901, -331.6459234803915, -298.98464381694794, -327.3798291981221, -322.7700773179531, -386.919694557786, -314.69394394755363, -294.06571704149246, -290.18491190671926, -316.21799927949905, -107.71891895681632, -302.0954101830721, -314.77871285378933, -297.43141958117485, -324.8219650089741, -10.295896667987137, -311.1774660348892, -318.52768022567034, -345.0020980238915, -299.4347640404012, -307.997469805181, -310.99478705972433, -319.0024529993534, -317.0659982599318, -291.4955489486456, -295.89181545004254, -304.6452603638172, -308.2343931496144, -291.8627876341343, -303.9606564193964, -319.96576219797134, -299.8106841892004, -316.6090160012245, -316.8867963589728, -308.64938439428806, -327.83651176840067, -319.00114038586617, -324.71664083004, -311.76660856604576, -313.9532176852226, -306.88803943991667, -279.3517171889544], "episode_lengths": [59, 74, 60, 67, 106, 79, 83, 43, 500, 47, 77, 57, 46, 44, 77, 62, 57, 79, 63, 50, 78, 60, 111, 76, 63, 64, 56, 76, 500, 81, 88, 51, 63, 63, 500, 55, 74, 61, 113, 84, 49, 86, 74, 53, 500, 54, 92, 89, 72, 43, 500, 50, 61, 44, 111, 70, 500, 83, 72, 463, 78, 75, 66, 104, 45, 73, 74, 41, 500, 59, 62, 71, 82, 500, 67, 37, 62, 70, 95, 98, 52, 58, 69, 50, 58, 71, 84, 86, 59, 83, 67, 39, 78, 57, 68, 67, 58, 64, 59, 83], "policy_shared_policy_reward": [-94.5105482240518, -106.62225361665091, -96.73678051431975, -107.47248399009308, -107.71559028824171, -97.74671482791504, -100.67961392303309, -112.66867776711783, -101.15404417117438, -94.33639583985011, -106.0285261074702, -92.89299225310485, -86.7365789761146, -96.72704472889504, -86.89480427404246, -102.99628999332587, -104.33153201142947, -114.91772089401881, -98.74401841064295, -110.94390179713568, -99.56892583270869, -113.53843686978023, -99.49838211752164, -103.17043421665828, -5.5703292464216645, -5.792561103900283, -5.772928675015777, -99.84143611292045, -112.57257197300594, -98.71512202794354, -97.00996726254623, -112.24527887503307, -102.83217481772105, -105.9200119972229, -94.17307287454605, -93.64412635564804, -101.52575734257698, -114.54884576797485, -100.20315481070429, -101.5014878809452, -112.79312545061111, -100.29582393914461, -91.61230612297854, -103.5931048889955, -91.89227025707564, -96.81914584338665, -98.13550674915314, -109.2061453461647, -93.97831761837006, -96.08411037921906, -109.62313616275787, -98.1272785961628, -109.54002669453621, -99.0832089483738, -100.58603678146999, -112.68162165085475, -101.66660432020824, -98.34462599953017, -97.74278538425764, -111.3809383114179, -98.12775059541067, -110.60910030206045, -97.8186945517858, -101.86816465854645, -111.63225454092026, -99.83102758228779, -103.29598721116781, -103.95421043038368, -117.84018695354462, -102.8229530553023, -115.37206862370174, -102.51999061803023, -103.44456310073535, -102.09755594531696, -119.13305858771007, -98.31045450766882, -110.71992429097494, -98.56047095855078, -93.88394171496233, -93.7652234931787, -106.60926880439123, -98.68348500132561, -99.32055196166039, -109.82680147886276, -0.7179031794269974, -0.8657581259807046, -1.421402012308448, -109.60013236602148, -95.91638322671255, -95.53270783027014, -109.87297123670578, -97.74024224281311, -95.98315289616585, -102.69735582669577, -103.71009745200476, -117.81583913167319, -97.451181522881, -111.63997753461203, -98.93009020884833, -112.31717767318091, -99.15601374705633, -101.06133537491164, 4.051267236471176, 4.188351437449455, 3.9279563277959824, -112.75982820987701, -98.9872636795044, -97.74539719894528, -99.78772250562906, -113.79285657405853, -100.69256210327148, -96.73570427298546, -95.29868661612272, -107.47107926011086, -108.38426782687506, -122.79681249459586, -110.96871389945349, -99.32605731735627, -111.39803491036098, -100.91835446159045, -102.33834332227707, -102.2873287498951, -116.02720713615417, -97.31511985262236, -109.67037995656332, -98.86169825990996, -113.00960224866867, -101.20552708208561, -104.4740469455719, -101.09438272317252, -111.61832364400229, -98.86839520310363, 1.4494641621907505, 1.5984963377316745, 1.7213516061504635, -97.55562667051952, -110.64033750693004, -100.45408550898235, -110.97071099281311, -96.25272768735886, -95.85840108990669, -99.92913903047642, -113.81041576464972, -101.44655426343283, -88.6292450365921, -101.0269898970922, -93.09030183156332, -101.40245215098064, -114.05525491635005, -100.868684882919, 7.538192383944988, 7.337734401226044, 8.007166830357164, -100.81195423255365, -115.28074709574382, -100.82509701947372, -98.21247366070747, -110.03439557552338, -96.79364044964314, -109.10036657253902, -98.69337458411853, -97.43343305091064, -100.60788178443909, -101.22512662410736, -113.01425361633301, -101.09073170026144, -101.2779593517383, -113.49288739760718, -2.3605759466687886, -2.5905719051758496, -2.4103558460871426, -97.7984789609909, -110.0657389163971, -98.56573677062988, -113.41196173429489, -101.1926961839199, -101.33909785747528, -110.67773893475533, -110.564831122756, -110.40335342288017, -94.94151701529822, -107.80847956736883, -96.23464723428091, -116.96594657500586, -105.84813298781714, -104.56574963529906, -117.19474490483603, -102.72231902678809, -102.85301338632902, -118.57404493292174, -128.89911324282488, -139.4465363820394, -101.26302580535412, -112.9972078204155, -100.43371032178402, -93.29496677716574, -107.55228992303213, -93.21846034129462, -91.8256239493688, -93.15916373332342, -105.20012422402701, -104.05925993124644, -99.80711583296458, -112.35162351528804, -35.07757463802894, -36.348411490519844, -36.29293282826742, -95.9217938631773, -109.35311502218246, -96.82050129771233, -100.9943825552861, -113.34792284170787, -100.43640745679538, -94.71956103295088, -94.89634118229151, -107.81551736593246, -106.12358204523723, -115.38432500759761, -103.31405795613925, -3.4768397634228165, -3.4511827950676377, -3.3678741094966824, -111.8736162185669, -99.96918791532516, -99.33466190099716, -101.55682917684317, -101.9895138591528, -114.98133718967438, -110.5298817952474, -122.17362978061041, -112.29858644803366, -111.62481037775676, -94.47118585805099, -93.33876780459347, -99.01619134346645, -96.7766186023752, -112.2046598593394, -112.430155535539, -98.99205952634415, -99.57257199784121, -101.70548808574677, -100.81673708558083, -116.48022782802582, -102.42353374759357, -113.49059234062831, -101.15187217170994, -94.30645622809729, -104.66931947072348, -92.51977324982485, -95.87345202391347, -102.39375933011374, -97.6246040960153, -96.86196126540503, -96.90624259908995, -110.87705649932226, -98.97322913010916, -109.53693514068922, -99.72422887881598, -104.9471641679605, -93.24862356980643, -93.6669998963674, -96.32396272321543, -98.4498055179914, -109.1868881781896, -103.63282054662704, -115.03505110740662, -101.29789054393768, -95.3035191744566, -96.29205721616745, -108.21510779857635, -113.21271407604218, -102.42266941070557, -100.97363251447678, -101.3963186815381, -114.2124981880188, -101.27797948941588, -98.76423093676567, -111.86395663022995, -98.02119682729244, -104.07679665833712, -117.88818389177322, -105.87153121829033, -101.77535328269005, -103.10111331939697, -114.12467378377914, -104.73765635490417, -116.01705276966095, -103.96193170547485, -99.10861578583717, -100.14198076725006, -112.51601201295853, -100.51588663458824, -111.72027850151062, -101.71705254912376, -98.52036770184836, -110.35464670260748, -98.0130250354608, -101.43291290601096, -88.97328335543475, -88.94552092750868]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14874309481031503, "mean_inference_ms": 0.6274503375833248, "mean_action_processing_ms": 0.09219282804413353, "mean_env_wait_ms": 0.7574688376419151, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 80000, "timesteps_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"sample_time_ms": 9692.482, "sample_throughput": 515.864, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1493.74, "learn_throughput": 3347.302, "update_time_ms": 7.214}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0005000000000000001, "total_loss": 1788.8625732421874, "policy_loss": -0.002011275920402866, "vf_loss": 1788.9214721679687, "vf_explained_var": 0.010526669025421143, "kl": 0.003500225121390791, "entropy": 5.693584871292114, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 80000, "num_agent_steps_sampled": 240000, "num_steps_trained": 80000, "num_agent_steps_trained": 240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 837, "training_iteration": 16, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-11-49", "timestamp": 1706227909, "time_this_iter_s": 9.537975549697876, "time_total_s": 154.66440725326538, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020280834820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 154.66440725326538, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 6.746153846153845, "ram_util_percent": 52.51538461538462}}
{"episode_reward_max": 22.883093615528196, "episode_reward_min": -628.2052738368511, "episode_reward_mean": -285.39833942301806, "episode_len_mean": 117.55, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {"shared_policy": -215.23611891269684}, "policy_reward_max": {"shared_policy": 8.007166830357164}, "policy_reward_mean": {"shared_policy": -95.13277980767268}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.7693121060728885, -308.6500496864319, -303.08183977007866, -315.18610905855894, -282.7465367652476, -316.3263919502497, 22.883093615528196, -316.91779834777117, -305.040509685874, -305.22717420756817, -314.84726202487946, -315.86157844960695, -7.361503697931781, -306.4299546480179, -315.9437557756901, -331.6459234803915, -298.98464381694794, -327.3798291981221, -322.7700773179531, -386.919694557786, -314.69394394755363, -294.06571704149246, -290.18491190671926, -316.21799927949905, -107.71891895681632, -302.0954101830721, -314.77871285378933, -297.43141958117485, -324.8219650089741, -10.295896667987137, -311.1774660348892, -318.52768022567034, -345.0020980238915, -299.4347640404012, -307.997469805181, -310.99478705972433, -319.0024529993534, -317.0659982599318, -291.4955489486456, -295.89181545004254, -304.6452603638172, -308.2343931496144, -291.8627876341343, -303.9606564193964, -319.96576219797134, -299.8106841892004, -316.6090160012245, -316.8867963589728, -308.64938439428806, -327.83651176840067, -319.00114038586617, -324.71664083004, -311.76660856604576, -313.9532176852226, -306.88803943991667, -279.3517171889544, -311.06073861569166, -314.8346009552479, -318.84230526536703, -323.0396140217781, -319.51298524439335, -328.42005406320095, -18.93763581663373, -316.4518796205521, -289.3744398057461, -628.2052738368511, -319.0865824148059, -279.55879753828054, -306.06203013658524, -311.8334315419197, -311.8310294672847, -320.7545671202243, -16.680988006293774, -314.7642594203353, -304.4074305295944, -311.9229853153229, -302.33535124361515, -305.1587700396776, -288.8792941123247, -313.3192248344422, 9.482196047902107, -306.83621234446764, -282.2533427402377, -12.786373630166082, -317.4116055220366, -299.83482423424726, -319.8700148649514, -333.851630717516, -304.8220546543598, -324.2692410722375, -339.2837383747101, -316.8818572796881, -300.8342771306634, -295.46429063379765, -319.71646620333195, -320.738133341074, -314.4057476595044, -325.2057358920574, -341.0472315400839, -1.8272719830274582], "episode_lengths": [500, 54, 92, 89, 72, 43, 500, 50, 61, 44, 111, 70, 500, 83, 72, 463, 78, 75, 66, 104, 45, 73, 74, 41, 500, 59, 62, 71, 82, 500, 67, 37, 62, 70, 95, 98, 52, 58, 69, 50, 58, 71, 84, 86, 59, 83, 67, 39, 78, 57, 68, 67, 58, 64, 59, 83, 90, 85, 46, 76, 46, 111, 500, 65, 167, 83, 57, 79, 66, 75, 98, 65, 500, 74, 55, 60, 72, 59, 105, 56, 500, 59, 94, 500, 77, 60, 98, 86, 67, 75, 82, 43, 47, 67, 79, 56, 42, 93, 67, 500], "policy_shared_policy_reward": [1.4494641621907505, 1.5984963377316745, 1.7213516061504635, -97.55562667051952, -110.64033750693004, -100.45408550898235, -110.97071099281311, -96.25272768735886, -95.85840108990669, -99.92913903047642, -113.81041576464972, -101.44655426343283, -88.6292450365921, -101.0269898970922, -93.09030183156332, -101.40245215098064, -114.05525491635005, -100.868684882919, 7.538192383944988, 7.337734401226044, 8.007166830357164, -100.81195423255365, -115.28074709574382, -100.82509701947372, -98.21247366070747, -110.03439557552338, -96.79364044964314, -109.10036657253902, -98.69337458411853, -97.43343305091064, -100.60788178443909, -101.22512662410736, -113.01425361633301, -101.09073170026144, -101.2779593517383, -113.49288739760718, -2.3605759466687886, -2.5905719051758496, -2.4103558460871426, -97.7984789609909, -110.0657389163971, -98.56573677062988, -113.41196173429489, -101.1926961839199, -101.33909785747528, -110.67773893475533, -110.564831122756, -110.40335342288017, -94.94151701529822, -107.80847956736883, -96.23464723428091, -116.96594657500586, -105.84813298781714, -104.56574963529906, -117.19474490483603, -102.72231902678809, -102.85301338632902, -118.57404493292174, -128.89911324282488, -139.4465363820394, -101.26302580535412, -112.9972078204155, -100.43371032178402, -93.29496677716574, -107.55228992303213, -93.21846034129462, -91.8256239493688, -93.15916373332342, -105.20012422402701, -104.05925993124644, -99.80711583296458, -112.35162351528804, -35.07757463802894, -36.348411490519844, -36.29293282826742, -95.9217938631773, -109.35311502218246, -96.82050129771233, -100.9943825552861, -113.34792284170787, -100.43640745679538, -94.71956103295088, -94.89634118229151, -107.81551736593246, -106.12358204523723, -115.38432500759761, -103.31405795613925, -3.4768397634228165, -3.4511827950676377, -3.3678741094966824, -111.8736162185669, -99.96918791532516, -99.33466190099716, -101.55682917684317, -101.9895138591528, -114.98133718967438, -110.5298817952474, -122.17362978061041, -112.29858644803366, -111.62481037775676, -94.47118585805099, -93.33876780459347, -99.01619134346645, -96.7766186023752, -112.2046598593394, -112.430155535539, -98.99205952634415, -99.57257199784121, -101.70548808574677, -100.81673708558083, -116.48022782802582, -102.42353374759357, -113.49059234062831, -101.15187217170994, -94.30645622809729, -104.66931947072348, -92.51977324982485, -95.87345202391347, -102.39375933011374, -97.6246040960153, -96.86196126540503, -96.90624259908995, -110.87705649932226, -98.97322913010916, -109.53693514068922, -99.72422887881598, -104.9471641679605, -93.24862356980643, -93.6669998963674, -96.32396272321543, -98.4498055179914, -109.1868881781896, -103.63282054662704, -115.03505110740662, -101.29789054393768, -95.3035191744566, -96.29205721616745, -108.21510779857635, -113.21271407604218, -102.42266941070557, -100.97363251447678, -101.3963186815381, -114.2124981880188, -101.27797948941588, -98.76423093676567, -111.86395663022995, -98.02119682729244, -104.07679665833712, -117.88818389177322, -105.87153121829033, -101.77535328269005, -103.10111331939697, -114.12467378377914, -104.73765635490417, -116.01705276966095, -103.96193170547485, -99.10861578583717, -100.14198076725006, -112.51601201295853, -100.51588663458824, -111.72027850151062, -101.71705254912376, -98.52036770184836, -110.35464670260748, -98.0130250354608, -101.43291290601096, -88.97328335543475, -88.94552092750868, -99.06552294145028, -100.03600535790126, -111.95921031634013, -114.57305574417114, -100.76180198788643, -99.49974322319031, -101.58115397642057, -102.46087878445785, -114.80027250448863, -115.58908335367839, -103.23560885588329, -104.21492181221645, -101.36501629153888, -116.78768042723338, -101.3602885256211, -105.07560028632483, -118.59742863972983, -104.74702513714632, -6.6689408024152215, -6.288757679363101, -5.979937334855407, -103.17110027869543, -101.75571735699972, -111.52506198485693, -92.86882661779723, -104.1773576339086, -92.32825555404028, -211.69425669312477, -215.23611891269684, -201.2748982310295, -101.82738720625639, -102.01289105415344, -115.24630415439606, -91.2693948869904, -91.6711535130938, -96.61824913819632, -109.4863583445549, -97.70641642808914, -98.86925536394119, -112.88900101184845, -99.9872542321682, -98.95717629790306, -112.15877920389175, -100.19707299768925, -99.47517726570368, -103.16637121637663, -115.76599486668906, -101.82220103715858, -5.457856819033623, -5.486364267766476, -5.736766919493675, -100.19898440688848, -114.06450271606445, -100.50077229738235, -97.43200285236041, -110.2316927711169, -96.74373490611713, -100.15654727816582, -111.26257210969925, -100.50386592745781, -95.27209728459518, -109.65492091576259, -97.4083330432574, -97.05436948438486, -109.37038238843283, -98.73401816685995, -107.65603431065878, -90.68276502688727, -90.5404947747787, -99.90576087435088, -99.25588219364485, -114.15758176644644, 3.2021482288837433, 3.4121203422546387, 2.8679274767637253, -97.32683400064707, -110.02844697237015, -99.48093137145042, -89.42567490786314, -89.88517355918884, -102.94249427318573, -4.188734834392875, -4.196570013960212, -4.401068781812995, -100.88073838253817, -113.9406558473905, -102.59021129210791, -107.38282676537833, -96.09111558397612, -96.36088188489279, -103.02981016039848, -101.51854513958097, -115.32165956497192, -107.2260646124681, -119.67537697156271, -106.95018913348517, -97.64016345143318, -109.15910422801971, -98.02278697490692, -102.81783095747232, -105.24229127168655, -116.20911884307861, -109.06552044550578, -120.595421175162, -109.62279675404231, -101.91469752788544, -114.57696104049683, -100.39019871130586, -100.53917849063873, -102.72847735881805, -97.56662128120661, -107.4563117424647, -94.35261429349582, -93.65536459783713, -102.47311007976532, -100.92966188490391, -116.31369423866272, -101.58756658434868, -103.93281549215317, -115.21775126457214, -100.75157678623995, -100.0488169019421, -113.60535397132239, -104.95730897784233, -105.43820163607597, -114.81022527813911, -108.84287771582603, -122.62200516462326, -109.58234865963459, -0.44160182029008865, -0.835694432258606, -0.5499757304787636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1483143908482887, "mean_inference_ms": 0.6234863108001089, "mean_action_processing_ms": 0.09115648767850835, "mean_env_wait_ms": 0.7556741432822202, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 85000, "timesteps_this_iter": 0, "agent_timesteps_total": 255000, "timers": {"sample_time_ms": 9643.708, "sample_throughput": 518.473, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1493.569, "learn_throughput": 3347.685, "update_time_ms": 7.215}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0005000000000000001, "total_loss": 1945.75830078125, "policy_loss": -0.0022030049601228898, "vf_loss": 1945.8175659179688, "vf_explained_var": 0.008069366216659546, "kl": 0.003470433232726426, "entropy": 5.705321979522705, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 85000, "num_agent_steps_sampled": 255000, "num_steps_trained": 85000, "num_agent_steps_trained": 255000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 881, "training_iteration": 17, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-11-59", "timestamp": 1706227919, "time_this_iter_s": 9.549856185913086, "time_total_s": 164.21426343917847, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824A3AF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 164.21426343917847, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 5.935714285714286, "ram_util_percent": 52.48571428571428}}
{"episode_reward_max": 9.482196047902107, "episode_reward_min": -628.2052738368511, "episode_reward_mean": -284.9682769595901, "episode_len_mean": 117.06, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {"shared_policy": -215.23611891269684}, "policy_reward_max": {"shared_policy": 3.4121203422546387}, "policy_reward_mean": {"shared_policy": -94.98942565319672}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-297.43141958117485, -324.8219650089741, -10.295896667987137, -311.1774660348892, -318.52768022567034, -345.0020980238915, -299.4347640404012, -307.997469805181, -310.99478705972433, -319.0024529993534, -317.0659982599318, -291.4955489486456, -295.89181545004254, -304.6452603638172, -308.2343931496144, -291.8627876341343, -303.9606564193964, -319.96576219797134, -299.8106841892004, -316.6090160012245, -316.8867963589728, -308.64938439428806, -327.83651176840067, -319.00114038586617, -324.71664083004, -311.76660856604576, -313.9532176852226, -306.88803943991667, -279.3517171889544, -311.06073861569166, -314.8346009552479, -318.84230526536703, -323.0396140217781, -319.51298524439335, -328.42005406320095, -18.93763581663373, -316.4518796205521, -289.3744398057461, -628.2052738368511, -319.0865824148059, -279.55879753828054, -306.06203013658524, -311.8334315419197, -311.8310294672847, -320.7545671202243, -16.680988006293774, -314.7642594203353, -304.4074305295944, -311.9229853153229, -302.33535124361515, -305.1587700396776, -288.8792941123247, -313.3192248344422, 9.482196047902107, -306.83621234446764, -282.2533427402377, -12.786373630166082, -317.4116055220366, -299.83482423424726, -319.8700148649514, -333.851630717516, -304.8220546543598, -324.2692410722375, -339.2837383747101, -316.8818572796881, -300.8342771306634, -295.46429063379765, -319.71646620333195, -320.738133341074, -314.4057476595044, -325.2057358920574, -341.0472315400839, -1.8272719830274582, -318.4588581621647, -300.65248879790306, -325.2745449244976, -316.54669431131333, -9.785042285919204, -38.90517810732129, -308.3773663043976, -286.8835301846266, -296.1204062998295, -295.164927393198, -314.3758690059185, -311.42101067304617, -327.5547270178795, -325.59665936231613, 9.044221326708794, -340.9077661633492, -287.5477574765682, -293.7458782456815, -288.37920677661896, -299.430948369205, -322.9150387644768, -324.2135187536478, -338.9790347889066, -324.2072729244828, -347.038438513875, -299.60076216980815, -17.37889009341599], "episode_lengths": [71, 82, 500, 67, 37, 62, 70, 95, 98, 52, 58, 69, 50, 58, 71, 84, 86, 59, 83, 67, 39, 78, 57, 68, 67, 58, 64, 59, 83, 90, 85, 46, 76, 46, 111, 500, 65, 167, 83, 57, 79, 66, 75, 98, 65, 500, 74, 55, 60, 72, 59, 105, 56, 500, 59, 94, 500, 77, 60, 98, 86, 67, 75, 82, 43, 47, 67, 79, 56, 42, 93, 67, 500, 137, 90, 52, 54, 500, 500, 43, 99, 64, 140, 85, 75, 71, 90, 500, 104, 80, 178, 71, 59, 60, 49, 75, 68, 101, 87, 500], "policy_shared_policy_reward": [-94.71956103295088, -94.89634118229151, -107.81551736593246, -106.12358204523723, -115.38432500759761, -103.31405795613925, -3.4768397634228165, -3.4511827950676377, -3.3678741094966824, -111.8736162185669, -99.96918791532516, -99.33466190099716, -101.55682917684317, -101.9895138591528, -114.98133718967438, -110.5298817952474, -122.17362978061041, -112.29858644803366, -111.62481037775676, -94.47118585805099, -93.33876780459347, -99.01619134346645, -96.7766186023752, -112.2046598593394, -112.430155535539, -98.99205952634415, -99.57257199784121, -101.70548808574677, -100.81673708558083, -116.48022782802582, -102.42353374759357, -113.49059234062831, -101.15187217170994, -94.30645622809729, -104.66931947072348, -92.51977324982485, -95.87345202391347, -102.39375933011374, -97.6246040960153, -96.86196126540503, -96.90624259908995, -110.87705649932226, -98.97322913010916, -109.53693514068922, -99.72422887881598, -104.9471641679605, -93.24862356980643, -93.6669998963674, -96.32396272321543, -98.4498055179914, -109.1868881781896, -103.63282054662704, -115.03505110740662, -101.29789054393768, -95.3035191744566, -96.29205721616745, -108.21510779857635, -113.21271407604218, -102.42266941070557, -100.97363251447678, -101.3963186815381, -114.2124981880188, -101.27797948941588, -98.76423093676567, -111.86395663022995, -98.02119682729244, -104.07679665833712, -117.88818389177322, -105.87153121829033, -101.77535328269005, -103.10111331939697, -114.12467378377914, -104.73765635490417, -116.01705276966095, -103.96193170547485, -99.10861578583717, -100.14198076725006, -112.51601201295853, -100.51588663458824, -111.72027850151062, -101.71705254912376, -98.52036770184836, -110.35464670260748, -98.0130250354608, -101.43291290601096, -88.97328335543475, -88.94552092750868, -99.06552294145028, -100.03600535790126, -111.95921031634013, -114.57305574417114, -100.76180198788643, -99.49974322319031, -101.58115397642057, -102.46087878445785, -114.80027250448863, -115.58908335367839, -103.23560885588329, -104.21492181221645, -101.36501629153888, -116.78768042723338, -101.3602885256211, -105.07560028632483, -118.59742863972983, -104.74702513714632, -6.6689408024152215, -6.288757679363101, -5.979937334855407, -103.17110027869543, -101.75571735699972, -111.52506198485693, -92.86882661779723, -104.1773576339086, -92.32825555404028, -211.69425669312477, -215.23611891269684, -201.2748982310295, -101.82738720625639, -102.01289105415344, -115.24630415439606, -91.2693948869904, -91.6711535130938, -96.61824913819632, -109.4863583445549, -97.70641642808914, -98.86925536394119, -112.88900101184845, -99.9872542321682, -98.95717629790306, -112.15877920389175, -100.19707299768925, -99.47517726570368, -103.16637121637663, -115.76599486668906, -101.82220103715858, -5.457856819033623, -5.486364267766476, -5.736766919493675, -100.19898440688848, -114.06450271606445, -100.50077229738235, -97.43200285236041, -110.2316927711169, -96.74373490611713, -100.15654727816582, -111.26257210969925, -100.50386592745781, -95.27209728459518, -109.65492091576259, -97.4083330432574, -97.05436948438486, -109.37038238843283, -98.73401816685995, -107.65603431065878, -90.68276502688727, -90.5404947747787, -99.90576087435088, -99.25588219364485, -114.15758176644644, 3.2021482288837433, 3.4121203422546387, 2.8679274767637253, -97.32683400064707, -110.02844697237015, -99.48093137145042, -89.42567490786314, -89.88517355918884, -102.94249427318573, -4.188734834392875, -4.196570013960212, -4.401068781812995, -100.88073838253817, -113.9406558473905, -102.59021129210791, -107.38282676537833, -96.09111558397612, -96.36088188489279, -103.02981016039848, -101.51854513958097, -115.32165956497192, -107.2260646124681, -119.67537697156271, -106.95018913348517, -97.64016345143318, -109.15910422801971, -98.02278697490692, -102.81783095747232, -105.24229127168655, -116.20911884307861, -109.06552044550578, -120.595421175162, -109.62279675404231, -101.91469752788544, -114.57696104049683, -100.39019871130586, -100.53917849063873, -102.72847735881805, -97.56662128120661, -107.4563117424647, -94.35261429349582, -93.65536459783713, -102.47311007976532, -100.92966188490391, -116.31369423866272, -101.58756658434868, -103.93281549215317, -115.21775126457214, -100.75157678623995, -100.0488169019421, -113.60535397132239, -104.95730897784233, -105.43820163607597, -114.81022527813911, -108.84287771582603, -122.62200516462326, -109.58234865963459, -0.44160182029008865, -0.835694432258606, -0.5499757304787636, -115.23150300979614, -101.66359668970108, -101.56375846266747, -108.48220403989157, -95.80067943533263, -96.3696053226789, -104.81355939308803, -103.61568708221118, -116.84529844919841, -115.87741641203563, -100.63017194966476, -100.03910594961296, -3.3320107037822453, -3.336913111309215, -3.116118470827743, -12.876725104947894, -13.010139932235091, -13.018313070138305, -97.95443105697632, -98.62637895345688, -111.79655629396439, -92.4268327454726, -102.09729840854804, -92.35939903060596, -94.80571445822716, -94.83455818891525, -106.48013365268707, -94.43558608492216, -106.0797526439031, -94.64958866437277, -100.29903162519138, -114.10190645853679, -99.97493092219035, -107.59664233525595, -103.83497532208762, -99.98939301570257, -114.57504117488861, -105.8046048283577, -107.17508101463318, -105.14723262190819, -103.2530810534954, -117.19634568691254, 3.1499065905809402, 3.0780367255210876, 2.8162780106067657, -121.91013761361441, -109.31710251172385, -109.68052603801092, -91.06466010212898, -103.35669159889221, -93.12640577554703, -106.04458183050156, -94.03838604688644, -93.66291036829352, -92.3420420686404, -103.62312112251918, -92.4140435854594, -109.64240860939026, -95.52019533514977, -94.26834442466497, -100.82895378271739, -116.90738658110301, -105.17869840065639, -103.34734480579695, -117.33225490649542, -103.53391904135546, -106.05545326819023, -109.26362808545431, -123.65995343526205, -104.56365860501926, -116.69692925612132, -102.94668506334226, -111.09412232041359, -124.78863054513931, -111.1556856483221, -98.11765533685684, -94.13245747610927, -107.35064935684204, -5.413052647064134, -5.4419866974155156, -6.52385074893634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1479829609553935, "mean_inference_ms": 0.6235900461403167, "mean_action_processing_ms": 0.09059668680289422, "mean_env_wait_ms": 0.7559847074593613, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 90000, "timesteps_this_iter": 0, "agent_timesteps_total": 270000, "timers": {"sample_time_ms": 9679.67, "sample_throughput": 516.547, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1492.728, "learn_throughput": 3349.572, "update_time_ms": 7.114}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0005000000000000001, "total_loss": 1101.6201171875, "policy_loss": -0.002159558442596654, "vf_loss": 1101.676611328125, "vf_explained_var": 0.01183016300201416, "kl": 0.0030767871707240314, "entropy": 5.433648920059204, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 90000, "num_agent_steps_sampled": 270000, "num_steps_trained": 90000, "num_agent_steps_trained": 270000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 908, "training_iteration": 18, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-12-09", "timestamp": 1706227929, "time_this_iter_s": 9.88451600074768, "time_total_s": 174.09877943992615, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824928B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 174.09877943992615, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 6.514285714285713, "ram_util_percent": 52.55714285714287}}
{"episode_reward_max": 9.482196047902107, "episode_reward_min": -628.2052738368511, "episode_reward_mean": -267.11499088666403, "episode_len_mean": 143.14, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {"shared_policy": -215.23611891269684}, "policy_reward_max": {"shared_policy": 3.4121203422546387}, "policy_reward_mean": {"shared_policy": -89.03833029555467}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-316.6090160012245, -316.8867963589728, -308.64938439428806, -327.83651176840067, -319.00114038586617, -324.71664083004, -311.76660856604576, -313.9532176852226, -306.88803943991667, -279.3517171889544, -311.06073861569166, -314.8346009552479, -318.84230526536703, -323.0396140217781, -319.51298524439335, -328.42005406320095, -18.93763581663373, -316.4518796205521, -289.3744398057461, -628.2052738368511, -319.0865824148059, -279.55879753828054, -306.06203013658524, -311.8334315419197, -311.8310294672847, -320.7545671202243, -16.680988006293774, -314.7642594203353, -304.4074305295944, -311.9229853153229, -302.33535124361515, -305.1587700396776, -288.8792941123247, -313.3192248344422, 9.482196047902107, -306.83621234446764, -282.2533427402377, -12.786373630166082, -317.4116055220366, -299.83482423424726, -319.8700148649514, -333.851630717516, -304.8220546543598, -324.2692410722375, -339.2837383747101, -316.8818572796881, -300.8342771306634, -295.46429063379765, -319.71646620333195, -320.738133341074, -314.4057476595044, -325.2057358920574, -341.0472315400839, -1.8272719830274582, -318.4588581621647, -300.65248879790306, -325.2745449244976, -316.54669431131333, -9.785042285919204, -38.90517810732129, -308.3773663043976, -286.8835301846266, -296.1204062998295, -295.164927393198, -314.3758690059185, -311.42101067304617, -327.5547270178795, -325.59665936231613, 9.044221326708794, -340.9077661633492, -287.5477574765682, -293.7458782456815, -288.37920677661896, -299.430948369205, -322.9150387644768, -324.2135187536478, -338.9790347889066, -324.2072729244828, -347.038438513875, -299.60076216980815, -17.37889009341599, 3.899302005767794, -311.2771198824048, -311.2520981132984, -26.35461271554233, -315.1797680556774, -305.6150645315647, -307.6963201984763, -16.8914052397013, -26.9808952584863, -319.6340034008026, -19.627472676336794, -289.1484929919243, -275.63460059463983, -5.316968634724645, -329.22042784839874, -310.91971465945244, -309.29544855654245, -292.82132518291473, -23.323862232267885], "episode_lengths": [67, 39, 78, 57, 68, 67, 58, 64, 59, 83, 90, 85, 46, 76, 46, 111, 500, 65, 167, 83, 57, 79, 66, 75, 98, 65, 500, 74, 55, 60, 72, 59, 105, 56, 500, 59, 94, 500, 77, 60, 98, 86, 67, 75, 82, 43, 47, 67, 79, 56, 42, 93, 67, 500, 137, 90, 52, 54, 500, 500, 43, 99, 64, 140, 85, 75, 71, 90, 500, 104, 80, 178, 71, 59, 60, 49, 75, 68, 101, 87, 500, 500, 70, 61, 500, 59, 66, 46, 500, 500, 78, 500, 97, 88, 500, 44, 74, 65, 112, 500], "policy_shared_policy_reward": [-113.21271407604218, -102.42266941070557, -100.97363251447678, -101.3963186815381, -114.2124981880188, -101.27797948941588, -98.76423093676567, -111.86395663022995, -98.02119682729244, -104.07679665833712, -117.88818389177322, -105.87153121829033, -101.77535328269005, -103.10111331939697, -114.12467378377914, -104.73765635490417, -116.01705276966095, -103.96193170547485, -99.10861578583717, -100.14198076725006, -112.51601201295853, -100.51588663458824, -111.72027850151062, -101.71705254912376, -98.52036770184836, -110.35464670260748, -98.0130250354608, -101.43291290601096, -88.97328335543475, -88.94552092750868, -99.06552294145028, -100.03600535790126, -111.95921031634013, -114.57305574417114, -100.76180198788643, -99.49974322319031, -101.58115397642057, -102.46087878445785, -114.80027250448863, -115.58908335367839, -103.23560885588329, -104.21492181221645, -101.36501629153888, -116.78768042723338, -101.3602885256211, -105.07560028632483, -118.59742863972983, -104.74702513714632, -6.6689408024152215, -6.288757679363101, -5.979937334855407, -103.17110027869543, -101.75571735699972, -111.52506198485693, -92.86882661779723, -104.1773576339086, -92.32825555404028, -211.69425669312477, -215.23611891269684, -201.2748982310295, -101.82738720625639, -102.01289105415344, -115.24630415439606, -91.2693948869904, -91.6711535130938, -96.61824913819632, -109.4863583445549, -97.70641642808914, -98.86925536394119, -112.88900101184845, -99.9872542321682, -98.95717629790306, -112.15877920389175, -100.19707299768925, -99.47517726570368, -103.16637121637663, -115.76599486668906, -101.82220103715858, -5.457856819033623, -5.486364267766476, -5.736766919493675, -100.19898440688848, -114.06450271606445, -100.50077229738235, -97.43200285236041, -110.2316927711169, -96.74373490611713, -100.15654727816582, -111.26257210969925, -100.50386592745781, -95.27209728459518, -109.65492091576259, -97.4083330432574, -97.05436948438486, -109.37038238843283, -98.73401816685995, -107.65603431065878, -90.68276502688727, -90.5404947747787, -99.90576087435088, -99.25588219364485, -114.15758176644644, 3.2021482288837433, 3.4121203422546387, 2.8679274767637253, -97.32683400064707, -110.02844697237015, -99.48093137145042, -89.42567490786314, -89.88517355918884, -102.94249427318573, -4.188734834392875, -4.196570013960212, -4.401068781812995, -100.88073838253817, -113.9406558473905, -102.59021129210791, -107.38282676537833, -96.09111558397612, -96.36088188489279, -103.02981016039848, -101.51854513958097, -115.32165956497192, -107.2260646124681, -119.67537697156271, -106.95018913348517, -97.64016345143318, -109.15910422801971, -98.02278697490692, -102.81783095747232, -105.24229127168655, -116.20911884307861, -109.06552044550578, -120.595421175162, -109.62279675404231, -101.91469752788544, -114.57696104049683, -100.39019871130586, -100.53917849063873, -102.72847735881805, -97.56662128120661, -107.4563117424647, -94.35261429349582, -93.65536459783713, -102.47311007976532, -100.92966188490391, -116.31369423866272, -101.58756658434868, -103.93281549215317, -115.21775126457214, -100.75157678623995, -100.0488169019421, -113.60535397132239, -104.95730897784233, -105.43820163607597, -114.81022527813911, -108.84287771582603, -122.62200516462326, -109.58234865963459, -0.44160182029008865, -0.835694432258606, -0.5499757304787636, -115.23150300979614, -101.66359668970108, -101.56375846266747, -108.48220403989157, -95.80067943533263, -96.3696053226789, -104.81355939308803, -103.61568708221118, -116.84529844919841, -115.87741641203563, -100.63017194966476, -100.03910594961296, -3.3320107037822453, -3.336913111309215, -3.116118470827743, -12.876725104947894, -13.010139932235091, -13.018313070138305, -97.95443105697632, -98.62637895345688, -111.79655629396439, -92.4268327454726, -102.09729840854804, -92.35939903060596, -94.80571445822716, -94.83455818891525, -106.48013365268707, -94.43558608492216, -106.0797526439031, -94.64958866437277, -100.29903162519138, -114.10190645853679, -99.97493092219035, -107.59664233525595, -103.83497532208762, -99.98939301570257, -114.57504117488861, -105.8046048283577, -107.17508101463318, -105.14723262190819, -103.2530810534954, -117.19634568691254, 3.1499065905809402, 3.0780367255210876, 2.8162780106067657, -121.91013761361441, -109.31710251172385, -109.68052603801092, -91.06466010212898, -103.35669159889221, -93.12640577554703, -106.04458183050156, -94.03838604688644, -93.66291036829352, -92.3420420686404, -103.62312112251918, -92.4140435854594, -109.64240860939026, -95.52019533514977, -94.26834442466497, -100.82895378271739, -116.90738658110301, -105.17869840065639, -103.34734480579695, -117.33225490649542, -103.53391904135546, -106.05545326819023, -109.26362808545431, -123.65995343526205, -104.56365860501926, -116.69692925612132, -102.94668506334226, -111.09412232041359, -124.78863054513931, -111.1556856483221, -98.11765533685684, -94.13245747610927, -107.35064935684204, -5.413052647064134, -5.4419866974155156, -6.52385074893634, 1.5431690613428657, 1.328147764007241, 1.0279851804176872, -105.3903116385142, -100.32659892986219, -105.56020931402843, -101.35897652308147, -98.12744916478793, -111.76567242542903, -8.62273432562749, -9.037149066726371, -8.694729323188469, -100.42244764665763, -100.38549813131492, -114.37182227770488, -98.74179895718893, -97.26610105236372, -109.60716452201208, -98.49589636176825, -98.6787129342556, -110.52171090245247, -5.450853665669769, -5.604651903112739, -5.835899670918792, -8.992061307032913, -8.967138183613628, -9.02169576783976, -101.83009825150172, -102.80604056517284, -114.99786458412807, -6.410113160808891, -6.524390873809665, -6.692968641718238, -92.9525158405304, -92.56406164169312, -103.63191550970078, -87.63417777915797, -99.1977964838346, -88.80262633164725, -1.6133083527286942, -1.6830969726046021, -2.020563309391349, -117.88791217406592, -104.24601298322281, -107.08650269110998, -111.21594486633937, -99.32596130172412, -100.37780849138896, -113.6922661860784, -97.13795966406664, -98.46522270639738, -107.33382646242778, -93.44872344533603, -92.03877527515094, -8.12886551519236, -7.650517081220954, -7.544479635854572]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1481396281056962, "mean_inference_ms": 0.6247628667760086, "mean_action_processing_ms": 0.09110555058013511, "mean_env_wait_ms": 0.7569228545680327, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 95000, "timesteps_this_iter": 0, "agent_timesteps_total": 285000, "timers": {"sample_time_ms": 9676.045, "sample_throughput": 516.74, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1493.437, "learn_throughput": 3347.981, "update_time_ms": 7.115}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0005000000000000001, "total_loss": 715.7452209472656, "policy_loss": -0.0029447878367205417, "vf_loss": 715.800537109375, "vf_explained_var": 0.016637688875198363, "kl": 0.004111732720051235, "entropy": 5.236662530899048, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 95000, "num_agent_steps_sampled": 285000, "num_steps_trained": 95000, "num_agent_steps_trained": 285000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 927, "training_iteration": 19, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-12-19", "timestamp": 1706227939, "time_this_iter_s": 9.513849020004272, "time_total_s": 183.61262845993042, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824A3DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 183.61262845993042, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 5.746153846153846, "ram_util_percent": 52.55384615384616}}
{"episode_reward_max": 17.524013556540012, "episode_reward_min": -347.038438513875, "episode_reward_mean": -243.04369421199897, "episode_len_mean": 173.4, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"shared_policy": -124.78863054513931}, "policy_reward_max": {"shared_policy": 5.9684160724282265}, "policy_reward_mean": {"shared_policy": -81.01456473733299}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-288.8792941123247, -313.3192248344422, 9.482196047902107, -306.83621234446764, -282.2533427402377, -12.786373630166082, -317.4116055220366, -299.83482423424726, -319.8700148649514, -333.851630717516, -304.8220546543598, -324.2692410722375, -339.2837383747101, -316.8818572796881, -300.8342771306634, -295.46429063379765, -319.71646620333195, -320.738133341074, -314.4057476595044, -325.2057358920574, -341.0472315400839, -1.8272719830274582, -318.4588581621647, -300.65248879790306, -325.2745449244976, -316.54669431131333, -9.785042285919204, -38.90517810732129, -308.3773663043976, -286.8835301846266, -296.1204062998295, -295.164927393198, -314.3758690059185, -311.42101067304617, -327.5547270178795, -325.59665936231613, 9.044221326708794, -340.9077661633492, -287.5477574765682, -293.7458782456815, -288.37920677661896, -299.430948369205, -322.9150387644768, -324.2135187536478, -338.9790347889066, -324.2072729244828, -347.038438513875, -299.60076216980815, -17.37889009341599, 3.899302005767794, -311.2771198824048, -311.2520981132984, -26.35461271554233, -315.1797680556774, -305.6150645315647, -307.6963201984763, -16.8914052397013, -26.9808952584863, -319.6340034008026, -19.627472676336794, -289.1484929919243, -275.63460059463983, -5.316968634724645, -329.22042784839874, -310.91971465945244, -309.29544855654245, -292.82132518291473, -23.323862232267885, -46.233118675649195, -20.305994965136065, -306.1048686951399, -306.8501805812121, -308.13872569799423, -314.53701540827757, -303.54319010674953, -286.9183317273855, -310.1932753771544, -19.842024762183456, -314.3839589431882, -309.80065390467644, -307.2539305239916, -99.55623534321785, -319.2285972908139, -323.548521719873, -331.08865001797676, -31.84078350663185, -5.170404836535482, -307.0483668036759, -296.7885423004627, 17.524013556540012, -306.26041845977306, -310.50536534003913, -301.6142416000367, -299.5629852563143, -304.13108217716217, 0.574968233704567, -325.81609401106834, -326.4282571077347, 12.293885435909033, -279.3042072579265], "episode_lengths": [105, 56, 500, 59, 94, 500, 77, 60, 98, 86, 67, 75, 82, 43, 47, 67, 79, 56, 42, 93, 67, 500, 137, 90, 52, 54, 500, 500, 43, 99, 64, 140, 85, 75, 71, 90, 500, 104, 80, 178, 71, 59, 60, 49, 75, 68, 101, 87, 500, 500, 70, 61, 500, 59, 66, 46, 500, 500, 78, 500, 97, 88, 500, 44, 74, 65, 112, 500, 500, 500, 102, 77, 59, 67, 62, 92, 73, 500, 55, 80, 72, 500, 55, 95, 84, 500, 500, 65, 96, 500, 60, 65, 57, 95, 57, 500, 91, 55, 500, 81], "policy_shared_policy_reward": [-107.65603431065878, -90.68276502688727, -90.5404947747787, -99.90576087435088, -99.25588219364485, -114.15758176644644, 3.2021482288837433, 3.4121203422546387, 2.8679274767637253, -97.32683400064707, -110.02844697237015, -99.48093137145042, -89.42567490786314, -89.88517355918884, -102.94249427318573, -4.188734834392875, -4.196570013960212, -4.401068781812995, -100.88073838253817, -113.9406558473905, -102.59021129210791, -107.38282676537833, -96.09111558397612, -96.36088188489279, -103.02981016039848, -101.51854513958097, -115.32165956497192, -107.2260646124681, -119.67537697156271, -106.95018913348517, -97.64016345143318, -109.15910422801971, -98.02278697490692, -102.81783095747232, -105.24229127168655, -116.20911884307861, -109.06552044550578, -120.595421175162, -109.62279675404231, -101.91469752788544, -114.57696104049683, -100.39019871130586, -100.53917849063873, -102.72847735881805, -97.56662128120661, -107.4563117424647, -94.35261429349582, -93.65536459783713, -102.47311007976532, -100.92966188490391, -116.31369423866272, -101.58756658434868, -103.93281549215317, -115.21775126457214, -100.75157678623995, -100.0488169019421, -113.60535397132239, -104.95730897784233, -105.43820163607597, -114.81022527813911, -108.84287771582603, -122.62200516462326, -109.58234865963459, -0.44160182029008865, -0.835694432258606, -0.5499757304787636, -115.23150300979614, -101.66359668970108, -101.56375846266747, -108.48220403989157, -95.80067943533263, -96.3696053226789, -104.81355939308803, -103.61568708221118, -116.84529844919841, -115.87741641203563, -100.63017194966476, -100.03910594961296, -3.3320107037822453, -3.336913111309215, -3.116118470827743, -12.876725104947894, -13.010139932235091, -13.018313070138305, -97.95443105697632, -98.62637895345688, -111.79655629396439, -92.4268327454726, -102.09729840854804, -92.35939903060596, -94.80571445822716, -94.83455818891525, -106.48013365268707, -94.43558608492216, -106.0797526439031, -94.64958866437277, -100.29903162519138, -114.10190645853679, -99.97493092219035, -107.59664233525595, -103.83497532208762, -99.98939301570257, -114.57504117488861, -105.8046048283577, -107.17508101463318, -105.14723262190819, -103.2530810534954, -117.19634568691254, 3.1499065905809402, 3.0780367255210876, 2.8162780106067657, -121.91013761361441, -109.31710251172385, -109.68052603801092, -91.06466010212898, -103.35669159889221, -93.12640577554703, -106.04458183050156, -94.03838604688644, -93.66291036829352, -92.3420420686404, -103.62312112251918, -92.4140435854594, -109.64240860939026, -95.52019533514977, -94.26834442466497, -100.82895378271739, -116.90738658110301, -105.17869840065639, -103.34734480579695, -117.33225490649542, -103.53391904135546, -106.05545326819023, -109.26362808545431, -123.65995343526205, -104.56365860501926, -116.69692925612132, -102.94668506334226, -111.09412232041359, -124.78863054513931, -111.1556856483221, -98.11765533685684, -94.13245747610927, -107.35064935684204, -5.413052647064134, -5.4419866974155156, -6.52385074893634, 1.5431690613428657, 1.328147764007241, 1.0279851804176872, -105.3903116385142, -100.32659892986219, -105.56020931402843, -101.35897652308147, -98.12744916478793, -111.76567242542903, -8.62273432562749, -9.037149066726371, -8.694729323188469, -100.42244764665763, -100.38549813131492, -114.37182227770488, -98.74179895718893, -97.26610105236372, -109.60716452201208, -98.49589636176825, -98.6787129342556, -110.52171090245247, -5.450853665669769, -5.604651903112739, -5.835899670918792, -8.992061307032913, -8.967138183613628, -9.02169576783976, -101.83009825150172, -102.80604056517284, -114.99786458412807, -6.410113160808891, -6.524390873809665, -6.692968641718238, -92.9525158405304, -92.56406164169312, -103.63191550970078, -87.63417777915797, -99.1977964838346, -88.80262633164725, -1.6133083527286942, -1.6830969726046021, -2.020563309391349, -117.88791217406592, -104.24601298322281, -107.08650269110998, -111.21594486633937, -99.32596130172412, -100.37780849138896, -113.6922661860784, -97.13795966406664, -98.46522270639738, -107.33382646242778, -93.44872344533603, -92.03877527515094, -8.12886551519236, -7.650517081220954, -7.544479635854572, -15.361615945895522, -15.425124657650798, -15.446378072102874, -6.44703020403783, -7.069138447443649, -6.789826313654586, -110.36983036994934, -97.76246050000191, -97.97257782518864, -100.46870704491934, -109.72874160607657, -96.65273193021616, -109.7942969997724, -99.37806554635367, -98.9663631518682, -101.2133820851644, -113.67462058862051, -99.64901273449263, -96.97011661032836, -97.65375275413196, -108.91932074228923, -91.3742370059093, -92.15300544102988, -103.39108928044638, -103.28702249129614, -101.47072047491869, -105.43553241093954, -6.658588548501342, -6.3704737958808835, -6.812962417801231, -101.44249296188354, -100.44278467446566, -112.49868130683899, -99.46490655342738, -98.20166940490405, -112.13407794634502, -99.05120875438055, -111.07585545380911, -97.12686631580195, -32.85153579215209, -33.297123799721405, -33.40757575134437, -104.2469684680303, -114.38435359795889, -100.59727522482476, -103.93674014260372, -103.6057856877645, -116.00599588950476, -104.74158568183582, -119.33255938688914, -107.01450494925182, -10.485621094703674, -10.663064569234848, -10.692097842693329, -2.0039396484692986, -1.395098467667907, -1.7713667203982766, -101.97968198855719, -99.81222466503581, -105.25646015008292, -107.25532825787863, -94.58994101484618, -94.94327302773794, 5.9684160724282265, 5.651255398988724, 5.904342085123062, -97.21318553388119, -110.76636183261871, -98.28087109327316, -98.79049056582153, -111.50605535507202, -100.20881941914558, -96.65545148154101, -108.10473208626112, -96.85405803223452, -95.8433405905962, -107.36541619896889, -96.35422846674919, -110.0954734881719, -97.10013683636984, -96.93547185262045, 0.26146963238716125, 0.07106363773345947, 0.24243496358394623, -104.64320081969103, -104.95700452228388, -116.21588866909346, -116.71517994006476, -105.02569328745207, -104.68738388021788, 3.980891689658165, 3.999289184808731, 4.313704561442137, -87.96526349832615, -90.2269449432691, -101.11199881633124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14736459191293202, "mean_inference_ms": 0.6268815579415926, "mean_action_processing_ms": 0.09163045765767772, "mean_env_wait_ms": 0.7596397602047119, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 100000, "timesteps_this_iter": 0, "agent_timesteps_total": 300000, "timers": {"sample_time_ms": 9749.368, "sample_throughput": 512.854, "load_time_ms": 0.1, "load_throughput": 50003624.225, "learn_time_ms": 1504.221, "learn_throughput": 3323.98, "update_time_ms": 7.115}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0005000000000000001, "total_loss": 1136.1116577148437, "policy_loss": -0.002354611675726881, "vf_loss": 1136.1702758789063, "vf_explained_var": 0.040369457006454466, "kl": 0.0034574371908128363, "entropy": 5.622900438308716, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 100000, "num_agent_steps_sampled": 300000, "num_steps_trained": 100000, "num_agent_steps_trained": 300000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 959, "training_iteration": 20, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-12-29", "timestamp": 1706227949, "time_this_iter_s": 10.416205883026123, "time_total_s": 194.02883434295654, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202825D1C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 194.02883434295654, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 8.853333333333333, "ram_util_percent": 52.59333333333335}}
{"episode_reward_max": 24.137328326702104, "episode_reward_min": -348.7094454020262, "episode_reward_mean": -225.56995388262905, "episode_len_mean": 199.92, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": -126.5179133017858}, "policy_reward_max": {"shared_policy": 8.258230594297245}, "policy_reward_mean": {"shared_policy": -75.18998462754301}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-341.0472315400839, -1.8272719830274582, -318.4588581621647, -300.65248879790306, -325.2745449244976, -316.54669431131333, -9.785042285919204, -38.90517810732129, -308.3773663043976, -286.8835301846266, -296.1204062998295, -295.164927393198, -314.3758690059185, -311.42101067304617, -327.5547270178795, -325.59665936231613, 9.044221326708794, -340.9077661633492, -287.5477574765682, -293.7458782456815, -288.37920677661896, -299.430948369205, -322.9150387644768, -324.2135187536478, -338.9790347889066, -324.2072729244828, -347.038438513875, -299.60076216980815, -17.37889009341599, 3.899302005767794, -311.2771198824048, -311.2520981132984, -26.35461271554233, -315.1797680556774, -305.6150645315647, -307.6963201984763, -16.8914052397013, -26.9808952584863, -319.6340034008026, -19.627472676336794, -289.1484929919243, -275.63460059463983, -5.316968634724645, -329.22042784839874, -310.91971465945244, -309.29544855654245, -292.82132518291473, -23.323862232267885, -46.233118675649195, -20.305994965136065, -306.1048686951399, -306.8501805812121, -308.13872569799423, -314.53701540827757, -303.54319010674953, -286.9183317273855, -310.1932753771544, -19.842024762183456, -314.3839589431882, -309.80065390467644, -307.2539305239916, -99.55623534321785, -319.2285972908139, -323.548521719873, -331.08865001797676, -31.84078350663185, -5.170404836535482, -307.0483668036759, -296.7885423004627, 17.524013556540012, -306.26041845977306, -310.50536534003913, -301.6142416000367, -299.5629852563143, -304.13108217716217, 0.574968233704567, -325.81609401106834, -326.4282571077347, 12.293885435909033, -279.3042072579265, 6.545453406870365, -302.88858288526535, -289.26571746915585, -301.8936101049185, -28.815266598016038, 24.137328326702104, -311.8033947944641, -334.4299926608801, 3.367823816835852, -288.8689662106335, -21.974609043449163, -37.117539726197734, -318.71910628676414, -293.45276037603617, -319.45281903445726, -316.9693494141102, -348.7094454020262, -49.88633207604289, -329.26356878876686, -20.34738093614581], "episode_lengths": [67, 500, 137, 90, 52, 54, 500, 500, 43, 99, 64, 140, 85, 75, 71, 90, 500, 104, 80, 178, 71, 59, 60, 49, 75, 68, 101, 87, 500, 500, 70, 61, 500, 59, 66, 46, 500, 500, 78, 500, 97, 88, 500, 44, 74, 65, 112, 500, 500, 500, 102, 77, 59, 67, 62, 92, 73, 500, 55, 80, 72, 500, 55, 95, 84, 500, 500, 65, 96, 500, 60, 65, 57, 95, 57, 500, 91, 55, 500, 81, 500, 76, 86, 96, 500, 500, 72, 62, 500, 73, 500, 500, 45, 72, 82, 53, 122, 500, 99, 500], "policy_shared_policy_reward": [-108.84287771582603, -122.62200516462326, -109.58234865963459, -0.44160182029008865, -0.835694432258606, -0.5499757304787636, -115.23150300979614, -101.66359668970108, -101.56375846266747, -108.48220403989157, -95.80067943533263, -96.3696053226789, -104.81355939308803, -103.61568708221118, -116.84529844919841, -115.87741641203563, -100.63017194966476, -100.03910594961296, -3.3320107037822453, -3.336913111309215, -3.116118470827743, -12.876725104947894, -13.010139932235091, -13.018313070138305, -97.95443105697632, -98.62637895345688, -111.79655629396439, -92.4268327454726, -102.09729840854804, -92.35939903060596, -94.80571445822716, -94.83455818891525, -106.48013365268707, -94.43558608492216, -106.0797526439031, -94.64958866437277, -100.29903162519138, -114.10190645853679, -99.97493092219035, -107.59664233525595, -103.83497532208762, -99.98939301570257, -114.57504117488861, -105.8046048283577, -107.17508101463318, -105.14723262190819, -103.2530810534954, -117.19634568691254, 3.1499065905809402, 3.0780367255210876, 2.8162780106067657, -121.91013761361441, -109.31710251172385, -109.68052603801092, -91.06466010212898, -103.35669159889221, -93.12640577554703, -106.04458183050156, -94.03838604688644, -93.66291036829352, -92.3420420686404, -103.62312112251918, -92.4140435854594, -109.64240860939026, -95.52019533514977, -94.26834442466497, -100.82895378271739, -116.90738658110301, -105.17869840065639, -103.34734480579695, -117.33225490649542, -103.53391904135546, -106.05545326819023, -109.26362808545431, -123.65995343526205, -104.56365860501926, -116.69692925612132, -102.94668506334226, -111.09412232041359, -124.78863054513931, -111.1556856483221, -98.11765533685684, -94.13245747610927, -107.35064935684204, -5.413052647064134, -5.4419866974155156, -6.52385074893634, 1.5431690613428657, 1.328147764007241, 1.0279851804176872, -105.3903116385142, -100.32659892986219, -105.56020931402843, -101.35897652308147, -98.12744916478793, -111.76567242542903, -8.62273432562749, -9.037149066726371, -8.694729323188469, -100.42244764665763, -100.38549813131492, -114.37182227770488, -98.74179895718893, -97.26610105236372, -109.60716452201208, -98.49589636176825, -98.6787129342556, -110.52171090245247, -5.450853665669769, -5.604651903112739, -5.835899670918792, -8.992061307032913, -8.967138183613628, -9.02169576783976, -101.83009825150172, -102.80604056517284, -114.99786458412807, -6.410113160808891, -6.524390873809665, -6.692968641718238, -92.9525158405304, -92.56406164169312, -103.63191550970078, -87.63417777915797, -99.1977964838346, -88.80262633164725, -1.6133083527286942, -1.6830969726046021, -2.020563309391349, -117.88791217406592, -104.24601298322281, -107.08650269110998, -111.21594486633937, -99.32596130172412, -100.37780849138896, -113.6922661860784, -97.13795966406664, -98.46522270639738, -107.33382646242778, -93.44872344533603, -92.03877527515094, -8.12886551519236, -7.650517081220954, -7.544479635854572, -15.361615945895522, -15.425124657650798, -15.446378072102874, -6.44703020403783, -7.069138447443649, -6.789826313654586, -110.36983036994934, -97.76246050000191, -97.97257782518864, -100.46870704491934, -109.72874160607657, -96.65273193021616, -109.7942969997724, -99.37806554635367, -98.9663631518682, -101.2133820851644, -113.67462058862051, -99.64901273449263, -96.97011661032836, -97.65375275413196, -108.91932074228923, -91.3742370059093, -92.15300544102988, -103.39108928044638, -103.28702249129614, -101.47072047491869, -105.43553241093954, -6.658588548501342, -6.3704737958808835, -6.812962417801231, -101.44249296188354, -100.44278467446566, -112.49868130683899, -99.46490655342738, -98.20166940490405, -112.13407794634502, -99.05120875438055, -111.07585545380911, -97.12686631580195, -32.85153579215209, -33.297123799721405, -33.40757575134437, -104.2469684680303, -114.38435359795889, -100.59727522482476, -103.93674014260372, -103.6057856877645, -116.00599588950476, -104.74158568183582, -119.33255938688914, -107.01450494925182, -10.485621094703674, -10.663064569234848, -10.692097842693329, -2.0039396484692986, -1.395098467667907, -1.7713667203982766, -101.97968198855719, -99.81222466503581, -105.25646015008292, -107.25532825787863, -94.58994101484618, -94.94327302773794, 5.9684160724282265, 5.651255398988724, 5.904342085123062, -97.21318553388119, -110.76636183261871, -98.28087109327316, -98.79049056582153, -111.50605535507202, -100.20881941914558, -96.65545148154101, -108.10473208626112, -96.85405803223452, -95.8433405905962, -107.36541619896889, -96.35422846674919, -110.0954734881719, -97.10013683636984, -96.93547185262045, 0.26146963238716125, 0.07106363773345947, 0.24243496358394623, -104.64320081969103, -104.95700452228388, -116.21588866909346, -116.71517994006476, -105.02569328745207, -104.68738388021788, 3.980891689658165, 3.999289184808731, 4.313704561442137, -87.96526349832615, -90.2269449432691, -101.11199881633124, 2.2967378608882427, 1.9930509477853775, 2.255664598196745, -97.84805365403494, -96.61378898223242, -108.42674024899802, -105.98200776179632, -91.52000513424477, -91.76370457311472, -107.62652232249579, -97.46519221862158, -96.80189556380114, -9.631764719883606, -9.238480924318239, -9.945020953814193, 8.054367137451962, 8.258230594297245, 7.8247305949528965, -98.33056790630023, -98.74241603414218, -114.73041085402171, -109.45516109466553, -119.44197177886963, -105.53285978734493, 1.2583854446808402, 1.2048482919732635, 0.9045900801817481, -105.51016815503439, -91.40589716409644, -91.95290089150271, -6.936916720122099, -7.133099392056465, -7.904592931270599, -11.64898917327325, -12.550372819105789, -12.918177733818695, -99.46380087733269, -117.0268144607544, -102.22849094867706, -106.32619939247768, -93.44528350482385, -93.68127747873466, -115.62204893430075, -102.41867031653723, -101.41209978361925, -102.46919568379721, -100.71485679348311, -113.7852969368299, -110.32364610334238, -111.86788599689802, -126.5179133017858, -16.531930074095726, -16.471107315272093, -16.88329468667507, -105.400409390529, -118.7468008597692, -105.11635853846869, -6.793194686373084, -6.742379752298206, -6.811806497474521]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14745972745281458, "mean_inference_ms": 0.629585523627811, "mean_action_processing_ms": 0.09217742384884037, "mean_env_wait_ms": 0.761753743121686, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 105000, "timesteps_this_iter": 0, "agent_timesteps_total": 315000, "timers": {"sample_time_ms": 9824.615, "sample_throughput": 508.926, "load_time_ms": 0.1, "load_throughput": 50003624.225, "learn_time_ms": 1505.388, "learn_throughput": 3321.402, "update_time_ms": 7.107}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0005000000000000001, "total_loss": 673.2047973632813, "policy_loss": -0.002128025742356332, "vf_loss": 673.25966796875, "vf_explained_var": 0.08327133059501649, "kl": 0.0027427747219952317, "entropy": 5.271411323547364, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 105000, "num_agent_steps_sampled": 315000, "num_steps_trained": 105000, "num_agent_steps_trained": 315000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 979, "training_iteration": 21, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-12-39", "timestamp": 1706227959, "time_this_iter_s": 10.205018281936646, "time_total_s": 204.2338526248932, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028457F430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 204.2338526248932, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 6.278571428571428, "ram_util_percent": 52.73571428571428}}
{"episode_reward_max": 24.137328326702104, "episode_reward_min": -348.7094454020262, "episode_reward_mean": -222.27073848338216, "episode_len_mean": 200.83, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {"shared_policy": -126.5179133017858}, "policy_reward_max": {"shared_policy": 8.258230594297245}, "policy_reward_mean": {"shared_policy": -74.09024616112738}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.37889009341599, 3.899302005767794, -311.2771198824048, -311.2520981132984, -26.35461271554233, -315.1797680556774, -305.6150645315647, -307.6963201984763, -16.8914052397013, -26.9808952584863, -319.6340034008026, -19.627472676336794, -289.1484929919243, -275.63460059463983, -5.316968634724645, -329.22042784839874, -310.91971465945244, -309.29544855654245, -292.82132518291473, -23.323862232267885, -46.233118675649195, -20.305994965136065, -306.1048686951399, -306.8501805812121, -308.13872569799423, -314.53701540827757, -303.54319010674953, -286.9183317273855, -310.1932753771544, -19.842024762183456, -314.3839589431882, -309.80065390467644, -307.2539305239916, -99.55623534321785, -319.2285972908139, -323.548521719873, -331.08865001797676, -31.84078350663185, -5.170404836535482, -307.0483668036759, -296.7885423004627, 17.524013556540012, -306.26041845977306, -310.50536534003913, -301.6142416000367, -299.5629852563143, -304.13108217716217, 0.574968233704567, -325.81609401106834, -326.4282571077347, 12.293885435909033, -279.3042072579265, 6.545453406870365, -302.88858288526535, -289.26571746915585, -301.8936101049185, -28.815266598016038, 24.137328326702104, -311.8033947944641, -334.4299926608801, 3.367823816835852, -288.8689662106335, -21.974609043449163, -37.117539726197734, -318.71910628676414, -293.45276037603617, -319.45281903445726, -316.9693494141102, -348.7094454020262, -49.88633207604289, -329.26356878876686, -20.34738093614581, -316.0324397981167, -326.81099078804255, -317.7637200392783, -303.1765479296446, -13.96556057780981, -314.9383474960923, -302.4601132199168, -14.674311548471465, -313.255544885993, -305.8018208760768, -303.2880765199661, -327.698292568326, -284.7302292138338, -308.7217565852916, -315.30639111995697, -15.317639611661448, -313.9740831553936, -311.0759957255796, -345.1822384893894, -305.5583492964506, -285.1569755077362, -13.86901562660934, -313.4927310273051, -324.1718710064888, -315.75452610850334, -310.02853763103485, -292.67004658281803, -31.11551511287692], "episode_lengths": [500, 500, 70, 61, 500, 59, 66, 46, 500, 500, 78, 500, 97, 88, 500, 44, 74, 65, 112, 500, 500, 500, 102, 77, 59, 67, 62, 92, 73, 500, 55, 80, 72, 500, 55, 95, 84, 500, 500, 65, 96, 500, 60, 65, 57, 95, 57, 500, 91, 55, 500, 81, 500, 76, 86, 96, 500, 500, 72, 62, 500, 73, 500, 500, 45, 72, 82, 53, 122, 500, 99, 500, 82, 51, 66, 66, 500, 58, 91, 500, 43, 57, 59, 65, 75, 71, 70, 500, 56, 47, 90, 63, 112, 500, 68, 70, 58, 80, 92, 500], "policy_shared_policy_reward": [-5.413052647064134, -5.4419866974155156, -6.52385074893634, 1.5431690613428657, 1.328147764007241, 1.0279851804176872, -105.3903116385142, -100.32659892986219, -105.56020931402843, -101.35897652308147, -98.12744916478793, -111.76567242542903, -8.62273432562749, -9.037149066726371, -8.694729323188469, -100.42244764665763, -100.38549813131492, -114.37182227770488, -98.74179895718893, -97.26610105236372, -109.60716452201208, -98.49589636176825, -98.6787129342556, -110.52171090245247, -5.450853665669769, -5.604651903112739, -5.835899670918792, -8.992061307032913, -8.967138183613628, -9.02169576783976, -101.83009825150172, -102.80604056517284, -114.99786458412807, -6.410113160808891, -6.524390873809665, -6.692968641718238, -92.9525158405304, -92.56406164169312, -103.63191550970078, -87.63417777915797, -99.1977964838346, -88.80262633164725, -1.6133083527286942, -1.6830969726046021, -2.020563309391349, -117.88791217406592, -104.24601298322281, -107.08650269110998, -111.21594486633937, -99.32596130172412, -100.37780849138896, -113.6922661860784, -97.13795966406664, -98.46522270639738, -107.33382646242778, -93.44872344533603, -92.03877527515094, -8.12886551519236, -7.650517081220954, -7.544479635854572, -15.361615945895522, -15.425124657650798, -15.446378072102874, -6.44703020403783, -7.069138447443649, -6.789826313654586, -110.36983036994934, -97.76246050000191, -97.97257782518864, -100.46870704491934, -109.72874160607657, -96.65273193021616, -109.7942969997724, -99.37806554635367, -98.9663631518682, -101.2133820851644, -113.67462058862051, -99.64901273449263, -96.97011661032836, -97.65375275413196, -108.91932074228923, -91.3742370059093, -92.15300544102988, -103.39108928044638, -103.28702249129614, -101.47072047491869, -105.43553241093954, -6.658588548501342, -6.3704737958808835, -6.812962417801231, -101.44249296188354, -100.44278467446566, -112.49868130683899, -99.46490655342738, -98.20166940490405, -112.13407794634502, -99.05120875438055, -111.07585545380911, -97.12686631580195, -32.85153579215209, -33.297123799721405, -33.40757575134437, -104.2469684680303, -114.38435359795889, -100.59727522482476, -103.93674014260372, -103.6057856877645, -116.00599588950476, -104.74158568183582, -119.33255938688914, -107.01450494925182, -10.485621094703674, -10.663064569234848, -10.692097842693329, -2.0039396484692986, -1.395098467667907, -1.7713667203982766, -101.97968198855719, -99.81222466503581, -105.25646015008292, -107.25532825787863, -94.58994101484618, -94.94327302773794, 5.9684160724282265, 5.651255398988724, 5.904342085123062, -97.21318553388119, -110.76636183261871, -98.28087109327316, -98.79049056582153, -111.50605535507202, -100.20881941914558, -96.65545148154101, -108.10473208626112, -96.85405803223452, -95.8433405905962, -107.36541619896889, -96.35422846674919, -110.0954734881719, -97.10013683636984, -96.93547185262045, 0.26146963238716125, 0.07106363773345947, 0.24243496358394623, -104.64320081969103, -104.95700452228388, -116.21588866909346, -116.71517994006476, -105.02569328745207, -104.68738388021788, 3.980891689658165, 3.999289184808731, 4.313704561442137, -87.96526349832615, -90.2269449432691, -101.11199881633124, 2.2967378608882427, 1.9930509477853775, 2.255664598196745, -97.84805365403494, -96.61378898223242, -108.42674024899802, -105.98200776179632, -91.52000513424477, -91.76370457311472, -107.62652232249579, -97.46519221862158, -96.80189556380114, -9.631764719883606, -9.238480924318239, -9.945020953814193, 8.054367137451962, 8.258230594297245, 7.8247305949528965, -98.33056790630023, -98.74241603414218, -114.73041085402171, -109.45516109466553, -119.44197177886963, -105.53285978734493, 1.2583854446808402, 1.2048482919732635, 0.9045900801817481, -105.51016815503439, -91.40589716409644, -91.95290089150271, -6.936916720122099, -7.133099392056465, -7.904592931270599, -11.64898917327325, -12.550372819105789, -12.918177733818695, -99.46380087733269, -117.0268144607544, -102.22849094867706, -106.32619939247768, -93.44528350482385, -93.68127747873466, -115.62204893430075, -102.41867031653723, -101.41209978361925, -102.46919568379721, -100.71485679348311, -113.7852969368299, -110.32364610334238, -111.86788599689802, -126.5179133017858, -16.531930074095726, -16.471107315272093, -16.88329468667507, -105.400409390529, -118.7468008597692, -105.11635853846869, -6.793194686373084, -6.742379752298206, -6.811806497474521, -101.78949982921283, -102.10664049784343, -112.13629947106044, -119.61661195755005, -103.95303091406822, -103.24134791642427, -113.79680581887564, -101.15841435765228, -102.80849986275038, -97.11868064105511, -97.00929382443428, -109.0485734641552, -4.677237585186958, -4.774965584278107, -4.513357408344746, -99.28966430574656, -101.56436109542847, -114.0843220949173, -96.5589865470926, -96.40128357211749, -109.49984310070674, -4.786152581373855, -4.838687072197601, -5.049471894900009, -113.36089166005453, -98.63705331583819, -101.25759991010031, -97.43910542068383, -110.5898874004682, -97.77282805492482, -96.84319597979388, -109.27729149659476, -97.16758904357752, -105.8405049343904, -117.29767980178198, -104.56010783215365, -102.65288980801901, -90.92090891798338, -91.15643048783144, -110.98703056573868, -99.39364425837994, -98.34108176117297, -106.62724415461223, -103.99611125389735, -104.6830357114474, -5.010187568763897, -4.9787352035443035, -5.328716839353248, -112.11004732052486, -100.28673035899799, -101.57730547587077, -98.76516940941414, -114.10456522305807, -98.20626109310737, -109.79806382457416, -110.58391455809276, -124.80026010672252, -111.65601368745169, -97.47448321183523, -96.42785239716372, -91.71567250291507, -102.57046733299892, -90.87083567182223, -4.26543826113145, -4.47260169188182, -5.130975673596069, -98.77942326913278, -112.1969642440478, -102.51634351412456, -115.8346008459727, -103.5454430381457, -104.7918271223704, -112.30825876196226, -101.7511693139871, -101.695098032554, -97.28990936279297, -113.75353538990021, -98.98509287834167, -92.19434640308222, -94.16944964726767, -106.30625053246817, -10.183124204476684, -10.395265703399986, -10.537125205000251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1472648759895117, "mean_inference_ms": 0.631835637751079, "mean_action_processing_ms": 0.09298674544220921, "mean_env_wait_ms": 0.7640598440101138, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 110000, "timesteps_this_iter": 0, "agent_timesteps_total": 330000, "timers": {"sample_time_ms": 9838.952, "sample_throughput": 508.184, "load_time_ms": 0.1, "load_throughput": 50003624.225, "learn_time_ms": 1510.969, "learn_throughput": 3309.134, "update_time_ms": 7.015}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0005000000000000001, "total_loss": 1050.558837890625, "policy_loss": -0.002622042372695521, "vf_loss": 1050.6165893554687, "vf_explained_var": 0.16079828143119812, "kl": 0.003381030744644129, "entropy": 5.515353870391846, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 110000, "num_agent_steps_sampled": 330000, "num_steps_trained": 110000, "num_agent_steps_trained": 330000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1007, "training_iteration": 22, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-12-49", "timestamp": 1706227969, "time_this_iter_s": 9.977071046829224, "time_total_s": 214.2109236717224, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202808BA310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 214.2109236717224, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 6.235714285714287, "ram_util_percent": 52.74285714285715}}
{"episode_reward_max": 24.137328326702104, "episode_reward_min": -348.7094454020262, "episode_reward_mean": -225.3858377137163, "episode_len_mean": 195.35, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {"shared_policy": -126.5179133017858}, "policy_reward_max": {"shared_policy": 8.258230594297245}, "policy_reward_mean": {"shared_policy": -75.12861257123878}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-303.54319010674953, -286.9183317273855, -310.1932753771544, -19.842024762183456, -314.3839589431882, -309.80065390467644, -307.2539305239916, -99.55623534321785, -319.2285972908139, -323.548521719873, -331.08865001797676, -31.84078350663185, -5.170404836535482, -307.0483668036759, -296.7885423004627, 17.524013556540012, -306.26041845977306, -310.50536534003913, -301.6142416000367, -299.5629852563143, -304.13108217716217, 0.574968233704567, -325.81609401106834, -326.4282571077347, 12.293885435909033, -279.3042072579265, 6.545453406870365, -302.88858288526535, -289.26571746915585, -301.8936101049185, -28.815266598016038, 24.137328326702104, -311.8033947944641, -334.4299926608801, 3.367823816835852, -288.8689662106335, -21.974609043449163, -37.117539726197734, -318.71910628676414, -293.45276037603617, -319.45281903445726, -316.9693494141102, -348.7094454020262, -49.88633207604289, -329.26356878876686, -20.34738093614581, -316.0324397981167, -326.81099078804255, -317.7637200392783, -303.1765479296446, -13.96556057780981, -314.9383474960923, -302.4601132199168, -14.674311548471465, -313.255544885993, -305.8018208760768, -303.2880765199661, -327.698292568326, -284.7302292138338, -308.7217565852916, -315.30639111995697, -15.317639611661448, -313.9740831553936, -311.0759957255796, -345.1822384893894, -305.5583492964506, -285.1569755077362, -13.86901562660934, -313.4927310273051, -324.1718710064888, -315.75452610850334, -310.02853763103485, -292.67004658281803, -31.11551511287692, 19.386113330721827, -309.3238830268383, -323.70962512493134, -304.6841654330492, -303.26691004633904, -35.54726823419334, -11.183522358536734, -306.22998274862766, -37.769713297486334, -309.12316501140594, -42.76665835827589, -304.8494642227888, -343.2136472761631, -27.5003425627947, 2.804852936416836, 12.012778356671333, -313.49119071662426, -15.528365038335323, -310.7228942960501, -313.7810886949301, -319.70578472316265, -295.0059901624918, -310.5528226941824, -310.7026413157582, -306.7403821796179, -302.1532530188561], "episode_lengths": [62, 92, 73, 500, 55, 80, 72, 500, 55, 95, 84, 500, 500, 65, 96, 500, 60, 65, 57, 95, 57, 500, 91, 55, 500, 81, 500, 76, 86, 96, 500, 500, 72, 62, 500, 73, 500, 500, 45, 72, 82, 53, 122, 500, 99, 500, 82, 51, 66, 66, 500, 58, 91, 500, 43, 57, 59, 65, 75, 71, 70, 500, 56, 47, 90, 63, 112, 500, 68, 70, 58, 80, 92, 500, 500, 61, 63, 55, 49, 500, 500, 66, 500, 88, 500, 42, 90, 500, 500, 500, 72, 500, 71, 62, 54, 62, 61, 95, 66, 60], "policy_shared_policy_reward": [-96.97011661032836, -97.65375275413196, -108.91932074228923, -91.3742370059093, -92.15300544102988, -103.39108928044638, -103.28702249129614, -101.47072047491869, -105.43553241093954, -6.658588548501342, -6.3704737958808835, -6.812962417801231, -101.44249296188354, -100.44278467446566, -112.49868130683899, -99.46490655342738, -98.20166940490405, -112.13407794634502, -99.05120875438055, -111.07585545380911, -97.12686631580195, -32.85153579215209, -33.297123799721405, -33.40757575134437, -104.2469684680303, -114.38435359795889, -100.59727522482476, -103.93674014260372, -103.6057856877645, -116.00599588950476, -104.74158568183582, -119.33255938688914, -107.01450494925182, -10.485621094703674, -10.663064569234848, -10.692097842693329, -2.0039396484692986, -1.395098467667907, -1.7713667203982766, -101.97968198855719, -99.81222466503581, -105.25646015008292, -107.25532825787863, -94.58994101484618, -94.94327302773794, 5.9684160724282265, 5.651255398988724, 5.904342085123062, -97.21318553388119, -110.76636183261871, -98.28087109327316, -98.79049056582153, -111.50605535507202, -100.20881941914558, -96.65545148154101, -108.10473208626112, -96.85405803223452, -95.8433405905962, -107.36541619896889, -96.35422846674919, -110.0954734881719, -97.10013683636984, -96.93547185262045, 0.26146963238716125, 0.07106363773345947, 0.24243496358394623, -104.64320081969103, -104.95700452228388, -116.21588866909346, -116.71517994006476, -105.02569328745207, -104.68738388021788, 3.980891689658165, 3.999289184808731, 4.313704561442137, -87.96526349832615, -90.2269449432691, -101.11199881633124, 2.2967378608882427, 1.9930509477853775, 2.255664598196745, -97.84805365403494, -96.61378898223242, -108.42674024899802, -105.98200776179632, -91.52000513424477, -91.76370457311472, -107.62652232249579, -97.46519221862158, -96.80189556380114, -9.631764719883606, -9.238480924318239, -9.945020953814193, 8.054367137451962, 8.258230594297245, 7.8247305949528965, -98.33056790630023, -98.74241603414218, -114.73041085402171, -109.45516109466553, -119.44197177886963, -105.53285978734493, 1.2583854446808402, 1.2048482919732635, 0.9045900801817481, -105.51016815503439, -91.40589716409644, -91.95290089150271, -6.936916720122099, -7.133099392056465, -7.904592931270599, -11.64898917327325, -12.550372819105789, -12.918177733818695, -99.46380087733269, -117.0268144607544, -102.22849094867706, -106.32619939247768, -93.44528350482385, -93.68127747873466, -115.62204893430075, -102.41867031653723, -101.41209978361925, -102.46919568379721, -100.71485679348311, -113.7852969368299, -110.32364610334238, -111.86788599689802, -126.5179133017858, -16.531930074095726, -16.471107315272093, -16.88329468667507, -105.400409390529, -118.7468008597692, -105.11635853846869, -6.793194686373084, -6.742379752298206, -6.811806497474521, -101.78949982921283, -102.10664049784343, -112.13629947106044, -119.61661195755005, -103.95303091406822, -103.24134791642427, -113.79680581887564, -101.15841435765228, -102.80849986275038, -97.11868064105511, -97.00929382443428, -109.0485734641552, -4.677237585186958, -4.774965584278107, -4.513357408344746, -99.28966430574656, -101.56436109542847, -114.0843220949173, -96.5589865470926, -96.40128357211749, -109.49984310070674, -4.786152581373855, -4.838687072197601, -5.049471894900009, -113.36089166005453, -98.63705331583819, -101.25759991010031, -97.43910542068383, -110.5898874004682, -97.77282805492482, -96.84319597979388, -109.27729149659476, -97.16758904357752, -105.8405049343904, -117.29767980178198, -104.56010783215365, -102.65288980801901, -90.92090891798338, -91.15643048783144, -110.98703056573868, -99.39364425837994, -98.34108176117297, -106.62724415461223, -103.99611125389735, -104.6830357114474, -5.010187568763897, -4.9787352035443035, -5.328716839353248, -112.11004732052486, -100.28673035899799, -101.57730547587077, -98.76516940941414, -114.10456522305807, -98.20626109310737, -109.79806382457416, -110.58391455809276, -124.80026010672252, -111.65601368745169, -97.47448321183523, -96.42785239716372, -91.71567250291507, -102.57046733299892, -90.87083567182223, -4.26543826113145, -4.47260169188182, -5.130975673596069, -98.77942326913278, -112.1969642440478, -102.51634351412456, -115.8346008459727, -103.5454430381457, -104.7918271223704, -112.30825876196226, -101.7511693139871, -101.695098032554, -97.28990936279297, -113.75353538990021, -98.98509287834167, -92.19434640308222, -94.16944964726767, -106.30625053246817, -10.183124204476684, -10.395265703399986, -10.537125205000251, 6.557608472804219, 6.474051701525838, 6.35445315639177, -99.84684724609058, -110.70951972405116, -98.76751605669658, -105.44900341828665, -114.69825639327368, -103.56236531337103, -96.70658280948798, -109.48877153793971, -98.48881108562152, -108.14271530508995, -98.60976940393448, -96.5144253373146, -12.250388349095985, -11.510907384256527, -11.785972500840828, -3.793261999885246, -3.6857763479153363, -3.7044840107361523, -97.89948277175426, -97.61114224791527, -110.71935772895813, -12.541776140530914, -12.543391910692065, -12.684545246263355, -98.02054651081562, -98.48695032298565, -112.61566817760468, -14.11744298785925, -14.371303156018257, -14.277912214398384, -99.50730157395205, -100.70362706979117, -104.63853557904562, -111.02011605103812, -122.10497601826987, -110.08855520685515, -9.171930807332203, -9.062772052983448, -9.26563970247905, 0.7514631773034637, 1.0559990840653484, 0.9973906750480239, 4.014058157801628, 4.021749913692474, 3.976970285177231, -99.20079525808494, -112.59184722105663, -101.69854823748271, -5.23685060441494, -5.026927925646305, -5.264586508274078, -100.5060088634491, -111.52161687612534, -98.69526855647564, -101.0028926630815, -112.73563530047736, -100.04256073137125, -115.03299431006114, -102.42481825004022, -102.2479721630613, -106.41213892896971, -94.26762155195078, -94.32622968157133, -98.86084339519343, -111.2360466917356, -100.4559326072534, -101.24682359645765, -102.74824593464534, -106.70757178465526, -110.91879852612814, -97.27443770070872, -98.54714595278105, -99.05591162045798, -98.93367113669714, -104.16367026170096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14720621637403164, "mean_inference_ms": 0.6313056706975355, "mean_action_processing_ms": 0.09287801819197669, "mean_env_wait_ms": 0.7638134818922662, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 115000, "timesteps_this_iter": 0, "agent_timesteps_total": 345000, "timers": {"sample_time_ms": 9858.87, "sample_throughput": 507.158, "load_time_ms": 0.1, "load_throughput": 50003624.225, "learn_time_ms": 1504.689, "learn_throughput": 3322.946, "update_time_ms": 7.015}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0005000000000000001, "total_loss": 819.8789978027344, "policy_loss": -0.001963390635736295, "vf_loss": 819.934619140625, "vf_explained_var": 0.2299725592136383, "kl": 0.0023523408017393894, "entropy": 5.3687763690948485, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 115000, "num_agent_steps_sampled": 345000, "num_steps_trained": 115000, "num_agent_steps_trained": 345000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1033, "training_iteration": 23, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-12-59", "timestamp": 1706227979, "time_this_iter_s": 9.680660009384155, "time_total_s": 223.89158368110657, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824BA160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 223.89158368110657, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 6.885714285714287, "ram_util_percent": 52.69285714285714}}
{"episode_reward_max": 24.137328326702104, "episode_reward_min": -348.7094454020262, "episode_reward_mean": -205.44700603264732, "episode_len_mean": 222.26, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -126.5179133017858}, "policy_reward_max": {"shared_policy": 8.258230594297245}, "policy_reward_mean": {"shared_policy": -68.48233534421578}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.170404836535482, -307.0483668036759, -296.7885423004627, 17.524013556540012, -306.26041845977306, -310.50536534003913, -301.6142416000367, -299.5629852563143, -304.13108217716217, 0.574968233704567, -325.81609401106834, -326.4282571077347, 12.293885435909033, -279.3042072579265, 6.545453406870365, -302.88858288526535, -289.26571746915585, -301.8936101049185, -28.815266598016038, 24.137328326702104, -311.8033947944641, -334.4299926608801, 3.367823816835852, -288.8689662106335, -21.974609043449163, -37.117539726197734, -318.71910628676414, -293.45276037603617, -319.45281903445726, -316.9693494141102, -348.7094454020262, -49.88633207604289, -329.26356878876686, -20.34738093614581, -316.0324397981167, -326.81099078804255, -317.7637200392783, -303.1765479296446, -13.96556057780981, -314.9383474960923, -302.4601132199168, -14.674311548471465, -313.255544885993, -305.8018208760768, -303.2880765199661, -327.698292568326, -284.7302292138338, -308.7217565852916, -315.30639111995697, -15.317639611661448, -313.9740831553936, -311.0759957255796, -345.1822384893894, -305.5583492964506, -285.1569755077362, -13.86901562660934, -313.4927310273051, -324.1718710064888, -315.75452610850334, -310.02853763103485, -292.67004658281803, -31.11551511287692, 19.386113330721827, -309.3238830268383, -323.70962512493134, -304.6841654330492, -303.26691004633904, -35.54726823419334, -11.183522358536734, -306.22998274862766, -37.769713297486334, -309.12316501140594, -42.76665835827589, -304.8494642227888, -343.2136472761631, -27.5003425627947, 2.804852936416836, 12.012778356671333, -313.49119071662426, -15.528365038335323, -310.7228942960501, -313.7810886949301, -319.70578472316265, -295.0059901624918, -310.5528226941824, -310.7026413157582, -306.7403821796179, -302.1532530188561, -9.372534386813669, 4.662539958953829, -282.07123919576406, -11.565790660679355, -3.365012412890806, -58.20514428615572, 1.925208970904336, -0.8103155940771103, -11.553082317113876, -298.8378611803055, -314.61930314451456, 20.497549131512613], "episode_lengths": [500, 65, 96, 500, 60, 65, 57, 95, 57, 500, 91, 55, 500, 81, 500, 76, 86, 96, 500, 500, 72, 62, 500, 73, 500, 500, 45, 72, 82, 53, 122, 500, 99, 500, 82, 51, 66, 66, 500, 58, 91, 500, 43, 57, 59, 65, 75, 71, 70, 500, 56, 47, 90, 63, 112, 500, 68, 70, 58, 80, 92, 500, 500, 61, 63, 55, 49, 500, 500, 66, 500, 88, 500, 42, 90, 500, 500, 500, 72, 500, 71, 62, 54, 62, 61, 95, 66, 60, 500, 500, 61, 500, 500, 500, 500, 500, 500, 99, 199, 500], "policy_shared_policy_reward": [-2.0039396484692986, -1.395098467667907, -1.7713667203982766, -101.97968198855719, -99.81222466503581, -105.25646015008292, -107.25532825787863, -94.58994101484618, -94.94327302773794, 5.9684160724282265, 5.651255398988724, 5.904342085123062, -97.21318553388119, -110.76636183261871, -98.28087109327316, -98.79049056582153, -111.50605535507202, -100.20881941914558, -96.65545148154101, -108.10473208626112, -96.85405803223452, -95.8433405905962, -107.36541619896889, -96.35422846674919, -110.0954734881719, -97.10013683636984, -96.93547185262045, 0.26146963238716125, 0.07106363773345947, 0.24243496358394623, -104.64320081969103, -104.95700452228388, -116.21588866909346, -116.71517994006476, -105.02569328745207, -104.68738388021788, 3.980891689658165, 3.999289184808731, 4.313704561442137, -87.96526349832615, -90.2269449432691, -101.11199881633124, 2.2967378608882427, 1.9930509477853775, 2.255664598196745, -97.84805365403494, -96.61378898223242, -108.42674024899802, -105.98200776179632, -91.52000513424477, -91.76370457311472, -107.62652232249579, -97.46519221862158, -96.80189556380114, -9.631764719883606, -9.238480924318239, -9.945020953814193, 8.054367137451962, 8.258230594297245, 7.8247305949528965, -98.33056790630023, -98.74241603414218, -114.73041085402171, -109.45516109466553, -119.44197177886963, -105.53285978734493, 1.2583854446808402, 1.2048482919732635, 0.9045900801817481, -105.51016815503439, -91.40589716409644, -91.95290089150271, -6.936916720122099, -7.133099392056465, -7.904592931270599, -11.64898917327325, -12.550372819105789, -12.918177733818695, -99.46380087733269, -117.0268144607544, -102.22849094867706, -106.32619939247768, -93.44528350482385, -93.68127747873466, -115.62204893430075, -102.41867031653723, -101.41209978361925, -102.46919568379721, -100.71485679348311, -113.7852969368299, -110.32364610334238, -111.86788599689802, -126.5179133017858, -16.531930074095726, -16.471107315272093, -16.88329468667507, -105.400409390529, -118.7468008597692, -105.11635853846869, -6.793194686373084, -6.742379752298206, -6.811806497474521, -101.78949982921283, -102.10664049784343, -112.13629947106044, -119.61661195755005, -103.95303091406822, -103.24134791642427, -113.79680581887564, -101.15841435765228, -102.80849986275038, -97.11868064105511, -97.00929382443428, -109.0485734641552, -4.677237585186958, -4.774965584278107, -4.513357408344746, -99.28966430574656, -101.56436109542847, -114.0843220949173, -96.5589865470926, -96.40128357211749, -109.49984310070674, -4.786152581373855, -4.838687072197601, -5.049471894900009, -113.36089166005453, -98.63705331583819, -101.25759991010031, -97.43910542068383, -110.5898874004682, -97.77282805492482, -96.84319597979388, -109.27729149659476, -97.16758904357752, -105.8405049343904, -117.29767980178198, -104.56010783215365, -102.65288980801901, -90.92090891798338, -91.15643048783144, -110.98703056573868, -99.39364425837994, -98.34108176117297, -106.62724415461223, -103.99611125389735, -104.6830357114474, -5.010187568763897, -4.9787352035443035, -5.328716839353248, -112.11004732052486, -100.28673035899799, -101.57730547587077, -98.76516940941414, -114.10456522305807, -98.20626109310737, -109.79806382457416, -110.58391455809276, -124.80026010672252, -111.65601368745169, -97.47448321183523, -96.42785239716372, -91.71567250291507, -102.57046733299892, -90.87083567182223, -4.26543826113145, -4.47260169188182, -5.130975673596069, -98.77942326913278, -112.1969642440478, -102.51634351412456, -115.8346008459727, -103.5454430381457, -104.7918271223704, -112.30825876196226, -101.7511693139871, -101.695098032554, -97.28990936279297, -113.75353538990021, -98.98509287834167, -92.19434640308222, -94.16944964726767, -106.30625053246817, -10.183124204476684, -10.395265703399986, -10.537125205000251, 6.557608472804219, 6.474051701525838, 6.35445315639177, -99.84684724609058, -110.70951972405116, -98.76751605669658, -105.44900341828665, -114.69825639327368, -103.56236531337103, -96.70658280948798, -109.48877153793971, -98.48881108562152, -108.14271530508995, -98.60976940393448, -96.5144253373146, -12.250388349095985, -11.510907384256527, -11.785972500840828, -3.793261999885246, -3.6857763479153363, -3.7044840107361523, -97.89948277175426, -97.61114224791527, -110.71935772895813, -12.541776140530914, -12.543391910692065, -12.684545246263355, -98.02054651081562, -98.48695032298565, -112.61566817760468, -14.11744298785925, -14.371303156018257, -14.277912214398384, -99.50730157395205, -100.70362706979117, -104.63853557904562, -111.02011605103812, -122.10497601826987, -110.08855520685515, -9.171930807332203, -9.062772052983448, -9.26563970247905, 0.7514631773034637, 1.0559990840653484, 0.9973906750480239, 4.014058157801628, 4.021749913692474, 3.976970285177231, -99.20079525808494, -112.59184722105663, -101.69854823748271, -5.23685060441494, -5.026927925646305, -5.264586508274078, -100.5060088634491, -111.52161687612534, -98.69526855647564, -101.0028926630815, -112.73563530047736, -100.04256073137125, -115.03299431006114, -102.42481825004022, -102.2479721630613, -106.41213892896971, -94.26762155195078, -94.32622968157133, -98.86084339519343, -111.2360466917356, -100.4559326072534, -101.24682359645765, -102.74824593464534, -106.70757178465526, -110.91879852612814, -97.27443770070872, -98.54714595278105, -99.05591162045798, -98.93367113669714, -104.16367026170096, -3.2486525078614648, -3.0319474165638383, -3.091934462388366, 1.7493438969055717, 1.5262950460115974, 1.38690101603666, -91.32582581043243, -101.64089238643646, -89.10452099889517, -3.83638719717662, -3.812619658807918, -3.9167838046948162, -1.2410060117642132, -1.391102130214378, -0.7329042709122149, -19.36500573903323, -19.288471437990673, -19.55166710913182, 0.7317043443520816, 0.47690000136692845, 0.716604625185326, -0.17728646099567413, -0.34713250398635864, -0.2858966290950775, -3.683694154024124, -4.032563269138336, -3.836824893951416, -106.24028803904852, -95.51090421279272, -97.08666892846426, -101.97123574217161, -111.49528974791369, -101.15277765442929, 7.1398526902000015, 6.916570189098508, 6.441126252214104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14736993850706123, "mean_inference_ms": 0.6323402316880243, "mean_action_processing_ms": 0.09267055643459314, "mean_env_wait_ms": 0.7648969979562317, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 120000, "timesteps_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"sample_time_ms": 9869.461, "sample_throughput": 506.613, "load_time_ms": 0.1, "load_throughput": 50003624.225, "learn_time_ms": 1507.751, "learn_throughput": 3316.197, "update_time_ms": 7.015}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0005000000000000001, "total_loss": 235.163720703125, "policy_loss": -0.0023495304891622327, "vf_loss": 235.21737518310547, "vf_explained_var": 0.0360161304473877, "kl": 0.003681576756938418, "entropy": 5.130851602554321, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 360000, "num_steps_trained": 120000, "num_agent_steps_trained": 360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1045, "training_iteration": 24, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-13-09", "timestamp": 1706227989, "time_this_iter_s": 10.119390487670898, "time_total_s": 234.01097416877747, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824924C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 234.01097416877747, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 6.478571428571428, "ram_util_percent": 52.92857142857142}}
{"episode_reward_max": 24.137328326702104, "episode_reward_min": -348.7094454020262, "episode_reward_mean": -196.50069685439928, "episode_len_mean": 239.24, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -126.5179133017858}, "policy_reward_max": {"shared_policy": 8.258230594297245}, "policy_reward_mean": {"shared_policy": -65.50023228479976}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-289.26571746915585, -301.8936101049185, -28.815266598016038, 24.137328326702104, -311.8033947944641, -334.4299926608801, 3.367823816835852, -288.8689662106335, -21.974609043449163, -37.117539726197734, -318.71910628676414, -293.45276037603617, -319.45281903445726, -316.9693494141102, -348.7094454020262, -49.88633207604289, -329.26356878876686, -20.34738093614581, -316.0324397981167, -326.81099078804255, -317.7637200392783, -303.1765479296446, -13.96556057780981, -314.9383474960923, -302.4601132199168, -14.674311548471465, -313.255544885993, -305.8018208760768, -303.2880765199661, -327.698292568326, -284.7302292138338, -308.7217565852916, -315.30639111995697, -15.317639611661448, -313.9740831553936, -311.0759957255796, -345.1822384893894, -305.5583492964506, -285.1569755077362, -13.86901562660934, -313.4927310273051, -324.1718710064888, -315.75452610850334, -310.02853763103485, -292.67004658281803, -31.11551511287692, 19.386113330721827, -309.3238830268383, -323.70962512493134, -304.6841654330492, -303.26691004633904, -35.54726823419334, -11.183522358536734, -306.22998274862766, -37.769713297486334, -309.12316501140594, -42.76665835827589, -304.8494642227888, -343.2136472761631, -27.5003425627947, 2.804852936416836, 12.012778356671333, -313.49119071662426, -15.528365038335323, -310.7228942960501, -313.7810886949301, -319.70578472316265, -295.0059901624918, -310.5528226941824, -310.7026413157582, -306.7403821796179, -302.1532530188561, -9.372534386813669, 4.662539958953829, -282.07123919576406, -11.565790660679355, -3.365012412890806, -58.20514428615572, 1.925208970904336, -0.8103155940771103, -11.553082317113876, -298.8378611803055, -314.61930314451456, 20.497549131512613, -17.48337721824646, -319.6274030506611, -24.209391444921508, -319.4885724633932, -20.953392587602167, -330.4477243423462, -19.40482360869649, -318.2082985639572, -347.8389357402921, -4.012444054707913, -2.3146970681846426, -11.544423837214737, -334.6478496938944, -35.852438308298616, -44.14414456486705, -283.7713930308819], "episode_lengths": [86, 96, 500, 500, 72, 62, 500, 73, 500, 500, 45, 72, 82, 53, 122, 500, 99, 500, 82, 51, 66, 66, 500, 58, 91, 500, 43, 57, 59, 65, 75, 71, 70, 500, 56, 47, 90, 63, 112, 500, 68, 70, 58, 80, 92, 500, 500, 61, 63, 55, 49, 500, 500, 66, 500, 88, 500, 42, 90, 500, 500, 500, 72, 500, 71, 62, 54, 62, 61, 95, 66, 60, 500, 500, 61, 500, 500, 500, 500, 500, 500, 99, 199, 500, 500, 110, 500, 49, 500, 54, 500, 70, 70, 500, 500, 500, 63, 500, 500, 80], "policy_shared_policy_reward": [-105.98200776179632, -91.52000513424477, -91.76370457311472, -107.62652232249579, -97.46519221862158, -96.80189556380114, -9.631764719883606, -9.238480924318239, -9.945020953814193, 8.054367137451962, 8.258230594297245, 7.8247305949528965, -98.33056790630023, -98.74241603414218, -114.73041085402171, -109.45516109466553, -119.44197177886963, -105.53285978734493, 1.2583854446808402, 1.2048482919732635, 0.9045900801817481, -105.51016815503439, -91.40589716409644, -91.95290089150271, -6.936916720122099, -7.133099392056465, -7.904592931270599, -11.64898917327325, -12.550372819105789, -12.918177733818695, -99.46380087733269, -117.0268144607544, -102.22849094867706, -106.32619939247768, -93.44528350482385, -93.68127747873466, -115.62204893430075, -102.41867031653723, -101.41209978361925, -102.46919568379721, -100.71485679348311, -113.7852969368299, -110.32364610334238, -111.86788599689802, -126.5179133017858, -16.531930074095726, -16.471107315272093, -16.88329468667507, -105.400409390529, -118.7468008597692, -105.11635853846869, -6.793194686373084, -6.742379752298206, -6.811806497474521, -101.78949982921283, -102.10664049784343, -112.13629947106044, -119.61661195755005, -103.95303091406822, -103.24134791642427, -113.79680581887564, -101.15841435765228, -102.80849986275038, -97.11868064105511, -97.00929382443428, -109.0485734641552, -4.677237585186958, -4.774965584278107, -4.513357408344746, -99.28966430574656, -101.56436109542847, -114.0843220949173, -96.5589865470926, -96.40128357211749, -109.49984310070674, -4.786152581373855, -4.838687072197601, -5.049471894900009, -113.36089166005453, -98.63705331583819, -101.25759991010031, -97.43910542068383, -110.5898874004682, -97.77282805492482, -96.84319597979388, -109.27729149659476, -97.16758904357752, -105.8405049343904, -117.29767980178198, -104.56010783215365, -102.65288980801901, -90.92090891798338, -91.15643048783144, -110.98703056573868, -99.39364425837994, -98.34108176117297, -106.62724415461223, -103.99611125389735, -104.6830357114474, -5.010187568763897, -4.9787352035443035, -5.328716839353248, -112.11004732052486, -100.28673035899799, -101.57730547587077, -98.76516940941414, -114.10456522305807, -98.20626109310737, -109.79806382457416, -110.58391455809276, -124.80026010672252, -111.65601368745169, -97.47448321183523, -96.42785239716372, -91.71567250291507, -102.57046733299892, -90.87083567182223, -4.26543826113145, -4.47260169188182, -5.130975673596069, -98.77942326913278, -112.1969642440478, -102.51634351412456, -115.8346008459727, -103.5454430381457, -104.7918271223704, -112.30825876196226, -101.7511693139871, -101.695098032554, -97.28990936279297, -113.75353538990021, -98.98509287834167, -92.19434640308222, -94.16944964726767, -106.30625053246817, -10.183124204476684, -10.395265703399986, -10.537125205000251, 6.557608472804219, 6.474051701525838, 6.35445315639177, -99.84684724609058, -110.70951972405116, -98.76751605669658, -105.44900341828665, -114.69825639327368, -103.56236531337103, -96.70658280948798, -109.48877153793971, -98.48881108562152, -108.14271530508995, -98.60976940393448, -96.5144253373146, -12.250388349095985, -11.510907384256527, -11.785972500840828, -3.793261999885246, -3.6857763479153363, -3.7044840107361523, -97.89948277175426, -97.61114224791527, -110.71935772895813, -12.541776140530914, -12.543391910692065, -12.684545246263355, -98.02054651081562, -98.48695032298565, -112.61566817760468, -14.11744298785925, -14.371303156018257, -14.277912214398384, -99.50730157395205, -100.70362706979117, -104.63853557904562, -111.02011605103812, -122.10497601826987, -110.08855520685515, -9.171930807332203, -9.062772052983448, -9.26563970247905, 0.7514631773034637, 1.0559990840653484, 0.9973906750480239, 4.014058157801628, 4.021749913692474, 3.976970285177231, -99.20079525808494, -112.59184722105663, -101.69854823748271, -5.23685060441494, -5.026927925646305, -5.264586508274078, -100.5060088634491, -111.52161687612534, -98.69526855647564, -101.0028926630815, -112.73563530047736, -100.04256073137125, -115.03299431006114, -102.42481825004022, -102.2479721630613, -106.41213892896971, -94.26762155195078, -94.32622968157133, -98.86084339519343, -111.2360466917356, -100.4559326072534, -101.24682359645765, -102.74824593464534, -106.70757178465526, -110.91879852612814, -97.27443770070872, -98.54714595278105, -99.05591162045798, -98.93367113669714, -104.16367026170096, -3.2486525078614648, -3.0319474165638383, -3.091934462388366, 1.7493438969055717, 1.5262950460115974, 1.38690101603666, -91.32582581043243, -101.64089238643646, -89.10452099889517, -3.83638719717662, -3.812619658807918, -3.9167838046948162, -1.2410060117642132, -1.391102130214378, -0.7329042709122149, -19.36500573903323, -19.288471437990673, -19.55166710913182, 0.7317043443520816, 0.47690000136692845, 0.716604625185326, -0.17728646099567413, -0.34713250398635864, -0.2858966290950775, -3.683694154024124, -4.032563269138336, -3.836824893951416, -106.24028803904852, -95.51090421279272, -97.08666892846426, -101.97123574217161, -111.49528974791369, -101.15277765442929, 7.1398526902000015, 6.916570189098508, 6.441126252214104, -5.877368718385696, -5.5229091346263885, -6.083099365234375, -115.59690779447556, -102.02173648774624, -102.0087587684393, -7.96534411857526, -7.983137297133609, -8.260910029212639, -114.00799663861594, -102.34877193470797, -103.13180389006934, -7.222193260987609, -6.8853049402435715, -6.845894386370986, -105.05688613653183, -104.8966765999794, -120.49416160583496, -6.7640922268231805, -6.256832522650569, -6.3838988592227395, -100.84981452425322, -100.93929450710615, -116.41918953259787, -110.58602624883255, -112.30490689476332, -124.94800259669623, -1.5401198615630562, -1.414065947135299, -1.058258246009558, -0.8064654444654877, -0.8093287770946915, -0.6989028466244633, -3.4602691320081647, -3.9910241862138207, -4.093130518992751, -107.97846087813377, -119.3816169500351, -107.28777186572552, -11.80171309163174, -12.144397815068572, -11.906327401598304, -14.710936566193908, -14.743525405724853, -14.689682592948287, -90.68758329749107, -102.86801165342331, -90.2157980799675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1470923337442555, "mean_inference_ms": 0.6336876835115673, "mean_action_processing_ms": 0.09300176325182109, "mean_env_wait_ms": 0.766630309245101, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 125000, "timesteps_this_iter": 0, "agent_timesteps_total": 375000, "timers": {"sample_time_ms": 9875.051, "sample_throughput": 506.327, "load_time_ms": 0.2, "load_throughput": 24998831.804, "learn_time_ms": 1507.43, "learn_throughput": 3316.904, "update_time_ms": 7.114}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0005000000000000001, "total_loss": 387.1831481933594, "policy_loss": -0.0020856619227243023, "vf_loss": 387.2364532470703, "vf_explained_var": 0.17360677123069762, "kl": 0.0046831450599744626, "entropy": 5.121115779876709, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 125000, "num_agent_steps_sampled": 375000, "num_steps_trained": 125000, "num_agent_steps_trained": 375000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1061, "training_iteration": 25, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-13-19", "timestamp": 1706227999, "time_this_iter_s": 9.547563791275024, "time_total_s": 243.5585379600525, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020280834F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 243.5585379600525, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 5.107142857142857, "ram_util_percent": 52.70714285714286}}
{"episode_reward_max": 21.221047079190598, "episode_reward_min": -348.7094454020262, "episode_reward_mean": -180.0140874473413, "episode_len_mean": 260.97, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {"shared_policy": -126.5179133017858}, "policy_reward_max": {"shared_policy": 7.592296953623489}, "policy_reward_mean": {"shared_policy": -60.004695815780444}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-316.9693494141102, -348.7094454020262, -49.88633207604289, -329.26356878876686, -20.34738093614581, -316.0324397981167, -326.81099078804255, -317.7637200392783, -303.1765479296446, -13.96556057780981, -314.9383474960923, -302.4601132199168, -14.674311548471465, -313.255544885993, -305.8018208760768, -303.2880765199661, -327.698292568326, -284.7302292138338, -308.7217565852916, -315.30639111995697, -15.317639611661448, -313.9740831553936, -311.0759957255796, -345.1822384893894, -305.5583492964506, -285.1569755077362, -13.86901562660934, -313.4927310273051, -324.1718710064888, -315.75452610850334, -310.02853763103485, -292.67004658281803, -31.11551511287692, 19.386113330721827, -309.3238830268383, -323.70962512493134, -304.6841654330492, -303.26691004633904, -35.54726823419334, -11.183522358536734, -306.22998274862766, -37.769713297486334, -309.12316501140594, -42.76665835827589, -304.8494642227888, -343.2136472761631, -27.5003425627947, 2.804852936416836, 12.012778356671333, -313.49119071662426, -15.528365038335323, -310.7228942960501, -313.7810886949301, -319.70578472316265, -295.0059901624918, -310.5528226941824, -310.7026413157582, -306.7403821796179, -302.1532530188561, -9.372534386813669, 4.662539958953829, -282.07123919576406, -11.565790660679355, -3.365012412890806, -58.20514428615572, 1.925208970904336, -0.8103155940771103, -11.553082317113876, -298.8378611803055, -314.61930314451456, 20.497549131512613, -17.48337721824646, -319.6274030506611, -24.209391444921508, -319.4885724633932, -20.953392587602167, -330.4477243423462, -19.40482360869649, -318.2082985639572, -347.8389357402921, -4.012444054707913, -2.3146970681846426, -11.544423837214737, -334.6478496938944, -35.852438308298616, -44.14414456486705, -283.7713930308819, -16.709961166605353, -6.468766130507021, -8.03705677576363, 1.6313985139131404, -309.00356052815914, -296.4308782424778, -5.097066484391689, 12.797867953777299, -265.00022091716534, 12.020666715689003, 11.241902610287056, 21.221047079190598, -21.793062083423152], "episode_lengths": [53, 122, 500, 99, 500, 82, 51, 66, 66, 500, 58, 91, 500, 43, 57, 59, 65, 75, 71, 70, 500, 56, 47, 90, 63, 112, 500, 68, 70, 58, 80, 92, 500, 500, 61, 63, 55, 49, 500, 500, 66, 500, 88, 500, 42, 90, 500, 500, 500, 72, 500, 71, 62, 54, 62, 61, 95, 66, 60, 500, 500, 61, 500, 500, 500, 500, 500, 500, 99, 199, 500, 500, 110, 500, 49, 500, 54, 500, 70, 70, 500, 500, 500, 63, 500, 500, 80, 500, 500, 500, 500, 74, 88, 500, 500, 99, 500, 500, 500, 500], "policy_shared_policy_reward": [-102.46919568379721, -100.71485679348311, -113.7852969368299, -110.32364610334238, -111.86788599689802, -126.5179133017858, -16.531930074095726, -16.471107315272093, -16.88329468667507, -105.400409390529, -118.7468008597692, -105.11635853846869, -6.793194686373084, -6.742379752298206, -6.811806497474521, -101.78949982921283, -102.10664049784343, -112.13629947106044, -119.61661195755005, -103.95303091406822, -103.24134791642427, -113.79680581887564, -101.15841435765228, -102.80849986275038, -97.11868064105511, -97.00929382443428, -109.0485734641552, -4.677237585186958, -4.774965584278107, -4.513357408344746, -99.28966430574656, -101.56436109542847, -114.0843220949173, -96.5589865470926, -96.40128357211749, -109.49984310070674, -4.786152581373855, -4.838687072197601, -5.049471894900009, -113.36089166005453, -98.63705331583819, -101.25759991010031, -97.43910542068383, -110.5898874004682, -97.77282805492482, -96.84319597979388, -109.27729149659476, -97.16758904357752, -105.8405049343904, -117.29767980178198, -104.56010783215365, -102.65288980801901, -90.92090891798338, -91.15643048783144, -110.98703056573868, -99.39364425837994, -98.34108176117297, -106.62724415461223, -103.99611125389735, -104.6830357114474, -5.010187568763897, -4.9787352035443035, -5.328716839353248, -112.11004732052486, -100.28673035899799, -101.57730547587077, -98.76516940941414, -114.10456522305807, -98.20626109310737, -109.79806382457416, -110.58391455809276, -124.80026010672252, -111.65601368745169, -97.47448321183523, -96.42785239716372, -91.71567250291507, -102.57046733299892, -90.87083567182223, -4.26543826113145, -4.47260169188182, -5.130975673596069, -98.77942326913278, -112.1969642440478, -102.51634351412456, -115.8346008459727, -103.5454430381457, -104.7918271223704, -112.30825876196226, -101.7511693139871, -101.695098032554, -97.28990936279297, -113.75353538990021, -98.98509287834167, -92.19434640308222, -94.16944964726767, -106.30625053246817, -10.183124204476684, -10.395265703399986, -10.537125205000251, 6.557608472804219, 6.474051701525838, 6.35445315639177, -99.84684724609058, -110.70951972405116, -98.76751605669658, -105.44900341828665, -114.69825639327368, -103.56236531337103, -96.70658280948798, -109.48877153793971, -98.48881108562152, -108.14271530508995, -98.60976940393448, -96.5144253373146, -12.250388349095985, -11.510907384256527, -11.785972500840828, -3.793261999885246, -3.6857763479153363, -3.7044840107361523, -97.89948277175426, -97.61114224791527, -110.71935772895813, -12.541776140530914, -12.543391910692065, -12.684545246263355, -98.02054651081562, -98.48695032298565, -112.61566817760468, -14.11744298785925, -14.371303156018257, -14.277912214398384, -99.50730157395205, -100.70362706979117, -104.63853557904562, -111.02011605103812, -122.10497601826987, -110.08855520685515, -9.171930807332203, -9.062772052983448, -9.26563970247905, 0.7514631773034637, 1.0559990840653484, 0.9973906750480239, 4.014058157801628, 4.021749913692474, 3.976970285177231, -99.20079525808494, -112.59184722105663, -101.69854823748271, -5.23685060441494, -5.026927925646305, -5.264586508274078, -100.5060088634491, -111.52161687612534, -98.69526855647564, -101.0028926630815, -112.73563530047736, -100.04256073137125, -115.03299431006114, -102.42481825004022, -102.2479721630613, -106.41213892896971, -94.26762155195078, -94.32622968157133, -98.86084339519343, -111.2360466917356, -100.4559326072534, -101.24682359645765, -102.74824593464534, -106.70757178465526, -110.91879852612814, -97.27443770070872, -98.54714595278105, -99.05591162045798, -98.93367113669714, -104.16367026170096, -3.2486525078614648, -3.0319474165638383, -3.091934462388366, 1.7493438969055717, 1.5262950460115974, 1.38690101603666, -91.32582581043243, -101.64089238643646, -89.10452099889517, -3.83638719717662, -3.812619658807918, -3.9167838046948162, -1.2410060117642132, -1.391102130214378, -0.7329042709122149, -19.36500573903323, -19.288471437990673, -19.55166710913182, 0.7317043443520816, 0.47690000136692845, 0.716604625185326, -0.17728646099567413, -0.34713250398635864, -0.2858966290950775, -3.683694154024124, -4.032563269138336, -3.836824893951416, -106.24028803904852, -95.51090421279272, -97.08666892846426, -101.97123574217161, -111.49528974791369, -101.15277765442929, 7.1398526902000015, 6.916570189098508, 6.441126252214104, -5.877368718385696, -5.5229091346263885, -6.083099365234375, -115.59690779447556, -102.02173648774624, -102.0087587684393, -7.96534411857526, -7.983137297133609, -8.260910029212639, -114.00799663861594, -102.34877193470797, -103.13180389006934, -7.222193260987609, -6.8853049402435715, -6.845894386370986, -105.05688613653183, -104.8966765999794, -120.49416160583496, -6.7640922268231805, -6.256832522650569, -6.3838988592227395, -100.84981452425322, -100.93929450710615, -116.41918953259787, -110.58602624883255, -112.30490689476332, -124.94800259669623, -1.5401198615630562, -1.414065947135299, -1.058258246009558, -0.8064654444654877, -0.8093287770946915, -0.6989028466244633, -3.4602691320081647, -3.9910241862138207, -4.093130518992751, -107.97846087813377, -119.3816169500351, -107.28777186572552, -11.80171309163174, -12.144397815068572, -11.906327401598304, -14.710936566193908, -14.743525405724853, -14.689682592948287, -90.68758329749107, -102.86801165342331, -90.2157980799675, -5.757224731147289, -5.70677126199007, -5.245965173467994, -2.298294027646392, -2.013860476513713, -2.1566116263469155, -2.8370500206947327, -2.6907422617077827, -2.5092644933611155, 0.6464416583379062, 0.4501296629508289, 0.5348271926244053, -99.20793875555198, -98.86190078655879, -110.93372098604839, -95.2360435773929, -106.97090031703314, -94.22393434805176, -1.559265412390232, -1.836588203907013, -1.7012128680944443, 4.251243037482098, 4.256590095659092, 4.290034820636109, -91.19006081422171, -86.53112406780323, -87.27903603514036, 4.138699118047953, 3.5085297375917435, 4.373437860049307, 3.6662696873148235, 3.638112639387444, 3.9375202835847887, 6.865469728906945, 6.763280396660164, 7.592296953623489, -7.131567793587848, -7.420406351486847, -7.241087938348457]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1467753930816974, "mean_inference_ms": 0.6338317586917516, "mean_action_processing_ms": 0.09306662882375596, "mean_env_wait_ms": 0.7673951533527418, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 130000, "timesteps_this_iter": 0, "agent_timesteps_total": 390000, "timers": {"sample_time_ms": 9998.78, "sample_throughput": 500.061, "load_time_ms": 0.301, "load_throughput": 16632183.361, "learn_time_ms": 1521.703, "learn_throughput": 3285.792, "update_time_ms": 7.214}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005000000000000001, "total_loss": 201.28061218261718, "policy_loss": -0.002339176908268904, "vf_loss": 201.335009765625, "vf_explained_var": 0.12781940698623656, "kl": 0.006050869805042998, "entropy": 5.206015491485596, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 130000, "num_agent_steps_sampled": 390000, "num_steps_trained": 130000, "num_agent_steps_trained": 390000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1074, "training_iteration": 26, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-13-30", "timestamp": 1706228010, "time_this_iter_s": 10.925416707992554, "time_total_s": 254.48395466804504, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028216BA60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 254.48395466804504, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 7.926666666666667, "ram_util_percent": 52.80666666666666}}
{"episode_reward_max": 21.221047079190598, "episode_reward_min": -349.91224578022957, "episode_reward_mean": -160.78613693861524, "episode_len_mean": 286.48, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {"shared_policy": -125.17068854967754}, "policy_reward_max": {"shared_policy": 7.592296953623489}, "policy_reward_mean": {"shared_policy": -53.59537897953841}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-303.2880765199661, -327.698292568326, -284.7302292138338, -308.7217565852916, -315.30639111995697, -15.317639611661448, -313.9740831553936, -311.0759957255796, -345.1822384893894, -305.5583492964506, -285.1569755077362, -13.86901562660934, -313.4927310273051, -324.1718710064888, -315.75452610850334, -310.02853763103485, -292.67004658281803, -31.11551511287692, 19.386113330721827, -309.3238830268383, -323.70962512493134, -304.6841654330492, -303.26691004633904, -35.54726823419334, -11.183522358536734, -306.22998274862766, -37.769713297486334, -309.12316501140594, -42.76665835827589, -304.8494642227888, -343.2136472761631, -27.5003425627947, 2.804852936416836, 12.012778356671333, -313.49119071662426, -15.528365038335323, -310.7228942960501, -313.7810886949301, -319.70578472316265, -295.0059901624918, -310.5528226941824, -310.7026413157582, -306.7403821796179, -302.1532530188561, -9.372534386813669, 4.662539958953829, -282.07123919576406, -11.565790660679355, -3.365012412890806, -58.20514428615572, 1.925208970904336, -0.8103155940771103, -11.553082317113876, -298.8378611803055, -314.61930314451456, 20.497549131512613, -17.48337721824646, -319.6274030506611, -24.209391444921508, -319.4885724633932, -20.953392587602167, -330.4477243423462, -19.40482360869649, -318.2082985639572, -347.8389357402921, -4.012444054707913, -2.3146970681846426, -11.544423837214737, -334.6478496938944, -35.852438308298616, -44.14414456486705, -283.7713930308819, -16.709961166605353, -6.468766130507021, -8.03705677576363, 1.6313985139131404, -309.00356052815914, -296.4308782424778, -5.097066484391689, 12.797867953777299, -265.00022091716534, 12.020666715689003, 11.241902610287056, 21.221047079190598, -21.793062083423152, -2.9345745705068254, -349.91224578022957, -2.755543127655997, -298.86523392796516, -22.11154932528737, -10.024100385606303, -20.59548858180645, -35.00322011858226, 1.0826660917373232, -317.8848005309701, -296.2019721083343, 18.099754810333252, 1.5620740726589872, -334.44719445705414, -1.2689949646592282], "episode_lengths": [59, 65, 75, 71, 70, 500, 56, 47, 90, 63, 112, 500, 68, 70, 58, 80, 92, 500, 500, 61, 63, 55, 49, 500, 500, 66, 500, 88, 500, 42, 90, 500, 500, 500, 72, 500, 71, 62, 54, 62, 61, 95, 66, 60, 500, 500, 61, 500, 500, 500, 500, 500, 500, 99, 199, 500, 500, 110, 500, 49, 500, 54, 500, 70, 70, 500, 500, 500, 63, 500, 500, 80, 500, 500, 500, 500, 74, 88, 500, 500, 99, 500, 500, 500, 500, 500, 80, 500, 67, 500, 500, 500, 500, 500, 52, 77, 500, 500, 63, 500], "policy_shared_policy_reward": [-96.84319597979388, -109.27729149659476, -97.16758904357752, -105.8405049343904, -117.29767980178198, -104.56010783215365, -102.65288980801901, -90.92090891798338, -91.15643048783144, -110.98703056573868, -99.39364425837994, -98.34108176117297, -106.62724415461223, -103.99611125389735, -104.6830357114474, -5.010187568763897, -4.9787352035443035, -5.328716839353248, -112.11004732052486, -100.28673035899799, -101.57730547587077, -98.76516940941414, -114.10456522305807, -98.20626109310737, -109.79806382457416, -110.58391455809276, -124.80026010672252, -111.65601368745169, -97.47448321183523, -96.42785239716372, -91.71567250291507, -102.57046733299892, -90.87083567182223, -4.26543826113145, -4.47260169188182, -5.130975673596069, -98.77942326913278, -112.1969642440478, -102.51634351412456, -115.8346008459727, -103.5454430381457, -104.7918271223704, -112.30825876196226, -101.7511693139871, -101.695098032554, -97.28990936279297, -113.75353538990021, -98.98509287834167, -92.19434640308222, -94.16944964726767, -106.30625053246817, -10.183124204476684, -10.395265703399986, -10.537125205000251, 6.557608472804219, 6.474051701525838, 6.35445315639177, -99.84684724609058, -110.70951972405116, -98.76751605669658, -105.44900341828665, -114.69825639327368, -103.56236531337103, -96.70658280948798, -109.48877153793971, -98.48881108562152, -108.14271530508995, -98.60976940393448, -96.5144253373146, -12.250388349095985, -11.510907384256527, -11.785972500840828, -3.793261999885246, -3.6857763479153363, -3.7044840107361523, -97.89948277175426, -97.61114224791527, -110.71935772895813, -12.541776140530914, -12.543391910692065, -12.684545246263355, -98.02054651081562, -98.48695032298565, -112.61566817760468, -14.11744298785925, -14.371303156018257, -14.277912214398384, -99.50730157395205, -100.70362706979117, -104.63853557904562, -111.02011605103812, -122.10497601826987, -110.08855520685515, -9.171930807332203, -9.062772052983448, -9.26563970247905, 0.7514631773034637, 1.0559990840653484, 0.9973906750480239, 4.014058157801628, 4.021749913692474, 3.976970285177231, -99.20079525808494, -112.59184722105663, -101.69854823748271, -5.23685060441494, -5.026927925646305, -5.264586508274078, -100.5060088634491, -111.52161687612534, -98.69526855647564, -101.0028926630815, -112.73563530047736, -100.04256073137125, -115.03299431006114, -102.42481825004022, -102.2479721630613, -106.41213892896971, -94.26762155195078, -94.32622968157133, -98.86084339519343, -111.2360466917356, -100.4559326072534, -101.24682359645765, -102.74824593464534, -106.70757178465526, -110.91879852612814, -97.27443770070872, -98.54714595278105, -99.05591162045798, -98.93367113669714, -104.16367026170096, -3.2486525078614648, -3.0319474165638383, -3.091934462388366, 1.7493438969055717, 1.5262950460115974, 1.38690101603666, -91.32582581043243, -101.64089238643646, -89.10452099889517, -3.83638719717662, -3.812619658807918, -3.9167838046948162, -1.2410060117642132, -1.391102130214378, -0.7329042709122149, -19.36500573903323, -19.288471437990673, -19.55166710913182, 0.7317043443520816, 0.47690000136692845, 0.716604625185326, -0.17728646099567413, -0.34713250398635864, -0.2858966290950775, -3.683694154024124, -4.032563269138336, -3.836824893951416, -106.24028803904852, -95.51090421279272, -97.08666892846426, -101.97123574217161, -111.49528974791369, -101.15277765442929, 7.1398526902000015, 6.916570189098508, 6.441126252214104, -5.877368718385696, -5.5229091346263885, -6.083099365234375, -115.59690779447556, -102.02173648774624, -102.0087587684393, -7.96534411857526, -7.983137297133609, -8.260910029212639, -114.00799663861594, -102.34877193470797, -103.13180389006934, -7.222193260987609, -6.8853049402435715, -6.845894386370986, -105.05688613653183, -104.8966765999794, -120.49416160583496, -6.7640922268231805, -6.256832522650569, -6.3838988592227395, -100.84981452425322, -100.93929450710615, -116.41918953259787, -110.58602624883255, -112.30490689476332, -124.94800259669623, -1.5401198615630562, -1.414065947135299, -1.058258246009558, -0.8064654444654877, -0.8093287770946915, -0.6989028466244633, -3.4602691320081647, -3.9910241862138207, -4.093130518992751, -107.97846087813377, -119.3816169500351, -107.28777186572552, -11.80171309163174, -12.144397815068572, -11.906327401598304, -14.710936566193908, -14.743525405724853, -14.689682592948287, -90.68758329749107, -102.86801165342331, -90.2157980799675, -5.757224731147289, -5.70677126199007, -5.245965173467994, -2.298294027646392, -2.013860476513713, -2.1566116263469155, -2.8370500206947327, -2.6907422617077827, -2.5092644933611155, 0.6464416583379062, 0.4501296629508289, 0.5348271926244053, -99.20793875555198, -98.86190078655879, -110.93372098604839, -95.2360435773929, -106.97090031703314, -94.22393434805176, -1.559265412390232, -1.836588203907013, -1.7012128680944443, 4.251243037482098, 4.256590095659092, 4.290034820636109, -91.19006081422171, -86.53112406780323, -87.27903603514036, 4.138699118047953, 3.5085297375917435, 4.373437860049307, 3.6662696873148235, 3.638112639387444, 3.9375202835847887, 6.865469728906945, 6.763280396660164, 7.592296953623489, -7.131567793587848, -7.420406351486847, -7.241087938348457, -0.9689490968982426, -1.141699227193996, -0.8239262464145867, -111.97851605216663, -125.17068854967754, -112.76304117838542, -0.9175452912847248, -1.008344138662025, -0.8296536977092472, -107.25012336174647, -95.88575337330501, -95.7293571929137, -7.1159190510710175, -7.647363712390273, -7.34826656182608, -3.2673075894514767, -3.25958100209634, -3.4972117940584866, -6.763581489523261, -6.559972414126008, -7.27193467815718, -11.58934609840314, -11.66421001652877, -11.749664003650352, 0.05005732675392949, 0.8692646897009837, 0.16334407528241002, -101.2015079036355, -101.260174036026, -115.4231185913086, -106.01675432920456, -95.11661593616009, -95.06860184296966, 5.942389786243439, 5.88970173895359, 6.267663285136223, 0.08705421785512613, 0.8062224412957733, 0.6687974135080879, -106.77084027727446, -119.93456705411276, -107.74178712566695, -0.19402694205443538, -0.3476213688651768, -0.727346653739616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14675140755227806, "mean_inference_ms": 0.6351018572445564, "mean_action_processing_ms": 0.09294175308623162, "mean_env_wait_ms": 0.768915628232476, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 135000, "timesteps_this_iter": 0, "agent_timesteps_total": 405000, "timers": {"sample_time_ms": 10130.35, "sample_throughput": 493.566, "load_time_ms": 0.301, "load_throughput": 16632183.361, "learn_time_ms": 1537.076, "learn_throughput": 3252.929, "update_time_ms": 7.42}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005000000000000001, "total_loss": 319.5774719238281, "policy_loss": -0.0020422442521170424, "vf_loss": 319.6334930419922, "vf_explained_var": 0.1649347186088562, "kl": 0.004900305674530685, "entropy": 5.398144865036011, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 135000, "num_agent_steps_sampled": 405000, "num_steps_trained": 135000, "num_agent_steps_trained": 405000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1089, "training_iteration": 27, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-13-41", "timestamp": 1706228021, "time_this_iter_s": 10.869544267654419, "time_total_s": 265.35349893569946, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824D0940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 265.35349893569946, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 8.993749999999999, "ram_util_percent": 52.849999999999994}}
{"episode_reward_max": 21.221047079190598, "episode_reward_min": -349.91224578022957, "episode_reward_mean": -148.82637459353427, "episode_len_mean": 304.99, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"shared_policy": -125.17068854967754}, "policy_reward_max": {"shared_policy": 7.592296953623489}, "policy_reward_mean": {"shared_policy": -49.60879153117809}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-292.67004658281803, -31.11551511287692, 19.386113330721827, -309.3238830268383, -323.70962512493134, -304.6841654330492, -303.26691004633904, -35.54726823419334, -11.183522358536734, -306.22998274862766, -37.769713297486334, -309.12316501140594, -42.76665835827589, -304.8494642227888, -343.2136472761631, -27.5003425627947, 2.804852936416836, 12.012778356671333, -313.49119071662426, -15.528365038335323, -310.7228942960501, -313.7810886949301, -319.70578472316265, -295.0059901624918, -310.5528226941824, -310.7026413157582, -306.7403821796179, -302.1532530188561, -9.372534386813669, 4.662539958953829, -282.07123919576406, -11.565790660679355, -3.365012412890806, -58.20514428615572, 1.925208970904336, -0.8103155940771103, -11.553082317113876, -298.8378611803055, -314.61930314451456, 20.497549131512613, -17.48337721824646, -319.6274030506611, -24.209391444921508, -319.4885724633932, -20.953392587602167, -330.4477243423462, -19.40482360869649, -318.2082985639572, -347.8389357402921, -4.012444054707913, -2.3146970681846426, -11.544423837214737, -334.6478496938944, -35.852438308298616, -44.14414456486705, -283.7713930308819, -16.709961166605353, -6.468766130507021, -8.03705677576363, 1.6313985139131404, -309.00356052815914, -296.4308782424778, -5.097066484391689, 12.797867953777299, -265.00022091716534, 12.020666715689003, 11.241902610287056, 21.221047079190598, -21.793062083423152, -2.9345745705068254, -349.91224578022957, -2.755543127655997, -298.86523392796516, -22.11154932528737, -10.024100385606303, -20.59548858180645, -35.00322011858226, 1.0826660917373232, -317.8848005309701, -296.2019721083343, 18.099754810333252, 1.5620740726589872, -334.44719445705414, -1.2689949646592282, 20.963289674371453, -41.0087131485343, -289.65599060058594, -277.2608275152743, -323.34556510299444, -17.936933055520086, -46.21655189245941, -317.47479367256165, -319.16326424479485, -320.3872296512127, -303.8170532584191, -297.798567250371, -324.5208715200424, -21.986288875341444, -0.39411170035603504, -317.34700287133455], "episode_lengths": [92, 500, 500, 61, 63, 55, 49, 500, 500, 66, 500, 88, 500, 42, 90, 500, 500, 500, 72, 500, 71, 62, 54, 62, 61, 95, 66, 60, 500, 500, 61, 500, 500, 500, 500, 500, 500, 99, 199, 500, 500, 110, 500, 49, 500, 54, 500, 70, 70, 500, 500, 500, 63, 500, 500, 80, 500, 500, 500, 500, 74, 88, 500, 500, 99, 500, 500, 500, 500, 500, 80, 500, 67, 500, 500, 500, 500, 500, 52, 77, 500, 500, 63, 500, 500, 500, 69, 78, 93, 500, 500, 60, 71, 72, 170, 93, 68, 500, 500, 61], "policy_shared_policy_reward": [-92.19434640308222, -94.16944964726767, -106.30625053246817, -10.183124204476684, -10.395265703399986, -10.537125205000251, 6.557608472804219, 6.474051701525838, 6.35445315639177, -99.84684724609058, -110.70951972405116, -98.76751605669658, -105.44900341828665, -114.69825639327368, -103.56236531337103, -96.70658280948798, -109.48877153793971, -98.48881108562152, -108.14271530508995, -98.60976940393448, -96.5144253373146, -12.250388349095985, -11.510907384256527, -11.785972500840828, -3.793261999885246, -3.6857763479153363, -3.7044840107361523, -97.89948277175426, -97.61114224791527, -110.71935772895813, -12.541776140530914, -12.543391910692065, -12.684545246263355, -98.02054651081562, -98.48695032298565, -112.61566817760468, -14.11744298785925, -14.371303156018257, -14.277912214398384, -99.50730157395205, -100.70362706979117, -104.63853557904562, -111.02011605103812, -122.10497601826987, -110.08855520685515, -9.171930807332203, -9.062772052983448, -9.26563970247905, 0.7514631773034637, 1.0559990840653484, 0.9973906750480239, 4.014058157801628, 4.021749913692474, 3.976970285177231, -99.20079525808494, -112.59184722105663, -101.69854823748271, -5.23685060441494, -5.026927925646305, -5.264586508274078, -100.5060088634491, -111.52161687612534, -98.69526855647564, -101.0028926630815, -112.73563530047736, -100.04256073137125, -115.03299431006114, -102.42481825004022, -102.2479721630613, -106.41213892896971, -94.26762155195078, -94.32622968157133, -98.86084339519343, -111.2360466917356, -100.4559326072534, -101.24682359645765, -102.74824593464534, -106.70757178465526, -110.91879852612814, -97.27443770070872, -98.54714595278105, -99.05591162045798, -98.93367113669714, -104.16367026170096, -3.2486525078614648, -3.0319474165638383, -3.091934462388366, 1.7493438969055717, 1.5262950460115974, 1.38690101603666, -91.32582581043243, -101.64089238643646, -89.10452099889517, -3.83638719717662, -3.812619658807918, -3.9167838046948162, -1.2410060117642132, -1.391102130214378, -0.7329042709122149, -19.36500573903323, -19.288471437990673, -19.55166710913182, 0.7317043443520816, 0.47690000136692845, 0.716604625185326, -0.17728646099567413, -0.34713250398635864, -0.2858966290950775, -3.683694154024124, -4.032563269138336, -3.836824893951416, -106.24028803904852, -95.51090421279272, -97.08666892846426, -101.97123574217161, -111.49528974791369, -101.15277765442929, 7.1398526902000015, 6.916570189098508, 6.441126252214104, -5.877368718385696, -5.5229091346263885, -6.083099365234375, -115.59690779447556, -102.02173648774624, -102.0087587684393, -7.96534411857526, -7.983137297133609, -8.260910029212639, -114.00799663861594, -102.34877193470797, -103.13180389006934, -7.222193260987609, -6.8853049402435715, -6.845894386370986, -105.05688613653183, -104.8966765999794, -120.49416160583496, -6.7640922268231805, -6.256832522650569, -6.3838988592227395, -100.84981452425322, -100.93929450710615, -116.41918953259787, -110.58602624883255, -112.30490689476332, -124.94800259669623, -1.5401198615630562, -1.414065947135299, -1.058258246009558, -0.8064654444654877, -0.8093287770946915, -0.6989028466244633, -3.4602691320081647, -3.9910241862138207, -4.093130518992751, -107.97846087813377, -119.3816169500351, -107.28777186572552, -11.80171309163174, -12.144397815068572, -11.906327401598304, -14.710936566193908, -14.743525405724853, -14.689682592948287, -90.68758329749107, -102.86801165342331, -90.2157980799675, -5.757224731147289, -5.70677126199007, -5.245965173467994, -2.298294027646392, -2.013860476513713, -2.1566116263469155, -2.8370500206947327, -2.6907422617077827, -2.5092644933611155, 0.6464416583379062, 0.4501296629508289, 0.5348271926244053, -99.20793875555198, -98.86190078655879, -110.93372098604839, -95.2360435773929, -106.97090031703314, -94.22393434805176, -1.559265412390232, -1.836588203907013, -1.7012128680944443, 4.251243037482098, 4.256590095659092, 4.290034820636109, -91.19006081422171, -86.53112406780323, -87.27903603514036, 4.138699118047953, 3.5085297375917435, 4.373437860049307, 3.6662696873148235, 3.638112639387444, 3.9375202835847887, 6.865469728906945, 6.763280396660164, 7.592296953623489, -7.131567793587848, -7.420406351486847, -7.241087938348457, -0.9689490968982426, -1.141699227193996, -0.8239262464145867, -111.97851605216663, -125.17068854967754, -112.76304117838542, -0.9175452912847248, -1.008344138662025, -0.8296536977092472, -107.25012336174647, -95.88575337330501, -95.7293571929137, -7.1159190510710175, -7.647363712390273, -7.34826656182608, -3.2673075894514767, -3.25958100209634, -3.4972117940584866, -6.763581489523261, -6.559972414126008, -7.27193467815718, -11.58934609840314, -11.66421001652877, -11.749664003650352, 0.05005732675392949, 0.8692646897009837, 0.16334407528241002, -101.2015079036355, -101.260174036026, -115.4231185913086, -106.01675432920456, -95.11661593616009, -95.06860184296966, 5.942389786243439, 5.88970173895359, 6.267663285136223, 0.08705421785512613, 0.8062224412957733, 0.6687974135080879, -106.77084027727446, -119.93456705411276, -107.74178712566695, -0.19402694205443538, -0.3476213688651768, -0.727346653739616, 7.103498345861823, 6.952087479333073, 6.907703849176556, -13.427439026534557, -13.394340008497238, -14.186934113502502, -91.948149005572, -103.13477108875911, -94.57307050625484, -90.00112374623617, -100.13735284407935, -87.1223509249588, -103.58848022172849, -104.37095319728057, -115.3861316839854, -5.578718153138965, -5.6460491990049775, -6.712165703376144, -15.360754656294986, -15.511617812017604, -15.344179424146816, -101.66146264473598, -113.16073761383693, -102.65259341398875, -104.56991177797318, -104.61484816670418, -109.97850430011749, -104.20495372017226, -107.34540935357413, -108.83686657746634, -97.03218578298888, -98.3203998108705, -108.46446766455969, -108.20496461788814, -95.34192449847858, -94.25167813400428, -104.60008716583252, -115.90450918674469, -104.01627516746521, -7.556936119993537, -7.477890824278205, -6.9514619310697014, -0.1334296216567452, -0.045484272142260807, -0.21519780655702903, -101.4426173468431, -116.21218653519949, -99.692198989292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1463600534196917, "mean_inference_ms": 0.6373350513434466, "mean_action_processing_ms": 0.09337869175739467, "mean_env_wait_ms": 0.7713999031416092, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 140000, "timesteps_this_iter": 0, "agent_timesteps_total": 420000, "timers": {"sample_time_ms": 10179.569, "sample_throughput": 491.18, "load_time_ms": 0.301, "load_throughput": 16632183.361, "learn_time_ms": 1549.375, "learn_throughput": 3227.109, "update_time_ms": 7.42}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005000000000000001, "total_loss": 553.0758544921875, "policy_loss": -0.002238546190184243, "vf_loss": 553.1330444335938, "vf_explained_var": 0.19221192598342896, "kl": 0.0037743497727234718, "entropy": 5.494857549667358, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 140000, "num_agent_steps_sampled": 420000, "num_steps_trained": 140000, "num_agent_steps_trained": 420000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1105, "training_iteration": 28, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-13-51", "timestamp": 1706228031, "time_this_iter_s": 10.335221529006958, "time_total_s": 275.6887204647064, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028457FB80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 275.6887204647064, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 6.507142857142858, "ram_util_percent": 53.00714285714287}}
{"episode_reward_max": 21.221047079190598, "episode_reward_min": -349.91224578022957, "episode_reward_mean": -136.95664402694325, "episode_len_mean": 323.36, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {"shared_policy": -125.17068854967754}, "policy_reward_max": {"shared_policy": 7.592296953623489}, "policy_reward_mean": {"shared_policy": -45.65221467564776}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-304.8494642227888, -343.2136472761631, -27.5003425627947, 2.804852936416836, 12.012778356671333, -313.49119071662426, -15.528365038335323, -310.7228942960501, -313.7810886949301, -319.70578472316265, -295.0059901624918, -310.5528226941824, -310.7026413157582, -306.7403821796179, -302.1532530188561, -9.372534386813669, 4.662539958953829, -282.07123919576406, -11.565790660679355, -3.365012412890806, -58.20514428615572, 1.925208970904336, -0.8103155940771103, -11.553082317113876, -298.8378611803055, -314.61930314451456, 20.497549131512613, -17.48337721824646, -319.6274030506611, -24.209391444921508, -319.4885724633932, -20.953392587602167, -330.4477243423462, -19.40482360869649, -318.2082985639572, -347.8389357402921, -4.012444054707913, -2.3146970681846426, -11.544423837214737, -334.6478496938944, -35.852438308298616, -44.14414456486705, -283.7713930308819, -16.709961166605353, -6.468766130507021, -8.03705677576363, 1.6313985139131404, -309.00356052815914, -296.4308782424778, -5.097066484391689, 12.797867953777299, -265.00022091716534, 12.020666715689003, 11.241902610287056, 21.221047079190598, -21.793062083423152, -2.9345745705068254, -349.91224578022957, -2.755543127655997, -298.86523392796516, -22.11154932528737, -10.024100385606303, -20.59548858180645, -35.00322011858226, 1.0826660917373232, -317.8848005309701, -296.2019721083343, 18.099754810333252, 1.5620740726589872, -334.44719445705414, -1.2689949646592282, 20.963289674371453, -41.0087131485343, -289.65599060058594, -277.2608275152743, -323.34556510299444, -17.936933055520086, -46.21655189245941, -317.47479367256165, -319.16326424479485, -320.3872296512127, -303.8170532584191, -297.798567250371, -324.5208715200424, -21.986288875341444, -0.39411170035603504, -317.34700287133455, -21.38066230714321, -11.89517195522788, -12.643621500581503, -57.4459203630686, -309.7028592824936, -1.8693109825253487, -59.16956044733526, -29.276198126375675, 5.509060308337212, -265.4164123944938, -56.29466854035855, -0.2370099499821663, -281.20894980430603], "episode_lengths": [42, 90, 500, 500, 500, 72, 500, 71, 62, 54, 62, 61, 95, 66, 60, 500, 500, 61, 500, 500, 500, 500, 500, 500, 99, 199, 500, 500, 110, 500, 49, 500, 54, 500, 70, 70, 500, 500, 500, 63, 500, 500, 80, 500, 500, 500, 500, 74, 88, 500, 500, 99, 500, 500, 500, 500, 500, 80, 500, 67, 500, 500, 500, 500, 500, 52, 77, 500, 500, 63, 500, 500, 500, 69, 78, 93, 500, 500, 60, 71, 72, 170, 93, 68, 500, 500, 61, 500, 500, 500, 500, 72, 500, 500, 500, 500, 163, 500, 500, 76], "policy_shared_policy_reward": [-99.50730157395205, -100.70362706979117, -104.63853557904562, -111.02011605103812, -122.10497601826987, -110.08855520685515, -9.171930807332203, -9.062772052983448, -9.26563970247905, 0.7514631773034637, 1.0559990840653484, 0.9973906750480239, 4.014058157801628, 4.021749913692474, 3.976970285177231, -99.20079525808494, -112.59184722105663, -101.69854823748271, -5.23685060441494, -5.026927925646305, -5.264586508274078, -100.5060088634491, -111.52161687612534, -98.69526855647564, -101.0028926630815, -112.73563530047736, -100.04256073137125, -115.03299431006114, -102.42481825004022, -102.2479721630613, -106.41213892896971, -94.26762155195078, -94.32622968157133, -98.86084339519343, -111.2360466917356, -100.4559326072534, -101.24682359645765, -102.74824593464534, -106.70757178465526, -110.91879852612814, -97.27443770070872, -98.54714595278105, -99.05591162045798, -98.93367113669714, -104.16367026170096, -3.2486525078614648, -3.0319474165638383, -3.091934462388366, 1.7493438969055717, 1.5262950460115974, 1.38690101603666, -91.32582581043243, -101.64089238643646, -89.10452099889517, -3.83638719717662, -3.812619658807918, -3.9167838046948162, -1.2410060117642132, -1.391102130214378, -0.7329042709122149, -19.36500573903323, -19.288471437990673, -19.55166710913182, 0.7317043443520816, 0.47690000136692845, 0.716604625185326, -0.17728646099567413, -0.34713250398635864, -0.2858966290950775, -3.683694154024124, -4.032563269138336, -3.836824893951416, -106.24028803904852, -95.51090421279272, -97.08666892846426, -101.97123574217161, -111.49528974791369, -101.15277765442929, 7.1398526902000015, 6.916570189098508, 6.441126252214104, -5.877368718385696, -5.5229091346263885, -6.083099365234375, -115.59690779447556, -102.02173648774624, -102.0087587684393, -7.96534411857526, -7.983137297133609, -8.260910029212639, -114.00799663861594, -102.34877193470797, -103.13180389006934, -7.222193260987609, -6.8853049402435715, -6.845894386370986, -105.05688613653183, -104.8966765999794, -120.49416160583496, -6.7640922268231805, -6.256832522650569, -6.3838988592227395, -100.84981452425322, -100.93929450710615, -116.41918953259787, -110.58602624883255, -112.30490689476332, -124.94800259669623, -1.5401198615630562, -1.414065947135299, -1.058258246009558, -0.8064654444654877, -0.8093287770946915, -0.6989028466244633, -3.4602691320081647, -3.9910241862138207, -4.093130518992751, -107.97846087813377, -119.3816169500351, -107.28777186572552, -11.80171309163174, -12.144397815068572, -11.906327401598304, -14.710936566193908, -14.743525405724853, -14.689682592948287, -90.68758329749107, -102.86801165342331, -90.2157980799675, -5.757224731147289, -5.70677126199007, -5.245965173467994, -2.298294027646392, -2.013860476513713, -2.1566116263469155, -2.8370500206947327, -2.6907422617077827, -2.5092644933611155, 0.6464416583379062, 0.4501296629508289, 0.5348271926244053, -99.20793875555198, -98.86190078655879, -110.93372098604839, -95.2360435773929, -106.97090031703314, -94.22393434805176, -1.559265412390232, -1.836588203907013, -1.7012128680944443, 4.251243037482098, 4.256590095659092, 4.290034820636109, -91.19006081422171, -86.53112406780323, -87.27903603514036, 4.138699118047953, 3.5085297375917435, 4.373437860049307, 3.6662696873148235, 3.638112639387444, 3.9375202835847887, 6.865469728906945, 6.763280396660164, 7.592296953623489, -7.131567793587848, -7.420406351486847, -7.241087938348457, -0.9689490968982426, -1.141699227193996, -0.8239262464145867, -111.97851605216663, -125.17068854967754, -112.76304117838542, -0.9175452912847248, -1.008344138662025, -0.8296536977092472, -107.25012336174647, -95.88575337330501, -95.7293571929137, -7.1159190510710175, -7.647363712390273, -7.34826656182608, -3.2673075894514767, -3.25958100209634, -3.4972117940584866, -6.763581489523261, -6.559972414126008, -7.27193467815718, -11.58934609840314, -11.66421001652877, -11.749664003650352, 0.05005732675392949, 0.8692646897009837, 0.16334407528241002, -101.2015079036355, -101.260174036026, -115.4231185913086, -106.01675432920456, -95.11661593616009, -95.06860184296966, 5.942389786243439, 5.88970173895359, 6.267663285136223, 0.08705421785512613, 0.8062224412957733, 0.6687974135080879, -106.77084027727446, -119.93456705411276, -107.74178712566695, -0.19402694205443538, -0.3476213688651768, -0.727346653739616, 7.103498345861823, 6.952087479333073, 6.907703849176556, -13.427439026534557, -13.394340008497238, -14.186934113502502, -91.948149005572, -103.13477108875911, -94.57307050625484, -90.00112374623617, -100.13735284407935, -87.1223509249588, -103.58848022172849, -104.37095319728057, -115.3861316839854, -5.578718153138965, -5.6460491990049775, -6.712165703376144, -15.360754656294986, -15.511617812017604, -15.344179424146816, -101.66146264473598, -113.16073761383693, -102.65259341398875, -104.56991177797318, -104.61484816670418, -109.97850430011749, -104.20495372017226, -107.34540935357413, -108.83686657746634, -97.03218578298888, -98.3203998108705, -108.46446766455969, -108.20496461788814, -95.34192449847858, -94.25167813400428, -104.60008716583252, -115.90450918674469, -104.01627516746521, -7.556936119993537, -7.477890824278205, -6.9514619310697014, -0.1334296216567452, -0.045484272142260807, -0.21519780655702903, -101.4426173468431, -116.21218653519949, -99.692198989292, -7.567373558878899, -7.0938088819384575, -6.719479866325855, -3.8945833568771775, -4.054194649060577, -3.946393949290126, -4.370614759624004, -4.181326761841774, -4.091679979115725, -19.10663457959891, -19.086036704480655, -19.253249078989036, -99.27671896417937, -100.2209495206674, -110.20519079764685, -0.6650068312883377, -0.5441101714968681, -0.6601939797401428, -19.25746137897174, -19.43185629944007, -20.480242768923446, -9.833820641040802, -9.367198713123798, -10.075178772211075, 1.5975876599550247, 2.1938826590776443, 1.7175899893045425, -85.36195149769387, -94.86276418094835, -85.19169671585163, -18.692455043395363, -18.606308897336326, -18.99590459962686, 0.15053842961788177, 0.27799055725336075, -0.6655389368534088, -101.46808419624965, -90.42449061075847, -89.31637499729793]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1461658587879912, "mean_inference_ms": 0.6377957103678298, "mean_action_processing_ms": 0.09338227043870921, "mean_env_wait_ms": 0.7724431358559137, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 145000, "timesteps_this_iter": 0, "agent_timesteps_total": 435000, "timers": {"sample_time_ms": 10229.527, "sample_throughput": 488.781, "load_time_ms": 0.301, "load_throughput": 16632183.361, "learn_time_ms": 1553.942, "learn_throughput": 3217.622, "update_time_ms": 7.393}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005000000000000001, "total_loss": 206.22855377197266, "policy_loss": -0.0020053520543749314, "vf_loss": 206.28580017089843, "vf_explained_var": 0.14426643252372742, "kl": 0.004670020961205466, "entropy": 5.52440037727356, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 145000, "num_agent_steps_sampled": 435000, "num_steps_trained": 145000, "num_agent_steps_trained": 435000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1118, "training_iteration": 29, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-14-01", "timestamp": 1706228041, "time_this_iter_s": 9.931337833404541, "time_total_s": 285.62005829811096, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028453C8B0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 285.62005829811096, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 8.114285714285716, "ram_util_percent": 53.021428571428565}}
{"episode_reward_max": 21.221047079190598, "episode_reward_min": -349.91224578022957, "episode_reward_mean": -121.26482448971714, "episode_len_mean": 345.6, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -125.17068854967754}, "policy_reward_max": {"shared_policy": 7.592296953623489}, "policy_reward_mean": {"shared_policy": -40.42160816323905}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-310.5528226941824, -310.7026413157582, -306.7403821796179, -302.1532530188561, -9.372534386813669, 4.662539958953829, -282.07123919576406, -11.565790660679355, -3.365012412890806, -58.20514428615572, 1.925208970904336, -0.8103155940771103, -11.553082317113876, -298.8378611803055, -314.61930314451456, 20.497549131512613, -17.48337721824646, -319.6274030506611, -24.209391444921508, -319.4885724633932, -20.953392587602167, -330.4477243423462, -19.40482360869649, -318.2082985639572, -347.8389357402921, -4.012444054707913, -2.3146970681846426, -11.544423837214737, -334.6478496938944, -35.852438308298616, -44.14414456486705, -283.7713930308819, -16.709961166605353, -6.468766130507021, -8.03705677576363, 1.6313985139131404, -309.00356052815914, -296.4308782424778, -5.097066484391689, 12.797867953777299, -265.00022091716534, 12.020666715689003, 11.241902610287056, 21.221047079190598, -21.793062083423152, -2.9345745705068254, -349.91224578022957, -2.755543127655997, -298.86523392796516, -22.11154932528737, -10.024100385606303, -20.59548858180645, -35.00322011858226, 1.0826660917373232, -317.8848005309701, -296.2019721083343, 18.099754810333252, 1.5620740726589872, -334.44719445705414, -1.2689949646592282, 20.963289674371453, -41.0087131485343, -289.65599060058594, -277.2608275152743, -323.34556510299444, -17.936933055520086, -46.21655189245941, -317.47479367256165, -319.16326424479485, -320.3872296512127, -303.8170532584191, -297.798567250371, -324.5208715200424, -21.986288875341444, -0.39411170035603504, -317.34700287133455, -21.38066230714321, -11.89517195522788, -12.643621500581503, -57.4459203630686, -309.7028592824936, -1.8693109825253487, -59.16956044733526, -29.276198126375675, 5.509060308337212, -265.4164123944938, -56.29466854035855, -0.2370099499821663, -281.20894980430603, -279.216969512403, -7.1731265485286855, -54.430396690964706, 7.269128426909447, 2.8420950248837187, -7.02491501532495, -323.40672293305397, 1.0633631050586558, 14.992212221026392, -22.384833369404106, 7.67098261415957], "episode_lengths": [61, 95, 66, 60, 500, 500, 61, 500, 500, 500, 500, 500, 500, 99, 199, 500, 500, 110, 500, 49, 500, 54, 500, 70, 70, 500, 500, 500, 63, 500, 500, 80, 500, 500, 500, 500, 74, 88, 500, 500, 99, 500, 500, 500, 500, 500, 80, 500, 67, 500, 500, 500, 500, 500, 52, 77, 500, 500, 63, 500, 500, 500, 69, 78, 93, 500, 500, 60, 71, 72, 170, 93, 68, 500, 500, 61, 500, 500, 500, 500, 72, 500, 500, 500, 500, 163, 500, 500, 76, 102, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500], "policy_shared_policy_reward": [-98.86084339519343, -111.2360466917356, -100.4559326072534, -101.24682359645765, -102.74824593464534, -106.70757178465526, -110.91879852612814, -97.27443770070872, -98.54714595278105, -99.05591162045798, -98.93367113669714, -104.16367026170096, -3.2486525078614648, -3.0319474165638383, -3.091934462388366, 1.7493438969055717, 1.5262950460115974, 1.38690101603666, -91.32582581043243, -101.64089238643646, -89.10452099889517, -3.83638719717662, -3.812619658807918, -3.9167838046948162, -1.2410060117642132, -1.391102130214378, -0.7329042709122149, -19.36500573903323, -19.288471437990673, -19.55166710913182, 0.7317043443520816, 0.47690000136692845, 0.716604625185326, -0.17728646099567413, -0.34713250398635864, -0.2858966290950775, -3.683694154024124, -4.032563269138336, -3.836824893951416, -106.24028803904852, -95.51090421279272, -97.08666892846426, -101.97123574217161, -111.49528974791369, -101.15277765442929, 7.1398526902000015, 6.916570189098508, 6.441126252214104, -5.877368718385696, -5.5229091346263885, -6.083099365234375, -115.59690779447556, -102.02173648774624, -102.0087587684393, -7.96534411857526, -7.983137297133609, -8.260910029212639, -114.00799663861594, -102.34877193470797, -103.13180389006934, -7.222193260987609, -6.8853049402435715, -6.845894386370986, -105.05688613653183, -104.8966765999794, -120.49416160583496, -6.7640922268231805, -6.256832522650569, -6.3838988592227395, -100.84981452425322, -100.93929450710615, -116.41918953259787, -110.58602624883255, -112.30490689476332, -124.94800259669623, -1.5401198615630562, -1.414065947135299, -1.058258246009558, -0.8064654444654877, -0.8093287770946915, -0.6989028466244633, -3.4602691320081647, -3.9910241862138207, -4.093130518992751, -107.97846087813377, -119.3816169500351, -107.28777186572552, -11.80171309163174, -12.144397815068572, -11.906327401598304, -14.710936566193908, -14.743525405724853, -14.689682592948287, -90.68758329749107, -102.86801165342331, -90.2157980799675, -5.757224731147289, -5.70677126199007, -5.245965173467994, -2.298294027646392, -2.013860476513713, -2.1566116263469155, -2.8370500206947327, -2.6907422617077827, -2.5092644933611155, 0.6464416583379062, 0.4501296629508289, 0.5348271926244053, -99.20793875555198, -98.86190078655879, -110.93372098604839, -95.2360435773929, -106.97090031703314, -94.22393434805176, -1.559265412390232, -1.836588203907013, -1.7012128680944443, 4.251243037482098, 4.256590095659092, 4.290034820636109, -91.19006081422171, -86.53112406780323, -87.27903603514036, 4.138699118047953, 3.5085297375917435, 4.373437860049307, 3.6662696873148235, 3.638112639387444, 3.9375202835847887, 6.865469728906945, 6.763280396660164, 7.592296953623489, -7.131567793587848, -7.420406351486847, -7.241087938348457, -0.9689490968982426, -1.141699227193996, -0.8239262464145867, -111.97851605216663, -125.17068854967754, -112.76304117838542, -0.9175452912847248, -1.008344138662025, -0.8296536977092472, -107.25012336174647, -95.88575337330501, -95.7293571929137, -7.1159190510710175, -7.647363712390273, -7.34826656182608, -3.2673075894514767, -3.25958100209634, -3.4972117940584866, -6.763581489523261, -6.559972414126008, -7.27193467815718, -11.58934609840314, -11.66421001652877, -11.749664003650352, 0.05005732675392949, 0.8692646897009837, 0.16334407528241002, -101.2015079036355, -101.260174036026, -115.4231185913086, -106.01675432920456, -95.11661593616009, -95.06860184296966, 5.942389786243439, 5.88970173895359, 6.267663285136223, 0.08705421785512613, 0.8062224412957733, 0.6687974135080879, -106.77084027727446, -119.93456705411276, -107.74178712566695, -0.19402694205443538, -0.3476213688651768, -0.727346653739616, 7.103498345861823, 6.952087479333073, 6.907703849176556, -13.427439026534557, -13.394340008497238, -14.186934113502502, -91.948149005572, -103.13477108875911, -94.57307050625484, -90.00112374623617, -100.13735284407935, -87.1223509249588, -103.58848022172849, -104.37095319728057, -115.3861316839854, -5.578718153138965, -5.6460491990049775, -6.712165703376144, -15.360754656294986, -15.511617812017604, -15.344179424146816, -101.66146264473598, -113.16073761383693, -102.65259341398875, -104.56991177797318, -104.61484816670418, -109.97850430011749, -104.20495372017226, -107.34540935357413, -108.83686657746634, -97.03218578298888, -98.3203998108705, -108.46446766455969, -108.20496461788814, -95.34192449847858, -94.25167813400428, -104.60008716583252, -115.90450918674469, -104.01627516746521, -7.556936119993537, -7.477890824278205, -6.9514619310697014, -0.1334296216567452, -0.045484272142260807, -0.21519780655702903, -101.4426173468431, -116.21218653519949, -99.692198989292, -7.567373558878899, -7.0938088819384575, -6.719479866325855, -3.8945833568771775, -4.054194649060577, -3.946393949290126, -4.370614759624004, -4.181326761841774, -4.091679979115725, -19.10663457959891, -19.086036704480655, -19.253249078989036, -99.27671896417937, -100.2209495206674, -110.20519079764685, -0.6650068312883377, -0.5441101714968681, -0.6601939797401428, -19.25746137897174, -19.43185629944007, -20.480242768923446, -9.833820641040802, -9.367198713123798, -10.075178772211075, 1.5975876599550247, 2.1938826590776443, 1.7175899893045425, -85.36195149769387, -94.86276418094835, -85.19169671585163, -18.692455043395363, -18.606308897336326, -18.99590459962686, 0.15053842961788177, 0.27799055725336075, -0.6655389368534088, -101.46808419624965, -90.42449061075847, -89.31637499729793, -101.58208854993185, -89.0573005427917, -88.57758041967949, -2.2069720874230114, -2.2797858665386883, -2.6863685945669857, -17.909881417949997, -18.085493390758835, -18.435021882255874, 2.4926555827260017, 2.563990794122219, 2.212482050061226, 0.8007284800211494, 1.0820274228850906, 0.9593391219774787, -2.5331462770700455, -2.4320531114935875, -2.0597156267613173, -116.12611728906631, -104.2094435095787, -103.07116213440895, 0.2526572098334583, 0.36923152705033147, 0.44147436817486607, 5.098895969490201, 4.862192439536244, 5.031123811999947, -7.1833247666557725, -6.977181227256864, -8.22432737549147, 2.5854842563470157, 2.527195384105042, 2.5583029737075123]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14584937501297707, "mean_inference_ms": 0.6392201796770373, "mean_action_processing_ms": 0.09359035279621207, "mean_env_wait_ms": 0.7740545201833801, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 150000, "timesteps_this_iter": 0, "agent_timesteps_total": 450000, "timers": {"sample_time_ms": 10196.713, "sample_throughput": 490.354, "load_time_ms": 0.201, "load_throughput": 24921592.395, "learn_time_ms": 1545.47, "learn_throughput": 3235.261, "update_time_ms": 7.393}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005000000000000001, "total_loss": 152.80140075683593, "policy_loss": -0.0020032785386204567, "vf_loss": 152.8581069946289, "vf_explained_var": 0.06805376410484314, "kl": 0.0048838195943996816, "entropy": 5.469963550567627, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 150000, "num_agent_steps_sampled": 450000, "num_steps_trained": 150000, "num_agent_steps_trained": 450000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1129, "training_iteration": 30, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-14-11", "timestamp": 1706228051, "time_this_iter_s": 9.960408210754395, "time_total_s": 295.58046650886536, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824A3EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 295.58046650886536, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 5.54, "ram_util_percent": 52.980000000000004}}
{"episode_reward_max": 21.923008233308764, "episode_reward_min": -349.91224578022957, "episode_reward_mean": -116.04703230921994, "episode_len_mean": 354.64, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -125.17068854967754}, "policy_reward_max": {"shared_policy": 7.592296953623489}, "policy_reward_mean": {"shared_policy": -38.682344103073326}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.553082317113876, -298.8378611803055, -314.61930314451456, 20.497549131512613, -17.48337721824646, -319.6274030506611, -24.209391444921508, -319.4885724633932, -20.953392587602167, -330.4477243423462, -19.40482360869649, -318.2082985639572, -347.8389357402921, -4.012444054707913, -2.3146970681846426, -11.544423837214737, -334.6478496938944, -35.852438308298616, -44.14414456486705, -283.7713930308819, -16.709961166605353, -6.468766130507021, -8.03705677576363, 1.6313985139131404, -309.00356052815914, -296.4308782424778, -5.097066484391689, 12.797867953777299, -265.00022091716534, 12.020666715689003, 11.241902610287056, 21.221047079190598, -21.793062083423152, -2.9345745705068254, -349.91224578022957, -2.755543127655997, -298.86523392796516, -22.11154932528737, -10.024100385606303, -20.59548858180645, -35.00322011858226, 1.0826660917373232, -317.8848005309701, -296.2019721083343, 18.099754810333252, 1.5620740726589872, -334.44719445705414, -1.2689949646592282, 20.963289674371453, -41.0087131485343, -289.65599060058594, -277.2608275152743, -323.34556510299444, -17.936933055520086, -46.21655189245941, -317.47479367256165, -319.16326424479485, -320.3872296512127, -303.8170532584191, -297.798567250371, -324.5208715200424, -21.986288875341444, -0.39411170035603504, -317.34700287133455, -21.38066230714321, -11.89517195522788, -12.643621500581503, -57.4459203630686, -309.7028592824936, -1.8693109825253487, -59.16956044733526, -29.276198126375675, 5.509060308337212, -265.4164123944938, -56.29466854035855, -0.2370099499821663, -281.20894980430603, -279.216969512403, -7.1731265485286855, -54.430396690964706, 7.269128426909447, 2.8420950248837187, -7.02491501532495, -323.40672293305397, 1.0633631050586558, 14.992212221026392, -22.384833369404106, 7.67098261415957, -9.075852744281306, -277.71055091172457, -28.319944918155684, -3.5521122552454614, -133.81820493936547, -10.06480604410173, -293.57501503825193, 8.318655960261793, -14.168205142021193, 21.923008233308764, -5.593258365988746, -321.5358825996518], "episode_lengths": [500, 99, 199, 500, 500, 110, 500, 49, 500, 54, 500, 70, 70, 500, 500, 500, 63, 500, 500, 80, 500, 500, 500, 500, 74, 88, 500, 500, 99, 500, 500, 500, 500, 500, 80, 500, 67, 500, 500, 500, 500, 500, 52, 77, 500, 500, 63, 500, 500, 500, 69, 78, 93, 500, 500, 60, 71, 72, 170, 93, 68, 500, 500, 61, 500, 500, 500, 500, 72, 500, 500, 500, 500, 163, 500, 500, 76, 102, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 89, 500, 500, 500, 500, 95, 500, 500, 500, 500, 63], "policy_shared_policy_reward": [-3.683694154024124, -4.032563269138336, -3.836824893951416, -106.24028803904852, -95.51090421279272, -97.08666892846426, -101.97123574217161, -111.49528974791369, -101.15277765442929, 7.1398526902000015, 6.916570189098508, 6.441126252214104, -5.877368718385696, -5.5229091346263885, -6.083099365234375, -115.59690779447556, -102.02173648774624, -102.0087587684393, -7.96534411857526, -7.983137297133609, -8.260910029212639, -114.00799663861594, -102.34877193470797, -103.13180389006934, -7.222193260987609, -6.8853049402435715, -6.845894386370986, -105.05688613653183, -104.8966765999794, -120.49416160583496, -6.7640922268231805, -6.256832522650569, -6.3838988592227395, -100.84981452425322, -100.93929450710615, -116.41918953259787, -110.58602624883255, -112.30490689476332, -124.94800259669623, -1.5401198615630562, -1.414065947135299, -1.058258246009558, -0.8064654444654877, -0.8093287770946915, -0.6989028466244633, -3.4602691320081647, -3.9910241862138207, -4.093130518992751, -107.97846087813377, -119.3816169500351, -107.28777186572552, -11.80171309163174, -12.144397815068572, -11.906327401598304, -14.710936566193908, -14.743525405724853, -14.689682592948287, -90.68758329749107, -102.86801165342331, -90.2157980799675, -5.757224731147289, -5.70677126199007, -5.245965173467994, -2.298294027646392, -2.013860476513713, -2.1566116263469155, -2.8370500206947327, -2.6907422617077827, -2.5092644933611155, 0.6464416583379062, 0.4501296629508289, 0.5348271926244053, -99.20793875555198, -98.86190078655879, -110.93372098604839, -95.2360435773929, -106.97090031703314, -94.22393434805176, -1.559265412390232, -1.836588203907013, -1.7012128680944443, 4.251243037482098, 4.256590095659092, 4.290034820636109, -91.19006081422171, -86.53112406780323, -87.27903603514036, 4.138699118047953, 3.5085297375917435, 4.373437860049307, 3.6662696873148235, 3.638112639387444, 3.9375202835847887, 6.865469728906945, 6.763280396660164, 7.592296953623489, -7.131567793587848, -7.420406351486847, -7.241087938348457, -0.9689490968982426, -1.141699227193996, -0.8239262464145867, -111.97851605216663, -125.17068854967754, -112.76304117838542, -0.9175452912847248, -1.008344138662025, -0.8296536977092472, -107.25012336174647, -95.88575337330501, -95.7293571929137, -7.1159190510710175, -7.647363712390273, -7.34826656182608, -3.2673075894514767, -3.25958100209634, -3.4972117940584866, -6.763581489523261, -6.559972414126008, -7.27193467815718, -11.58934609840314, -11.66421001652877, -11.749664003650352, 0.05005732675392949, 0.8692646897009837, 0.16334407528241002, -101.2015079036355, -101.260174036026, -115.4231185913086, -106.01675432920456, -95.11661593616009, -95.06860184296966, 5.942389786243439, 5.88970173895359, 6.267663285136223, 0.08705421785512613, 0.8062224412957733, 0.6687974135080879, -106.77084027727446, -119.93456705411276, -107.74178712566695, -0.19402694205443538, -0.3476213688651768, -0.727346653739616, 7.103498345861823, 6.952087479333073, 6.907703849176556, -13.427439026534557, -13.394340008497238, -14.186934113502502, -91.948149005572, -103.13477108875911, -94.57307050625484, -90.00112374623617, -100.13735284407935, -87.1223509249588, -103.58848022172849, -104.37095319728057, -115.3861316839854, -5.578718153138965, -5.6460491990049775, -6.712165703376144, -15.360754656294986, -15.511617812017604, -15.344179424146816, -101.66146264473598, -113.16073761383693, -102.65259341398875, -104.56991177797318, -104.61484816670418, -109.97850430011749, -104.20495372017226, -107.34540935357413, -108.83686657746634, -97.03218578298888, -98.3203998108705, -108.46446766455969, -108.20496461788814, -95.34192449847858, -94.25167813400428, -104.60008716583252, -115.90450918674469, -104.01627516746521, -7.556936119993537, -7.477890824278205, -6.9514619310697014, -0.1334296216567452, -0.045484272142260807, -0.21519780655702903, -101.4426173468431, -116.21218653519949, -99.692198989292, -7.567373558878899, -7.0938088819384575, -6.719479866325855, -3.8945833568771775, -4.054194649060577, -3.946393949290126, -4.370614759624004, -4.181326761841774, -4.091679979115725, -19.10663457959891, -19.086036704480655, -19.253249078989036, -99.27671896417937, -100.2209495206674, -110.20519079764685, -0.6650068312883377, -0.5441101714968681, -0.6601939797401428, -19.25746137897174, -19.43185629944007, -20.480242768923446, -9.833820641040802, -9.367198713123798, -10.075178772211075, 1.5975876599550247, 2.1938826590776443, 1.7175899893045425, -85.36195149769387, -94.86276418094835, -85.19169671585163, -18.692455043395363, -18.606308897336326, -18.99590459962686, 0.15053842961788177, 0.27799055725336075, -0.6655389368534088, -101.46808419624965, -90.42449061075847, -89.31637499729793, -101.58208854993185, -89.0573005427917, -88.57758041967949, -2.2069720874230114, -2.2797858665386883, -2.6863685945669857, -17.909881417949997, -18.085493390758835, -18.435021882255874, 2.4926555827260017, 2.563990794122219, 2.212482050061226, 0.8007284800211494, 1.0820274228850906, 0.9593391219774787, -2.5331462770700455, -2.4320531114935875, -2.0597156267613173, -116.12611728906631, -104.2094435095787, -103.07116213440895, 0.2526572098334583, 0.36923152705033147, 0.44147436817486607, 5.098895969490201, 4.862192439536244, 5.031123811999947, -7.1833247666557725, -6.977181227256864, -8.22432737549147, 2.5854842563470157, 2.527195384105042, 2.5583029737075123, -2.826834345857307, -2.9546245808402745, -3.2943938175837246, -102.43123829364777, -87.4537904933095, -87.8255221247673, -9.343171427647277, -9.202028820912048, -9.774744669596359, -0.8712192165354935, -1.321614841620132, -1.3592781970898358, -43.57577005277078, -43.7423463339607, -46.500088552633926, -3.3090835685531346, -3.1137326235572544, -3.6419898519913403, -92.51320294042429, -108.38708802064261, -92.674724077185, 2.9533366809288566, 2.93416331956783, 2.431155959765107, -4.4302747497956005, -4.769914383689567, -4.968016008536026, 7.313223148385674, 7.0806325624386375, 7.529152522484452, -1.7140604058901516, -1.868110323945686, -2.011087636152908, -116.69121019045512, -103.19606296221416, -101.64860944698255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1455311223783869, "mean_inference_ms": 0.6400081464401646, "mean_action_processing_ms": 0.09366638536738224, "mean_env_wait_ms": 0.7751551399117524, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 155000, "timesteps_this_iter": 0, "agent_timesteps_total": 465000, "timers": {"sample_time_ms": 10137.966, "sample_throughput": 493.196, "load_time_ms": 0.201, "load_throughput": 24921592.395, "learn_time_ms": 1549.917, "learn_throughput": 3225.98, "update_time_ms": 7.301}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 206.87335815429688, "policy_loss": -0.0031960804809692015, "vf_loss": 206.93151092529297, "vf_explained_var": 0.12083885669708253, "kl": 0.005789171459039272, "entropy": 5.49631519317627, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 155000, "num_agent_steps_sampled": 465000, "num_steps_trained": 155000, "num_agent_steps_trained": 465000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1141, "training_iteration": 31, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-14-21", "timestamp": 1706228061, "time_this_iter_s": 9.75635051727295, "time_total_s": 305.3368170261383, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202825774C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 305.3368170261383, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 8.36923076923077, "ram_util_percent": 52.89999999999999}}
{"episode_reward_max": 21.923008233308764, "episode_reward_min": -349.91224578022957, "episode_reward_mean": -106.96966280947323, "episode_len_mean": 366.47, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -125.17068854967754}, "policy_reward_max": {"shared_policy": 7.592296953623489}, "policy_reward_mean": {"shared_policy": -35.65655426982442}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-347.8389357402921, -4.012444054707913, -2.3146970681846426, -11.544423837214737, -334.6478496938944, -35.852438308298616, -44.14414456486705, -283.7713930308819, -16.709961166605353, -6.468766130507021, -8.03705677576363, 1.6313985139131404, -309.00356052815914, -296.4308782424778, -5.097066484391689, 12.797867953777299, -265.00022091716534, 12.020666715689003, 11.241902610287056, 21.221047079190598, -21.793062083423152, -2.9345745705068254, -349.91224578022957, -2.755543127655997, -298.86523392796516, -22.11154932528737, -10.024100385606303, -20.59548858180645, -35.00322011858226, 1.0826660917373232, -317.8848005309701, -296.2019721083343, 18.099754810333252, 1.5620740726589872, -334.44719445705414, -1.2689949646592282, 20.963289674371453, -41.0087131485343, -289.65599060058594, -277.2608275152743, -323.34556510299444, -17.936933055520086, -46.21655189245941, -317.47479367256165, -319.16326424479485, -320.3872296512127, -303.8170532584191, -297.798567250371, -324.5208715200424, -21.986288875341444, -0.39411170035603504, -317.34700287133455, -21.38066230714321, -11.89517195522788, -12.643621500581503, -57.4459203630686, -309.7028592824936, -1.8693109825253487, -59.16956044733526, -29.276198126375675, 5.509060308337212, -265.4164123944938, -56.29466854035855, -0.2370099499821663, -281.20894980430603, -279.216969512403, -7.1731265485286855, -54.430396690964706, 7.269128426909447, 2.8420950248837187, -7.02491501532495, -323.40672293305397, 1.0633631050586558, 14.992212221026392, -22.384833369404106, 7.67098261415957, -9.075852744281306, -277.71055091172457, -28.319944918155684, -3.5521122552454614, -133.81820493936547, -10.06480604410173, -293.57501503825193, 8.318655960261793, -14.168205142021193, 21.923008233308764, -5.593258365988746, -321.5358825996518, -3.6694798916578293, 15.320466227829428, -6.408649444580092, -30.56043317168951, -14.800080843269853, -316.766369143501, -42.102663196623354, -51.60689474269748, -300.77726811915636, -307.9377134144306, -12.854693725705147, 5.565048649907098], "episode_lengths": [70, 500, 500, 500, 63, 500, 500, 80, 500, 500, 500, 500, 74, 88, 500, 500, 99, 500, 500, 500, 500, 500, 80, 500, 67, 500, 500, 500, 500, 500, 52, 77, 500, 500, 63, 500, 500, 500, 69, 78, 93, 500, 500, 60, 71, 72, 170, 93, 68, 500, 500, 61, 500, 500, 500, 500, 72, 500, 500, 500, 500, 163, 500, 500, 76, 102, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 89, 500, 500, 500, 500, 95, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 76, 500, 500, 103, 85, 500, 500], "policy_shared_policy_reward": [-110.58602624883255, -112.30490689476332, -124.94800259669623, -1.5401198615630562, -1.414065947135299, -1.058258246009558, -0.8064654444654877, -0.8093287770946915, -0.6989028466244633, -3.4602691320081647, -3.9910241862138207, -4.093130518992751, -107.97846087813377, -119.3816169500351, -107.28777186572552, -11.80171309163174, -12.144397815068572, -11.906327401598304, -14.710936566193908, -14.743525405724853, -14.689682592948287, -90.68758329749107, -102.86801165342331, -90.2157980799675, -5.757224731147289, -5.70677126199007, -5.245965173467994, -2.298294027646392, -2.013860476513713, -2.1566116263469155, -2.8370500206947327, -2.6907422617077827, -2.5092644933611155, 0.6464416583379062, 0.4501296629508289, 0.5348271926244053, -99.20793875555198, -98.86190078655879, -110.93372098604839, -95.2360435773929, -106.97090031703314, -94.22393434805176, -1.559265412390232, -1.836588203907013, -1.7012128680944443, 4.251243037482098, 4.256590095659092, 4.290034820636109, -91.19006081422171, -86.53112406780323, -87.27903603514036, 4.138699118047953, 3.5085297375917435, 4.373437860049307, 3.6662696873148235, 3.638112639387444, 3.9375202835847887, 6.865469728906945, 6.763280396660164, 7.592296953623489, -7.131567793587848, -7.420406351486847, -7.241087938348457, -0.9689490968982426, -1.141699227193996, -0.8239262464145867, -111.97851605216663, -125.17068854967754, -112.76304117838542, -0.9175452912847248, -1.008344138662025, -0.8296536977092472, -107.25012336174647, -95.88575337330501, -95.7293571929137, -7.1159190510710175, -7.647363712390273, -7.34826656182608, -3.2673075894514767, -3.25958100209634, -3.4972117940584866, -6.763581489523261, -6.559972414126008, -7.27193467815718, -11.58934609840314, -11.66421001652877, -11.749664003650352, 0.05005732675392949, 0.8692646897009837, 0.16334407528241002, -101.2015079036355, -101.260174036026, -115.4231185913086, -106.01675432920456, -95.11661593616009, -95.06860184296966, 5.942389786243439, 5.88970173895359, 6.267663285136223, 0.08705421785512613, 0.8062224412957733, 0.6687974135080879, -106.77084027727446, -119.93456705411276, -107.74178712566695, -0.19402694205443538, -0.3476213688651768, -0.727346653739616, 7.103498345861823, 6.952087479333073, 6.907703849176556, -13.427439026534557, -13.394340008497238, -14.186934113502502, -91.948149005572, -103.13477108875911, -94.57307050625484, -90.00112374623617, -100.13735284407935, -87.1223509249588, -103.58848022172849, -104.37095319728057, -115.3861316839854, -5.578718153138965, -5.6460491990049775, -6.712165703376144, -15.360754656294986, -15.511617812017604, -15.344179424146816, -101.66146264473598, -113.16073761383693, -102.65259341398875, -104.56991177797318, -104.61484816670418, -109.97850430011749, -104.20495372017226, -107.34540935357413, -108.83686657746634, -97.03218578298888, -98.3203998108705, -108.46446766455969, -108.20496461788814, -95.34192449847858, -94.25167813400428, -104.60008716583252, -115.90450918674469, -104.01627516746521, -7.556936119993537, -7.477890824278205, -6.9514619310697014, -0.1334296216567452, -0.045484272142260807, -0.21519780655702903, -101.4426173468431, -116.21218653519949, -99.692198989292, -7.567373558878899, -7.0938088819384575, -6.719479866325855, -3.8945833568771775, -4.054194649060577, -3.946393949290126, -4.370614759624004, -4.181326761841774, -4.091679979115725, -19.10663457959891, -19.086036704480655, -19.253249078989036, -99.27671896417937, -100.2209495206674, -110.20519079764685, -0.6650068312883377, -0.5441101714968681, -0.6601939797401428, -19.25746137897174, -19.43185629944007, -20.480242768923446, -9.833820641040802, -9.367198713123798, -10.075178772211075, 1.5975876599550247, 2.1938826590776443, 1.7175899893045425, -85.36195149769387, -94.86276418094835, -85.19169671585163, -18.692455043395363, -18.606308897336326, -18.99590459962686, 0.15053842961788177, 0.27799055725336075, -0.6655389368534088, -101.46808419624965, -90.42449061075847, -89.31637499729793, -101.58208854993185, -89.0573005427917, -88.57758041967949, -2.2069720874230114, -2.2797858665386883, -2.6863685945669857, -17.909881417949997, -18.085493390758835, -18.435021882255874, 2.4926555827260017, 2.563990794122219, 2.212482050061226, 0.8007284800211494, 1.0820274228850906, 0.9593391219774787, -2.5331462770700455, -2.4320531114935875, -2.0597156267613173, -116.12611728906631, -104.2094435095787, -103.07116213440895, 0.2526572098334583, 0.36923152705033147, 0.44147436817486607, 5.098895969490201, 4.862192439536244, 5.031123811999947, -7.1833247666557725, -6.977181227256864, -8.22432737549147, 2.5854842563470157, 2.527195384105042, 2.5583029737075123, -2.826834345857307, -2.9546245808402745, -3.2943938175837246, -102.43123829364777, -87.4537904933095, -87.8255221247673, -9.343171427647277, -9.202028820912048, -9.774744669596359, -0.8712192165354935, -1.321614841620132, -1.3592781970898358, -43.57577005277078, -43.7423463339607, -46.500088552633926, -3.3090835685531346, -3.1137326235572544, -3.6419898519913403, -92.51320294042429, -108.38708802064261, -92.674724077185, 2.9533366809288566, 2.93416331956783, 2.431155959765107, -4.4302747497956005, -4.769914383689567, -4.968016008536026, 7.313223148385674, 7.0806325624386375, 7.529152522484452, -1.7140604058901516, -1.868110323945686, -2.011087636152908, -116.69121019045512, -103.19606296221416, -101.64860944698255, -1.1203953102231026, -1.0907748565077782, -1.4583097249269485, 4.899749244252831, 5.131384479502827, 5.289332504073769, -2.0990746791164128, -1.9247935290137974, -2.384781236449882, -9.842050142586231, -10.281704768538475, -10.436678260564804, -4.67935757090649, -5.036169638236373, -5.084553634126991, -112.66576238473257, -102.32455589373907, -101.7760508650293, -13.74466430892548, -14.080047090848296, -14.277951796849578, -17.012836415320635, -17.48344576358795, -17.11061256378889, -94.33247508108616, -94.46663980931044, -111.97815322875977, -102.27144221464793, -100.74455226461093, -104.92171893517177, -4.684445947408676, -4.262488275766373, -3.907759502530098, 1.9016010214885029, 1.8853347649176868, 1.7781128635009082]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1453645095363343, "mean_inference_ms": 0.6406551296352955, "mean_action_processing_ms": 0.09362772012707596, "mean_env_wait_ms": 0.7763207140654836, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 160000, "timesteps_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"sample_time_ms": 10154.651, "sample_throughput": 492.385, "load_time_ms": 0.201, "load_throughput": 24921592.395, "learn_time_ms": 1545.373, "learn_throughput": 3235.466, "update_time_ms": 7.3}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 199.76761779785156, "policy_loss": -0.002558443883095557, "vf_loss": 199.82608032226562, "vf_explained_var": 0.05242356061935425, "kl": 0.008092903567014614, "entropy": 5.589885997772217, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 160000, "num_agent_steps_sampled": 480000, "num_steps_trained": 160000, "num_agent_steps_trained": 480000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1153, "training_iteration": 32, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-14-31", "timestamp": 1706228071, "time_this_iter_s": 10.079730987548828, "time_total_s": 315.41654801368713, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202CC9A9550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 315.41654801368713, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 7.028571428571429, "ram_util_percent": 52.87142857142857}}
{"episode_reward_max": 21.923008233308764, "episode_reward_min": -349.91224578022957, "episode_reward_mean": -99.49819404751412, "episode_len_mean": 375.21, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -125.17068854967754}, "policy_reward_max": {"shared_policy": 7.592296953623489}, "policy_reward_mean": {"shared_policy": -33.16606468250471}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.6313985139131404, -309.00356052815914, -296.4308782424778, -5.097066484391689, 12.797867953777299, -265.00022091716534, 12.020666715689003, 11.241902610287056, 21.221047079190598, -21.793062083423152, -2.9345745705068254, -349.91224578022957, -2.755543127655997, -298.86523392796516, -22.11154932528737, -10.024100385606303, -20.59548858180645, -35.00322011858226, 1.0826660917373232, -317.8848005309701, -296.2019721083343, 18.099754810333252, 1.5620740726589872, -334.44719445705414, -1.2689949646592282, 20.963289674371453, -41.0087131485343, -289.65599060058594, -277.2608275152743, -323.34556510299444, -17.936933055520086, -46.21655189245941, -317.47479367256165, -319.16326424479485, -320.3872296512127, -303.8170532584191, -297.798567250371, -324.5208715200424, -21.986288875341444, -0.39411170035603504, -317.34700287133455, -21.38066230714321, -11.89517195522788, -12.643621500581503, -57.4459203630686, -309.7028592824936, -1.8693109825253487, -59.16956044733526, -29.276198126375675, 5.509060308337212, -265.4164123944938, -56.29466854035855, -0.2370099499821663, -281.20894980430603, -279.216969512403, -7.1731265485286855, -54.430396690964706, 7.269128426909447, 2.8420950248837187, -7.02491501532495, -323.40672293305397, 1.0633631050586558, 14.992212221026392, -22.384833369404106, 7.67098261415957, -9.075852744281306, -277.71055091172457, -28.319944918155684, -3.5521122552454614, -133.81820493936547, -10.06480604410173, -293.57501503825193, 8.318655960261793, -14.168205142021193, 21.923008233308764, -5.593258365988746, -321.5358825996518, -3.6694798916578293, 15.320466227829428, -6.408649444580092, -30.56043317168951, -14.800080843269853, -316.766369143501, -42.102663196623354, -51.60689474269748, -300.77726811915636, -307.9377134144306, -12.854693725705147, 5.565048649907098, 4.7345051541924335, -2.0799172520637796, -271.82859505712986, -0.9909159392118738, -61.342686006799354, 2.2636556997894957, 14.114535011351094, 10.253884635865688, -22.982368865981712, -37.83525927318263, 17.497927717864485], "episode_lengths": [500, 74, 88, 500, 500, 99, 500, 500, 500, 500, 500, 80, 500, 67, 500, 500, 500, 500, 500, 52, 77, 500, 500, 63, 500, 500, 500, 69, 78, 93, 500, 500, 60, 71, 72, 170, 93, 68, 500, 500, 61, 500, 500, 500, 500, 72, 500, 500, 500, 500, 163, 500, 500, 76, 102, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 89, 500, 500, 500, 500, 95, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 76, 500, 500, 103, 85, 500, 500, 500, 500, 87, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [0.6464416583379062, 0.4501296629508289, 0.5348271926244053, -99.20793875555198, -98.86190078655879, -110.93372098604839, -95.2360435773929, -106.97090031703314, -94.22393434805176, -1.559265412390232, -1.836588203907013, -1.7012128680944443, 4.251243037482098, 4.256590095659092, 4.290034820636109, -91.19006081422171, -86.53112406780323, -87.27903603514036, 4.138699118047953, 3.5085297375917435, 4.373437860049307, 3.6662696873148235, 3.638112639387444, 3.9375202835847887, 6.865469728906945, 6.763280396660164, 7.592296953623489, -7.131567793587848, -7.420406351486847, -7.241087938348457, -0.9689490968982426, -1.141699227193996, -0.8239262464145867, -111.97851605216663, -125.17068854967754, -112.76304117838542, -0.9175452912847248, -1.008344138662025, -0.8296536977092472, -107.25012336174647, -95.88575337330501, -95.7293571929137, -7.1159190510710175, -7.647363712390273, -7.34826656182608, -3.2673075894514767, -3.25958100209634, -3.4972117940584866, -6.763581489523261, -6.559972414126008, -7.27193467815718, -11.58934609840314, -11.66421001652877, -11.749664003650352, 0.05005732675392949, 0.8692646897009837, 0.16334407528241002, -101.2015079036355, -101.260174036026, -115.4231185913086, -106.01675432920456, -95.11661593616009, -95.06860184296966, 5.942389786243439, 5.88970173895359, 6.267663285136223, 0.08705421785512613, 0.8062224412957733, 0.6687974135080879, -106.77084027727446, -119.93456705411276, -107.74178712566695, -0.19402694205443538, -0.3476213688651768, -0.727346653739616, 7.103498345861823, 6.952087479333073, 6.907703849176556, -13.427439026534557, -13.394340008497238, -14.186934113502502, -91.948149005572, -103.13477108875911, -94.57307050625484, -90.00112374623617, -100.13735284407935, -87.1223509249588, -103.58848022172849, -104.37095319728057, -115.3861316839854, -5.578718153138965, -5.6460491990049775, -6.712165703376144, -15.360754656294986, -15.511617812017604, -15.344179424146816, -101.66146264473598, -113.16073761383693, -102.65259341398875, -104.56991177797318, -104.61484816670418, -109.97850430011749, -104.20495372017226, -107.34540935357413, -108.83686657746634, -97.03218578298888, -98.3203998108705, -108.46446766455969, -108.20496461788814, -95.34192449847858, -94.25167813400428, -104.60008716583252, -115.90450918674469, -104.01627516746521, -7.556936119993537, -7.477890824278205, -6.9514619310697014, -0.1334296216567452, -0.045484272142260807, -0.21519780655702903, -101.4426173468431, -116.21218653519949, -99.692198989292, -7.567373558878899, -7.0938088819384575, -6.719479866325855, -3.8945833568771775, -4.054194649060577, -3.946393949290126, -4.370614759624004, -4.181326761841774, -4.091679979115725, -19.10663457959891, -19.086036704480655, -19.253249078989036, -99.27671896417937, -100.2209495206674, -110.20519079764685, -0.6650068312883377, -0.5441101714968681, -0.6601939797401428, -19.25746137897174, -19.43185629944007, -20.480242768923446, -9.833820641040802, -9.367198713123798, -10.075178772211075, 1.5975876599550247, 2.1938826590776443, 1.7175899893045425, -85.36195149769387, -94.86276418094835, -85.19169671585163, -18.692455043395363, -18.606308897336326, -18.99590459962686, 0.15053842961788177, 0.27799055725336075, -0.6655389368534088, -101.46808419624965, -90.42449061075847, -89.31637499729793, -101.58208854993185, -89.0573005427917, -88.57758041967949, -2.2069720874230114, -2.2797858665386883, -2.6863685945669857, -17.909881417949997, -18.085493390758835, -18.435021882255874, 2.4926555827260017, 2.563990794122219, 2.212482050061226, 0.8007284800211494, 1.0820274228850906, 0.9593391219774787, -2.5331462770700455, -2.4320531114935875, -2.0597156267613173, -116.12611728906631, -104.2094435095787, -103.07116213440895, 0.2526572098334583, 0.36923152705033147, 0.44147436817486607, 5.098895969490201, 4.862192439536244, 5.031123811999947, -7.1833247666557725, -6.977181227256864, -8.22432737549147, 2.5854842563470157, 2.527195384105042, 2.5583029737075123, -2.826834345857307, -2.9546245808402745, -3.2943938175837246, -102.43123829364777, -87.4537904933095, -87.8255221247673, -9.343171427647277, -9.202028820912048, -9.774744669596359, -0.8712192165354935, -1.321614841620132, -1.3592781970898358, -43.57577005277078, -43.7423463339607, -46.500088552633926, -3.3090835685531346, -3.1137326235572544, -3.6419898519913403, -92.51320294042429, -108.38708802064261, -92.674724077185, 2.9533366809288566, 2.93416331956783, 2.431155959765107, -4.4302747497956005, -4.769914383689567, -4.968016008536026, 7.313223148385674, 7.0806325624386375, 7.529152522484452, -1.7140604058901516, -1.868110323945686, -2.011087636152908, -116.69121019045512, -103.19606296221416, -101.64860944698255, -1.1203953102231026, -1.0907748565077782, -1.4583097249269485, 4.899749244252831, 5.131384479502827, 5.289332504073769, -2.0990746791164128, -1.9247935290137974, -2.384781236449882, -9.842050142586231, -10.281704768538475, -10.436678260564804, -4.67935757090649, -5.036169638236373, -5.084553634126991, -112.66576238473257, -102.32455589373907, -101.7760508650293, -13.74466430892548, -14.080047090848296, -14.277951796849578, -17.012836415320635, -17.48344576358795, -17.11061256378889, -94.33247508108616, -94.46663980931044, -111.97815322875977, -102.27144221464793, -100.74455226461093, -104.92171893517177, -4.684445947408676, -4.262488275766373, -3.907759502530098, 1.9016010214885029, 1.8853347649176868, 1.7781128635009082, 1.7350702484448703, 1.1599398156007084, 1.8394950901468547, -0.6200707902511056, -0.9580618341763909, -0.5017846276362832, -89.20712891717753, -93.2746550043424, -89.34681113560995, -0.45668694128593756, -0.2627974835534985, -0.27143151437243773, -19.367578952262804, -19.228993654871985, -22.746113399664566, 0.6555431211988036, 0.48663916687169717, 1.1214734117189948, 5.244901654620961, 4.717951854070023, 4.151681502660111, 3.2992657124996185, 3.4363843724131584, 3.5182345509529114, -7.841466645399734, -7.388118308658406, -7.752783911923572, -12.778761838873237, -12.074347187609732, -12.98215024669966, 5.608348841468484, 5.76369799176851, 6.125880884627492]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14504456562837115, "mean_inference_ms": 0.6420605911758673, "mean_action_processing_ms": 0.09381527386697551, "mean_env_wait_ms": 0.7779954382966922, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 165000, "timesteps_this_iter": 0, "agent_timesteps_total": 495000, "timers": {"sample_time_ms": 10213.62, "sample_throughput": 489.542, "load_time_ms": 0.201, "load_throughput": 24921592.395, "learn_time_ms": 1555.248, "learn_throughput": 3214.92, "update_time_ms": 7.293}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 89.90378799438477, "policy_loss": -0.0029453165216278164, "vf_loss": 89.96353683471679, "vf_explained_var": -0.15950424671173097, "kl": 0.007815536967247924, "entropy": 5.680494499206543, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 165000, "num_agent_steps_sampled": 495000, "num_steps_trained": 165000, "num_agent_steps_trained": 495000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1164, "training_iteration": 33, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-14-41", "timestamp": 1706228081, "time_this_iter_s": 10.417542219161987, "time_total_s": 325.8340902328491, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202808BA280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 325.8340902328491, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 10.293333333333333, "ram_util_percent": 53.08000000000001}}
{"episode_reward_max": 21.923008233308764, "episode_reward_min": -349.91224578022957, "episode_reward_mean": -96.442816565627, "episode_len_mean": 383.18, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -125.17068854967754}, "policy_reward_max": {"shared_policy": 7.529152522484452}, "policy_reward_mean": {"shared_policy": -32.147605521875676}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-349.91224578022957, -2.755543127655997, -298.86523392796516, -22.11154932528737, -10.024100385606303, -20.59548858180645, -35.00322011858226, 1.0826660917373232, -317.8848005309701, -296.2019721083343, 18.099754810333252, 1.5620740726589872, -334.44719445705414, -1.2689949646592282, 20.963289674371453, -41.0087131485343, -289.65599060058594, -277.2608275152743, -323.34556510299444, -17.936933055520086, -46.21655189245941, -317.47479367256165, -319.16326424479485, -320.3872296512127, -303.8170532584191, -297.798567250371, -324.5208715200424, -21.986288875341444, -0.39411170035603504, -317.34700287133455, -21.38066230714321, -11.89517195522788, -12.643621500581503, -57.4459203630686, -309.7028592824936, -1.8693109825253487, -59.16956044733526, -29.276198126375675, 5.509060308337212, -265.4164123944938, -56.29466854035855, -0.2370099499821663, -281.20894980430603, -279.216969512403, -7.1731265485286855, -54.430396690964706, 7.269128426909447, 2.8420950248837187, -7.02491501532495, -323.40672293305397, 1.0633631050586558, 14.992212221026392, -22.384833369404106, 7.67098261415957, -9.075852744281306, -277.71055091172457, -28.319944918155684, -3.5521122552454614, -133.81820493936547, -10.06480604410173, -293.57501503825193, 8.318655960261793, -14.168205142021193, 21.923008233308764, -5.593258365988746, -321.5358825996518, -3.6694798916578293, 15.320466227829428, -6.408649444580092, -30.56043317168951, -14.800080843269853, -316.766369143501, -42.102663196623354, -51.60689474269748, -300.77726811915636, -307.9377134144306, -12.854693725705147, 5.565048649907098, 4.7345051541924335, -2.0799172520637796, -271.82859505712986, -0.9909159392118738, -61.342686006799354, 2.2636556997894957, 14.114535011351094, 10.253884635865688, -22.982368865981712, -37.83525927318263, 17.497927717864485, -2.419696144759655, 4.335375934839249, -309.99488212168217, -33.76478774845603, 3.2286133058369018, -6.928040102124243, -54.147896096110365, -25.218878190964475, -62.184256516397014, -10.61954053491354, -38.094743549823775], "episode_lengths": [80, 500, 67, 500, 500, 500, 500, 500, 52, 77, 500, 500, 63, 500, 500, 500, 69, 78, 93, 500, 500, 60, 71, 72, 170, 93, 68, 500, 500, 61, 500, 500, 500, 500, 72, 500, 500, 500, 500, 163, 500, 500, 76, 102, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 89, 500, 500, 500, 500, 95, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 76, 500, 500, 103, 85, 500, 500, 500, 500, 87, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-111.97851605216663, -125.17068854967754, -112.76304117838542, -0.9175452912847248, -1.008344138662025, -0.8296536977092472, -107.25012336174647, -95.88575337330501, -95.7293571929137, -7.1159190510710175, -7.647363712390273, -7.34826656182608, -3.2673075894514767, -3.25958100209634, -3.4972117940584866, -6.763581489523261, -6.559972414126008, -7.27193467815718, -11.58934609840314, -11.66421001652877, -11.749664003650352, 0.05005732675392949, 0.8692646897009837, 0.16334407528241002, -101.2015079036355, -101.260174036026, -115.4231185913086, -106.01675432920456, -95.11661593616009, -95.06860184296966, 5.942389786243439, 5.88970173895359, 6.267663285136223, 0.08705421785512613, 0.8062224412957733, 0.6687974135080879, -106.77084027727446, -119.93456705411276, -107.74178712566695, -0.19402694205443538, -0.3476213688651768, -0.727346653739616, 7.103498345861823, 6.952087479333073, 6.907703849176556, -13.427439026534557, -13.394340008497238, -14.186934113502502, -91.948149005572, -103.13477108875911, -94.57307050625484, -90.00112374623617, -100.13735284407935, -87.1223509249588, -103.58848022172849, -104.37095319728057, -115.3861316839854, -5.578718153138965, -5.6460491990049775, -6.712165703376144, -15.360754656294986, -15.511617812017604, -15.344179424146816, -101.66146264473598, -113.16073761383693, -102.65259341398875, -104.56991177797318, -104.61484816670418, -109.97850430011749, -104.20495372017226, -107.34540935357413, -108.83686657746634, -97.03218578298888, -98.3203998108705, -108.46446766455969, -108.20496461788814, -95.34192449847858, -94.25167813400428, -104.60008716583252, -115.90450918674469, -104.01627516746521, -7.556936119993537, -7.477890824278205, -6.9514619310697014, -0.1334296216567452, -0.045484272142260807, -0.21519780655702903, -101.4426173468431, -116.21218653519949, -99.692198989292, -7.567373558878899, -7.0938088819384575, -6.719479866325855, -3.8945833568771775, -4.054194649060577, -3.946393949290126, -4.370614759624004, -4.181326761841774, -4.091679979115725, -19.10663457959891, -19.086036704480655, -19.253249078989036, -99.27671896417937, -100.2209495206674, -110.20519079764685, -0.6650068312883377, -0.5441101714968681, -0.6601939797401428, -19.25746137897174, -19.43185629944007, -20.480242768923446, -9.833820641040802, -9.367198713123798, -10.075178772211075, 1.5975876599550247, 2.1938826590776443, 1.7175899893045425, -85.36195149769387, -94.86276418094835, -85.19169671585163, -18.692455043395363, -18.606308897336326, -18.99590459962686, 0.15053842961788177, 0.27799055725336075, -0.6655389368534088, -101.46808419624965, -90.42449061075847, -89.31637499729793, -101.58208854993185, -89.0573005427917, -88.57758041967949, -2.2069720874230114, -2.2797858665386883, -2.6863685945669857, -17.909881417949997, -18.085493390758835, -18.435021882255874, 2.4926555827260017, 2.563990794122219, 2.212482050061226, 0.8007284800211494, 1.0820274228850906, 0.9593391219774787, -2.5331462770700455, -2.4320531114935875, -2.0597156267613173, -116.12611728906631, -104.2094435095787, -103.07116213440895, 0.2526572098334583, 0.36923152705033147, 0.44147436817486607, 5.098895969490201, 4.862192439536244, 5.031123811999947, -7.1833247666557725, -6.977181227256864, -8.22432737549147, 2.5854842563470157, 2.527195384105042, 2.5583029737075123, -2.826834345857307, -2.9546245808402745, -3.2943938175837246, -102.43123829364777, -87.4537904933095, -87.8255221247673, -9.343171427647277, -9.202028820912048, -9.774744669596359, -0.8712192165354935, -1.321614841620132, -1.3592781970898358, -43.57577005277078, -43.7423463339607, -46.500088552633926, -3.3090835685531346, -3.1137326235572544, -3.6419898519913403, -92.51320294042429, -108.38708802064261, -92.674724077185, 2.9533366809288566, 2.93416331956783, 2.431155959765107, -4.4302747497956005, -4.769914383689567, -4.968016008536026, 7.313223148385674, 7.0806325624386375, 7.529152522484452, -1.7140604058901516, -1.868110323945686, -2.011087636152908, -116.69121019045512, -103.19606296221416, -101.64860944698255, -1.1203953102231026, -1.0907748565077782, -1.4583097249269485, 4.899749244252831, 5.131384479502827, 5.289332504073769, -2.0990746791164128, -1.9247935290137974, -2.384781236449882, -9.842050142586231, -10.281704768538475, -10.436678260564804, -4.67935757090649, -5.036169638236373, -5.084553634126991, -112.66576238473257, -102.32455589373907, -101.7760508650293, -13.74466430892548, -14.080047090848296, -14.277951796849578, -17.012836415320635, -17.48344576358795, -17.11061256378889, -94.33247508108616, -94.46663980931044, -111.97815322875977, -102.27144221464793, -100.74455226461093, -104.92171893517177, -4.684445947408676, -4.262488275766373, -3.907759502530098, 1.9016010214885029, 1.8853347649176868, 1.7781128635009082, 1.7350702484448703, 1.1599398156007084, 1.8394950901468547, -0.6200707902511056, -0.9580618341763909, -0.5017846276362832, -89.20712891717753, -93.2746550043424, -89.34681113560995, -0.45668694128593756, -0.2627974835534985, -0.27143151437243773, -19.367578952262804, -19.228993654871985, -22.746113399664566, 0.6555431211988036, 0.48663916687169717, 1.1214734117189948, 5.244901654620961, 4.717951854070023, 4.151681502660111, 3.2992657124996185, 3.4363843724131584, 3.5182345509529114, -7.841466645399734, -7.388118308658406, -7.752783911923572, -12.778761838873237, -12.074347187609732, -12.98215024669966, 5.608348841468484, 5.76369799176851, 6.125880884627492, -0.7243156284093857, -0.7386291995644569, -0.9567513167858124, 1.0565432608127594, 1.382363185286522, 1.8964694887399673, -110.5878114203612, -99.7410127768914, -99.66605792442958, -11.350371633966773, -11.031040792663902, -11.383375321825355, 0.9786136200030597, 0.7580830653508457, 1.4919166204829963, -2.0464698274930413, -2.3620790292819436, -2.5194912453492577, -17.906187921762474, -17.843331322073944, -18.398376852273948, -8.61865133295457, -8.416413853565857, -8.183813004444048, -20.25073679039876, -20.539971793691322, -21.39354793230693, -3.213173046708107, -3.2611425295472145, -4.145224958658218, -12.435507396856949, -12.871975893775627, -12.7872602591912]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14493122781051485, "mean_inference_ms": 0.6437372611539522, "mean_action_processing_ms": 0.09399590297209397, "mean_env_wait_ms": 0.7798866436337063, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 170000, "timesteps_this_iter": 0, "agent_timesteps_total": 510000, "timers": {"sample_time_ms": 10235.349, "sample_throughput": 488.503, "load_time_ms": 0.201, "load_throughput": 24921592.395, "learn_time_ms": 1557.243, "learn_throughput": 3210.802, "update_time_ms": 7.393}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 82.34814682006837, "policy_loss": -0.0015526395223188882, "vf_loss": 82.4072509765625, "vf_explained_var": -0.05400303602218628, "kl": 0.005682359519416607, "entropy": 5.755141115188598, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 170000, "num_agent_steps_sampled": 510000, "num_steps_trained": 170000, "num_agent_steps_trained": 510000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1175, "training_iteration": 34, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-14-51", "timestamp": 1706228091, "time_this_iter_s": 10.250420331954956, "time_total_s": 336.0845105648041, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202837C51F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 336.0845105648041, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 10.746666666666666, "ram_util_percent": 53.20000000000001}}
{"episode_reward_max": 55.400361317209885, "episode_reward_min": -335.2159327790141, "episode_reward_mean": -90.52316651197616, "episode_len_mean": 391.9, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -119.93456705411276}, "policy_reward_max": {"shared_policy": 18.96731141985704}, "policy_reward_mean": {"shared_policy": -30.1743888373254}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-334.44719445705414, -1.2689949646592282, 20.963289674371453, -41.0087131485343, -289.65599060058594, -277.2608275152743, -323.34556510299444, -17.936933055520086, -46.21655189245941, -317.47479367256165, -319.16326424479485, -320.3872296512127, -303.8170532584191, -297.798567250371, -324.5208715200424, -21.986288875341444, -0.39411170035603504, -317.34700287133455, -21.38066230714321, -11.89517195522788, -12.643621500581503, -57.4459203630686, -309.7028592824936, -1.8693109825253487, -59.16956044733526, -29.276198126375675, 5.509060308337212, -265.4164123944938, -56.29466854035855, -0.2370099499821663, -281.20894980430603, -279.216969512403, -7.1731265485286855, -54.430396690964706, 7.269128426909447, 2.8420950248837187, -7.02491501532495, -323.40672293305397, 1.0633631050586558, 14.992212221026392, -22.384833369404106, 7.67098261415957, -9.075852744281306, -277.71055091172457, -28.319944918155684, -3.5521122552454614, -133.81820493936547, -10.06480604410173, -293.57501503825193, 8.318655960261793, -14.168205142021193, 21.923008233308764, -5.593258365988746, -321.5358825996518, -3.6694798916578293, 15.320466227829428, -6.408649444580092, -30.56043317168951, -14.800080843269853, -316.766369143501, -42.102663196623354, -51.60689474269748, -300.77726811915636, -307.9377134144306, -12.854693725705147, 5.565048649907098, 4.7345051541924335, -2.0799172520637796, -271.82859505712986, -0.9909159392118738, -61.342686006799354, 2.2636556997894957, 14.114535011351094, 10.253884635865688, -22.982368865981712, -37.83525927318263, 17.497927717864485, -2.419696144759655, 4.335375934839249, -309.99488212168217, -33.76478774845603, 3.2286133058369018, -6.928040102124243, -54.147896096110365, -25.218878190964475, -62.184256516397014, -10.61954053491354, -38.094743549823775, -59.98958248645068, -17.442598402500167, 8.564976632595062, 7.499374784529195, -34.978407129645376, -12.173897594213514, -22.254494650289416, -47.44674706459048, 55.400361317209885, -293.7305898666382, 11.122883692383738, -335.2159327790141], "episode_lengths": [63, 500, 500, 500, 69, 78, 93, 500, 500, 60, 71, 72, 170, 93, 68, 500, 500, 61, 500, 500, 500, 500, 72, 500, 500, 500, 500, 163, 500, 500, 76, 102, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 89, 500, 500, 500, 500, 95, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 76, 500, 500, 103, 85, 500, 500, 500, 500, 87, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 44, 500, 104], "policy_shared_policy_reward": [-106.77084027727446, -119.93456705411276, -107.74178712566695, -0.19402694205443538, -0.3476213688651768, -0.727346653739616, 7.103498345861823, 6.952087479333073, 6.907703849176556, -13.427439026534557, -13.394340008497238, -14.186934113502502, -91.948149005572, -103.13477108875911, -94.57307050625484, -90.00112374623617, -100.13735284407935, -87.1223509249588, -103.58848022172849, -104.37095319728057, -115.3861316839854, -5.578718153138965, -5.6460491990049775, -6.712165703376144, -15.360754656294986, -15.511617812017604, -15.344179424146816, -101.66146264473598, -113.16073761383693, -102.65259341398875, -104.56991177797318, -104.61484816670418, -109.97850430011749, -104.20495372017226, -107.34540935357413, -108.83686657746634, -97.03218578298888, -98.3203998108705, -108.46446766455969, -108.20496461788814, -95.34192449847858, -94.25167813400428, -104.60008716583252, -115.90450918674469, -104.01627516746521, -7.556936119993537, -7.477890824278205, -6.9514619310697014, -0.1334296216567452, -0.045484272142260807, -0.21519780655702903, -101.4426173468431, -116.21218653519949, -99.692198989292, -7.567373558878899, -7.0938088819384575, -6.719479866325855, -3.8945833568771775, -4.054194649060577, -3.946393949290126, -4.370614759624004, -4.181326761841774, -4.091679979115725, -19.10663457959891, -19.086036704480655, -19.253249078989036, -99.27671896417937, -100.2209495206674, -110.20519079764685, -0.6650068312883377, -0.5441101714968681, -0.6601939797401428, -19.25746137897174, -19.43185629944007, -20.480242768923446, -9.833820641040802, -9.367198713123798, -10.075178772211075, 1.5975876599550247, 2.1938826590776443, 1.7175899893045425, -85.36195149769387, -94.86276418094835, -85.19169671585163, -18.692455043395363, -18.606308897336326, -18.99590459962686, 0.15053842961788177, 0.27799055725336075, -0.6655389368534088, -101.46808419624965, -90.42449061075847, -89.31637499729793, -101.58208854993185, -89.0573005427917, -88.57758041967949, -2.2069720874230114, -2.2797858665386883, -2.6863685945669857, -17.909881417949997, -18.085493390758835, -18.435021882255874, 2.4926555827260017, 2.563990794122219, 2.212482050061226, 0.8007284800211494, 1.0820274228850906, 0.9593391219774787, -2.5331462770700455, -2.4320531114935875, -2.0597156267613173, -116.12611728906631, -104.2094435095787, -103.07116213440895, 0.2526572098334583, 0.36923152705033147, 0.44147436817486607, 5.098895969490201, 4.862192439536244, 5.031123811999947, -7.1833247666557725, -6.977181227256864, -8.22432737549147, 2.5854842563470157, 2.527195384105042, 2.5583029737075123, -2.826834345857307, -2.9546245808402745, -3.2943938175837246, -102.43123829364777, -87.4537904933095, -87.8255221247673, -9.343171427647277, -9.202028820912048, -9.774744669596359, -0.8712192165354935, -1.321614841620132, -1.3592781970898358, -43.57577005277078, -43.7423463339607, -46.500088552633926, -3.3090835685531346, -3.1137326235572544, -3.6419898519913403, -92.51320294042429, -108.38708802064261, -92.674724077185, 2.9533366809288566, 2.93416331956783, 2.431155959765107, -4.4302747497956005, -4.769914383689567, -4.968016008536026, 7.313223148385674, 7.0806325624386375, 7.529152522484452, -1.7140604058901516, -1.868110323945686, -2.011087636152908, -116.69121019045512, -103.19606296221416, -101.64860944698255, -1.1203953102231026, -1.0907748565077782, -1.4583097249269485, 4.899749244252831, 5.131384479502827, 5.289332504073769, -2.0990746791164128, -1.9247935290137974, -2.384781236449882, -9.842050142586231, -10.281704768538475, -10.436678260564804, -4.67935757090649, -5.036169638236373, -5.084553634126991, -112.66576238473257, -102.32455589373907, -101.7760508650293, -13.74466430892548, -14.080047090848296, -14.277951796849578, -17.012836415320635, -17.48344576358795, -17.11061256378889, -94.33247508108616, -94.46663980931044, -111.97815322875977, -102.27144221464793, -100.74455226461093, -104.92171893517177, -4.684445947408676, -4.262488275766373, -3.907759502530098, 1.9016010214885029, 1.8853347649176868, 1.7781128635009082, 1.7350702484448703, 1.1599398156007084, 1.8394950901468547, -0.6200707902511056, -0.9580618341763909, -0.5017846276362832, -89.20712891717753, -93.2746550043424, -89.34681113560995, -0.45668694128593756, -0.2627974835534985, -0.27143151437243773, -19.367578952262804, -19.228993654871985, -22.746113399664566, 0.6555431211988036, 0.48663916687169717, 1.1214734117189948, 5.244901654620961, 4.717951854070023, 4.151681502660111, 3.2992657124996185, 3.4363843724131584, 3.5182345509529114, -7.841466645399734, -7.388118308658406, -7.752783911923572, -12.778761838873237, -12.074347187609732, -12.98215024669966, 5.608348841468484, 5.76369799176851, 6.125880884627492, -0.7243156284093857, -0.7386291995644569, -0.9567513167858124, 1.0565432608127594, 1.382363185286522, 1.8964694887399673, -110.5878114203612, -99.7410127768914, -99.66605792442958, -11.350371633966773, -11.031040792663902, -11.383375321825355, 0.9786136200030597, 0.7580830653508457, 1.4919166204829963, -2.0464698274930413, -2.3620790292819436, -2.5194912453492577, -17.906187921762474, -17.843331322073944, -18.398376852273948, -8.61865133295457, -8.416413853565857, -8.183813004444048, -20.25073679039876, -20.539971793691322, -21.39354793230693, -3.213173046708107, -3.2611425295472145, -4.145224958658218, -12.435507396856949, -12.871975893775627, -12.7872602591912, -19.57756848384937, -19.33503312369188, -21.07698087890943, -5.758594940106079, -5.667559723059341, -6.016443739334747, 2.932525336742401, 3.19611294567585, 2.436338350176811, 2.6011780028541835, 2.4235539635022434, 2.474642818172768, -11.787786667545646, -11.165242378910392, -12.025378083189338, -3.714052056272834, -3.901865844925254, -4.557979693015426, -7.372970260679722, -7.08783165179193, -7.793692737817764, -15.761110340555518, -15.851709326108306, -15.833927397926658, 18.355040555198983, 18.078009342153862, 18.96731141985704, -99.52228391170502, -97.46006453037262, -96.74824142456055, 3.4143413553635185, 3.755318629244954, 3.9532237077752654, -107.39981372406086, -108.13568242390951, -119.68043663104376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14475571919228383, "mean_inference_ms": 0.6438719120408067, "mean_action_processing_ms": 0.0940871343636368, "mean_env_wait_ms": 0.7807062100262558, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 175000, "timesteps_this_iter": 0, "agent_timesteps_total": 525000, "timers": {"sample_time_ms": 10265.831, "sample_throughput": 487.053, "load_time_ms": 0.101, "load_throughput": 49695545.024, "learn_time_ms": 1561.451, "learn_throughput": 3202.151, "update_time_ms": 7.472}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 158.26507263183595, "policy_loss": -0.0024664452113676793, "vf_loss": 158.32576599121094, "vf_explained_var": -0.008313220739364625, "kl": 0.006505738158013842, "entropy": 5.823061466217041, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 175000, "num_agent_steps_sampled": 525000, "num_steps_trained": 175000, "num_agent_steps_trained": 525000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1187, "training_iteration": 35, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-15-01", "timestamp": 1706228101, "time_this_iter_s": 9.8711416721344, "time_total_s": 345.9556522369385, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028453CB80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 345.9556522369385, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 9.414285714285715, "ram_util_percent": 53.22142857142857}}
{"episode_reward_max": 55.400361317209885, "episode_reward_min": -335.2159327790141, "episode_reward_mean": -76.37841230135876, "episode_len_mean": 413.27, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -119.68043663104376}, "policy_reward_max": {"shared_policy": 18.96731141985704}, "policy_reward_mean": {"shared_policy": -25.459470767119594}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-319.16326424479485, -320.3872296512127, -303.8170532584191, -297.798567250371, -324.5208715200424, -21.986288875341444, -0.39411170035603504, -317.34700287133455, -21.38066230714321, -11.89517195522788, -12.643621500581503, -57.4459203630686, -309.7028592824936, -1.8693109825253487, -59.16956044733526, -29.276198126375675, 5.509060308337212, -265.4164123944938, -56.29466854035855, -0.2370099499821663, -281.20894980430603, -279.216969512403, -7.1731265485286855, -54.430396690964706, 7.269128426909447, 2.8420950248837187, -7.02491501532495, -323.40672293305397, 1.0633631050586558, 14.992212221026392, -22.384833369404106, 7.67098261415957, -9.075852744281306, -277.71055091172457, -28.319944918155684, -3.5521122552454614, -133.81820493936547, -10.06480604410173, -293.57501503825193, 8.318655960261793, -14.168205142021193, 21.923008233308764, -5.593258365988746, -321.5358825996518, -3.6694798916578293, 15.320466227829428, -6.408649444580092, -30.56043317168951, -14.800080843269853, -316.766369143501, -42.102663196623354, -51.60689474269748, -300.77726811915636, -307.9377134144306, -12.854693725705147, 5.565048649907098, 4.7345051541924335, -2.0799172520637796, -271.82859505712986, -0.9909159392118738, -61.342686006799354, 2.2636556997894957, 14.114535011351094, 10.253884635865688, -22.982368865981712, -37.83525927318263, 17.497927717864485, -2.419696144759655, 4.335375934839249, -309.99488212168217, -33.76478774845603, 3.2286133058369018, -6.928040102124243, -54.147896096110365, -25.218878190964475, -62.184256516397014, -10.61954053491354, -38.094743549823775, -59.98958248645068, -17.442598402500167, 8.564976632595062, 7.499374784529195, -34.978407129645376, -12.173897594213514, -22.254494650289416, -47.44674706459048, 55.400361317209885, -293.7305898666382, 11.122883692383738, -335.2159327790141, -37.820102497935295, -50.65030884742738, -59.31036646664145, 18.567930316552506, 15.864145390689359, -28.11338762938979, -6.176827318966403, -2.5512928515672684, -56.29942895472051, -6.6872148141264915], "episode_lengths": [71, 72, 170, 93, 68, 500, 500, 61, 500, 500, 500, 500, 72, 500, 500, 500, 500, 163, 500, 500, 76, 102, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 89, 500, 500, 500, 500, 95, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 76, 500, 500, 103, 85, 500, 500, 500, 500, 87, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 44, 500, 104, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-104.56991177797318, -104.61484816670418, -109.97850430011749, -104.20495372017226, -107.34540935357413, -108.83686657746634, -97.03218578298888, -98.3203998108705, -108.46446766455969, -108.20496461788814, -95.34192449847858, -94.25167813400428, -104.60008716583252, -115.90450918674469, -104.01627516746521, -7.556936119993537, -7.477890824278205, -6.9514619310697014, -0.1334296216567452, -0.045484272142260807, -0.21519780655702903, -101.4426173468431, -116.21218653519949, -99.692198989292, -7.567373558878899, -7.0938088819384575, -6.719479866325855, -3.8945833568771775, -4.054194649060577, -3.946393949290126, -4.370614759624004, -4.181326761841774, -4.091679979115725, -19.10663457959891, -19.086036704480655, -19.253249078989036, -99.27671896417937, -100.2209495206674, -110.20519079764685, -0.6650068312883377, -0.5441101714968681, -0.6601939797401428, -19.25746137897174, -19.43185629944007, -20.480242768923446, -9.833820641040802, -9.367198713123798, -10.075178772211075, 1.5975876599550247, 2.1938826590776443, 1.7175899893045425, -85.36195149769387, -94.86276418094835, -85.19169671585163, -18.692455043395363, -18.606308897336326, -18.99590459962686, 0.15053842961788177, 0.27799055725336075, -0.6655389368534088, -101.46808419624965, -90.42449061075847, -89.31637499729793, -101.58208854993185, -89.0573005427917, -88.57758041967949, -2.2069720874230114, -2.2797858665386883, -2.6863685945669857, -17.909881417949997, -18.085493390758835, -18.435021882255874, 2.4926555827260017, 2.563990794122219, 2.212482050061226, 0.8007284800211494, 1.0820274228850906, 0.9593391219774787, -2.5331462770700455, -2.4320531114935875, -2.0597156267613173, -116.12611728906631, -104.2094435095787, -103.07116213440895, 0.2526572098334583, 0.36923152705033147, 0.44147436817486607, 5.098895969490201, 4.862192439536244, 5.031123811999947, -7.1833247666557725, -6.977181227256864, -8.22432737549147, 2.5854842563470157, 2.527195384105042, 2.5583029737075123, -2.826834345857307, -2.9546245808402745, -3.2943938175837246, -102.43123829364777, -87.4537904933095, -87.8255221247673, -9.343171427647277, -9.202028820912048, -9.774744669596359, -0.8712192165354935, -1.321614841620132, -1.3592781970898358, -43.57577005277078, -43.7423463339607, -46.500088552633926, -3.3090835685531346, -3.1137326235572544, -3.6419898519913403, -92.51320294042429, -108.38708802064261, -92.674724077185, 2.9533366809288566, 2.93416331956783, 2.431155959765107, -4.4302747497956005, -4.769914383689567, -4.968016008536026, 7.313223148385674, 7.0806325624386375, 7.529152522484452, -1.7140604058901516, -1.868110323945686, -2.011087636152908, -116.69121019045512, -103.19606296221416, -101.64860944698255, -1.1203953102231026, -1.0907748565077782, -1.4583097249269485, 4.899749244252831, 5.131384479502827, 5.289332504073769, -2.0990746791164128, -1.9247935290137974, -2.384781236449882, -9.842050142586231, -10.281704768538475, -10.436678260564804, -4.67935757090649, -5.036169638236373, -5.084553634126991, -112.66576238473257, -102.32455589373907, -101.7760508650293, -13.74466430892548, -14.080047090848296, -14.277951796849578, -17.012836415320635, -17.48344576358795, -17.11061256378889, -94.33247508108616, -94.46663980931044, -111.97815322875977, -102.27144221464793, -100.74455226461093, -104.92171893517177, -4.684445947408676, -4.262488275766373, -3.907759502530098, 1.9016010214885029, 1.8853347649176868, 1.7781128635009082, 1.7350702484448703, 1.1599398156007084, 1.8394950901468547, -0.6200707902511056, -0.9580618341763909, -0.5017846276362832, -89.20712891717753, -93.2746550043424, -89.34681113560995, -0.45668694128593756, -0.2627974835534985, -0.27143151437243773, -19.367578952262804, -19.228993654871985, -22.746113399664566, 0.6555431211988036, 0.48663916687169717, 1.1214734117189948, 5.244901654620961, 4.717951854070023, 4.151681502660111, 3.2992657124996185, 3.4363843724131584, 3.5182345509529114, -7.841466645399734, -7.388118308658406, -7.752783911923572, -12.778761838873237, -12.074347187609732, -12.98215024669966, 5.608348841468484, 5.76369799176851, 6.125880884627492, -0.7243156284093857, -0.7386291995644569, -0.9567513167858124, 1.0565432608127594, 1.382363185286522, 1.8964694887399673, -110.5878114203612, -99.7410127768914, -99.66605792442958, -11.350371633966773, -11.031040792663902, -11.383375321825355, 0.9786136200030597, 0.7580830653508457, 1.4919166204829963, -2.0464698274930413, -2.3620790292819436, -2.5194912453492577, -17.906187921762474, -17.843331322073944, -18.398376852273948, -8.61865133295457, -8.416413853565857, -8.183813004444048, -20.25073679039876, -20.539971793691322, -21.39354793230693, -3.213173046708107, -3.2611425295472145, -4.145224958658218, -12.435507396856949, -12.871975893775627, -12.7872602591912, -19.57756848384937, -19.33503312369188, -21.07698087890943, -5.758594940106079, -5.667559723059341, -6.016443739334747, 2.932525336742401, 3.19611294567585, 2.436338350176811, 2.6011780028541835, 2.4235539635022434, 2.474642818172768, -11.787786667545646, -11.165242378910392, -12.025378083189338, -3.714052056272834, -3.901865844925254, -4.557979693015426, -7.372970260679722, -7.08783165179193, -7.793692737817764, -15.761110340555518, -15.851709326108306, -15.833927397926658, 18.355040555198983, 18.078009342153862, 18.96731141985704, -99.52228391170502, -97.46006453037262, -96.74824142456055, 3.4143413553635185, 3.755318629244954, 3.9532237077752654, -107.39981372406086, -108.13568242390951, -119.68043663104376, -12.672773748636246, -12.649855315685272, -12.497473433613777, -17.066721955935165, -16.807643959919616, -16.7759429315726, -19.90614442527295, -19.308657631278045, -20.095564410090454, 6.273757894833878, 5.746871833999947, 6.547300587718681, 5.572434542079762, 5.193004151185349, 5.098706697424248, -9.531559308369964, -9.321753044923156, -9.260075276096671, -1.9337067479888645, -2.1867950359980313, -2.056325534979507, -0.9325268119573593, -0.8365189284086227, -0.7822471112012863, -18.831497336427375, -18.866707476476833, -18.601224141816303, -2.08040414750576, -2.3717181980609894, -2.235092468559742]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14439688249351135, "mean_inference_ms": 0.6434216892946384, "mean_action_processing_ms": 0.09396436173765058, "mean_env_wait_ms": 0.7808021736434333, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 180000, "timesteps_this_iter": 0, "agent_timesteps_total": 540000, "timers": {"sample_time_ms": 10169.783, "sample_throughput": 491.653, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1564.609, "learn_throughput": 3195.686, "update_time_ms": 7.479}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 25.016585540771484, "policy_loss": -0.0025335786873249334, "vf_loss": 25.07808837890625, "vf_explained_var": -1.0, "kl": 0.006384642573541073, "entropy": 5.896883630752564, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 180000, "num_agent_steps_sampled": 540000, "num_steps_trained": 180000, "num_agent_steps_trained": 540000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1197, "training_iteration": 36, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-15-11", "timestamp": 1706228111, "time_this_iter_s": 9.953942775726318, "time_total_s": 355.9095950126648, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028453CDC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 355.9095950126648, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 8.085714285714285, "ram_util_percent": 53.32142857142857}}
{"episode_reward_max": 55.400361317209885, "episode_reward_min": -335.2159327790141, "episode_reward_mean": -61.37153235480655, "episode_len_mean": 433.34, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -119.68043663104376}, "policy_reward_max": {"shared_policy": 18.96731141985704}, "policy_reward_mean": {"shared_policy": -20.45717745160219}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-57.4459203630686, -309.7028592824936, -1.8693109825253487, -59.16956044733526, -29.276198126375675, 5.509060308337212, -265.4164123944938, -56.29466854035855, -0.2370099499821663, -281.20894980430603, -279.216969512403, -7.1731265485286855, -54.430396690964706, 7.269128426909447, 2.8420950248837187, -7.02491501532495, -323.40672293305397, 1.0633631050586558, 14.992212221026392, -22.384833369404106, 7.67098261415957, -9.075852744281306, -277.71055091172457, -28.319944918155684, -3.5521122552454614, -133.81820493936547, -10.06480604410173, -293.57501503825193, 8.318655960261793, -14.168205142021193, 21.923008233308764, -5.593258365988746, -321.5358825996518, -3.6694798916578293, 15.320466227829428, -6.408649444580092, -30.56043317168951, -14.800080843269853, -316.766369143501, -42.102663196623354, -51.60689474269748, -300.77726811915636, -307.9377134144306, -12.854693725705147, 5.565048649907098, 4.7345051541924335, -2.0799172520637796, -271.82859505712986, -0.9909159392118738, -61.342686006799354, 2.2636556997894957, 14.114535011351094, 10.253884635865688, -22.982368865981712, -37.83525927318263, 17.497927717864485, -2.419696144759655, 4.335375934839249, -309.99488212168217, -33.76478774845603, 3.2286133058369018, -6.928040102124243, -54.147896096110365, -25.218878190964475, -62.184256516397014, -10.61954053491354, -38.094743549823775, -59.98958248645068, -17.442598402500167, 8.564976632595062, 7.499374784529195, -34.978407129645376, -12.173897594213514, -22.254494650289416, -47.44674706459048, 55.400361317209885, -293.7305898666382, 11.122883692383738, -335.2159327790141, -37.820102497935295, -50.65030884742738, -59.31036646664145, 18.567930316552506, 15.864145390689359, -28.11338762938979, -6.176827318966403, -2.5512928515672684, -56.29942895472051, -6.6872148141264915, -11.331786807626486, -4.314158059656634, -36.341410636901884, 0.18819906562563915, -15.686353780329256, -17.14821233600381, -326.2751701772213, -15.351593643426895, -21.811619989573956, -21.74140573292972, 19.167661618441315], "episode_lengths": [500, 72, 500, 500, 500, 500, 163, 500, 500, 76, 102, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 89, 500, 500, 500, 500, 95, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 76, 500, 500, 103, 85, 500, 500, 500, 500, 87, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 44, 500, 104, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 42, 500, 500, 500, 500], "policy_shared_policy_reward": [-19.10663457959891, -19.086036704480655, -19.253249078989036, -99.27671896417937, -100.2209495206674, -110.20519079764685, -0.6650068312883377, -0.5441101714968681, -0.6601939797401428, -19.25746137897174, -19.43185629944007, -20.480242768923446, -9.833820641040802, -9.367198713123798, -10.075178772211075, 1.5975876599550247, 2.1938826590776443, 1.7175899893045425, -85.36195149769387, -94.86276418094835, -85.19169671585163, -18.692455043395363, -18.606308897336326, -18.99590459962686, 0.15053842961788177, 0.27799055725336075, -0.6655389368534088, -101.46808419624965, -90.42449061075847, -89.31637499729793, -101.58208854993185, -89.0573005427917, -88.57758041967949, -2.2069720874230114, -2.2797858665386883, -2.6863685945669857, -17.909881417949997, -18.085493390758835, -18.435021882255874, 2.4926555827260017, 2.563990794122219, 2.212482050061226, 0.8007284800211494, 1.0820274228850906, 0.9593391219774787, -2.5331462770700455, -2.4320531114935875, -2.0597156267613173, -116.12611728906631, -104.2094435095787, -103.07116213440895, 0.2526572098334583, 0.36923152705033147, 0.44147436817486607, 5.098895969490201, 4.862192439536244, 5.031123811999947, -7.1833247666557725, -6.977181227256864, -8.22432737549147, 2.5854842563470157, 2.527195384105042, 2.5583029737075123, -2.826834345857307, -2.9546245808402745, -3.2943938175837246, -102.43123829364777, -87.4537904933095, -87.8255221247673, -9.343171427647277, -9.202028820912048, -9.774744669596359, -0.8712192165354935, -1.321614841620132, -1.3592781970898358, -43.57577005277078, -43.7423463339607, -46.500088552633926, -3.3090835685531346, -3.1137326235572544, -3.6419898519913403, -92.51320294042429, -108.38708802064261, -92.674724077185, 2.9533366809288566, 2.93416331956783, 2.431155959765107, -4.4302747497956005, -4.769914383689567, -4.968016008536026, 7.313223148385674, 7.0806325624386375, 7.529152522484452, -1.7140604058901516, -1.868110323945686, -2.011087636152908, -116.69121019045512, -103.19606296221416, -101.64860944698255, -1.1203953102231026, -1.0907748565077782, -1.4583097249269485, 4.899749244252831, 5.131384479502827, 5.289332504073769, -2.0990746791164128, -1.9247935290137974, -2.384781236449882, -9.842050142586231, -10.281704768538475, -10.436678260564804, -4.67935757090649, -5.036169638236373, -5.084553634126991, -112.66576238473257, -102.32455589373907, -101.7760508650293, -13.74466430892548, -14.080047090848296, -14.277951796849578, -17.012836415320635, -17.48344576358795, -17.11061256378889, -94.33247508108616, -94.46663980931044, -111.97815322875977, -102.27144221464793, -100.74455226461093, -104.92171893517177, -4.684445947408676, -4.262488275766373, -3.907759502530098, 1.9016010214885029, 1.8853347649176868, 1.7781128635009082, 1.7350702484448703, 1.1599398156007084, 1.8394950901468547, -0.6200707902511056, -0.9580618341763909, -0.5017846276362832, -89.20712891717753, -93.2746550043424, -89.34681113560995, -0.45668694128593756, -0.2627974835534985, -0.27143151437243773, -19.367578952262804, -19.228993654871985, -22.746113399664566, 0.6555431211988036, 0.48663916687169717, 1.1214734117189948, 5.244901654620961, 4.717951854070023, 4.151681502660111, 3.2992657124996185, 3.4363843724131584, 3.5182345509529114, -7.841466645399734, -7.388118308658406, -7.752783911923572, -12.778761838873237, -12.074347187609732, -12.98215024669966, 5.608348841468484, 5.76369799176851, 6.125880884627492, -0.7243156284093857, -0.7386291995644569, -0.9567513167858124, 1.0565432608127594, 1.382363185286522, 1.8964694887399673, -110.5878114203612, -99.7410127768914, -99.66605792442958, -11.350371633966773, -11.031040792663902, -11.383375321825355, 0.9786136200030597, 0.7580830653508457, 1.4919166204829963, -2.0464698274930413, -2.3620790292819436, -2.5194912453492577, -17.906187921762474, -17.843331322073944, -18.398376852273948, -8.61865133295457, -8.416413853565857, -8.183813004444048, -20.25073679039876, -20.539971793691322, -21.39354793230693, -3.213173046708107, -3.2611425295472145, -4.145224958658218, -12.435507396856949, -12.871975893775627, -12.7872602591912, -19.57756848384937, -19.33503312369188, -21.07698087890943, -5.758594940106079, -5.667559723059341, -6.016443739334747, 2.932525336742401, 3.19611294567585, 2.436338350176811, 2.6011780028541835, 2.4235539635022434, 2.474642818172768, -11.787786667545646, -11.165242378910392, -12.025378083189338, -3.714052056272834, -3.901865844925254, -4.557979693015426, -7.372970260679722, -7.08783165179193, -7.793692737817764, -15.761110340555518, -15.851709326108306, -15.833927397926658, 18.355040555198983, 18.078009342153862, 18.96731141985704, -99.52228391170502, -97.46006453037262, -96.74824142456055, 3.4143413553635185, 3.755318629244954, 3.9532237077752654, -107.39981372406086, -108.13568242390951, -119.68043663104376, -12.672773748636246, -12.649855315685272, -12.497473433613777, -17.066721955935165, -16.807643959919616, -16.7759429315726, -19.90614442527295, -19.308657631278045, -20.095564410090454, 6.273757894833878, 5.746871833999947, 6.547300587718681, 5.572434542079762, 5.193004151185349, 5.098706697424248, -9.531559308369964, -9.321753044923156, -9.260075276096671, -1.9337067479888645, -2.1867950359980313, -2.056325534979507, -0.9325268119573593, -0.8365189284086227, -0.7822471112012863, -18.831497336427375, -18.866707476476833, -18.601224141816303, -2.08040414750576, -2.3717181980609894, -2.235092468559742, -3.523933470249176, -3.496989544481039, -4.310863792896271, -1.6472499022881237, -1.3163644025723187, -1.3505437547961918, -11.86665350695452, -11.848231201370567, -12.626525928576797, 0.10233629743257211, 0.1728571231166427, -0.08699435492357566, -5.845076491435378, -4.751270872851222, -5.090006416042655, -5.752627586325019, -5.779665519793838, -5.615919229884952, -116.82012991110484, -103.61132533351581, -105.84371493260066, -5.076556541025639, -5.284011736512184, -4.991025365889072, -7.211595367640257, -7.1979481764137745, -7.402076445519924, -7.753882596890136, -7.375557387868568, -6.611965748171016, 6.706865823517234, 6.1591688195864265, 6.301626975337655]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1439126309222823, "mean_inference_ms": 0.6436324241443159, "mean_action_processing_ms": 0.0939962978143741, "mean_env_wait_ms": 0.7816577290956576, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 185000, "timesteps_this_iter": 0, "agent_timesteps_total": 555000, "timers": {"sample_time_ms": 10124.701, "sample_throughput": 493.842, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1563.157, "learn_throughput": 3198.655, "update_time_ms": 7.373}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 69.67573776245118, "policy_loss": -0.0024281513589449856, "vf_loss": 69.73889465332032, "vf_explained_var": -0.01279541254043579, "kl": 0.005578579421855598, "entropy": 6.072619009017944, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 185000, "num_agent_steps_sampled": 555000, "num_steps_trained": 185000, "num_agent_steps_trained": 555000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1208, "training_iteration": 37, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-15-22", "timestamp": 1706228122, "time_this_iter_s": 10.372485637664795, "time_total_s": 366.2820806503296, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202825D19D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 366.2820806503296, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 7.306666666666666, "ram_util_percent": 53.533333333333324}}
{"episode_reward_max": 55.400361317209885, "episode_reward_min": -349.88043539226055, "episode_reward_mean": -54.70042854283471, "episode_len_mean": 442.35, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -119.68043663104376}, "policy_reward_max": {"shared_policy": 18.96731141985704}, "policy_reward_mean": {"shared_policy": -18.23347618094491}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-279.216969512403, -7.1731265485286855, -54.430396690964706, 7.269128426909447, 2.8420950248837187, -7.02491501532495, -323.40672293305397, 1.0633631050586558, 14.992212221026392, -22.384833369404106, 7.67098261415957, -9.075852744281306, -277.71055091172457, -28.319944918155684, -3.5521122552454614, -133.81820493936547, -10.06480604410173, -293.57501503825193, 8.318655960261793, -14.168205142021193, 21.923008233308764, -5.593258365988746, -321.5358825996518, -3.6694798916578293, 15.320466227829428, -6.408649444580092, -30.56043317168951, -14.800080843269853, -316.766369143501, -42.102663196623354, -51.60689474269748, -300.77726811915636, -307.9377134144306, -12.854693725705147, 5.565048649907098, 4.7345051541924335, -2.0799172520637796, -271.82859505712986, -0.9909159392118738, -61.342686006799354, 2.2636556997894957, 14.114535011351094, 10.253884635865688, -22.982368865981712, -37.83525927318263, 17.497927717864485, -2.419696144759655, 4.335375934839249, -309.99488212168217, -33.76478774845603, 3.2286133058369018, -6.928040102124243, -54.147896096110365, -25.218878190964475, -62.184256516397014, -10.61954053491354, -38.094743549823775, -59.98958248645068, -17.442598402500167, 8.564976632595062, 7.499374784529195, -34.978407129645376, -12.173897594213514, -22.254494650289416, -47.44674706459048, 55.400361317209885, -293.7305898666382, 11.122883692383738, -335.2159327790141, -37.820102497935295, -50.65030884742738, -59.31036646664145, 18.567930316552506, 15.864145390689359, -28.11338762938979, -6.176827318966403, -2.5512928515672684, -56.29942895472051, -6.6872148141264915, -11.331786807626486, -4.314158059656634, -36.341410636901884, 0.18819906562563915, -15.686353780329256, -17.14821233600381, -326.2751701772213, -15.351593643426895, -21.811619989573956, -21.74140573292972, 19.167661618441315, -19.513440094888225, -14.18073346465826, 25.19572536647317, -349.88043539226055, -17.08098530024293, 14.592745035886736, -20.62692395597699, -1.4536785855889605, -0.628817163407831, -4.424904830753803], "episode_lengths": [102, 500, 500, 500, 500, 500, 75, 500, 500, 500, 500, 500, 89, 500, 500, 500, 500, 95, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 76, 500, 500, 103, 85, 500, 500, 500, 500, 87, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 44, 500, 104, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 42, 500, 500, 500, 500, 500, 500, 500, 212, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-101.58208854993185, -89.0573005427917, -88.57758041967949, -2.2069720874230114, -2.2797858665386883, -2.6863685945669857, -17.909881417949997, -18.085493390758835, -18.435021882255874, 2.4926555827260017, 2.563990794122219, 2.212482050061226, 0.8007284800211494, 1.0820274228850906, 0.9593391219774787, -2.5331462770700455, -2.4320531114935875, -2.0597156267613173, -116.12611728906631, -104.2094435095787, -103.07116213440895, 0.2526572098334583, 0.36923152705033147, 0.44147436817486607, 5.098895969490201, 4.862192439536244, 5.031123811999947, -7.1833247666557725, -6.977181227256864, -8.22432737549147, 2.5854842563470157, 2.527195384105042, 2.5583029737075123, -2.826834345857307, -2.9546245808402745, -3.2943938175837246, -102.43123829364777, -87.4537904933095, -87.8255221247673, -9.343171427647277, -9.202028820912048, -9.774744669596359, -0.8712192165354935, -1.321614841620132, -1.3592781970898358, -43.57577005277078, -43.7423463339607, -46.500088552633926, -3.3090835685531346, -3.1137326235572544, -3.6419898519913403, -92.51320294042429, -108.38708802064261, -92.674724077185, 2.9533366809288566, 2.93416331956783, 2.431155959765107, -4.4302747497956005, -4.769914383689567, -4.968016008536026, 7.313223148385674, 7.0806325624386375, 7.529152522484452, -1.7140604058901516, -1.868110323945686, -2.011087636152908, -116.69121019045512, -103.19606296221416, -101.64860944698255, -1.1203953102231026, -1.0907748565077782, -1.4583097249269485, 4.899749244252831, 5.131384479502827, 5.289332504073769, -2.0990746791164128, -1.9247935290137974, -2.384781236449882, -9.842050142586231, -10.281704768538475, -10.436678260564804, -4.67935757090649, -5.036169638236373, -5.084553634126991, -112.66576238473257, -102.32455589373907, -101.7760508650293, -13.74466430892548, -14.080047090848296, -14.277951796849578, -17.012836415320635, -17.48344576358795, -17.11061256378889, -94.33247508108616, -94.46663980931044, -111.97815322875977, -102.27144221464793, -100.74455226461093, -104.92171893517177, -4.684445947408676, -4.262488275766373, -3.907759502530098, 1.9016010214885029, 1.8853347649176868, 1.7781128635009082, 1.7350702484448703, 1.1599398156007084, 1.8394950901468547, -0.6200707902511056, -0.9580618341763909, -0.5017846276362832, -89.20712891717753, -93.2746550043424, -89.34681113560995, -0.45668694128593756, -0.2627974835534985, -0.27143151437243773, -19.367578952262804, -19.228993654871985, -22.746113399664566, 0.6555431211988036, 0.48663916687169717, 1.1214734117189948, 5.244901654620961, 4.717951854070023, 4.151681502660111, 3.2992657124996185, 3.4363843724131584, 3.5182345509529114, -7.841466645399734, -7.388118308658406, -7.752783911923572, -12.778761838873237, -12.074347187609732, -12.98215024669966, 5.608348841468484, 5.76369799176851, 6.125880884627492, -0.7243156284093857, -0.7386291995644569, -0.9567513167858124, 1.0565432608127594, 1.382363185286522, 1.8964694887399673, -110.5878114203612, -99.7410127768914, -99.66605792442958, -11.350371633966773, -11.031040792663902, -11.383375321825355, 0.9786136200030597, 0.7580830653508457, 1.4919166204829963, -2.0464698274930413, -2.3620790292819436, -2.5194912453492577, -17.906187921762474, -17.843331322073944, -18.398376852273948, -8.61865133295457, -8.416413853565857, -8.183813004444048, -20.25073679039876, -20.539971793691322, -21.39354793230693, -3.213173046708107, -3.2611425295472145, -4.145224958658218, -12.435507396856949, -12.871975893775627, -12.7872602591912, -19.57756848384937, -19.33503312369188, -21.07698087890943, -5.758594940106079, -5.667559723059341, -6.016443739334747, 2.932525336742401, 3.19611294567585, 2.436338350176811, 2.6011780028541835, 2.4235539635022434, 2.474642818172768, -11.787786667545646, -11.165242378910392, -12.025378083189338, -3.714052056272834, -3.901865844925254, -4.557979693015426, -7.372970260679722, -7.08783165179193, -7.793692737817764, -15.761110340555518, -15.851709326108306, -15.833927397926658, 18.355040555198983, 18.078009342153862, 18.96731141985704, -99.52228391170502, -97.46006453037262, -96.74824142456055, 3.4143413553635185, 3.755318629244954, 3.9532237077752654, -107.39981372406086, -108.13568242390951, -119.68043663104376, -12.672773748636246, -12.649855315685272, -12.497473433613777, -17.066721955935165, -16.807643959919616, -16.7759429315726, -19.90614442527295, -19.308657631278045, -20.095564410090454, 6.273757894833878, 5.746871833999947, 6.547300587718681, 5.572434542079762, 5.193004151185349, 5.098706697424248, -9.531559308369964, -9.321753044923156, -9.260075276096671, -1.9337067479888645, -2.1867950359980313, -2.056325534979507, -0.9325268119573593, -0.8365189284086227, -0.7822471112012863, -18.831497336427375, -18.866707476476833, -18.601224141816303, -2.08040414750576, -2.3717181980609894, -2.235092468559742, -3.523933470249176, -3.496989544481039, -4.310863792896271, -1.6472499022881237, -1.3163644025723187, -1.3505437547961918, -11.86665350695452, -11.848231201370567, -12.626525928576797, 0.10233629743257211, 0.1728571231166427, -0.08699435492357566, -5.845076491435378, -4.751270872851222, -5.090006416042655, -5.752627586325019, -5.779665519793838, -5.615919229884952, -116.82012991110484, -103.61132533351581, -105.84371493260066, -5.076556541025639, -5.284011736512184, -4.991025365889072, -7.211595367640257, -7.1979481764137745, -7.402076445519924, -7.753882596890136, -7.375557387868568, -6.611965748171016, 6.706865823517234, 6.1591688195864265, 6.301626975337655, -6.466121586660549, -6.535613040129348, -6.511705468098327, -4.884642317891121, -4.720377430319786, -4.575713716447353, 8.172132308284432, 8.5352998326222, 8.488293225566537, -118.98279984792075, -114.94015586872897, -115.95747967561087, -5.689308454593032, -5.721259673436492, -5.670417172213405, 4.849968189994485, 4.737232411901147, 5.005544433991105, -6.605370526512473, -6.56557269146046, -7.455980738004058, -0.2508038704594071, -0.20096079011759116, -1.0019139250119622, -0.12520863612493827, 0.22714649389186548, -0.7307550211747582, -1.4671925902366638, -1.1695277020335197, -1.7881845384836197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14366726719139714, "mean_inference_ms": 0.6448323577805009, "mean_action_processing_ms": 0.0940752900709914, "mean_env_wait_ms": 0.7831257318156823, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 190000, "timesteps_this_iter": 0, "agent_timesteps_total": 570000, "timers": {"sample_time_ms": 10137.303, "sample_throughput": 493.228, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1577.845, "learn_throughput": 3168.879, "update_time_ms": 7.48}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 114.39058990478516, "policy_loss": -0.0024980280273997567, "vf_loss": 114.4557861328125, "vf_explained_var": -0.08556593656539917, "kl": 0.008576531041764958, "entropy": 6.270004653930664, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 190000, "num_agent_steps_sampled": 570000, "num_steps_trained": 190000, "num_agent_steps_trained": 570000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1218, "training_iteration": 38, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-15-32", "timestamp": 1706228132, "time_this_iter_s": 10.632595777511597, "time_total_s": 376.9146764278412, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282577550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 376.9146764278412, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 7.046666666666669, "ram_util_percent": 52.87999999999999}}
{"episode_reward_max": 55.400361317209885, "episode_reward_min": -349.88043539226055, "episode_reward_mean": -50.65960047394852, "episode_len_mean": 446.5, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -121.63940258820853}, "policy_reward_max": {"shared_policy": 18.96731141985704}, "policy_reward_mean": {"shared_policy": -16.886533491316175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.075852744281306, -277.71055091172457, -28.319944918155684, -3.5521122552454614, -133.81820493936547, -10.06480604410173, -293.57501503825193, 8.318655960261793, -14.168205142021193, 21.923008233308764, -5.593258365988746, -321.5358825996518, -3.6694798916578293, 15.320466227829428, -6.408649444580092, -30.56043317168951, -14.800080843269853, -316.766369143501, -42.102663196623354, -51.60689474269748, -300.77726811915636, -307.9377134144306, -12.854693725705147, 5.565048649907098, 4.7345051541924335, -2.0799172520637796, -271.82859505712986, -0.9909159392118738, -61.342686006799354, 2.2636556997894957, 14.114535011351094, 10.253884635865688, -22.982368865981712, -37.83525927318263, 17.497927717864485, -2.419696144759655, 4.335375934839249, -309.99488212168217, -33.76478774845603, 3.2286133058369018, -6.928040102124243, -54.147896096110365, -25.218878190964475, -62.184256516397014, -10.61954053491354, -38.094743549823775, -59.98958248645068, -17.442598402500167, 8.564976632595062, 7.499374784529195, -34.978407129645376, -12.173897594213514, -22.254494650289416, -47.44674706459048, 55.400361317209885, -293.7305898666382, 11.122883692383738, -335.2159327790141, -37.820102497935295, -50.65030884742738, -59.31036646664145, 18.567930316552506, 15.864145390689359, -28.11338762938979, -6.176827318966403, -2.5512928515672684, -56.29942895472051, -6.6872148141264915, -11.331786807626486, -4.314158059656634, -36.341410636901884, 0.18819906562563915, -15.686353780329256, -17.14821233600381, -326.2751701772213, -15.351593643426895, -21.811619989573956, -21.74140573292972, 19.167661618441315, -19.513440094888225, -14.18073346465826, 25.19572536647317, -349.88043539226055, -17.08098530024293, 14.592745035886736, -20.62692395597699, -1.4536785855889605, -0.628817163407831, -4.424904830753803, -0.371148526668577, 7.878413490951061, -0.323971974081374, 0.7586849033832408, 16.88312754034996, 7.054913148283958, 10.905322618782506, -333.65802088379866, 2.9784524124115563, -3.217849105596571, 35.39570058695969], "episode_lengths": [500, 89, 500, 500, 500, 500, 95, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 76, 500, 500, 103, 85, 500, 500, 500, 500, 87, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 44, 500, 104, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 42, 500, 500, 500, 500, 500, 500, 500, 212, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 92, 500, 500, 500], "policy_shared_policy_reward": [-2.826834345857307, -2.9546245808402745, -3.2943938175837246, -102.43123829364777, -87.4537904933095, -87.8255221247673, -9.343171427647277, -9.202028820912048, -9.774744669596359, -0.8712192165354935, -1.321614841620132, -1.3592781970898358, -43.57577005277078, -43.7423463339607, -46.500088552633926, -3.3090835685531346, -3.1137326235572544, -3.6419898519913403, -92.51320294042429, -108.38708802064261, -92.674724077185, 2.9533366809288566, 2.93416331956783, 2.431155959765107, -4.4302747497956005, -4.769914383689567, -4.968016008536026, 7.313223148385674, 7.0806325624386375, 7.529152522484452, -1.7140604058901516, -1.868110323945686, -2.011087636152908, -116.69121019045512, -103.19606296221416, -101.64860944698255, -1.1203953102231026, -1.0907748565077782, -1.4583097249269485, 4.899749244252831, 5.131384479502827, 5.289332504073769, -2.0990746791164128, -1.9247935290137974, -2.384781236449882, -9.842050142586231, -10.281704768538475, -10.436678260564804, -4.67935757090649, -5.036169638236373, -5.084553634126991, -112.66576238473257, -102.32455589373907, -101.7760508650293, -13.74466430892548, -14.080047090848296, -14.277951796849578, -17.012836415320635, -17.48344576358795, -17.11061256378889, -94.33247508108616, -94.46663980931044, -111.97815322875977, -102.27144221464793, -100.74455226461093, -104.92171893517177, -4.684445947408676, -4.262488275766373, -3.907759502530098, 1.9016010214885029, 1.8853347649176868, 1.7781128635009082, 1.7350702484448703, 1.1599398156007084, 1.8394950901468547, -0.6200707902511056, -0.9580618341763909, -0.5017846276362832, -89.20712891717753, -93.2746550043424, -89.34681113560995, -0.45668694128593756, -0.2627974835534985, -0.27143151437243773, -19.367578952262804, -19.228993654871985, -22.746113399664566, 0.6555431211988036, 0.48663916687169717, 1.1214734117189948, 5.244901654620961, 4.717951854070023, 4.151681502660111, 3.2992657124996185, 3.4363843724131584, 3.5182345509529114, -7.841466645399734, -7.388118308658406, -7.752783911923572, -12.778761838873237, -12.074347187609732, -12.98215024669966, 5.608348841468484, 5.76369799176851, 6.125880884627492, -0.7243156284093857, -0.7386291995644569, -0.9567513167858124, 1.0565432608127594, 1.382363185286522, 1.8964694887399673, -110.5878114203612, -99.7410127768914, -99.66605792442958, -11.350371633966773, -11.031040792663902, -11.383375321825355, 0.9786136200030597, 0.7580830653508457, 1.4919166204829963, -2.0464698274930413, -2.3620790292819436, -2.5194912453492577, -17.906187921762474, -17.843331322073944, -18.398376852273948, -8.61865133295457, -8.416413853565857, -8.183813004444048, -20.25073679039876, -20.539971793691322, -21.39354793230693, -3.213173046708107, -3.2611425295472145, -4.145224958658218, -12.435507396856949, -12.871975893775627, -12.7872602591912, -19.57756848384937, -19.33503312369188, -21.07698087890943, -5.758594940106079, -5.667559723059341, -6.016443739334747, 2.932525336742401, 3.19611294567585, 2.436338350176811, 2.6011780028541835, 2.4235539635022434, 2.474642818172768, -11.787786667545646, -11.165242378910392, -12.025378083189338, -3.714052056272834, -3.901865844925254, -4.557979693015426, -7.372970260679722, -7.08783165179193, -7.793692737817764, -15.761110340555518, -15.851709326108306, -15.833927397926658, 18.355040555198983, 18.078009342153862, 18.96731141985704, -99.52228391170502, -97.46006453037262, -96.74824142456055, 3.4143413553635185, 3.755318629244954, 3.9532237077752654, -107.39981372406086, -108.13568242390951, -119.68043663104376, -12.672773748636246, -12.649855315685272, -12.497473433613777, -17.066721955935165, -16.807643959919616, -16.7759429315726, -19.90614442527295, -19.308657631278045, -20.095564410090454, 6.273757894833878, 5.746871833999947, 6.547300587718681, 5.572434542079762, 5.193004151185349, 5.098706697424248, -9.531559308369964, -9.321753044923156, -9.260075276096671, -1.9337067479888645, -2.1867950359980313, -2.056325534979507, -0.9325268119573593, -0.8365189284086227, -0.7822471112012863, -18.831497336427375, -18.866707476476833, -18.601224141816303, -2.08040414750576, -2.3717181980609894, -2.235092468559742, -3.523933470249176, -3.496989544481039, -4.310863792896271, -1.6472499022881237, -1.3163644025723187, -1.3505437547961918, -11.86665350695452, -11.848231201370567, -12.626525928576797, 0.10233629743257211, 0.1728571231166427, -0.08699435492357566, -5.845076491435378, -4.751270872851222, -5.090006416042655, -5.752627586325019, -5.779665519793838, -5.615919229884952, -116.82012991110484, -103.61132533351581, -105.84371493260066, -5.076556541025639, -5.284011736512184, -4.991025365889072, -7.211595367640257, -7.1979481764137745, -7.402076445519924, -7.753882596890136, -7.375557387868568, -6.611965748171016, 6.706865823517234, 6.1591688195864265, 6.301626975337655, -6.466121586660549, -6.535613040129348, -6.511705468098327, -4.884642317891121, -4.720377430319786, -4.575713716447353, 8.172132308284432, 8.5352998326222, 8.488293225566537, -118.98279984792075, -114.94015586872897, -115.95747967561087, -5.689308454593032, -5.721259673436492, -5.670417172213405, 4.849968189994485, 4.737232411901147, 5.005544433991105, -6.605370526512473, -6.56557269146046, -7.455980738004058, -0.2508038704594071, -0.20096079011759116, -1.0019139250119622, -0.12520863612493827, 0.22714649389186548, -0.7307550211747582, -1.4671925902366638, -1.1695277020335197, -1.7881845384836197, 0.09311682979264901, -0.20001672705015494, -0.2642486294110711, 2.844714805483818, 2.729634441435337, 2.304064244031906, -0.042480709652110704, 0.29730715878152125, -0.5787984232107846, 0.4437042375405582, 0.1977265228827747, 0.11725414295990788, 5.508361533284187, 5.605033114552498, 5.769732892513275, 2.331946589052677, 2.237528547644615, 2.485438011586666, 3.803329405685261, 3.512969364722565, 3.58902384837468, -105.16054146488509, -106.85807683070502, -121.63940258820853, 0.5676474471886905, 1.3634701774766, 1.0473347877462658, -1.1878836800654824, -0.9945342590411599, -1.0354311664899285, 11.678274969259888, 11.702972563604504, 12.014453054095299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14335280074900375, "mean_inference_ms": 0.6455021893958995, "mean_action_processing_ms": 0.09416034993603334, "mean_env_wait_ms": 0.7841611979825543, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 195000, "timesteps_this_iter": 0, "agent_timesteps_total": 585000, "timers": {"sample_time_ms": 10257.184, "sample_throughput": 487.463, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1585.379, "learn_throughput": 3153.82, "update_time_ms": 7.524}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 95.66856460571289, "policy_loss": -0.0024955897651286916, "vf_loss": 95.73373489379883, "vf_explained_var": 0.01915283203125, "kl": 0.00887558431423018, "entropy": 6.267274999618531, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 195000, "num_agent_steps_sampled": 585000, "num_steps_trained": 195000, "num_agent_steps_trained": 585000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1229, "training_iteration": 39, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-15-43", "timestamp": 1706228143, "time_this_iter_s": 11.056365728378296, "time_total_s": 387.9710421562195, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202846E49D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 387.9710421562195, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 9.586666666666668, "ram_util_percent": 49.900000000000006}}
{"episode_reward_max": 55.400361317209885, "episode_reward_min": -349.88043539226055, "episode_reward_mean": -43.56888193615597, "episode_len_mean": 454.66, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -121.63940258820853}, "policy_reward_max": {"shared_policy": 18.96731141985704}, "policy_reward_mean": {"shared_policy": -14.522960645385325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.593258365988746, -321.5358825996518, -3.6694798916578293, 15.320466227829428, -6.408649444580092, -30.56043317168951, -14.800080843269853, -316.766369143501, -42.102663196623354, -51.60689474269748, -300.77726811915636, -307.9377134144306, -12.854693725705147, 5.565048649907098, 4.7345051541924335, -2.0799172520637796, -271.82859505712986, -0.9909159392118738, -61.342686006799354, 2.2636556997894957, 14.114535011351094, 10.253884635865688, -22.982368865981712, -37.83525927318263, 17.497927717864485, -2.419696144759655, 4.335375934839249, -309.99488212168217, -33.76478774845603, 3.2286133058369018, -6.928040102124243, -54.147896096110365, -25.218878190964475, -62.184256516397014, -10.61954053491354, -38.094743549823775, -59.98958248645068, -17.442598402500167, 8.564976632595062, 7.499374784529195, -34.978407129645376, -12.173897594213514, -22.254494650289416, -47.44674706459048, 55.400361317209885, -293.7305898666382, 11.122883692383738, -335.2159327790141, -37.820102497935295, -50.65030884742738, -59.31036646664145, 18.567930316552506, 15.864145390689359, -28.11338762938979, -6.176827318966403, -2.5512928515672684, -56.29942895472051, -6.6872148141264915, -11.331786807626486, -4.314158059656634, -36.341410636901884, 0.18819906562563915, -15.686353780329256, -17.14821233600381, -326.2751701772213, -15.351593643426895, -21.811619989573956, -21.74140573292972, 19.167661618441315, -19.513440094888225, -14.18073346465826, 25.19572536647317, -349.88043539226055, -17.08098530024293, 14.592745035886736, -20.62692395597699, -1.4536785855889605, -0.628817163407831, -4.424904830753803, -0.371148526668577, 7.878413490951061, -0.323971974081374, 0.7586849033832408, 16.88312754034996, 7.054913148283958, 10.905322618782506, -333.65802088379866, 2.9784524124115563, -3.217849105596571, 35.39570058695969, -30.471078604459763, -13.836379468441038, 6.415416724979863, -12.029791876673727, -26.07709232717754, 7.884379945695386, 27.761606823652954, -3.5009599328041077, 18.934826374053955, -6.052101679146304], "episode_lengths": [500, 63, 500, 500, 500, 500, 500, 76, 500, 500, 103, 85, 500, 500, 500, 500, 87, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 44, 500, 104, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 42, 500, 500, 500, 500, 500, 500, 500, 212, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 92, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-1.7140604058901516, -1.868110323945686, -2.011087636152908, -116.69121019045512, -103.19606296221416, -101.64860944698255, -1.1203953102231026, -1.0907748565077782, -1.4583097249269485, 4.899749244252831, 5.131384479502827, 5.289332504073769, -2.0990746791164128, -1.9247935290137974, -2.384781236449882, -9.842050142586231, -10.281704768538475, -10.436678260564804, -4.67935757090649, -5.036169638236373, -5.084553634126991, -112.66576238473257, -102.32455589373907, -101.7760508650293, -13.74466430892548, -14.080047090848296, -14.277951796849578, -17.012836415320635, -17.48344576358795, -17.11061256378889, -94.33247508108616, -94.46663980931044, -111.97815322875977, -102.27144221464793, -100.74455226461093, -104.92171893517177, -4.684445947408676, -4.262488275766373, -3.907759502530098, 1.9016010214885029, 1.8853347649176868, 1.7781128635009082, 1.7350702484448703, 1.1599398156007084, 1.8394950901468547, -0.6200707902511056, -0.9580618341763909, -0.5017846276362832, -89.20712891717753, -93.2746550043424, -89.34681113560995, -0.45668694128593756, -0.2627974835534985, -0.27143151437243773, -19.367578952262804, -19.228993654871985, -22.746113399664566, 0.6555431211988036, 0.48663916687169717, 1.1214734117189948, 5.244901654620961, 4.717951854070023, 4.151681502660111, 3.2992657124996185, 3.4363843724131584, 3.5182345509529114, -7.841466645399734, -7.388118308658406, -7.752783911923572, -12.778761838873237, -12.074347187609732, -12.98215024669966, 5.608348841468484, 5.76369799176851, 6.125880884627492, -0.7243156284093857, -0.7386291995644569, -0.9567513167858124, 1.0565432608127594, 1.382363185286522, 1.8964694887399673, -110.5878114203612, -99.7410127768914, -99.66605792442958, -11.350371633966773, -11.031040792663902, -11.383375321825355, 0.9786136200030597, 0.7580830653508457, 1.4919166204829963, -2.0464698274930413, -2.3620790292819436, -2.5194912453492577, -17.906187921762474, -17.843331322073944, -18.398376852273948, -8.61865133295457, -8.416413853565857, -8.183813004444048, -20.25073679039876, -20.539971793691322, -21.39354793230693, -3.213173046708107, -3.2611425295472145, -4.145224958658218, -12.435507396856949, -12.871975893775627, -12.7872602591912, -19.57756848384937, -19.33503312369188, -21.07698087890943, -5.758594940106079, -5.667559723059341, -6.016443739334747, 2.932525336742401, 3.19611294567585, 2.436338350176811, 2.6011780028541835, 2.4235539635022434, 2.474642818172768, -11.787786667545646, -11.165242378910392, -12.025378083189338, -3.714052056272834, -3.901865844925254, -4.557979693015426, -7.372970260679722, -7.08783165179193, -7.793692737817764, -15.761110340555518, -15.851709326108306, -15.833927397926658, 18.355040555198983, 18.078009342153862, 18.96731141985704, -99.52228391170502, -97.46006453037262, -96.74824142456055, 3.4143413553635185, 3.755318629244954, 3.9532237077752654, -107.39981372406086, -108.13568242390951, -119.68043663104376, -12.672773748636246, -12.649855315685272, -12.497473433613777, -17.066721955935165, -16.807643959919616, -16.7759429315726, -19.90614442527295, -19.308657631278045, -20.095564410090454, 6.273757894833878, 5.746871833999947, 6.547300587718681, 5.572434542079762, 5.193004151185349, 5.098706697424248, -9.531559308369964, -9.321753044923156, -9.260075276096671, -1.9337067479888645, -2.1867950359980313, -2.056325534979507, -0.9325268119573593, -0.8365189284086227, -0.7822471112012863, -18.831497336427375, -18.866707476476833, -18.601224141816303, -2.08040414750576, -2.3717181980609894, -2.235092468559742, -3.523933470249176, -3.496989544481039, -4.310863792896271, -1.6472499022881237, -1.3163644025723187, -1.3505437547961918, -11.86665350695452, -11.848231201370567, -12.626525928576797, 0.10233629743257211, 0.1728571231166427, -0.08699435492357566, -5.845076491435378, -4.751270872851222, -5.090006416042655, -5.752627586325019, -5.779665519793838, -5.615919229884952, -116.82012991110484, -103.61132533351581, -105.84371493260066, -5.076556541025639, -5.284011736512184, -4.991025365889072, -7.211595367640257, -7.1979481764137745, -7.402076445519924, -7.753882596890136, -7.375557387868568, -6.611965748171016, 6.706865823517234, 6.1591688195864265, 6.301626975337655, -6.466121586660549, -6.535613040129348, -6.511705468098327, -4.884642317891121, -4.720377430319786, -4.575713716447353, 8.172132308284432, 8.5352998326222, 8.488293225566537, -118.98279984792075, -114.94015586872897, -115.95747967561087, -5.689308454593032, -5.721259673436492, -5.670417172213405, 4.849968189994485, 4.737232411901147, 5.005544433991105, -6.605370526512473, -6.56557269146046, -7.455980738004058, -0.2508038704594071, -0.20096079011759116, -1.0019139250119622, -0.12520863612493827, 0.22714649389186548, -0.7307550211747582, -1.4671925902366638, -1.1695277020335197, -1.7881845384836197, 0.09311682979264901, -0.20001672705015494, -0.2642486294110711, 2.844714805483818, 2.729634441435337, 2.304064244031906, -0.042480709652110704, 0.29730715878152125, -0.5787984232107846, 0.4437042375405582, 0.1977265228827747, 0.11725414295990788, 5.508361533284187, 5.605033114552498, 5.769732892513275, 2.331946589052677, 2.237528547644615, 2.485438011586666, 3.803329405685261, 3.512969364722565, 3.58902384837468, -105.16054146488509, -106.85807683070502, -121.63940258820853, 0.5676474471886905, 1.3634701774766, 1.0473347877462658, -1.1878836800654824, -0.9945342590411599, -1.0354311664899285, 11.678274969259888, 11.702972563604504, 12.014453054095299, -10.187064334750175, -10.10692223906517, -10.177092030644417, -4.6800560032328065, -4.355729622145503, -4.800593843062728, 2.068527308603123, 2.1222642858823093, 2.224625130494431, -4.280173589785903, -3.638820533951133, -4.110797752936691, -8.497167850534126, -8.369034739832088, -9.210889736811325, 2.683553603788212, 2.439941336711243, 2.760885005195931, 9.398746064553649, 9.209045621256024, 9.153815137843281, -1.1435520350933075, -1.2907009273767471, -1.066706970334053, 6.74153932929039, 6.285178154706955, 5.90810889005661, -1.8493934522072522, -1.7223156417409626, -2.4803925851980893]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14324215063791404, "mean_inference_ms": 0.6463458633402681, "mean_action_processing_ms": 0.0943261373772414, "mean_env_wait_ms": 0.7853551134028653, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 200000, "timesteps_this_iter": 0, "agent_timesteps_total": 600000, "timers": {"sample_time_ms": 10381.824, "sample_throughput": 481.611, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1597.631, "learn_throughput": 3129.634, "update_time_ms": 7.823}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 19.028940773010255, "policy_loss": -0.003430010732430944, "vf_loss": 19.096748733520506, "vf_explained_var": -1.0, "kl": 0.006166226844655227, "entropy": 6.4378218173980715, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 200000, "num_agent_steps_sampled": 600000, "num_steps_trained": 200000, "num_agent_steps_trained": 600000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1239, "training_iteration": 40, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-15-55", "timestamp": 1706228155, "time_this_iter_s": 11.247013807296753, "time_total_s": 399.21805596351624, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202825D1280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 399.21805596351624, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 14.6, "ram_util_percent": 51.08125}}
{"episode_reward_max": 55.400361317209885, "episode_reward_min": -349.88043539226055, "episode_reward_mean": -36.2514281134389, "episode_len_mean": 463.27, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -121.63940258820853}, "policy_reward_max": {"shared_policy": 18.96731141985704}, "policy_reward_mean": {"shared_policy": -12.083809371146302}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-300.77726811915636, -307.9377134144306, -12.854693725705147, 5.565048649907098, 4.7345051541924335, -2.0799172520637796, -271.82859505712986, -0.9909159392118738, -61.342686006799354, 2.2636556997894957, 14.114535011351094, 10.253884635865688, -22.982368865981712, -37.83525927318263, 17.497927717864485, -2.419696144759655, 4.335375934839249, -309.99488212168217, -33.76478774845603, 3.2286133058369018, -6.928040102124243, -54.147896096110365, -25.218878190964475, -62.184256516397014, -10.61954053491354, -38.094743549823775, -59.98958248645068, -17.442598402500167, 8.564976632595062, 7.499374784529195, -34.978407129645376, -12.173897594213514, -22.254494650289416, -47.44674706459048, 55.400361317209885, -293.7305898666382, 11.122883692383738, -335.2159327790141, -37.820102497935295, -50.65030884742738, -59.31036646664145, 18.567930316552506, 15.864145390689359, -28.11338762938979, -6.176827318966403, -2.5512928515672684, -56.29942895472051, -6.6872148141264915, -11.331786807626486, -4.314158059656634, -36.341410636901884, 0.18819906562563915, -15.686353780329256, -17.14821233600381, -326.2751701772213, -15.351593643426895, -21.811619989573956, -21.74140573292972, 19.167661618441315, -19.513440094888225, -14.18073346465826, 25.19572536647317, -349.88043539226055, -17.08098530024293, 14.592745035886736, -20.62692395597699, -1.4536785855889605, -0.628817163407831, -4.424904830753803, -0.371148526668577, 7.878413490951061, -0.323971974081374, 0.7586849033832408, 16.88312754034996, 7.054913148283958, 10.905322618782506, -333.65802088379866, 2.9784524124115563, -3.217849105596571, 35.39570058695969, -30.471078604459763, -13.836379468441038, 6.415416724979863, -12.029791876673727, -26.07709232717754, 7.884379945695386, 27.761606823652954, -3.5009599328041077, 18.934826374053955, -6.052101679146304, 7.259065389633179, -0.0020862817764424335, 7.145898230373859, -38.711151385679855, -14.399679757654681, -12.12013599276544, 27.91458928585051, 14.806628983467817, -72.19551600515835, 34.32452463358641], "episode_lengths": [103, 85, 500, 500, 500, 500, 87, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 44, 500, 104, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 42, 500, 500, 500, 500, 500, 500, 500, 212, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 92, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-94.33247508108616, -94.46663980931044, -111.97815322875977, -102.27144221464793, -100.74455226461093, -104.92171893517177, -4.684445947408676, -4.262488275766373, -3.907759502530098, 1.9016010214885029, 1.8853347649176868, 1.7781128635009082, 1.7350702484448703, 1.1599398156007084, 1.8394950901468547, -0.6200707902511056, -0.9580618341763909, -0.5017846276362832, -89.20712891717753, -93.2746550043424, -89.34681113560995, -0.45668694128593756, -0.2627974835534985, -0.27143151437243773, -19.367578952262804, -19.228993654871985, -22.746113399664566, 0.6555431211988036, 0.48663916687169717, 1.1214734117189948, 5.244901654620961, 4.717951854070023, 4.151681502660111, 3.2992657124996185, 3.4363843724131584, 3.5182345509529114, -7.841466645399734, -7.388118308658406, -7.752783911923572, -12.778761838873237, -12.074347187609732, -12.98215024669966, 5.608348841468484, 5.76369799176851, 6.125880884627492, -0.7243156284093857, -0.7386291995644569, -0.9567513167858124, 1.0565432608127594, 1.382363185286522, 1.8964694887399673, -110.5878114203612, -99.7410127768914, -99.66605792442958, -11.350371633966773, -11.031040792663902, -11.383375321825355, 0.9786136200030597, 0.7580830653508457, 1.4919166204829963, -2.0464698274930413, -2.3620790292819436, -2.5194912453492577, -17.906187921762474, -17.843331322073944, -18.398376852273948, -8.61865133295457, -8.416413853565857, -8.183813004444048, -20.25073679039876, -20.539971793691322, -21.39354793230693, -3.213173046708107, -3.2611425295472145, -4.145224958658218, -12.435507396856949, -12.871975893775627, -12.7872602591912, -19.57756848384937, -19.33503312369188, -21.07698087890943, -5.758594940106079, -5.667559723059341, -6.016443739334747, 2.932525336742401, 3.19611294567585, 2.436338350176811, 2.6011780028541835, 2.4235539635022434, 2.474642818172768, -11.787786667545646, -11.165242378910392, -12.025378083189338, -3.714052056272834, -3.901865844925254, -4.557979693015426, -7.372970260679722, -7.08783165179193, -7.793692737817764, -15.761110340555518, -15.851709326108306, -15.833927397926658, 18.355040555198983, 18.078009342153862, 18.96731141985704, -99.52228391170502, -97.46006453037262, -96.74824142456055, 3.4143413553635185, 3.755318629244954, 3.9532237077752654, -107.39981372406086, -108.13568242390951, -119.68043663104376, -12.672773748636246, -12.649855315685272, -12.497473433613777, -17.066721955935165, -16.807643959919616, -16.7759429315726, -19.90614442527295, -19.308657631278045, -20.095564410090454, 6.273757894833878, 5.746871833999947, 6.547300587718681, 5.572434542079762, 5.193004151185349, 5.098706697424248, -9.531559308369964, -9.321753044923156, -9.260075276096671, -1.9337067479888645, -2.1867950359980313, -2.056325534979507, -0.9325268119573593, -0.8365189284086227, -0.7822471112012863, -18.831497336427375, -18.866707476476833, -18.601224141816303, -2.08040414750576, -2.3717181980609894, -2.235092468559742, -3.523933470249176, -3.496989544481039, -4.310863792896271, -1.6472499022881237, -1.3163644025723187, -1.3505437547961918, -11.86665350695452, -11.848231201370567, -12.626525928576797, 0.10233629743257211, 0.1728571231166427, -0.08699435492357566, -5.845076491435378, -4.751270872851222, -5.090006416042655, -5.752627586325019, -5.779665519793838, -5.615919229884952, -116.82012991110484, -103.61132533351581, -105.84371493260066, -5.076556541025639, -5.284011736512184, -4.991025365889072, -7.211595367640257, -7.1979481764137745, -7.402076445519924, -7.753882596890136, -7.375557387868568, -6.611965748171016, 6.706865823517234, 6.1591688195864265, 6.301626975337655, -6.466121586660549, -6.535613040129348, -6.511705468098327, -4.884642317891121, -4.720377430319786, -4.575713716447353, 8.172132308284432, 8.5352998326222, 8.488293225566537, -118.98279984792075, -114.94015586872897, -115.95747967561087, -5.689308454593032, -5.721259673436492, -5.670417172213405, 4.849968189994485, 4.737232411901147, 5.005544433991105, -6.605370526512473, -6.56557269146046, -7.455980738004058, -0.2508038704594071, -0.20096079011759116, -1.0019139250119622, -0.12520863612493827, 0.22714649389186548, -0.7307550211747582, -1.4671925902366638, -1.1695277020335197, -1.7881845384836197, 0.09311682979264901, -0.20001672705015494, -0.2642486294110711, 2.844714805483818, 2.729634441435337, 2.304064244031906, -0.042480709652110704, 0.29730715878152125, -0.5787984232107846, 0.4437042375405582, 0.1977265228827747, 0.11725414295990788, 5.508361533284187, 5.605033114552498, 5.769732892513275, 2.331946589052677, 2.237528547644615, 2.485438011586666, 3.803329405685261, 3.512969364722565, 3.58902384837468, -105.16054146488509, -106.85807683070502, -121.63940258820853, 0.5676474471886905, 1.3634701774766, 1.0473347877462658, -1.1878836800654824, -0.9945342590411599, -1.0354311664899285, 11.678274969259888, 11.702972563604504, 12.014453054095299, -10.187064334750175, -10.10692223906517, -10.177092030644417, -4.6800560032328065, -4.355729622145503, -4.800593843062728, 2.068527308603123, 2.1222642858823093, 2.224625130494431, -4.280173589785903, -3.638820533951133, -4.110797752936691, -8.497167850534126, -8.369034739832088, -9.210889736811325, 2.683553603788212, 2.439941336711243, 2.760885005195931, 9.398746064553649, 9.209045621256024, 9.153815137843281, -1.1435520350933075, -1.2907009273767471, -1.066706970334053, 6.74153932929039, 6.285178154706955, 5.90810889005661, -1.8493934522072522, -1.7223156417409626, -2.4803925851980893, 2.579805091023445, 1.939544215798378, 2.7397160828113556, -0.2589428822199551, -0.10977935294310726, 0.3666359533866199, 2.4447112157940865, 2.1903032064437866, 2.5108838081359863, -13.233361954490348, -12.770850344250604, -12.706939086938903, -4.793284277121231, -4.715336191157505, -4.891059289375946, -4.033851924041912, -3.994071560601398, -4.092212508122131, 9.212377001841858, 9.256846015652016, 9.445366268356636, 4.91646683216095, 4.766317665576935, 5.123844485729933, -23.684145025908954, -23.86497240513564, -24.646398574113853, 11.514050863683224, 11.297687157988548, 11.512786611914635]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1430896640088507, "mean_inference_ms": 0.6475960099778704, "mean_action_processing_ms": 0.09443486299507649, "mean_env_wait_ms": 0.7868626559323719, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 205000, "timesteps_this_iter": 0, "agent_timesteps_total": 615000, "timers": {"sample_time_ms": 10514.032, "sample_throughput": 475.555, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1608.493, "learn_throughput": 3108.5, "update_time_ms": 8.023}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 12.728861045837402, "policy_loss": -0.0030371346253156737, "vf_loss": 12.797531032562256, "vf_explained_var": -1.0, "kl": 0.004679312609372137, "entropy": 6.5632555961608885, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 205000, "num_agent_steps_sampled": 615000, "num_steps_trained": 205000, "num_agent_steps_trained": 615000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1249, "training_iteration": 41, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-16-06", "timestamp": 1706228166, "time_this_iter_s": 11.050082921981812, "time_total_s": 410.26813888549805, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202CC7B6430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 410.26813888549805, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 11.41875, "ram_util_percent": 52.0625}}
{"episode_reward_max": 55.400361317209885, "episode_reward_min": -349.88043539226055, "episode_reward_mean": -27.4943368464138, "episode_len_mean": 475.52, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -121.63940258820853}, "policy_reward_max": {"shared_policy": 18.96731141985704}, "policy_reward_mean": {"shared_policy": -9.164778948804601}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.114535011351094, 10.253884635865688, -22.982368865981712, -37.83525927318263, 17.497927717864485, -2.419696144759655, 4.335375934839249, -309.99488212168217, -33.76478774845603, 3.2286133058369018, -6.928040102124243, -54.147896096110365, -25.218878190964475, -62.184256516397014, -10.61954053491354, -38.094743549823775, -59.98958248645068, -17.442598402500167, 8.564976632595062, 7.499374784529195, -34.978407129645376, -12.173897594213514, -22.254494650289416, -47.44674706459048, 55.400361317209885, -293.7305898666382, 11.122883692383738, -335.2159327790141, -37.820102497935295, -50.65030884742738, -59.31036646664145, 18.567930316552506, 15.864145390689359, -28.11338762938979, -6.176827318966403, -2.5512928515672684, -56.29942895472051, -6.6872148141264915, -11.331786807626486, -4.314158059656634, -36.341410636901884, 0.18819906562563915, -15.686353780329256, -17.14821233600381, -326.2751701772213, -15.351593643426895, -21.811619989573956, -21.74140573292972, 19.167661618441315, -19.513440094888225, -14.18073346465826, 25.19572536647317, -349.88043539226055, -17.08098530024293, 14.592745035886736, -20.62692395597699, -1.4536785855889605, -0.628817163407831, -4.424904830753803, -0.371148526668577, 7.878413490951061, -0.323971974081374, 0.7586849033832408, 16.88312754034996, 7.054913148283958, 10.905322618782506, -333.65802088379866, 2.9784524124115563, -3.217849105596571, 35.39570058695969, -30.471078604459763, -13.836379468441038, 6.415416724979863, -12.029791876673727, -26.07709232717754, 7.884379945695386, 27.761606823652954, -3.5009599328041077, 18.934826374053955, -6.052101679146304, 7.259065389633179, -0.0020862817764424335, 7.145898230373859, -38.711151385679855, -14.399679757654681, -12.12013599276544, 27.91458928585051, 14.806628983467817, -72.19551600515835, 34.32452463358641, -14.850772828795044, -15.598984293639688, 11.261562876403332, -21.254037015140085, -8.353422803804293, 13.775235377252102, 17.011873599141836, -10.19139840453866, -44.64422810822728, 3.304718293249607], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 44, 500, 104, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 42, 500, 500, 500, 500, 500, 500, 500, 212, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 92, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [5.244901654620961, 4.717951854070023, 4.151681502660111, 3.2992657124996185, 3.4363843724131584, 3.5182345509529114, -7.841466645399734, -7.388118308658406, -7.752783911923572, -12.778761838873237, -12.074347187609732, -12.98215024669966, 5.608348841468484, 5.76369799176851, 6.125880884627492, -0.7243156284093857, -0.7386291995644569, -0.9567513167858124, 1.0565432608127594, 1.382363185286522, 1.8964694887399673, -110.5878114203612, -99.7410127768914, -99.66605792442958, -11.350371633966773, -11.031040792663902, -11.383375321825355, 0.9786136200030597, 0.7580830653508457, 1.4919166204829963, -2.0464698274930413, -2.3620790292819436, -2.5194912453492577, -17.906187921762474, -17.843331322073944, -18.398376852273948, -8.61865133295457, -8.416413853565857, -8.183813004444048, -20.25073679039876, -20.539971793691322, -21.39354793230693, -3.213173046708107, -3.2611425295472145, -4.145224958658218, -12.435507396856949, -12.871975893775627, -12.7872602591912, -19.57756848384937, -19.33503312369188, -21.07698087890943, -5.758594940106079, -5.667559723059341, -6.016443739334747, 2.932525336742401, 3.19611294567585, 2.436338350176811, 2.6011780028541835, 2.4235539635022434, 2.474642818172768, -11.787786667545646, -11.165242378910392, -12.025378083189338, -3.714052056272834, -3.901865844925254, -4.557979693015426, -7.372970260679722, -7.08783165179193, -7.793692737817764, -15.761110340555518, -15.851709326108306, -15.833927397926658, 18.355040555198983, 18.078009342153862, 18.96731141985704, -99.52228391170502, -97.46006453037262, -96.74824142456055, 3.4143413553635185, 3.755318629244954, 3.9532237077752654, -107.39981372406086, -108.13568242390951, -119.68043663104376, -12.672773748636246, -12.649855315685272, -12.497473433613777, -17.066721955935165, -16.807643959919616, -16.7759429315726, -19.90614442527295, -19.308657631278045, -20.095564410090454, 6.273757894833878, 5.746871833999947, 6.547300587718681, 5.572434542079762, 5.193004151185349, 5.098706697424248, -9.531559308369964, -9.321753044923156, -9.260075276096671, -1.9337067479888645, -2.1867950359980313, -2.056325534979507, -0.9325268119573593, -0.8365189284086227, -0.7822471112012863, -18.831497336427375, -18.866707476476833, -18.601224141816303, -2.08040414750576, -2.3717181980609894, -2.235092468559742, -3.523933470249176, -3.496989544481039, -4.310863792896271, -1.6472499022881237, -1.3163644025723187, -1.3505437547961918, -11.86665350695452, -11.848231201370567, -12.626525928576797, 0.10233629743257211, 0.1728571231166427, -0.08699435492357566, -5.845076491435378, -4.751270872851222, -5.090006416042655, -5.752627586325019, -5.779665519793838, -5.615919229884952, -116.82012991110484, -103.61132533351581, -105.84371493260066, -5.076556541025639, -5.284011736512184, -4.991025365889072, -7.211595367640257, -7.1979481764137745, -7.402076445519924, -7.753882596890136, -7.375557387868568, -6.611965748171016, 6.706865823517234, 6.1591688195864265, 6.301626975337655, -6.466121586660549, -6.535613040129348, -6.511705468098327, -4.884642317891121, -4.720377430319786, -4.575713716447353, 8.172132308284432, 8.5352998326222, 8.488293225566537, -118.98279984792075, -114.94015586872897, -115.95747967561087, -5.689308454593032, -5.721259673436492, -5.670417172213405, 4.849968189994485, 4.737232411901147, 5.005544433991105, -6.605370526512473, -6.56557269146046, -7.455980738004058, -0.2508038704594071, -0.20096079011759116, -1.0019139250119622, -0.12520863612493827, 0.22714649389186548, -0.7307550211747582, -1.4671925902366638, -1.1695277020335197, -1.7881845384836197, 0.09311682979264901, -0.20001672705015494, -0.2642486294110711, 2.844714805483818, 2.729634441435337, 2.304064244031906, -0.042480709652110704, 0.29730715878152125, -0.5787984232107846, 0.4437042375405582, 0.1977265228827747, 0.11725414295990788, 5.508361533284187, 5.605033114552498, 5.769732892513275, 2.331946589052677, 2.237528547644615, 2.485438011586666, 3.803329405685261, 3.512969364722565, 3.58902384837468, -105.16054146488509, -106.85807683070502, -121.63940258820853, 0.5676474471886905, 1.3634701774766, 1.0473347877462658, -1.1878836800654824, -0.9945342590411599, -1.0354311664899285, 11.678274969259888, 11.702972563604504, 12.014453054095299, -10.187064334750175, -10.10692223906517, -10.177092030644417, -4.6800560032328065, -4.355729622145503, -4.800593843062728, 2.068527308603123, 2.1222642858823093, 2.224625130494431, -4.280173589785903, -3.638820533951133, -4.110797752936691, -8.497167850534126, -8.369034739832088, -9.210889736811325, 2.683553603788212, 2.439941336711243, 2.760885005195931, 9.398746064553649, 9.209045621256024, 9.153815137843281, -1.1435520350933075, -1.2907009273767471, -1.066706970334053, 6.74153932929039, 6.285178154706955, 5.90810889005661, -1.8493934522072522, -1.7223156417409626, -2.4803925851980893, 2.579805091023445, 1.939544215798378, 2.7397160828113556, -0.2589428822199551, -0.10977935294310726, 0.3666359533866199, 2.4447112157940865, 2.1903032064437866, 2.5108838081359863, -13.233361954490348, -12.770850344250604, -12.706939086938903, -4.793284277121231, -4.715336191157505, -4.891059289375946, -4.033851924041912, -3.994071560601398, -4.092212508122131, 9.212377001841858, 9.256846015652016, 9.445366268356636, 4.91646683216095, 4.766317665576935, 5.123844485729933, -23.684145025908954, -23.86497240513564, -24.646398574113853, 11.514050863683224, 11.297687157988548, 11.512786611914635, -5.104328294595092, -5.2666225781043465, -4.479821956095606, -5.234042321642249, -4.989835349222034, -5.375106622775405, 3.8639814108610153, 4.035007514059544, 3.362573951482773, -6.97300906976065, -7.286314403017371, -6.994713542362064, -2.733882779876396, -3.18023380140464, -2.439306222523257, 5.003611706197262, 4.73324790596962, 4.03837576508522, 5.667896434664726, 5.9231984205543995, 5.42077874392271, -2.820091990133136, -3.700393622120231, -3.670912792285293, -14.694892478485912, -14.97853269179663, -14.97080293794474, 0.7863667756319046, 1.1142413467168808, 1.4041101709008217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14300658351992726, "mean_inference_ms": 0.6485122666106765, "mean_action_processing_ms": 0.0945491136545285, "mean_env_wait_ms": 0.7882252890350984, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 210000, "timesteps_this_iter": 0, "agent_timesteps_total": 630000, "timers": {"sample_time_ms": 10559.483, "sample_throughput": 473.508, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1625.718, "learn_throughput": 3075.565, "update_time_ms": 8.058}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0005000000000000001, "total_loss": 13.462236213684083, "policy_loss": -0.002026435271107374, "vf_loss": 13.530659770965576, "vf_explained_var": -1.0, "kl": 0.003352766501487861, "entropy": 6.639655494689942, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 210000, "num_agent_steps_sampled": 630000, "num_steps_trained": 210000, "num_agent_steps_trained": 630000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1259, "training_iteration": 42, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-16-16", "timestamp": 1706228176, "time_this_iter_s": 10.568950176239014, "time_total_s": 420.83708906173706, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824924C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 420.83708906173706, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 10.893333333333333, "ram_util_percent": 52.39999999999999}}
{"episode_reward_max": 55.400361317209885, "episode_reward_min": -349.88043539226055, "episode_reward_mean": -23.414246913943217, "episode_len_mean": 479.94, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -121.63940258820853}, "policy_reward_max": {"shared_policy": 18.96731141985704}, "policy_reward_mean": {"shared_policy": -7.8047489713144085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.928040102124243, -54.147896096110365, -25.218878190964475, -62.184256516397014, -10.61954053491354, -38.094743549823775, -59.98958248645068, -17.442598402500167, 8.564976632595062, 7.499374784529195, -34.978407129645376, -12.173897594213514, -22.254494650289416, -47.44674706459048, 55.400361317209885, -293.7305898666382, 11.122883692383738, -335.2159327790141, -37.820102497935295, -50.65030884742738, -59.31036646664145, 18.567930316552506, 15.864145390689359, -28.11338762938979, -6.176827318966403, -2.5512928515672684, -56.29942895472051, -6.6872148141264915, -11.331786807626486, -4.314158059656634, -36.341410636901884, 0.18819906562563915, -15.686353780329256, -17.14821233600381, -326.2751701772213, -15.351593643426895, -21.811619989573956, -21.74140573292972, 19.167661618441315, -19.513440094888225, -14.18073346465826, 25.19572536647317, -349.88043539226055, -17.08098530024293, 14.592745035886736, -20.62692395597699, -1.4536785855889605, -0.628817163407831, -4.424904830753803, -0.371148526668577, 7.878413490951061, -0.323971974081374, 0.7586849033832408, 16.88312754034996, 7.054913148283958, 10.905322618782506, -333.65802088379866, 2.9784524124115563, -3.217849105596571, 35.39570058695969, -30.471078604459763, -13.836379468441038, 6.415416724979863, -12.029791876673727, -26.07709232717754, 7.884379945695386, 27.761606823652954, -3.5009599328041077, 18.934826374053955, -6.052101679146304, 7.259065389633179, -0.0020862817764424335, 7.145898230373859, -38.711151385679855, -14.399679757654681, -12.12013599276544, 27.91458928585051, 14.806628983467817, -72.19551600515835, 34.32452463358641, -14.850772828795044, -15.598984293639688, 11.261562876403332, -21.254037015140085, -8.353422803804293, 13.775235377252102, 17.011873599141836, -10.19139840453866, -44.64422810822728, 3.304718293249607, 37.41335318982598, 7.345856502652154, -9.875654637813597, 8.131863519549356, 27.748803660273538, -7.2228490076959275, 18.43922203034161, -27.85829511284831, -5.016599707305446, 1.3366352617740347], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 44, 500, 104, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 42, 500, 500, 500, 500, 500, 500, 500, 212, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 92, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-2.0464698274930413, -2.3620790292819436, -2.5194912453492577, -17.906187921762474, -17.843331322073944, -18.398376852273948, -8.61865133295457, -8.416413853565857, -8.183813004444048, -20.25073679039876, -20.539971793691322, -21.39354793230693, -3.213173046708107, -3.2611425295472145, -4.145224958658218, -12.435507396856949, -12.871975893775627, -12.7872602591912, -19.57756848384937, -19.33503312369188, -21.07698087890943, -5.758594940106079, -5.667559723059341, -6.016443739334747, 2.932525336742401, 3.19611294567585, 2.436338350176811, 2.6011780028541835, 2.4235539635022434, 2.474642818172768, -11.787786667545646, -11.165242378910392, -12.025378083189338, -3.714052056272834, -3.901865844925254, -4.557979693015426, -7.372970260679722, -7.08783165179193, -7.793692737817764, -15.761110340555518, -15.851709326108306, -15.833927397926658, 18.355040555198983, 18.078009342153862, 18.96731141985704, -99.52228391170502, -97.46006453037262, -96.74824142456055, 3.4143413553635185, 3.755318629244954, 3.9532237077752654, -107.39981372406086, -108.13568242390951, -119.68043663104376, -12.672773748636246, -12.649855315685272, -12.497473433613777, -17.066721955935165, -16.807643959919616, -16.7759429315726, -19.90614442527295, -19.308657631278045, -20.095564410090454, 6.273757894833878, 5.746871833999947, 6.547300587718681, 5.572434542079762, 5.193004151185349, 5.098706697424248, -9.531559308369964, -9.321753044923156, -9.260075276096671, -1.9337067479888645, -2.1867950359980313, -2.056325534979507, -0.9325268119573593, -0.8365189284086227, -0.7822471112012863, -18.831497336427375, -18.866707476476833, -18.601224141816303, -2.08040414750576, -2.3717181980609894, -2.235092468559742, -3.523933470249176, -3.496989544481039, -4.310863792896271, -1.6472499022881237, -1.3163644025723187, -1.3505437547961918, -11.86665350695452, -11.848231201370567, -12.626525928576797, 0.10233629743257211, 0.1728571231166427, -0.08699435492357566, -5.845076491435378, -4.751270872851222, -5.090006416042655, -5.752627586325019, -5.779665519793838, -5.615919229884952, -116.82012991110484, -103.61132533351581, -105.84371493260066, -5.076556541025639, -5.284011736512184, -4.991025365889072, -7.211595367640257, -7.1979481764137745, -7.402076445519924, -7.753882596890136, -7.375557387868568, -6.611965748171016, 6.706865823517234, 6.1591688195864265, 6.301626975337655, -6.466121586660549, -6.535613040129348, -6.511705468098327, -4.884642317891121, -4.720377430319786, -4.575713716447353, 8.172132308284432, 8.5352998326222, 8.488293225566537, -118.98279984792075, -114.94015586872897, -115.95747967561087, -5.689308454593032, -5.721259673436492, -5.670417172213405, 4.849968189994485, 4.737232411901147, 5.005544433991105, -6.605370526512473, -6.56557269146046, -7.455980738004058, -0.2508038704594071, -0.20096079011759116, -1.0019139250119622, -0.12520863612493827, 0.22714649389186548, -0.7307550211747582, -1.4671925902366638, -1.1695277020335197, -1.7881845384836197, 0.09311682979264901, -0.20001672705015494, -0.2642486294110711, 2.844714805483818, 2.729634441435337, 2.304064244031906, -0.042480709652110704, 0.29730715878152125, -0.5787984232107846, 0.4437042375405582, 0.1977265228827747, 0.11725414295990788, 5.508361533284187, 5.605033114552498, 5.769732892513275, 2.331946589052677, 2.237528547644615, 2.485438011586666, 3.803329405685261, 3.512969364722565, 3.58902384837468, -105.16054146488509, -106.85807683070502, -121.63940258820853, 0.5676474471886905, 1.3634701774766, 1.0473347877462658, -1.1878836800654824, -0.9945342590411599, -1.0354311664899285, 11.678274969259888, 11.702972563604504, 12.014453054095299, -10.187064334750175, -10.10692223906517, -10.177092030644417, -4.6800560032328065, -4.355729622145503, -4.800593843062728, 2.068527308603123, 2.1222642858823093, 2.224625130494431, -4.280173589785903, -3.638820533951133, -4.110797752936691, -8.497167850534126, -8.369034739832088, -9.210889736811325, 2.683553603788212, 2.439941336711243, 2.760885005195931, 9.398746064553649, 9.209045621256024, 9.153815137843281, -1.1435520350933075, -1.2907009273767471, -1.066706970334053, 6.74153932929039, 6.285178154706955, 5.90810889005661, -1.8493934522072522, -1.7223156417409626, -2.4803925851980893, 2.579805091023445, 1.939544215798378, 2.7397160828113556, -0.2589428822199551, -0.10977935294310726, 0.3666359533866199, 2.4447112157940865, 2.1903032064437866, 2.5108838081359863, -13.233361954490348, -12.770850344250604, -12.706939086938903, -4.793284277121231, -4.715336191157505, -4.891059289375946, -4.033851924041912, -3.994071560601398, -4.092212508122131, 9.212377001841858, 9.256846015652016, 9.445366268356636, 4.91646683216095, 4.766317665576935, 5.123844485729933, -23.684145025908954, -23.86497240513564, -24.646398574113853, 11.514050863683224, 11.297687157988548, 11.512786611914635, -5.104328294595092, -5.2666225781043465, -4.479821956095606, -5.234042321642249, -4.989835349222034, -5.375106622775405, 3.8639814108610153, 4.035007514059544, 3.362573951482773, -6.97300906976065, -7.286314403017371, -6.994713542362064, -2.733882779876396, -3.18023380140464, -2.439306222523257, 5.003611706197262, 4.73324790596962, 4.03837576508522, 5.667896434664726, 5.9231984205543995, 5.42077874392271, -2.820091990133136, -3.700393622120231, -3.670912792285293, -14.694892478485912, -14.97853269179663, -14.97080293794474, 0.7863667756319046, 1.1142413467168808, 1.4041101709008217, 12.454564626018197, 12.654024119178445, 12.304764444629342, 2.7888388683398517, 2.3516803731520923, 2.20533726116021, -3.264653106530517, -3.425189723571151, -3.1858118077119286, 2.849147756894425, 2.402778779466942, 2.8799369831879886, 9.455175455970064, 8.789171879490212, 9.504456324813262, -1.9210009860495774, -2.253000217179462, -3.048847804466888, 5.807091077168778, 6.238124412794903, 6.39400654037793, -9.079766487081855, -9.221674417456, -9.556854208310455, -1.8216101328531948, -1.376283007363483, -1.8187065670887677, 0.5512499759594505, 0.5983664790789192, 0.18701880673566507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14293969891033487, "mean_inference_ms": 0.6492570697016578, "mean_action_processing_ms": 0.09474009551165519, "mean_env_wait_ms": 0.7894232102194526, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 215000, "timesteps_this_iter": 0, "agent_timesteps_total": 645000, "timers": {"sample_time_ms": 10601.493, "sample_throughput": 471.632, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1625.955, "learn_throughput": 3075.116, "update_time_ms": 8.165}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0005000000000000001, "total_loss": 9.063895416259765, "policy_loss": -0.002203543565639521, "vf_loss": 9.1334547996521, "vf_explained_var": -1.0, "kl": 0.005993504839720115, "entropy": 6.7355938911437985, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 215000, "num_agent_steps_sampled": 645000, "num_steps_trained": 215000, "num_agent_steps_trained": 645000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1269, "training_iteration": 43, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-16-27", "timestamp": 1706228187, "time_this_iter_s": 10.666102409362793, "time_total_s": 431.50319147109985, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028227AAF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 431.50319147109985, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 10.893333333333334, "ram_util_percent": 52.46}}
{"episode_reward_max": 55.400361317209885, "episode_reward_min": -362.3990852832794, "episode_reward_mean": -23.83653766755365, "episode_len_mean": 478.28, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -121.63940258820853}, "policy_reward_max": {"shared_policy": 18.96731141985704}, "policy_reward_mean": {"shared_policy": -7.945512555851219}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.978407129645376, -12.173897594213514, -22.254494650289416, -47.44674706459048, 55.400361317209885, -293.7305898666382, 11.122883692383738, -335.2159327790141, -37.820102497935295, -50.65030884742738, -59.31036646664145, 18.567930316552506, 15.864145390689359, -28.11338762938979, -6.176827318966403, -2.5512928515672684, -56.29942895472051, -6.6872148141264915, -11.331786807626486, -4.314158059656634, -36.341410636901884, 0.18819906562563915, -15.686353780329256, -17.14821233600381, -326.2751701772213, -15.351593643426895, -21.811619989573956, -21.74140573292972, 19.167661618441315, -19.513440094888225, -14.18073346465826, 25.19572536647317, -349.88043539226055, -17.08098530024293, 14.592745035886736, -20.62692395597699, -1.4536785855889605, -0.628817163407831, -4.424904830753803, -0.371148526668577, 7.878413490951061, -0.323971974081374, 0.7586849033832408, 16.88312754034996, 7.054913148283958, 10.905322618782506, -333.65802088379866, 2.9784524124115563, -3.217849105596571, 35.39570058695969, -30.471078604459763, -13.836379468441038, 6.415416724979863, -12.029791876673727, -26.07709232717754, 7.884379945695386, 27.761606823652954, -3.5009599328041077, 18.934826374053955, -6.052101679146304, 7.259065389633179, -0.0020862817764424335, 7.145898230373859, -38.711151385679855, -14.399679757654681, -12.12013599276544, 27.91458928585051, 14.806628983467817, -72.19551600515835, 34.32452463358641, -14.850772828795044, -15.598984293639688, 11.261562876403332, -21.254037015140085, -8.353422803804293, 13.775235377252102, 17.011873599141836, -10.19139840453866, -44.64422810822728, 3.304718293249607, 37.41335318982598, 7.345856502652154, -9.875654637813597, 8.131863519549356, 27.748803660273538, -7.2228490076959275, 18.43922203034161, -27.85829511284831, -5.016599707305446, 1.3366352617740347, 1.61557487398386, 13.953671179711804, -10.648815050721197, 12.001836046576472, 7.670308209955664, 25.26869896426797, 33.01945065334438, -4.544781647622585, -362.3990852832794, -16.727117769420147], "episode_lengths": [500, 500, 500, 500, 500, 44, 500, 104, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 42, 500, 500, 500, 500, 500, 500, 500, 212, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 92, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 334, 500], "policy_shared_policy_reward": [-11.787786667545646, -11.165242378910392, -12.025378083189338, -3.714052056272834, -3.901865844925254, -4.557979693015426, -7.372970260679722, -7.08783165179193, -7.793692737817764, -15.761110340555518, -15.851709326108306, -15.833927397926658, 18.355040555198983, 18.078009342153862, 18.96731141985704, -99.52228391170502, -97.46006453037262, -96.74824142456055, 3.4143413553635185, 3.755318629244954, 3.9532237077752654, -107.39981372406086, -108.13568242390951, -119.68043663104376, -12.672773748636246, -12.649855315685272, -12.497473433613777, -17.066721955935165, -16.807643959919616, -16.7759429315726, -19.90614442527295, -19.308657631278045, -20.095564410090454, 6.273757894833878, 5.746871833999947, 6.547300587718681, 5.572434542079762, 5.193004151185349, 5.098706697424248, -9.531559308369964, -9.321753044923156, -9.260075276096671, -1.9337067479888645, -2.1867950359980313, -2.056325534979507, -0.9325268119573593, -0.8365189284086227, -0.7822471112012863, -18.831497336427375, -18.866707476476833, -18.601224141816303, -2.08040414750576, -2.3717181980609894, -2.235092468559742, -3.523933470249176, -3.496989544481039, -4.310863792896271, -1.6472499022881237, -1.3163644025723187, -1.3505437547961918, -11.86665350695452, -11.848231201370567, -12.626525928576797, 0.10233629743257211, 0.1728571231166427, -0.08699435492357566, -5.845076491435378, -4.751270872851222, -5.090006416042655, -5.752627586325019, -5.779665519793838, -5.615919229884952, -116.82012991110484, -103.61132533351581, -105.84371493260066, -5.076556541025639, -5.284011736512184, -4.991025365889072, -7.211595367640257, -7.1979481764137745, -7.402076445519924, -7.753882596890136, -7.375557387868568, -6.611965748171016, 6.706865823517234, 6.1591688195864265, 6.301626975337655, -6.466121586660549, -6.535613040129348, -6.511705468098327, -4.884642317891121, -4.720377430319786, -4.575713716447353, 8.172132308284432, 8.5352998326222, 8.488293225566537, -118.98279984792075, -114.94015586872897, -115.95747967561087, -5.689308454593032, -5.721259673436492, -5.670417172213405, 4.849968189994485, 4.737232411901147, 5.005544433991105, -6.605370526512473, -6.56557269146046, -7.455980738004058, -0.2508038704594071, -0.20096079011759116, -1.0019139250119622, -0.12520863612493827, 0.22714649389186548, -0.7307550211747582, -1.4671925902366638, -1.1695277020335197, -1.7881845384836197, 0.09311682979264901, -0.20001672705015494, -0.2642486294110711, 2.844714805483818, 2.729634441435337, 2.304064244031906, -0.042480709652110704, 0.29730715878152125, -0.5787984232107846, 0.4437042375405582, 0.1977265228827747, 0.11725414295990788, 5.508361533284187, 5.605033114552498, 5.769732892513275, 2.331946589052677, 2.237528547644615, 2.485438011586666, 3.803329405685261, 3.512969364722565, 3.58902384837468, -105.16054146488509, -106.85807683070502, -121.63940258820853, 0.5676474471886905, 1.3634701774766, 1.0473347877462658, -1.1878836800654824, -0.9945342590411599, -1.0354311664899285, 11.678274969259888, 11.702972563604504, 12.014453054095299, -10.187064334750175, -10.10692223906517, -10.177092030644417, -4.6800560032328065, -4.355729622145503, -4.800593843062728, 2.068527308603123, 2.1222642858823093, 2.224625130494431, -4.280173589785903, -3.638820533951133, -4.110797752936691, -8.497167850534126, -8.369034739832088, -9.210889736811325, 2.683553603788212, 2.439941336711243, 2.760885005195931, 9.398746064553649, 9.209045621256024, 9.153815137843281, -1.1435520350933075, -1.2907009273767471, -1.066706970334053, 6.74153932929039, 6.285178154706955, 5.90810889005661, -1.8493934522072522, -1.7223156417409626, -2.4803925851980893, 2.579805091023445, 1.939544215798378, 2.7397160828113556, -0.2589428822199551, -0.10977935294310726, 0.3666359533866199, 2.4447112157940865, 2.1903032064437866, 2.5108838081359863, -13.233361954490348, -12.770850344250604, -12.706939086938903, -4.793284277121231, -4.715336191157505, -4.891059289375946, -4.033851924041912, -3.994071560601398, -4.092212508122131, 9.212377001841858, 9.256846015652016, 9.445366268356636, 4.91646683216095, 4.766317665576935, 5.123844485729933, -23.684145025908954, -23.86497240513564, -24.646398574113853, 11.514050863683224, 11.297687157988548, 11.512786611914635, -5.104328294595092, -5.2666225781043465, -4.479821956095606, -5.234042321642249, -4.989835349222034, -5.375106622775405, 3.8639814108610153, 4.035007514059544, 3.362573951482773, -6.97300906976065, -7.286314403017371, -6.994713542362064, -2.733882779876396, -3.18023380140464, -2.439306222523257, 5.003611706197262, 4.73324790596962, 4.03837576508522, 5.667896434664726, 5.9231984205543995, 5.42077874392271, -2.820091990133136, -3.700393622120231, -3.670912792285293, -14.694892478485912, -14.97853269179663, -14.97080293794474, 0.7863667756319046, 1.1142413467168808, 1.4041101709008217, 12.454564626018197, 12.654024119178445, 12.304764444629342, 2.7888388683398517, 2.3516803731520923, 2.20533726116021, -3.264653106530517, -3.425189723571151, -3.1858118077119286, 2.849147756894425, 2.402778779466942, 2.8799369831879886, 9.455175455970064, 8.789171879490212, 9.504456324813262, -1.9210009860495774, -2.253000217179462, -3.048847804466888, 5.807091077168778, 6.238124412794903, 6.39400654037793, -9.079766487081855, -9.221674417456, -9.556854208310455, -1.8216101328531948, -1.376283007363483, -1.8187065670887677, 0.5512499759594505, 0.5983664790789192, 0.18701880673566507, 0.8148342221975327, 0.5132898911833763, 0.28745076060295105, 4.8321379547317775, 4.47906570633252, 4.642467518647507, -3.388700248052686, -3.3683346447845395, -3.8917801578839715, 4.25132159392038, 4.567860032121331, 3.18265442053476, 2.2261163989702766, 2.483938003579766, 2.9602538074056213, 8.923697669059038, 8.113543197512627, 8.231458097696304, 11.078016941746071, 10.528593619664505, 11.412840091933802, -1.4743474423885345, -1.9170759171247482, -1.1533582881093025, -120.96389337380728, -120.28839840491614, -121.14679350455603, -5.725373074412346, -5.478875868022442, -5.522868826985359]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1428600562441673, "mean_inference_ms": 0.6503561236028155, "mean_action_processing_ms": 0.09489446426314219, "mean_env_wait_ms": 0.7909203642909656, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 220000, "timesteps_this_iter": 0, "agent_timesteps_total": 660000, "timers": {"sample_time_ms": 10613.418, "sample_throughput": 471.102, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1633.043, "learn_throughput": 3061.769, "update_time_ms": 8.165}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0005000000000000001, "total_loss": 91.88981781005859, "policy_loss": -0.0018191961757978437, "vf_loss": 91.96086120605469, "vf_explained_var": -0.08125138282775879, "kl": 0.010202446166663048, "entropy": 6.9223874568939205, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 220000, "num_agent_steps_sampled": 660000, "num_steps_trained": 220000, "num_agent_steps_trained": 660000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1279, "training_iteration": 44, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-16-38", "timestamp": 1706228198, "time_this_iter_s": 10.436830043792725, "time_total_s": 441.9400215148926, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202825D1F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 441.9400215148926, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 11.057142857142859, "ram_util_percent": 52.42857142857142}}
{"episode_reward_max": 37.41335318982598, "episode_reward_min": -362.3990852832794, "episode_reward_mean": -18.140401824893207, "episode_len_mean": 482.86, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -121.63940258820853}, "policy_reward_max": {"shared_policy": 12.654024119178445}, "policy_reward_mean": {"shared_policy": -6.046800608297739}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.567930316552506, 15.864145390689359, -28.11338762938979, -6.176827318966403, -2.5512928515672684, -56.29942895472051, -6.6872148141264915, -11.331786807626486, -4.314158059656634, -36.341410636901884, 0.18819906562563915, -15.686353780329256, -17.14821233600381, -326.2751701772213, -15.351593643426895, -21.811619989573956, -21.74140573292972, 19.167661618441315, -19.513440094888225, -14.18073346465826, 25.19572536647317, -349.88043539226055, -17.08098530024293, 14.592745035886736, -20.62692395597699, -1.4536785855889605, -0.628817163407831, -4.424904830753803, -0.371148526668577, 7.878413490951061, -0.323971974081374, 0.7586849033832408, 16.88312754034996, 7.054913148283958, 10.905322618782506, -333.65802088379866, 2.9784524124115563, -3.217849105596571, 35.39570058695969, -30.471078604459763, -13.836379468441038, 6.415416724979863, -12.029791876673727, -26.07709232717754, 7.884379945695386, 27.761606823652954, -3.5009599328041077, 18.934826374053955, -6.052101679146304, 7.259065389633179, -0.0020862817764424335, 7.145898230373859, -38.711151385679855, -14.399679757654681, -12.12013599276544, 27.91458928585051, 14.806628983467817, -72.19551600515835, 34.32452463358641, -14.850772828795044, -15.598984293639688, 11.261562876403332, -21.254037015140085, -8.353422803804293, 13.775235377252102, 17.011873599141836, -10.19139840453866, -44.64422810822728, 3.304718293249607, 37.41335318982598, 7.345856502652154, -9.875654637813597, 8.131863519549356, 27.748803660273538, -7.2228490076959275, 18.43922203034161, -27.85829511284831, -5.016599707305446, 1.3366352617740347, 1.61557487398386, 13.953671179711804, -10.648815050721197, 12.001836046576472, 7.670308209955664, 25.26869896426797, 33.01945065334438, -4.544781647622585, -362.3990852832794, -16.727117769420147, -22.413630098104477, -321.59275782853365, 10.88873882591723, 7.985551506280871, 10.440928809344754, 18.23855268955228, -0.6232213452458666, 34.7182515002787, -13.46655591391027, 18.205159664154053, 0.1749645695090294], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 42, 500, 500, 500, 500, 500, 500, 500, 212, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 92, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 334, 500, 500, 106, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [6.273757894833878, 5.746871833999947, 6.547300587718681, 5.572434542079762, 5.193004151185349, 5.098706697424248, -9.531559308369964, -9.321753044923156, -9.260075276096671, -1.9337067479888645, -2.1867950359980313, -2.056325534979507, -0.9325268119573593, -0.8365189284086227, -0.7822471112012863, -18.831497336427375, -18.866707476476833, -18.601224141816303, -2.08040414750576, -2.3717181980609894, -2.235092468559742, -3.523933470249176, -3.496989544481039, -4.310863792896271, -1.6472499022881237, -1.3163644025723187, -1.3505437547961918, -11.86665350695452, -11.848231201370567, -12.626525928576797, 0.10233629743257211, 0.1728571231166427, -0.08699435492357566, -5.845076491435378, -4.751270872851222, -5.090006416042655, -5.752627586325019, -5.779665519793838, -5.615919229884952, -116.82012991110484, -103.61132533351581, -105.84371493260066, -5.076556541025639, -5.284011736512184, -4.991025365889072, -7.211595367640257, -7.1979481764137745, -7.402076445519924, -7.753882596890136, -7.375557387868568, -6.611965748171016, 6.706865823517234, 6.1591688195864265, 6.301626975337655, -6.466121586660549, -6.535613040129348, -6.511705468098327, -4.884642317891121, -4.720377430319786, -4.575713716447353, 8.172132308284432, 8.5352998326222, 8.488293225566537, -118.98279984792075, -114.94015586872897, -115.95747967561087, -5.689308454593032, -5.721259673436492, -5.670417172213405, 4.849968189994485, 4.737232411901147, 5.005544433991105, -6.605370526512473, -6.56557269146046, -7.455980738004058, -0.2508038704594071, -0.20096079011759116, -1.0019139250119622, -0.12520863612493827, 0.22714649389186548, -0.7307550211747582, -1.4671925902366638, -1.1695277020335197, -1.7881845384836197, 0.09311682979264901, -0.20001672705015494, -0.2642486294110711, 2.844714805483818, 2.729634441435337, 2.304064244031906, -0.042480709652110704, 0.29730715878152125, -0.5787984232107846, 0.4437042375405582, 0.1977265228827747, 0.11725414295990788, 5.508361533284187, 5.605033114552498, 5.769732892513275, 2.331946589052677, 2.237528547644615, 2.485438011586666, 3.803329405685261, 3.512969364722565, 3.58902384837468, -105.16054146488509, -106.85807683070502, -121.63940258820853, 0.5676474471886905, 1.3634701774766, 1.0473347877462658, -1.1878836800654824, -0.9945342590411599, -1.0354311664899285, 11.678274969259888, 11.702972563604504, 12.014453054095299, -10.187064334750175, -10.10692223906517, -10.177092030644417, -4.6800560032328065, -4.355729622145503, -4.800593843062728, 2.068527308603123, 2.1222642858823093, 2.224625130494431, -4.280173589785903, -3.638820533951133, -4.110797752936691, -8.497167850534126, -8.369034739832088, -9.210889736811325, 2.683553603788212, 2.439941336711243, 2.760885005195931, 9.398746064553649, 9.209045621256024, 9.153815137843281, -1.1435520350933075, -1.2907009273767471, -1.066706970334053, 6.74153932929039, 6.285178154706955, 5.90810889005661, -1.8493934522072522, -1.7223156417409626, -2.4803925851980893, 2.579805091023445, 1.939544215798378, 2.7397160828113556, -0.2589428822199551, -0.10977935294310726, 0.3666359533866199, 2.4447112157940865, 2.1903032064437866, 2.5108838081359863, -13.233361954490348, -12.770850344250604, -12.706939086938903, -4.793284277121231, -4.715336191157505, -4.891059289375946, -4.033851924041912, -3.994071560601398, -4.092212508122131, 9.212377001841858, 9.256846015652016, 9.445366268356636, 4.91646683216095, 4.766317665576935, 5.123844485729933, -23.684145025908954, -23.86497240513564, -24.646398574113853, 11.514050863683224, 11.297687157988548, 11.512786611914635, -5.104328294595092, -5.2666225781043465, -4.479821956095606, -5.234042321642249, -4.989835349222034, -5.375106622775405, 3.8639814108610153, 4.035007514059544, 3.362573951482773, -6.97300906976065, -7.286314403017371, -6.994713542362064, -2.733882779876396, -3.18023380140464, -2.439306222523257, 5.003611706197262, 4.73324790596962, 4.03837576508522, 5.667896434664726, 5.9231984205543995, 5.42077874392271, -2.820091990133136, -3.700393622120231, -3.670912792285293, -14.694892478485912, -14.97853269179663, -14.97080293794474, 0.7863667756319046, 1.1142413467168808, 1.4041101709008217, 12.454564626018197, 12.654024119178445, 12.304764444629342, 2.7888388683398517, 2.3516803731520923, 2.20533726116021, -3.264653106530517, -3.425189723571151, -3.1858118077119286, 2.849147756894425, 2.402778779466942, 2.8799369831879886, 9.455175455970064, 8.789171879490212, 9.504456324813262, -1.9210009860495774, -2.253000217179462, -3.048847804466888, 5.807091077168778, 6.238124412794903, 6.39400654037793, -9.079766487081855, -9.221674417456, -9.556854208310455, -1.8216101328531948, -1.376283007363483, -1.8187065670887677, 0.5512499759594505, 0.5983664790789192, 0.18701880673566507, 0.8148342221975327, 0.5132898911833763, 0.28745076060295105, 4.8321379547317775, 4.47906570633252, 4.642467518647507, -3.388700248052686, -3.3683346447845395, -3.8917801578839715, 4.25132159392038, 4.567860032121331, 3.18265442053476, 2.2261163989702766, 2.483938003579766, 2.9602538074056213, 8.923697669059038, 8.113543197512627, 8.231458097696304, 11.078016941746071, 10.528593619664505, 11.412840091933802, -1.4743474423885345, -1.9170759171247482, -1.1533582881093025, -120.96389337380728, -120.28839840491614, -121.14679350455603, -5.725373074412346, -5.478875868022442, -5.522868826985359, -7.286942720413208, -6.795996248722076, -8.330691128969193, -103.124284910659, -103.96929068366687, -114.4991822342078, 3.7919353221853527, 3.755482462545231, 3.341321041186646, 2.2648898760477607, 2.742416436473519, 2.978245193759591, 3.6908411433299335, 3.342831042905644, 3.407256623109177, 6.3054705510536735, 6.238827491799981, 5.694254646698624, -0.0014018093546326327, -0.18595265348753287, -0.4358668824037011, 11.523894180854157, 12.032342010488108, 11.162015308936432, -4.928215071558952, -4.016102021560073, -4.5222388207912445, 6.103166125714779, 5.936367109417915, 6.1656264290213585, -0.46795693039894104, 0.42252450436353683, 0.2203969955444336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14257795458791336, "mean_inference_ms": 0.6515582096133978, "mean_action_processing_ms": 0.09507977119278417, "mean_env_wait_ms": 0.7926142451026962, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 225000, "timesteps_this_iter": 0, "agent_timesteps_total": 675000, "timers": {"sample_time_ms": 10682.999, "sample_throughput": 468.033, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1640.902, "learn_throughput": 3047.105, "update_time_ms": 8.064}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0005000000000000001, "total_loss": 101.77950744628906, "policy_loss": -0.001840640306531771, "vf_loss": 101.85080642700196, "vf_explained_var": -0.03313782215118408, "kl": 0.01111840618541911, "entropy": 6.9457793712615965, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 225000, "num_agent_steps_sampled": 675000, "num_steps_trained": 225000, "num_agent_steps_trained": 675000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1290, "training_iteration": 45, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-16-48", "timestamp": 1706228208, "time_this_iter_s": 10.574287176132202, "time_total_s": 452.5143086910248, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202CC7B6C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 452.5143086910248, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 11.206666666666667, "ram_util_percent": 52.45333333333333}}
{"episode_reward_max": 38.21245565637946, "episode_reward_min": -362.3990852832794, "episode_reward_mean": -16.642809319117813, "episode_len_mean": 482.86, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -121.63940258820853}, "policy_reward_max": {"shared_policy": 12.916230086237192}, "policy_reward_mean": {"shared_policy": -5.547603106372607}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.18819906562563915, -15.686353780329256, -17.14821233600381, -326.2751701772213, -15.351593643426895, -21.811619989573956, -21.74140573292972, 19.167661618441315, -19.513440094888225, -14.18073346465826, 25.19572536647317, -349.88043539226055, -17.08098530024293, 14.592745035886736, -20.62692395597699, -1.4536785855889605, -0.628817163407831, -4.424904830753803, -0.371148526668577, 7.878413490951061, -0.323971974081374, 0.7586849033832408, 16.88312754034996, 7.054913148283958, 10.905322618782506, -333.65802088379866, 2.9784524124115563, -3.217849105596571, 35.39570058695969, -30.471078604459763, -13.836379468441038, 6.415416724979863, -12.029791876673727, -26.07709232717754, 7.884379945695386, 27.761606823652954, -3.5009599328041077, 18.934826374053955, -6.052101679146304, 7.259065389633179, -0.0020862817764424335, 7.145898230373859, -38.711151385679855, -14.399679757654681, -12.12013599276544, 27.91458928585051, 14.806628983467817, -72.19551600515835, 34.32452463358641, -14.850772828795044, -15.598984293639688, 11.261562876403332, -21.254037015140085, -8.353422803804293, 13.775235377252102, 17.011873599141836, -10.19139840453866, -44.64422810822728, 3.304718293249607, 37.41335318982598, 7.345856502652154, -9.875654637813597, 8.131863519549356, 27.748803660273538, -7.2228490076959275, 18.43922203034161, -27.85829511284831, -5.016599707305446, 1.3366352617740347, 1.61557487398386, 13.953671179711804, -10.648815050721197, 12.001836046576472, 7.670308209955664, 25.26869896426797, 33.01945065334438, -4.544781647622585, -362.3990852832794, -16.727117769420147, -22.413630098104477, -321.59275782853365, 10.88873882591723, 7.985551506280871, 10.440928809344754, 18.23855268955228, -0.6232213452458666, 34.7182515002787, -13.46655591391027, 18.205159664154053, 0.1749645695090294, -22.00958906859161, -27.7282466068864, 21.479485232383013, 17.90959007292986, -2.1453540027141713, -25.839725852012663, 38.21245565637946, 11.737034473568187, 10.000201338902102, 10.759967967867823], "episode_lengths": [500, 500, 500, 42, 500, 500, 500, 500, 500, 500, 500, 212, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 92, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 334, 500, 500, 106, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [0.10233629743257211, 0.1728571231166427, -0.08699435492357566, -5.845076491435378, -4.751270872851222, -5.090006416042655, -5.752627586325019, -5.779665519793838, -5.615919229884952, -116.82012991110484, -103.61132533351581, -105.84371493260066, -5.076556541025639, -5.284011736512184, -4.991025365889072, -7.211595367640257, -7.1979481764137745, -7.402076445519924, -7.753882596890136, -7.375557387868568, -6.611965748171016, 6.706865823517234, 6.1591688195864265, 6.301626975337655, -6.466121586660549, -6.535613040129348, -6.511705468098327, -4.884642317891121, -4.720377430319786, -4.575713716447353, 8.172132308284432, 8.5352998326222, 8.488293225566537, -118.98279984792075, -114.94015586872897, -115.95747967561087, -5.689308454593032, -5.721259673436492, -5.670417172213405, 4.849968189994485, 4.737232411901147, 5.005544433991105, -6.605370526512473, -6.56557269146046, -7.455980738004058, -0.2508038704594071, -0.20096079011759116, -1.0019139250119622, -0.12520863612493827, 0.22714649389186548, -0.7307550211747582, -1.4671925902366638, -1.1695277020335197, -1.7881845384836197, 0.09311682979264901, -0.20001672705015494, -0.2642486294110711, 2.844714805483818, 2.729634441435337, 2.304064244031906, -0.042480709652110704, 0.29730715878152125, -0.5787984232107846, 0.4437042375405582, 0.1977265228827747, 0.11725414295990788, 5.508361533284187, 5.605033114552498, 5.769732892513275, 2.331946589052677, 2.237528547644615, 2.485438011586666, 3.803329405685261, 3.512969364722565, 3.58902384837468, -105.16054146488509, -106.85807683070502, -121.63940258820853, 0.5676474471886905, 1.3634701774766, 1.0473347877462658, -1.1878836800654824, -0.9945342590411599, -1.0354311664899285, 11.678274969259888, 11.702972563604504, 12.014453054095299, -10.187064334750175, -10.10692223906517, -10.177092030644417, -4.6800560032328065, -4.355729622145503, -4.800593843062728, 2.068527308603123, 2.1222642858823093, 2.224625130494431, -4.280173589785903, -3.638820533951133, -4.110797752936691, -8.497167850534126, -8.369034739832088, -9.210889736811325, 2.683553603788212, 2.439941336711243, 2.760885005195931, 9.398746064553649, 9.209045621256024, 9.153815137843281, -1.1435520350933075, -1.2907009273767471, -1.066706970334053, 6.74153932929039, 6.285178154706955, 5.90810889005661, -1.8493934522072522, -1.7223156417409626, -2.4803925851980893, 2.579805091023445, 1.939544215798378, 2.7397160828113556, -0.2589428822199551, -0.10977935294310726, 0.3666359533866199, 2.4447112157940865, 2.1903032064437866, 2.5108838081359863, -13.233361954490348, -12.770850344250604, -12.706939086938903, -4.793284277121231, -4.715336191157505, -4.891059289375946, -4.033851924041912, -3.994071560601398, -4.092212508122131, 9.212377001841858, 9.256846015652016, 9.445366268356636, 4.91646683216095, 4.766317665576935, 5.123844485729933, -23.684145025908954, -23.86497240513564, -24.646398574113853, 11.514050863683224, 11.297687157988548, 11.512786611914635, -5.104328294595092, -5.2666225781043465, -4.479821956095606, -5.234042321642249, -4.989835349222034, -5.375106622775405, 3.8639814108610153, 4.035007514059544, 3.362573951482773, -6.97300906976065, -7.286314403017371, -6.994713542362064, -2.733882779876396, -3.18023380140464, -2.439306222523257, 5.003611706197262, 4.73324790596962, 4.03837576508522, 5.667896434664726, 5.9231984205543995, 5.42077874392271, -2.820091990133136, -3.700393622120231, -3.670912792285293, -14.694892478485912, -14.97853269179663, -14.97080293794474, 0.7863667756319046, 1.1142413467168808, 1.4041101709008217, 12.454564626018197, 12.654024119178445, 12.304764444629342, 2.7888388683398517, 2.3516803731520923, 2.20533726116021, -3.264653106530517, -3.425189723571151, -3.1858118077119286, 2.849147756894425, 2.402778779466942, 2.8799369831879886, 9.455175455970064, 8.789171879490212, 9.504456324813262, -1.9210009860495774, -2.253000217179462, -3.048847804466888, 5.807091077168778, 6.238124412794903, 6.39400654037793, -9.079766487081855, -9.221674417456, -9.556854208310455, -1.8216101328531948, -1.376283007363483, -1.8187065670887677, 0.5512499759594505, 0.5983664790789192, 0.18701880673566507, 0.8148342221975327, 0.5132898911833763, 0.28745076060295105, 4.8321379547317775, 4.47906570633252, 4.642467518647507, -3.388700248052686, -3.3683346447845395, -3.8917801578839715, 4.25132159392038, 4.567860032121331, 3.18265442053476, 2.2261163989702766, 2.483938003579766, 2.9602538074056213, 8.923697669059038, 8.113543197512627, 8.231458097696304, 11.078016941746071, 10.528593619664505, 11.412840091933802, -1.4743474423885345, -1.9170759171247482, -1.1533582881093025, -120.96389337380728, -120.28839840491614, -121.14679350455603, -5.725373074412346, -5.478875868022442, -5.522868826985359, -7.286942720413208, -6.795996248722076, -8.330691128969193, -103.124284910659, -103.96929068366687, -114.4991822342078, 3.7919353221853527, 3.755482462545231, 3.341321041186646, 2.2648898760477607, 2.742416436473519, 2.978245193759591, 3.6908411433299335, 3.342831042905644, 3.407256623109177, 6.3054705510536735, 6.238827491799981, 5.694254646698624, -0.0014018093546326327, -0.18595265348753287, -0.4358668824037011, 11.523894180854157, 12.032342010488108, 11.162015308936432, -4.928215071558952, -4.016102021560073, -4.5222388207912445, 6.103166125714779, 5.936367109417915, 6.1656264290213585, -0.46795693039894104, 0.42252450436353683, 0.2203969955444336, -7.072081911067173, -7.417881498734161, -7.519625658790275, -8.819987254838153, -9.736946413914367, -9.17131293813388, 6.780550166964531, 7.638318467885256, 7.060616597533226, 5.869856685400009, 5.827537909150124, 6.212195478379726, -0.5361426124970166, -1.147476310531303, -0.4617350796858517, -8.687723790605872, -8.327735801537841, -8.82426625986895, 12.801113344728947, 12.916230086237192, 12.495112225413322, 4.106562548627451, 3.905536030729607, 3.7249358942111286, 3.0505024691422733, 3.850932284568742, 3.098766585191086, 3.764672326544911, 2.9685814778009956, 4.026714163521916]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14258184308917227, "mean_inference_ms": 0.6528628421476407, "mean_action_processing_ms": 0.0952685972217516, "mean_env_wait_ms": 0.7943213981469, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 230000, "timesteps_this_iter": 0, "agent_timesteps_total": 690000, "timers": {"sample_time_ms": 10788.065, "sample_throughput": 463.475, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1628.829, "learn_throughput": 3069.69, "update_time_ms": 8.057}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0005000000000000001, "total_loss": 8.730737209320068, "policy_loss": -0.0022725232711884313, "vf_loss": 8.802364253997803, "vf_explained_var": -1.0, "kl": 0.003676267527048633, "entropy": 6.935438108444214, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 230000, "num_agent_steps_sampled": 690000, "num_steps_trained": 230000, "num_agent_steps_trained": 690000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1300, "training_iteration": 46, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-16-59", "timestamp": 1706228219, "time_this_iter_s": 10.799393892288208, "time_total_s": 463.313702583313, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202CC7B6430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 463.313702583313, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 11.9, "ram_util_percent": 52.5}}
{"episode_reward_max": 63.10753016918896, "episode_reward_min": -362.3990852832794, "episode_reward_mean": -11.34612000606373, "episode_len_mean": 487.44, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -121.63940258820853}, "policy_reward_max": {"shared_policy": 21.168302183349923}, "policy_reward_mean": {"shared_policy": -3.782040002021245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.19572536647317, -349.88043539226055, -17.08098530024293, 14.592745035886736, -20.62692395597699, -1.4536785855889605, -0.628817163407831, -4.424904830753803, -0.371148526668577, 7.878413490951061, -0.323971974081374, 0.7586849033832408, 16.88312754034996, 7.054913148283958, 10.905322618782506, -333.65802088379866, 2.9784524124115563, -3.217849105596571, 35.39570058695969, -30.471078604459763, -13.836379468441038, 6.415416724979863, -12.029791876673727, -26.07709232717754, 7.884379945695386, 27.761606823652954, -3.5009599328041077, 18.934826374053955, -6.052101679146304, 7.259065389633179, -0.0020862817764424335, 7.145898230373859, -38.711151385679855, -14.399679757654681, -12.12013599276544, 27.91458928585051, 14.806628983467817, -72.19551600515835, 34.32452463358641, -14.850772828795044, -15.598984293639688, 11.261562876403332, -21.254037015140085, -8.353422803804293, 13.775235377252102, 17.011873599141836, -10.19139840453866, -44.64422810822728, 3.304718293249607, 37.41335318982598, 7.345856502652154, -9.875654637813597, 8.131863519549356, 27.748803660273538, -7.2228490076959275, 18.43922203034161, -27.85829511284831, -5.016599707305446, 1.3366352617740347, 1.61557487398386, 13.953671179711804, -10.648815050721197, 12.001836046576472, 7.670308209955664, 25.26869896426797, 33.01945065334438, -4.544781647622585, -362.3990852832794, -16.727117769420147, -22.413630098104477, -321.59275782853365, 10.88873882591723, 7.985551506280871, 10.440928809344754, 18.23855268955228, -0.6232213452458666, 34.7182515002787, -13.46655591391027, 18.205159664154053, 0.1749645695090294, -22.00958906859161, -27.7282466068864, 21.479485232383013, 17.90959007292986, -2.1453540027141713, -25.839725852012663, 38.21245565637946, 11.737034473568187, 10.000201338902102, 10.759967967867823, -2.6482477337121964, 63.10753016918896, 24.856791801750646, 2.826969765126691, -9.27205261588098, 7.29045654833314, -10.53925853967668, -2.325127508491306, 13.19324728101492, 10.825953602790818], "episode_lengths": [500, 212, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 92, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 334, 500, 500, 106, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [8.172132308284432, 8.5352998326222, 8.488293225566537, -118.98279984792075, -114.94015586872897, -115.95747967561087, -5.689308454593032, -5.721259673436492, -5.670417172213405, 4.849968189994485, 4.737232411901147, 5.005544433991105, -6.605370526512473, -6.56557269146046, -7.455980738004058, -0.2508038704594071, -0.20096079011759116, -1.0019139250119622, -0.12520863612493827, 0.22714649389186548, -0.7307550211747582, -1.4671925902366638, -1.1695277020335197, -1.7881845384836197, 0.09311682979264901, -0.20001672705015494, -0.2642486294110711, 2.844714805483818, 2.729634441435337, 2.304064244031906, -0.042480709652110704, 0.29730715878152125, -0.5787984232107846, 0.4437042375405582, 0.1977265228827747, 0.11725414295990788, 5.508361533284187, 5.605033114552498, 5.769732892513275, 2.331946589052677, 2.237528547644615, 2.485438011586666, 3.803329405685261, 3.512969364722565, 3.58902384837468, -105.16054146488509, -106.85807683070502, -121.63940258820853, 0.5676474471886905, 1.3634701774766, 1.0473347877462658, -1.1878836800654824, -0.9945342590411599, -1.0354311664899285, 11.678274969259888, 11.702972563604504, 12.014453054095299, -10.187064334750175, -10.10692223906517, -10.177092030644417, -4.6800560032328065, -4.355729622145503, -4.800593843062728, 2.068527308603123, 2.1222642858823093, 2.224625130494431, -4.280173589785903, -3.638820533951133, -4.110797752936691, -8.497167850534126, -8.369034739832088, -9.210889736811325, 2.683553603788212, 2.439941336711243, 2.760885005195931, 9.398746064553649, 9.209045621256024, 9.153815137843281, -1.1435520350933075, -1.2907009273767471, -1.066706970334053, 6.74153932929039, 6.285178154706955, 5.90810889005661, -1.8493934522072522, -1.7223156417409626, -2.4803925851980893, 2.579805091023445, 1.939544215798378, 2.7397160828113556, -0.2589428822199551, -0.10977935294310726, 0.3666359533866199, 2.4447112157940865, 2.1903032064437866, 2.5108838081359863, -13.233361954490348, -12.770850344250604, -12.706939086938903, -4.793284277121231, -4.715336191157505, -4.891059289375946, -4.033851924041912, -3.994071560601398, -4.092212508122131, 9.212377001841858, 9.256846015652016, 9.445366268356636, 4.91646683216095, 4.766317665576935, 5.123844485729933, -23.684145025908954, -23.86497240513564, -24.646398574113853, 11.514050863683224, 11.297687157988548, 11.512786611914635, -5.104328294595092, -5.2666225781043465, -4.479821956095606, -5.234042321642249, -4.989835349222034, -5.375106622775405, 3.8639814108610153, 4.035007514059544, 3.362573951482773, -6.97300906976065, -7.286314403017371, -6.994713542362064, -2.733882779876396, -3.18023380140464, -2.439306222523257, 5.003611706197262, 4.73324790596962, 4.03837576508522, 5.667896434664726, 5.9231984205543995, 5.42077874392271, -2.820091990133136, -3.700393622120231, -3.670912792285293, -14.694892478485912, -14.97853269179663, -14.97080293794474, 0.7863667756319046, 1.1142413467168808, 1.4041101709008217, 12.454564626018197, 12.654024119178445, 12.304764444629342, 2.7888388683398517, 2.3516803731520923, 2.20533726116021, -3.264653106530517, -3.425189723571151, -3.1858118077119286, 2.849147756894425, 2.402778779466942, 2.8799369831879886, 9.455175455970064, 8.789171879490212, 9.504456324813262, -1.9210009860495774, -2.253000217179462, -3.048847804466888, 5.807091077168778, 6.238124412794903, 6.39400654037793, -9.079766487081855, -9.221674417456, -9.556854208310455, -1.8216101328531948, -1.376283007363483, -1.8187065670887677, 0.5512499759594505, 0.5983664790789192, 0.18701880673566507, 0.8148342221975327, 0.5132898911833763, 0.28745076060295105, 4.8321379547317775, 4.47906570633252, 4.642467518647507, -3.388700248052686, -3.3683346447845395, -3.8917801578839715, 4.25132159392038, 4.567860032121331, 3.18265442053476, 2.2261163989702766, 2.483938003579766, 2.9602538074056213, 8.923697669059038, 8.113543197512627, 8.231458097696304, 11.078016941746071, 10.528593619664505, 11.412840091933802, -1.4743474423885345, -1.9170759171247482, -1.1533582881093025, -120.96389337380728, -120.28839840491614, -121.14679350455603, -5.725373074412346, -5.478875868022442, -5.522868826985359, -7.286942720413208, -6.795996248722076, -8.330691128969193, -103.124284910659, -103.96929068366687, -114.4991822342078, 3.7919353221853527, 3.755482462545231, 3.341321041186646, 2.2648898760477607, 2.742416436473519, 2.978245193759591, 3.6908411433299335, 3.342831042905644, 3.407256623109177, 6.3054705510536735, 6.238827491799981, 5.694254646698624, -0.0014018093546326327, -0.18595265348753287, -0.4358668824037011, 11.523894180854157, 12.032342010488108, 11.162015308936432, -4.928215071558952, -4.016102021560073, -4.5222388207912445, 6.103166125714779, 5.936367109417915, 6.1656264290213585, -0.46795693039894104, 0.42252450436353683, 0.2203969955444336, -7.072081911067173, -7.417881498734161, -7.519625658790275, -8.819987254838153, -9.736946413914367, -9.17131293813388, 6.780550166964531, 7.638318467885256, 7.060616597533226, 5.869856685400009, 5.827537909150124, 6.212195478379726, -0.5361426124970166, -1.147476310531303, -0.4617350796858517, -8.687723790605872, -8.327735801537841, -8.82426625986895, 12.801113344728947, 12.916230086237192, 12.495112225413322, 4.106562548627451, 3.905536030729607, 3.7249358942111286, 3.0505024691422733, 3.850932284568742, 3.098766585191086, 3.764672326544911, 2.9685814778009956, 4.026714163521916, -0.9998332560062408, -0.5819033682346344, -1.066511109471321, 21.125498337050274, 21.168302183349923, 20.813729648788765, 8.329099630316094, 8.478158441682652, 8.0495337297519, 0.8182247330745014, 1.1307542746265682, 0.8779907574256214, -2.8504116485516278, -2.877159456412002, -3.5444815109173504, 2.272910411159188, 2.3122457514206474, 2.7053003857533042, -3.324981297055885, -3.359218875567123, -3.8550583670536724, -0.4564849076171811, -1.0334565093120034, -0.8351860915621216, 4.51643493026495, 4.671129584312439, 4.0056827664375305, 3.6037880827983173, 3.5321712394555362, 3.6899942805369648]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1425423808527222, "mean_inference_ms": 0.6539752392015328, "mean_action_processing_ms": 0.09551782119906704, "mean_env_wait_ms": 0.7959080533500422, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 235000, "timesteps_this_iter": 0, "agent_timesteps_total": 705000, "timers": {"sample_time_ms": 10791.684, "sample_throughput": 463.32, "load_time_ms": 0.099, "load_throughput": 50291414.868, "learn_time_ms": 1619.779, "learn_throughput": 3086.842, "update_time_ms": 7.957}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0005000000000000001, "total_loss": 6.728862380981445, "policy_loss": -0.0030928300048690184, "vf_loss": 6.801222705841065, "vf_explained_var": -1.0, "kl": 0.005134805399580005, "entropy": 6.926745510101318, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 235000, "num_agent_steps_sampled": 705000, "num_steps_trained": 235000, "num_agent_steps_trained": 705000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1310, "training_iteration": 47, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-17-10", "timestamp": 1706228230, "time_this_iter_s": 10.43871808052063, "time_total_s": 473.7524206638336, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202CC9A9550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 473.7524206638336, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 11.333333333333334, "ram_util_percent": 52.58666666666668}}
{"episode_reward_max": 63.10753016918896, "episode_reward_min": -362.3990852832794, "episode_reward_mean": -6.635496694793703, "episode_len_mean": 490.32, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -121.63940258820853}, "policy_reward_max": {"shared_policy": 21.168302183349923}, "policy_reward_mean": {"shared_policy": -2.2118322315979024}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.323971974081374, 0.7586849033832408, 16.88312754034996, 7.054913148283958, 10.905322618782506, -333.65802088379866, 2.9784524124115563, -3.217849105596571, 35.39570058695969, -30.471078604459763, -13.836379468441038, 6.415416724979863, -12.029791876673727, -26.07709232717754, 7.884379945695386, 27.761606823652954, -3.5009599328041077, 18.934826374053955, -6.052101679146304, 7.259065389633179, -0.0020862817764424335, 7.145898230373859, -38.711151385679855, -14.399679757654681, -12.12013599276544, 27.91458928585051, 14.806628983467817, -72.19551600515835, 34.32452463358641, -14.850772828795044, -15.598984293639688, 11.261562876403332, -21.254037015140085, -8.353422803804293, 13.775235377252102, 17.011873599141836, -10.19139840453866, -44.64422810822728, 3.304718293249607, 37.41335318982598, 7.345856502652154, -9.875654637813597, 8.131863519549356, 27.748803660273538, -7.2228490076959275, 18.43922203034161, -27.85829511284831, -5.016599707305446, 1.3366352617740347, 1.61557487398386, 13.953671179711804, -10.648815050721197, 12.001836046576472, 7.670308209955664, 25.26869896426797, 33.01945065334438, -4.544781647622585, -362.3990852832794, -16.727117769420147, -22.413630098104477, -321.59275782853365, 10.88873882591723, 7.985551506280871, 10.440928809344754, 18.23855268955228, -0.6232213452458666, 34.7182515002787, -13.46655591391027, 18.205159664154053, 0.1749645695090294, -22.00958906859161, -27.7282466068864, 21.479485232383013, 17.90959007292986, -2.1453540027141713, -25.839725852012663, 38.21245565637946, 11.737034473568187, 10.000201338902102, 10.759967967867823, -2.6482477337121964, 63.10753016918896, 24.856791801750646, 2.826969765126691, -9.27205261588098, 7.29045654833314, -10.53925853967668, -2.325127508491306, 13.19324728101492, 10.825953602790818, 17.83609854429959, -6.431767523288741, 9.15657515078783, 3.960928201675401, 19.75167725235221, 46.38538269884883, 13.238292552530766, 7.745339296758161, 8.10087344795464, 4.51892164349556], "episode_lengths": [500, 500, 500, 500, 500, 92, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 334, 500, 500, 106, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-0.042480709652110704, 0.29730715878152125, -0.5787984232107846, 0.4437042375405582, 0.1977265228827747, 0.11725414295990788, 5.508361533284187, 5.605033114552498, 5.769732892513275, 2.331946589052677, 2.237528547644615, 2.485438011586666, 3.803329405685261, 3.512969364722565, 3.58902384837468, -105.16054146488509, -106.85807683070502, -121.63940258820853, 0.5676474471886905, 1.3634701774766, 1.0473347877462658, -1.1878836800654824, -0.9945342590411599, -1.0354311664899285, 11.678274969259888, 11.702972563604504, 12.014453054095299, -10.187064334750175, -10.10692223906517, -10.177092030644417, -4.6800560032328065, -4.355729622145503, -4.800593843062728, 2.068527308603123, 2.1222642858823093, 2.224625130494431, -4.280173589785903, -3.638820533951133, -4.110797752936691, -8.497167850534126, -8.369034739832088, -9.210889736811325, 2.683553603788212, 2.439941336711243, 2.760885005195931, 9.398746064553649, 9.209045621256024, 9.153815137843281, -1.1435520350933075, -1.2907009273767471, -1.066706970334053, 6.74153932929039, 6.285178154706955, 5.90810889005661, -1.8493934522072522, -1.7223156417409626, -2.4803925851980893, 2.579805091023445, 1.939544215798378, 2.7397160828113556, -0.2589428822199551, -0.10977935294310726, 0.3666359533866199, 2.4447112157940865, 2.1903032064437866, 2.5108838081359863, -13.233361954490348, -12.770850344250604, -12.706939086938903, -4.793284277121231, -4.715336191157505, -4.891059289375946, -4.033851924041912, -3.994071560601398, -4.092212508122131, 9.212377001841858, 9.256846015652016, 9.445366268356636, 4.91646683216095, 4.766317665576935, 5.123844485729933, -23.684145025908954, -23.86497240513564, -24.646398574113853, 11.514050863683224, 11.297687157988548, 11.512786611914635, -5.104328294595092, -5.2666225781043465, -4.479821956095606, -5.234042321642249, -4.989835349222034, -5.375106622775405, 3.8639814108610153, 4.035007514059544, 3.362573951482773, -6.97300906976065, -7.286314403017371, -6.994713542362064, -2.733882779876396, -3.18023380140464, -2.439306222523257, 5.003611706197262, 4.73324790596962, 4.03837576508522, 5.667896434664726, 5.9231984205543995, 5.42077874392271, -2.820091990133136, -3.700393622120231, -3.670912792285293, -14.694892478485912, -14.97853269179663, -14.97080293794474, 0.7863667756319046, 1.1142413467168808, 1.4041101709008217, 12.454564626018197, 12.654024119178445, 12.304764444629342, 2.7888388683398517, 2.3516803731520923, 2.20533726116021, -3.264653106530517, -3.425189723571151, -3.1858118077119286, 2.849147756894425, 2.402778779466942, 2.8799369831879886, 9.455175455970064, 8.789171879490212, 9.504456324813262, -1.9210009860495774, -2.253000217179462, -3.048847804466888, 5.807091077168778, 6.238124412794903, 6.39400654037793, -9.079766487081855, -9.221674417456, -9.556854208310455, -1.8216101328531948, -1.376283007363483, -1.8187065670887677, 0.5512499759594505, 0.5983664790789192, 0.18701880673566507, 0.8148342221975327, 0.5132898911833763, 0.28745076060295105, 4.8321379547317775, 4.47906570633252, 4.642467518647507, -3.388700248052686, -3.3683346447845395, -3.8917801578839715, 4.25132159392038, 4.567860032121331, 3.18265442053476, 2.2261163989702766, 2.483938003579766, 2.9602538074056213, 8.923697669059038, 8.113543197512627, 8.231458097696304, 11.078016941746071, 10.528593619664505, 11.412840091933802, -1.4743474423885345, -1.9170759171247482, -1.1533582881093025, -120.96389337380728, -120.28839840491614, -121.14679350455603, -5.725373074412346, -5.478875868022442, -5.522868826985359, -7.286942720413208, -6.795996248722076, -8.330691128969193, -103.124284910659, -103.96929068366687, -114.4991822342078, 3.7919353221853527, 3.755482462545231, 3.341321041186646, 2.2648898760477607, 2.742416436473519, 2.978245193759591, 3.6908411433299335, 3.342831042905644, 3.407256623109177, 6.3054705510536735, 6.238827491799981, 5.694254646698624, -0.0014018093546326327, -0.18595265348753287, -0.4358668824037011, 11.523894180854157, 12.032342010488108, 11.162015308936432, -4.928215071558952, -4.016102021560073, -4.5222388207912445, 6.103166125714779, 5.936367109417915, 6.1656264290213585, -0.46795693039894104, 0.42252450436353683, 0.2203969955444336, -7.072081911067173, -7.417881498734161, -7.519625658790275, -8.819987254838153, -9.736946413914367, -9.17131293813388, 6.780550166964531, 7.638318467885256, 7.060616597533226, 5.869856685400009, 5.827537909150124, 6.212195478379726, -0.5361426124970166, -1.147476310531303, -0.4617350796858517, -8.687723790605872, -8.327735801537841, -8.82426625986895, 12.801113344728947, 12.916230086237192, 12.495112225413322, 4.106562548627451, 3.905536030729607, 3.7249358942111286, 3.0505024691422733, 3.850932284568742, 3.098766585191086, 3.764672326544911, 2.9685814778009956, 4.026714163521916, -0.9998332560062408, -0.5819033682346344, -1.066511109471321, 21.125498337050274, 21.168302183349923, 20.813729648788765, 8.329099630316094, 8.478158441682652, 8.0495337297519, 0.8182247330745014, 1.1307542746265682, 0.8779907574256214, -2.8504116485516278, -2.877159456412002, -3.5444815109173504, 2.272910411159188, 2.3122457514206474, 2.7053003857533042, -3.324981297055885, -3.359218875567123, -3.8550583670536724, -0.4564849076171811, -1.0334565093120034, -0.8351860915621216, 4.51643493026495, 4.671129584312439, 4.0056827664375305, 3.6037880827983173, 3.5321712394555362, 3.6899942805369648, 6.4463266556461605, 5.866341908772782, 5.523429979880646, -1.8245658377806393, -2.4047718296448437, -2.202429855863258, 3.156313233077526, 2.9540115669369698, 3.0462503507733345, 1.485529092450932, 0.8574343075354847, 1.6179648016889843, 6.3196567694346015, 6.81827003757158, 6.613750445346028, 15.081919958194092, 15.430417885382965, 15.873044855271772, 4.441644012928009, 4.45157228410244, 4.345076255500317, 2.525213380654648, 2.7311698546012195, 2.488956061502293, 2.6973423709471973, 2.3106651355822834, 3.09286594142516, 1.5978142768144608, 1.3772390186786652, 1.5438683480024338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14257936462400658, "mean_inference_ms": 0.655138278605166, "mean_action_processing_ms": 0.09569540908421592, "mean_env_wait_ms": 0.79757001861176, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 240000, "timesteps_this_iter": 0, "agent_timesteps_total": 720000, "timers": {"sample_time_ms": 10810.771, "sample_throughput": 462.502, "load_time_ms": 0.099, "load_throughput": 50291414.868, "learn_time_ms": 1600.279, "learn_throughput": 3124.455, "update_time_ms": 7.895}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0005000000000000001, "total_loss": 5.028166818618774, "policy_loss": -0.0024597704613395165, "vf_loss": 5.10139799118042, "vf_explained_var": -1.0, "kl": 0.0035542382611364618, "entropy": 7.077133464813232, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 240000, "num_agent_steps_sampled": 720000, "num_steps_trained": 240000, "num_agent_steps_trained": 720000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1320, "training_iteration": 48, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-17-20", "timestamp": 1706228240, "time_this_iter_s": 10.7189040184021, "time_total_s": 484.4713246822357, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028227A040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 484.4713246822357, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 11.346666666666666, "ram_util_percent": 52.62000000000002}}
{"episode_reward_max": 63.10753016918896, "episode_reward_min": -362.3990852832794, "episode_reward_mean": -6.156183480704215, "episode_len_mean": 490.03, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -121.14679350455603}, "policy_reward_max": {"shared_policy": 21.168302183349923}, "policy_reward_mean": {"shared_policy": -2.052061160234739}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.415416724979863, -12.029791876673727, -26.07709232717754, 7.884379945695386, 27.761606823652954, -3.5009599328041077, 18.934826374053955, -6.052101679146304, 7.259065389633179, -0.0020862817764424335, 7.145898230373859, -38.711151385679855, -14.399679757654681, -12.12013599276544, 27.91458928585051, 14.806628983467817, -72.19551600515835, 34.32452463358641, -14.850772828795044, -15.598984293639688, 11.261562876403332, -21.254037015140085, -8.353422803804293, 13.775235377252102, 17.011873599141836, -10.19139840453866, -44.64422810822728, 3.304718293249607, 37.41335318982598, 7.345856502652154, -9.875654637813597, 8.131863519549356, 27.748803660273538, -7.2228490076959275, 18.43922203034161, -27.85829511284831, -5.016599707305446, 1.3366352617740347, 1.61557487398386, 13.953671179711804, -10.648815050721197, 12.001836046576472, 7.670308209955664, 25.26869896426797, 33.01945065334438, -4.544781647622585, -362.3990852832794, -16.727117769420147, -22.413630098104477, -321.59275782853365, 10.88873882591723, 7.985551506280871, 10.440928809344754, 18.23855268955228, -0.6232213452458666, 34.7182515002787, -13.46655591391027, 18.205159664154053, 0.1749645695090294, -22.00958906859161, -27.7282466068864, 21.479485232383013, 17.90959007292986, -2.1453540027141713, -25.839725852012663, 38.21245565637946, 11.737034473568187, 10.000201338902102, 10.759967967867823, -2.6482477337121964, 63.10753016918896, 24.856791801750646, 2.826969765126691, -9.27205261588098, 7.29045654833314, -10.53925853967668, -2.325127508491306, 13.19324728101492, 10.825953602790818, 17.83609854429959, -6.431767523288741, 9.15657515078783, 3.960928201675401, 19.75167725235221, 46.38538269884883, 13.238292552530766, 7.745339296758161, 8.10087344795464, 4.51892164349556, 16.387647703289986, -38.49100016802551, 9.159602835774393, 23.268791787326336, -303.2542890012264, 21.96783781051633, -34.25553028471771, 12.441624514758558, 4.7540857791900635, 2.377068959176512, 26.04438264667988], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 334, 500, 500, 106, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [2.068527308603123, 2.1222642858823093, 2.224625130494431, -4.280173589785903, -3.638820533951133, -4.110797752936691, -8.497167850534126, -8.369034739832088, -9.210889736811325, 2.683553603788212, 2.439941336711243, 2.760885005195931, 9.398746064553649, 9.209045621256024, 9.153815137843281, -1.1435520350933075, -1.2907009273767471, -1.066706970334053, 6.74153932929039, 6.285178154706955, 5.90810889005661, -1.8493934522072522, -1.7223156417409626, -2.4803925851980893, 2.579805091023445, 1.939544215798378, 2.7397160828113556, -0.2589428822199551, -0.10977935294310726, 0.3666359533866199, 2.4447112157940865, 2.1903032064437866, 2.5108838081359863, -13.233361954490348, -12.770850344250604, -12.706939086938903, -4.793284277121231, -4.715336191157505, -4.891059289375946, -4.033851924041912, -3.994071560601398, -4.092212508122131, 9.212377001841858, 9.256846015652016, 9.445366268356636, 4.91646683216095, 4.766317665576935, 5.123844485729933, -23.684145025908954, -23.86497240513564, -24.646398574113853, 11.514050863683224, 11.297687157988548, 11.512786611914635, -5.104328294595092, -5.2666225781043465, -4.479821956095606, -5.234042321642249, -4.989835349222034, -5.375106622775405, 3.8639814108610153, 4.035007514059544, 3.362573951482773, -6.97300906976065, -7.286314403017371, -6.994713542362064, -2.733882779876396, -3.18023380140464, -2.439306222523257, 5.003611706197262, 4.73324790596962, 4.03837576508522, 5.667896434664726, 5.9231984205543995, 5.42077874392271, -2.820091990133136, -3.700393622120231, -3.670912792285293, -14.694892478485912, -14.97853269179663, -14.97080293794474, 0.7863667756319046, 1.1142413467168808, 1.4041101709008217, 12.454564626018197, 12.654024119178445, 12.304764444629342, 2.7888388683398517, 2.3516803731520923, 2.20533726116021, -3.264653106530517, -3.425189723571151, -3.1858118077119286, 2.849147756894425, 2.402778779466942, 2.8799369831879886, 9.455175455970064, 8.789171879490212, 9.504456324813262, -1.9210009860495774, -2.253000217179462, -3.048847804466888, 5.807091077168778, 6.238124412794903, 6.39400654037793, -9.079766487081855, -9.221674417456, -9.556854208310455, -1.8216101328531948, -1.376283007363483, -1.8187065670887677, 0.5512499759594505, 0.5983664790789192, 0.18701880673566507, 0.8148342221975327, 0.5132898911833763, 0.28745076060295105, 4.8321379547317775, 4.47906570633252, 4.642467518647507, -3.388700248052686, -3.3683346447845395, -3.8917801578839715, 4.25132159392038, 4.567860032121331, 3.18265442053476, 2.2261163989702766, 2.483938003579766, 2.9602538074056213, 8.923697669059038, 8.113543197512627, 8.231458097696304, 11.078016941746071, 10.528593619664505, 11.412840091933802, -1.4743474423885345, -1.9170759171247482, -1.1533582881093025, -120.96389337380728, -120.28839840491614, -121.14679350455603, -5.725373074412346, -5.478875868022442, -5.522868826985359, -7.286942720413208, -6.795996248722076, -8.330691128969193, -103.124284910659, -103.96929068366687, -114.4991822342078, 3.7919353221853527, 3.755482462545231, 3.341321041186646, 2.2648898760477607, 2.742416436473519, 2.978245193759591, 3.6908411433299335, 3.342831042905644, 3.407256623109177, 6.3054705510536735, 6.238827491799981, 5.694254646698624, -0.0014018093546326327, -0.18595265348753287, -0.4358668824037011, 11.523894180854157, 12.032342010488108, 11.162015308936432, -4.928215071558952, -4.016102021560073, -4.5222388207912445, 6.103166125714779, 5.936367109417915, 6.1656264290213585, -0.46795693039894104, 0.42252450436353683, 0.2203969955444336, -7.072081911067173, -7.417881498734161, -7.519625658790275, -8.819987254838153, -9.736946413914367, -9.17131293813388, 6.780550166964531, 7.638318467885256, 7.060616597533226, 5.869856685400009, 5.827537909150124, 6.212195478379726, -0.5361426124970166, -1.147476310531303, -0.4617350796858517, -8.687723790605872, -8.327735801537841, -8.82426625986895, 12.801113344728947, 12.916230086237192, 12.495112225413322, 4.106562548627451, 3.905536030729607, 3.7249358942111286, 3.0505024691422733, 3.850932284568742, 3.098766585191086, 3.764672326544911, 2.9685814778009956, 4.026714163521916, -0.9998332560062408, -0.5819033682346344, -1.066511109471321, 21.125498337050274, 21.168302183349923, 20.813729648788765, 8.329099630316094, 8.478158441682652, 8.0495337297519, 0.8182247330745014, 1.1307542746265682, 0.8779907574256214, -2.8504116485516278, -2.877159456412002, -3.5444815109173504, 2.272910411159188, 2.3122457514206474, 2.7053003857533042, -3.324981297055885, -3.359218875567123, -3.8550583670536724, -0.4564849076171811, -1.0334565093120034, -0.8351860915621216, 4.51643493026495, 4.671129584312439, 4.0056827664375305, 3.6037880827983173, 3.5321712394555362, 3.6899942805369648, 6.4463266556461605, 5.866341908772782, 5.523429979880646, -1.8245658377806393, -2.4047718296448437, -2.202429855863258, 3.156313233077526, 2.9540115669369698, 3.0462503507733345, 1.485529092450932, 0.8574343075354847, 1.6179648016889843, 6.3196567694346015, 6.81827003757158, 6.613750445346028, 15.081919958194092, 15.430417885382965, 15.873044855271772, 4.441644012928009, 4.45157228410244, 4.345076255500317, 2.525213380654648, 2.7311698546012195, 2.488956061502293, 2.6973423709471973, 2.3106651355822834, 3.09286594142516, 1.5978142768144608, 1.3772390186786652, 1.5438683480024338, 5.497410848736763, 5.4130938947200775, 5.477142959833145, -12.868062595526382, -12.790571602682277, -12.832365969816848, 3.1204544554153983, 2.827378044525773, 3.211770335833222, 8.166272707283497, 7.8367127031087875, 7.2658063769340515, -98.08721283078194, -107.99520881474018, -97.17186735570431, 7.177755857507378, 7.398686880866677, 7.391395072142274, -10.990518278752774, -11.644694929321616, -11.620317076643317, 3.592859084407479, 4.54030121366182, 4.308464216689259, 1.4275522828102112, 1.5219787061214447, 1.8045547902584076, 0.3620249281326835, 0.9420459220806663, 1.0729981089631622, 8.585427939891815, 8.676486030220985, 8.782468676567078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14255806886018393, "mean_inference_ms": 0.6561037898877267, "mean_action_processing_ms": 0.09586525817725387, "mean_env_wait_ms": 0.7992923939398611, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 245000, "timesteps_this_iter": 0, "agent_timesteps_total": 735000, "timers": {"sample_time_ms": 10776.891, "sample_throughput": 463.956, "load_time_ms": 0.099, "load_throughput": 50291414.868, "learn_time_ms": 1599.154, "learn_throughput": 3126.654, "update_time_ms": 7.878}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0005000000000000001, "total_loss": 78.81228790283203, "policy_loss": -0.00279929547538984, "vf_loss": 78.88613433837891, "vf_explained_var": -0.019208741188049317, "kl": 0.009982198069343234, "entropy": 7.105132341384888, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 245000, "num_agent_steps_sampled": 735000, "num_steps_trained": 245000, "num_agent_steps_trained": 735000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1331, "training_iteration": 49, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-17-31", "timestamp": 1706228251, "time_this_iter_s": 10.901751279830933, "time_total_s": 495.37307596206665, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202846E4D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 495.37307596206665, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 11.033333333333333, "ram_util_percent": 52.726666666666674}}
{"episode_reward_max": 63.10753016918896, "episode_reward_min": -362.3990852832794, "episode_reward_mean": -4.748061420489114, "episode_len_mean": 490.03, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -121.14679350455603}, "policy_reward_max": {"shared_policy": 21.168302183349923}, "policy_reward_mean": {"shared_policy": -1.5826871401630394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.145898230373859, -38.711151385679855, -14.399679757654681, -12.12013599276544, 27.91458928585051, 14.806628983467817, -72.19551600515835, 34.32452463358641, -14.850772828795044, -15.598984293639688, 11.261562876403332, -21.254037015140085, -8.353422803804293, 13.775235377252102, 17.011873599141836, -10.19139840453866, -44.64422810822728, 3.304718293249607, 37.41335318982598, 7.345856502652154, -9.875654637813597, 8.131863519549356, 27.748803660273538, -7.2228490076959275, 18.43922203034161, -27.85829511284831, -5.016599707305446, 1.3366352617740347, 1.61557487398386, 13.953671179711804, -10.648815050721197, 12.001836046576472, 7.670308209955664, 25.26869896426797, 33.01945065334438, -4.544781647622585, -362.3990852832794, -16.727117769420147, -22.413630098104477, -321.59275782853365, 10.88873882591723, 7.985551506280871, 10.440928809344754, 18.23855268955228, -0.6232213452458666, 34.7182515002787, -13.46655591391027, 18.205159664154053, 0.1749645695090294, -22.00958906859161, -27.7282466068864, 21.479485232383013, 17.90959007292986, -2.1453540027141713, -25.839725852012663, 38.21245565637946, 11.737034473568187, 10.000201338902102, 10.759967967867823, -2.6482477337121964, 63.10753016918896, 24.856791801750646, 2.826969765126691, -9.27205261588098, 7.29045654833314, -10.53925853967668, -2.325127508491306, 13.19324728101492, 10.825953602790818, 17.83609854429959, -6.431767523288741, 9.15657515078783, 3.960928201675401, 19.75167725235221, 46.38538269884883, 13.238292552530766, 7.745339296758161, 8.10087344795464, 4.51892164349556, 16.387647703289986, -38.49100016802551, 9.159602835774393, 23.268791787326336, -303.2542890012264, 21.96783781051633, -34.25553028471771, 12.441624514758558, 4.7540857791900635, 2.377068959176512, 26.04438264667988, 33.024083599448204, 17.433504775166497, 37.047203928232165, 18.88963054865596, 6.411947004497023, 13.475078180432305, -12.016673162579565, 9.930931918323026, 14.925424054265008, 22.284338335506604], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 334, 500, 500, 106, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [2.4447112157940865, 2.1903032064437866, 2.5108838081359863, -13.233361954490348, -12.770850344250604, -12.706939086938903, -4.793284277121231, -4.715336191157505, -4.891059289375946, -4.033851924041912, -3.994071560601398, -4.092212508122131, 9.212377001841858, 9.256846015652016, 9.445366268356636, 4.91646683216095, 4.766317665576935, 5.123844485729933, -23.684145025908954, -23.86497240513564, -24.646398574113853, 11.514050863683224, 11.297687157988548, 11.512786611914635, -5.104328294595092, -5.2666225781043465, -4.479821956095606, -5.234042321642249, -4.989835349222034, -5.375106622775405, 3.8639814108610153, 4.035007514059544, 3.362573951482773, -6.97300906976065, -7.286314403017371, -6.994713542362064, -2.733882779876396, -3.18023380140464, -2.439306222523257, 5.003611706197262, 4.73324790596962, 4.03837576508522, 5.667896434664726, 5.9231984205543995, 5.42077874392271, -2.820091990133136, -3.700393622120231, -3.670912792285293, -14.694892478485912, -14.97853269179663, -14.97080293794474, 0.7863667756319046, 1.1142413467168808, 1.4041101709008217, 12.454564626018197, 12.654024119178445, 12.304764444629342, 2.7888388683398517, 2.3516803731520923, 2.20533726116021, -3.264653106530517, -3.425189723571151, -3.1858118077119286, 2.849147756894425, 2.402778779466942, 2.8799369831879886, 9.455175455970064, 8.789171879490212, 9.504456324813262, -1.9210009860495774, -2.253000217179462, -3.048847804466888, 5.807091077168778, 6.238124412794903, 6.39400654037793, -9.079766487081855, -9.221674417456, -9.556854208310455, -1.8216101328531948, -1.376283007363483, -1.8187065670887677, 0.5512499759594505, 0.5983664790789192, 0.18701880673566507, 0.8148342221975327, 0.5132898911833763, 0.28745076060295105, 4.8321379547317775, 4.47906570633252, 4.642467518647507, -3.388700248052686, -3.3683346447845395, -3.8917801578839715, 4.25132159392038, 4.567860032121331, 3.18265442053476, 2.2261163989702766, 2.483938003579766, 2.9602538074056213, 8.923697669059038, 8.113543197512627, 8.231458097696304, 11.078016941746071, 10.528593619664505, 11.412840091933802, -1.4743474423885345, -1.9170759171247482, -1.1533582881093025, -120.96389337380728, -120.28839840491614, -121.14679350455603, -5.725373074412346, -5.478875868022442, -5.522868826985359, -7.286942720413208, -6.795996248722076, -8.330691128969193, -103.124284910659, -103.96929068366687, -114.4991822342078, 3.7919353221853527, 3.755482462545231, 3.341321041186646, 2.2648898760477607, 2.742416436473519, 2.978245193759591, 3.6908411433299335, 3.342831042905644, 3.407256623109177, 6.3054705510536735, 6.238827491799981, 5.694254646698624, -0.0014018093546326327, -0.18595265348753287, -0.4358668824037011, 11.523894180854157, 12.032342010488108, 11.162015308936432, -4.928215071558952, -4.016102021560073, -4.5222388207912445, 6.103166125714779, 5.936367109417915, 6.1656264290213585, -0.46795693039894104, 0.42252450436353683, 0.2203969955444336, -7.072081911067173, -7.417881498734161, -7.519625658790275, -8.819987254838153, -9.736946413914367, -9.17131293813388, 6.780550166964531, 7.638318467885256, 7.060616597533226, 5.869856685400009, 5.827537909150124, 6.212195478379726, -0.5361426124970166, -1.147476310531303, -0.4617350796858517, -8.687723790605872, -8.327735801537841, -8.82426625986895, 12.801113344728947, 12.916230086237192, 12.495112225413322, 4.106562548627451, 3.905536030729607, 3.7249358942111286, 3.0505024691422733, 3.850932284568742, 3.098766585191086, 3.764672326544911, 2.9685814778009956, 4.026714163521916, -0.9998332560062408, -0.5819033682346344, -1.066511109471321, 21.125498337050274, 21.168302183349923, 20.813729648788765, 8.329099630316094, 8.478158441682652, 8.0495337297519, 0.8182247330745014, 1.1307542746265682, 0.8779907574256214, -2.8504116485516278, -2.877159456412002, -3.5444815109173504, 2.272910411159188, 2.3122457514206474, 2.7053003857533042, -3.324981297055885, -3.359218875567123, -3.8550583670536724, -0.4564849076171811, -1.0334565093120034, -0.8351860915621216, 4.51643493026495, 4.671129584312439, 4.0056827664375305, 3.6037880827983173, 3.5321712394555362, 3.6899942805369648, 6.4463266556461605, 5.866341908772782, 5.523429979880646, -1.8245658377806393, -2.4047718296448437, -2.202429855863258, 3.156313233077526, 2.9540115669369698, 3.0462503507733345, 1.485529092450932, 0.8574343075354847, 1.6179648016889843, 6.3196567694346015, 6.81827003757158, 6.613750445346028, 15.081919958194092, 15.430417885382965, 15.873044855271772, 4.441644012928009, 4.45157228410244, 4.345076255500317, 2.525213380654648, 2.7311698546012195, 2.488956061502293, 2.6973423709471973, 2.3106651355822834, 3.09286594142516, 1.5978142768144608, 1.3772390186786652, 1.5438683480024338, 5.497410848736763, 5.4130938947200775, 5.477142959833145, -12.868062595526382, -12.790571602682277, -12.832365969816848, 3.1204544554153983, 2.827378044525773, 3.211770335833222, 8.166272707283497, 7.8367127031087875, 7.2658063769340515, -98.08721283078194, -107.99520881474018, -97.17186735570431, 7.177755857507378, 7.398686880866677, 7.391395072142274, -10.990518278752774, -11.644694929321616, -11.620317076643317, 3.592859084407479, 4.54030121366182, 4.308464216689259, 1.4275522828102112, 1.5219787061214447, 1.8045547902584076, 0.3620249281326835, 0.9420459220806663, 1.0729981089631622, 8.585427939891815, 8.676486030220985, 8.782468676567078, 10.620003789663315, 11.149892061948776, 11.254187747836113, 6.11529306073983, 6.083713402350739, 5.234498312075928, 12.315647254387528, 12.848025063673646, 11.88353161017099, 6.083394835392625, 6.371249506870896, 6.434986206392438, 2.2456901992360656, 2.3628753523031776, 1.8033814529577796, 4.508117010196045, 4.684769009550408, 4.282192160685852, -3.659870450695365, -4.44660094877085, -3.910201763113349, 3.4514768769343647, 3.1681941424806865, 3.3112608989079746, 5.335405459006623, 4.628653590877846, 4.961365004380539, 7.182144602139786, 7.718993127656475, 7.383200605710343]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1426056224431891, "mean_inference_ms": 0.6570779819148757, "mean_action_processing_ms": 0.09599123919649039, "mean_env_wait_ms": 0.8008091043777482, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 250000, "timesteps_this_iter": 0, "agent_timesteps_total": 750000, "timers": {"sample_time_ms": 10786.701, "sample_throughput": 463.534, "load_time_ms": 0.099, "load_throughput": 50291414.868, "learn_time_ms": 1590.369, "learn_throughput": 3143.924, "update_time_ms": 7.645}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0005000000000000001, "total_loss": 6.698568058013916, "policy_loss": -0.00295908628781949, "vf_loss": 6.773976564407349, "vf_explained_var": -1.0, "kl": 0.0035373163875257545, "entropy": 7.244961071014404, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 250000, "num_agent_steps_sampled": 750000, "num_steps_trained": 250000, "num_agent_steps_trained": 750000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 34.0126005709171, "episode_reward_min": -7.471814773976803, "episode_reward_mean": 14.604975010338228, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -2.798642635345459}, "policy_reward_max": {"shared_policy": 11.669605577985436}, "policy_reward_mean": {"shared_policy": 4.868325003446076}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.439413283020258, 34.0126005709171, 19.64425831101832, 18.19293911755082, -2.248585879802704, 15.353883542120457, 30.757842459483044, 14.88079072907567, 5.488422743976116, -7.471814773976803], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [5.736105754971504, 5.544210985302925, 6.159096542745829, 11.329937706391007, 11.013057286540658, 11.669605577985436, 6.758205151806266, 6.997322921330721, 5.888730237881333, 6.471938128272683, 6.219684044520051, 5.501316944758088, -1.1529182344675064, -0.5383021458983421, -0.5573654994368553, 5.161621272563934, 4.941599033772945, 5.250663235783577, 10.34764928619066, 10.733509499036387, 9.676683674255997, 5.138225499540567, 5.122085884213448, 4.620479345321655, 1.1867379546165466, 1.9115520417690277, 2.390132747590542, -2.0579599663615227, -2.798642635345459, -2.615212172269821]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13563595302484915, "mean_inference_ms": 0.6891553627445897, "mean_action_processing_ms": 0.10191533737625033, "mean_env_wait_ms": 0.8480618462946815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 1341, "training_iteration": 50, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-17-51", "timestamp": 1706228271, "time_this_iter_s": 20.166138172149658, "time_total_s": 515.5392141342163, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824925E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 515.5392141342163, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 10.655172413793105, "ram_util_percent": 52.68965517241378}}
{"episode_reward_max": 63.10753016918896, "episode_reward_min": -362.3990852832794, "episode_reward_mean": -1.810539296148358, "episode_len_mean": 490.03, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -121.14679350455603}, "policy_reward_max": {"shared_policy": 21.168302183349923}, "policy_reward_mean": {"shared_policy": -0.6035130987161197}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.261562876403332, -21.254037015140085, -8.353422803804293, 13.775235377252102, 17.011873599141836, -10.19139840453866, -44.64422810822728, 3.304718293249607, 37.41335318982598, 7.345856502652154, -9.875654637813597, 8.131863519549356, 27.748803660273538, -7.2228490076959275, 18.43922203034161, -27.85829511284831, -5.016599707305446, 1.3366352617740347, 1.61557487398386, 13.953671179711804, -10.648815050721197, 12.001836046576472, 7.670308209955664, 25.26869896426797, 33.01945065334438, -4.544781647622585, -362.3990852832794, -16.727117769420147, -22.413630098104477, -321.59275782853365, 10.88873882591723, 7.985551506280871, 10.440928809344754, 18.23855268955228, -0.6232213452458666, 34.7182515002787, -13.46655591391027, 18.205159664154053, 0.1749645695090294, -22.00958906859161, -27.7282466068864, 21.479485232383013, 17.90959007292986, -2.1453540027141713, -25.839725852012663, 38.21245565637946, 11.737034473568187, 10.000201338902102, 10.759967967867823, -2.6482477337121964, 63.10753016918896, 24.856791801750646, 2.826969765126691, -9.27205261588098, 7.29045654833314, -10.53925853967668, -2.325127508491306, 13.19324728101492, 10.825953602790818, 17.83609854429959, -6.431767523288741, 9.15657515078783, 3.960928201675401, 19.75167725235221, 46.38538269884883, 13.238292552530766, 7.745339296758161, 8.10087344795464, 4.51892164349556, 16.387647703289986, -38.49100016802551, 9.159602835774393, 23.268791787326336, -303.2542890012264, 21.96783781051633, -34.25553028471771, 12.441624514758558, 4.7540857791900635, 2.377068959176512, 26.04438264667988, 33.024083599448204, 17.433504775166497, 37.047203928232165, 18.88963054865596, 6.411947004497023, 13.475078180432305, -12.016673162579565, 9.930931918323026, 14.925424054265008, 22.284338335506604, 15.962607920169816, 35.78087469935414, 19.929900225251913, 21.842284236103296, 35.756862327456474, 27.446187473833547, 47.30958164483309, 23.45077417790887, -31.172596536576762, 13.761137135326848], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 334, 500, 500, 106, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [3.8639814108610153, 4.035007514059544, 3.362573951482773, -6.97300906976065, -7.286314403017371, -6.994713542362064, -2.733882779876396, -3.18023380140464, -2.439306222523257, 5.003611706197262, 4.73324790596962, 4.03837576508522, 5.667896434664726, 5.9231984205543995, 5.42077874392271, -2.820091990133136, -3.700393622120231, -3.670912792285293, -14.694892478485912, -14.97853269179663, -14.97080293794474, 0.7863667756319046, 1.1142413467168808, 1.4041101709008217, 12.454564626018197, 12.654024119178445, 12.304764444629342, 2.7888388683398517, 2.3516803731520923, 2.20533726116021, -3.264653106530517, -3.425189723571151, -3.1858118077119286, 2.849147756894425, 2.402778779466942, 2.8799369831879886, 9.455175455970064, 8.789171879490212, 9.504456324813262, -1.9210009860495774, -2.253000217179462, -3.048847804466888, 5.807091077168778, 6.238124412794903, 6.39400654037793, -9.079766487081855, -9.221674417456, -9.556854208310455, -1.8216101328531948, -1.376283007363483, -1.8187065670887677, 0.5512499759594505, 0.5983664790789192, 0.18701880673566507, 0.8148342221975327, 0.5132898911833763, 0.28745076060295105, 4.8321379547317775, 4.47906570633252, 4.642467518647507, -3.388700248052686, -3.3683346447845395, -3.8917801578839715, 4.25132159392038, 4.567860032121331, 3.18265442053476, 2.2261163989702766, 2.483938003579766, 2.9602538074056213, 8.923697669059038, 8.113543197512627, 8.231458097696304, 11.078016941746071, 10.528593619664505, 11.412840091933802, -1.4743474423885345, -1.9170759171247482, -1.1533582881093025, -120.96389337380728, -120.28839840491614, -121.14679350455603, -5.725373074412346, -5.478875868022442, -5.522868826985359, -7.286942720413208, -6.795996248722076, -8.330691128969193, -103.124284910659, -103.96929068366687, -114.4991822342078, 3.7919353221853527, 3.755482462545231, 3.341321041186646, 2.2648898760477607, 2.742416436473519, 2.978245193759591, 3.6908411433299335, 3.342831042905644, 3.407256623109177, 6.3054705510536735, 6.238827491799981, 5.694254646698624, -0.0014018093546326327, -0.18595265348753287, -0.4358668824037011, 11.523894180854157, 12.032342010488108, 11.162015308936432, -4.928215071558952, -4.016102021560073, -4.5222388207912445, 6.103166125714779, 5.936367109417915, 6.1656264290213585, -0.46795693039894104, 0.42252450436353683, 0.2203969955444336, -7.072081911067173, -7.417881498734161, -7.519625658790275, -8.819987254838153, -9.736946413914367, -9.17131293813388, 6.780550166964531, 7.638318467885256, 7.060616597533226, 5.869856685400009, 5.827537909150124, 6.212195478379726, -0.5361426124970166, -1.147476310531303, -0.4617350796858517, -8.687723790605872, -8.327735801537841, -8.82426625986895, 12.801113344728947, 12.916230086237192, 12.495112225413322, 4.106562548627451, 3.905536030729607, 3.7249358942111286, 3.0505024691422733, 3.850932284568742, 3.098766585191086, 3.764672326544911, 2.9685814778009956, 4.026714163521916, -0.9998332560062408, -0.5819033682346344, -1.066511109471321, 21.125498337050274, 21.168302183349923, 20.813729648788765, 8.329099630316094, 8.478158441682652, 8.0495337297519, 0.8182247330745014, 1.1307542746265682, 0.8779907574256214, -2.8504116485516278, -2.877159456412002, -3.5444815109173504, 2.272910411159188, 2.3122457514206474, 2.7053003857533042, -3.324981297055885, -3.359218875567123, -3.8550583670536724, -0.4564849076171811, -1.0334565093120034, -0.8351860915621216, 4.51643493026495, 4.671129584312439, 4.0056827664375305, 3.6037880827983173, 3.5321712394555362, 3.6899942805369648, 6.4463266556461605, 5.866341908772782, 5.523429979880646, -1.8245658377806393, -2.4047718296448437, -2.202429855863258, 3.156313233077526, 2.9540115669369698, 3.0462503507733345, 1.485529092450932, 0.8574343075354847, 1.6179648016889843, 6.3196567694346015, 6.81827003757158, 6.613750445346028, 15.081919958194092, 15.430417885382965, 15.873044855271772, 4.441644012928009, 4.45157228410244, 4.345076255500317, 2.525213380654648, 2.7311698546012195, 2.488956061502293, 2.6973423709471973, 2.3106651355822834, 3.09286594142516, 1.5978142768144608, 1.3772390186786652, 1.5438683480024338, 5.497410848736763, 5.4130938947200775, 5.477142959833145, -12.868062595526382, -12.790571602682277, -12.832365969816848, 3.1204544554153983, 2.827378044525773, 3.211770335833222, 8.166272707283497, 7.8367127031087875, 7.2658063769340515, -98.08721283078194, -107.99520881474018, -97.17186735570431, 7.177755857507378, 7.398686880866677, 7.391395072142274, -10.990518278752774, -11.644694929321616, -11.620317076643317, 3.592859084407479, 4.54030121366182, 4.308464216689259, 1.4275522828102112, 1.5219787061214447, 1.8045547902584076, 0.3620249281326835, 0.9420459220806663, 1.0729981089631622, 8.585427939891815, 8.676486030220985, 8.782468676567078, 10.620003789663315, 11.149892061948776, 11.254187747836113, 6.11529306073983, 6.083713402350739, 5.234498312075928, 12.315647254387528, 12.848025063673646, 11.88353161017099, 6.083394835392625, 6.371249506870896, 6.434986206392438, 2.2456901992360656, 2.3628753523031776, 1.8033814529577796, 4.508117010196045, 4.684769009550408, 4.282192160685852, -3.659870450695365, -4.44660094877085, -3.910201763113349, 3.4514768769343647, 3.1681941424806865, 3.3112608989079746, 5.335405459006623, 4.628653590877846, 4.961365004380539, 7.182144602139786, 7.718993127656475, 7.383200605710343, 5.731754583617047, 5.593978521724537, 4.636874814828232, 12.28394343952337, 11.967523987094552, 11.529407272736222, 6.395122930407524, 6.59927174448967, 6.935505550354719, 7.523909669369459, 7.211991615593433, 7.106382951140404, 11.877131715416908, 11.948873803019524, 11.930856809020042, 9.187610050042466, 9.61013139535983, 8.648446028431252, 15.941758058965206, 16.053242102265358, 15.314581483602524, 7.784455331663281, 7.70326981941858, 7.963049026827008, -10.048228087524578, -10.48079400757949, -10.643574441472694, 5.033891675372914, 3.8866874476273807, 4.840558012326554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.142657197431487, "mean_inference_ms": 0.6580159967104783, "mean_action_processing_ms": 0.09615010548848789, "mean_env_wait_ms": 0.8022709304191337, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 255000, "timesteps_this_iter": 0, "agent_timesteps_total": 765000, "timers": {"sample_time_ms": 11669.67, "sample_throughput": 428.461, "load_time_ms": 0.099, "load_throughput": 50291414.868, "learn_time_ms": 1580.795, "learn_throughput": 3162.966, "update_time_ms": 8.067}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 0.0005000000000000001, "total_loss": 4.396384000778198, "policy_loss": -0.0026538962078063387, "vf_loss": 4.47122859954834, "vf_explained_var": -0.8321609258651733, "kl": 0.0035536057548662637, "entropy": 7.219079303741455, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 255000, "num_agent_steps_sampled": 765000, "num_steps_trained": 255000, "num_agent_steps_trained": 765000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1351, "training_iteration": 51, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-18-02", "timestamp": 1706228282, "time_this_iter_s": 10.987370014190674, "time_total_s": 526.526584148407, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824920D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 526.526584148407, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 11.693333333333335, "ram_util_percent": 52.64666666666668}}
{"episode_reward_max": 63.10753016918896, "episode_reward_min": -362.3990852832794, "episode_reward_mean": -0.7628746583333245, "episode_len_mean": 490.03, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -121.14679350455603}, "policy_reward_max": {"shared_policy": 21.168302183349923}, "policy_reward_mean": {"shared_policy": -0.2542915527777755}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.875654637813597, 8.131863519549356, 27.748803660273538, -7.2228490076959275, 18.43922203034161, -27.85829511284831, -5.016599707305446, 1.3366352617740347, 1.61557487398386, 13.953671179711804, -10.648815050721197, 12.001836046576472, 7.670308209955664, 25.26869896426797, 33.01945065334438, -4.544781647622585, -362.3990852832794, -16.727117769420147, -22.413630098104477, -321.59275782853365, 10.88873882591723, 7.985551506280871, 10.440928809344754, 18.23855268955228, -0.6232213452458666, 34.7182515002787, -13.46655591391027, 18.205159664154053, 0.1749645695090294, -22.00958906859161, -27.7282466068864, 21.479485232383013, 17.90959007292986, -2.1453540027141713, -25.839725852012663, 38.21245565637946, 11.737034473568187, 10.000201338902102, 10.759967967867823, -2.6482477337121964, 63.10753016918896, 24.856791801750646, 2.826969765126691, -9.27205261588098, 7.29045654833314, -10.53925853967668, -2.325127508491306, 13.19324728101492, 10.825953602790818, 17.83609854429959, -6.431767523288741, 9.15657515078783, 3.960928201675401, 19.75167725235221, 46.38538269884883, 13.238292552530766, 7.745339296758161, 8.10087344795464, 4.51892164349556, 16.387647703289986, -38.49100016802551, 9.159602835774393, 23.268791787326336, -303.2542890012264, 21.96783781051633, -34.25553028471771, 12.441624514758558, 4.7540857791900635, 2.377068959176512, 26.04438264667988, 33.024083599448204, 17.433504775166497, 37.047203928232165, 18.88963054865596, 6.411947004497023, 13.475078180432305, -12.016673162579565, 9.930931918323026, 14.925424054265008, 22.284338335506604, 15.962607920169816, 35.78087469935414, 19.929900225251913, 21.842284236103296, 35.756862327456474, 27.446187473833547, 47.30958164483309, 23.45077417790887, -31.172596536576762, 13.761137135326848, -4.186826184392004, 14.021149881184073, 27.435740739107132, 41.29938079230487, 25.06045801824075, 29.544400170445442, -2.6182600110769414, 4.309302493929849, -20.15353518724443, -4.27583342418076], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 334, 500, 500, 106, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-3.264653106530517, -3.425189723571151, -3.1858118077119286, 2.849147756894425, 2.402778779466942, 2.8799369831879886, 9.455175455970064, 8.789171879490212, 9.504456324813262, -1.9210009860495774, -2.253000217179462, -3.048847804466888, 5.807091077168778, 6.238124412794903, 6.39400654037793, -9.079766487081855, -9.221674417456, -9.556854208310455, -1.8216101328531948, -1.376283007363483, -1.8187065670887677, 0.5512499759594505, 0.5983664790789192, 0.18701880673566507, 0.8148342221975327, 0.5132898911833763, 0.28745076060295105, 4.8321379547317775, 4.47906570633252, 4.642467518647507, -3.388700248052686, -3.3683346447845395, -3.8917801578839715, 4.25132159392038, 4.567860032121331, 3.18265442053476, 2.2261163989702766, 2.483938003579766, 2.9602538074056213, 8.923697669059038, 8.113543197512627, 8.231458097696304, 11.078016941746071, 10.528593619664505, 11.412840091933802, -1.4743474423885345, -1.9170759171247482, -1.1533582881093025, -120.96389337380728, -120.28839840491614, -121.14679350455603, -5.725373074412346, -5.478875868022442, -5.522868826985359, -7.286942720413208, -6.795996248722076, -8.330691128969193, -103.124284910659, -103.96929068366687, -114.4991822342078, 3.7919353221853527, 3.755482462545231, 3.341321041186646, 2.2648898760477607, 2.742416436473519, 2.978245193759591, 3.6908411433299335, 3.342831042905644, 3.407256623109177, 6.3054705510536735, 6.238827491799981, 5.694254646698624, -0.0014018093546326327, -0.18595265348753287, -0.4358668824037011, 11.523894180854157, 12.032342010488108, 11.162015308936432, -4.928215071558952, -4.016102021560073, -4.5222388207912445, 6.103166125714779, 5.936367109417915, 6.1656264290213585, -0.46795693039894104, 0.42252450436353683, 0.2203969955444336, -7.072081911067173, -7.417881498734161, -7.519625658790275, -8.819987254838153, -9.736946413914367, -9.17131293813388, 6.780550166964531, 7.638318467885256, 7.060616597533226, 5.869856685400009, 5.827537909150124, 6.212195478379726, -0.5361426124970166, -1.147476310531303, -0.4617350796858517, -8.687723790605872, -8.327735801537841, -8.82426625986895, 12.801113344728947, 12.916230086237192, 12.495112225413322, 4.106562548627451, 3.905536030729607, 3.7249358942111286, 3.0505024691422733, 3.850932284568742, 3.098766585191086, 3.764672326544911, 2.9685814778009956, 4.026714163521916, -0.9998332560062408, -0.5819033682346344, -1.066511109471321, 21.125498337050274, 21.168302183349923, 20.813729648788765, 8.329099630316094, 8.478158441682652, 8.0495337297519, 0.8182247330745014, 1.1307542746265682, 0.8779907574256214, -2.8504116485516278, -2.877159456412002, -3.5444815109173504, 2.272910411159188, 2.3122457514206474, 2.7053003857533042, -3.324981297055885, -3.359218875567123, -3.8550583670536724, -0.4564849076171811, -1.0334565093120034, -0.8351860915621216, 4.51643493026495, 4.671129584312439, 4.0056827664375305, 3.6037880827983173, 3.5321712394555362, 3.6899942805369648, 6.4463266556461605, 5.866341908772782, 5.523429979880646, -1.8245658377806393, -2.4047718296448437, -2.202429855863258, 3.156313233077526, 2.9540115669369698, 3.0462503507733345, 1.485529092450932, 0.8574343075354847, 1.6179648016889843, 6.3196567694346015, 6.81827003757158, 6.613750445346028, 15.081919958194092, 15.430417885382965, 15.873044855271772, 4.441644012928009, 4.45157228410244, 4.345076255500317, 2.525213380654648, 2.7311698546012195, 2.488956061502293, 2.6973423709471973, 2.3106651355822834, 3.09286594142516, 1.5978142768144608, 1.3772390186786652, 1.5438683480024338, 5.497410848736763, 5.4130938947200775, 5.477142959833145, -12.868062595526382, -12.790571602682277, -12.832365969816848, 3.1204544554153983, 2.827378044525773, 3.211770335833222, 8.166272707283497, 7.8367127031087875, 7.2658063769340515, -98.08721283078194, -107.99520881474018, -97.17186735570431, 7.177755857507378, 7.398686880866677, 7.391395072142274, -10.990518278752774, -11.644694929321616, -11.620317076643317, 3.592859084407479, 4.54030121366182, 4.308464216689259, 1.4275522828102112, 1.5219787061214447, 1.8045547902584076, 0.3620249281326835, 0.9420459220806663, 1.0729981089631622, 8.585427939891815, 8.676486030220985, 8.782468676567078, 10.620003789663315, 11.149892061948776, 11.254187747836113, 6.11529306073983, 6.083713402350739, 5.234498312075928, 12.315647254387528, 12.848025063673646, 11.88353161017099, 6.083394835392625, 6.371249506870896, 6.434986206392438, 2.2456901992360656, 2.3628753523031776, 1.8033814529577796, 4.508117010196045, 4.684769009550408, 4.282192160685852, -3.659870450695365, -4.44660094877085, -3.910201763113349, 3.4514768769343647, 3.1681941424806865, 3.3112608989079746, 5.335405459006623, 4.628653590877846, 4.961365004380539, 7.182144602139786, 7.718993127656475, 7.383200605710343, 5.731754583617047, 5.593978521724537, 4.636874814828232, 12.28394343952337, 11.967523987094552, 11.529407272736222, 6.395122930407524, 6.59927174448967, 6.935505550354719, 7.523909669369459, 7.211991615593433, 7.106382951140404, 11.877131715416908, 11.948873803019524, 11.930856809020042, 9.187610050042466, 9.61013139535983, 8.648446028431252, 15.941758058965206, 16.053242102265358, 15.314581483602524, 7.784455331663281, 7.70326981941858, 7.963049026827008, -10.048228087524578, -10.48079400757949, -10.643574441472694, 5.033891675372914, 3.8866874476273807, 4.840558012326554, -1.3171724056204255, -1.5549019922812874, -1.314751786490291, 4.909836428860814, 4.560714180270821, 4.5505992720524375, 9.304971292614937, 9.014493271708488, 9.116276174783707, 14.226340776309371, 13.833709754049778, 13.239330261945724, 8.798125698027434, 7.88957080245018, 8.372761517763138, 9.845080725848675, 10.16360705345869, 9.535712391138077, -0.6509393701950756, -0.8975731829802243, -1.0697474579016415, 1.3051686187585148, 1.6350110371907505, 1.3691228379805835, -6.311805481712028, -7.0753593097130505, -6.766370395819351, -1.4895741889874188, -1.5488253037134854, -1.2374339314798561]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14273375460339835, "mean_inference_ms": 0.6589384522358438, "mean_action_processing_ms": 0.09630746952631906, "mean_env_wait_ms": 0.8036952113594544, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 260000, "timesteps_this_iter": 0, "agent_timesteps_total": 780000, "timers": {"sample_time_ms": 11672.302, "sample_throughput": 428.365, "load_time_ms": 0.099, "load_throughput": 50291414.868, "learn_time_ms": 1568.977, "learn_throughput": 3186.789, "update_time_ms": 8.057}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0005000000000000001, "total_loss": 6.721080350875854, "policy_loss": -0.0028306879834209655, "vf_loss": 6.79736213684082, "vf_explained_var": -1.0, "kl": 0.004736939317088235, "entropy": 7.345088720321655, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 260000, "num_agent_steps_sampled": 780000, "num_steps_trained": 260000, "num_agent_steps_trained": 780000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1361, "training_iteration": 52, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-18-13", "timestamp": 1706228293, "time_this_iter_s": 10.578508853912354, "time_total_s": 537.1050930023193, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824B29D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 537.1050930023193, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 10.713333333333335, "ram_util_percent": 52.72000000000001}}
{"episode_reward_max": 63.10753016918896, "episode_reward_min": -362.3990852832794, "episode_reward_mean": 1.6779158036611508, "episode_len_mean": 490.03, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -121.14679350455603}, "policy_reward_max": {"shared_policy": 21.168302183349923}, "policy_reward_mean": {"shared_policy": 0.559305267887049}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.648815050721197, 12.001836046576472, 7.670308209955664, 25.26869896426797, 33.01945065334438, -4.544781647622585, -362.3990852832794, -16.727117769420147, -22.413630098104477, -321.59275782853365, 10.88873882591723, 7.985551506280871, 10.440928809344754, 18.23855268955228, -0.6232213452458666, 34.7182515002787, -13.46655591391027, 18.205159664154053, 0.1749645695090294, -22.00958906859161, -27.7282466068864, 21.479485232383013, 17.90959007292986, -2.1453540027141713, -25.839725852012663, 38.21245565637946, 11.737034473568187, 10.000201338902102, 10.759967967867823, -2.6482477337121964, 63.10753016918896, 24.856791801750646, 2.826969765126691, -9.27205261588098, 7.29045654833314, -10.53925853967668, -2.325127508491306, 13.19324728101492, 10.825953602790818, 17.83609854429959, -6.431767523288741, 9.15657515078783, 3.960928201675401, 19.75167725235221, 46.38538269884883, 13.238292552530766, 7.745339296758161, 8.10087344795464, 4.51892164349556, 16.387647703289986, -38.49100016802551, 9.159602835774393, 23.268791787326336, -303.2542890012264, 21.96783781051633, -34.25553028471771, 12.441624514758558, 4.7540857791900635, 2.377068959176512, 26.04438264667988, 33.024083599448204, 17.433504775166497, 37.047203928232165, 18.88963054865596, 6.411947004497023, 13.475078180432305, -12.016673162579565, 9.930931918323026, 14.925424054265008, 22.284338335506604, 15.962607920169816, 35.78087469935414, 19.929900225251913, 21.842284236103296, 35.756862327456474, 27.446187473833547, 47.30958164483309, 23.45077417790887, -31.172596536576762, 13.761137135326848, -4.186826184392004, 14.021149881184073, 27.435740739107132, 41.29938079230487, 25.06045801824075, 29.544400170445442, -2.6182600110769414, 4.309302493929849, -20.15353518724443, -4.27583342418076, 42.873344056308255, 26.133685939013958, 35.307167740538716, -18.93208537995818, 51.99022353067993, 32.53355118259785, 28.61481929570435, 16.6958528574323, 23.86389468610284, 26.250964350998373], "episode_lengths": [500, 500, 500, 500, 500, 500, 334, 500, 500, 106, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-3.388700248052686, -3.3683346447845395, -3.8917801578839715, 4.25132159392038, 4.567860032121331, 3.18265442053476, 2.2261163989702766, 2.483938003579766, 2.9602538074056213, 8.923697669059038, 8.113543197512627, 8.231458097696304, 11.078016941746071, 10.528593619664505, 11.412840091933802, -1.4743474423885345, -1.9170759171247482, -1.1533582881093025, -120.96389337380728, -120.28839840491614, -121.14679350455603, -5.725373074412346, -5.478875868022442, -5.522868826985359, -7.286942720413208, -6.795996248722076, -8.330691128969193, -103.124284910659, -103.96929068366687, -114.4991822342078, 3.7919353221853527, 3.755482462545231, 3.341321041186646, 2.2648898760477607, 2.742416436473519, 2.978245193759591, 3.6908411433299335, 3.342831042905644, 3.407256623109177, 6.3054705510536735, 6.238827491799981, 5.694254646698624, -0.0014018093546326327, -0.18595265348753287, -0.4358668824037011, 11.523894180854157, 12.032342010488108, 11.162015308936432, -4.928215071558952, -4.016102021560073, -4.5222388207912445, 6.103166125714779, 5.936367109417915, 6.1656264290213585, -0.46795693039894104, 0.42252450436353683, 0.2203969955444336, -7.072081911067173, -7.417881498734161, -7.519625658790275, -8.819987254838153, -9.736946413914367, -9.17131293813388, 6.780550166964531, 7.638318467885256, 7.060616597533226, 5.869856685400009, 5.827537909150124, 6.212195478379726, -0.5361426124970166, -1.147476310531303, -0.4617350796858517, -8.687723790605872, -8.327735801537841, -8.82426625986895, 12.801113344728947, 12.916230086237192, 12.495112225413322, 4.106562548627451, 3.905536030729607, 3.7249358942111286, 3.0505024691422733, 3.850932284568742, 3.098766585191086, 3.764672326544911, 2.9685814778009956, 4.026714163521916, -0.9998332560062408, -0.5819033682346344, -1.066511109471321, 21.125498337050274, 21.168302183349923, 20.813729648788765, 8.329099630316094, 8.478158441682652, 8.0495337297519, 0.8182247330745014, 1.1307542746265682, 0.8779907574256214, -2.8504116485516278, -2.877159456412002, -3.5444815109173504, 2.272910411159188, 2.3122457514206474, 2.7053003857533042, -3.324981297055885, -3.359218875567123, -3.8550583670536724, -0.4564849076171811, -1.0334565093120034, -0.8351860915621216, 4.51643493026495, 4.671129584312439, 4.0056827664375305, 3.6037880827983173, 3.5321712394555362, 3.6899942805369648, 6.4463266556461605, 5.866341908772782, 5.523429979880646, -1.8245658377806393, -2.4047718296448437, -2.202429855863258, 3.156313233077526, 2.9540115669369698, 3.0462503507733345, 1.485529092450932, 0.8574343075354847, 1.6179648016889843, 6.3196567694346015, 6.81827003757158, 6.613750445346028, 15.081919958194092, 15.430417885382965, 15.873044855271772, 4.441644012928009, 4.45157228410244, 4.345076255500317, 2.525213380654648, 2.7311698546012195, 2.488956061502293, 2.6973423709471973, 2.3106651355822834, 3.09286594142516, 1.5978142768144608, 1.3772390186786652, 1.5438683480024338, 5.497410848736763, 5.4130938947200775, 5.477142959833145, -12.868062595526382, -12.790571602682277, -12.832365969816848, 3.1204544554153983, 2.827378044525773, 3.211770335833222, 8.166272707283497, 7.8367127031087875, 7.2658063769340515, -98.08721283078194, -107.99520881474018, -97.17186735570431, 7.177755857507378, 7.398686880866677, 7.391395072142274, -10.990518278752774, -11.644694929321616, -11.620317076643317, 3.592859084407479, 4.54030121366182, 4.308464216689259, 1.4275522828102112, 1.5219787061214447, 1.8045547902584076, 0.3620249281326835, 0.9420459220806663, 1.0729981089631622, 8.585427939891815, 8.676486030220985, 8.782468676567078, 10.620003789663315, 11.149892061948776, 11.254187747836113, 6.11529306073983, 6.083713402350739, 5.234498312075928, 12.315647254387528, 12.848025063673646, 11.88353161017099, 6.083394835392625, 6.371249506870896, 6.434986206392438, 2.2456901992360656, 2.3628753523031776, 1.8033814529577796, 4.508117010196045, 4.684769009550408, 4.282192160685852, -3.659870450695365, -4.44660094877085, -3.910201763113349, 3.4514768769343647, 3.1681941424806865, 3.3112608989079746, 5.335405459006623, 4.628653590877846, 4.961365004380539, 7.182144602139786, 7.718993127656475, 7.383200605710343, 5.731754583617047, 5.593978521724537, 4.636874814828232, 12.28394343952337, 11.967523987094552, 11.529407272736222, 6.395122930407524, 6.59927174448967, 6.935505550354719, 7.523909669369459, 7.211991615593433, 7.106382951140404, 11.877131715416908, 11.948873803019524, 11.930856809020042, 9.187610050042466, 9.61013139535983, 8.648446028431252, 15.941758058965206, 16.053242102265358, 15.314581483602524, 7.784455331663281, 7.70326981941858, 7.963049026827008, -10.048228087524578, -10.48079400757949, -10.643574441472694, 5.033891675372914, 3.8866874476273807, 4.840558012326554, -1.3171724056204255, -1.5549019922812874, -1.314751786490291, 4.909836428860814, 4.560714180270821, 4.5505992720524375, 9.304971292614937, 9.014493271708488, 9.116276174783707, 14.226340776309371, 13.833709754049778, 13.239330261945724, 8.798125698027434, 7.88957080245018, 8.372761517763138, 9.845080725848675, 10.16360705345869, 9.535712391138077, -0.6509393701950756, -0.8975731829802243, -1.0697474579016415, 1.3051686187585148, 1.6350110371907505, 1.3691228379805835, -6.311805481712028, -7.0753593097130505, -6.766370395819351, -1.4895741889874188, -1.5488253037134854, -1.2374339314798561, 14.173190509279564, 14.504050416251019, 14.196103130777672, 8.583915323019028, 8.762119241058826, 8.787651374936104, 11.564053073525429, 11.801434624940157, 11.94168004207313, -6.207385015984386, -6.342497532566398, -6.3822028314073975, 17.198424359162644, 17.661012449612215, 17.130786721905068, 10.791708307961613, 10.737849774459988, 11.003993100176245, 9.47595903774102, 9.906680119534329, 9.232180138429001, 5.808194338382833, 5.533899272481591, 5.353759246567876, 8.386979589859635, 7.691397110621125, 7.785517985622079, 8.859565346191317, 8.627888890604169, 8.763510114202887]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1428098561883043, "mean_inference_ms": 0.6598318067647899, "mean_action_processing_ms": 0.09647178295610738, "mean_env_wait_ms": 0.80509898711506, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 265000, "timesteps_this_iter": 0, "agent_timesteps_total": 795000, "timers": {"sample_time_ms": 11664.42, "sample_throughput": 428.654, "load_time_ms": 0.199, "load_throughput": 25073553.324, "learn_time_ms": 1563.983, "learn_throughput": 3196.965, "update_time_ms": 7.857}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 0.0005000000000000001, "total_loss": 6.01326060295105, "policy_loss": -0.0025313794896658416, "vf_loss": 6.0895270824432375, "vf_explained_var": -1.0, "kl": 0.004702438198735867, "entropy": 7.373514986038208, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 265000, "num_agent_steps_sampled": 795000, "num_steps_trained": 265000, "num_agent_steps_trained": 795000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1371, "training_iteration": 53, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-18-24", "timestamp": 1706228304, "time_this_iter_s": 10.65552830696106, "time_total_s": 547.7606213092804, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282542700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 547.7606213092804, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 11.006666666666666, "ram_util_percent": 52.74}}
{"episode_reward_max": 63.10753016918896, "episode_reward_min": -303.2542890012264, "episode_reward_mean": 10.61345909657101, "episode_len_mean": 495.63, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -107.99520881474018}, "policy_reward_max": {"shared_policy": 21.168302183349923}, "policy_reward_mean": {"shared_policy": 3.537819698857003}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.88873882591723, 7.985551506280871, 10.440928809344754, 18.23855268955228, -0.6232213452458666, 34.7182515002787, -13.46655591391027, 18.205159664154053, 0.1749645695090294, -22.00958906859161, -27.7282466068864, 21.479485232383013, 17.90959007292986, -2.1453540027141713, -25.839725852012663, 38.21245565637946, 11.737034473568187, 10.000201338902102, 10.759967967867823, -2.6482477337121964, 63.10753016918896, 24.856791801750646, 2.826969765126691, -9.27205261588098, 7.29045654833314, -10.53925853967668, -2.325127508491306, 13.19324728101492, 10.825953602790818, 17.83609854429959, -6.431767523288741, 9.15657515078783, 3.960928201675401, 19.75167725235221, 46.38538269884883, 13.238292552530766, 7.745339296758161, 8.10087344795464, 4.51892164349556, 16.387647703289986, -38.49100016802551, 9.159602835774393, 23.268791787326336, -303.2542890012264, 21.96783781051633, -34.25553028471771, 12.441624514758558, 4.7540857791900635, 2.377068959176512, 26.04438264667988, 33.024083599448204, 17.433504775166497, 37.047203928232165, 18.88963054865596, 6.411947004497023, 13.475078180432305, -12.016673162579565, 9.930931918323026, 14.925424054265008, 22.284338335506604, 15.962607920169816, 35.78087469935414, 19.929900225251913, 21.842284236103296, 35.756862327456474, 27.446187473833547, 47.30958164483309, 23.45077417790887, -31.172596536576762, 13.761137135326848, -4.186826184392004, 14.021149881184073, 27.435740739107132, 41.29938079230487, 25.06045801824075, 29.544400170445442, -2.6182600110769414, 4.309302493929849, -20.15353518724443, -4.27583342418076, 42.873344056308255, 26.133685939013958, 35.307167740538716, -18.93208537995818, 51.99022353067993, 32.53355118259785, 28.61481929570435, 16.6958528574323, 23.86389468610284, 26.250964350998373, 17.92140163108705, 31.125522468239055, 10.940393727272735, 26.368116185069056, 36.302303992211804, 20.897261854261146, 51.84220702946186, 8.69024131447074, 1.518074780702591, 27.582912504673004], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [3.7919353221853527, 3.755482462545231, 3.341321041186646, 2.2648898760477607, 2.742416436473519, 2.978245193759591, 3.6908411433299335, 3.342831042905644, 3.407256623109177, 6.3054705510536735, 6.238827491799981, 5.694254646698624, -0.0014018093546326327, -0.18595265348753287, -0.4358668824037011, 11.523894180854157, 12.032342010488108, 11.162015308936432, -4.928215071558952, -4.016102021560073, -4.5222388207912445, 6.103166125714779, 5.936367109417915, 6.1656264290213585, -0.46795693039894104, 0.42252450436353683, 0.2203969955444336, -7.072081911067173, -7.417881498734161, -7.519625658790275, -8.819987254838153, -9.736946413914367, -9.17131293813388, 6.780550166964531, 7.638318467885256, 7.060616597533226, 5.869856685400009, 5.827537909150124, 6.212195478379726, -0.5361426124970166, -1.147476310531303, -0.4617350796858517, -8.687723790605872, -8.327735801537841, -8.82426625986895, 12.801113344728947, 12.916230086237192, 12.495112225413322, 4.106562548627451, 3.905536030729607, 3.7249358942111286, 3.0505024691422733, 3.850932284568742, 3.098766585191086, 3.764672326544911, 2.9685814778009956, 4.026714163521916, -0.9998332560062408, -0.5819033682346344, -1.066511109471321, 21.125498337050274, 21.168302183349923, 20.813729648788765, 8.329099630316094, 8.478158441682652, 8.0495337297519, 0.8182247330745014, 1.1307542746265682, 0.8779907574256214, -2.8504116485516278, -2.877159456412002, -3.5444815109173504, 2.272910411159188, 2.3122457514206474, 2.7053003857533042, -3.324981297055885, -3.359218875567123, -3.8550583670536724, -0.4564849076171811, -1.0334565093120034, -0.8351860915621216, 4.51643493026495, 4.671129584312439, 4.0056827664375305, 3.6037880827983173, 3.5321712394555362, 3.6899942805369648, 6.4463266556461605, 5.866341908772782, 5.523429979880646, -1.8245658377806393, -2.4047718296448437, -2.202429855863258, 3.156313233077526, 2.9540115669369698, 3.0462503507733345, 1.485529092450932, 0.8574343075354847, 1.6179648016889843, 6.3196567694346015, 6.81827003757158, 6.613750445346028, 15.081919958194092, 15.430417885382965, 15.873044855271772, 4.441644012928009, 4.45157228410244, 4.345076255500317, 2.525213380654648, 2.7311698546012195, 2.488956061502293, 2.6973423709471973, 2.3106651355822834, 3.09286594142516, 1.5978142768144608, 1.3772390186786652, 1.5438683480024338, 5.497410848736763, 5.4130938947200775, 5.477142959833145, -12.868062595526382, -12.790571602682277, -12.832365969816848, 3.1204544554153983, 2.827378044525773, 3.211770335833222, 8.166272707283497, 7.8367127031087875, 7.2658063769340515, -98.08721283078194, -107.99520881474018, -97.17186735570431, 7.177755857507378, 7.398686880866677, 7.391395072142274, -10.990518278752774, -11.644694929321616, -11.620317076643317, 3.592859084407479, 4.54030121366182, 4.308464216689259, 1.4275522828102112, 1.5219787061214447, 1.8045547902584076, 0.3620249281326835, 0.9420459220806663, 1.0729981089631622, 8.585427939891815, 8.676486030220985, 8.782468676567078, 10.620003789663315, 11.149892061948776, 11.254187747836113, 6.11529306073983, 6.083713402350739, 5.234498312075928, 12.315647254387528, 12.848025063673646, 11.88353161017099, 6.083394835392625, 6.371249506870896, 6.434986206392438, 2.2456901992360656, 2.3628753523031776, 1.8033814529577796, 4.508117010196045, 4.684769009550408, 4.282192160685852, -3.659870450695365, -4.44660094877085, -3.910201763113349, 3.4514768769343647, 3.1681941424806865, 3.3112608989079746, 5.335405459006623, 4.628653590877846, 4.961365004380539, 7.182144602139786, 7.718993127656475, 7.383200605710343, 5.731754583617047, 5.593978521724537, 4.636874814828232, 12.28394343952337, 11.967523987094552, 11.529407272736222, 6.395122930407524, 6.59927174448967, 6.935505550354719, 7.523909669369459, 7.211991615593433, 7.106382951140404, 11.877131715416908, 11.948873803019524, 11.930856809020042, 9.187610050042466, 9.61013139535983, 8.648446028431252, 15.941758058965206, 16.053242102265358, 15.314581483602524, 7.784455331663281, 7.70326981941858, 7.963049026827008, -10.048228087524578, -10.48079400757949, -10.643574441472694, 5.033891675372914, 3.8866874476273807, 4.840558012326554, -1.3171724056204255, -1.5549019922812874, -1.314751786490291, 4.909836428860814, 4.560714180270821, 4.5505992720524375, 9.304971292614937, 9.014493271708488, 9.116276174783707, 14.226340776309371, 13.833709754049778, 13.239330261945724, 8.798125698027434, 7.88957080245018, 8.372761517763138, 9.845080725848675, 10.16360705345869, 9.535712391138077, -0.6509393701950756, -0.8975731829802243, -1.0697474579016415, 1.3051686187585148, 1.6350110371907505, 1.3691228379805835, -6.311805481712028, -7.0753593097130505, -6.766370395819351, -1.4895741889874188, -1.5488253037134854, -1.2374339314798561, 14.173190509279564, 14.504050416251019, 14.196103130777672, 8.583915323019028, 8.762119241058826, 8.787651374936104, 11.564053073525429, 11.801434624940157, 11.94168004207313, -6.207385015984386, -6.342497532566398, -6.3822028314073975, 17.198424359162644, 17.661012449612215, 17.130786721905068, 10.791708307961613, 10.737849774459988, 11.003993100176245, 9.47595903774102, 9.906680119534329, 9.232180138429001, 5.808194338382833, 5.533899272481591, 5.353759246567876, 8.386979589859635, 7.691397110621125, 7.785517985622079, 8.859565346191317, 8.627888890604169, 8.763510114202887, 5.306703602274254, 6.480020978798464, 6.134677050014332, 10.630083130051688, 10.331967500348881, 10.163471837838486, 3.584138867755726, 3.8088871029516014, 3.547367756565407, 8.594963813821465, 8.78625430415073, 8.98689806709686, 12.045703214903668, 12.129388583203152, 12.127212194104985, 6.955270444353417, 7.331997783233717, 6.609993626674012, 17.214593172073364, 17.25089605152607, 17.376717805862427, 2.8578487286964958, 2.7989866087833946, 3.0334059769908492, 0.6833643168210983, 0.628465011715889, 0.20624545216560364, 9.357666790485382, 9.590281814336777, 8.634963899850845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14287814851250522, "mean_inference_ms": 0.6608402577696135, "mean_action_processing_ms": 0.09662466002359066, "mean_env_wait_ms": 0.8066483983782298, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 270000, "timesteps_this_iter": 0, "agent_timesteps_total": 810000, "timers": {"sample_time_ms": 11712.416, "sample_throughput": 426.897, "load_time_ms": 0.199, "load_throughput": 25073553.324, "learn_time_ms": 1556.979, "learn_throughput": 3211.347, "update_time_ms": 8.191}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 0.0005000000000000001, "total_loss": 5.589221572875976, "policy_loss": -0.002682015092950296, "vf_loss": 5.666862440109253, "vf_explained_var": -1.0, "kl": 0.004079098824885515, "entropy": 7.495892715454102, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 270000, "num_agent_steps_sampled": 810000, "num_steps_trained": 270000, "num_agent_steps_trained": 810000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1381, "training_iteration": 54, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-18-35", "timestamp": 1706228315, "time_this_iter_s": 10.901306629180908, "time_total_s": 558.6619279384613, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282542430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 558.6619279384613, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 10.70625, "ram_util_percent": 52.8125}}
{"episode_reward_max": 63.10753016918896, "episode_reward_min": -303.2542890012264, "episode_reward_mean": 12.929643171747728, "episode_len_mean": 495.63, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -107.99520881474018}, "policy_reward_max": {"shared_policy": 21.168302183349923}, "policy_reward_mean": {"shared_policy": 4.309881057249242}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.7282466068864, 21.479485232383013, 17.90959007292986, -2.1453540027141713, -25.839725852012663, 38.21245565637946, 11.737034473568187, 10.000201338902102, 10.759967967867823, -2.6482477337121964, 63.10753016918896, 24.856791801750646, 2.826969765126691, -9.27205261588098, 7.29045654833314, -10.53925853967668, -2.325127508491306, 13.19324728101492, 10.825953602790818, 17.83609854429959, -6.431767523288741, 9.15657515078783, 3.960928201675401, 19.75167725235221, 46.38538269884883, 13.238292552530766, 7.745339296758161, 8.10087344795464, 4.51892164349556, 16.387647703289986, -38.49100016802551, 9.159602835774393, 23.268791787326336, -303.2542890012264, 21.96783781051633, -34.25553028471771, 12.441624514758558, 4.7540857791900635, 2.377068959176512, 26.04438264667988, 33.024083599448204, 17.433504775166497, 37.047203928232165, 18.88963054865596, 6.411947004497023, 13.475078180432305, -12.016673162579565, 9.930931918323026, 14.925424054265008, 22.284338335506604, 15.962607920169816, 35.78087469935414, 19.929900225251913, 21.842284236103296, 35.756862327456474, 27.446187473833547, 47.30958164483309, 23.45077417790887, -31.172596536576762, 13.761137135326848, -4.186826184392004, 14.021149881184073, 27.435740739107132, 41.29938079230487, 25.06045801824075, 29.544400170445442, -2.6182600110769414, 4.309302493929849, -20.15353518724443, -4.27583342418076, 42.873344056308255, 26.133685939013958, 35.307167740538716, -18.93208537995818, 51.99022353067993, 32.53355118259785, 28.61481929570435, 16.6958528574323, 23.86389468610284, 26.250964350998373, 17.92140163108705, 31.125522468239055, 10.940393727272735, 26.368116185069056, 36.302303992211804, 20.897261854261146, 51.84220702946186, 8.69024131447074, 1.518074780702591, 27.582912504673004, 38.807135973125696, 14.202502265572548, 32.121771536767454, 32.840878903865786, 28.503894340246887, 34.67925716564058, 32.41067020595072, 19.91974932700394, 38.82680389471352, 23.85852514207363], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-8.819987254838153, -9.736946413914367, -9.17131293813388, 6.780550166964531, 7.638318467885256, 7.060616597533226, 5.869856685400009, 5.827537909150124, 6.212195478379726, -0.5361426124970166, -1.147476310531303, -0.4617350796858517, -8.687723790605872, -8.327735801537841, -8.82426625986895, 12.801113344728947, 12.916230086237192, 12.495112225413322, 4.106562548627451, 3.905536030729607, 3.7249358942111286, 3.0505024691422733, 3.850932284568742, 3.098766585191086, 3.764672326544911, 2.9685814778009956, 4.026714163521916, -0.9998332560062408, -0.5819033682346344, -1.066511109471321, 21.125498337050274, 21.168302183349923, 20.813729648788765, 8.329099630316094, 8.478158441682652, 8.0495337297519, 0.8182247330745014, 1.1307542746265682, 0.8779907574256214, -2.8504116485516278, -2.877159456412002, -3.5444815109173504, 2.272910411159188, 2.3122457514206474, 2.7053003857533042, -3.324981297055885, -3.359218875567123, -3.8550583670536724, -0.4564849076171811, -1.0334565093120034, -0.8351860915621216, 4.51643493026495, 4.671129584312439, 4.0056827664375305, 3.6037880827983173, 3.5321712394555362, 3.6899942805369648, 6.4463266556461605, 5.866341908772782, 5.523429979880646, -1.8245658377806393, -2.4047718296448437, -2.202429855863258, 3.156313233077526, 2.9540115669369698, 3.0462503507733345, 1.485529092450932, 0.8574343075354847, 1.6179648016889843, 6.3196567694346015, 6.81827003757158, 6.613750445346028, 15.081919958194092, 15.430417885382965, 15.873044855271772, 4.441644012928009, 4.45157228410244, 4.345076255500317, 2.525213380654648, 2.7311698546012195, 2.488956061502293, 2.6973423709471973, 2.3106651355822834, 3.09286594142516, 1.5978142768144608, 1.3772390186786652, 1.5438683480024338, 5.497410848736763, 5.4130938947200775, 5.477142959833145, -12.868062595526382, -12.790571602682277, -12.832365969816848, 3.1204544554153983, 2.827378044525773, 3.211770335833222, 8.166272707283497, 7.8367127031087875, 7.2658063769340515, -98.08721283078194, -107.99520881474018, -97.17186735570431, 7.177755857507378, 7.398686880866677, 7.391395072142274, -10.990518278752774, -11.644694929321616, -11.620317076643317, 3.592859084407479, 4.54030121366182, 4.308464216689259, 1.4275522828102112, 1.5219787061214447, 1.8045547902584076, 0.3620249281326835, 0.9420459220806663, 1.0729981089631622, 8.585427939891815, 8.676486030220985, 8.782468676567078, 10.620003789663315, 11.149892061948776, 11.254187747836113, 6.11529306073983, 6.083713402350739, 5.234498312075928, 12.315647254387528, 12.848025063673646, 11.88353161017099, 6.083394835392625, 6.371249506870896, 6.434986206392438, 2.2456901992360656, 2.3628753523031776, 1.8033814529577796, 4.508117010196045, 4.684769009550408, 4.282192160685852, -3.659870450695365, -4.44660094877085, -3.910201763113349, 3.4514768769343647, 3.1681941424806865, 3.3112608989079746, 5.335405459006623, 4.628653590877846, 4.961365004380539, 7.182144602139786, 7.718993127656475, 7.383200605710343, 5.731754583617047, 5.593978521724537, 4.636874814828232, 12.28394343952337, 11.967523987094552, 11.529407272736222, 6.395122930407524, 6.59927174448967, 6.935505550354719, 7.523909669369459, 7.211991615593433, 7.106382951140404, 11.877131715416908, 11.948873803019524, 11.930856809020042, 9.187610050042466, 9.61013139535983, 8.648446028431252, 15.941758058965206, 16.053242102265358, 15.314581483602524, 7.784455331663281, 7.70326981941858, 7.963049026827008, -10.048228087524578, -10.48079400757949, -10.643574441472694, 5.033891675372914, 3.8866874476273807, 4.840558012326554, -1.3171724056204255, -1.5549019922812874, -1.314751786490291, 4.909836428860814, 4.560714180270821, 4.5505992720524375, 9.304971292614937, 9.014493271708488, 9.116276174783707, 14.226340776309371, 13.833709754049778, 13.239330261945724, 8.798125698027434, 7.88957080245018, 8.372761517763138, 9.845080725848675, 10.16360705345869, 9.535712391138077, -0.6509393701950756, -0.8975731829802243, -1.0697474579016415, 1.3051686187585148, 1.6350110371907505, 1.3691228379805835, -6.311805481712028, -7.0753593097130505, -6.766370395819351, -1.4895741889874188, -1.5488253037134854, -1.2374339314798561, 14.173190509279564, 14.504050416251019, 14.196103130777672, 8.583915323019028, 8.762119241058826, 8.787651374936104, 11.564053073525429, 11.801434624940157, 11.94168004207313, -6.207385015984386, -6.342497532566398, -6.3822028314073975, 17.198424359162644, 17.661012449612215, 17.130786721905068, 10.791708307961613, 10.737849774459988, 11.003993100176245, 9.47595903774102, 9.906680119534329, 9.232180138429001, 5.808194338382833, 5.533899272481591, 5.353759246567876, 8.386979589859635, 7.691397110621125, 7.785517985622079, 8.859565346191317, 8.627888890604169, 8.763510114202887, 5.306703602274254, 6.480020978798464, 6.134677050014332, 10.630083130051688, 10.331967500348881, 10.163471837838486, 3.584138867755726, 3.8088871029516014, 3.547367756565407, 8.594963813821465, 8.78625430415073, 8.98689806709686, 12.045703214903668, 12.129388583203152, 12.127212194104985, 6.955270444353417, 7.331997783233717, 6.609993626674012, 17.214593172073364, 17.25089605152607, 17.376717805862427, 2.8578487286964958, 2.7989866087833946, 3.0334059769908492, 0.6833643168210983, 0.628465011715889, 0.20624545216560364, 9.357666790485382, 9.590281814336777, 8.634963899850845, 13.147745121270418, 12.713518410921097, 12.945872440934181, 5.031115725636482, 4.501075834035873, 4.670310705900192, 11.231634231905133, 10.311388472716004, 10.578748832146317, 10.620662103096635, 11.152433956662804, 11.067782844106347, 9.411944697300584, 9.648272475848586, 9.443677167097718, 11.663668175538376, 11.777134725203112, 11.23845426489909, 10.834741165240601, 10.95777453978856, 10.618154500921563, 6.594723393519715, 6.6609784265359195, 6.664047506948307, 13.269226046279073, 12.47536812722683, 13.082209721207619, 7.8533164113759995, 7.998236387968063, 8.006972342729568]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1429710293893963, "mean_inference_ms": 0.6618268579786792, "mean_action_processing_ms": 0.09679188078192862, "mean_env_wait_ms": 0.8081097481972903, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 275000, "timesteps_this_iter": 0, "agent_timesteps_total": 825000, "timers": {"sample_time_ms": 11743.367, "sample_throughput": 425.772, "load_time_ms": 0.199, "load_throughput": 25073553.324, "learn_time_ms": 1571.191, "learn_throughput": 3182.298, "update_time_ms": 8.242}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0005000000000000001, "total_loss": 4.542921018600464, "policy_loss": -0.0028703113288866986, "vf_loss": 4.621544885635376, "vf_explained_var": -0.9634036064147949, "kl": 0.003208389002256702, "entropy": 7.5753336429595945, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 275000, "num_agent_steps_sampled": 825000, "num_steps_trained": 275000, "num_agent_steps_trained": 825000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1391, "training_iteration": 55, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-18-46", "timestamp": 1706228326, "time_this_iter_s": 11.089911937713623, "time_total_s": 569.7518398761749, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202825D1040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 569.7518398761749, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 11.959999999999999, "ram_util_percent": 52.94000000000001}}
{"episode_reward_max": 63.10753016918896, "episode_reward_min": -303.2542890012264, "episode_reward_mean": 14.193835147597406, "episode_len_mean": 495.63, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -107.99520881474018}, "policy_reward_max": {"shared_policy": 21.168302183349923}, "policy_reward_mean": {"shared_policy": 4.731278382532469}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.10753016918896, 24.856791801750646, 2.826969765126691, -9.27205261588098, 7.29045654833314, -10.53925853967668, -2.325127508491306, 13.19324728101492, 10.825953602790818, 17.83609854429959, -6.431767523288741, 9.15657515078783, 3.960928201675401, 19.75167725235221, 46.38538269884883, 13.238292552530766, 7.745339296758161, 8.10087344795464, 4.51892164349556, 16.387647703289986, -38.49100016802551, 9.159602835774393, 23.268791787326336, -303.2542890012264, 21.96783781051633, -34.25553028471771, 12.441624514758558, 4.7540857791900635, 2.377068959176512, 26.04438264667988, 33.024083599448204, 17.433504775166497, 37.047203928232165, 18.88963054865596, 6.411947004497023, 13.475078180432305, -12.016673162579565, 9.930931918323026, 14.925424054265008, 22.284338335506604, 15.962607920169816, 35.78087469935414, 19.929900225251913, 21.842284236103296, 35.756862327456474, 27.446187473833547, 47.30958164483309, 23.45077417790887, -31.172596536576762, 13.761137135326848, -4.186826184392004, 14.021149881184073, 27.435740739107132, 41.29938079230487, 25.06045801824075, 29.544400170445442, -2.6182600110769414, 4.309302493929849, -20.15353518724443, -4.27583342418076, 42.873344056308255, 26.133685939013958, 35.307167740538716, -18.93208537995818, 51.99022353067993, 32.53355118259785, 28.61481929570435, 16.6958528574323, 23.86389468610284, 26.250964350998373, 17.92140163108705, 31.125522468239055, 10.940393727272735, 26.368116185069056, 36.302303992211804, 20.897261854261146, 51.84220702946186, 8.69024131447074, 1.518074780702591, 27.582912504673004, 38.807135973125696, 14.202502265572548, 32.121771536767454, 32.840878903865786, 28.503894340246887, 34.67925716564058, 32.41067020595072, 19.91974932700394, 38.82680389471352, 23.85852514207363, 20.36537211388348, 17.479072326794252, 43.41685963422057, -8.893877618014827, 8.079360336065278, 26.894051589071736, 34.040388257708386, 22.45682469755411, -10.698379740119009, 25.01668653450905], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [21.125498337050274, 21.168302183349923, 20.813729648788765, 8.329099630316094, 8.478158441682652, 8.0495337297519, 0.8182247330745014, 1.1307542746265682, 0.8779907574256214, -2.8504116485516278, -2.877159456412002, -3.5444815109173504, 2.272910411159188, 2.3122457514206474, 2.7053003857533042, -3.324981297055885, -3.359218875567123, -3.8550583670536724, -0.4564849076171811, -1.0334565093120034, -0.8351860915621216, 4.51643493026495, 4.671129584312439, 4.0056827664375305, 3.6037880827983173, 3.5321712394555362, 3.6899942805369648, 6.4463266556461605, 5.866341908772782, 5.523429979880646, -1.8245658377806393, -2.4047718296448437, -2.202429855863258, 3.156313233077526, 2.9540115669369698, 3.0462503507733345, 1.485529092450932, 0.8574343075354847, 1.6179648016889843, 6.3196567694346015, 6.81827003757158, 6.613750445346028, 15.081919958194092, 15.430417885382965, 15.873044855271772, 4.441644012928009, 4.45157228410244, 4.345076255500317, 2.525213380654648, 2.7311698546012195, 2.488956061502293, 2.6973423709471973, 2.3106651355822834, 3.09286594142516, 1.5978142768144608, 1.3772390186786652, 1.5438683480024338, 5.497410848736763, 5.4130938947200775, 5.477142959833145, -12.868062595526382, -12.790571602682277, -12.832365969816848, 3.1204544554153983, 2.827378044525773, 3.211770335833222, 8.166272707283497, 7.8367127031087875, 7.2658063769340515, -98.08721283078194, -107.99520881474018, -97.17186735570431, 7.177755857507378, 7.398686880866677, 7.391395072142274, -10.990518278752774, -11.644694929321616, -11.620317076643317, 3.592859084407479, 4.54030121366182, 4.308464216689259, 1.4275522828102112, 1.5219787061214447, 1.8045547902584076, 0.3620249281326835, 0.9420459220806663, 1.0729981089631622, 8.585427939891815, 8.676486030220985, 8.782468676567078, 10.620003789663315, 11.149892061948776, 11.254187747836113, 6.11529306073983, 6.083713402350739, 5.234498312075928, 12.315647254387528, 12.848025063673646, 11.88353161017099, 6.083394835392625, 6.371249506870896, 6.434986206392438, 2.2456901992360656, 2.3628753523031776, 1.8033814529577796, 4.508117010196045, 4.684769009550408, 4.282192160685852, -3.659870450695365, -4.44660094877085, -3.910201763113349, 3.4514768769343647, 3.1681941424806865, 3.3112608989079746, 5.335405459006623, 4.628653590877846, 4.961365004380539, 7.182144602139786, 7.718993127656475, 7.383200605710343, 5.731754583617047, 5.593978521724537, 4.636874814828232, 12.28394343952337, 11.967523987094552, 11.529407272736222, 6.395122930407524, 6.59927174448967, 6.935505550354719, 7.523909669369459, 7.211991615593433, 7.106382951140404, 11.877131715416908, 11.948873803019524, 11.930856809020042, 9.187610050042466, 9.61013139535983, 8.648446028431252, 15.941758058965206, 16.053242102265358, 15.314581483602524, 7.784455331663281, 7.70326981941858, 7.963049026827008, -10.048228087524578, -10.48079400757949, -10.643574441472694, 5.033891675372914, 3.8866874476273807, 4.840558012326554, -1.3171724056204255, -1.5549019922812874, -1.314751786490291, 4.909836428860814, 4.560714180270821, 4.5505992720524375, 9.304971292614937, 9.014493271708488, 9.116276174783707, 14.226340776309371, 13.833709754049778, 13.239330261945724, 8.798125698027434, 7.88957080245018, 8.372761517763138, 9.845080725848675, 10.16360705345869, 9.535712391138077, -0.6509393701950756, -0.8975731829802243, -1.0697474579016415, 1.3051686187585148, 1.6350110371907505, 1.3691228379805835, -6.311805481712028, -7.0753593097130505, -6.766370395819351, -1.4895741889874188, -1.5488253037134854, -1.2374339314798561, 14.173190509279564, 14.504050416251019, 14.196103130777672, 8.583915323019028, 8.762119241058826, 8.787651374936104, 11.564053073525429, 11.801434624940157, 11.94168004207313, -6.207385015984386, -6.342497532566398, -6.3822028314073975, 17.198424359162644, 17.661012449612215, 17.130786721905068, 10.791708307961613, 10.737849774459988, 11.003993100176245, 9.47595903774102, 9.906680119534329, 9.232180138429001, 5.808194338382833, 5.533899272481591, 5.353759246567876, 8.386979589859635, 7.691397110621125, 7.785517985622079, 8.859565346191317, 8.627888890604169, 8.763510114202887, 5.306703602274254, 6.480020978798464, 6.134677050014332, 10.630083130051688, 10.331967500348881, 10.163471837838486, 3.584138867755726, 3.8088871029516014, 3.547367756565407, 8.594963813821465, 8.78625430415073, 8.98689806709686, 12.045703214903668, 12.129388583203152, 12.127212194104985, 6.955270444353417, 7.331997783233717, 6.609993626674012, 17.214593172073364, 17.25089605152607, 17.376717805862427, 2.8578487286964958, 2.7989866087833946, 3.0334059769908492, 0.6833643168210983, 0.628465011715889, 0.20624545216560364, 9.357666790485382, 9.590281814336777, 8.634963899850845, 13.147745121270418, 12.713518410921097, 12.945872440934181, 5.031115725636482, 4.501075834035873, 4.670310705900192, 11.231634231905133, 10.311388472716004, 10.578748832146317, 10.620662103096635, 11.152433956662804, 11.067782844106347, 9.411944697300584, 9.648272475848586, 9.443677167097718, 11.663668175538376, 11.777134725203112, 11.23845426489909, 10.834741165240601, 10.95777453978856, 10.618154500921563, 6.594723393519715, 6.6609784265359195, 6.664047506948307, 13.269226046279073, 12.47536812722683, 13.082209721207619, 7.8533164113759995, 7.998236387968063, 8.006972342729568, 6.779604082306221, 7.024398533006504, 6.561369498570755, 6.054658710335687, 5.61435993512471, 5.810053681333855, 14.422188977400452, 14.73106229553619, 14.263608361283929, -3.229052479068443, -2.8678295562664715, -2.796995582679912, 3.0676530500252994, 2.7188811649878772, 2.2928261210521015, 9.469969374438122, 8.926601474483803, 8.497480740149811, 11.37083889295657, 11.696746154533074, 10.972803210218743, 7.549418419599533, 7.218737885355949, 7.688668392598629, -3.932990064223617, -3.1024012019236977, -3.6629884739716942, 8.36434957881768, 8.783981616919235, 7.868355338772133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1430756448466442, "mean_inference_ms": 0.6628677328943556, "mean_action_processing_ms": 0.09696440071708931, "mean_env_wait_ms": 0.8096400298190448, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 280000, "timesteps_this_iter": 0, "agent_timesteps_total": 840000, "timers": {"sample_time_ms": 11822.185, "sample_throughput": 422.934, "load_time_ms": 0.199, "load_throughput": 25073553.324, "learn_time_ms": 1581.733, "learn_throughput": 3161.09, "update_time_ms": 8.442}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 0.0005000000000000001, "total_loss": 4.247807931900025, "policy_loss": -0.0024027003870857656, "vf_loss": 4.326239013671875, "vf_explained_var": -0.8798434376716614, "kl": 0.003605961252478559, "entropy": 7.602835083007813, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 280000, "num_agent_steps_sampled": 840000, "num_steps_trained": 280000, "num_agent_steps_trained": 840000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1401, "training_iteration": 56, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-18-57", "timestamp": 1706228337, "time_this_iter_s": 11.553270816802979, "time_total_s": 581.3051106929779, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824BA670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 581.3051106929779, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 10.925, "ram_util_percent": 53.206250000000004}}
{"episode_reward_max": 51.99022353067993, "episode_reward_min": -303.2542890012264, "episode_reward_mean": 15.333163220566043, "episode_len_mean": 495.63, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -107.99520881474018}, "policy_reward_max": {"shared_policy": 17.661012449612215}, "policy_reward_mean": {"shared_policy": 5.111054406855347}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.431767523288741, 9.15657515078783, 3.960928201675401, 19.75167725235221, 46.38538269884883, 13.238292552530766, 7.745339296758161, 8.10087344795464, 4.51892164349556, 16.387647703289986, -38.49100016802551, 9.159602835774393, 23.268791787326336, -303.2542890012264, 21.96783781051633, -34.25553028471771, 12.441624514758558, 4.7540857791900635, 2.377068959176512, 26.04438264667988, 33.024083599448204, 17.433504775166497, 37.047203928232165, 18.88963054865596, 6.411947004497023, 13.475078180432305, -12.016673162579565, 9.930931918323026, 14.925424054265008, 22.284338335506604, 15.962607920169816, 35.78087469935414, 19.929900225251913, 21.842284236103296, 35.756862327456474, 27.446187473833547, 47.30958164483309, 23.45077417790887, -31.172596536576762, 13.761137135326848, -4.186826184392004, 14.021149881184073, 27.435740739107132, 41.29938079230487, 25.06045801824075, 29.544400170445442, -2.6182600110769414, 4.309302493929849, -20.15353518724443, -4.27583342418076, 42.873344056308255, 26.133685939013958, 35.307167740538716, -18.93208537995818, 51.99022353067993, 32.53355118259785, 28.61481929570435, 16.6958528574323, 23.86389468610284, 26.250964350998373, 17.92140163108705, 31.125522468239055, 10.940393727272735, 26.368116185069056, 36.302303992211804, 20.897261854261146, 51.84220702946186, 8.69024131447074, 1.518074780702591, 27.582912504673004, 38.807135973125696, 14.202502265572548, 32.121771536767454, 32.840878903865786, 28.503894340246887, 34.67925716564058, 32.41067020595072, 19.91974932700394, 38.82680389471352, 23.85852514207363, 20.36537211388348, 17.479072326794252, 43.41685963422057, -8.893877618014827, 8.079360336065278, 26.894051589071736, 34.040388257708386, 22.45682469755411, -10.698379740119009, 25.01668653450905, -11.341099448502064, 44.83501065149902, 15.074677959084497, 13.716256689280257, 42.73975155956575, -5.584347814321532, 33.61507345736025, 36.23526278836651, 15.698839008808136, 46.74399149417874], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-1.8245658377806393, -2.4047718296448437, -2.202429855863258, 3.156313233077526, 2.9540115669369698, 3.0462503507733345, 1.485529092450932, 0.8574343075354847, 1.6179648016889843, 6.3196567694346015, 6.81827003757158, 6.613750445346028, 15.081919958194092, 15.430417885382965, 15.873044855271772, 4.441644012928009, 4.45157228410244, 4.345076255500317, 2.525213380654648, 2.7311698546012195, 2.488956061502293, 2.6973423709471973, 2.3106651355822834, 3.09286594142516, 1.5978142768144608, 1.3772390186786652, 1.5438683480024338, 5.497410848736763, 5.4130938947200775, 5.477142959833145, -12.868062595526382, -12.790571602682277, -12.832365969816848, 3.1204544554153983, 2.827378044525773, 3.211770335833222, 8.166272707283497, 7.8367127031087875, 7.2658063769340515, -98.08721283078194, -107.99520881474018, -97.17186735570431, 7.177755857507378, 7.398686880866677, 7.391395072142274, -10.990518278752774, -11.644694929321616, -11.620317076643317, 3.592859084407479, 4.54030121366182, 4.308464216689259, 1.4275522828102112, 1.5219787061214447, 1.8045547902584076, 0.3620249281326835, 0.9420459220806663, 1.0729981089631622, 8.585427939891815, 8.676486030220985, 8.782468676567078, 10.620003789663315, 11.149892061948776, 11.254187747836113, 6.11529306073983, 6.083713402350739, 5.234498312075928, 12.315647254387528, 12.848025063673646, 11.88353161017099, 6.083394835392625, 6.371249506870896, 6.434986206392438, 2.2456901992360656, 2.3628753523031776, 1.8033814529577796, 4.508117010196045, 4.684769009550408, 4.282192160685852, -3.659870450695365, -4.44660094877085, -3.910201763113349, 3.4514768769343647, 3.1681941424806865, 3.3112608989079746, 5.335405459006623, 4.628653590877846, 4.961365004380539, 7.182144602139786, 7.718993127656475, 7.383200605710343, 5.731754583617047, 5.593978521724537, 4.636874814828232, 12.28394343952337, 11.967523987094552, 11.529407272736222, 6.395122930407524, 6.59927174448967, 6.935505550354719, 7.523909669369459, 7.211991615593433, 7.106382951140404, 11.877131715416908, 11.948873803019524, 11.930856809020042, 9.187610050042466, 9.61013139535983, 8.648446028431252, 15.941758058965206, 16.053242102265358, 15.314581483602524, 7.784455331663281, 7.70326981941858, 7.963049026827008, -10.048228087524578, -10.48079400757949, -10.643574441472694, 5.033891675372914, 3.8866874476273807, 4.840558012326554, -1.3171724056204255, -1.5549019922812874, -1.314751786490291, 4.909836428860814, 4.560714180270821, 4.5505992720524375, 9.304971292614937, 9.014493271708488, 9.116276174783707, 14.226340776309371, 13.833709754049778, 13.239330261945724, 8.798125698027434, 7.88957080245018, 8.372761517763138, 9.845080725848675, 10.16360705345869, 9.535712391138077, -0.6509393701950756, -0.8975731829802243, -1.0697474579016415, 1.3051686187585148, 1.6350110371907505, 1.3691228379805835, -6.311805481712028, -7.0753593097130505, -6.766370395819351, -1.4895741889874188, -1.5488253037134854, -1.2374339314798561, 14.173190509279564, 14.504050416251019, 14.196103130777672, 8.583915323019028, 8.762119241058826, 8.787651374936104, 11.564053073525429, 11.801434624940157, 11.94168004207313, -6.207385015984386, -6.342497532566398, -6.3822028314073975, 17.198424359162644, 17.661012449612215, 17.130786721905068, 10.791708307961613, 10.737849774459988, 11.003993100176245, 9.47595903774102, 9.906680119534329, 9.232180138429001, 5.808194338382833, 5.533899272481591, 5.353759246567876, 8.386979589859635, 7.691397110621125, 7.785517985622079, 8.859565346191317, 8.627888890604169, 8.763510114202887, 5.306703602274254, 6.480020978798464, 6.134677050014332, 10.630083130051688, 10.331967500348881, 10.163471837838486, 3.584138867755726, 3.8088871029516014, 3.547367756565407, 8.594963813821465, 8.78625430415073, 8.98689806709686, 12.045703214903668, 12.129388583203152, 12.127212194104985, 6.955270444353417, 7.331997783233717, 6.609993626674012, 17.214593172073364, 17.25089605152607, 17.376717805862427, 2.8578487286964958, 2.7989866087833946, 3.0334059769908492, 0.6833643168210983, 0.628465011715889, 0.20624545216560364, 9.357666790485382, 9.590281814336777, 8.634963899850845, 13.147745121270418, 12.713518410921097, 12.945872440934181, 5.031115725636482, 4.501075834035873, 4.670310705900192, 11.231634231905133, 10.311388472716004, 10.578748832146317, 10.620662103096635, 11.152433956662804, 11.067782844106347, 9.411944697300584, 9.648272475848586, 9.443677167097718, 11.663668175538376, 11.777134725203112, 11.23845426489909, 10.834741165240601, 10.95777453978856, 10.618154500921563, 6.594723393519715, 6.6609784265359195, 6.664047506948307, 13.269226046279073, 12.47536812722683, 13.082209721207619, 7.8533164113759995, 7.998236387968063, 8.006972342729568, 6.779604082306221, 7.024398533006504, 6.561369498570755, 6.054658710335687, 5.61435993512471, 5.810053681333855, 14.422188977400452, 14.73106229553619, 14.263608361283929, -3.229052479068443, -2.8678295562664715, -2.796995582679912, 3.0676530500252994, 2.7188811649878772, 2.2928261210521015, 9.469969374438122, 8.926601474483803, 8.497480740149811, 11.37083889295657, 11.696746154533074, 10.972803210218743, 7.549418419599533, 7.218737885355949, 7.688668392598629, -3.932990064223617, -3.1024012019236977, -3.6629884739716942, 8.36434957881768, 8.783981616919235, 7.868355338772133, -3.5774995908141136, -3.7988802194595337, -3.9647196382284164, 14.795180191596344, 14.930141386886433, 15.109689073016241, 4.920988296469048, 4.961504218478993, 5.192185444136456, 4.695681059112147, 4.567601275940731, 4.452974354227379, 14.302796783546597, 14.685988708903693, 13.750966067115456, -1.53381508092086, -2.3023987213770596, -1.7481340120236126, 11.510188457866505, 11.289895651241139, 10.81498934825261, 11.741998453934983, 12.54964869919543, 11.9436156352361, 5.316225536167622, 5.180350229144096, 5.202263243496418, 15.652334580818803, 15.81684101621309, 15.274815897146851]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1432166766997258, "mean_inference_ms": 0.6640315847578779, "mean_action_processing_ms": 0.09715643255430127, "mean_env_wait_ms": 0.8112376395726782, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 285000, "timesteps_this_iter": 0, "agent_timesteps_total": 855000, "timers": {"sample_time_ms": 11924.274, "sample_throughput": 419.313, "load_time_ms": 0.1, "load_throughput": 50003624.225, "learn_time_ms": 1586.277, "learn_throughput": 3152.035, "update_time_ms": 8.642}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 0.0005000000000000001, "total_loss": 2.528342866897583, "policy_loss": -0.0024971590183737293, "vf_loss": 2.6074783325195314, "vf_explained_var": -0.7178266525268555, "kl": 0.0034132915912870035, "entropy": 7.66382908821106, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 285000, "num_agent_steps_sampled": 855000, "num_steps_trained": 285000, "num_agent_steps_trained": 855000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1411, "training_iteration": 57, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-19-09", "timestamp": 1706228349, "time_this_iter_s": 11.399381160736084, "time_total_s": 592.704491853714, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282542F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 592.704491853714, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 12.641176470588235, "ram_util_percent": 53.135294117647064}}
{"episode_reward_max": 51.99022353067993, "episode_reward_min": -303.2542890012264, "episode_reward_mean": 15.744894700488356, "episode_len_mean": 495.63, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -107.99520881474018}, "policy_reward_max": {"shared_policy": 17.661012449612215}, "policy_reward_mean": {"shared_policy": 5.248298233496118}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.49100016802551, 9.159602835774393, 23.268791787326336, -303.2542890012264, 21.96783781051633, -34.25553028471771, 12.441624514758558, 4.7540857791900635, 2.377068959176512, 26.04438264667988, 33.024083599448204, 17.433504775166497, 37.047203928232165, 18.88963054865596, 6.411947004497023, 13.475078180432305, -12.016673162579565, 9.930931918323026, 14.925424054265008, 22.284338335506604, 15.962607920169816, 35.78087469935414, 19.929900225251913, 21.842284236103296, 35.756862327456474, 27.446187473833547, 47.30958164483309, 23.45077417790887, -31.172596536576762, 13.761137135326848, -4.186826184392004, 14.021149881184073, 27.435740739107132, 41.29938079230487, 25.06045801824075, 29.544400170445442, -2.6182600110769414, 4.309302493929849, -20.15353518724443, -4.27583342418076, 42.873344056308255, 26.133685939013958, 35.307167740538716, -18.93208537995818, 51.99022353067993, 32.53355118259785, 28.61481929570435, 16.6958528574323, 23.86389468610284, 26.250964350998373, 17.92140163108705, 31.125522468239055, 10.940393727272735, 26.368116185069056, 36.302303992211804, 20.897261854261146, 51.84220702946186, 8.69024131447074, 1.518074780702591, 27.582912504673004, 38.807135973125696, 14.202502265572548, 32.121771536767454, 32.840878903865786, 28.503894340246887, 34.67925716564058, 32.41067020595072, 19.91974932700394, 38.82680389471352, 23.85852514207363, 20.36537211388348, 17.479072326794252, 43.41685963422057, -8.893877618014827, 8.079360336065278, 26.894051589071736, 34.040388257708386, 22.45682469755411, -10.698379740119009, 25.01668653450905, -11.341099448502064, 44.83501065149902, 15.074677959084497, 13.716256689280257, 42.73975155956575, -5.584347814321532, 33.61507345736025, 36.23526278836651, 15.698839008808136, 46.74399149417874, 25.40467221289873, 19.716950370930107, 29.901417136192293, 18.005000688135624, 3.7557140886783316, 7.531038999557481, 12.58010812848805, 19.977502536028624, 33.51294505596161, -6.398330800235286], "episode_lengths": [500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-12.868062595526382, -12.790571602682277, -12.832365969816848, 3.1204544554153983, 2.827378044525773, 3.211770335833222, 8.166272707283497, 7.8367127031087875, 7.2658063769340515, -98.08721283078194, -107.99520881474018, -97.17186735570431, 7.177755857507378, 7.398686880866677, 7.391395072142274, -10.990518278752774, -11.644694929321616, -11.620317076643317, 3.592859084407479, 4.54030121366182, 4.308464216689259, 1.4275522828102112, 1.5219787061214447, 1.8045547902584076, 0.3620249281326835, 0.9420459220806663, 1.0729981089631622, 8.585427939891815, 8.676486030220985, 8.782468676567078, 10.620003789663315, 11.149892061948776, 11.254187747836113, 6.11529306073983, 6.083713402350739, 5.234498312075928, 12.315647254387528, 12.848025063673646, 11.88353161017099, 6.083394835392625, 6.371249506870896, 6.434986206392438, 2.2456901992360656, 2.3628753523031776, 1.8033814529577796, 4.508117010196045, 4.684769009550408, 4.282192160685852, -3.659870450695365, -4.44660094877085, -3.910201763113349, 3.4514768769343647, 3.1681941424806865, 3.3112608989079746, 5.335405459006623, 4.628653590877846, 4.961365004380539, 7.182144602139786, 7.718993127656475, 7.383200605710343, 5.731754583617047, 5.593978521724537, 4.636874814828232, 12.28394343952337, 11.967523987094552, 11.529407272736222, 6.395122930407524, 6.59927174448967, 6.935505550354719, 7.523909669369459, 7.211991615593433, 7.106382951140404, 11.877131715416908, 11.948873803019524, 11.930856809020042, 9.187610050042466, 9.61013139535983, 8.648446028431252, 15.941758058965206, 16.053242102265358, 15.314581483602524, 7.784455331663281, 7.70326981941858, 7.963049026827008, -10.048228087524578, -10.48079400757949, -10.643574441472694, 5.033891675372914, 3.8866874476273807, 4.840558012326554, -1.3171724056204255, -1.5549019922812874, -1.314751786490291, 4.909836428860814, 4.560714180270821, 4.5505992720524375, 9.304971292614937, 9.014493271708488, 9.116276174783707, 14.226340776309371, 13.833709754049778, 13.239330261945724, 8.798125698027434, 7.88957080245018, 8.372761517763138, 9.845080725848675, 10.16360705345869, 9.535712391138077, -0.6509393701950756, -0.8975731829802243, -1.0697474579016415, 1.3051686187585148, 1.6350110371907505, 1.3691228379805835, -6.311805481712028, -7.0753593097130505, -6.766370395819351, -1.4895741889874188, -1.5488253037134854, -1.2374339314798561, 14.173190509279564, 14.504050416251019, 14.196103130777672, 8.583915323019028, 8.762119241058826, 8.787651374936104, 11.564053073525429, 11.801434624940157, 11.94168004207313, -6.207385015984386, -6.342497532566398, -6.3822028314073975, 17.198424359162644, 17.661012449612215, 17.130786721905068, 10.791708307961613, 10.737849774459988, 11.003993100176245, 9.47595903774102, 9.906680119534329, 9.232180138429001, 5.808194338382833, 5.533899272481591, 5.353759246567876, 8.386979589859635, 7.691397110621125, 7.785517985622079, 8.859565346191317, 8.627888890604169, 8.763510114202887, 5.306703602274254, 6.480020978798464, 6.134677050014332, 10.630083130051688, 10.331967500348881, 10.163471837838486, 3.584138867755726, 3.8088871029516014, 3.547367756565407, 8.594963813821465, 8.78625430415073, 8.98689806709686, 12.045703214903668, 12.129388583203152, 12.127212194104985, 6.955270444353417, 7.331997783233717, 6.609993626674012, 17.214593172073364, 17.25089605152607, 17.376717805862427, 2.8578487286964958, 2.7989866087833946, 3.0334059769908492, 0.6833643168210983, 0.628465011715889, 0.20624545216560364, 9.357666790485382, 9.590281814336777, 8.634963899850845, 13.147745121270418, 12.713518410921097, 12.945872440934181, 5.031115725636482, 4.501075834035873, 4.670310705900192, 11.231634231905133, 10.311388472716004, 10.578748832146317, 10.620662103096635, 11.152433956662804, 11.067782844106347, 9.411944697300584, 9.648272475848586, 9.443677167097718, 11.663668175538376, 11.777134725203112, 11.23845426489909, 10.834741165240601, 10.95777453978856, 10.618154500921563, 6.594723393519715, 6.6609784265359195, 6.664047506948307, 13.269226046279073, 12.47536812722683, 13.082209721207619, 7.8533164113759995, 7.998236387968063, 8.006972342729568, 6.779604082306221, 7.024398533006504, 6.561369498570755, 6.054658710335687, 5.61435993512471, 5.810053681333855, 14.422188977400452, 14.73106229553619, 14.263608361283929, -3.229052479068443, -2.8678295562664715, -2.796995582679912, 3.0676530500252994, 2.7188811649878772, 2.2928261210521015, 9.469969374438122, 8.926601474483803, 8.497480740149811, 11.37083889295657, 11.696746154533074, 10.972803210218743, 7.549418419599533, 7.218737885355949, 7.688668392598629, -3.932990064223617, -3.1024012019236977, -3.6629884739716942, 8.36434957881768, 8.783981616919235, 7.868355338772133, -3.5774995908141136, -3.7988802194595337, -3.9647196382284164, 14.795180191596344, 14.930141386886433, 15.109689073016241, 4.920988296469048, 4.961504218478993, 5.192185444136456, 4.695681059112147, 4.567601275940731, 4.452974354227379, 14.302796783546597, 14.685988708903693, 13.750966067115456, -1.53381508092086, -2.3023987213770596, -1.7481340120236126, 11.510188457866505, 11.289895651241139, 10.81498934825261, 11.741998453934983, 12.54964869919543, 11.9436156352361, 5.316225536167622, 5.180350229144096, 5.202263243496418, 15.652334580818803, 15.81684101621309, 15.274815897146851, 8.23155589401722, 8.875369541347027, 8.297746777534485, 6.379894937078149, 6.467494095365197, 6.869561338486761, 10.149344260493905, 10.046477968494088, 9.7055949072043, 5.996018461883068, 5.948055945336819, 6.060926280915737, 1.010092327992112, 1.5568537811438148, 1.1887679795424049, 2.7313473423321994, 2.270969485243157, 2.5287221719821247, 4.213710678120449, 4.2290468414624485, 4.137350608905152, 6.626379176974297, 6.470722019672394, 6.880401339381933, 11.310302972793579, 11.231136158108711, 10.971505925059319, -2.3471254060665814, -1.8386289055148808, -2.2125764886538235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14336329848324833, "mean_inference_ms": 0.6651815162160115, "mean_action_processing_ms": 0.09734884605421915, "mean_env_wait_ms": 0.8128388890321716, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 290000, "timesteps_this_iter": 0, "agent_timesteps_total": 870000, "timers": {"sample_time_ms": 11955.946, "sample_throughput": 418.202, "load_time_ms": 0.1, "load_throughput": 50003624.225, "learn_time_ms": 1585.769, "learn_throughput": 3153.044, "update_time_ms": 8.647}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 0.0005000000000000001, "total_loss": 5.767472553253174, "policy_loss": -0.0024692333023715205, "vf_loss": 5.846921300888061, "vf_explained_var": -0.6681270360946655, "kl": 0.0030185841722507453, "entropy": 7.69794397354126, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 290000, "num_agent_steps_sampled": 870000, "num_steps_trained": 290000, "num_agent_steps_trained": 870000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1421, "training_iteration": 58, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-19-20", "timestamp": 1706228360, "time_this_iter_s": 10.979378700256348, "time_total_s": 603.6838705539703, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202825ADDC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 603.6838705539703, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 10.42, "ram_util_percent": 53.15333333333334}}
{"episode_reward_max": 64.34444022318345, "episode_reward_min": -322.5052448287606, "episode_reward_mean": 15.704658039971534, "episode_len_mean": 493.1, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"shared_policy": -120.22615766525269}, "policy_reward_max": {"shared_policy": 21.766978901034832}, "policy_reward_mean": {"shared_policy": 5.234886013323844}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.047203928232165, 18.88963054865596, 6.411947004497023, 13.475078180432305, -12.016673162579565, 9.930931918323026, 14.925424054265008, 22.284338335506604, 15.962607920169816, 35.78087469935414, 19.929900225251913, 21.842284236103296, 35.756862327456474, 27.446187473833547, 47.30958164483309, 23.45077417790887, -31.172596536576762, 13.761137135326848, -4.186826184392004, 14.021149881184073, 27.435740739107132, 41.29938079230487, 25.06045801824075, 29.544400170445442, -2.6182600110769414, 4.309302493929849, -20.15353518724443, -4.27583342418076, 42.873344056308255, 26.133685939013958, 35.307167740538716, -18.93208537995818, 51.99022353067993, 32.53355118259785, 28.61481929570435, 16.6958528574323, 23.86389468610284, 26.250964350998373, 17.92140163108705, 31.125522468239055, 10.940393727272735, 26.368116185069056, 36.302303992211804, 20.897261854261146, 51.84220702946186, 8.69024131447074, 1.518074780702591, 27.582912504673004, 38.807135973125696, 14.202502265572548, 32.121771536767454, 32.840878903865786, 28.503894340246887, 34.67925716564058, 32.41067020595072, 19.91974932700394, 38.82680389471352, 23.85852514207363, 20.36537211388348, 17.479072326794252, 43.41685963422057, -8.893877618014827, 8.079360336065278, 26.894051589071736, 34.040388257708386, 22.45682469755411, -10.698379740119009, 25.01668653450905, -11.341099448502064, 44.83501065149902, 15.074677959084497, 13.716256689280257, 42.73975155956575, -5.584347814321532, 33.61507345736025, 36.23526278836651, 15.698839008808136, 46.74399149417874, 25.40467221289873, 19.716950370930107, 29.901417136192293, 18.005000688135624, 3.7557140886783316, 7.531038999557481, 12.58010812848805, 19.977502536028624, 33.51294505596161, -6.398330800235286, 33.60796061530709, 30.301469638943658, 26.430213417857857, 29.647727444767938, -277.61270413920283, 29.804061084985705, 45.52965035662055, 64.34444022318345, 40.991889722645254, -322.5052448287606, 39.322079582139835, 30.58495408389716], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 243, 500, 500, 500, 500, 67, 500, 500], "policy_shared_policy_reward": [12.315647254387528, 12.848025063673646, 11.88353161017099, 6.083394835392625, 6.371249506870896, 6.434986206392438, 2.2456901992360656, 2.3628753523031776, 1.8033814529577796, 4.508117010196045, 4.684769009550408, 4.282192160685852, -3.659870450695365, -4.44660094877085, -3.910201763113349, 3.4514768769343647, 3.1681941424806865, 3.3112608989079746, 5.335405459006623, 4.628653590877846, 4.961365004380539, 7.182144602139786, 7.718993127656475, 7.383200605710343, 5.731754583617047, 5.593978521724537, 4.636874814828232, 12.28394343952337, 11.967523987094552, 11.529407272736222, 6.395122930407524, 6.59927174448967, 6.935505550354719, 7.523909669369459, 7.211991615593433, 7.106382951140404, 11.877131715416908, 11.948873803019524, 11.930856809020042, 9.187610050042466, 9.61013139535983, 8.648446028431252, 15.941758058965206, 16.053242102265358, 15.314581483602524, 7.784455331663281, 7.70326981941858, 7.963049026827008, -10.048228087524578, -10.48079400757949, -10.643574441472694, 5.033891675372914, 3.8866874476273807, 4.840558012326554, -1.3171724056204255, -1.5549019922812874, -1.314751786490291, 4.909836428860814, 4.560714180270821, 4.5505992720524375, 9.304971292614937, 9.014493271708488, 9.116276174783707, 14.226340776309371, 13.833709754049778, 13.239330261945724, 8.798125698027434, 7.88957080245018, 8.372761517763138, 9.845080725848675, 10.16360705345869, 9.535712391138077, -0.6509393701950756, -0.8975731829802243, -1.0697474579016415, 1.3051686187585148, 1.6350110371907505, 1.3691228379805835, -6.311805481712028, -7.0753593097130505, -6.766370395819351, -1.4895741889874188, -1.5488253037134854, -1.2374339314798561, 14.173190509279564, 14.504050416251019, 14.196103130777672, 8.583915323019028, 8.762119241058826, 8.787651374936104, 11.564053073525429, 11.801434624940157, 11.94168004207313, -6.207385015984386, -6.342497532566398, -6.3822028314073975, 17.198424359162644, 17.661012449612215, 17.130786721905068, 10.791708307961613, 10.737849774459988, 11.003993100176245, 9.47595903774102, 9.906680119534329, 9.232180138429001, 5.808194338382833, 5.533899272481591, 5.353759246567876, 8.386979589859635, 7.691397110621125, 7.785517985622079, 8.859565346191317, 8.627888890604169, 8.763510114202887, 5.306703602274254, 6.480020978798464, 6.134677050014332, 10.630083130051688, 10.331967500348881, 10.163471837838486, 3.584138867755726, 3.8088871029516014, 3.547367756565407, 8.594963813821465, 8.78625430415073, 8.98689806709686, 12.045703214903668, 12.129388583203152, 12.127212194104985, 6.955270444353417, 7.331997783233717, 6.609993626674012, 17.214593172073364, 17.25089605152607, 17.376717805862427, 2.8578487286964958, 2.7989866087833946, 3.0334059769908492, 0.6833643168210983, 0.628465011715889, 0.20624545216560364, 9.357666790485382, 9.590281814336777, 8.634963899850845, 13.147745121270418, 12.713518410921097, 12.945872440934181, 5.031115725636482, 4.501075834035873, 4.670310705900192, 11.231634231905133, 10.311388472716004, 10.578748832146317, 10.620662103096635, 11.152433956662804, 11.067782844106347, 9.411944697300584, 9.648272475848586, 9.443677167097718, 11.663668175538376, 11.777134725203112, 11.23845426489909, 10.834741165240601, 10.95777453978856, 10.618154500921563, 6.594723393519715, 6.6609784265359195, 6.664047506948307, 13.269226046279073, 12.47536812722683, 13.082209721207619, 7.8533164113759995, 7.998236387968063, 8.006972342729568, 6.779604082306221, 7.024398533006504, 6.561369498570755, 6.054658710335687, 5.61435993512471, 5.810053681333855, 14.422188977400452, 14.73106229553619, 14.263608361283929, -3.229052479068443, -2.8678295562664715, -2.796995582679912, 3.0676530500252994, 2.7188811649878772, 2.2928261210521015, 9.469969374438122, 8.926601474483803, 8.497480740149811, 11.37083889295657, 11.696746154533074, 10.972803210218743, 7.549418419599533, 7.218737885355949, 7.688668392598629, -3.932990064223617, -3.1024012019236977, -3.6629884739716942, 8.36434957881768, 8.783981616919235, 7.868355338772133, -3.5774995908141136, -3.7988802194595337, -3.9647196382284164, 14.795180191596344, 14.930141386886433, 15.109689073016241, 4.920988296469048, 4.961504218478993, 5.192185444136456, 4.695681059112147, 4.567601275940731, 4.452974354227379, 14.302796783546597, 14.685988708903693, 13.750966067115456, -1.53381508092086, -2.3023987213770596, -1.7481340120236126, 11.510188457866505, 11.289895651241139, 10.81498934825261, 11.741998453934983, 12.54964869919543, 11.9436156352361, 5.316225536167622, 5.180350229144096, 5.202263243496418, 15.652334580818803, 15.81684101621309, 15.274815897146851, 8.23155589401722, 8.875369541347027, 8.297746777534485, 6.379894937078149, 6.467494095365197, 6.869561338486761, 10.149344260493905, 10.046477968494088, 9.7055949072043, 5.996018461883068, 5.948055945336819, 6.060926280915737, 1.010092327992112, 1.5568537811438148, 1.1887679795424049, 2.7313473423321994, 2.270969485243157, 2.5287221719821247, 4.213710678120449, 4.2290468414624485, 4.137350608905152, 6.626379176974297, 6.470722019672394, 6.880401339381933, 11.310302972793579, 11.231136158108711, 10.971505925059319, -2.3471254060665814, -1.8386289055148808, -2.2125764886538235, 10.809314906597137, 10.94578406214714, 11.852861646562815, 9.868177672227219, 10.176986133058861, 10.256305833657578, 9.205669141064078, 8.756194109717995, 8.468350167075783, 9.782703017195061, 9.895506297548607, 9.96951813002427, -89.91499571998915, -99.1290369530519, -88.56867146616182, 9.398666928211838, 9.822677383820206, 10.58271677295366, 15.174039974808693, 14.987756982445717, 15.36785339936614, 21.766978901034832, 21.49063059190908, 21.08683073023954, 13.469572241107613, 13.902628781894833, 13.619688699642808, -100.41996160894632, -101.85912555456161, -120.22615766525269, 12.803396751483277, 13.120194954176739, 13.39848787647982, 10.58844730102767, 10.150654104848698, 9.84585267802079]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14357658292855194, "mean_inference_ms": 0.6665306790043123, "mean_action_processing_ms": 0.09759415529027725, "mean_env_wait_ms": 0.814706768643065, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 295000, "timesteps_this_iter": 0, "agent_timesteps_total": 885000, "timers": {"sample_time_ms": 12088.365, "sample_throughput": 413.621, "load_time_ms": 0.2, "load_throughput": 25004793.132, "learn_time_ms": 1591.485, "learn_throughput": 3141.72, "update_time_ms": 8.847}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0005000000000000001, "total_loss": 187.66456909179686, "policy_loss": -0.0027396856985427488, "vf_loss": 187.74398193359374, "vf_explained_var": 0.018422472476959228, "kl": 0.004135560191944466, "entropy": 7.667057275772095, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 295000, "num_agent_steps_sampled": 885000, "num_steps_trained": 295000, "num_agent_steps_trained": 885000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1433, "training_iteration": 59, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-19-32", "timestamp": 1706228372, "time_this_iter_s": 12.29312515258789, "time_total_s": 615.9769957065582, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028227A040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 615.9769957065582, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 10.829411764705881, "ram_util_percent": 53.41176470588236}}
{"episode_reward_max": 64.34444022318345, "episode_reward_min": -322.5052448287606, "episode_reward_mean": 14.181271273815353, "episode_len_mean": 490.29, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -120.22615766525269}, "policy_reward_max": {"shared_policy": 21.766978901034832}, "policy_reward_mean": {"shared_policy": 4.727090424605116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.929900225251913, 21.842284236103296, 35.756862327456474, 27.446187473833547, 47.30958164483309, 23.45077417790887, -31.172596536576762, 13.761137135326848, -4.186826184392004, 14.021149881184073, 27.435740739107132, 41.29938079230487, 25.06045801824075, 29.544400170445442, -2.6182600110769414, 4.309302493929849, -20.15353518724443, -4.27583342418076, 42.873344056308255, 26.133685939013958, 35.307167740538716, -18.93208537995818, 51.99022353067993, 32.53355118259785, 28.61481929570435, 16.6958528574323, 23.86389468610284, 26.250964350998373, 17.92140163108705, 31.125522468239055, 10.940393727272735, 26.368116185069056, 36.302303992211804, 20.897261854261146, 51.84220702946186, 8.69024131447074, 1.518074780702591, 27.582912504673004, 38.807135973125696, 14.202502265572548, 32.121771536767454, 32.840878903865786, 28.503894340246887, 34.67925716564058, 32.41067020595072, 19.91974932700394, 38.82680389471352, 23.85852514207363, 20.36537211388348, 17.479072326794252, 43.41685963422057, -8.893877618014827, 8.079360336065278, 26.894051589071736, 34.040388257708386, 22.45682469755411, -10.698379740119009, 25.01668653450905, -11.341099448502064, 44.83501065149902, 15.074677959084497, 13.716256689280257, 42.73975155956575, -5.584347814321532, 33.61507345736025, 36.23526278836651, 15.698839008808136, 46.74399149417874, 25.40467221289873, 19.716950370930107, 29.901417136192293, 18.005000688135624, 3.7557140886783316, 7.531038999557481, 12.58010812848805, 19.977502536028624, 33.51294505596161, -6.398330800235286, 33.60796061530709, 30.301469638943658, 26.430213417857857, 29.647727444767938, -277.61270413920283, 29.804061084985705, 45.52965035662055, 64.34444022318345, 40.991889722645254, -322.5052448287606, 39.322079582139835, 30.58495408389716, 5.952903544530258, 37.30082766711712, 27.13883045315741, -255.8787339515984, 13.599912773817778, 24.819219077005968, 51.09720600768921, 30.357885368168326, 27.647206619381876, 48.31742925196886], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 243, 500, 500, 500, 500, 67, 500, 500, 500, 500, 500, 219, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [6.395122930407524, 6.59927174448967, 6.935505550354719, 7.523909669369459, 7.211991615593433, 7.106382951140404, 11.877131715416908, 11.948873803019524, 11.930856809020042, 9.187610050042466, 9.61013139535983, 8.648446028431252, 15.941758058965206, 16.053242102265358, 15.314581483602524, 7.784455331663281, 7.70326981941858, 7.963049026827008, -10.048228087524578, -10.48079400757949, -10.643574441472694, 5.033891675372914, 3.8866874476273807, 4.840558012326554, -1.3171724056204255, -1.5549019922812874, -1.314751786490291, 4.909836428860814, 4.560714180270821, 4.5505992720524375, 9.304971292614937, 9.014493271708488, 9.116276174783707, 14.226340776309371, 13.833709754049778, 13.239330261945724, 8.798125698027434, 7.88957080245018, 8.372761517763138, 9.845080725848675, 10.16360705345869, 9.535712391138077, -0.6509393701950756, -0.8975731829802243, -1.0697474579016415, 1.3051686187585148, 1.6350110371907505, 1.3691228379805835, -6.311805481712028, -7.0753593097130505, -6.766370395819351, -1.4895741889874188, -1.5488253037134854, -1.2374339314798561, 14.173190509279564, 14.504050416251019, 14.196103130777672, 8.583915323019028, 8.762119241058826, 8.787651374936104, 11.564053073525429, 11.801434624940157, 11.94168004207313, -6.207385015984386, -6.342497532566398, -6.3822028314073975, 17.198424359162644, 17.661012449612215, 17.130786721905068, 10.791708307961613, 10.737849774459988, 11.003993100176245, 9.47595903774102, 9.906680119534329, 9.232180138429001, 5.808194338382833, 5.533899272481591, 5.353759246567876, 8.386979589859635, 7.691397110621125, 7.785517985622079, 8.859565346191317, 8.627888890604169, 8.763510114202887, 5.306703602274254, 6.480020978798464, 6.134677050014332, 10.630083130051688, 10.331967500348881, 10.163471837838486, 3.584138867755726, 3.8088871029516014, 3.547367756565407, 8.594963813821465, 8.78625430415073, 8.98689806709686, 12.045703214903668, 12.129388583203152, 12.127212194104985, 6.955270444353417, 7.331997783233717, 6.609993626674012, 17.214593172073364, 17.25089605152607, 17.376717805862427, 2.8578487286964958, 2.7989866087833946, 3.0334059769908492, 0.6833643168210983, 0.628465011715889, 0.20624545216560364, 9.357666790485382, 9.590281814336777, 8.634963899850845, 13.147745121270418, 12.713518410921097, 12.945872440934181, 5.031115725636482, 4.501075834035873, 4.670310705900192, 11.231634231905133, 10.311388472716004, 10.578748832146317, 10.620662103096635, 11.152433956662804, 11.067782844106347, 9.411944697300584, 9.648272475848586, 9.443677167097718, 11.663668175538376, 11.777134725203112, 11.23845426489909, 10.834741165240601, 10.95777453978856, 10.618154500921563, 6.594723393519715, 6.6609784265359195, 6.664047506948307, 13.269226046279073, 12.47536812722683, 13.082209721207619, 7.8533164113759995, 7.998236387968063, 8.006972342729568, 6.779604082306221, 7.024398533006504, 6.561369498570755, 6.054658710335687, 5.61435993512471, 5.810053681333855, 14.422188977400452, 14.73106229553619, 14.263608361283929, -3.229052479068443, -2.8678295562664715, -2.796995582679912, 3.0676530500252994, 2.7188811649878772, 2.2928261210521015, 9.469969374438122, 8.926601474483803, 8.497480740149811, 11.37083889295657, 11.696746154533074, 10.972803210218743, 7.549418419599533, 7.218737885355949, 7.688668392598629, -3.932990064223617, -3.1024012019236977, -3.6629884739716942, 8.36434957881768, 8.783981616919235, 7.868355338772133, -3.5774995908141136, -3.7988802194595337, -3.9647196382284164, 14.795180191596344, 14.930141386886433, 15.109689073016241, 4.920988296469048, 4.961504218478993, 5.192185444136456, 4.695681059112147, 4.567601275940731, 4.452974354227379, 14.302796783546597, 14.685988708903693, 13.750966067115456, -1.53381508092086, -2.3023987213770596, -1.7481340120236126, 11.510188457866505, 11.289895651241139, 10.81498934825261, 11.741998453934983, 12.54964869919543, 11.9436156352361, 5.316225536167622, 5.180350229144096, 5.202263243496418, 15.652334580818803, 15.81684101621309, 15.274815897146851, 8.23155589401722, 8.875369541347027, 8.297746777534485, 6.379894937078149, 6.467494095365197, 6.869561338486761, 10.149344260493905, 10.046477968494088, 9.7055949072043, 5.996018461883068, 5.948055945336819, 6.060926280915737, 1.010092327992112, 1.5568537811438148, 1.1887679795424049, 2.7313473423321994, 2.270969485243157, 2.5287221719821247, 4.213710678120449, 4.2290468414624485, 4.137350608905152, 6.626379176974297, 6.470722019672394, 6.880401339381933, 11.310302972793579, 11.231136158108711, 10.971505925059319, -2.3471254060665814, -1.8386289055148808, -2.2125764886538235, 10.809314906597137, 10.94578406214714, 11.852861646562815, 9.868177672227219, 10.176986133058861, 10.256305833657578, 9.205669141064078, 8.756194109717995, 8.468350167075783, 9.782703017195061, 9.895506297548607, 9.96951813002427, -89.91499571998915, -99.1290369530519, -88.56867146616182, 9.398666928211838, 9.822677383820206, 10.58271677295366, 15.174039974808693, 14.987756982445717, 15.36785339936614, 21.766978901034832, 21.49063059190908, 21.08683073023954, 13.469572241107613, 13.902628781894833, 13.619688699642808, -100.41996160894632, -101.85912555456161, -120.22615766525269, 12.803396751483277, 13.120194954176739, 13.39848787647982, 10.58844730102767, 10.150654104848698, 9.84585267802079, 2.240643988673881, 1.7462847878535541, 1.9659747680028232, 12.286789931356907, 12.507978521287441, 12.50605921447277, 9.462923665841416, 8.82744926710923, 8.848457520206765, -82.06046974162261, -92.21833152572314, -81.59993268425266, 4.709635708481073, 4.5050353333354, 4.385241732001305, 8.009985794623688, 8.02430223425229, 8.784931048129991, 17.081609560797602, 17.04094900439182, 16.974647442499787, 10.050215909878403, 10.190907123188168, 10.116762335101754, 9.355675647656113, 9.267529318730027, 9.024001652995736, 16.405160941183567, 15.510975301265717, 16.401293009519577]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14373303381605038, "mean_inference_ms": 0.6678562086043788, "mean_action_processing_ms": 0.09778410125342397, "mean_env_wait_ms": 0.8164549427249627, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 300000, "timesteps_this_iter": 0, "agent_timesteps_total": 900000, "timers": {"sample_time_ms": 12150.963, "sample_throughput": 411.49, "load_time_ms": 0.2, "load_throughput": 25004793.132, "learn_time_ms": 1605.671, "learn_throughput": 3113.964, "update_time_ms": 8.88}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0005000000000000001, "total_loss": 109.84421844482422, "policy_loss": -0.001452607314844201, "vf_loss": 109.92359161376953, "vf_explained_var": -0.028202545642852784, "kl": 0.006495934026325409, "entropy": 7.79231219291687, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 300000, "num_agent_steps_sampled": 900000, "num_steps_trained": 300000, "num_agent_steps_trained": 900000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1443, "training_iteration": 60, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-19-44", "timestamp": 1706228384, "time_this_iter_s": 11.964094400405884, "time_total_s": 627.9410901069641, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824BA9D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 627.9410901069641, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 11.188235294117646, "ram_util_percent": 55.15294117647059}}
{"episode_reward_max": 64.34444022318345, "episode_reward_min": -322.5052448287606, "episode_reward_mean": 15.992238862258661, "episode_len_mean": 490.29, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -120.22615766525269}, "policy_reward_max": {"shared_policy": 21.766978901034832}, "policy_reward_mean": {"shared_policy": 5.330746287419553}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.435740739107132, 41.29938079230487, 25.06045801824075, 29.544400170445442, -2.6182600110769414, 4.309302493929849, -20.15353518724443, -4.27583342418076, 42.873344056308255, 26.133685939013958, 35.307167740538716, -18.93208537995818, 51.99022353067993, 32.53355118259785, 28.61481929570435, 16.6958528574323, 23.86389468610284, 26.250964350998373, 17.92140163108705, 31.125522468239055, 10.940393727272735, 26.368116185069056, 36.302303992211804, 20.897261854261146, 51.84220702946186, 8.69024131447074, 1.518074780702591, 27.582912504673004, 38.807135973125696, 14.202502265572548, 32.121771536767454, 32.840878903865786, 28.503894340246887, 34.67925716564058, 32.41067020595072, 19.91974932700394, 38.82680389471352, 23.85852514207363, 20.36537211388348, 17.479072326794252, 43.41685963422057, -8.893877618014827, 8.079360336065278, 26.894051589071736, 34.040388257708386, 22.45682469755411, -10.698379740119009, 25.01668653450905, -11.341099448502064, 44.83501065149902, 15.074677959084497, 13.716256689280257, 42.73975155956575, -5.584347814321532, 33.61507345736025, 36.23526278836651, 15.698839008808136, 46.74399149417874, 25.40467221289873, 19.716950370930107, 29.901417136192293, 18.005000688135624, 3.7557140886783316, 7.531038999557481, 12.58010812848805, 19.977502536028624, 33.51294505596161, -6.398330800235286, 33.60796061530709, 30.301469638943658, 26.430213417857857, 29.647727444767938, -277.61270413920283, 29.804061084985705, 45.52965035662055, 64.34444022318345, 40.991889722645254, -322.5052448287606, 39.322079582139835, 30.58495408389716, 5.952903544530258, 37.30082766711712, 27.13883045315741, -255.8787339515984, 13.599912773817778, 24.819219077005968, 51.09720600768921, 30.357885368168326, 27.647206619381876, 48.31742925196886, 44.67184065468609, 8.57082423055543, 19.139486327767358, 42.77327675744888, 37.24969824030994, 10.664861853700103, 58.62336251884696, 38.549379318952546, 41.797651978209615, 47.214831344783306], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 243, 500, 500, 500, 500, 67, 500, 500, 500, 500, 500, 219, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [9.304971292614937, 9.014493271708488, 9.116276174783707, 14.226340776309371, 13.833709754049778, 13.239330261945724, 8.798125698027434, 7.88957080245018, 8.372761517763138, 9.845080725848675, 10.16360705345869, 9.535712391138077, -0.6509393701950756, -0.8975731829802243, -1.0697474579016415, 1.3051686187585148, 1.6350110371907505, 1.3691228379805835, -6.311805481712028, -7.0753593097130505, -6.766370395819351, -1.4895741889874188, -1.5488253037134854, -1.2374339314798561, 14.173190509279564, 14.504050416251019, 14.196103130777672, 8.583915323019028, 8.762119241058826, 8.787651374936104, 11.564053073525429, 11.801434624940157, 11.94168004207313, -6.207385015984386, -6.342497532566398, -6.3822028314073975, 17.198424359162644, 17.661012449612215, 17.130786721905068, 10.791708307961613, 10.737849774459988, 11.003993100176245, 9.47595903774102, 9.906680119534329, 9.232180138429001, 5.808194338382833, 5.533899272481591, 5.353759246567876, 8.386979589859635, 7.691397110621125, 7.785517985622079, 8.859565346191317, 8.627888890604169, 8.763510114202887, 5.306703602274254, 6.480020978798464, 6.134677050014332, 10.630083130051688, 10.331967500348881, 10.163471837838486, 3.584138867755726, 3.8088871029516014, 3.547367756565407, 8.594963813821465, 8.78625430415073, 8.98689806709686, 12.045703214903668, 12.129388583203152, 12.127212194104985, 6.955270444353417, 7.331997783233717, 6.609993626674012, 17.214593172073364, 17.25089605152607, 17.376717805862427, 2.8578487286964958, 2.7989866087833946, 3.0334059769908492, 0.6833643168210983, 0.628465011715889, 0.20624545216560364, 9.357666790485382, 9.590281814336777, 8.634963899850845, 13.147745121270418, 12.713518410921097, 12.945872440934181, 5.031115725636482, 4.501075834035873, 4.670310705900192, 11.231634231905133, 10.311388472716004, 10.578748832146317, 10.620662103096635, 11.152433956662804, 11.067782844106347, 9.411944697300584, 9.648272475848586, 9.443677167097718, 11.663668175538376, 11.777134725203112, 11.23845426489909, 10.834741165240601, 10.95777453978856, 10.618154500921563, 6.594723393519715, 6.6609784265359195, 6.664047506948307, 13.269226046279073, 12.47536812722683, 13.082209721207619, 7.8533164113759995, 7.998236387968063, 8.006972342729568, 6.779604082306221, 7.024398533006504, 6.561369498570755, 6.054658710335687, 5.61435993512471, 5.810053681333855, 14.422188977400452, 14.73106229553619, 14.263608361283929, -3.229052479068443, -2.8678295562664715, -2.796995582679912, 3.0676530500252994, 2.7188811649878772, 2.2928261210521015, 9.469969374438122, 8.926601474483803, 8.497480740149811, 11.37083889295657, 11.696746154533074, 10.972803210218743, 7.549418419599533, 7.218737885355949, 7.688668392598629, -3.932990064223617, -3.1024012019236977, -3.6629884739716942, 8.36434957881768, 8.783981616919235, 7.868355338772133, -3.5774995908141136, -3.7988802194595337, -3.9647196382284164, 14.795180191596344, 14.930141386886433, 15.109689073016241, 4.920988296469048, 4.961504218478993, 5.192185444136456, 4.695681059112147, 4.567601275940731, 4.452974354227379, 14.302796783546597, 14.685988708903693, 13.750966067115456, -1.53381508092086, -2.3023987213770596, -1.7481340120236126, 11.510188457866505, 11.289895651241139, 10.81498934825261, 11.741998453934983, 12.54964869919543, 11.9436156352361, 5.316225536167622, 5.180350229144096, 5.202263243496418, 15.652334580818803, 15.81684101621309, 15.274815897146851, 8.23155589401722, 8.875369541347027, 8.297746777534485, 6.379894937078149, 6.467494095365197, 6.869561338486761, 10.149344260493905, 10.046477968494088, 9.7055949072043, 5.996018461883068, 5.948055945336819, 6.060926280915737, 1.010092327992112, 1.5568537811438148, 1.1887679795424049, 2.7313473423321994, 2.270969485243157, 2.5287221719821247, 4.213710678120449, 4.2290468414624485, 4.137350608905152, 6.626379176974297, 6.470722019672394, 6.880401339381933, 11.310302972793579, 11.231136158108711, 10.971505925059319, -2.3471254060665814, -1.8386289055148808, -2.2125764886538235, 10.809314906597137, 10.94578406214714, 11.852861646562815, 9.868177672227219, 10.176986133058861, 10.256305833657578, 9.205669141064078, 8.756194109717995, 8.468350167075783, 9.782703017195061, 9.895506297548607, 9.96951813002427, -89.91499571998915, -99.1290369530519, -88.56867146616182, 9.398666928211838, 9.822677383820206, 10.58271677295366, 15.174039974808693, 14.987756982445717, 15.36785339936614, 21.766978901034832, 21.49063059190908, 21.08683073023954, 13.469572241107613, 13.902628781894833, 13.619688699642808, -100.41996160894632, -101.85912555456161, -120.22615766525269, 12.803396751483277, 13.120194954176739, 13.39848787647982, 10.58844730102767, 10.150654104848698, 9.84585267802079, 2.240643988673881, 1.7462847878535541, 1.9659747680028232, 12.286789931356907, 12.507978521287441, 12.50605921447277, 9.462923665841416, 8.82744926710923, 8.848457520206765, -82.06046974162261, -92.21833152572314, -81.59993268425266, 4.709635708481073, 4.5050353333354, 4.385241732001305, 8.009985794623688, 8.02430223425229, 8.784931048129991, 17.081609560797602, 17.04094900439182, 16.974647442499787, 10.050215909878403, 10.190907123188168, 10.116762335101754, 9.355675647656113, 9.267529318730027, 9.024001652995736, 16.405160941183567, 15.510975301265717, 16.401293009519577, 14.845408082008362, 14.738036647439003, 15.088395925238729, 2.7470187594493183, 3.137620851242289, 2.6861846198638233, 6.339561839898423, 6.2691997488339695, 6.530724739034966, 14.453083066890628, 14.196756216386945, 14.123437474171311, 12.786356040587023, 12.184170817335442, 12.279171382387474, 3.776530919751764, 3.3916009689370696, 3.4967299650112693, 19.38021260003248, 19.549737373987824, 19.693412544826657, 12.881436144312218, 13.175210153063134, 12.492733021577195, 14.075097113847733, 13.36537678539753, 14.357178078964353, 15.815497055649757, 15.855851300060749, 15.5434829890728]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1438740975512482, "mean_inference_ms": 0.669159139557686, "mean_action_processing_ms": 0.0979366264286618, "mean_env_wait_ms": 0.8181727068557774, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 305000, "timesteps_this_iter": 0, "agent_timesteps_total": 915000, "timers": {"sample_time_ms": 11266.973, "sample_throughput": 443.775, "load_time_ms": 0.2, "load_throughput": 25004793.132, "learn_time_ms": 1608.039, "learn_throughput": 3109.378, "update_time_ms": 8.358}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0005000000000000001, "total_loss": 8.29852991104126, "policy_loss": -0.002226898025607227, "vf_loss": 8.379109525680542, "vf_explained_var": -0.3672626972198486, "kl": 0.003289581392902236, "entropy": 7.835273933410645, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 305000, "num_agent_steps_sampled": 915000, "num_steps_trained": 305000, "num_agent_steps_trained": 915000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1453, "training_iteration": 61, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-19-55", "timestamp": 1706228395, "time_this_iter_s": 10.916276931762695, "time_total_s": 638.8573670387268, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202CC9A9550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 638.8573670387268, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 10.88125, "ram_util_percent": 55.21875}}
{"episode_reward_max": 64.34444022318345, "episode_reward_min": -322.5052448287606, "episode_reward_mean": 14.099857216041988, "episode_len_mean": 485.92, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -120.22615766525269}, "policy_reward_max": {"shared_policy": 21.766978901034832}, "policy_reward_mean": {"shared_policy": 4.699952405347328}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.93208537995818, 51.99022353067993, 32.53355118259785, 28.61481929570435, 16.6958528574323, 23.86389468610284, 26.250964350998373, 17.92140163108705, 31.125522468239055, 10.940393727272735, 26.368116185069056, 36.302303992211804, 20.897261854261146, 51.84220702946186, 8.69024131447074, 1.518074780702591, 27.582912504673004, 38.807135973125696, 14.202502265572548, 32.121771536767454, 32.840878903865786, 28.503894340246887, 34.67925716564058, 32.41067020595072, 19.91974932700394, 38.82680389471352, 23.85852514207363, 20.36537211388348, 17.479072326794252, 43.41685963422057, -8.893877618014827, 8.079360336065278, 26.894051589071736, 34.040388257708386, 22.45682469755411, -10.698379740119009, 25.01668653450905, -11.341099448502064, 44.83501065149902, 15.074677959084497, 13.716256689280257, 42.73975155956575, -5.584347814321532, 33.61507345736025, 36.23526278836651, 15.698839008808136, 46.74399149417874, 25.40467221289873, 19.716950370930107, 29.901417136192293, 18.005000688135624, 3.7557140886783316, 7.531038999557481, 12.58010812848805, 19.977502536028624, 33.51294505596161, -6.398330800235286, 33.60796061530709, 30.301469638943658, 26.430213417857857, 29.647727444767938, -277.61270413920283, 29.804061084985705, 45.52965035662055, 64.34444022318345, 40.991889722645254, -322.5052448287606, 39.322079582139835, 30.58495408389716, 5.952903544530258, 37.30082766711712, 27.13883045315741, -255.8787339515984, 13.599912773817778, 24.819219077005968, 51.09720600768921, 30.357885368168326, 27.647206619381876, 48.31742925196886, 44.67184065468609, 8.57082423055543, 19.139486327767358, 42.77327675744888, 37.24969824030994, 10.664861853700103, 58.62336251884696, 38.549379318952546, 41.797651978209615, 47.214831344783306, 35.850117623805986, 43.27708675712347, 35.02469454705712, 38.70758806541562, -315.2578740045428, 34.94106638431546, 21.66645962931213, 41.25132663920522, 57.60117878206074, 22.18466804176569, 0.4313742402009382], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 243, 500, 500, 500, 500, 67, 500, 500, 500, 500, 500, 219, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-6.207385015984386, -6.342497532566398, -6.3822028314073975, 17.198424359162644, 17.661012449612215, 17.130786721905068, 10.791708307961613, 10.737849774459988, 11.003993100176245, 9.47595903774102, 9.906680119534329, 9.232180138429001, 5.808194338382833, 5.533899272481591, 5.353759246567876, 8.386979589859635, 7.691397110621125, 7.785517985622079, 8.859565346191317, 8.627888890604169, 8.763510114202887, 5.306703602274254, 6.480020978798464, 6.134677050014332, 10.630083130051688, 10.331967500348881, 10.163471837838486, 3.584138867755726, 3.8088871029516014, 3.547367756565407, 8.594963813821465, 8.78625430415073, 8.98689806709686, 12.045703214903668, 12.129388583203152, 12.127212194104985, 6.955270444353417, 7.331997783233717, 6.609993626674012, 17.214593172073364, 17.25089605152607, 17.376717805862427, 2.8578487286964958, 2.7989866087833946, 3.0334059769908492, 0.6833643168210983, 0.628465011715889, 0.20624545216560364, 9.357666790485382, 9.590281814336777, 8.634963899850845, 13.147745121270418, 12.713518410921097, 12.945872440934181, 5.031115725636482, 4.501075834035873, 4.670310705900192, 11.231634231905133, 10.311388472716004, 10.578748832146317, 10.620662103096635, 11.152433956662804, 11.067782844106347, 9.411944697300584, 9.648272475848586, 9.443677167097718, 11.663668175538376, 11.777134725203112, 11.23845426489909, 10.834741165240601, 10.95777453978856, 10.618154500921563, 6.594723393519715, 6.6609784265359195, 6.664047506948307, 13.269226046279073, 12.47536812722683, 13.082209721207619, 7.8533164113759995, 7.998236387968063, 8.006972342729568, 6.779604082306221, 7.024398533006504, 6.561369498570755, 6.054658710335687, 5.61435993512471, 5.810053681333855, 14.422188977400452, 14.73106229553619, 14.263608361283929, -3.229052479068443, -2.8678295562664715, -2.796995582679912, 3.0676530500252994, 2.7188811649878772, 2.2928261210521015, 9.469969374438122, 8.926601474483803, 8.497480740149811, 11.37083889295657, 11.696746154533074, 10.972803210218743, 7.549418419599533, 7.218737885355949, 7.688668392598629, -3.932990064223617, -3.1024012019236977, -3.6629884739716942, 8.36434957881768, 8.783981616919235, 7.868355338772133, -3.5774995908141136, -3.7988802194595337, -3.9647196382284164, 14.795180191596344, 14.930141386886433, 15.109689073016241, 4.920988296469048, 4.961504218478993, 5.192185444136456, 4.695681059112147, 4.567601275940731, 4.452974354227379, 14.302796783546597, 14.685988708903693, 13.750966067115456, -1.53381508092086, -2.3023987213770596, -1.7481340120236126, 11.510188457866505, 11.289895651241139, 10.81498934825261, 11.741998453934983, 12.54964869919543, 11.9436156352361, 5.316225536167622, 5.180350229144096, 5.202263243496418, 15.652334580818803, 15.81684101621309, 15.274815897146851, 8.23155589401722, 8.875369541347027, 8.297746777534485, 6.379894937078149, 6.467494095365197, 6.869561338486761, 10.149344260493905, 10.046477968494088, 9.7055949072043, 5.996018461883068, 5.948055945336819, 6.060926280915737, 1.010092327992112, 1.5568537811438148, 1.1887679795424049, 2.7313473423321994, 2.270969485243157, 2.5287221719821247, 4.213710678120449, 4.2290468414624485, 4.137350608905152, 6.626379176974297, 6.470722019672394, 6.880401339381933, 11.310302972793579, 11.231136158108711, 10.971505925059319, -2.3471254060665814, -1.8386289055148808, -2.2125764886538235, 10.809314906597137, 10.94578406214714, 11.852861646562815, 9.868177672227219, 10.176986133058861, 10.256305833657578, 9.205669141064078, 8.756194109717995, 8.468350167075783, 9.782703017195061, 9.895506297548607, 9.96951813002427, -89.91499571998915, -99.1290369530519, -88.56867146616182, 9.398666928211838, 9.822677383820206, 10.58271677295366, 15.174039974808693, 14.987756982445717, 15.36785339936614, 21.766978901034832, 21.49063059190908, 21.08683073023954, 13.469572241107613, 13.902628781894833, 13.619688699642808, -100.41996160894632, -101.85912555456161, -120.22615766525269, 12.803396751483277, 13.120194954176739, 13.39848787647982, 10.58844730102767, 10.150654104848698, 9.84585267802079, 2.240643988673881, 1.7462847878535541, 1.9659747680028232, 12.286789931356907, 12.507978521287441, 12.50605921447277, 9.462923665841416, 8.82744926710923, 8.848457520206765, -82.06046974162261, -92.21833152572314, -81.59993268425266, 4.709635708481073, 4.5050353333354, 4.385241732001305, 8.009985794623688, 8.02430223425229, 8.784931048129991, 17.081609560797602, 17.04094900439182, 16.974647442499787, 10.050215909878403, 10.190907123188168, 10.116762335101754, 9.355675647656113, 9.267529318730027, 9.024001652995736, 16.405160941183567, 15.510975301265717, 16.401293009519577, 14.845408082008362, 14.738036647439003, 15.088395925238729, 2.7470187594493183, 3.137620851242289, 2.6861846198638233, 6.339561839898423, 6.2691997488339695, 6.530724739034966, 14.453083066890628, 14.196756216386945, 14.123437474171311, 12.786356040587023, 12.184170817335442, 12.279171382387474, 3.776530919751764, 3.3916009689370696, 3.4967299650112693, 19.38021260003248, 19.549737373987824, 19.693412544826657, 12.881436144312218, 13.175210153063134, 12.492733021577195, 14.075097113847733, 13.36537678539753, 14.357178078964353, 15.815497055649757, 15.855851300060749, 15.5434829890728, 11.737277721365288, 11.8818550457557, 12.230984856684998, 14.428884819149971, 14.207706063985825, 14.640495873987675, 11.883265639344842, 11.213278139630944, 11.928150768081338, 13.045715544372797, 12.89144991338253, 12.770422607660294, -100.19270777205627, -115.05172602335612, -100.01344020913045, 11.814177716771752, 11.396236504117638, 11.730652163426072, 7.0244308287898605, 7.175678993264825, 7.466349807257444, 13.947033580392599, 13.63786642998457, 13.666426628828049, 19.042100496590137, 19.517101170495152, 19.041977114975452, 7.809033744037151, 7.0299389362335205, 7.345695361495018, 0.081614161531121, -0.26415305336317374, 0.6139131320329909]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1440433121865904, "mean_inference_ms": 0.6707276885627523, "mean_action_processing_ms": 0.09809364113447323, "mean_env_wait_ms": 0.8201606432358135, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 310000, "timesteps_this_iter": 0, "agent_timesteps_total": 930000, "timers": {"sample_time_ms": 11431.973, "sample_throughput": 437.37, "load_time_ms": 0.2, "load_throughput": 25004793.132, "learn_time_ms": 1624.161, "learn_throughput": 3078.513, "update_time_ms": 8.434}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0005000000000000001, "total_loss": 79.51133270263672, "policy_loss": -0.003007913341075197, "vf_loss": 79.59289627075195, "vf_explained_var": 0.041287165880203244, "kl": 0.005822872073633006, "entropy": 7.855644655227661, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 310000, "num_agent_steps_sampled": 930000, "num_steps_trained": 310000, "num_agent_steps_trained": 930000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1464, "training_iteration": 62, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-20-08", "timestamp": 1706228408, "time_this_iter_s": 12.355976343154907, "time_total_s": 651.2133433818817, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202823BEEE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 651.2133433818817, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 9.600000000000001, "ram_util_percent": 55.2764705882353}}
{"episode_reward_max": 64.34444022318345, "episode_reward_min": -322.5052448287606, "episode_reward_mean": 11.530672875427397, "episode_len_mean": 481.3, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -120.22615766525269}, "policy_reward_max": {"shared_policy": 21.766978901034832}, "policy_reward_mean": {"shared_policy": 3.843557625142465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.302303992211804, 20.897261854261146, 51.84220702946186, 8.69024131447074, 1.518074780702591, 27.582912504673004, 38.807135973125696, 14.202502265572548, 32.121771536767454, 32.840878903865786, 28.503894340246887, 34.67925716564058, 32.41067020595072, 19.91974932700394, 38.82680389471352, 23.85852514207363, 20.36537211388348, 17.479072326794252, 43.41685963422057, -8.893877618014827, 8.079360336065278, 26.894051589071736, 34.040388257708386, 22.45682469755411, -10.698379740119009, 25.01668653450905, -11.341099448502064, 44.83501065149902, 15.074677959084497, 13.716256689280257, 42.73975155956575, -5.584347814321532, 33.61507345736025, 36.23526278836651, 15.698839008808136, 46.74399149417874, 25.40467221289873, 19.716950370930107, 29.901417136192293, 18.005000688135624, 3.7557140886783316, 7.531038999557481, 12.58010812848805, 19.977502536028624, 33.51294505596161, -6.398330800235286, 33.60796061530709, 30.301469638943658, 26.430213417857857, 29.647727444767938, -277.61270413920283, 29.804061084985705, 45.52965035662055, 64.34444022318345, 40.991889722645254, -322.5052448287606, 39.322079582139835, 30.58495408389716, 5.952903544530258, 37.30082766711712, 27.13883045315741, -255.8787339515984, 13.599912773817778, 24.819219077005968, 51.09720600768921, 30.357885368168326, 27.647206619381876, 48.31742925196886, 44.67184065468609, 8.57082423055543, 19.139486327767358, 42.77327675744888, 37.24969824030994, 10.664861853700103, 58.62336251884696, 38.549379318952546, 41.797651978209615, 47.214831344783306, 35.850117623805986, 43.27708675712347, 35.02469454705712, 38.70758806541562, -315.2578740045428, 34.94106638431546, 21.66645962931213, 41.25132663920522, 57.60117878206074, 22.18466804176569, 0.4313742402009382, 45.291758857667446, 38.843996573239565, 34.36321583017707, -320.8944304585457, 37.98070468753575, 37.30912393331526, 34.58247875701633, 47.78084924630819, 17.010101214051218, 16.821557401679442, 1.364864431321621], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 243, 500, 500, 500, 500, 67, 500, 500, 500, 500, 500, 219, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 38, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [12.045703214903668, 12.129388583203152, 12.127212194104985, 6.955270444353417, 7.331997783233717, 6.609993626674012, 17.214593172073364, 17.25089605152607, 17.376717805862427, 2.8578487286964958, 2.7989866087833946, 3.0334059769908492, 0.6833643168210983, 0.628465011715889, 0.20624545216560364, 9.357666790485382, 9.590281814336777, 8.634963899850845, 13.147745121270418, 12.713518410921097, 12.945872440934181, 5.031115725636482, 4.501075834035873, 4.670310705900192, 11.231634231905133, 10.311388472716004, 10.578748832146317, 10.620662103096635, 11.152433956662804, 11.067782844106347, 9.411944697300584, 9.648272475848586, 9.443677167097718, 11.663668175538376, 11.777134725203112, 11.23845426489909, 10.834741165240601, 10.95777453978856, 10.618154500921563, 6.594723393519715, 6.6609784265359195, 6.664047506948307, 13.269226046279073, 12.47536812722683, 13.082209721207619, 7.8533164113759995, 7.998236387968063, 8.006972342729568, 6.779604082306221, 7.024398533006504, 6.561369498570755, 6.054658710335687, 5.61435993512471, 5.810053681333855, 14.422188977400452, 14.73106229553619, 14.263608361283929, -3.229052479068443, -2.8678295562664715, -2.796995582679912, 3.0676530500252994, 2.7188811649878772, 2.2928261210521015, 9.469969374438122, 8.926601474483803, 8.497480740149811, 11.37083889295657, 11.696746154533074, 10.972803210218743, 7.549418419599533, 7.218737885355949, 7.688668392598629, -3.932990064223617, -3.1024012019236977, -3.6629884739716942, 8.36434957881768, 8.783981616919235, 7.868355338772133, -3.5774995908141136, -3.7988802194595337, -3.9647196382284164, 14.795180191596344, 14.930141386886433, 15.109689073016241, 4.920988296469048, 4.961504218478993, 5.192185444136456, 4.695681059112147, 4.567601275940731, 4.452974354227379, 14.302796783546597, 14.685988708903693, 13.750966067115456, -1.53381508092086, -2.3023987213770596, -1.7481340120236126, 11.510188457866505, 11.289895651241139, 10.81498934825261, 11.741998453934983, 12.54964869919543, 11.9436156352361, 5.316225536167622, 5.180350229144096, 5.202263243496418, 15.652334580818803, 15.81684101621309, 15.274815897146851, 8.23155589401722, 8.875369541347027, 8.297746777534485, 6.379894937078149, 6.467494095365197, 6.869561338486761, 10.149344260493905, 10.046477968494088, 9.7055949072043, 5.996018461883068, 5.948055945336819, 6.060926280915737, 1.010092327992112, 1.5568537811438148, 1.1887679795424049, 2.7313473423321994, 2.270969485243157, 2.5287221719821247, 4.213710678120449, 4.2290468414624485, 4.137350608905152, 6.626379176974297, 6.470722019672394, 6.880401339381933, 11.310302972793579, 11.231136158108711, 10.971505925059319, -2.3471254060665814, -1.8386289055148808, -2.2125764886538235, 10.809314906597137, 10.94578406214714, 11.852861646562815, 9.868177672227219, 10.176986133058861, 10.256305833657578, 9.205669141064078, 8.756194109717995, 8.468350167075783, 9.782703017195061, 9.895506297548607, 9.96951813002427, -89.91499571998915, -99.1290369530519, -88.56867146616182, 9.398666928211838, 9.822677383820206, 10.58271677295366, 15.174039974808693, 14.987756982445717, 15.36785339936614, 21.766978901034832, 21.49063059190908, 21.08683073023954, 13.469572241107613, 13.902628781894833, 13.619688699642808, -100.41996160894632, -101.85912555456161, -120.22615766525269, 12.803396751483277, 13.120194954176739, 13.39848787647982, 10.58844730102767, 10.150654104848698, 9.84585267802079, 2.240643988673881, 1.7462847878535541, 1.9659747680028232, 12.286789931356907, 12.507978521287441, 12.50605921447277, 9.462923665841416, 8.82744926710923, 8.848457520206765, -82.06046974162261, -92.21833152572314, -81.59993268425266, 4.709635708481073, 4.5050353333354, 4.385241732001305, 8.009985794623688, 8.02430223425229, 8.784931048129991, 17.081609560797602, 17.04094900439182, 16.974647442499787, 10.050215909878403, 10.190907123188168, 10.116762335101754, 9.355675647656113, 9.267529318730027, 9.024001652995736, 16.405160941183567, 15.510975301265717, 16.401293009519577, 14.845408082008362, 14.738036647439003, 15.088395925238729, 2.7470187594493183, 3.137620851242289, 2.6861846198638233, 6.339561839898423, 6.2691997488339695, 6.530724739034966, 14.453083066890628, 14.196756216386945, 14.123437474171311, 12.786356040587023, 12.184170817335442, 12.279171382387474, 3.776530919751764, 3.3916009689370696, 3.4967299650112693, 19.38021260003248, 19.549737373987824, 19.693412544826657, 12.881436144312218, 13.175210153063134, 12.492733021577195, 14.075097113847733, 13.36537678539753, 14.357178078964353, 15.815497055649757, 15.855851300060749, 15.5434829890728, 11.737277721365288, 11.8818550457557, 12.230984856684998, 14.428884819149971, 14.207706063985825, 14.640495873987675, 11.883265639344842, 11.213278139630944, 11.928150768081338, 13.045715544372797, 12.89144991338253, 12.770422607660294, -100.19270777205627, -115.05172602335612, -100.01344020913045, 11.814177716771752, 11.396236504117638, 11.730652163426072, 7.0244308287898605, 7.175678993264825, 7.466349807257444, 13.947033580392599, 13.63786642998457, 13.666426628828049, 19.042100496590137, 19.517101170495152, 19.041977114975452, 7.809033744037151, 7.0299389362335205, 7.345695361495018, 0.081614161531121, -0.26415305336317374, 0.6139131320329909, 14.74203036725521, 15.25059973448515, 15.299128755927086, 12.864203549921513, 12.721623167395592, 13.25816985592246, 11.514822755008936, 11.360041469335556, 11.488351605832577, -116.24576922257742, -102.43868957956633, -102.20997165640196, 12.30442016323407, 12.789930877586201, 12.886353646715477, 12.498949599762753, 12.490569857259587, 12.319604476292923, 11.436029779414326, 11.721247834774346, 11.42520114282766, 16.113972503071025, 15.821481605370835, 15.845395137866333, 5.557047868768365, 5.925834248463303, 5.52721909681955, 5.489957516392067, 5.305127759774521, 6.0264721255128535, 0.4834371879696846, 0.5027831047773361, 0.3786441385746002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14436895879829945, "mean_inference_ms": 0.6727961630283914, "mean_action_processing_ms": 0.09832216739644764, "mean_env_wait_ms": 0.8225311079006997, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 315000, "timesteps_this_iter": 0, "agent_timesteps_total": 945000, "timers": {"sample_time_ms": 11609.239, "sample_throughput": 430.691, "load_time_ms": 0.1, "load_throughput": 50015549.726, "learn_time_ms": 1640.606, "learn_throughput": 3047.654, "update_time_ms": 8.456}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0005000000000000001, "total_loss": 63.50545425415039, "policy_loss": -0.003451620732136074, "vf_loss": 63.58814964294434, "vf_explained_var": 0.038347494602203366, "kl": 0.007936153115598954, "entropy": 7.9244709491729735, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 315000, "num_agent_steps_sampled": 945000, "num_steps_trained": 315000, "num_agent_steps_trained": 945000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1475, "training_iteration": 63, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-20-20", "timestamp": 1706228420, "time_this_iter_s": 12.424197435379028, "time_total_s": 663.6375408172607, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028458FAF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 663.6375408172607, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 10.683333333333334, "ram_util_percent": 55.400000000000006}}
{"episode_reward_max": 64.34444022318345, "episode_reward_min": -322.5052448287606, "episode_reward_mean": 13.144053610519613, "episode_len_mean": 481.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -120.22615766525269}, "policy_reward_max": {"shared_policy": 21.766978901034832}, "policy_reward_mean": {"shared_policy": 4.3813512035065365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.503894340246887, 34.67925716564058, 32.41067020595072, 19.91974932700394, 38.82680389471352, 23.85852514207363, 20.36537211388348, 17.479072326794252, 43.41685963422057, -8.893877618014827, 8.079360336065278, 26.894051589071736, 34.040388257708386, 22.45682469755411, -10.698379740119009, 25.01668653450905, -11.341099448502064, 44.83501065149902, 15.074677959084497, 13.716256689280257, 42.73975155956575, -5.584347814321532, 33.61507345736025, 36.23526278836651, 15.698839008808136, 46.74399149417874, 25.40467221289873, 19.716950370930107, 29.901417136192293, 18.005000688135624, 3.7557140886783316, 7.531038999557481, 12.58010812848805, 19.977502536028624, 33.51294505596161, -6.398330800235286, 33.60796061530709, 30.301469638943658, 26.430213417857857, 29.647727444767938, -277.61270413920283, 29.804061084985705, 45.52965035662055, 64.34444022318345, 40.991889722645254, -322.5052448287606, 39.322079582139835, 30.58495408389716, 5.952903544530258, 37.30082766711712, 27.13883045315741, -255.8787339515984, 13.599912773817778, 24.819219077005968, 51.09720600768921, 30.357885368168326, 27.647206619381876, 48.31742925196886, 44.67184065468609, 8.57082423055543, 19.139486327767358, 42.77327675744888, 37.24969824030994, 10.664861853700103, 58.62336251884696, 38.549379318952546, 41.797651978209615, 47.214831344783306, 35.850117623805986, 43.27708675712347, 35.02469454705712, 38.70758806541562, -315.2578740045428, 34.94106638431546, 21.66645962931213, 41.25132663920522, 57.60117878206074, 22.18466804176569, 0.4313742402009382, 45.291758857667446, 38.843996573239565, 34.36321583017707, -320.8944304585457, 37.98070468753575, 37.30912393331526, 34.58247875701633, 47.78084924630819, 17.010101214051218, 16.821557401679442, 1.364864431321621, 62.49244418554008, 58.02146406844258, 59.822682386264205, 24.941822938621044, 51.008024184033246, 36.11169526167214, 37.772522220795494, 14.965691074728937, 32.505376249551745, 48.5016410946846], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 243, 500, 500, 500, 500, 67, 500, 500, 500, 500, 500, 219, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 38, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [9.411944697300584, 9.648272475848586, 9.443677167097718, 11.663668175538376, 11.777134725203112, 11.23845426489909, 10.834741165240601, 10.95777453978856, 10.618154500921563, 6.594723393519715, 6.6609784265359195, 6.664047506948307, 13.269226046279073, 12.47536812722683, 13.082209721207619, 7.8533164113759995, 7.998236387968063, 8.006972342729568, 6.779604082306221, 7.024398533006504, 6.561369498570755, 6.054658710335687, 5.61435993512471, 5.810053681333855, 14.422188977400452, 14.73106229553619, 14.263608361283929, -3.229052479068443, -2.8678295562664715, -2.796995582679912, 3.0676530500252994, 2.7188811649878772, 2.2928261210521015, 9.469969374438122, 8.926601474483803, 8.497480740149811, 11.37083889295657, 11.696746154533074, 10.972803210218743, 7.549418419599533, 7.218737885355949, 7.688668392598629, -3.932990064223617, -3.1024012019236977, -3.6629884739716942, 8.36434957881768, 8.783981616919235, 7.868355338772133, -3.5774995908141136, -3.7988802194595337, -3.9647196382284164, 14.795180191596344, 14.930141386886433, 15.109689073016241, 4.920988296469048, 4.961504218478993, 5.192185444136456, 4.695681059112147, 4.567601275940731, 4.452974354227379, 14.302796783546597, 14.685988708903693, 13.750966067115456, -1.53381508092086, -2.3023987213770596, -1.7481340120236126, 11.510188457866505, 11.289895651241139, 10.81498934825261, 11.741998453934983, 12.54964869919543, 11.9436156352361, 5.316225536167622, 5.180350229144096, 5.202263243496418, 15.652334580818803, 15.81684101621309, 15.274815897146851, 8.23155589401722, 8.875369541347027, 8.297746777534485, 6.379894937078149, 6.467494095365197, 6.869561338486761, 10.149344260493905, 10.046477968494088, 9.7055949072043, 5.996018461883068, 5.948055945336819, 6.060926280915737, 1.010092327992112, 1.5568537811438148, 1.1887679795424049, 2.7313473423321994, 2.270969485243157, 2.5287221719821247, 4.213710678120449, 4.2290468414624485, 4.137350608905152, 6.626379176974297, 6.470722019672394, 6.880401339381933, 11.310302972793579, 11.231136158108711, 10.971505925059319, -2.3471254060665814, -1.8386289055148808, -2.2125764886538235, 10.809314906597137, 10.94578406214714, 11.852861646562815, 9.868177672227219, 10.176986133058861, 10.256305833657578, 9.205669141064078, 8.756194109717995, 8.468350167075783, 9.782703017195061, 9.895506297548607, 9.96951813002427, -89.91499571998915, -99.1290369530519, -88.56867146616182, 9.398666928211838, 9.822677383820206, 10.58271677295366, 15.174039974808693, 14.987756982445717, 15.36785339936614, 21.766978901034832, 21.49063059190908, 21.08683073023954, 13.469572241107613, 13.902628781894833, 13.619688699642808, -100.41996160894632, -101.85912555456161, -120.22615766525269, 12.803396751483277, 13.120194954176739, 13.39848787647982, 10.58844730102767, 10.150654104848698, 9.84585267802079, 2.240643988673881, 1.7462847878535541, 1.9659747680028232, 12.286789931356907, 12.507978521287441, 12.50605921447277, 9.462923665841416, 8.82744926710923, 8.848457520206765, -82.06046974162261, -92.21833152572314, -81.59993268425266, 4.709635708481073, 4.5050353333354, 4.385241732001305, 8.009985794623688, 8.02430223425229, 8.784931048129991, 17.081609560797602, 17.04094900439182, 16.974647442499787, 10.050215909878403, 10.190907123188168, 10.116762335101754, 9.355675647656113, 9.267529318730027, 9.024001652995736, 16.405160941183567, 15.510975301265717, 16.401293009519577, 14.845408082008362, 14.738036647439003, 15.088395925238729, 2.7470187594493183, 3.137620851242289, 2.6861846198638233, 6.339561839898423, 6.2691997488339695, 6.530724739034966, 14.453083066890628, 14.196756216386945, 14.123437474171311, 12.786356040587023, 12.184170817335442, 12.279171382387474, 3.776530919751764, 3.3916009689370696, 3.4967299650112693, 19.38021260003248, 19.549737373987824, 19.693412544826657, 12.881436144312218, 13.175210153063134, 12.492733021577195, 14.075097113847733, 13.36537678539753, 14.357178078964353, 15.815497055649757, 15.855851300060749, 15.5434829890728, 11.737277721365288, 11.8818550457557, 12.230984856684998, 14.428884819149971, 14.207706063985825, 14.640495873987675, 11.883265639344842, 11.213278139630944, 11.928150768081338, 13.045715544372797, 12.89144991338253, 12.770422607660294, -100.19270777205627, -115.05172602335612, -100.01344020913045, 11.814177716771752, 11.396236504117638, 11.730652163426072, 7.0244308287898605, 7.175678993264825, 7.466349807257444, 13.947033580392599, 13.63786642998457, 13.666426628828049, 19.042100496590137, 19.517101170495152, 19.041977114975452, 7.809033744037151, 7.0299389362335205, 7.345695361495018, 0.081614161531121, -0.26415305336317374, 0.6139131320329909, 14.74203036725521, 15.25059973448515, 15.299128755927086, 12.864203549921513, 12.721623167395592, 13.25816985592246, 11.514822755008936, 11.360041469335556, 11.488351605832577, -116.24576922257742, -102.43868957956633, -102.20997165640196, 12.30442016323407, 12.789930877586201, 12.886353646715477, 12.498949599762753, 12.490569857259587, 12.319604476292923, 11.436029779414326, 11.721247834774346, 11.42520114282766, 16.113972503071025, 15.821481605370835, 15.845395137866333, 5.557047868768365, 5.925834248463303, 5.52721909681955, 5.489957516392067, 5.305127759774521, 6.0264721255128535, 0.4834371879696846, 0.5027831047773361, 0.3786441385746002, 20.614996768534184, 20.84746043384075, 21.029986983165145, 19.152167066931725, 19.578861016780138, 19.29043598473072, 20.095635088160634, 19.9833696000278, 19.74367769807577, 8.234564803540707, 8.265362523496151, 8.441895611584187, 16.520441527167947, 17.083887736002595, 17.403694920862705, 12.064728379249573, 12.310275049880147, 11.73669183254242, 12.662715756120932, 12.59008756310989, 12.519718901564673, 5.181347290674836, 4.8631660739580695, 4.921177710096032, 11.007626163462788, 10.53756013015905, 10.960189955929906, 15.982718124985695, 16.20428729057312, 16.314635679125786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14461831471417305, "mean_inference_ms": 0.674570899610803, "mean_action_processing_ms": 0.09851333030387187, "mean_env_wait_ms": 0.8245876762257801, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 320000, "timesteps_this_iter": 0, "agent_timesteps_total": 960000, "timers": {"sample_time_ms": 11704.486, "sample_throughput": 427.187, "load_time_ms": 0.1, "load_throughput": 50015549.726, "learn_time_ms": 1652.991, "learn_throughput": 3024.819, "update_time_ms": 8.094}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0005000000000000001, "total_loss": 4.115029215812683, "policy_loss": -0.0030193542651955952, "vf_loss": 4.197363257408142, "vf_explained_var": -0.6210785150527954, "kl": 0.0026288198052605272, "entropy": 7.93146710395813, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 320000, "num_agent_steps_sampled": 960000, "num_steps_trained": 320000, "num_agent_steps_trained": 960000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1485, "training_iteration": 64, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-20-32", "timestamp": 1706228432, "time_this_iter_s": 11.808799743652344, "time_total_s": 675.4463405609131, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824D0AF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 675.4463405609131, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 10.5, "ram_util_percent": 55.49375}}
{"episode_reward_max": 64.34444022318345, "episode_reward_min": -322.5052448287606, "episode_reward_mean": 13.681089962956603, "episode_len_mean": 481.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -120.22615766525269}, "policy_reward_max": {"shared_policy": 21.766978901034832}, "policy_reward_mean": {"shared_policy": 4.560363320985533}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.079360336065278, 26.894051589071736, 34.040388257708386, 22.45682469755411, -10.698379740119009, 25.01668653450905, -11.341099448502064, 44.83501065149902, 15.074677959084497, 13.716256689280257, 42.73975155956575, -5.584347814321532, 33.61507345736025, 36.23526278836651, 15.698839008808136, 46.74399149417874, 25.40467221289873, 19.716950370930107, 29.901417136192293, 18.005000688135624, 3.7557140886783316, 7.531038999557481, 12.58010812848805, 19.977502536028624, 33.51294505596161, -6.398330800235286, 33.60796061530709, 30.301469638943658, 26.430213417857857, 29.647727444767938, -277.61270413920283, 29.804061084985705, 45.52965035662055, 64.34444022318345, 40.991889722645254, -322.5052448287606, 39.322079582139835, 30.58495408389716, 5.952903544530258, 37.30082766711712, 27.13883045315741, -255.8787339515984, 13.599912773817778, 24.819219077005968, 51.09720600768921, 30.357885368168326, 27.647206619381876, 48.31742925196886, 44.67184065468609, 8.57082423055543, 19.139486327767358, 42.77327675744888, 37.24969824030994, 10.664861853700103, 58.62336251884696, 38.549379318952546, 41.797651978209615, 47.214831344783306, 35.850117623805986, 43.27708675712347, 35.02469454705712, 38.70758806541562, -315.2578740045428, 34.94106638431546, 21.66645962931213, 41.25132663920522, 57.60117878206074, 22.18466804176569, 0.4313742402009382, 45.291758857667446, 38.843996573239565, 34.36321583017707, -320.8944304585457, 37.98070468753575, 37.30912393331526, 34.58247875701633, 47.78084924630819, 17.010101214051218, 16.821557401679442, 1.364864431321621, 62.49244418554008, 58.02146406844258, 59.822682386264205, 24.941822938621044, 51.008024184033246, 36.11169526167214, 37.772522220795494, 14.965691074728937, 32.505376249551745, 48.5016410946846, 25.438391899690004, 31.998920008540154, 34.22590850293636, 13.86639159172772, 28.57443417608738, 15.345767930150018, 27.41528821922836, 37.64282925426957, 62.120868967846036, 27.64116122573614], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 243, 500, 500, 500, 500, 67, 500, 500, 500, 500, 500, 219, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 38, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [3.0676530500252994, 2.7188811649878772, 2.2928261210521015, 9.469969374438122, 8.926601474483803, 8.497480740149811, 11.37083889295657, 11.696746154533074, 10.972803210218743, 7.549418419599533, 7.218737885355949, 7.688668392598629, -3.932990064223617, -3.1024012019236977, -3.6629884739716942, 8.36434957881768, 8.783981616919235, 7.868355338772133, -3.5774995908141136, -3.7988802194595337, -3.9647196382284164, 14.795180191596344, 14.930141386886433, 15.109689073016241, 4.920988296469048, 4.961504218478993, 5.192185444136456, 4.695681059112147, 4.567601275940731, 4.452974354227379, 14.302796783546597, 14.685988708903693, 13.750966067115456, -1.53381508092086, -2.3023987213770596, -1.7481340120236126, 11.510188457866505, 11.289895651241139, 10.81498934825261, 11.741998453934983, 12.54964869919543, 11.9436156352361, 5.316225536167622, 5.180350229144096, 5.202263243496418, 15.652334580818803, 15.81684101621309, 15.274815897146851, 8.23155589401722, 8.875369541347027, 8.297746777534485, 6.379894937078149, 6.467494095365197, 6.869561338486761, 10.149344260493905, 10.046477968494088, 9.7055949072043, 5.996018461883068, 5.948055945336819, 6.060926280915737, 1.010092327992112, 1.5568537811438148, 1.1887679795424049, 2.7313473423321994, 2.270969485243157, 2.5287221719821247, 4.213710678120449, 4.2290468414624485, 4.137350608905152, 6.626379176974297, 6.470722019672394, 6.880401339381933, 11.310302972793579, 11.231136158108711, 10.971505925059319, -2.3471254060665814, -1.8386289055148808, -2.2125764886538235, 10.809314906597137, 10.94578406214714, 11.852861646562815, 9.868177672227219, 10.176986133058861, 10.256305833657578, 9.205669141064078, 8.756194109717995, 8.468350167075783, 9.782703017195061, 9.895506297548607, 9.96951813002427, -89.91499571998915, -99.1290369530519, -88.56867146616182, 9.398666928211838, 9.822677383820206, 10.58271677295366, 15.174039974808693, 14.987756982445717, 15.36785339936614, 21.766978901034832, 21.49063059190908, 21.08683073023954, 13.469572241107613, 13.902628781894833, 13.619688699642808, -100.41996160894632, -101.85912555456161, -120.22615766525269, 12.803396751483277, 13.120194954176739, 13.39848787647982, 10.58844730102767, 10.150654104848698, 9.84585267802079, 2.240643988673881, 1.7462847878535541, 1.9659747680028232, 12.286789931356907, 12.507978521287441, 12.50605921447277, 9.462923665841416, 8.82744926710923, 8.848457520206765, -82.06046974162261, -92.21833152572314, -81.59993268425266, 4.709635708481073, 4.5050353333354, 4.385241732001305, 8.009985794623688, 8.02430223425229, 8.784931048129991, 17.081609560797602, 17.04094900439182, 16.974647442499787, 10.050215909878403, 10.190907123188168, 10.116762335101754, 9.355675647656113, 9.267529318730027, 9.024001652995736, 16.405160941183567, 15.510975301265717, 16.401293009519577, 14.845408082008362, 14.738036647439003, 15.088395925238729, 2.7470187594493183, 3.137620851242289, 2.6861846198638233, 6.339561839898423, 6.2691997488339695, 6.530724739034966, 14.453083066890628, 14.196756216386945, 14.123437474171311, 12.786356040587023, 12.184170817335442, 12.279171382387474, 3.776530919751764, 3.3916009689370696, 3.4967299650112693, 19.38021260003248, 19.549737373987824, 19.693412544826657, 12.881436144312218, 13.175210153063134, 12.492733021577195, 14.075097113847733, 13.36537678539753, 14.357178078964353, 15.815497055649757, 15.855851300060749, 15.5434829890728, 11.737277721365288, 11.8818550457557, 12.230984856684998, 14.428884819149971, 14.207706063985825, 14.640495873987675, 11.883265639344842, 11.213278139630944, 11.928150768081338, 13.045715544372797, 12.89144991338253, 12.770422607660294, -100.19270777205627, -115.05172602335612, -100.01344020913045, 11.814177716771752, 11.396236504117638, 11.730652163426072, 7.0244308287898605, 7.175678993264825, 7.466349807257444, 13.947033580392599, 13.63786642998457, 13.666426628828049, 19.042100496590137, 19.517101170495152, 19.041977114975452, 7.809033744037151, 7.0299389362335205, 7.345695361495018, 0.081614161531121, -0.26415305336317374, 0.6139131320329909, 14.74203036725521, 15.25059973448515, 15.299128755927086, 12.864203549921513, 12.721623167395592, 13.25816985592246, 11.514822755008936, 11.360041469335556, 11.488351605832577, -116.24576922257742, -102.43868957956633, -102.20997165640196, 12.30442016323407, 12.789930877586201, 12.886353646715477, 12.498949599762753, 12.490569857259587, 12.319604476292923, 11.436029779414326, 11.721247834774346, 11.42520114282766, 16.113972503071025, 15.821481605370835, 15.845395137866333, 5.557047868768365, 5.925834248463303, 5.52721909681955, 5.489957516392067, 5.305127759774521, 6.0264721255128535, 0.4834371879696846, 0.5027831047773361, 0.3786441385746002, 20.614996768534184, 20.84746043384075, 21.029986983165145, 19.152167066931725, 19.578861016780138, 19.29043598473072, 20.095635088160634, 19.9833696000278, 19.74367769807577, 8.234564803540707, 8.265362523496151, 8.441895611584187, 16.520441527167947, 17.083887736002595, 17.403694920862705, 12.064728379249573, 12.310275049880147, 11.73669183254242, 12.662715756120932, 12.59008756310989, 12.519718901564673, 5.181347290674836, 4.8631660739580695, 4.921177710096032, 11.007626163462788, 10.53756013015905, 10.960189955929906, 15.982718124985695, 16.20428729057312, 16.314635679125786, 8.771489795918257, 8.607952206085116, 8.058949897686631, 10.415763102471828, 10.755259703844786, 10.82789720222354, 11.744903445243835, 11.70838151872158, 10.772623538970947, 4.584665497144059, 4.514677350719765, 4.767048743863896, 9.066572099924088, 9.193316608667374, 10.314545467495918, 5.019036819537476, 5.113765140374497, 5.212965970238045, 9.238762913892657, 8.800235355893761, 9.37628994944194, 12.50312230984369, 12.485963548223168, 12.653743396202714, 20.270163014531136, 20.836274966597557, 21.014430986717343, 9.14522173255682, 8.941124513745308, 9.554814979434013]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14485636529388185, "mean_inference_ms": 0.6762601716766252, "mean_action_processing_ms": 0.09869642430889199, "mean_env_wait_ms": 0.8265712575559457, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 325000, "timesteps_this_iter": 0, "agent_timesteps_total": 975000, "timers": {"sample_time_ms": 11754.991, "sample_throughput": 425.351, "load_time_ms": 0.1, "load_throughput": 50015549.726, "learn_time_ms": 1658.721, "learn_throughput": 3014.371, "update_time_ms": 8.043}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0005000000000000001, "total_loss": 4.373428535461426, "policy_loss": -0.0030450450408024297, "vf_loss": 4.456804466247559, "vf_explained_var": -0.4787405252456665, "kl": 0.003476648138905613, "entropy": 8.033088541030883, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 325000, "num_agent_steps_sampled": 975000, "num_steps_trained": 325000, "num_agent_steps_trained": 975000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1495, "training_iteration": 65, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-20-43", "timestamp": 1706228443, "time_this_iter_s": 11.534530639648438, "time_total_s": 686.9808712005615, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282492550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 686.9808712005615, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 11.55625, "ram_util_percent": 55.474999999999994}}
{"episode_reward_max": 64.34444022318345, "episode_reward_min": -322.5052448287606, "episode_reward_mean": 16.310641339233253, "episode_len_mean": 481.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -120.22615766525269}, "policy_reward_max": {"shared_policy": 21.766978901034832}, "policy_reward_mean": {"shared_policy": 5.436880446411083}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.73975155956575, -5.584347814321532, 33.61507345736025, 36.23526278836651, 15.698839008808136, 46.74399149417874, 25.40467221289873, 19.716950370930107, 29.901417136192293, 18.005000688135624, 3.7557140886783316, 7.531038999557481, 12.58010812848805, 19.977502536028624, 33.51294505596161, -6.398330800235286, 33.60796061530709, 30.301469638943658, 26.430213417857857, 29.647727444767938, -277.61270413920283, 29.804061084985705, 45.52965035662055, 64.34444022318345, 40.991889722645254, -322.5052448287606, 39.322079582139835, 30.58495408389716, 5.952903544530258, 37.30082766711712, 27.13883045315741, -255.8787339515984, 13.599912773817778, 24.819219077005968, 51.09720600768921, 30.357885368168326, 27.647206619381876, 48.31742925196886, 44.67184065468609, 8.57082423055543, 19.139486327767358, 42.77327675744888, 37.24969824030994, 10.664861853700103, 58.62336251884696, 38.549379318952546, 41.797651978209615, 47.214831344783306, 35.850117623805986, 43.27708675712347, 35.02469454705712, 38.70758806541562, -315.2578740045428, 34.94106638431546, 21.66645962931213, 41.25132663920522, 57.60117878206074, 22.18466804176569, 0.4313742402009382, 45.291758857667446, 38.843996573239565, 34.36321583017707, -320.8944304585457, 37.98070468753575, 37.30912393331526, 34.58247875701633, 47.78084924630819, 17.010101214051218, 16.821557401679442, 1.364864431321621, 62.49244418554008, 58.02146406844258, 59.822682386264205, 24.941822938621044, 51.008024184033246, 36.11169526167214, 37.772522220795494, 14.965691074728937, 32.505376249551745, 48.5016410946846, 25.438391899690004, 31.998920008540154, 34.22590850293636, 13.86639159172772, 28.57443417608738, 15.345767930150018, 27.41528821922836, 37.64282925426957, 62.120868967846036, 27.64116122573614, 40.3327876590192, 30.93250134587285, 46.96331913024186, 28.647127464413643, 41.98732722178099, 53.164920298382626, 44.856613364070625, 52.98296887427567, 58.2721545025706, 32.88919529318808], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 243, 500, 500, 500, 500, 67, 500, 500, 500, 500, 500, 219, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 38, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [14.302796783546597, 14.685988708903693, 13.750966067115456, -1.53381508092086, -2.3023987213770596, -1.7481340120236126, 11.510188457866505, 11.289895651241139, 10.81498934825261, 11.741998453934983, 12.54964869919543, 11.9436156352361, 5.316225536167622, 5.180350229144096, 5.202263243496418, 15.652334580818803, 15.81684101621309, 15.274815897146851, 8.23155589401722, 8.875369541347027, 8.297746777534485, 6.379894937078149, 6.467494095365197, 6.869561338486761, 10.149344260493905, 10.046477968494088, 9.7055949072043, 5.996018461883068, 5.948055945336819, 6.060926280915737, 1.010092327992112, 1.5568537811438148, 1.1887679795424049, 2.7313473423321994, 2.270969485243157, 2.5287221719821247, 4.213710678120449, 4.2290468414624485, 4.137350608905152, 6.626379176974297, 6.470722019672394, 6.880401339381933, 11.310302972793579, 11.231136158108711, 10.971505925059319, -2.3471254060665814, -1.8386289055148808, -2.2125764886538235, 10.809314906597137, 10.94578406214714, 11.852861646562815, 9.868177672227219, 10.176986133058861, 10.256305833657578, 9.205669141064078, 8.756194109717995, 8.468350167075783, 9.782703017195061, 9.895506297548607, 9.96951813002427, -89.91499571998915, -99.1290369530519, -88.56867146616182, 9.398666928211838, 9.822677383820206, 10.58271677295366, 15.174039974808693, 14.987756982445717, 15.36785339936614, 21.766978901034832, 21.49063059190908, 21.08683073023954, 13.469572241107613, 13.902628781894833, 13.619688699642808, -100.41996160894632, -101.85912555456161, -120.22615766525269, 12.803396751483277, 13.120194954176739, 13.39848787647982, 10.58844730102767, 10.150654104848698, 9.84585267802079, 2.240643988673881, 1.7462847878535541, 1.9659747680028232, 12.286789931356907, 12.507978521287441, 12.50605921447277, 9.462923665841416, 8.82744926710923, 8.848457520206765, -82.06046974162261, -92.21833152572314, -81.59993268425266, 4.709635708481073, 4.5050353333354, 4.385241732001305, 8.009985794623688, 8.02430223425229, 8.784931048129991, 17.081609560797602, 17.04094900439182, 16.974647442499787, 10.050215909878403, 10.190907123188168, 10.116762335101754, 9.355675647656113, 9.267529318730027, 9.024001652995736, 16.405160941183567, 15.510975301265717, 16.401293009519577, 14.845408082008362, 14.738036647439003, 15.088395925238729, 2.7470187594493183, 3.137620851242289, 2.6861846198638233, 6.339561839898423, 6.2691997488339695, 6.530724739034966, 14.453083066890628, 14.196756216386945, 14.123437474171311, 12.786356040587023, 12.184170817335442, 12.279171382387474, 3.776530919751764, 3.3916009689370696, 3.4967299650112693, 19.38021260003248, 19.549737373987824, 19.693412544826657, 12.881436144312218, 13.175210153063134, 12.492733021577195, 14.075097113847733, 13.36537678539753, 14.357178078964353, 15.815497055649757, 15.855851300060749, 15.5434829890728, 11.737277721365288, 11.8818550457557, 12.230984856684998, 14.428884819149971, 14.207706063985825, 14.640495873987675, 11.883265639344842, 11.213278139630944, 11.928150768081338, 13.045715544372797, 12.89144991338253, 12.770422607660294, -100.19270777205627, -115.05172602335612, -100.01344020913045, 11.814177716771752, 11.396236504117638, 11.730652163426072, 7.0244308287898605, 7.175678993264825, 7.466349807257444, 13.947033580392599, 13.63786642998457, 13.666426628828049, 19.042100496590137, 19.517101170495152, 19.041977114975452, 7.809033744037151, 7.0299389362335205, 7.345695361495018, 0.081614161531121, -0.26415305336317374, 0.6139131320329909, 14.74203036725521, 15.25059973448515, 15.299128755927086, 12.864203549921513, 12.721623167395592, 13.25816985592246, 11.514822755008936, 11.360041469335556, 11.488351605832577, -116.24576922257742, -102.43868957956633, -102.20997165640196, 12.30442016323407, 12.789930877586201, 12.886353646715477, 12.498949599762753, 12.490569857259587, 12.319604476292923, 11.436029779414326, 11.721247834774346, 11.42520114282766, 16.113972503071025, 15.821481605370835, 15.845395137866333, 5.557047868768365, 5.925834248463303, 5.52721909681955, 5.489957516392067, 5.305127759774521, 6.0264721255128535, 0.4834371879696846, 0.5027831047773361, 0.3786441385746002, 20.614996768534184, 20.84746043384075, 21.029986983165145, 19.152167066931725, 19.578861016780138, 19.29043598473072, 20.095635088160634, 19.9833696000278, 19.74367769807577, 8.234564803540707, 8.265362523496151, 8.441895611584187, 16.520441527167947, 17.083887736002595, 17.403694920862705, 12.064728379249573, 12.310275049880147, 11.73669183254242, 12.662715756120932, 12.59008756310989, 12.519718901564673, 5.181347290674836, 4.8631660739580695, 4.921177710096032, 11.007626163462788, 10.53756013015905, 10.960189955929906, 15.982718124985695, 16.20428729057312, 16.314635679125786, 8.771489795918257, 8.607952206085116, 8.058949897686631, 10.415763102471828, 10.755259703844786, 10.82789720222354, 11.744903445243835, 11.70838151872158, 10.772623538970947, 4.584665497144059, 4.514677350719765, 4.767048743863896, 9.066572099924088, 9.193316608667374, 10.314545467495918, 5.019036819537476, 5.113765140374497, 5.212965970238045, 9.238762913892657, 8.800235355893761, 9.37628994944194, 12.50312230984369, 12.485963548223168, 12.653743396202714, 20.270163014531136, 20.836274966597557, 21.014430986717343, 9.14522173255682, 8.941124513745308, 9.554814979434013, 13.523043936739356, 13.612486126522214, 13.197257595757634, 10.13666448990503, 10.675162429610879, 10.120674426356942, 15.664797035356358, 16.060820539792374, 15.237701555093125, 8.991658344864845, 9.853071115911007, 9.80239800363779, 13.777550178269536, 14.187611601004988, 14.022165442506463, 17.942667930697397, 17.395863329370812, 17.826389038314417, 14.880017759899289, 14.927922795216233, 15.048672808955104, 18.116309208174542, 17.350351487596825, 17.516308178504303, 19.405416692296654, 19.65537208567062, 19.211365724603326, 11.095234510799244, 11.114136857291058, 10.679823925097779]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14505802851256125, "mean_inference_ms": 0.6777699465724241, "mean_action_processing_ms": 0.09887470679932689, "mean_env_wait_ms": 0.828365108975285, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 330000, "timesteps_this_iter": 0, "agent_timesteps_total": 990000, "timers": {"sample_time_ms": 11659.426, "sample_throughput": 428.838, "load_time_ms": 0.1, "load_throughput": 50015549.726, "learn_time_ms": 1658.69, "learn_throughput": 3014.426, "update_time_ms": 7.837}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0005000000000000001, "total_loss": 6.296962547302246, "policy_loss": -0.0025960062454640108, "vf_loss": 6.380401992797852, "vf_explained_var": -0.4887168645858765, "kl": 0.004869854211586158, "entropy": 8.084353828430176, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 330000, "num_agent_steps_sampled": 990000, "num_steps_trained": 330000, "num_agent_steps_trained": 990000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1505, "training_iteration": 66, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-20-54", "timestamp": 1706228454, "time_this_iter_s": 10.537254333496094, "time_total_s": 697.5181255340576, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282306CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 697.5181255340576, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 10.886666666666665, "ram_util_percent": 55.12666666666667}}
{"episode_reward_max": 80.47015759348866, "episode_reward_min": -333.9557865317911, "episode_reward_mean": 11.969117111209187, "episode_len_mean": 477.04, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -120.22615766525269}, "policy_reward_max": {"shared_policy": 27.22214230398336}, "policy_reward_mean": {"shared_policy": 3.989705703736394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.531038999557481, 12.58010812848805, 19.977502536028624, 33.51294505596161, -6.398330800235286, 33.60796061530709, 30.301469638943658, 26.430213417857857, 29.647727444767938, -277.61270413920283, 29.804061084985705, 45.52965035662055, 64.34444022318345, 40.991889722645254, -322.5052448287606, 39.322079582139835, 30.58495408389716, 5.952903544530258, 37.30082766711712, 27.13883045315741, -255.8787339515984, 13.599912773817778, 24.819219077005968, 51.09720600768921, 30.357885368168326, 27.647206619381876, 48.31742925196886, 44.67184065468609, 8.57082423055543, 19.139486327767358, 42.77327675744888, 37.24969824030994, 10.664861853700103, 58.62336251884696, 38.549379318952546, 41.797651978209615, 47.214831344783306, 35.850117623805986, 43.27708675712347, 35.02469454705712, 38.70758806541562, -315.2578740045428, 34.94106638431546, 21.66645962931213, 41.25132663920522, 57.60117878206074, 22.18466804176569, 0.4313742402009382, 45.291758857667446, 38.843996573239565, 34.36321583017707, -320.8944304585457, 37.98070468753575, 37.30912393331526, 34.58247875701633, 47.78084924630819, 17.010101214051218, 16.821557401679442, 1.364864431321621, 62.49244418554008, 58.02146406844258, 59.822682386264205, 24.941822938621044, 51.008024184033246, 36.11169526167214, 37.772522220795494, 14.965691074728937, 32.505376249551745, 48.5016410946846, 25.438391899690004, 31.998920008540154, 34.22590850293636, 13.86639159172772, 28.57443417608738, 15.345767930150018, 27.41528821922836, 37.64282925426957, 62.120868967846036, 27.64116122573614, 40.3327876590192, 30.93250134587285, 46.96331913024186, 28.647127464413643, 41.98732722178099, 53.164920298382626, 44.856613364070625, 52.98296887427567, 58.2721545025706, 32.88919529318808, 46.42111031711099, 80.47015759348866, 51.17703098058698, -252.88157315179706, 28.529302697395906, 27.405109032988534, 45.74528683349489, -333.9557865317911, 50.61886852979657, 36.80749586666934, 51.742900020442875], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 243, 500, 500, 500, 500, 67, 500, 500, 500, 500, 500, 219, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 38, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 476, 500, 500, 500, 98, 500, 500, 500], "policy_shared_policy_reward": [2.7313473423321994, 2.270969485243157, 2.5287221719821247, 4.213710678120449, 4.2290468414624485, 4.137350608905152, 6.626379176974297, 6.470722019672394, 6.880401339381933, 11.310302972793579, 11.231136158108711, 10.971505925059319, -2.3471254060665814, -1.8386289055148808, -2.2125764886538235, 10.809314906597137, 10.94578406214714, 11.852861646562815, 9.868177672227219, 10.176986133058861, 10.256305833657578, 9.205669141064078, 8.756194109717995, 8.468350167075783, 9.782703017195061, 9.895506297548607, 9.96951813002427, -89.91499571998915, -99.1290369530519, -88.56867146616182, 9.398666928211838, 9.822677383820206, 10.58271677295366, 15.174039974808693, 14.987756982445717, 15.36785339936614, 21.766978901034832, 21.49063059190908, 21.08683073023954, 13.469572241107613, 13.902628781894833, 13.619688699642808, -100.41996160894632, -101.85912555456161, -120.22615766525269, 12.803396751483277, 13.120194954176739, 13.39848787647982, 10.58844730102767, 10.150654104848698, 9.84585267802079, 2.240643988673881, 1.7462847878535541, 1.9659747680028232, 12.286789931356907, 12.507978521287441, 12.50605921447277, 9.462923665841416, 8.82744926710923, 8.848457520206765, -82.06046974162261, -92.21833152572314, -81.59993268425266, 4.709635708481073, 4.5050353333354, 4.385241732001305, 8.009985794623688, 8.02430223425229, 8.784931048129991, 17.081609560797602, 17.04094900439182, 16.974647442499787, 10.050215909878403, 10.190907123188168, 10.116762335101754, 9.355675647656113, 9.267529318730027, 9.024001652995736, 16.405160941183567, 15.510975301265717, 16.401293009519577, 14.845408082008362, 14.738036647439003, 15.088395925238729, 2.7470187594493183, 3.137620851242289, 2.6861846198638233, 6.339561839898423, 6.2691997488339695, 6.530724739034966, 14.453083066890628, 14.196756216386945, 14.123437474171311, 12.786356040587023, 12.184170817335442, 12.279171382387474, 3.776530919751764, 3.3916009689370696, 3.4967299650112693, 19.38021260003248, 19.549737373987824, 19.693412544826657, 12.881436144312218, 13.175210153063134, 12.492733021577195, 14.075097113847733, 13.36537678539753, 14.357178078964353, 15.815497055649757, 15.855851300060749, 15.5434829890728, 11.737277721365288, 11.8818550457557, 12.230984856684998, 14.428884819149971, 14.207706063985825, 14.640495873987675, 11.883265639344842, 11.213278139630944, 11.928150768081338, 13.045715544372797, 12.89144991338253, 12.770422607660294, -100.19270777205627, -115.05172602335612, -100.01344020913045, 11.814177716771752, 11.396236504117638, 11.730652163426072, 7.0244308287898605, 7.175678993264825, 7.466349807257444, 13.947033580392599, 13.63786642998457, 13.666426628828049, 19.042100496590137, 19.517101170495152, 19.041977114975452, 7.809033744037151, 7.0299389362335205, 7.345695361495018, 0.081614161531121, -0.26415305336317374, 0.6139131320329909, 14.74203036725521, 15.25059973448515, 15.299128755927086, 12.864203549921513, 12.721623167395592, 13.25816985592246, 11.514822755008936, 11.360041469335556, 11.488351605832577, -116.24576922257742, -102.43868957956633, -102.20997165640196, 12.30442016323407, 12.789930877586201, 12.886353646715477, 12.498949599762753, 12.490569857259587, 12.319604476292923, 11.436029779414326, 11.721247834774346, 11.42520114282766, 16.113972503071025, 15.821481605370835, 15.845395137866333, 5.557047868768365, 5.925834248463303, 5.52721909681955, 5.489957516392067, 5.305127759774521, 6.0264721255128535, 0.4834371879696846, 0.5027831047773361, 0.3786441385746002, 20.614996768534184, 20.84746043384075, 21.029986983165145, 19.152167066931725, 19.578861016780138, 19.29043598473072, 20.095635088160634, 19.9833696000278, 19.74367769807577, 8.234564803540707, 8.265362523496151, 8.441895611584187, 16.520441527167947, 17.083887736002595, 17.403694920862705, 12.064728379249573, 12.310275049880147, 11.73669183254242, 12.662715756120932, 12.59008756310989, 12.519718901564673, 5.181347290674836, 4.8631660739580695, 4.921177710096032, 11.007626163462788, 10.53756013015905, 10.960189955929906, 15.982718124985695, 16.20428729057312, 16.314635679125786, 8.771489795918257, 8.607952206085116, 8.058949897686631, 10.415763102471828, 10.755259703844786, 10.82789720222354, 11.744903445243835, 11.70838151872158, 10.772623538970947, 4.584665497144059, 4.514677350719765, 4.767048743863896, 9.066572099924088, 9.193316608667374, 10.314545467495918, 5.019036819537476, 5.113765140374497, 5.212965970238045, 9.238762913892657, 8.800235355893761, 9.37628994944194, 12.50312230984369, 12.485963548223168, 12.653743396202714, 20.270163014531136, 20.836274966597557, 21.014430986717343, 9.14522173255682, 8.941124513745308, 9.554814979434013, 13.523043936739356, 13.612486126522214, 13.197257595757634, 10.13666448990503, 10.675162429610879, 10.120674426356942, 15.664797035356358, 16.060820539792374, 15.237701555093125, 8.991658344864845, 9.853071115911007, 9.80239800363779, 13.777550178269536, 14.187611601004988, 14.022165442506463, 17.942667930697397, 17.395863329370812, 17.826389038314417, 14.880017759899289, 14.927922795216233, 15.048672808955104, 18.116309208174542, 17.350351487596825, 17.516308178504303, 19.405416692296654, 19.65537208567062, 19.211365724603326, 11.095234510799244, 11.114136857291058, 10.679823925097779, 15.564695070187241, 15.920937950412423, 14.935477296511323, 26.739572296539933, 27.22214230398336, 26.50844299296537, 16.82106831173101, 16.944673294822366, 17.4112893740336, -80.22449194515745, -81.47653252879779, -91.18054867784183, 9.224803358316422, 9.835774030303583, 9.468725308775902, 9.22756205623348, 9.276991331328944, 8.90055564542611, 15.544048623492316, 14.965670277674988, 15.235567932327584, -108.23808063318333, -117.795430538555, -107.9222753600528, 16.89248341570297, 16.962502444783837, 16.763882669309766, 11.485473662614822, 12.518290914595127, 12.803731289459392, 17.15009582291046, 17.15878681341806, 17.434017384114355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14528465162493454, "mean_inference_ms": 0.6794261061458614, "mean_action_processing_ms": 0.09904093819198562, "mean_env_wait_ms": 0.8302778300059357, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 335000, "timesteps_this_iter": 0, "agent_timesteps_total": 1005000, "timers": {"sample_time_ms": 11621.306, "sample_throughput": 430.244, "load_time_ms": 0.1, "load_throughput": 50015549.726, "learn_time_ms": 1669.974, "learn_throughput": 2994.059, "update_time_ms": 7.737}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 0.0005000000000000001, "total_loss": 219.75357513427736, "policy_loss": -0.002050059179005537, "vf_loss": 219.83633575439453, "vf_explained_var": -0.00645521879196167, "kl": 0.003399010864098812, "entropy": 8.071836471557617, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 335000, "num_agent_steps_sampled": 1005000, "num_steps_trained": 335000, "num_agent_steps_trained": 1005000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1516, "training_iteration": 67, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-21-05", "timestamp": 1706228465, "time_this_iter_s": 11.131991863250732, "time_total_s": 708.6501173973083, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824B2A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 708.6501173973083, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 11.175, "ram_util_percent": 55.6875}}
{"episode_reward_max": 80.47015759348866, "episode_reward_min": -333.9557865317911, "episode_reward_mean": 16.800964380618524, "episode_len_mean": 479.61, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -120.22615766525269}, "policy_reward_max": {"shared_policy": 27.22214230398336}, "policy_reward_mean": {"shared_policy": 5.600321460206174}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.804061084985705, 45.52965035662055, 64.34444022318345, 40.991889722645254, -322.5052448287606, 39.322079582139835, 30.58495408389716, 5.952903544530258, 37.30082766711712, 27.13883045315741, -255.8787339515984, 13.599912773817778, 24.819219077005968, 51.09720600768921, 30.357885368168326, 27.647206619381876, 48.31742925196886, 44.67184065468609, 8.57082423055543, 19.139486327767358, 42.77327675744888, 37.24969824030994, 10.664861853700103, 58.62336251884696, 38.549379318952546, 41.797651978209615, 47.214831344783306, 35.850117623805986, 43.27708675712347, 35.02469454705712, 38.70758806541562, -315.2578740045428, 34.94106638431546, 21.66645962931213, 41.25132663920522, 57.60117878206074, 22.18466804176569, 0.4313742402009382, 45.291758857667446, 38.843996573239565, 34.36321583017707, -320.8944304585457, 37.98070468753575, 37.30912393331526, 34.58247875701633, 47.78084924630819, 17.010101214051218, 16.821557401679442, 1.364864431321621, 62.49244418554008, 58.02146406844258, 59.822682386264205, 24.941822938621044, 51.008024184033246, 36.11169526167214, 37.772522220795494, 14.965691074728937, 32.505376249551745, 48.5016410946846, 25.438391899690004, 31.998920008540154, 34.22590850293636, 13.86639159172772, 28.57443417608738, 15.345767930150018, 27.41528821922836, 37.64282925426957, 62.120868967846036, 27.64116122573614, 40.3327876590192, 30.93250134587285, 46.96331913024186, 28.647127464413643, 41.98732722178099, 53.164920298382626, 44.856613364070625, 52.98296887427567, 58.2721545025706, 32.88919529318808, 46.42111031711099, 80.47015759348866, 51.17703098058698, -252.88157315179706, 28.529302697395906, 27.405109032988534, 45.74528683349489, -333.9557865317911, 50.61886852979657, 36.80749586666934, 51.742900020442875, 41.22997383028269, 25.6976633891463, 38.184747055172906, 49.50026887981218, 30.836673367768526, 20.222480013966546, 28.086770355701432, 37.038877006620154, 64.2209297157824, 57.74427422415465], "episode_lengths": [500, 500, 500, 500, 67, 500, 500, 500, 500, 500, 219, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 38, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 476, 500, 500, 500, 98, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [9.398666928211838, 9.822677383820206, 10.58271677295366, 15.174039974808693, 14.987756982445717, 15.36785339936614, 21.766978901034832, 21.49063059190908, 21.08683073023954, 13.469572241107613, 13.902628781894833, 13.619688699642808, -100.41996160894632, -101.85912555456161, -120.22615766525269, 12.803396751483277, 13.120194954176739, 13.39848787647982, 10.58844730102767, 10.150654104848698, 9.84585267802079, 2.240643988673881, 1.7462847878535541, 1.9659747680028232, 12.286789931356907, 12.507978521287441, 12.50605921447277, 9.462923665841416, 8.82744926710923, 8.848457520206765, -82.06046974162261, -92.21833152572314, -81.59993268425266, 4.709635708481073, 4.5050353333354, 4.385241732001305, 8.009985794623688, 8.02430223425229, 8.784931048129991, 17.081609560797602, 17.04094900439182, 16.974647442499787, 10.050215909878403, 10.190907123188168, 10.116762335101754, 9.355675647656113, 9.267529318730027, 9.024001652995736, 16.405160941183567, 15.510975301265717, 16.401293009519577, 14.845408082008362, 14.738036647439003, 15.088395925238729, 2.7470187594493183, 3.137620851242289, 2.6861846198638233, 6.339561839898423, 6.2691997488339695, 6.530724739034966, 14.453083066890628, 14.196756216386945, 14.123437474171311, 12.786356040587023, 12.184170817335442, 12.279171382387474, 3.776530919751764, 3.3916009689370696, 3.4967299650112693, 19.38021260003248, 19.549737373987824, 19.693412544826657, 12.881436144312218, 13.175210153063134, 12.492733021577195, 14.075097113847733, 13.36537678539753, 14.357178078964353, 15.815497055649757, 15.855851300060749, 15.5434829890728, 11.737277721365288, 11.8818550457557, 12.230984856684998, 14.428884819149971, 14.207706063985825, 14.640495873987675, 11.883265639344842, 11.213278139630944, 11.928150768081338, 13.045715544372797, 12.89144991338253, 12.770422607660294, -100.19270777205627, -115.05172602335612, -100.01344020913045, 11.814177716771752, 11.396236504117638, 11.730652163426072, 7.0244308287898605, 7.175678993264825, 7.466349807257444, 13.947033580392599, 13.63786642998457, 13.666426628828049, 19.042100496590137, 19.517101170495152, 19.041977114975452, 7.809033744037151, 7.0299389362335205, 7.345695361495018, 0.081614161531121, -0.26415305336317374, 0.6139131320329909, 14.74203036725521, 15.25059973448515, 15.299128755927086, 12.864203549921513, 12.721623167395592, 13.25816985592246, 11.514822755008936, 11.360041469335556, 11.488351605832577, -116.24576922257742, -102.43868957956633, -102.20997165640196, 12.30442016323407, 12.789930877586201, 12.886353646715477, 12.498949599762753, 12.490569857259587, 12.319604476292923, 11.436029779414326, 11.721247834774346, 11.42520114282766, 16.113972503071025, 15.821481605370835, 15.845395137866333, 5.557047868768365, 5.925834248463303, 5.52721909681955, 5.489957516392067, 5.305127759774521, 6.0264721255128535, 0.4834371879696846, 0.5027831047773361, 0.3786441385746002, 20.614996768534184, 20.84746043384075, 21.029986983165145, 19.152167066931725, 19.578861016780138, 19.29043598473072, 20.095635088160634, 19.9833696000278, 19.74367769807577, 8.234564803540707, 8.265362523496151, 8.441895611584187, 16.520441527167947, 17.083887736002595, 17.403694920862705, 12.064728379249573, 12.310275049880147, 11.73669183254242, 12.662715756120932, 12.59008756310989, 12.519718901564673, 5.181347290674836, 4.8631660739580695, 4.921177710096032, 11.007626163462788, 10.53756013015905, 10.960189955929906, 15.982718124985695, 16.20428729057312, 16.314635679125786, 8.771489795918257, 8.607952206085116, 8.058949897686631, 10.415763102471828, 10.755259703844786, 10.82789720222354, 11.744903445243835, 11.70838151872158, 10.772623538970947, 4.584665497144059, 4.514677350719765, 4.767048743863896, 9.066572099924088, 9.193316608667374, 10.314545467495918, 5.019036819537476, 5.113765140374497, 5.212965970238045, 9.238762913892657, 8.800235355893761, 9.37628994944194, 12.50312230984369, 12.485963548223168, 12.653743396202714, 20.270163014531136, 20.836274966597557, 21.014430986717343, 9.14522173255682, 8.941124513745308, 9.554814979434013, 13.523043936739356, 13.612486126522214, 13.197257595757634, 10.13666448990503, 10.675162429610879, 10.120674426356942, 15.664797035356358, 16.060820539792374, 15.237701555093125, 8.991658344864845, 9.853071115911007, 9.80239800363779, 13.777550178269536, 14.187611601004988, 14.022165442506463, 17.942667930697397, 17.395863329370812, 17.826389038314417, 14.880017759899289, 14.927922795216233, 15.048672808955104, 18.116309208174542, 17.350351487596825, 17.516308178504303, 19.405416692296654, 19.65537208567062, 19.211365724603326, 11.095234510799244, 11.114136857291058, 10.679823925097779, 15.564695070187241, 15.920937950412423, 14.935477296511323, 26.739572296539933, 27.22214230398336, 26.50844299296537, 16.82106831173101, 16.944673294822366, 17.4112893740336, -80.22449194515745, -81.47653252879779, -91.18054867784183, 9.224803358316422, 9.835774030303583, 9.468725308775902, 9.22756205623348, 9.276991331328944, 8.90055564542611, 15.544048623492316, 14.965670277674988, 15.235567932327584, -108.23808063318333, -117.795430538555, -107.9222753600528, 16.89248341570297, 16.962502444783837, 16.763882669309766, 11.485473662614822, 12.518290914595127, 12.803731289459392, 17.15009582291046, 17.15878681341806, 17.434017384114355, 13.69286709278822, 13.458493173122406, 14.078613564372063, 8.21692409614721, 8.496113742391259, 8.98462555060783, 12.919805457194641, 12.722208124895886, 12.542733473082379, 16.73751254581535, 16.65606679643193, 16.106689537564904, 10.302186734974384, 10.300045493990183, 10.234441138803959, 6.76026303817828, 6.733806324501828, 6.728410651286438, 9.297484268744782, 9.423604288448885, 9.365681798507765, 12.162507404883698, 12.159930621584252, 12.716438980152205, 21.633066352456808, 21.447148233652115, 21.14071512967348, 19.54441978316754, 19.01752746850252, 19.18232697248459]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14550815029362046, "mean_inference_ms": 0.6808270424437717, "mean_action_processing_ms": 0.099233282589191, "mean_env_wait_ms": 0.8319107427306917, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 340000, "timesteps_this_iter": 0, "agent_timesteps_total": 1020000, "timers": {"sample_time_ms": 11650.527, "sample_throughput": 429.165, "load_time_ms": 0.1, "load_throughput": 50015549.726, "learn_time_ms": 1681.239, "learn_throughput": 2973.997, "update_time_ms": 8.334}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 0.0005000000000000001, "total_loss": 6.184727621078491, "policy_loss": -0.002198976106702677, "vf_loss": 6.268558597564697, "vf_explained_var": -0.33332550525665283, "kl": 0.003645540383889698, "entropy": 8.163206672668457, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 340000, "num_agent_steps_sampled": 1020000, "num_steps_trained": 340000, "num_agent_steps_trained": 1020000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1526, "training_iteration": 68, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-21-16", "timestamp": 1706228476, "time_this_iter_s": 11.28452205657959, "time_total_s": 719.9346394538879, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028227AAF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 719.9346394538879, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 11.99375, "ram_util_percent": 54.9375}}
{"episode_reward_max": 80.47015759348866, "episode_reward_min": -333.9557865317911, "episode_reward_mean": 21.009202468930148, "episode_len_mean": 483.94, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -117.795430538555}, "policy_reward_max": {"shared_policy": 27.22214230398336}, "policy_reward_mean": {"shared_policy": 7.0030674896433815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-255.8787339515984, 13.599912773817778, 24.819219077005968, 51.09720600768921, 30.357885368168326, 27.647206619381876, 48.31742925196886, 44.67184065468609, 8.57082423055543, 19.139486327767358, 42.77327675744888, 37.24969824030994, 10.664861853700103, 58.62336251884696, 38.549379318952546, 41.797651978209615, 47.214831344783306, 35.850117623805986, 43.27708675712347, 35.02469454705712, 38.70758806541562, -315.2578740045428, 34.94106638431546, 21.66645962931213, 41.25132663920522, 57.60117878206074, 22.18466804176569, 0.4313742402009382, 45.291758857667446, 38.843996573239565, 34.36321583017707, -320.8944304585457, 37.98070468753575, 37.30912393331526, 34.58247875701633, 47.78084924630819, 17.010101214051218, 16.821557401679442, 1.364864431321621, 62.49244418554008, 58.02146406844258, 59.822682386264205, 24.941822938621044, 51.008024184033246, 36.11169526167214, 37.772522220795494, 14.965691074728937, 32.505376249551745, 48.5016410946846, 25.438391899690004, 31.998920008540154, 34.22590850293636, 13.86639159172772, 28.57443417608738, 15.345767930150018, 27.41528821922836, 37.64282925426957, 62.120868967846036, 27.64116122573614, 40.3327876590192, 30.93250134587285, 46.96331913024186, 28.647127464413643, 41.98732722178099, 53.164920298382626, 44.856613364070625, 52.98296887427567, 58.2721545025706, 32.88919529318808, 46.42111031711099, 80.47015759348866, 51.17703098058698, -252.88157315179706, 28.529302697395906, 27.405109032988534, 45.74528683349489, -333.9557865317911, 50.61886852979657, 36.80749586666934, 51.742900020442875, 41.22997383028269, 25.6976633891463, 38.184747055172906, 49.50026887981218, 30.836673367768526, 20.222480013966546, 28.086770355701432, 37.038877006620154, 64.2209297157824, 57.74427422415465, 38.543405435979366, 24.06707595661281, 65.68926971033213, 67.94063475728034, 38.40267070010303, 56.60655389726159, 15.951185941696167, 20.63691933033985, 37.98645042255518, 53.464034568518386], "episode_lengths": [219, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 38, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 476, 500, 500, 500, 98, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-82.06046974162261, -92.21833152572314, -81.59993268425266, 4.709635708481073, 4.5050353333354, 4.385241732001305, 8.009985794623688, 8.02430223425229, 8.784931048129991, 17.081609560797602, 17.04094900439182, 16.974647442499787, 10.050215909878403, 10.190907123188168, 10.116762335101754, 9.355675647656113, 9.267529318730027, 9.024001652995736, 16.405160941183567, 15.510975301265717, 16.401293009519577, 14.845408082008362, 14.738036647439003, 15.088395925238729, 2.7470187594493183, 3.137620851242289, 2.6861846198638233, 6.339561839898423, 6.2691997488339695, 6.530724739034966, 14.453083066890628, 14.196756216386945, 14.123437474171311, 12.786356040587023, 12.184170817335442, 12.279171382387474, 3.776530919751764, 3.3916009689370696, 3.4967299650112693, 19.38021260003248, 19.549737373987824, 19.693412544826657, 12.881436144312218, 13.175210153063134, 12.492733021577195, 14.075097113847733, 13.36537678539753, 14.357178078964353, 15.815497055649757, 15.855851300060749, 15.5434829890728, 11.737277721365288, 11.8818550457557, 12.230984856684998, 14.428884819149971, 14.207706063985825, 14.640495873987675, 11.883265639344842, 11.213278139630944, 11.928150768081338, 13.045715544372797, 12.89144991338253, 12.770422607660294, -100.19270777205627, -115.05172602335612, -100.01344020913045, 11.814177716771752, 11.396236504117638, 11.730652163426072, 7.0244308287898605, 7.175678993264825, 7.466349807257444, 13.947033580392599, 13.63786642998457, 13.666426628828049, 19.042100496590137, 19.517101170495152, 19.041977114975452, 7.809033744037151, 7.0299389362335205, 7.345695361495018, 0.081614161531121, -0.26415305336317374, 0.6139131320329909, 14.74203036725521, 15.25059973448515, 15.299128755927086, 12.864203549921513, 12.721623167395592, 13.25816985592246, 11.514822755008936, 11.360041469335556, 11.488351605832577, -116.24576922257742, -102.43868957956633, -102.20997165640196, 12.30442016323407, 12.789930877586201, 12.886353646715477, 12.498949599762753, 12.490569857259587, 12.319604476292923, 11.436029779414326, 11.721247834774346, 11.42520114282766, 16.113972503071025, 15.821481605370835, 15.845395137866333, 5.557047868768365, 5.925834248463303, 5.52721909681955, 5.489957516392067, 5.305127759774521, 6.0264721255128535, 0.4834371879696846, 0.5027831047773361, 0.3786441385746002, 20.614996768534184, 20.84746043384075, 21.029986983165145, 19.152167066931725, 19.578861016780138, 19.29043598473072, 20.095635088160634, 19.9833696000278, 19.74367769807577, 8.234564803540707, 8.265362523496151, 8.441895611584187, 16.520441527167947, 17.083887736002595, 17.403694920862705, 12.064728379249573, 12.310275049880147, 11.73669183254242, 12.662715756120932, 12.59008756310989, 12.519718901564673, 5.181347290674836, 4.8631660739580695, 4.921177710096032, 11.007626163462788, 10.53756013015905, 10.960189955929906, 15.982718124985695, 16.20428729057312, 16.314635679125786, 8.771489795918257, 8.607952206085116, 8.058949897686631, 10.415763102471828, 10.755259703844786, 10.82789720222354, 11.744903445243835, 11.70838151872158, 10.772623538970947, 4.584665497144059, 4.514677350719765, 4.767048743863896, 9.066572099924088, 9.193316608667374, 10.314545467495918, 5.019036819537476, 5.113765140374497, 5.212965970238045, 9.238762913892657, 8.800235355893761, 9.37628994944194, 12.50312230984369, 12.485963548223168, 12.653743396202714, 20.270163014531136, 20.836274966597557, 21.014430986717343, 9.14522173255682, 8.941124513745308, 9.554814979434013, 13.523043936739356, 13.612486126522214, 13.197257595757634, 10.13666448990503, 10.675162429610879, 10.120674426356942, 15.664797035356358, 16.060820539792374, 15.237701555093125, 8.991658344864845, 9.853071115911007, 9.80239800363779, 13.777550178269536, 14.187611601004988, 14.022165442506463, 17.942667930697397, 17.395863329370812, 17.826389038314417, 14.880017759899289, 14.927922795216233, 15.048672808955104, 18.116309208174542, 17.350351487596825, 17.516308178504303, 19.405416692296654, 19.65537208567062, 19.211365724603326, 11.095234510799244, 11.114136857291058, 10.679823925097779, 15.564695070187241, 15.920937950412423, 14.935477296511323, 26.739572296539933, 27.22214230398336, 26.50844299296537, 16.82106831173101, 16.944673294822366, 17.4112893740336, -80.22449194515745, -81.47653252879779, -91.18054867784183, 9.224803358316422, 9.835774030303583, 9.468725308775902, 9.22756205623348, 9.276991331328944, 8.90055564542611, 15.544048623492316, 14.965670277674988, 15.235567932327584, -108.23808063318333, -117.795430538555, -107.9222753600528, 16.89248341570297, 16.962502444783837, 16.763882669309766, 11.485473662614822, 12.518290914595127, 12.803731289459392, 17.15009582291046, 17.15878681341806, 17.434017384114355, 13.69286709278822, 13.458493173122406, 14.078613564372063, 8.21692409614721, 8.496113742391259, 8.98462555060783, 12.919805457194641, 12.722208124895886, 12.542733473082379, 16.73751254581535, 16.65606679643193, 16.106689537564904, 10.302186734974384, 10.300045493990183, 10.234441138803959, 6.76026303817828, 6.733806324501828, 6.728410651286438, 9.297484268744782, 9.423604288448885, 9.365681798507765, 12.162507404883698, 12.159930621584252, 12.716438980152205, 21.633066352456808, 21.447148233652115, 21.14071512967348, 19.54441978316754, 19.01752746850252, 19.18232697248459, 12.89388532936573, 12.86028641462326, 12.789233691990376, 7.931615454455212, 8.297546082486704, 7.837914419670895, 21.888049783805997, 21.924354730794818, 21.876865195731312, 22.743918289740876, 22.1122608979543, 23.08445556958516, 12.265473400553063, 13.119271659602717, 13.01792563994725, 18.862976665298135, 18.870928371946007, 18.87264886001745, 5.401897445321083, 5.171361543238163, 5.377926953136921, 7.0831193017462795, 7.287036316624523, 6.266763711969048, 12.610619379828364, 12.7783179792265, 12.597513063500315, 17.91618865480025, 17.460687985022858, 18.087157928695277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1455799310959594, "mean_inference_ms": 0.6819217108598916, "mean_action_processing_ms": 0.09938058510626852, "mean_env_wait_ms": 0.833367665559304, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 345000, "timesteps_this_iter": 0, "agent_timesteps_total": 1035000, "timers": {"sample_time_ms": 11545.529, "sample_throughput": 433.068, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1677.899, "learn_throughput": 2979.917, "update_time_ms": 8.283}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0005000000000000001, "total_loss": 5.527965879440307, "policy_loss": -0.0028859166339566754, "vf_loss": 5.612967920303345, "vf_explained_var": -0.31425745487213136, "kl": 0.003766383117194097, "entropy": 8.211599731445313, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 345000, "num_agent_steps_sampled": 1035000, "num_steps_trained": 345000, "num_agent_steps_trained": 1035000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1536, "training_iteration": 69, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-21-28", "timestamp": 1706228488, "time_this_iter_s": 11.069644212722778, "time_total_s": 731.0042836666107, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028458FCA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 731.0042836666107, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 11.631250000000001, "ram_util_percent": 54.95}}
{"episode_reward_max": 80.47015759348866, "episode_reward_min": -333.9557865317911, "episode_reward_mean": 25.12496518933155, "episode_len_mean": 486.75, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -117.795430538555}, "policy_reward_max": {"shared_policy": 27.22214230398336}, "policy_reward_mean": {"shared_policy": 8.374988396443847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.77327675744888, 37.24969824030994, 10.664861853700103, 58.62336251884696, 38.549379318952546, 41.797651978209615, 47.214831344783306, 35.850117623805986, 43.27708675712347, 35.02469454705712, 38.70758806541562, -315.2578740045428, 34.94106638431546, 21.66645962931213, 41.25132663920522, 57.60117878206074, 22.18466804176569, 0.4313742402009382, 45.291758857667446, 38.843996573239565, 34.36321583017707, -320.8944304585457, 37.98070468753575, 37.30912393331526, 34.58247875701633, 47.78084924630819, 17.010101214051218, 16.821557401679442, 1.364864431321621, 62.49244418554008, 58.02146406844258, 59.822682386264205, 24.941822938621044, 51.008024184033246, 36.11169526167214, 37.772522220795494, 14.965691074728937, 32.505376249551745, 48.5016410946846, 25.438391899690004, 31.998920008540154, 34.22590850293636, 13.86639159172772, 28.57443417608738, 15.345767930150018, 27.41528821922836, 37.64282925426957, 62.120868967846036, 27.64116122573614, 40.3327876590192, 30.93250134587285, 46.96331913024186, 28.647127464413643, 41.98732722178099, 53.164920298382626, 44.856613364070625, 52.98296887427567, 58.2721545025706, 32.88919529318808, 46.42111031711099, 80.47015759348866, 51.17703098058698, -252.88157315179706, 28.529302697395906, 27.405109032988534, 45.74528683349489, -333.9557865317911, 50.61886852979657, 36.80749586666934, 51.742900020442875, 41.22997383028269, 25.6976633891463, 38.184747055172906, 49.50026887981218, 30.836673367768526, 20.222480013966546, 28.086770355701432, 37.038877006620154, 64.2209297157824, 57.74427422415465, 38.543405435979366, 24.06707595661281, 65.68926971033213, 67.94063475728034, 38.40267070010303, 56.60655389726159, 15.951185941696167, 20.63691933033985, 37.98645042255518, 53.464034568518386, 69.65765576064587, 49.57234625332056, 51.32656567543742, 42.647960111498804, 53.90916645713149, 30.747764967381954, 26.884671358391643, 48.39659471809864, 24.44545689225197, 26.330366205424056], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 38, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 476, 500, 500, 500, 98, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [14.453083066890628, 14.196756216386945, 14.123437474171311, 12.786356040587023, 12.184170817335442, 12.279171382387474, 3.776530919751764, 3.3916009689370696, 3.4967299650112693, 19.38021260003248, 19.549737373987824, 19.693412544826657, 12.881436144312218, 13.175210153063134, 12.492733021577195, 14.075097113847733, 13.36537678539753, 14.357178078964353, 15.815497055649757, 15.855851300060749, 15.5434829890728, 11.737277721365288, 11.8818550457557, 12.230984856684998, 14.428884819149971, 14.207706063985825, 14.640495873987675, 11.883265639344842, 11.213278139630944, 11.928150768081338, 13.045715544372797, 12.89144991338253, 12.770422607660294, -100.19270777205627, -115.05172602335612, -100.01344020913045, 11.814177716771752, 11.396236504117638, 11.730652163426072, 7.0244308287898605, 7.175678993264825, 7.466349807257444, 13.947033580392599, 13.63786642998457, 13.666426628828049, 19.042100496590137, 19.517101170495152, 19.041977114975452, 7.809033744037151, 7.0299389362335205, 7.345695361495018, 0.081614161531121, -0.26415305336317374, 0.6139131320329909, 14.74203036725521, 15.25059973448515, 15.299128755927086, 12.864203549921513, 12.721623167395592, 13.25816985592246, 11.514822755008936, 11.360041469335556, 11.488351605832577, -116.24576922257742, -102.43868957956633, -102.20997165640196, 12.30442016323407, 12.789930877586201, 12.886353646715477, 12.498949599762753, 12.490569857259587, 12.319604476292923, 11.436029779414326, 11.721247834774346, 11.42520114282766, 16.113972503071025, 15.821481605370835, 15.845395137866333, 5.557047868768365, 5.925834248463303, 5.52721909681955, 5.489957516392067, 5.305127759774521, 6.0264721255128535, 0.4834371879696846, 0.5027831047773361, 0.3786441385746002, 20.614996768534184, 20.84746043384075, 21.029986983165145, 19.152167066931725, 19.578861016780138, 19.29043598473072, 20.095635088160634, 19.9833696000278, 19.74367769807577, 8.234564803540707, 8.265362523496151, 8.441895611584187, 16.520441527167947, 17.083887736002595, 17.403694920862705, 12.064728379249573, 12.310275049880147, 11.73669183254242, 12.662715756120932, 12.59008756310989, 12.519718901564673, 5.181347290674836, 4.8631660739580695, 4.921177710096032, 11.007626163462788, 10.53756013015905, 10.960189955929906, 15.982718124985695, 16.20428729057312, 16.314635679125786, 8.771489795918257, 8.607952206085116, 8.058949897686631, 10.415763102471828, 10.755259703844786, 10.82789720222354, 11.744903445243835, 11.70838151872158, 10.772623538970947, 4.584665497144059, 4.514677350719765, 4.767048743863896, 9.066572099924088, 9.193316608667374, 10.314545467495918, 5.019036819537476, 5.113765140374497, 5.212965970238045, 9.238762913892657, 8.800235355893761, 9.37628994944194, 12.50312230984369, 12.485963548223168, 12.653743396202714, 20.270163014531136, 20.836274966597557, 21.014430986717343, 9.14522173255682, 8.941124513745308, 9.554814979434013, 13.523043936739356, 13.612486126522214, 13.197257595757634, 10.13666448990503, 10.675162429610879, 10.120674426356942, 15.664797035356358, 16.060820539792374, 15.237701555093125, 8.991658344864845, 9.853071115911007, 9.80239800363779, 13.777550178269536, 14.187611601004988, 14.022165442506463, 17.942667930697397, 17.395863329370812, 17.826389038314417, 14.880017759899289, 14.927922795216233, 15.048672808955104, 18.116309208174542, 17.350351487596825, 17.516308178504303, 19.405416692296654, 19.65537208567062, 19.211365724603326, 11.095234510799244, 11.114136857291058, 10.679823925097779, 15.564695070187241, 15.920937950412423, 14.935477296511323, 26.739572296539933, 27.22214230398336, 26.50844299296537, 16.82106831173101, 16.944673294822366, 17.4112893740336, -80.22449194515745, -81.47653252879779, -91.18054867784183, 9.224803358316422, 9.835774030303583, 9.468725308775902, 9.22756205623348, 9.276991331328944, 8.90055564542611, 15.544048623492316, 14.965670277674988, 15.235567932327584, -108.23808063318333, -117.795430538555, -107.9222753600528, 16.89248341570297, 16.962502444783837, 16.763882669309766, 11.485473662614822, 12.518290914595127, 12.803731289459392, 17.15009582291046, 17.15878681341806, 17.434017384114355, 13.69286709278822, 13.458493173122406, 14.078613564372063, 8.21692409614721, 8.496113742391259, 8.98462555060783, 12.919805457194641, 12.722208124895886, 12.542733473082379, 16.73751254581535, 16.65606679643193, 16.106689537564904, 10.302186734974384, 10.300045493990183, 10.234441138803959, 6.76026303817828, 6.733806324501828, 6.728410651286438, 9.297484268744782, 9.423604288448885, 9.365681798507765, 12.162507404883698, 12.159930621584252, 12.716438980152205, 21.633066352456808, 21.447148233652115, 21.14071512967348, 19.54441978316754, 19.01752746850252, 19.18232697248459, 12.89388532936573, 12.86028641462326, 12.789233691990376, 7.931615454455212, 8.297546082486704, 7.837914419670895, 21.888049783805997, 21.924354730794818, 21.876865195731312, 22.743918289740876, 22.1122608979543, 23.08445556958516, 12.265473400553063, 13.119271659602717, 13.01792563994725, 18.862976665298135, 18.870928371946007, 18.87264886001745, 5.401897445321083, 5.171361543238163, 5.377926953136921, 7.0831193017462795, 7.287036316624523, 6.266763711969048, 12.610619379828364, 12.7783179792265, 12.597513063500315, 17.91618865480025, 17.460687985022858, 18.087157928695277, 23.506420984864235, 23.196823805570602, 22.95441097021103, 16.327857752641037, 16.443786700566605, 16.80070180011292, 17.178524809579045, 17.007138806084782, 17.140902059773595, 14.68722368280092, 13.905007417003304, 14.05572901169458, 17.96999905010064, 18.30516450790067, 17.63400289913018, 10.227147825062275, 10.196824073791504, 10.323793068528175, 8.551747485995293, 8.746880203485489, 9.586043668910861, 16.081180214881897, 16.369254231452942, 15.946160271763802, 8.236644327640533, 8.237536385655403, 7.971276178956032, 8.665265445907906, 8.644340862830475, 9.020759896685675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14568216431726577, "mean_inference_ms": 0.6829655414189003, "mean_action_processing_ms": 0.09951467989139054, "mean_env_wait_ms": 0.8347358039709633, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 350000, "timesteps_this_iter": 0, "agent_timesteps_total": 1050000, "timers": {"sample_time_ms": 11433.026, "sample_throughput": 437.33, "load_time_ms": 0.101, "load_throughput": 49636733.728, "learn_time_ms": 1669.77, "learn_throughput": 2994.424, "update_time_ms": 8.282}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.552713678800501e-16, "cur_lr": 0.0005000000000000001, "total_loss": 8.3304292678833, "policy_loss": -0.002965419078103082, "vf_loss": 8.414874601364136, "vf_explained_var": -0.34416109323501587, "kl": 0.0032280948115057232, "entropy": 8.147990417480468, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 350000, "num_agent_steps_sampled": 1050000, "num_steps_trained": 350000, "num_agent_steps_trained": 1050000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1546, "training_iteration": 70, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-21-38", "timestamp": 1706228498, "time_this_iter_s": 10.80429220199585, "time_total_s": 741.8085758686066, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282575820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 741.8085758686066, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 11.54, "ram_util_percent": 54.86}}
{"episode_reward_max": 80.47015759348866, "episode_reward_min": -333.9557865317911, "episode_reward_mean": 23.88094182516855, "episode_len_mean": 485.99, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -117.795430538555}, "policy_reward_max": {"shared_policy": 27.22214230398336}, "policy_reward_mean": {"shared_policy": 7.960313941722846}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.70758806541562, -315.2578740045428, 34.94106638431546, 21.66645962931213, 41.25132663920522, 57.60117878206074, 22.18466804176569, 0.4313742402009382, 45.291758857667446, 38.843996573239565, 34.36321583017707, -320.8944304585457, 37.98070468753575, 37.30912393331526, 34.58247875701633, 47.78084924630819, 17.010101214051218, 16.821557401679442, 1.364864431321621, 62.49244418554008, 58.02146406844258, 59.822682386264205, 24.941822938621044, 51.008024184033246, 36.11169526167214, 37.772522220795494, 14.965691074728937, 32.505376249551745, 48.5016410946846, 25.438391899690004, 31.998920008540154, 34.22590850293636, 13.86639159172772, 28.57443417608738, 15.345767930150018, 27.41528821922836, 37.64282925426957, 62.120868967846036, 27.64116122573614, 40.3327876590192, 30.93250134587285, 46.96331913024186, 28.647127464413643, 41.98732722178099, 53.164920298382626, 44.856613364070625, 52.98296887427567, 58.2721545025706, 32.88919529318808, 46.42111031711099, 80.47015759348866, 51.17703098058698, -252.88157315179706, 28.529302697395906, 27.405109032988534, 45.74528683349489, -333.9557865317911, 50.61886852979657, 36.80749586666934, 51.742900020442875, 41.22997383028269, 25.6976633891463, 38.184747055172906, 49.50026887981218, 30.836673367768526, 20.222480013966546, 28.086770355701432, 37.038877006620154, 64.2209297157824, 57.74427422415465, 38.543405435979366, 24.06707595661281, 65.68926971033213, 67.94063475728034, 38.40267070010303, 56.60655389726159, 15.951185941696167, 20.63691933033985, 37.98645042255518, 53.464034568518386, 69.65765576064587, 49.57234625332056, 51.32656567543742, 42.647960111498804, 53.90916645713149, 30.747764967381954, 26.884671358391643, 48.39659471809864, 24.44545689225197, 26.330366205424056, 78.49337562173602, 43.519068799912915, 77.86236525326966, -266.05314495414495, 59.42798769474028, 56.43243495747447, 71.2728435061872, 60.39466104283929, 26.829338364303084, 58.443694237619624], "episode_lengths": [500, 63, 500, 500, 500, 500, 500, 500, 500, 500, 500, 38, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 476, 500, 500, 500, 98, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 424, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [13.045715544372797, 12.89144991338253, 12.770422607660294, -100.19270777205627, -115.05172602335612, -100.01344020913045, 11.814177716771752, 11.396236504117638, 11.730652163426072, 7.0244308287898605, 7.175678993264825, 7.466349807257444, 13.947033580392599, 13.63786642998457, 13.666426628828049, 19.042100496590137, 19.517101170495152, 19.041977114975452, 7.809033744037151, 7.0299389362335205, 7.345695361495018, 0.081614161531121, -0.26415305336317374, 0.6139131320329909, 14.74203036725521, 15.25059973448515, 15.299128755927086, 12.864203549921513, 12.721623167395592, 13.25816985592246, 11.514822755008936, 11.360041469335556, 11.488351605832577, -116.24576922257742, -102.43868957956633, -102.20997165640196, 12.30442016323407, 12.789930877586201, 12.886353646715477, 12.498949599762753, 12.490569857259587, 12.319604476292923, 11.436029779414326, 11.721247834774346, 11.42520114282766, 16.113972503071025, 15.821481605370835, 15.845395137866333, 5.557047868768365, 5.925834248463303, 5.52721909681955, 5.489957516392067, 5.305127759774521, 6.0264721255128535, 0.4834371879696846, 0.5027831047773361, 0.3786441385746002, 20.614996768534184, 20.84746043384075, 21.029986983165145, 19.152167066931725, 19.578861016780138, 19.29043598473072, 20.095635088160634, 19.9833696000278, 19.74367769807577, 8.234564803540707, 8.265362523496151, 8.441895611584187, 16.520441527167947, 17.083887736002595, 17.403694920862705, 12.064728379249573, 12.310275049880147, 11.73669183254242, 12.662715756120932, 12.59008756310989, 12.519718901564673, 5.181347290674836, 4.8631660739580695, 4.921177710096032, 11.007626163462788, 10.53756013015905, 10.960189955929906, 15.982718124985695, 16.20428729057312, 16.314635679125786, 8.771489795918257, 8.607952206085116, 8.058949897686631, 10.415763102471828, 10.755259703844786, 10.82789720222354, 11.744903445243835, 11.70838151872158, 10.772623538970947, 4.584665497144059, 4.514677350719765, 4.767048743863896, 9.066572099924088, 9.193316608667374, 10.314545467495918, 5.019036819537476, 5.113765140374497, 5.212965970238045, 9.238762913892657, 8.800235355893761, 9.37628994944194, 12.50312230984369, 12.485963548223168, 12.653743396202714, 20.270163014531136, 20.836274966597557, 21.014430986717343, 9.14522173255682, 8.941124513745308, 9.554814979434013, 13.523043936739356, 13.612486126522214, 13.197257595757634, 10.13666448990503, 10.675162429610879, 10.120674426356942, 15.664797035356358, 16.060820539792374, 15.237701555093125, 8.991658344864845, 9.853071115911007, 9.80239800363779, 13.777550178269536, 14.187611601004988, 14.022165442506463, 17.942667930697397, 17.395863329370812, 17.826389038314417, 14.880017759899289, 14.927922795216233, 15.048672808955104, 18.116309208174542, 17.350351487596825, 17.516308178504303, 19.405416692296654, 19.65537208567062, 19.211365724603326, 11.095234510799244, 11.114136857291058, 10.679823925097779, 15.564695070187241, 15.920937950412423, 14.935477296511323, 26.739572296539933, 27.22214230398336, 26.50844299296537, 16.82106831173101, 16.944673294822366, 17.4112893740336, -80.22449194515745, -81.47653252879779, -91.18054867784183, 9.224803358316422, 9.835774030303583, 9.468725308775902, 9.22756205623348, 9.276991331328944, 8.90055564542611, 15.544048623492316, 14.965670277674988, 15.235567932327584, -108.23808063318333, -117.795430538555, -107.9222753600528, 16.89248341570297, 16.962502444783837, 16.763882669309766, 11.485473662614822, 12.518290914595127, 12.803731289459392, 17.15009582291046, 17.15878681341806, 17.434017384114355, 13.69286709278822, 13.458493173122406, 14.078613564372063, 8.21692409614721, 8.496113742391259, 8.98462555060783, 12.919805457194641, 12.722208124895886, 12.542733473082379, 16.73751254581535, 16.65606679643193, 16.106689537564904, 10.302186734974384, 10.300045493990183, 10.234441138803959, 6.76026303817828, 6.733806324501828, 6.728410651286438, 9.297484268744782, 9.423604288448885, 9.365681798507765, 12.162507404883698, 12.159930621584252, 12.716438980152205, 21.633066352456808, 21.447148233652115, 21.14071512967348, 19.54441978316754, 19.01752746850252, 19.18232697248459, 12.89388532936573, 12.86028641462326, 12.789233691990376, 7.931615454455212, 8.297546082486704, 7.837914419670895, 21.888049783805997, 21.924354730794818, 21.876865195731312, 22.743918289740876, 22.1122608979543, 23.08445556958516, 12.265473400553063, 13.119271659602717, 13.01792563994725, 18.862976665298135, 18.870928371946007, 18.87264886001745, 5.401897445321083, 5.171361543238163, 5.377926953136921, 7.0831193017462795, 7.287036316624523, 6.266763711969048, 12.610619379828364, 12.7783179792265, 12.597513063500315, 17.91618865480025, 17.460687985022858, 18.087157928695277, 23.506420984864235, 23.196823805570602, 22.95441097021103, 16.327857752641037, 16.443786700566605, 16.80070180011292, 17.178524809579045, 17.007138806084782, 17.140902059773595, 14.68722368280092, 13.905007417003304, 14.05572901169458, 17.96999905010064, 18.30516450790067, 17.63400289913018, 10.227147825062275, 10.196824073791504, 10.323793068528175, 8.551747485995293, 8.746880203485489, 9.586043668910861, 16.081180214881897, 16.369254231452942, 15.946160271763802, 8.236644327640533, 8.237536385655403, 7.971276178956032, 8.665265445907906, 8.644340862830475, 9.020759896685675, 26.38334701831141, 26.25172010685006, 25.85830849657455, 14.865382534762219, 14.110060592492417, 14.54362567265828, 25.93786175300677, 25.97022411351402, 25.954279386748865, -88.72552901009719, -88.66254213700692, -88.66507380704086, 19.974222054084137, 19.841362481315926, 19.612403159340218, 18.837535500526428, 19.029877807945013, 18.56502164900303, 23.827050548046827, 23.707018919289112, 23.73877403885126, 20.205458864569664, 20.221216823905706, 19.96798535436392, 9.04594390715161, 9.026616542289645, 8.756777914861829, 19.536571239431694, 19.2501204808553, 19.65700251733263]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1457995128320153, "mean_inference_ms": 0.6840066300111275, "mean_action_processing_ms": 0.09964577247925774, "mean_env_wait_ms": 0.8360986613441636, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 355000, "timesteps_this_iter": 0, "agent_timesteps_total": 1065000, "timers": {"sample_time_ms": 11499.229, "sample_throughput": 434.812, "load_time_ms": 0.101, "load_throughput": 49636733.728, "learn_time_ms": 1674.733, "learn_throughput": 2985.551, "update_time_ms": 8.389}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 0.0005000000000000001, "total_loss": 101.42268218994141, "policy_loss": -0.0018526337885515164, "vf_loss": 101.50645294189454, "vf_explained_var": -0.011706876754760741, "kl": 0.007190682209342788, "entropy": 8.191319751739503, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 355000, "num_agent_steps_sampled": 1065000, "num_steps_trained": 355000, "num_agent_steps_trained": 1065000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1556, "training_iteration": 71, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-21-50", "timestamp": 1706228510, "time_this_iter_s": 11.714674949645996, "time_total_s": 753.5232508182526, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028216BD30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 753.5232508182526, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 11.6875, "ram_util_percent": 55.625}}
{"episode_reward_max": 84.46108080260453, "episode_reward_min": -333.9557865317911, "episode_reward_mean": 30.159352919030344, "episode_len_mean": 490.36, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -117.795430538555}, "policy_reward_max": {"shared_policy": 28.392182581747562}, "policy_reward_mean": {"shared_policy": 10.053117639676778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.36321583017707, -320.8944304585457, 37.98070468753575, 37.30912393331526, 34.58247875701633, 47.78084924630819, 17.010101214051218, 16.821557401679442, 1.364864431321621, 62.49244418554008, 58.02146406844258, 59.822682386264205, 24.941822938621044, 51.008024184033246, 36.11169526167214, 37.772522220795494, 14.965691074728937, 32.505376249551745, 48.5016410946846, 25.438391899690004, 31.998920008540154, 34.22590850293636, 13.86639159172772, 28.57443417608738, 15.345767930150018, 27.41528821922836, 37.64282925426957, 62.120868967846036, 27.64116122573614, 40.3327876590192, 30.93250134587285, 46.96331913024186, 28.647127464413643, 41.98732722178099, 53.164920298382626, 44.856613364070625, 52.98296887427567, 58.2721545025706, 32.88919529318808, 46.42111031711099, 80.47015759348866, 51.17703098058698, -252.88157315179706, 28.529302697395906, 27.405109032988534, 45.74528683349489, -333.9557865317911, 50.61886852979657, 36.80749586666934, 51.742900020442875, 41.22997383028269, 25.6976633891463, 38.184747055172906, 49.50026887981218, 30.836673367768526, 20.222480013966546, 28.086770355701432, 37.038877006620154, 64.2209297157824, 57.74427422415465, 38.543405435979366, 24.06707595661281, 65.68926971033213, 67.94063475728034, 38.40267070010303, 56.60655389726159, 15.951185941696167, 20.63691933033985, 37.98645042255518, 53.464034568518386, 69.65765576064587, 49.57234625332056, 51.32656567543742, 42.647960111498804, 53.90916645713149, 30.747764967381954, 26.884671358391643, 48.39659471809864, 24.44545689225197, 26.330366205424056, 78.49337562173602, 43.519068799912915, 77.86236525326966, -266.05314495414495, 59.42798769474028, 56.43243495747447, 71.2728435061872, 60.39466104283929, 26.829338364303084, 58.443694237619624, 84.46108080260453, 68.18793770670891, 69.37322362139821, 55.34286947175859, 68.11594384908673, 32.464655831456156, 83.38133598864076, 42.59162921085954, 57.52857769280671, 52.05539841949938], "episode_lengths": [500, 38, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 476, 500, 500, 500, 98, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 424, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [11.514822755008936, 11.360041469335556, 11.488351605832577, -116.24576922257742, -102.43868957956633, -102.20997165640196, 12.30442016323407, 12.789930877586201, 12.886353646715477, 12.498949599762753, 12.490569857259587, 12.319604476292923, 11.436029779414326, 11.721247834774346, 11.42520114282766, 16.113972503071025, 15.821481605370835, 15.845395137866333, 5.557047868768365, 5.925834248463303, 5.52721909681955, 5.489957516392067, 5.305127759774521, 6.0264721255128535, 0.4834371879696846, 0.5027831047773361, 0.3786441385746002, 20.614996768534184, 20.84746043384075, 21.029986983165145, 19.152167066931725, 19.578861016780138, 19.29043598473072, 20.095635088160634, 19.9833696000278, 19.74367769807577, 8.234564803540707, 8.265362523496151, 8.441895611584187, 16.520441527167947, 17.083887736002595, 17.403694920862705, 12.064728379249573, 12.310275049880147, 11.73669183254242, 12.662715756120932, 12.59008756310989, 12.519718901564673, 5.181347290674836, 4.8631660739580695, 4.921177710096032, 11.007626163462788, 10.53756013015905, 10.960189955929906, 15.982718124985695, 16.20428729057312, 16.314635679125786, 8.771489795918257, 8.607952206085116, 8.058949897686631, 10.415763102471828, 10.755259703844786, 10.82789720222354, 11.744903445243835, 11.70838151872158, 10.772623538970947, 4.584665497144059, 4.514677350719765, 4.767048743863896, 9.066572099924088, 9.193316608667374, 10.314545467495918, 5.019036819537476, 5.113765140374497, 5.212965970238045, 9.238762913892657, 8.800235355893761, 9.37628994944194, 12.50312230984369, 12.485963548223168, 12.653743396202714, 20.270163014531136, 20.836274966597557, 21.014430986717343, 9.14522173255682, 8.941124513745308, 9.554814979434013, 13.523043936739356, 13.612486126522214, 13.197257595757634, 10.13666448990503, 10.675162429610879, 10.120674426356942, 15.664797035356358, 16.060820539792374, 15.237701555093125, 8.991658344864845, 9.853071115911007, 9.80239800363779, 13.777550178269536, 14.187611601004988, 14.022165442506463, 17.942667930697397, 17.395863329370812, 17.826389038314417, 14.880017759899289, 14.927922795216233, 15.048672808955104, 18.116309208174542, 17.350351487596825, 17.516308178504303, 19.405416692296654, 19.65537208567062, 19.211365724603326, 11.095234510799244, 11.114136857291058, 10.679823925097779, 15.564695070187241, 15.920937950412423, 14.935477296511323, 26.739572296539933, 27.22214230398336, 26.50844299296537, 16.82106831173101, 16.944673294822366, 17.4112893740336, -80.22449194515745, -81.47653252879779, -91.18054867784183, 9.224803358316422, 9.835774030303583, 9.468725308775902, 9.22756205623348, 9.276991331328944, 8.90055564542611, 15.544048623492316, 14.965670277674988, 15.235567932327584, -108.23808063318333, -117.795430538555, -107.9222753600528, 16.89248341570297, 16.962502444783837, 16.763882669309766, 11.485473662614822, 12.518290914595127, 12.803731289459392, 17.15009582291046, 17.15878681341806, 17.434017384114355, 13.69286709278822, 13.458493173122406, 14.078613564372063, 8.21692409614721, 8.496113742391259, 8.98462555060783, 12.919805457194641, 12.722208124895886, 12.542733473082379, 16.73751254581535, 16.65606679643193, 16.106689537564904, 10.302186734974384, 10.300045493990183, 10.234441138803959, 6.76026303817828, 6.733806324501828, 6.728410651286438, 9.297484268744782, 9.423604288448885, 9.365681798507765, 12.162507404883698, 12.159930621584252, 12.716438980152205, 21.633066352456808, 21.447148233652115, 21.14071512967348, 19.54441978316754, 19.01752746850252, 19.18232697248459, 12.89388532936573, 12.86028641462326, 12.789233691990376, 7.931615454455212, 8.297546082486704, 7.837914419670895, 21.888049783805997, 21.924354730794818, 21.876865195731312, 22.743918289740876, 22.1122608979543, 23.08445556958516, 12.265473400553063, 13.119271659602717, 13.01792563994725, 18.862976665298135, 18.870928371946007, 18.87264886001745, 5.401897445321083, 5.171361543238163, 5.377926953136921, 7.0831193017462795, 7.287036316624523, 6.266763711969048, 12.610619379828364, 12.7783179792265, 12.597513063500315, 17.91618865480025, 17.460687985022858, 18.087157928695277, 23.506420984864235, 23.196823805570602, 22.95441097021103, 16.327857752641037, 16.443786700566605, 16.80070180011292, 17.178524809579045, 17.007138806084782, 17.140902059773595, 14.68722368280092, 13.905007417003304, 14.05572901169458, 17.96999905010064, 18.30516450790067, 17.63400289913018, 10.227147825062275, 10.196824073791504, 10.323793068528175, 8.551747485995293, 8.746880203485489, 9.586043668910861, 16.081180214881897, 16.369254231452942, 15.946160271763802, 8.236644327640533, 8.237536385655403, 7.971276178956032, 8.665265445907906, 8.644340862830475, 9.020759896685675, 26.38334701831141, 26.25172010685006, 25.85830849657455, 14.865382534762219, 14.110060592492417, 14.54362567265828, 25.93786175300677, 25.97022411351402, 25.954279386748865, -88.72552901009719, -88.66254213700692, -88.66507380704086, 19.974222054084137, 19.841362481315926, 19.612403159340218, 18.837535500526428, 19.029877807945013, 18.56502164900303, 23.827050548046827, 23.707018919289112, 23.73877403885126, 20.205458864569664, 20.221216823905706, 19.96798535436392, 9.04594390715161, 9.026616542289645, 8.756777914861829, 19.536571239431694, 19.2501204808553, 19.65700251733263, 28.392182581747562, 28.07277217755714, 27.996126043299824, 22.748176284134388, 22.681100867688656, 22.758660554885864, 22.654461205005646, 23.383198618888855, 23.33556379750371, 18.610647858430937, 18.305408169825867, 18.426813443501786, 22.840867154921085, 22.76917336570719, 22.50590332845846, 10.940328354636819, 10.445139894882828, 11.079187581936509, 27.962646587441355, 27.488547573486954, 27.930141827712447, 14.108956262469292, 13.75139231979847, 14.731280628591776, 19.270303958406046, 19.264060111095503, 18.994213623305157, 17.601135549445942, 17.421405417223767, 17.032857452829674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14593667227013019, "mean_inference_ms": 0.6850863212379729, "mean_action_processing_ms": 0.09977958180675013, "mean_env_wait_ms": 0.8374869322081079, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 360000, "timesteps_this_iter": 0, "agent_timesteps_total": 1080000, "timers": {"sample_time_ms": 11396.949, "sample_throughput": 438.714, "load_time_ms": 0.101, "load_throughput": 49636733.728, "learn_time_ms": 1670.834, "learn_throughput": 2992.517, "update_time_ms": 8.689}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 0.0005000000000000001, "total_loss": 4.160151720046997, "policy_loss": -0.003003533688140969, "vf_loss": 4.246613931655884, "vf_explained_var": -0.3142740249633789, "kl": 0.004671145579791906, "entropy": 8.345867824554443, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 360000, "num_agent_steps_sampled": 1080000, "num_steps_trained": 360000, "num_agent_steps_trained": 1080000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1566, "training_iteration": 72, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-22-02", "timestamp": 1706228522, "time_this_iter_s": 11.276212930679321, "time_total_s": 764.7994637489319, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282552DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 764.7994637489319, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 11.075, "ram_util_percent": 55.6375}}
{"episode_reward_max": 84.46108080260453, "episode_reward_min": -333.9557865317911, "episode_reward_mean": 36.008553672106345, "episode_len_mean": 494.98, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -117.795430538555}, "policy_reward_max": {"shared_policy": 28.392182581747562}, "policy_reward_mean": {"shared_policy": 12.002851224035446}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.02146406844258, 59.822682386264205, 24.941822938621044, 51.008024184033246, 36.11169526167214, 37.772522220795494, 14.965691074728937, 32.505376249551745, 48.5016410946846, 25.438391899690004, 31.998920008540154, 34.22590850293636, 13.86639159172772, 28.57443417608738, 15.345767930150018, 27.41528821922836, 37.64282925426957, 62.120868967846036, 27.64116122573614, 40.3327876590192, 30.93250134587285, 46.96331913024186, 28.647127464413643, 41.98732722178099, 53.164920298382626, 44.856613364070625, 52.98296887427567, 58.2721545025706, 32.88919529318808, 46.42111031711099, 80.47015759348866, 51.17703098058698, -252.88157315179706, 28.529302697395906, 27.405109032988534, 45.74528683349489, -333.9557865317911, 50.61886852979657, 36.80749586666934, 51.742900020442875, 41.22997383028269, 25.6976633891463, 38.184747055172906, 49.50026887981218, 30.836673367768526, 20.222480013966546, 28.086770355701432, 37.038877006620154, 64.2209297157824, 57.74427422415465, 38.543405435979366, 24.06707595661281, 65.68926971033213, 67.94063475728034, 38.40267070010303, 56.60655389726159, 15.951185941696167, 20.63691933033985, 37.98645042255518, 53.464034568518386, 69.65765576064587, 49.57234625332056, 51.32656567543742, 42.647960111498804, 53.90916645713149, 30.747764967381954, 26.884671358391643, 48.39659471809864, 24.44545689225197, 26.330366205424056, 78.49337562173602, 43.519068799912915, 77.86236525326966, -266.05314495414495, 59.42798769474028, 56.43243495747447, 71.2728435061872, 60.39466104283929, 26.829338364303084, 58.443694237619624, 84.46108080260453, 68.18793770670891, 69.37322362139821, 55.34286947175859, 68.11594384908673, 32.464655831456156, 83.38133598864076, 42.59162921085954, 57.52857769280671, 52.05539841949938, 53.28203263878822, 67.546004332602, 42.71920898929237, 59.46376359090209, 51.65256555750965, 70.17331944033502, 55.82624000124633, 50.63769536465405, 54.03854082804173, 48.391613792628036], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 476, 500, 500, 500, 98, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 424, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [19.152167066931725, 19.578861016780138, 19.29043598473072, 20.095635088160634, 19.9833696000278, 19.74367769807577, 8.234564803540707, 8.265362523496151, 8.441895611584187, 16.520441527167947, 17.083887736002595, 17.403694920862705, 12.064728379249573, 12.310275049880147, 11.73669183254242, 12.662715756120932, 12.59008756310989, 12.519718901564673, 5.181347290674836, 4.8631660739580695, 4.921177710096032, 11.007626163462788, 10.53756013015905, 10.960189955929906, 15.982718124985695, 16.20428729057312, 16.314635679125786, 8.771489795918257, 8.607952206085116, 8.058949897686631, 10.415763102471828, 10.755259703844786, 10.82789720222354, 11.744903445243835, 11.70838151872158, 10.772623538970947, 4.584665497144059, 4.514677350719765, 4.767048743863896, 9.066572099924088, 9.193316608667374, 10.314545467495918, 5.019036819537476, 5.113765140374497, 5.212965970238045, 9.238762913892657, 8.800235355893761, 9.37628994944194, 12.50312230984369, 12.485963548223168, 12.653743396202714, 20.270163014531136, 20.836274966597557, 21.014430986717343, 9.14522173255682, 8.941124513745308, 9.554814979434013, 13.523043936739356, 13.612486126522214, 13.197257595757634, 10.13666448990503, 10.675162429610879, 10.120674426356942, 15.664797035356358, 16.060820539792374, 15.237701555093125, 8.991658344864845, 9.853071115911007, 9.80239800363779, 13.777550178269536, 14.187611601004988, 14.022165442506463, 17.942667930697397, 17.395863329370812, 17.826389038314417, 14.880017759899289, 14.927922795216233, 15.048672808955104, 18.116309208174542, 17.350351487596825, 17.516308178504303, 19.405416692296654, 19.65537208567062, 19.211365724603326, 11.095234510799244, 11.114136857291058, 10.679823925097779, 15.564695070187241, 15.920937950412423, 14.935477296511323, 26.739572296539933, 27.22214230398336, 26.50844299296537, 16.82106831173101, 16.944673294822366, 17.4112893740336, -80.22449194515745, -81.47653252879779, -91.18054867784183, 9.224803358316422, 9.835774030303583, 9.468725308775902, 9.22756205623348, 9.276991331328944, 8.90055564542611, 15.544048623492316, 14.965670277674988, 15.235567932327584, -108.23808063318333, -117.795430538555, -107.9222753600528, 16.89248341570297, 16.962502444783837, 16.763882669309766, 11.485473662614822, 12.518290914595127, 12.803731289459392, 17.15009582291046, 17.15878681341806, 17.434017384114355, 13.69286709278822, 13.458493173122406, 14.078613564372063, 8.21692409614721, 8.496113742391259, 8.98462555060783, 12.919805457194641, 12.722208124895886, 12.542733473082379, 16.73751254581535, 16.65606679643193, 16.106689537564904, 10.302186734974384, 10.300045493990183, 10.234441138803959, 6.76026303817828, 6.733806324501828, 6.728410651286438, 9.297484268744782, 9.423604288448885, 9.365681798507765, 12.162507404883698, 12.159930621584252, 12.716438980152205, 21.633066352456808, 21.447148233652115, 21.14071512967348, 19.54441978316754, 19.01752746850252, 19.18232697248459, 12.89388532936573, 12.86028641462326, 12.789233691990376, 7.931615454455212, 8.297546082486704, 7.837914419670895, 21.888049783805997, 21.924354730794818, 21.876865195731312, 22.743918289740876, 22.1122608979543, 23.08445556958516, 12.265473400553063, 13.119271659602717, 13.01792563994725, 18.862976665298135, 18.870928371946007, 18.87264886001745, 5.401897445321083, 5.171361543238163, 5.377926953136921, 7.0831193017462795, 7.287036316624523, 6.266763711969048, 12.610619379828364, 12.7783179792265, 12.597513063500315, 17.91618865480025, 17.460687985022858, 18.087157928695277, 23.506420984864235, 23.196823805570602, 22.95441097021103, 16.327857752641037, 16.443786700566605, 16.80070180011292, 17.178524809579045, 17.007138806084782, 17.140902059773595, 14.68722368280092, 13.905007417003304, 14.05572901169458, 17.96999905010064, 18.30516450790067, 17.63400289913018, 10.227147825062275, 10.196824073791504, 10.323793068528175, 8.551747485995293, 8.746880203485489, 9.586043668910861, 16.081180214881897, 16.369254231452942, 15.946160271763802, 8.236644327640533, 8.237536385655403, 7.971276178956032, 8.665265445907906, 8.644340862830475, 9.020759896685675, 26.38334701831141, 26.25172010685006, 25.85830849657455, 14.865382534762219, 14.110060592492417, 14.54362567265828, 25.93786175300677, 25.97022411351402, 25.954279386748865, -88.72552901009719, -88.66254213700692, -88.66507380704086, 19.974222054084137, 19.841362481315926, 19.612403159340218, 18.837535500526428, 19.029877807945013, 18.56502164900303, 23.827050548046827, 23.707018919289112, 23.73877403885126, 20.205458864569664, 20.221216823905706, 19.96798535436392, 9.04594390715161, 9.026616542289645, 8.756777914861829, 19.536571239431694, 19.2501204808553, 19.65700251733263, 28.392182581747562, 28.07277217755714, 27.996126043299824, 22.748176284134388, 22.681100867688656, 22.758660554885864, 22.654461205005646, 23.383198618888855, 23.33556379750371, 18.610647858430937, 18.305408169825867, 18.426813443501786, 22.840867154921085, 22.76917336570719, 22.50590332845846, 10.940328354636819, 10.445139894882828, 11.079187581936509, 27.962646587441355, 27.488547573486954, 27.930141827712447, 14.108956262469292, 13.75139231979847, 14.731280628591776, 19.270303958406046, 19.264060111095503, 18.994213623305157, 17.601135549445942, 17.421405417223767, 17.032857452829674, 17.88667517155409, 17.44710086286068, 17.948256604373455, 22.538949268559605, 22.351918684939534, 22.655136379102856, 14.205030997594193, 14.36952519540985, 14.144652796288327, 19.755362644791603, 19.781929031014442, 19.926471915096045, 17.393922196080283, 16.819339772065476, 17.439303589363888, 23.262911101182297, 23.56153892104824, 23.348869418104485, 18.507219675928354, 18.662630922161043, 18.656389403156936, 16.82275792707999, 16.97980472942193, 16.83513270815213, 17.83655073493719, 17.96410832554102, 18.237881767563522, 16.17879032467802, 16.07650376235445, 16.136319705595568]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14594417567971532, "mean_inference_ms": 0.6859104907025367, "mean_action_processing_ms": 0.09984297550855063, "mean_env_wait_ms": 0.8386526930808165, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 365000, "timesteps_this_iter": 0, "agent_timesteps_total": 1095000, "timers": {"sample_time_ms": 11225.886, "sample_throughput": 445.399, "load_time_ms": 0.101, "load_throughput": 49636733.728, "learn_time_ms": 1653.765, "learn_throughput": 3023.405, "update_time_ms": 8.892}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.881784197001253e-17, "cur_lr": 0.0005000000000000001, "total_loss": 4.0702736377716064, "policy_loss": -0.0023836337793634145, "vf_loss": 4.155800819396973, "vf_explained_var": -0.2153627634048462, "kl": 0.0025835977983806797, "entropy": 8.314357948303222, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 365000, "num_agent_steps_sampled": 1095000, "num_steps_trained": 365000, "num_agent_steps_trained": 1095000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1576, "training_iteration": 73, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-22-12", "timestamp": 1706228532, "time_this_iter_s": 10.582284688949585, "time_total_s": 775.3817484378815, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282490A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 775.3817484378815, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 11.013333333333332, "ram_util_percent": 55.54}}
{"episode_reward_max": 84.46108080260453, "episode_reward_min": -333.9557865317911, "episode_reward_mean": 33.72158902393886, "episode_len_mean": 490.5, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -117.795430538555}, "policy_reward_max": {"shared_policy": 28.392182581747562}, "policy_reward_mean": {"shared_policy": 11.240529674646284}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.22590850293636, 13.86639159172772, 28.57443417608738, 15.345767930150018, 27.41528821922836, 37.64282925426957, 62.120868967846036, 27.64116122573614, 40.3327876590192, 30.93250134587285, 46.96331913024186, 28.647127464413643, 41.98732722178099, 53.164920298382626, 44.856613364070625, 52.98296887427567, 58.2721545025706, 32.88919529318808, 46.42111031711099, 80.47015759348866, 51.17703098058698, -252.88157315179706, 28.529302697395906, 27.405109032988534, 45.74528683349489, -333.9557865317911, 50.61886852979657, 36.80749586666934, 51.742900020442875, 41.22997383028269, 25.6976633891463, 38.184747055172906, 49.50026887981218, 30.836673367768526, 20.222480013966546, 28.086770355701432, 37.038877006620154, 64.2209297157824, 57.74427422415465, 38.543405435979366, 24.06707595661281, 65.68926971033213, 67.94063475728034, 38.40267070010303, 56.60655389726159, 15.951185941696167, 20.63691933033985, 37.98645042255518, 53.464034568518386, 69.65765576064587, 49.57234625332056, 51.32656567543742, 42.647960111498804, 53.90916645713149, 30.747764967381954, 26.884671358391643, 48.39659471809864, 24.44545689225197, 26.330366205424056, 78.49337562173602, 43.519068799912915, 77.86236525326966, -266.05314495414495, 59.42798769474028, 56.43243495747447, 71.2728435061872, 60.39466104283929, 26.829338364303084, 58.443694237619624, 84.46108080260453, 68.18793770670891, 69.37322362139821, 55.34286947175859, 68.11594384908673, 32.464655831456156, 83.38133598864076, 42.59162921085954, 57.52857769280671, 52.05539841949938, 53.28203263878822, 67.546004332602, 42.71920898929237, 59.46376359090209, 51.65256555750965, 70.17331944033502, 55.82624000124633, 50.63769536465405, 54.03854082804173, 48.391613792628036, 56.7454668302089, 59.826315389946075, 28.649030085653052, 48.96741173474582, 61.15433414280413, 54.71549089625475, 45.105212033260614, -314.09991102840286, 33.435336344409734, 44.377344345673905, 73.51573579572138], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 476, 500, 500, 500, 98, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 424, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 52, 500, 500, 500], "policy_shared_policy_reward": [11.744903445243835, 11.70838151872158, 10.772623538970947, 4.584665497144059, 4.514677350719765, 4.767048743863896, 9.066572099924088, 9.193316608667374, 10.314545467495918, 5.019036819537476, 5.113765140374497, 5.212965970238045, 9.238762913892657, 8.800235355893761, 9.37628994944194, 12.50312230984369, 12.485963548223168, 12.653743396202714, 20.270163014531136, 20.836274966597557, 21.014430986717343, 9.14522173255682, 8.941124513745308, 9.554814979434013, 13.523043936739356, 13.612486126522214, 13.197257595757634, 10.13666448990503, 10.675162429610879, 10.120674426356942, 15.664797035356358, 16.060820539792374, 15.237701555093125, 8.991658344864845, 9.853071115911007, 9.80239800363779, 13.777550178269536, 14.187611601004988, 14.022165442506463, 17.942667930697397, 17.395863329370812, 17.826389038314417, 14.880017759899289, 14.927922795216233, 15.048672808955104, 18.116309208174542, 17.350351487596825, 17.516308178504303, 19.405416692296654, 19.65537208567062, 19.211365724603326, 11.095234510799244, 11.114136857291058, 10.679823925097779, 15.564695070187241, 15.920937950412423, 14.935477296511323, 26.739572296539933, 27.22214230398336, 26.50844299296537, 16.82106831173101, 16.944673294822366, 17.4112893740336, -80.22449194515745, -81.47653252879779, -91.18054867784183, 9.224803358316422, 9.835774030303583, 9.468725308775902, 9.22756205623348, 9.276991331328944, 8.90055564542611, 15.544048623492316, 14.965670277674988, 15.235567932327584, -108.23808063318333, -117.795430538555, -107.9222753600528, 16.89248341570297, 16.962502444783837, 16.763882669309766, 11.485473662614822, 12.518290914595127, 12.803731289459392, 17.15009582291046, 17.15878681341806, 17.434017384114355, 13.69286709278822, 13.458493173122406, 14.078613564372063, 8.21692409614721, 8.496113742391259, 8.98462555060783, 12.919805457194641, 12.722208124895886, 12.542733473082379, 16.73751254581535, 16.65606679643193, 16.106689537564904, 10.302186734974384, 10.300045493990183, 10.234441138803959, 6.76026303817828, 6.733806324501828, 6.728410651286438, 9.297484268744782, 9.423604288448885, 9.365681798507765, 12.162507404883698, 12.159930621584252, 12.716438980152205, 21.633066352456808, 21.447148233652115, 21.14071512967348, 19.54441978316754, 19.01752746850252, 19.18232697248459, 12.89388532936573, 12.86028641462326, 12.789233691990376, 7.931615454455212, 8.297546082486704, 7.837914419670895, 21.888049783805997, 21.924354730794818, 21.876865195731312, 22.743918289740876, 22.1122608979543, 23.08445556958516, 12.265473400553063, 13.119271659602717, 13.01792563994725, 18.862976665298135, 18.870928371946007, 18.87264886001745, 5.401897445321083, 5.171361543238163, 5.377926953136921, 7.0831193017462795, 7.287036316624523, 6.266763711969048, 12.610619379828364, 12.7783179792265, 12.597513063500315, 17.91618865480025, 17.460687985022858, 18.087157928695277, 23.506420984864235, 23.196823805570602, 22.95441097021103, 16.327857752641037, 16.443786700566605, 16.80070180011292, 17.178524809579045, 17.007138806084782, 17.140902059773595, 14.68722368280092, 13.905007417003304, 14.05572901169458, 17.96999905010064, 18.30516450790067, 17.63400289913018, 10.227147825062275, 10.196824073791504, 10.323793068528175, 8.551747485995293, 8.746880203485489, 9.586043668910861, 16.081180214881897, 16.369254231452942, 15.946160271763802, 8.236644327640533, 8.237536385655403, 7.971276178956032, 8.665265445907906, 8.644340862830475, 9.020759896685675, 26.38334701831141, 26.25172010685006, 25.85830849657455, 14.865382534762219, 14.110060592492417, 14.54362567265828, 25.93786175300677, 25.97022411351402, 25.954279386748865, -88.72552901009719, -88.66254213700692, -88.66507380704086, 19.974222054084137, 19.841362481315926, 19.612403159340218, 18.837535500526428, 19.029877807945013, 18.56502164900303, 23.827050548046827, 23.707018919289112, 23.73877403885126, 20.205458864569664, 20.221216823905706, 19.96798535436392, 9.04594390715161, 9.026616542289645, 8.756777914861829, 19.536571239431694, 19.2501204808553, 19.65700251733263, 28.392182581747562, 28.07277217755714, 27.996126043299824, 22.748176284134388, 22.681100867688656, 22.758660554885864, 22.654461205005646, 23.383198618888855, 23.33556379750371, 18.610647858430937, 18.305408169825867, 18.426813443501786, 22.840867154921085, 22.76917336570719, 22.50590332845846, 10.940328354636819, 10.445139894882828, 11.079187581936509, 27.962646587441355, 27.488547573486954, 27.930141827712447, 14.108956262469292, 13.75139231979847, 14.731280628591776, 19.270303958406046, 19.264060111095503, 18.994213623305157, 17.601135549445942, 17.421405417223767, 17.032857452829674, 17.88667517155409, 17.44710086286068, 17.948256604373455, 22.538949268559605, 22.351918684939534, 22.655136379102856, 14.205030997594193, 14.36952519540985, 14.144652796288327, 19.755362644791603, 19.781929031014442, 19.926471915096045, 17.393922196080283, 16.819339772065476, 17.439303589363888, 23.262911101182297, 23.56153892104824, 23.348869418104485, 18.507219675928354, 18.662630922161043, 18.656389403156936, 16.82275792707999, 16.97980472942193, 16.83513270815213, 17.83655073493719, 17.96410832554102, 18.237881767563522, 16.17879032467802, 16.07650376235445, 16.136319705595568, 18.820049479603767, 18.844085536897182, 19.081331813707948, 19.38091757396856, 20.25732019605735, 20.188077619920165, 9.602766049404934, 9.775431559731558, 9.27083247651656, 16.211224121352032, 16.77672233242386, 15.979465280969933, 20.334026431043938, 20.62658804406722, 20.193719667692974, 18.352619259307772, 18.393924141923577, 17.9689474950234, 15.135836187750101, 14.650276020169258, 15.319099825341254, -111.1785558780733, -101.2184459588801, -101.70290919144949, 10.572082847356796, 11.376668959856033, 11.486584537196904, 14.895012096812323, 14.425878336032227, 15.056453912829355, 24.479342530171067, 24.307636859516293, 24.728756406034023]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14594108083353832, "mean_inference_ms": 0.6862920117614634, "mean_action_processing_ms": 0.0999017906707973, "mean_env_wait_ms": 0.8393764565125688, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 370000, "timesteps_this_iter": 0, "agent_timesteps_total": 1110000, "timers": {"sample_time_ms": 11122.264, "sample_throughput": 449.549, "load_time_ms": 0.101, "load_throughput": 49636733.728, "learn_time_ms": 1643.221, "learn_throughput": 3042.804, "update_time_ms": 9.053}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.4408920985006264e-17, "cur_lr": 0.0005000000000000001, "total_loss": 76.79551696777344, "policy_loss": -0.0027632840786874445, "vf_loss": 76.88286743164062, "vf_explained_var": 0.00252038836479187, "kl": 0.011154790967718124, "entropy": 8.4586932182312, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 370000, "num_agent_steps_sampled": 1110000, "num_steps_trained": 370000, "num_agent_steps_trained": 1110000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1587, "training_iteration": 74, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-22-23", "timestamp": 1706228543, "time_this_iter_s": 10.837579011917114, "time_total_s": 786.2193274497986, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282575280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 786.2193274497986, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 11.053333333333336, "ram_util_percent": 55.03333333333333}}
{"episode_reward_max": 84.46108080260453, "episode_reward_min": -333.9557865317911, "episode_reward_mean": 32.793830442407625, "episode_len_mean": 489.08, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -117.795430538555}, "policy_reward_max": {"shared_policy": 28.392182581747562}, "policy_reward_mean": {"shared_policy": 10.931276814135872}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.647127464413643, 41.98732722178099, 53.164920298382626, 44.856613364070625, 52.98296887427567, 58.2721545025706, 32.88919529318808, 46.42111031711099, 80.47015759348866, 51.17703098058698, -252.88157315179706, 28.529302697395906, 27.405109032988534, 45.74528683349489, -333.9557865317911, 50.61886852979657, 36.80749586666934, 51.742900020442875, 41.22997383028269, 25.6976633891463, 38.184747055172906, 49.50026887981218, 30.836673367768526, 20.222480013966546, 28.086770355701432, 37.038877006620154, 64.2209297157824, 57.74427422415465, 38.543405435979366, 24.06707595661281, 65.68926971033213, 67.94063475728034, 38.40267070010303, 56.60655389726159, 15.951185941696167, 20.63691933033985, 37.98645042255518, 53.464034568518386, 69.65765576064587, 49.57234625332056, 51.32656567543742, 42.647960111498804, 53.90916645713149, 30.747764967381954, 26.884671358391643, 48.39659471809864, 24.44545689225197, 26.330366205424056, 78.49337562173602, 43.519068799912915, 77.86236525326966, -266.05314495414495, 59.42798769474028, 56.43243495747447, 71.2728435061872, 60.39466104283929, 26.829338364303084, 58.443694237619624, 84.46108080260453, 68.18793770670891, 69.37322362139821, 55.34286947175859, 68.11594384908673, 32.464655831456156, 83.38133598864076, 42.59162921085954, 57.52857769280671, 52.05539841949938, 53.28203263878822, 67.546004332602, 42.71920898929237, 59.46376359090209, 51.65256555750965, 70.17331944033502, 55.82624000124633, 50.63769536465405, 54.03854082804173, 48.391613792628036, 56.7454668302089, 59.826315389946075, 28.649030085653052, 48.96741173474582, 61.15433414280413, 54.71549089625475, 45.105212033260614, -314.09991102840286, 33.435336344409734, 44.377344345673905, 73.51573579572138, 78.00749402586369, 64.02207320928571, 51.364726103842244, 70.44336963444945, 49.438236020505414, 68.50334151461718, 36.651034560054526, 54.245305594056816, -241.05011696740985, 27.042733939830214, 13.61720221489665], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 476, 500, 500, 500, 98, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 424, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 52, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 358, 500, 500], "policy_shared_policy_reward": [8.991658344864845, 9.853071115911007, 9.80239800363779, 13.777550178269536, 14.187611601004988, 14.022165442506463, 17.942667930697397, 17.395863329370812, 17.826389038314417, 14.880017759899289, 14.927922795216233, 15.048672808955104, 18.116309208174542, 17.350351487596825, 17.516308178504303, 19.405416692296654, 19.65537208567062, 19.211365724603326, 11.095234510799244, 11.114136857291058, 10.679823925097779, 15.564695070187241, 15.920937950412423, 14.935477296511323, 26.739572296539933, 27.22214230398336, 26.50844299296537, 16.82106831173101, 16.944673294822366, 17.4112893740336, -80.22449194515745, -81.47653252879779, -91.18054867784183, 9.224803358316422, 9.835774030303583, 9.468725308775902, 9.22756205623348, 9.276991331328944, 8.90055564542611, 15.544048623492316, 14.965670277674988, 15.235567932327584, -108.23808063318333, -117.795430538555, -107.9222753600528, 16.89248341570297, 16.962502444783837, 16.763882669309766, 11.485473662614822, 12.518290914595127, 12.803731289459392, 17.15009582291046, 17.15878681341806, 17.434017384114355, 13.69286709278822, 13.458493173122406, 14.078613564372063, 8.21692409614721, 8.496113742391259, 8.98462555060783, 12.919805457194641, 12.722208124895886, 12.542733473082379, 16.73751254581535, 16.65606679643193, 16.106689537564904, 10.302186734974384, 10.300045493990183, 10.234441138803959, 6.76026303817828, 6.733806324501828, 6.728410651286438, 9.297484268744782, 9.423604288448885, 9.365681798507765, 12.162507404883698, 12.159930621584252, 12.716438980152205, 21.633066352456808, 21.447148233652115, 21.14071512967348, 19.54441978316754, 19.01752746850252, 19.18232697248459, 12.89388532936573, 12.86028641462326, 12.789233691990376, 7.931615454455212, 8.297546082486704, 7.837914419670895, 21.888049783805997, 21.924354730794818, 21.876865195731312, 22.743918289740876, 22.1122608979543, 23.08445556958516, 12.265473400553063, 13.119271659602717, 13.01792563994725, 18.862976665298135, 18.870928371946007, 18.87264886001745, 5.401897445321083, 5.171361543238163, 5.377926953136921, 7.0831193017462795, 7.287036316624523, 6.266763711969048, 12.610619379828364, 12.7783179792265, 12.597513063500315, 17.91618865480025, 17.460687985022858, 18.087157928695277, 23.506420984864235, 23.196823805570602, 22.95441097021103, 16.327857752641037, 16.443786700566605, 16.80070180011292, 17.178524809579045, 17.007138806084782, 17.140902059773595, 14.68722368280092, 13.905007417003304, 14.05572901169458, 17.96999905010064, 18.30516450790067, 17.63400289913018, 10.227147825062275, 10.196824073791504, 10.323793068528175, 8.551747485995293, 8.746880203485489, 9.586043668910861, 16.081180214881897, 16.369254231452942, 15.946160271763802, 8.236644327640533, 8.237536385655403, 7.971276178956032, 8.665265445907906, 8.644340862830475, 9.020759896685675, 26.38334701831141, 26.25172010685006, 25.85830849657455, 14.865382534762219, 14.110060592492417, 14.54362567265828, 25.93786175300677, 25.97022411351402, 25.954279386748865, -88.72552901009719, -88.66254213700692, -88.66507380704086, 19.974222054084137, 19.841362481315926, 19.612403159340218, 18.837535500526428, 19.029877807945013, 18.56502164900303, 23.827050548046827, 23.707018919289112, 23.73877403885126, 20.205458864569664, 20.221216823905706, 19.96798535436392, 9.04594390715161, 9.026616542289645, 8.756777914861829, 19.536571239431694, 19.2501204808553, 19.65700251733263, 28.392182581747562, 28.07277217755714, 27.996126043299824, 22.748176284134388, 22.681100867688656, 22.758660554885864, 22.654461205005646, 23.383198618888855, 23.33556379750371, 18.610647858430937, 18.305408169825867, 18.426813443501786, 22.840867154921085, 22.76917336570719, 22.50590332845846, 10.940328354636819, 10.445139894882828, 11.079187581936509, 27.962646587441355, 27.488547573486954, 27.930141827712447, 14.108956262469292, 13.75139231979847, 14.731280628591776, 19.270303958406046, 19.264060111095503, 18.994213623305157, 17.601135549445942, 17.421405417223767, 17.032857452829674, 17.88667517155409, 17.44710086286068, 17.948256604373455, 22.538949268559605, 22.351918684939534, 22.655136379102856, 14.205030997594193, 14.36952519540985, 14.144652796288327, 19.755362644791603, 19.781929031014442, 19.926471915096045, 17.393922196080283, 16.819339772065476, 17.439303589363888, 23.262911101182297, 23.56153892104824, 23.348869418104485, 18.507219675928354, 18.662630922161043, 18.656389403156936, 16.82275792707999, 16.97980472942193, 16.83513270815213, 17.83655073493719, 17.96410832554102, 18.237881767563522, 16.17879032467802, 16.07650376235445, 16.136319705595568, 18.820049479603767, 18.844085536897182, 19.081331813707948, 19.38091757396856, 20.25732019605735, 20.188077619920165, 9.602766049404934, 9.775431559731558, 9.27083247651656, 16.211224121352032, 16.77672233242386, 15.979465280969933, 20.334026431043938, 20.62658804406722, 20.193719667692974, 18.352619259307772, 18.393924141923577, 17.9689474950234, 15.135836187750101, 14.650276020169258, 15.319099825341254, -111.1785558780733, -101.2184459588801, -101.70290919144949, 10.572082847356796, 11.376668959856033, 11.486584537196904, 14.895012096812323, 14.425878336032227, 15.056453912829355, 24.479342530171067, 24.307636859516293, 24.728756406034023, 26.174344513875738, 25.673576635619, 26.159572876368955, 21.39669671157995, 21.542663047711045, 21.082713449994714, 17.202790235479668, 16.822325741251305, 17.33961012711127, 23.660646143058926, 23.392742226521165, 23.389981264869363, 16.734968995054558, 16.09659572442372, 16.606671301027134, 22.578915807108075, 22.961328646788985, 22.963097060720116, 11.931293358405426, 12.118797053893402, 12.600944147755698, 17.825521575907857, 18.19811505327621, 18.221668964872748, -78.98431692520778, -86.1174347649018, -75.94836527730028, 9.369064355734736, 8.918509192764759, 8.755160391330719, 4.939869786302239, 3.739587138096482, 4.937745290497929]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14587620480032593, "mean_inference_ms": 0.6867369756699948, "mean_action_processing_ms": 0.09990812978656052, "mean_env_wait_ms": 0.8401972955546563, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 375000, "timesteps_this_iter": 0, "agent_timesteps_total": 1125000, "timers": {"sample_time_ms": 11063.559, "sample_throughput": 451.934, "load_time_ms": 0.101, "load_throughput": 49636733.728, "learn_time_ms": 1617.172, "learn_throughput": 3091.818, "update_time_ms": 9.052}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.4408920985006264e-17, "cur_lr": 0.0005000000000000001, "total_loss": 119.08237228393554, "policy_loss": -0.0014215211564380325, "vf_loss": 119.1699935913086, "vf_explained_var": -0.01718238592147827, "kl": 0.006181693339039246, "entropy": 8.620441722869874, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 375000, "num_agent_steps_sampled": 1125000, "num_steps_trained": 375000, "num_agent_steps_trained": 1125000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1598, "training_iteration": 75, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-22-34", "timestamp": 1706228554, "time_this_iter_s": 10.786052227020264, "time_total_s": 797.0053796768188, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202846E4310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 797.0053796768188, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 11.07333333333333, "ram_util_percent": 54.686666666666675}}
{"episode_reward_max": 84.46108080260453, "episode_reward_min": -333.9557865317911, "episode_reward_mean": 33.88547722201561, "episode_len_mean": 489.08, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -117.795430538555}, "policy_reward_max": {"shared_policy": 28.392182581747562}, "policy_reward_mean": {"shared_policy": 11.2951590740052}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-252.88157315179706, 28.529302697395906, 27.405109032988534, 45.74528683349489, -333.9557865317911, 50.61886852979657, 36.80749586666934, 51.742900020442875, 41.22997383028269, 25.6976633891463, 38.184747055172906, 49.50026887981218, 30.836673367768526, 20.222480013966546, 28.086770355701432, 37.038877006620154, 64.2209297157824, 57.74427422415465, 38.543405435979366, 24.06707595661281, 65.68926971033213, 67.94063475728034, 38.40267070010303, 56.60655389726159, 15.951185941696167, 20.63691933033985, 37.98645042255518, 53.464034568518386, 69.65765576064587, 49.57234625332056, 51.32656567543742, 42.647960111498804, 53.90916645713149, 30.747764967381954, 26.884671358391643, 48.39659471809864, 24.44545689225197, 26.330366205424056, 78.49337562173602, 43.519068799912915, 77.86236525326966, -266.05314495414495, 59.42798769474028, 56.43243495747447, 71.2728435061872, 60.39466104283929, 26.829338364303084, 58.443694237619624, 84.46108080260453, 68.18793770670891, 69.37322362139821, 55.34286947175859, 68.11594384908673, 32.464655831456156, 83.38133598864076, 42.59162921085954, 57.52857769280671, 52.05539841949938, 53.28203263878822, 67.546004332602, 42.71920898929237, 59.46376359090209, 51.65256555750965, 70.17331944033502, 55.82624000124633, 50.63769536465405, 54.03854082804173, 48.391613792628036, 56.7454668302089, 59.826315389946075, 28.649030085653052, 48.96741173474582, 61.15433414280413, 54.71549089625475, 45.105212033260614, -314.09991102840286, 33.435336344409734, 44.377344345673905, 73.51573579572138, 78.00749402586369, 64.02207320928571, 51.364726103842244, 70.44336963444945, 49.438236020505414, 68.50334151461718, 36.651034560054526, 54.245305594056816, -241.05011696740985, 27.042733939830214, 13.61720221489665, 77.81473493389782, 61.010586144402595, 30.91091687977314, 37.70231822319326, 70.04821197688577, 52.55517116189, 55.66404546238479, 81.44854799285531, 53.809793170541525, 79.06895792484282], "episode_lengths": [476, 500, 500, 500, 98, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 424, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 52, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 358, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-80.22449194515745, -81.47653252879779, -91.18054867784183, 9.224803358316422, 9.835774030303583, 9.468725308775902, 9.22756205623348, 9.276991331328944, 8.90055564542611, 15.544048623492316, 14.965670277674988, 15.235567932327584, -108.23808063318333, -117.795430538555, -107.9222753600528, 16.89248341570297, 16.962502444783837, 16.763882669309766, 11.485473662614822, 12.518290914595127, 12.803731289459392, 17.15009582291046, 17.15878681341806, 17.434017384114355, 13.69286709278822, 13.458493173122406, 14.078613564372063, 8.21692409614721, 8.496113742391259, 8.98462555060783, 12.919805457194641, 12.722208124895886, 12.542733473082379, 16.73751254581535, 16.65606679643193, 16.106689537564904, 10.302186734974384, 10.300045493990183, 10.234441138803959, 6.76026303817828, 6.733806324501828, 6.728410651286438, 9.297484268744782, 9.423604288448885, 9.365681798507765, 12.162507404883698, 12.159930621584252, 12.716438980152205, 21.633066352456808, 21.447148233652115, 21.14071512967348, 19.54441978316754, 19.01752746850252, 19.18232697248459, 12.89388532936573, 12.86028641462326, 12.789233691990376, 7.931615454455212, 8.297546082486704, 7.837914419670895, 21.888049783805997, 21.924354730794818, 21.876865195731312, 22.743918289740876, 22.1122608979543, 23.08445556958516, 12.265473400553063, 13.119271659602717, 13.01792563994725, 18.862976665298135, 18.870928371946007, 18.87264886001745, 5.401897445321083, 5.171361543238163, 5.377926953136921, 7.0831193017462795, 7.287036316624523, 6.266763711969048, 12.610619379828364, 12.7783179792265, 12.597513063500315, 17.91618865480025, 17.460687985022858, 18.087157928695277, 23.506420984864235, 23.196823805570602, 22.95441097021103, 16.327857752641037, 16.443786700566605, 16.80070180011292, 17.178524809579045, 17.007138806084782, 17.140902059773595, 14.68722368280092, 13.905007417003304, 14.05572901169458, 17.96999905010064, 18.30516450790067, 17.63400289913018, 10.227147825062275, 10.196824073791504, 10.323793068528175, 8.551747485995293, 8.746880203485489, 9.586043668910861, 16.081180214881897, 16.369254231452942, 15.946160271763802, 8.236644327640533, 8.237536385655403, 7.971276178956032, 8.665265445907906, 8.644340862830475, 9.020759896685675, 26.38334701831141, 26.25172010685006, 25.85830849657455, 14.865382534762219, 14.110060592492417, 14.54362567265828, 25.93786175300677, 25.97022411351402, 25.954279386748865, -88.72552901009719, -88.66254213700692, -88.66507380704086, 19.974222054084137, 19.841362481315926, 19.612403159340218, 18.837535500526428, 19.029877807945013, 18.56502164900303, 23.827050548046827, 23.707018919289112, 23.73877403885126, 20.205458864569664, 20.221216823905706, 19.96798535436392, 9.04594390715161, 9.026616542289645, 8.756777914861829, 19.536571239431694, 19.2501204808553, 19.65700251733263, 28.392182581747562, 28.07277217755714, 27.996126043299824, 22.748176284134388, 22.681100867688656, 22.758660554885864, 22.654461205005646, 23.383198618888855, 23.33556379750371, 18.610647858430937, 18.305408169825867, 18.426813443501786, 22.840867154921085, 22.76917336570719, 22.50590332845846, 10.940328354636819, 10.445139894882828, 11.079187581936509, 27.962646587441355, 27.488547573486954, 27.930141827712447, 14.108956262469292, 13.75139231979847, 14.731280628591776, 19.270303958406046, 19.264060111095503, 18.994213623305157, 17.601135549445942, 17.421405417223767, 17.032857452829674, 17.88667517155409, 17.44710086286068, 17.948256604373455, 22.538949268559605, 22.351918684939534, 22.655136379102856, 14.205030997594193, 14.36952519540985, 14.144652796288327, 19.755362644791603, 19.781929031014442, 19.926471915096045, 17.393922196080283, 16.819339772065476, 17.439303589363888, 23.262911101182297, 23.56153892104824, 23.348869418104485, 18.507219675928354, 18.662630922161043, 18.656389403156936, 16.82275792707999, 16.97980472942193, 16.83513270815213, 17.83655073493719, 17.96410832554102, 18.237881767563522, 16.17879032467802, 16.07650376235445, 16.136319705595568, 18.820049479603767, 18.844085536897182, 19.081331813707948, 19.38091757396856, 20.25732019605735, 20.188077619920165, 9.602766049404934, 9.775431559731558, 9.27083247651656, 16.211224121352032, 16.77672233242386, 15.979465280969933, 20.334026431043938, 20.62658804406722, 20.193719667692974, 18.352619259307772, 18.393924141923577, 17.9689474950234, 15.135836187750101, 14.650276020169258, 15.319099825341254, -111.1785558780733, -101.2184459588801, -101.70290919144949, 10.572082847356796, 11.376668959856033, 11.486584537196904, 14.895012096812323, 14.425878336032227, 15.056453912829355, 24.479342530171067, 24.307636859516293, 24.728756406034023, 26.174344513875738, 25.673576635619, 26.159572876368955, 21.39669671157995, 21.542663047711045, 21.082713449994714, 17.202790235479668, 16.822325741251305, 17.33961012711127, 23.660646143058926, 23.392742226521165, 23.389981264869363, 16.734968995054558, 16.09659572442372, 16.606671301027134, 22.578915807108075, 22.961328646788985, 22.963097060720116, 11.931293358405426, 12.118797053893402, 12.600944147755698, 17.825521575907857, 18.19811505327621, 18.221668964872748, -78.98431692520778, -86.1174347649018, -75.94836527730028, 9.369064355734736, 8.918509192764759, 8.755160391330719, 4.939869786302239, 3.739587138096482, 4.937745290497929, 26.024453761676938, 25.365004325906426, 26.42527684631446, 20.14591260502735, 20.308982028315455, 20.55569151105979, 10.314908720552921, 10.243491068482399, 10.35251709073782, 12.69942154424885, 12.760165112713963, 12.242731566230447, 23.226721862951905, 23.764233792821557, 23.057256321112305, 17.384962695340306, 17.62161952878037, 17.548588937769324, 18.458712751666695, 18.4179964835445, 18.787336227173597, 27.10451190173626, 27.295963529497385, 27.048072561621666, 17.709489703178406, 18.37939701601863, 17.72090645134449, 26.588945781191185, 25.93012923498948, 26.549882908662156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1458523435126771, "mean_inference_ms": 0.6872642211500907, "mean_action_processing_ms": 0.09994090670910331, "mean_env_wait_ms": 0.8410503260502062, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 380000, "timesteps_this_iter": 0, "agent_timesteps_total": 1140000, "timers": {"sample_time_ms": 11047.141, "sample_throughput": 452.606, "load_time_ms": 0.101, "load_throughput": 49636733.728, "learn_time_ms": 1606.539, "learn_throughput": 3112.28, "update_time_ms": 9.058}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.4408920985006264e-17, "cur_lr": 0.0005000000000000001, "total_loss": 4.992708683013916, "policy_loss": -0.0036479067830988755, "vf_loss": 5.083664751052856, "vf_explained_var": -0.18598462343215943, "kl": 0.003647768142419025, "entropy": 8.730835723876954, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 380000, "num_agent_steps_sampled": 1140000, "num_steps_trained": 380000, "num_agent_steps_trained": 1140000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1608, "training_iteration": 76, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-22-44", "timestamp": 1706228564, "time_this_iter_s": 10.52677297592163, "time_total_s": 807.5321526527405, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282569310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 807.5321526527405, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 10.16, "ram_util_percent": 54.82666666666666}}
{"episode_reward_max": 100.6074570789933, "episode_reward_min": -314.09991102840286, "episode_reward_mean": 42.319217852546124, "episode_len_mean": 493.34, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -111.1785558780733}, "policy_reward_max": {"shared_policy": 33.73910430570443}, "policy_reward_mean": {"shared_policy": 14.106405950848705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.184747055172906, 49.50026887981218, 30.836673367768526, 20.222480013966546, 28.086770355701432, 37.038877006620154, 64.2209297157824, 57.74427422415465, 38.543405435979366, 24.06707595661281, 65.68926971033213, 67.94063475728034, 38.40267070010303, 56.60655389726159, 15.951185941696167, 20.63691933033985, 37.98645042255518, 53.464034568518386, 69.65765576064587, 49.57234625332056, 51.32656567543742, 42.647960111498804, 53.90916645713149, 30.747764967381954, 26.884671358391643, 48.39659471809864, 24.44545689225197, 26.330366205424056, 78.49337562173602, 43.519068799912915, 77.86236525326966, -266.05314495414495, 59.42798769474028, 56.43243495747447, 71.2728435061872, 60.39466104283929, 26.829338364303084, 58.443694237619624, 84.46108080260453, 68.18793770670891, 69.37322362139821, 55.34286947175859, 68.11594384908673, 32.464655831456156, 83.38133598864076, 42.59162921085954, 57.52857769280671, 52.05539841949938, 53.28203263878822, 67.546004332602, 42.71920898929237, 59.46376359090209, 51.65256555750965, 70.17331944033502, 55.82624000124633, 50.63769536465405, 54.03854082804173, 48.391613792628036, 56.7454668302089, 59.826315389946075, 28.649030085653052, 48.96741173474582, 61.15433414280413, 54.71549089625475, 45.105212033260614, -314.09991102840286, 33.435336344409734, 44.377344345673905, 73.51573579572138, 78.00749402586369, 64.02207320928571, 51.364726103842244, 70.44336963444945, 49.438236020505414, 68.50334151461718, 36.651034560054526, 54.245305594056816, -241.05011696740985, 27.042733939830214, 13.61720221489665, 77.81473493389782, 61.010586144402595, 30.91091687977314, 37.70231822319326, 70.04821197688577, 52.55517116189, 55.66404546238479, 81.44854799285531, 53.809793170541525, 79.06895792484282, 55.445895761251435, 40.25910576898603, 24.35741774551569, 30.183635078370557, 72.81525989901272, 100.6074570789933, 54.81891626550349, 76.72970214858648, 50.23882149253038, 58.85709233093074], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 424, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 52, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 358, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [12.919805457194641, 12.722208124895886, 12.542733473082379, 16.73751254581535, 16.65606679643193, 16.106689537564904, 10.302186734974384, 10.300045493990183, 10.234441138803959, 6.76026303817828, 6.733806324501828, 6.728410651286438, 9.297484268744782, 9.423604288448885, 9.365681798507765, 12.162507404883698, 12.159930621584252, 12.716438980152205, 21.633066352456808, 21.447148233652115, 21.14071512967348, 19.54441978316754, 19.01752746850252, 19.18232697248459, 12.89388532936573, 12.86028641462326, 12.789233691990376, 7.931615454455212, 8.297546082486704, 7.837914419670895, 21.888049783805997, 21.924354730794818, 21.876865195731312, 22.743918289740876, 22.1122608979543, 23.08445556958516, 12.265473400553063, 13.119271659602717, 13.01792563994725, 18.862976665298135, 18.870928371946007, 18.87264886001745, 5.401897445321083, 5.171361543238163, 5.377926953136921, 7.0831193017462795, 7.287036316624523, 6.266763711969048, 12.610619379828364, 12.7783179792265, 12.597513063500315, 17.91618865480025, 17.460687985022858, 18.087157928695277, 23.506420984864235, 23.196823805570602, 22.95441097021103, 16.327857752641037, 16.443786700566605, 16.80070180011292, 17.178524809579045, 17.007138806084782, 17.140902059773595, 14.68722368280092, 13.905007417003304, 14.05572901169458, 17.96999905010064, 18.30516450790067, 17.63400289913018, 10.227147825062275, 10.196824073791504, 10.323793068528175, 8.551747485995293, 8.746880203485489, 9.586043668910861, 16.081180214881897, 16.369254231452942, 15.946160271763802, 8.236644327640533, 8.237536385655403, 7.971276178956032, 8.665265445907906, 8.644340862830475, 9.020759896685675, 26.38334701831141, 26.25172010685006, 25.85830849657455, 14.865382534762219, 14.110060592492417, 14.54362567265828, 25.93786175300677, 25.97022411351402, 25.954279386748865, -88.72552901009719, -88.66254213700692, -88.66507380704086, 19.974222054084137, 19.841362481315926, 19.612403159340218, 18.837535500526428, 19.029877807945013, 18.56502164900303, 23.827050548046827, 23.707018919289112, 23.73877403885126, 20.205458864569664, 20.221216823905706, 19.96798535436392, 9.04594390715161, 9.026616542289645, 8.756777914861829, 19.536571239431694, 19.2501204808553, 19.65700251733263, 28.392182581747562, 28.07277217755714, 27.996126043299824, 22.748176284134388, 22.681100867688656, 22.758660554885864, 22.654461205005646, 23.383198618888855, 23.33556379750371, 18.610647858430937, 18.305408169825867, 18.426813443501786, 22.840867154921085, 22.76917336570719, 22.50590332845846, 10.940328354636819, 10.445139894882828, 11.079187581936509, 27.962646587441355, 27.488547573486954, 27.930141827712447, 14.108956262469292, 13.75139231979847, 14.731280628591776, 19.270303958406046, 19.264060111095503, 18.994213623305157, 17.601135549445942, 17.421405417223767, 17.032857452829674, 17.88667517155409, 17.44710086286068, 17.948256604373455, 22.538949268559605, 22.351918684939534, 22.655136379102856, 14.205030997594193, 14.36952519540985, 14.144652796288327, 19.755362644791603, 19.781929031014442, 19.926471915096045, 17.393922196080283, 16.819339772065476, 17.439303589363888, 23.262911101182297, 23.56153892104824, 23.348869418104485, 18.507219675928354, 18.662630922161043, 18.656389403156936, 16.82275792707999, 16.97980472942193, 16.83513270815213, 17.83655073493719, 17.96410832554102, 18.237881767563522, 16.17879032467802, 16.07650376235445, 16.136319705595568, 18.820049479603767, 18.844085536897182, 19.081331813707948, 19.38091757396856, 20.25732019605735, 20.188077619920165, 9.602766049404934, 9.775431559731558, 9.27083247651656, 16.211224121352032, 16.77672233242386, 15.979465280969933, 20.334026431043938, 20.62658804406722, 20.193719667692974, 18.352619259307772, 18.393924141923577, 17.9689474950234, 15.135836187750101, 14.650276020169258, 15.319099825341254, -111.1785558780733, -101.2184459588801, -101.70290919144949, 10.572082847356796, 11.376668959856033, 11.486584537196904, 14.895012096812323, 14.425878336032227, 15.056453912829355, 24.479342530171067, 24.307636859516293, 24.728756406034023, 26.174344513875738, 25.673576635619, 26.159572876368955, 21.39669671157995, 21.542663047711045, 21.082713449994714, 17.202790235479668, 16.822325741251305, 17.33961012711127, 23.660646143058926, 23.392742226521165, 23.389981264869363, 16.734968995054558, 16.09659572442372, 16.606671301027134, 22.578915807108075, 22.961328646788985, 22.963097060720116, 11.931293358405426, 12.118797053893402, 12.600944147755698, 17.825521575907857, 18.19811505327621, 18.221668964872748, -78.98431692520778, -86.1174347649018, -75.94836527730028, 9.369064355734736, 8.918509192764759, 8.755160391330719, 4.939869786302239, 3.739587138096482, 4.937745290497929, 26.024453761676938, 25.365004325906426, 26.42527684631446, 20.14591260502735, 20.308982028315455, 20.55569151105979, 10.314908720552921, 10.243491068482399, 10.35251709073782, 12.69942154424885, 12.760165112713963, 12.242731566230447, 23.226721862951905, 23.764233792821557, 23.057256321112305, 17.384962695340306, 17.62161952878037, 17.548588937769324, 18.458712751666695, 18.4179964835445, 18.787336227173597, 27.10451190173626, 27.295963529497385, 27.048072561621666, 17.709489703178406, 18.37939701601863, 17.72090645134449, 26.588945781191185, 25.93012923498948, 26.549882908662156, 18.442610306044415, 18.745226067801312, 18.25805938740571, 13.637553174359098, 13.033929770191506, 13.587622824435428, 8.089599822958306, 7.856394266088799, 8.411423656468585, 9.754459430774048, 10.023035128911332, 10.406140518685177, 24.30954375738898, 24.476412580969424, 24.029303560654313, 33.65917198111613, 33.209180792172745, 33.73910430570443, 18.247402918835476, 18.328247018119626, 18.243266328548387, 25.444371203581483, 25.701647984484822, 25.58368296052018, 16.708352367083222, 16.483012462655694, 17.04745666279146, 19.633513316822544, 19.53217639153202, 19.691402622576177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14580790126657742, "mean_inference_ms": 0.6877734114505081, "mean_action_processing_ms": 0.09998126011516453, "mean_env_wait_ms": 0.841983694616034, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 385000, "timesteps_this_iter": 0, "agent_timesteps_total": 1155000, "timers": {"sample_time_ms": 10984.046, "sample_throughput": 455.206, "load_time_ms": 0.101, "load_throughput": 49636733.728, "learn_time_ms": 1589.081, "learn_throughput": 3146.472, "update_time_ms": 8.957}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2204460492503132e-17, "cur_lr": 0.0005000000000000001, "total_loss": 5.864979600906372, "policy_loss": -0.0026205009904845867, "vf_loss": 5.9550214290618895, "vf_explained_var": -0.1677908182144165, "kl": 0.003654013318028149, "entropy": 8.74214792251587, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 385000, "num_agent_steps_sampled": 1155000, "num_steps_trained": 385000, "num_agent_steps_trained": 1155000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1618, "training_iteration": 77, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-22-55", "timestamp": 1706228575, "time_this_iter_s": 10.432615995407104, "time_total_s": 817.9647686481476, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202823BE1F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 817.9647686481476, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 8.100000000000001, "ram_util_percent": 54.77999999999999}}
{"episode_reward_max": 100.6074570789933, "episode_reward_min": -314.09991102840286, "episode_reward_mean": 41.289533128665056, "episode_len_mean": 491.83, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -111.1785558780733}, "policy_reward_max": {"shared_policy": 33.73910430570443}, "policy_reward_mean": {"shared_policy": 13.763177709555015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.68926971033213, 67.94063475728034, 38.40267070010303, 56.60655389726159, 15.951185941696167, 20.63691933033985, 37.98645042255518, 53.464034568518386, 69.65765576064587, 49.57234625332056, 51.32656567543742, 42.647960111498804, 53.90916645713149, 30.747764967381954, 26.884671358391643, 48.39659471809864, 24.44545689225197, 26.330366205424056, 78.49337562173602, 43.519068799912915, 77.86236525326966, -266.05314495414495, 59.42798769474028, 56.43243495747447, 71.2728435061872, 60.39466104283929, 26.829338364303084, 58.443694237619624, 84.46108080260453, 68.18793770670891, 69.37322362139821, 55.34286947175859, 68.11594384908673, 32.464655831456156, 83.38133598864076, 42.59162921085954, 57.52857769280671, 52.05539841949938, 53.28203263878822, 67.546004332602, 42.71920898929237, 59.46376359090209, 51.65256555750965, 70.17331944033502, 55.82624000124633, 50.63769536465405, 54.03854082804173, 48.391613792628036, 56.7454668302089, 59.826315389946075, 28.649030085653052, 48.96741173474582, 61.15433414280413, 54.71549089625475, 45.105212033260614, -314.09991102840286, 33.435336344409734, 44.377344345673905, 73.51573579572138, 78.00749402586369, 64.02207320928571, 51.364726103842244, 70.44336963444945, 49.438236020505414, 68.50334151461718, 36.651034560054526, 54.245305594056816, -241.05011696740985, 27.042733939830214, 13.61720221489665, 77.81473493389782, 61.010586144402595, 30.91091687977314, 37.70231822319326, 70.04821197688577, 52.55517116189, 55.66404546238479, 81.44854799285531, 53.809793170541525, 79.06895792484282, 55.445895761251435, 40.25910576898603, 24.35741774551569, 30.183635078370557, 72.81525989901272, 100.6074570789933, 54.81891626550349, 76.72970214858648, 50.23882149253038, 58.85709233093074, 55.50536608695981, -259.1314719170332, 56.18256562948227, 53.611168479546876, 36.32126317918298, 84.84900727961212, 58.30909163877365, 40.47206746041775, 90.76198944356291, 68.59598234295842], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 424, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 52, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 358, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 349, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [21.888049783805997, 21.924354730794818, 21.876865195731312, 22.743918289740876, 22.1122608979543, 23.08445556958516, 12.265473400553063, 13.119271659602717, 13.01792563994725, 18.862976665298135, 18.870928371946007, 18.87264886001745, 5.401897445321083, 5.171361543238163, 5.377926953136921, 7.0831193017462795, 7.287036316624523, 6.266763711969048, 12.610619379828364, 12.7783179792265, 12.597513063500315, 17.91618865480025, 17.460687985022858, 18.087157928695277, 23.506420984864235, 23.196823805570602, 22.95441097021103, 16.327857752641037, 16.443786700566605, 16.80070180011292, 17.178524809579045, 17.007138806084782, 17.140902059773595, 14.68722368280092, 13.905007417003304, 14.05572901169458, 17.96999905010064, 18.30516450790067, 17.63400289913018, 10.227147825062275, 10.196824073791504, 10.323793068528175, 8.551747485995293, 8.746880203485489, 9.586043668910861, 16.081180214881897, 16.369254231452942, 15.946160271763802, 8.236644327640533, 8.237536385655403, 7.971276178956032, 8.665265445907906, 8.644340862830475, 9.020759896685675, 26.38334701831141, 26.25172010685006, 25.85830849657455, 14.865382534762219, 14.110060592492417, 14.54362567265828, 25.93786175300677, 25.97022411351402, 25.954279386748865, -88.72552901009719, -88.66254213700692, -88.66507380704086, 19.974222054084137, 19.841362481315926, 19.612403159340218, 18.837535500526428, 19.029877807945013, 18.56502164900303, 23.827050548046827, 23.707018919289112, 23.73877403885126, 20.205458864569664, 20.221216823905706, 19.96798535436392, 9.04594390715161, 9.026616542289645, 8.756777914861829, 19.536571239431694, 19.2501204808553, 19.65700251733263, 28.392182581747562, 28.07277217755714, 27.996126043299824, 22.748176284134388, 22.681100867688656, 22.758660554885864, 22.654461205005646, 23.383198618888855, 23.33556379750371, 18.610647858430937, 18.305408169825867, 18.426813443501786, 22.840867154921085, 22.76917336570719, 22.50590332845846, 10.940328354636819, 10.445139894882828, 11.079187581936509, 27.962646587441355, 27.488547573486954, 27.930141827712447, 14.108956262469292, 13.75139231979847, 14.731280628591776, 19.270303958406046, 19.264060111095503, 18.994213623305157, 17.601135549445942, 17.421405417223767, 17.032857452829674, 17.88667517155409, 17.44710086286068, 17.948256604373455, 22.538949268559605, 22.351918684939534, 22.655136379102856, 14.205030997594193, 14.36952519540985, 14.144652796288327, 19.755362644791603, 19.781929031014442, 19.926471915096045, 17.393922196080283, 16.819339772065476, 17.439303589363888, 23.262911101182297, 23.56153892104824, 23.348869418104485, 18.507219675928354, 18.662630922161043, 18.656389403156936, 16.82275792707999, 16.97980472942193, 16.83513270815213, 17.83655073493719, 17.96410832554102, 18.237881767563522, 16.17879032467802, 16.07650376235445, 16.136319705595568, 18.820049479603767, 18.844085536897182, 19.081331813707948, 19.38091757396856, 20.25732019605735, 20.188077619920165, 9.602766049404934, 9.775431559731558, 9.27083247651656, 16.211224121352032, 16.77672233242386, 15.979465280969933, 20.334026431043938, 20.62658804406722, 20.193719667692974, 18.352619259307772, 18.393924141923577, 17.9689474950234, 15.135836187750101, 14.650276020169258, 15.319099825341254, -111.1785558780733, -101.2184459588801, -101.70290919144949, 10.572082847356796, 11.376668959856033, 11.486584537196904, 14.895012096812323, 14.425878336032227, 15.056453912829355, 24.479342530171067, 24.307636859516293, 24.728756406034023, 26.174344513875738, 25.673576635619, 26.159572876368955, 21.39669671157995, 21.542663047711045, 21.082713449994714, 17.202790235479668, 16.822325741251305, 17.33961012711127, 23.660646143058926, 23.392742226521165, 23.389981264869363, 16.734968995054558, 16.09659572442372, 16.606671301027134, 22.578915807108075, 22.961328646788985, 22.963097060720116, 11.931293358405426, 12.118797053893402, 12.600944147755698, 17.825521575907857, 18.19811505327621, 18.221668964872748, -78.98431692520778, -86.1174347649018, -75.94836527730028, 9.369064355734736, 8.918509192764759, 8.755160391330719, 4.939869786302239, 3.739587138096482, 4.937745290497929, 26.024453761676938, 25.365004325906426, 26.42527684631446, 20.14591260502735, 20.308982028315455, 20.55569151105979, 10.314908720552921, 10.243491068482399, 10.35251709073782, 12.69942154424885, 12.760165112713963, 12.242731566230447, 23.226721862951905, 23.764233792821557, 23.057256321112305, 17.384962695340306, 17.62161952878037, 17.548588937769324, 18.458712751666695, 18.4179964835445, 18.787336227173597, 27.10451190173626, 27.295963529497385, 27.048072561621666, 17.709489703178406, 18.37939701601863, 17.72090645134449, 26.588945781191185, 25.93012923498948, 26.549882908662156, 18.442610306044415, 18.745226067801312, 18.25805938740571, 13.637553174359098, 13.033929770191506, 13.587622824435428, 8.089599822958306, 7.856394266088799, 8.411423656468585, 9.754459430774048, 10.023035128911332, 10.406140518685177, 24.30954375738898, 24.476412580969424, 24.029303560654313, 33.65917198111613, 33.209180792172745, 33.73910430570443, 18.247402918835476, 18.328247018119626, 18.243266328548387, 25.444371203581483, 25.701647984484822, 25.58368296052018, 16.708352367083222, 16.483012462655694, 17.04745666279146, 19.633513316822544, 19.53217639153202, 19.691402622576177, 17.999082202712685, 18.73042035351196, 18.775863530735165, -83.54467671116194, -92.86365277816853, -82.72314242770275, 18.294130742549896, 19.096610724925995, 18.791824162006378, 18.19327985557416, 17.46693695584932, 17.950951668123395, 11.980549226204545, 12.515675927201897, 11.825038025776536, 28.337470546364784, 28.610974938608706, 27.900561794638634, 19.414881775776536, 19.053350920478493, 19.840858942518622, 13.372123345732689, 13.529536567628384, 13.570407547056675, 30.21514145036538, 30.260924113293484, 30.285923879904047, 22.704277063409478, 22.808836388091237, 23.082868891457707]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14574319721888063, "mean_inference_ms": 0.6880754481755795, "mean_action_processing_ms": 0.09999511006671911, "mean_env_wait_ms": 0.8426221954803885, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 390000, "timesteps_this_iter": 0, "agent_timesteps_total": 1170000, "timers": {"sample_time_ms": 10891.704, "sample_throughput": 459.065, "load_time_ms": 0.101, "load_throughput": 49636733.728, "learn_time_ms": 1574.623, "learn_throughput": 3175.363, "update_time_ms": 8.311}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1102230246251566e-17, "cur_lr": 0.0005000000000000001, "total_loss": 93.00965728759766, "policy_loss": -0.0011337858863764705, "vf_loss": 93.09778518676758, "vf_explained_var": -0.015764808654785155, "kl": 0.005824164184759902, "entropy": 8.699750995635986, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 390000, "num_agent_steps_sampled": 1170000, "num_steps_trained": 390000, "num_agent_steps_trained": 1170000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1628, "training_iteration": 78, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-23-05", "timestamp": 1706228585, "time_this_iter_s": 10.383361101150513, "time_total_s": 828.3481297492981, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282542820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 828.3481297492981, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 7.864285714285715, "ram_util_percent": 54.80714285714284}}
{"episode_reward_max": 100.6074570789933, "episode_reward_min": -314.09991102840286, "episode_reward_mean": 41.70672730982419, "episode_len_mean": 491.83, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -111.1785558780733}, "policy_reward_max": {"shared_policy": 33.73910430570443}, "policy_reward_mean": {"shared_policy": 13.902242436608061}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.32656567543742, 42.647960111498804, 53.90916645713149, 30.747764967381954, 26.884671358391643, 48.39659471809864, 24.44545689225197, 26.330366205424056, 78.49337562173602, 43.519068799912915, 77.86236525326966, -266.05314495414495, 59.42798769474028, 56.43243495747447, 71.2728435061872, 60.39466104283929, 26.829338364303084, 58.443694237619624, 84.46108080260453, 68.18793770670891, 69.37322362139821, 55.34286947175859, 68.11594384908673, 32.464655831456156, 83.38133598864076, 42.59162921085954, 57.52857769280671, 52.05539841949938, 53.28203263878822, 67.546004332602, 42.71920898929237, 59.46376359090209, 51.65256555750965, 70.17331944033502, 55.82624000124633, 50.63769536465405, 54.03854082804173, 48.391613792628036, 56.7454668302089, 59.826315389946075, 28.649030085653052, 48.96741173474582, 61.15433414280413, 54.71549089625475, 45.105212033260614, -314.09991102840286, 33.435336344409734, 44.377344345673905, 73.51573579572138, 78.00749402586369, 64.02207320928571, 51.364726103842244, 70.44336963444945, 49.438236020505414, 68.50334151461718, 36.651034560054526, 54.245305594056816, -241.05011696740985, 27.042733939830214, 13.61720221489665, 77.81473493389782, 61.010586144402595, 30.91091687977314, 37.70231822319326, 70.04821197688577, 52.55517116189, 55.66404546238479, 81.44854799285531, 53.809793170541525, 79.06895792484282, 55.445895761251435, 40.25910576898603, 24.35741774551569, 30.183635078370557, 72.81525989901272, 100.6074570789933, 54.81891626550349, 76.72970214858648, 50.23882149253038, 58.85709233093074, 55.50536608695981, -259.1314719170332, 56.18256562948227, 53.611168479546876, 36.32126317918298, 84.84900727961212, 58.30909163877365, 40.47206746041775, 90.76198944356291, 68.59598234295842, 62.917863626265884, 48.90364116989075, 59.96369960345325, 32.31119751930234, 58.914441676810384, 41.16773390769956, 34.7411971464753, 63.39257007488048, 42.54695648979394, 72.76783824339509], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 424, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 52, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 358, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 349, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [17.178524809579045, 17.007138806084782, 17.140902059773595, 14.68722368280092, 13.905007417003304, 14.05572901169458, 17.96999905010064, 18.30516450790067, 17.63400289913018, 10.227147825062275, 10.196824073791504, 10.323793068528175, 8.551747485995293, 8.746880203485489, 9.586043668910861, 16.081180214881897, 16.369254231452942, 15.946160271763802, 8.236644327640533, 8.237536385655403, 7.971276178956032, 8.665265445907906, 8.644340862830475, 9.020759896685675, 26.38334701831141, 26.25172010685006, 25.85830849657455, 14.865382534762219, 14.110060592492417, 14.54362567265828, 25.93786175300677, 25.97022411351402, 25.954279386748865, -88.72552901009719, -88.66254213700692, -88.66507380704086, 19.974222054084137, 19.841362481315926, 19.612403159340218, 18.837535500526428, 19.029877807945013, 18.56502164900303, 23.827050548046827, 23.707018919289112, 23.73877403885126, 20.205458864569664, 20.221216823905706, 19.96798535436392, 9.04594390715161, 9.026616542289645, 8.756777914861829, 19.536571239431694, 19.2501204808553, 19.65700251733263, 28.392182581747562, 28.07277217755714, 27.996126043299824, 22.748176284134388, 22.681100867688656, 22.758660554885864, 22.654461205005646, 23.383198618888855, 23.33556379750371, 18.610647858430937, 18.305408169825867, 18.426813443501786, 22.840867154921085, 22.76917336570719, 22.50590332845846, 10.940328354636819, 10.445139894882828, 11.079187581936509, 27.962646587441355, 27.488547573486954, 27.930141827712447, 14.108956262469292, 13.75139231979847, 14.731280628591776, 19.270303958406046, 19.264060111095503, 18.994213623305157, 17.601135549445942, 17.421405417223767, 17.032857452829674, 17.88667517155409, 17.44710086286068, 17.948256604373455, 22.538949268559605, 22.351918684939534, 22.655136379102856, 14.205030997594193, 14.36952519540985, 14.144652796288327, 19.755362644791603, 19.781929031014442, 19.926471915096045, 17.393922196080283, 16.819339772065476, 17.439303589363888, 23.262911101182297, 23.56153892104824, 23.348869418104485, 18.507219675928354, 18.662630922161043, 18.656389403156936, 16.82275792707999, 16.97980472942193, 16.83513270815213, 17.83655073493719, 17.96410832554102, 18.237881767563522, 16.17879032467802, 16.07650376235445, 16.136319705595568, 18.820049479603767, 18.844085536897182, 19.081331813707948, 19.38091757396856, 20.25732019605735, 20.188077619920165, 9.602766049404934, 9.775431559731558, 9.27083247651656, 16.211224121352032, 16.77672233242386, 15.979465280969933, 20.334026431043938, 20.62658804406722, 20.193719667692974, 18.352619259307772, 18.393924141923577, 17.9689474950234, 15.135836187750101, 14.650276020169258, 15.319099825341254, -111.1785558780733, -101.2184459588801, -101.70290919144949, 10.572082847356796, 11.376668959856033, 11.486584537196904, 14.895012096812323, 14.425878336032227, 15.056453912829355, 24.479342530171067, 24.307636859516293, 24.728756406034023, 26.174344513875738, 25.673576635619, 26.159572876368955, 21.39669671157995, 21.542663047711045, 21.082713449994714, 17.202790235479668, 16.822325741251305, 17.33961012711127, 23.660646143058926, 23.392742226521165, 23.389981264869363, 16.734968995054558, 16.09659572442372, 16.606671301027134, 22.578915807108075, 22.961328646788985, 22.963097060720116, 11.931293358405426, 12.118797053893402, 12.600944147755698, 17.825521575907857, 18.19811505327621, 18.221668964872748, -78.98431692520778, -86.1174347649018, -75.94836527730028, 9.369064355734736, 8.918509192764759, 8.755160391330719, 4.939869786302239, 3.739587138096482, 4.937745290497929, 26.024453761676938, 25.365004325906426, 26.42527684631446, 20.14591260502735, 20.308982028315455, 20.55569151105979, 10.314908720552921, 10.243491068482399, 10.35251709073782, 12.69942154424885, 12.760165112713963, 12.242731566230447, 23.226721862951905, 23.764233792821557, 23.057256321112305, 17.384962695340306, 17.62161952878037, 17.548588937769324, 18.458712751666695, 18.4179964835445, 18.787336227173597, 27.10451190173626, 27.295963529497385, 27.048072561621666, 17.709489703178406, 18.37939701601863, 17.72090645134449, 26.588945781191185, 25.93012923498948, 26.549882908662156, 18.442610306044415, 18.745226067801312, 18.25805938740571, 13.637553174359098, 13.033929770191506, 13.587622824435428, 8.089599822958306, 7.856394266088799, 8.411423656468585, 9.754459430774048, 10.023035128911332, 10.406140518685177, 24.30954375738898, 24.476412580969424, 24.029303560654313, 33.65917198111613, 33.209180792172745, 33.73910430570443, 18.247402918835476, 18.328247018119626, 18.243266328548387, 25.444371203581483, 25.701647984484822, 25.58368296052018, 16.708352367083222, 16.483012462655694, 17.04745666279146, 19.633513316822544, 19.53217639153202, 19.691402622576177, 17.999082202712685, 18.73042035351196, 18.775863530735165, -83.54467671116194, -92.86365277816853, -82.72314242770275, 18.294130742549896, 19.096610724925995, 18.791824162006378, 18.19327985557416, 17.46693695584932, 17.950951668123395, 11.980549226204545, 12.515675927201897, 11.825038025776536, 28.337470546364784, 28.610974938608706, 27.900561794638634, 19.414881775776536, 19.053350920478493, 19.840858942518622, 13.372123345732689, 13.529536567628384, 13.570407547056675, 30.21514145036538, 30.260924113293484, 30.285923879904047, 22.704277063409478, 22.808836388091237, 23.082868891457707, 21.33038854373929, 20.40411405762036, 21.183361024906233, 16.006222938497856, 17.00475734037657, 15.89266089101632, 20.168980666125805, 19.81148017446199, 19.983238762865454, 10.945461715261132, 11.14873858789602, 10.216997216145188, 19.636127829551697, 19.916250558570027, 19.36206328868866, 13.757309744755418, 13.626888411740453, 13.783535751203686, 11.635547277828053, 11.633470353980854, 11.472179514666394, 21.508279794439048, 21.33094472934802, 20.553345551093415, 14.52471717478086, 14.433586222430066, 13.588653092583016, 24.18301396816969, 24.067622877657413, 24.517201397567987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14566601633065354, "mean_inference_ms": 0.6883021052701647, "mean_action_processing_ms": 0.10000193668557095, "mean_env_wait_ms": 0.843224983001414, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 395000, "timesteps_this_iter": 0, "agent_timesteps_total": 1185000, "timers": {"sample_time_ms": 10818.501, "sample_throughput": 462.171, "load_time_ms": 0.201, "load_throughput": 24912710.858, "learn_time_ms": 1564.042, "learn_throughput": 3196.844, "update_time_ms": 8.162}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1102230246251566e-17, "cur_lr": 0.0005000000000000001, "total_loss": 3.7713525533676147, "policy_loss": -0.002986110166038003, "vf_loss": 3.862517499923706, "vf_explained_var": -0.23817770481109618, "kl": 0.0033465103595717314, "entropy": 8.817890071868897, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 395000, "num_agent_steps_sampled": 1185000, "num_steps_trained": 395000, "num_agent_steps_trained": 1185000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1638, "training_iteration": 79, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-23-16", "timestamp": 1706228596, "time_this_iter_s": 10.40244746208191, "time_total_s": 838.75057721138, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202822183A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 838.75057721138, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 8.520000000000001, "ram_util_percent": 54.83999999999999}}
{"episode_reward_max": 100.6074570789933, "episode_reward_min": -314.96595004945993, "episode_reward_mean": 38.99628758713253, "episode_len_mean": 487.55, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -112.05555311838786}, "policy_reward_max": {"shared_policy": 33.73910430570443}, "policy_reward_mean": {"shared_policy": 12.998762529044173}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-266.05314495414495, 59.42798769474028, 56.43243495747447, 71.2728435061872, 60.39466104283929, 26.829338364303084, 58.443694237619624, 84.46108080260453, 68.18793770670891, 69.37322362139821, 55.34286947175859, 68.11594384908673, 32.464655831456156, 83.38133598864076, 42.59162921085954, 57.52857769280671, 52.05539841949938, 53.28203263878822, 67.546004332602, 42.71920898929237, 59.46376359090209, 51.65256555750965, 70.17331944033502, 55.82624000124633, 50.63769536465405, 54.03854082804173, 48.391613792628036, 56.7454668302089, 59.826315389946075, 28.649030085653052, 48.96741173474582, 61.15433414280413, 54.71549089625475, 45.105212033260614, -314.09991102840286, 33.435336344409734, 44.377344345673905, 73.51573579572138, 78.00749402586369, 64.02207320928571, 51.364726103842244, 70.44336963444945, 49.438236020505414, 68.50334151461718, 36.651034560054526, 54.245305594056816, -241.05011696740985, 27.042733939830214, 13.61720221489665, 77.81473493389782, 61.010586144402595, 30.91091687977314, 37.70231822319326, 70.04821197688577, 52.55517116189, 55.66404546238479, 81.44854799285531, 53.809793170541525, 79.06895792484282, 55.445895761251435, 40.25910576898603, 24.35741774551569, 30.183635078370557, 72.81525989901272, 100.6074570789933, 54.81891626550349, 76.72970214858648, 50.23882149253038, 58.85709233093074, 55.50536608695981, -259.1314719170332, 56.18256562948227, 53.611168479546876, 36.32126317918298, 84.84900727961212, 58.30909163877365, 40.47206746041775, 90.76198944356291, 68.59598234295842, 62.917863626265884, 48.90364116989075, 59.96369960345325, 32.31119751930234, 58.914441676810384, 41.16773390769956, 34.7411971464753, 63.39257007488048, 42.54695648979394, 72.76783824339509, 58.81305228546259, -314.96595004945993, 63.82524815108627, 68.80988309532404, 45.949420183897004, 65.54899225803089, 52.68392744101581, 24.419940739870043, 49.864520715549574, 68.5565176345408, 50.0138313360512], "episode_lengths": [424, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 52, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 358, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 349, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 72, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-88.72552901009719, -88.66254213700692, -88.66507380704086, 19.974222054084137, 19.841362481315926, 19.612403159340218, 18.837535500526428, 19.029877807945013, 18.56502164900303, 23.827050548046827, 23.707018919289112, 23.73877403885126, 20.205458864569664, 20.221216823905706, 19.96798535436392, 9.04594390715161, 9.026616542289645, 8.756777914861829, 19.536571239431694, 19.2501204808553, 19.65700251733263, 28.392182581747562, 28.07277217755714, 27.996126043299824, 22.748176284134388, 22.681100867688656, 22.758660554885864, 22.654461205005646, 23.383198618888855, 23.33556379750371, 18.610647858430937, 18.305408169825867, 18.426813443501786, 22.840867154921085, 22.76917336570719, 22.50590332845846, 10.940328354636819, 10.445139894882828, 11.079187581936509, 27.962646587441355, 27.488547573486954, 27.930141827712447, 14.108956262469292, 13.75139231979847, 14.731280628591776, 19.270303958406046, 19.264060111095503, 18.994213623305157, 17.601135549445942, 17.421405417223767, 17.032857452829674, 17.88667517155409, 17.44710086286068, 17.948256604373455, 22.538949268559605, 22.351918684939534, 22.655136379102856, 14.205030997594193, 14.36952519540985, 14.144652796288327, 19.755362644791603, 19.781929031014442, 19.926471915096045, 17.393922196080283, 16.819339772065476, 17.439303589363888, 23.262911101182297, 23.56153892104824, 23.348869418104485, 18.507219675928354, 18.662630922161043, 18.656389403156936, 16.82275792707999, 16.97980472942193, 16.83513270815213, 17.83655073493719, 17.96410832554102, 18.237881767563522, 16.17879032467802, 16.07650376235445, 16.136319705595568, 18.820049479603767, 18.844085536897182, 19.081331813707948, 19.38091757396856, 20.25732019605735, 20.188077619920165, 9.602766049404934, 9.775431559731558, 9.27083247651656, 16.211224121352032, 16.77672233242386, 15.979465280969933, 20.334026431043938, 20.62658804406722, 20.193719667692974, 18.352619259307772, 18.393924141923577, 17.9689474950234, 15.135836187750101, 14.650276020169258, 15.319099825341254, -111.1785558780733, -101.2184459588801, -101.70290919144949, 10.572082847356796, 11.376668959856033, 11.486584537196904, 14.895012096812323, 14.425878336032227, 15.056453912829355, 24.479342530171067, 24.307636859516293, 24.728756406034023, 26.174344513875738, 25.673576635619, 26.159572876368955, 21.39669671157995, 21.542663047711045, 21.082713449994714, 17.202790235479668, 16.822325741251305, 17.33961012711127, 23.660646143058926, 23.392742226521165, 23.389981264869363, 16.734968995054558, 16.09659572442372, 16.606671301027134, 22.578915807108075, 22.961328646788985, 22.963097060720116, 11.931293358405426, 12.118797053893402, 12.600944147755698, 17.825521575907857, 18.19811505327621, 18.221668964872748, -78.98431692520778, -86.1174347649018, -75.94836527730028, 9.369064355734736, 8.918509192764759, 8.755160391330719, 4.939869786302239, 3.739587138096482, 4.937745290497929, 26.024453761676938, 25.365004325906426, 26.42527684631446, 20.14591260502735, 20.308982028315455, 20.55569151105979, 10.314908720552921, 10.243491068482399, 10.35251709073782, 12.69942154424885, 12.760165112713963, 12.242731566230447, 23.226721862951905, 23.764233792821557, 23.057256321112305, 17.384962695340306, 17.62161952878037, 17.548588937769324, 18.458712751666695, 18.4179964835445, 18.787336227173597, 27.10451190173626, 27.295963529497385, 27.048072561621666, 17.709489703178406, 18.37939701601863, 17.72090645134449, 26.588945781191185, 25.93012923498948, 26.549882908662156, 18.442610306044415, 18.745226067801312, 18.25805938740571, 13.637553174359098, 13.033929770191506, 13.587622824435428, 8.089599822958306, 7.856394266088799, 8.411423656468585, 9.754459430774048, 10.023035128911332, 10.406140518685177, 24.30954375738898, 24.476412580969424, 24.029303560654313, 33.65917198111613, 33.209180792172745, 33.73910430570443, 18.247402918835476, 18.328247018119626, 18.243266328548387, 25.444371203581483, 25.701647984484822, 25.58368296052018, 16.708352367083222, 16.483012462655694, 17.04745666279146, 19.633513316822544, 19.53217639153202, 19.691402622576177, 17.999082202712685, 18.73042035351196, 18.775863530735165, -83.54467671116194, -92.86365277816853, -82.72314242770275, 18.294130742549896, 19.096610724925995, 18.791824162006378, 18.19327985557416, 17.46693695584932, 17.950951668123395, 11.980549226204545, 12.515675927201897, 11.825038025776536, 28.337470546364784, 28.610974938608706, 27.900561794638634, 19.414881775776536, 19.053350920478493, 19.840858942518622, 13.372123345732689, 13.529536567628384, 13.570407547056675, 30.21514145036538, 30.260924113293484, 30.285923879904047, 22.704277063409478, 22.808836388091237, 23.082868891457707, 21.33038854373929, 20.40411405762036, 21.183361024906233, 16.006222938497856, 17.00475734037657, 15.89266089101632, 20.168980666125805, 19.81148017446199, 19.983238762865454, 10.945461715261132, 11.14873858789602, 10.216997216145188, 19.636127829551697, 19.916250558570027, 19.36206328868866, 13.757309744755418, 13.626888411740453, 13.783535751203686, 11.635547277828053, 11.633470353980854, 11.472179514666394, 21.508279794439048, 21.33094472934802, 20.553345551093415, 14.52471717478086, 14.433586222430066, 13.588653092583016, 24.18301396816969, 24.067622877657413, 24.517201397567987, 20.01798968637982, 19.05236570040384, 19.74269689867893, -101.44855315300326, -101.46184377806883, -112.05555311838786, 21.138139873743057, 21.19709751009941, 21.490010767243803, 23.185617819428444, 22.317776650190353, 23.306488625705242, 15.745351289709404, 15.204231714208916, 14.999837179978684, 22.2616495109784, 21.52780836323896, 21.75953438381353, 17.411373051504285, 17.632361565406114, 17.640192824105412, 8.180062035719544, 8.261175165573746, 7.978703538576752, 16.43606812258561, 16.623287597050265, 16.8051649959137, 23.131850961595774, 22.508266031742096, 22.916400641202927, 16.40039339164892, 17.216808362553508, 16.39662958184877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14559297040710134, "mean_inference_ms": 0.6884684015477514, "mean_action_processing_ms": 0.10000232648456944, "mean_env_wait_ms": 0.8437638695406254, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 400000, "timesteps_this_iter": 0, "agent_timesteps_total": 1200000, "timers": {"sample_time_ms": 10801.337, "sample_throughput": 462.906, "load_time_ms": 0.2, "load_throughput": 25010757.305, "learn_time_ms": 1557.633, "learn_throughput": 3209.999, "update_time_ms": 8.062}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.551115123125783e-18, "cur_lr": 0.0005000000000000001, "total_loss": 87.02136535644532, "policy_loss": -0.0034059690898594398, "vf_loss": 87.11121444702148, "vf_explained_var": 0.023968809843063356, "kl": 0.0072309764335123945, "entropy": 8.64415225982666, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 400000, "num_agent_steps_sampled": 1200000, "num_steps_trained": 400000, "num_agent_steps_trained": 1200000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1649, "training_iteration": 80, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-23-26", "timestamp": 1706228606, "time_this_iter_s": 10.674924850463867, "time_total_s": 849.4255020618439, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202825423A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 849.4255020618439, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 9.406666666666666, "ram_util_percent": 54.85999999999999}}
{"episode_reward_max": 100.6074570789933, "episode_reward_min": -314.96595004945993, "episode_reward_mean": 39.1756446541252, "episode_len_mean": 487.99, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -112.05555311838786}, "policy_reward_max": {"shared_policy": 33.73910430570443}, "policy_reward_mean": {"shared_policy": 13.05854821804173}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.34286947175859, 68.11594384908673, 32.464655831456156, 83.38133598864076, 42.59162921085954, 57.52857769280671, 52.05539841949938, 53.28203263878822, 67.546004332602, 42.71920898929237, 59.46376359090209, 51.65256555750965, 70.17331944033502, 55.82624000124633, 50.63769536465405, 54.03854082804173, 48.391613792628036, 56.7454668302089, 59.826315389946075, 28.649030085653052, 48.96741173474582, 61.15433414280413, 54.71549089625475, 45.105212033260614, -314.09991102840286, 33.435336344409734, 44.377344345673905, 73.51573579572138, 78.00749402586369, 64.02207320928571, 51.364726103842244, 70.44336963444945, 49.438236020505414, 68.50334151461718, 36.651034560054526, 54.245305594056816, -241.05011696740985, 27.042733939830214, 13.61720221489665, 77.81473493389782, 61.010586144402595, 30.91091687977314, 37.70231822319326, 70.04821197688577, 52.55517116189, 55.66404546238479, 81.44854799285531, 53.809793170541525, 79.06895792484282, 55.445895761251435, 40.25910576898603, 24.35741774551569, 30.183635078370557, 72.81525989901272, 100.6074570789933, 54.81891626550349, 76.72970214858648, 50.23882149253038, 58.85709233093074, 55.50536608695981, -259.1314719170332, 56.18256562948227, 53.611168479546876, 36.32126317918298, 84.84900727961212, 58.30909163877365, 40.47206746041775, 90.76198944356291, 68.59598234295842, 62.917863626265884, 48.90364116989075, 59.96369960345325, 32.31119751930234, 58.914441676810384, 41.16773390769956, 34.7411971464753, 63.39257007488048, 42.54695648979394, 72.76783824339509, 58.81305228546259, -314.96595004945993, 63.82524815108627, 68.80988309532404, 45.949420183897004, 65.54899225803089, 52.68392744101581, 24.419940739870043, 49.864520715549574, 68.5565176345408, 50.0138313360512, 53.172311648726435, 58.824784485623226, 75.47367307357487, -224.16393211390823, 44.67413065582511, 81.47812472283839, 86.82368048653005, 40.34705045819281, 57.39634453970936, 32.67959572188556], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 52, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 358, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 349, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 72, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [18.610647858430937, 18.305408169825867, 18.426813443501786, 22.840867154921085, 22.76917336570719, 22.50590332845846, 10.940328354636819, 10.445139894882828, 11.079187581936509, 27.962646587441355, 27.488547573486954, 27.930141827712447, 14.108956262469292, 13.75139231979847, 14.731280628591776, 19.270303958406046, 19.264060111095503, 18.994213623305157, 17.601135549445942, 17.421405417223767, 17.032857452829674, 17.88667517155409, 17.44710086286068, 17.948256604373455, 22.538949268559605, 22.351918684939534, 22.655136379102856, 14.205030997594193, 14.36952519540985, 14.144652796288327, 19.755362644791603, 19.781929031014442, 19.926471915096045, 17.393922196080283, 16.819339772065476, 17.439303589363888, 23.262911101182297, 23.56153892104824, 23.348869418104485, 18.507219675928354, 18.662630922161043, 18.656389403156936, 16.82275792707999, 16.97980472942193, 16.83513270815213, 17.83655073493719, 17.96410832554102, 18.237881767563522, 16.17879032467802, 16.07650376235445, 16.136319705595568, 18.820049479603767, 18.844085536897182, 19.081331813707948, 19.38091757396856, 20.25732019605735, 20.188077619920165, 9.602766049404934, 9.775431559731558, 9.27083247651656, 16.211224121352032, 16.77672233242386, 15.979465280969933, 20.334026431043938, 20.62658804406722, 20.193719667692974, 18.352619259307772, 18.393924141923577, 17.9689474950234, 15.135836187750101, 14.650276020169258, 15.319099825341254, -111.1785558780733, -101.2184459588801, -101.70290919144949, 10.572082847356796, 11.376668959856033, 11.486584537196904, 14.895012096812323, 14.425878336032227, 15.056453912829355, 24.479342530171067, 24.307636859516293, 24.728756406034023, 26.174344513875738, 25.673576635619, 26.159572876368955, 21.39669671157995, 21.542663047711045, 21.082713449994714, 17.202790235479668, 16.822325741251305, 17.33961012711127, 23.660646143058926, 23.392742226521165, 23.389981264869363, 16.734968995054558, 16.09659572442372, 16.606671301027134, 22.578915807108075, 22.961328646788985, 22.963097060720116, 11.931293358405426, 12.118797053893402, 12.600944147755698, 17.825521575907857, 18.19811505327621, 18.221668964872748, -78.98431692520778, -86.1174347649018, -75.94836527730028, 9.369064355734736, 8.918509192764759, 8.755160391330719, 4.939869786302239, 3.739587138096482, 4.937745290497929, 26.024453761676938, 25.365004325906426, 26.42527684631446, 20.14591260502735, 20.308982028315455, 20.55569151105979, 10.314908720552921, 10.243491068482399, 10.35251709073782, 12.69942154424885, 12.760165112713963, 12.242731566230447, 23.226721862951905, 23.764233792821557, 23.057256321112305, 17.384962695340306, 17.62161952878037, 17.548588937769324, 18.458712751666695, 18.4179964835445, 18.787336227173597, 27.10451190173626, 27.295963529497385, 27.048072561621666, 17.709489703178406, 18.37939701601863, 17.72090645134449, 26.588945781191185, 25.93012923498948, 26.549882908662156, 18.442610306044415, 18.745226067801312, 18.25805938740571, 13.637553174359098, 13.033929770191506, 13.587622824435428, 8.089599822958306, 7.856394266088799, 8.411423656468585, 9.754459430774048, 10.023035128911332, 10.406140518685177, 24.30954375738898, 24.476412580969424, 24.029303560654313, 33.65917198111613, 33.209180792172745, 33.73910430570443, 18.247402918835476, 18.328247018119626, 18.243266328548387, 25.444371203581483, 25.701647984484822, 25.58368296052018, 16.708352367083222, 16.483012462655694, 17.04745666279146, 19.633513316822544, 19.53217639153202, 19.691402622576177, 17.999082202712685, 18.73042035351196, 18.775863530735165, -83.54467671116194, -92.86365277816853, -82.72314242770275, 18.294130742549896, 19.096610724925995, 18.791824162006378, 18.19327985557416, 17.46693695584932, 17.950951668123395, 11.980549226204545, 12.515675927201897, 11.825038025776536, 28.337470546364784, 28.610974938608706, 27.900561794638634, 19.414881775776536, 19.053350920478493, 19.840858942518622, 13.372123345732689, 13.529536567628384, 13.570407547056675, 30.21514145036538, 30.260924113293484, 30.285923879904047, 22.704277063409478, 22.808836388091237, 23.082868891457707, 21.33038854373929, 20.40411405762036, 21.183361024906233, 16.006222938497856, 17.00475734037657, 15.89266089101632, 20.168980666125805, 19.81148017446199, 19.983238762865454, 10.945461715261132, 11.14873858789602, 10.216997216145188, 19.636127829551697, 19.916250558570027, 19.36206328868866, 13.757309744755418, 13.626888411740453, 13.783535751203686, 11.635547277828053, 11.633470353980854, 11.472179514666394, 21.508279794439048, 21.33094472934802, 20.553345551093415, 14.52471717478086, 14.433586222430066, 13.588653092583016, 24.18301396816969, 24.067622877657413, 24.517201397567987, 20.01798968637982, 19.05236570040384, 19.74269689867893, -101.44855315300326, -101.46184377806883, -112.05555311838786, 21.138139873743057, 21.19709751009941, 21.490010767243803, 23.185617819428444, 22.317776650190353, 23.306488625705242, 15.745351289709404, 15.204231714208916, 14.999837179978684, 22.2616495109784, 21.52780836323896, 21.75953438381353, 17.411373051504285, 17.632361565406114, 17.640192824105412, 8.180062035719544, 8.261175165573746, 7.978703538576752, 16.43606812258561, 16.623287597050265, 16.8051649959137, 23.131850961595774, 22.508266031742096, 22.916400641202927, 16.40039339164892, 17.216808362553508, 16.39662958184877, 17.77682741979757, 17.697590606907994, 17.69789362202087, 20.22295788240929, 19.997621302803353, 18.604205300410584, 25.08892661581436, 25.176859765003115, 25.2078866927574, -72.04821163415909, -81.36131459474564, -70.75440588500351, 15.216504501799733, 14.926926548282296, 14.53069960574308, 27.195011177410677, 27.24860145275791, 27.0345120926698, 29.11794109952946, 29.11314255309601, 28.59259683390458, 13.794353564580277, 13.672866781552628, 12.879830112059906, 18.909288505713135, 19.36550000278899, 19.121556031207234, 10.598305776715279, 10.819570809602737, 11.261719135567546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14552801195513587, "mean_inference_ms": 0.6885924357545258, "mean_action_processing_ms": 0.1000171561169271, "mean_env_wait_ms": 0.8442222704323556, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 405000, "timesteps_this_iter": 0, "agent_timesteps_total": 1215000, "timers": {"sample_time_ms": 10743.727, "sample_throughput": 465.388, "load_time_ms": 0.2, "load_throughput": 25010757.305, "learn_time_ms": 1551.907, "learn_throughput": 3221.842, "update_time_ms": 8.055}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.551115123125783e-18, "cur_lr": 0.0005000000000000001, "total_loss": 102.55942230224609, "policy_loss": -0.0012871097930359787, "vf_loss": 102.64869003295898, "vf_explained_var": -0.01546698808670044, "kl": 0.006836326379581632, "entropy": 8.797924327850343, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 405000, "num_agent_steps_sampled": 1215000, "num_steps_trained": 405000, "num_agent_steps_trained": 1215000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1659, "training_iteration": 81, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-23-38", "timestamp": 1706228618, "time_this_iter_s": 11.143628597259521, "time_total_s": 860.5691306591034, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282575CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 860.5691306591034, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 8.450000000000001, "ram_util_percent": 54.9125}}
{"episode_reward_max": 100.6074570789933, "episode_reward_min": -314.96595004945993, "episode_reward_mean": 40.10888436749227, "episode_len_mean": 487.99, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -112.05555311838786}, "policy_reward_max": {"shared_policy": 33.73910430570443}, "policy_reward_mean": {"shared_policy": 13.36962812249742}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.46376359090209, 51.65256555750965, 70.17331944033502, 55.82624000124633, 50.63769536465405, 54.03854082804173, 48.391613792628036, 56.7454668302089, 59.826315389946075, 28.649030085653052, 48.96741173474582, 61.15433414280413, 54.71549089625475, 45.105212033260614, -314.09991102840286, 33.435336344409734, 44.377344345673905, 73.51573579572138, 78.00749402586369, 64.02207320928571, 51.364726103842244, 70.44336963444945, 49.438236020505414, 68.50334151461718, 36.651034560054526, 54.245305594056816, -241.05011696740985, 27.042733939830214, 13.61720221489665, 77.81473493389782, 61.010586144402595, 30.91091687977314, 37.70231822319326, 70.04821197688577, 52.55517116189, 55.66404546238479, 81.44854799285531, 53.809793170541525, 79.06895792484282, 55.445895761251435, 40.25910576898603, 24.35741774551569, 30.183635078370557, 72.81525989901272, 100.6074570789933, 54.81891626550349, 76.72970214858648, 50.23882149253038, 58.85709233093074, 55.50536608695981, -259.1314719170332, 56.18256562948227, 53.611168479546876, 36.32126317918298, 84.84900727961212, 58.30909163877365, 40.47206746041775, 90.76198944356291, 68.59598234295842, 62.917863626265884, 48.90364116989075, 59.96369960345325, 32.31119751930234, 58.914441676810384, 41.16773390769956, 34.7411971464753, 63.39257007488048, 42.54695648979394, 72.76783824339509, 58.81305228546259, -314.96595004945993, 63.82524815108627, 68.80988309532404, 45.949420183897004, 65.54899225803089, 52.68392744101581, 24.419940739870043, 49.864520715549574, 68.5565176345408, 50.0138313360512, 53.172311648726435, 58.824784485623226, 75.47367307357487, -224.16393211390823, 44.67413065582511, 81.47812472283839, 86.82368048653005, 40.34705045819281, 57.39634453970936, 32.67959572188556, 41.40538874827325, 88.0939430836588, 92.94918186683208, 44.81642309483138, 74.00056425482033, 65.64858710765839, 65.72329428326336, 68.98304583877322, 41.8880281727761, 64.84317131061107], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 52, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 358, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 349, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 72, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [19.755362644791603, 19.781929031014442, 19.926471915096045, 17.393922196080283, 16.819339772065476, 17.439303589363888, 23.262911101182297, 23.56153892104824, 23.348869418104485, 18.507219675928354, 18.662630922161043, 18.656389403156936, 16.82275792707999, 16.97980472942193, 16.83513270815213, 17.83655073493719, 17.96410832554102, 18.237881767563522, 16.17879032467802, 16.07650376235445, 16.136319705595568, 18.820049479603767, 18.844085536897182, 19.081331813707948, 19.38091757396856, 20.25732019605735, 20.188077619920165, 9.602766049404934, 9.775431559731558, 9.27083247651656, 16.211224121352032, 16.77672233242386, 15.979465280969933, 20.334026431043938, 20.62658804406722, 20.193719667692974, 18.352619259307772, 18.393924141923577, 17.9689474950234, 15.135836187750101, 14.650276020169258, 15.319099825341254, -111.1785558780733, -101.2184459588801, -101.70290919144949, 10.572082847356796, 11.376668959856033, 11.486584537196904, 14.895012096812323, 14.425878336032227, 15.056453912829355, 24.479342530171067, 24.307636859516293, 24.728756406034023, 26.174344513875738, 25.673576635619, 26.159572876368955, 21.39669671157995, 21.542663047711045, 21.082713449994714, 17.202790235479668, 16.822325741251305, 17.33961012711127, 23.660646143058926, 23.392742226521165, 23.389981264869363, 16.734968995054558, 16.09659572442372, 16.606671301027134, 22.578915807108075, 22.961328646788985, 22.963097060720116, 11.931293358405426, 12.118797053893402, 12.600944147755698, 17.825521575907857, 18.19811505327621, 18.221668964872748, -78.98431692520778, -86.1174347649018, -75.94836527730028, 9.369064355734736, 8.918509192764759, 8.755160391330719, 4.939869786302239, 3.739587138096482, 4.937745290497929, 26.024453761676938, 25.365004325906426, 26.42527684631446, 20.14591260502735, 20.308982028315455, 20.55569151105979, 10.314908720552921, 10.243491068482399, 10.35251709073782, 12.69942154424885, 12.760165112713963, 12.242731566230447, 23.226721862951905, 23.764233792821557, 23.057256321112305, 17.384962695340306, 17.62161952878037, 17.548588937769324, 18.458712751666695, 18.4179964835445, 18.787336227173597, 27.10451190173626, 27.295963529497385, 27.048072561621666, 17.709489703178406, 18.37939701601863, 17.72090645134449, 26.588945781191185, 25.93012923498948, 26.549882908662156, 18.442610306044415, 18.745226067801312, 18.25805938740571, 13.637553174359098, 13.033929770191506, 13.587622824435428, 8.089599822958306, 7.856394266088799, 8.411423656468585, 9.754459430774048, 10.023035128911332, 10.406140518685177, 24.30954375738898, 24.476412580969424, 24.029303560654313, 33.65917198111613, 33.209180792172745, 33.73910430570443, 18.247402918835476, 18.328247018119626, 18.243266328548387, 25.444371203581483, 25.701647984484822, 25.58368296052018, 16.708352367083222, 16.483012462655694, 17.04745666279146, 19.633513316822544, 19.53217639153202, 19.691402622576177, 17.999082202712685, 18.73042035351196, 18.775863530735165, -83.54467671116194, -92.86365277816853, -82.72314242770275, 18.294130742549896, 19.096610724925995, 18.791824162006378, 18.19327985557416, 17.46693695584932, 17.950951668123395, 11.980549226204545, 12.515675927201897, 11.825038025776536, 28.337470546364784, 28.610974938608706, 27.900561794638634, 19.414881775776536, 19.053350920478493, 19.840858942518622, 13.372123345732689, 13.529536567628384, 13.570407547056675, 30.21514145036538, 30.260924113293484, 30.285923879904047, 22.704277063409478, 22.808836388091237, 23.082868891457707, 21.33038854373929, 20.40411405762036, 21.183361024906233, 16.006222938497856, 17.00475734037657, 15.89266089101632, 20.168980666125805, 19.81148017446199, 19.983238762865454, 10.945461715261132, 11.14873858789602, 10.216997216145188, 19.636127829551697, 19.916250558570027, 19.36206328868866, 13.757309744755418, 13.626888411740453, 13.783535751203686, 11.635547277828053, 11.633470353980854, 11.472179514666394, 21.508279794439048, 21.33094472934802, 20.553345551093415, 14.52471717478086, 14.433586222430066, 13.588653092583016, 24.18301396816969, 24.067622877657413, 24.517201397567987, 20.01798968637982, 19.05236570040384, 19.74269689867893, -101.44855315300326, -101.46184377806883, -112.05555311838786, 21.138139873743057, 21.19709751009941, 21.490010767243803, 23.185617819428444, 22.317776650190353, 23.306488625705242, 15.745351289709404, 15.204231714208916, 14.999837179978684, 22.2616495109784, 21.52780836323896, 21.75953438381353, 17.411373051504285, 17.632361565406114, 17.640192824105412, 8.180062035719544, 8.261175165573746, 7.978703538576752, 16.43606812258561, 16.623287597050265, 16.8051649959137, 23.131850961595774, 22.508266031742096, 22.916400641202927, 16.40039339164892, 17.216808362553508, 16.39662958184877, 17.77682741979757, 17.697590606907994, 17.69789362202087, 20.22295788240929, 19.997621302803353, 18.604205300410584, 25.08892661581436, 25.176859765003115, 25.2078866927574, -72.04821163415909, -81.36131459474564, -70.75440588500351, 15.216504501799733, 14.926926548282296, 14.53069960574308, 27.195011177410677, 27.24860145275791, 27.0345120926698, 29.11794109952946, 29.11314255309601, 28.59259683390458, 13.794353564580277, 13.672866781552628, 12.879830112059906, 18.909288505713135, 19.36550000278899, 19.121556031207234, 10.598305776715279, 10.819570809602737, 11.261719135567546, 14.027504740282893, 13.477371647953987, 13.900512360036373, 28.846561213334397, 29.6249273729821, 29.622454497342304, 31.351357837207615, 30.880431555211544, 30.717392474412918, 15.278245145144552, 14.770186538497597, 14.767991411189229, 24.834583563109234, 24.555904058118657, 24.610076633592442, 22.174538660794497, 22.031891372054815, 21.442157074809074, 21.608969608942658, 22.0989705879862, 22.015354086334497, 23.256469177703053, 22.90664746860662, 22.819929192463547, 14.168024964630604, 13.33625790476799, 14.38374530337751, 21.636551678180695, 21.31573425978422, 21.890885372646153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14546662149002718, "mean_inference_ms": 0.6887358989141303, "mean_action_processing_ms": 0.1000380341809914, "mean_env_wait_ms": 0.8446881981032973, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 410000, "timesteps_this_iter": 0, "agent_timesteps_total": 1230000, "timers": {"sample_time_ms": 10748.375, "sample_throughput": 465.187, "load_time_ms": 0.3, "load_throughput": 16679805.933, "learn_time_ms": 1534.467, "learn_throughput": 3258.46, "update_time_ms": 7.656}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.551115123125783e-18, "cur_lr": 0.0005000000000000001, "total_loss": 5.5415332317352295, "policy_loss": -0.0028780825642651386, "vf_loss": 5.632893419265747, "vf_explained_var": -0.1679712176322937, "kl": 0.0038490342209325616, "entropy": 8.848210525512695, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 410000, "num_agent_steps_sampled": 1230000, "num_steps_trained": 410000, "num_agent_steps_trained": 1230000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1669, "training_iteration": 82, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-23-49", "timestamp": 1706228629, "time_this_iter_s": 11.1698477268219, "time_total_s": 871.7389783859253, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202825D1DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 871.7389783859253, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 9.23125, "ram_util_percent": 54.006249999999994}}
{"episode_reward_max": 100.6074570789933, "episode_reward_min": -314.96595004945993, "episode_reward_mean": 40.72128149541676, "episode_len_mean": 487.99, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -112.05555311838786}, "policy_reward_max": {"shared_policy": 33.73910430570443}, "policy_reward_mean": {"shared_policy": 13.57376049847225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.96741173474582, 61.15433414280413, 54.71549089625475, 45.105212033260614, -314.09991102840286, 33.435336344409734, 44.377344345673905, 73.51573579572138, 78.00749402586369, 64.02207320928571, 51.364726103842244, 70.44336963444945, 49.438236020505414, 68.50334151461718, 36.651034560054526, 54.245305594056816, -241.05011696740985, 27.042733939830214, 13.61720221489665, 77.81473493389782, 61.010586144402595, 30.91091687977314, 37.70231822319326, 70.04821197688577, 52.55517116189, 55.66404546238479, 81.44854799285531, 53.809793170541525, 79.06895792484282, 55.445895761251435, 40.25910576898603, 24.35741774551569, 30.183635078370557, 72.81525989901272, 100.6074570789933, 54.81891626550349, 76.72970214858648, 50.23882149253038, 58.85709233093074, 55.50536608695981, -259.1314719170332, 56.18256562948227, 53.611168479546876, 36.32126317918298, 84.84900727961212, 58.30909163877365, 40.47206746041775, 90.76198944356291, 68.59598234295842, 62.917863626265884, 48.90364116989075, 59.96369960345325, 32.31119751930234, 58.914441676810384, 41.16773390769956, 34.7411971464753, 63.39257007488048, 42.54695648979394, 72.76783824339509, 58.81305228546259, -314.96595004945993, 63.82524815108627, 68.80988309532404, 45.949420183897004, 65.54899225803089, 52.68392744101581, 24.419940739870043, 49.864520715549574, 68.5565176345408, 50.0138313360512, 53.172311648726435, 58.824784485623226, 75.47367307357487, -224.16393211390823, 44.67413065582511, 81.47812472283839, 86.82368048653005, 40.34705045819281, 57.39634453970936, 32.67959572188556, 41.40538874827325, 88.0939430836588, 92.94918186683208, 44.81642309483138, 74.00056425482033, 65.64858710765839, 65.72329428326336, 68.98304583877322, 41.8880281727761, 64.84317131061107, 95.3121470659971, 42.87112151598558, 74.16442365804684, 60.12986235693094, 47.97166953608394, 57.414029922336326, 58.85461296886203, 66.7294687144458, 30.654571820050478, 62.54235611483453], "episode_lengths": [500, 500, 500, 500, 52, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 358, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 349, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 72, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [16.211224121352032, 16.77672233242386, 15.979465280969933, 20.334026431043938, 20.62658804406722, 20.193719667692974, 18.352619259307772, 18.393924141923577, 17.9689474950234, 15.135836187750101, 14.650276020169258, 15.319099825341254, -111.1785558780733, -101.2184459588801, -101.70290919144949, 10.572082847356796, 11.376668959856033, 11.486584537196904, 14.895012096812323, 14.425878336032227, 15.056453912829355, 24.479342530171067, 24.307636859516293, 24.728756406034023, 26.174344513875738, 25.673576635619, 26.159572876368955, 21.39669671157995, 21.542663047711045, 21.082713449994714, 17.202790235479668, 16.822325741251305, 17.33961012711127, 23.660646143058926, 23.392742226521165, 23.389981264869363, 16.734968995054558, 16.09659572442372, 16.606671301027134, 22.578915807108075, 22.961328646788985, 22.963097060720116, 11.931293358405426, 12.118797053893402, 12.600944147755698, 17.825521575907857, 18.19811505327621, 18.221668964872748, -78.98431692520778, -86.1174347649018, -75.94836527730028, 9.369064355734736, 8.918509192764759, 8.755160391330719, 4.939869786302239, 3.739587138096482, 4.937745290497929, 26.024453761676938, 25.365004325906426, 26.42527684631446, 20.14591260502735, 20.308982028315455, 20.55569151105979, 10.314908720552921, 10.243491068482399, 10.35251709073782, 12.69942154424885, 12.760165112713963, 12.242731566230447, 23.226721862951905, 23.764233792821557, 23.057256321112305, 17.384962695340306, 17.62161952878037, 17.548588937769324, 18.458712751666695, 18.4179964835445, 18.787336227173597, 27.10451190173626, 27.295963529497385, 27.048072561621666, 17.709489703178406, 18.37939701601863, 17.72090645134449, 26.588945781191185, 25.93012923498948, 26.549882908662156, 18.442610306044415, 18.745226067801312, 18.25805938740571, 13.637553174359098, 13.033929770191506, 13.587622824435428, 8.089599822958306, 7.856394266088799, 8.411423656468585, 9.754459430774048, 10.023035128911332, 10.406140518685177, 24.30954375738898, 24.476412580969424, 24.029303560654313, 33.65917198111613, 33.209180792172745, 33.73910430570443, 18.247402918835476, 18.328247018119626, 18.243266328548387, 25.444371203581483, 25.701647984484822, 25.58368296052018, 16.708352367083222, 16.483012462655694, 17.04745666279146, 19.633513316822544, 19.53217639153202, 19.691402622576177, 17.999082202712685, 18.73042035351196, 18.775863530735165, -83.54467671116194, -92.86365277816853, -82.72314242770275, 18.294130742549896, 19.096610724925995, 18.791824162006378, 18.19327985557416, 17.46693695584932, 17.950951668123395, 11.980549226204545, 12.515675927201897, 11.825038025776536, 28.337470546364784, 28.610974938608706, 27.900561794638634, 19.414881775776536, 19.053350920478493, 19.840858942518622, 13.372123345732689, 13.529536567628384, 13.570407547056675, 30.21514145036538, 30.260924113293484, 30.285923879904047, 22.704277063409478, 22.808836388091237, 23.082868891457707, 21.33038854373929, 20.40411405762036, 21.183361024906233, 16.006222938497856, 17.00475734037657, 15.89266089101632, 20.168980666125805, 19.81148017446199, 19.983238762865454, 10.945461715261132, 11.14873858789602, 10.216997216145188, 19.636127829551697, 19.916250558570027, 19.36206328868866, 13.757309744755418, 13.626888411740453, 13.783535751203686, 11.635547277828053, 11.633470353980854, 11.472179514666394, 21.508279794439048, 21.33094472934802, 20.553345551093415, 14.52471717478086, 14.433586222430066, 13.588653092583016, 24.18301396816969, 24.067622877657413, 24.517201397567987, 20.01798968637982, 19.05236570040384, 19.74269689867893, -101.44855315300326, -101.46184377806883, -112.05555311838786, 21.138139873743057, 21.19709751009941, 21.490010767243803, 23.185617819428444, 22.317776650190353, 23.306488625705242, 15.745351289709404, 15.204231714208916, 14.999837179978684, 22.2616495109784, 21.52780836323896, 21.75953438381353, 17.411373051504285, 17.632361565406114, 17.640192824105412, 8.180062035719544, 8.261175165573746, 7.978703538576752, 16.43606812258561, 16.623287597050265, 16.8051649959137, 23.131850961595774, 22.508266031742096, 22.916400641202927, 16.40039339164892, 17.216808362553508, 16.39662958184877, 17.77682741979757, 17.697590606907994, 17.69789362202087, 20.22295788240929, 19.997621302803353, 18.604205300410584, 25.08892661581436, 25.176859765003115, 25.2078866927574, -72.04821163415909, -81.36131459474564, -70.75440588500351, 15.216504501799733, 14.926926548282296, 14.53069960574308, 27.195011177410677, 27.24860145275791, 27.0345120926698, 29.11794109952946, 29.11314255309601, 28.59259683390458, 13.794353564580277, 13.672866781552628, 12.879830112059906, 18.909288505713135, 19.36550000278899, 19.121556031207234, 10.598305776715279, 10.819570809602737, 11.261719135567546, 14.027504740282893, 13.477371647953987, 13.900512360036373, 28.846561213334397, 29.6249273729821, 29.622454497342304, 31.351357837207615, 30.880431555211544, 30.717392474412918, 15.278245145144552, 14.770186538497597, 14.767991411189229, 24.834583563109234, 24.555904058118657, 24.610076633592442, 22.174538660794497, 22.031891372054815, 21.442157074809074, 21.608969608942658, 22.0989705879862, 22.015354086334497, 23.256469177703053, 22.90664746860662, 22.819929192463547, 14.168024964630604, 13.33625790476799, 14.38374530337751, 21.636551678180695, 21.31573425978422, 21.890885372646153, 31.989083519826323, 31.799359663079173, 31.5237038830916, 14.19501780718565, 14.043255887925625, 14.632847820874304, 24.53090605388084, 24.815153380079806, 24.818364224086196, 20.361882946143538, 19.62735756735006, 20.140621843437344, 15.95665892213583, 15.90874494612217, 16.106265667825937, 19.222113785644368, 18.880713542302445, 19.311202594389513, 19.605778536448867, 19.61968372265497, 19.629150709758193, 22.138479399184376, 22.325369036446006, 22.26562027881542, 9.98768463730812, 10.569424014538527, 10.09746316820383, 21.185811029126242, 20.573797484238938, 20.782747601469353]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14541471359077196, "mean_inference_ms": 0.6888499042827483, "mean_action_processing_ms": 0.1000585782647644, "mean_env_wait_ms": 0.8451200214309744, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 415000, "timesteps_this_iter": 0, "agent_timesteps_total": 1245000, "timers": {"sample_time_ms": 10711.613, "sample_throughput": 466.783, "load_time_ms": 0.3, "load_throughput": 16679805.933, "learn_time_ms": 1532.708, "learn_throughput": 3262.2, "update_time_ms": 7.431}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7755575615628915e-18, "cur_lr": 0.0005000000000000001, "total_loss": 4.598932456970215, "policy_loss": -0.002940493264230959, "vf_loss": 4.689449310302734, "vf_explained_var": -0.18485156297683716, "kl": 0.00312225507807153, "entropy": 8.757658004760742, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 415000, "num_agent_steps_sampled": 1245000, "num_steps_trained": 415000, "num_agent_steps_trained": 1245000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1679, "training_iteration": 83, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-23-59", "timestamp": 1706228639, "time_this_iter_s": 10.379871845245361, "time_total_s": 882.1188502311707, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202825D1EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 882.1188502311707, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 8.08, "ram_util_percent": 53.83333333333332}}
{"episode_reward_max": 100.6074570789933, "episode_reward_min": -314.96595004945993, "episode_reward_mean": 45.67167901448788, "episode_len_mean": 492.47, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -112.05555311838786}, "policy_reward_max": {"shared_policy": 33.73910430570443}, "policy_reward_mean": {"shared_policy": 15.223893004829291}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.364726103842244, 70.44336963444945, 49.438236020505414, 68.50334151461718, 36.651034560054526, 54.245305594056816, -241.05011696740985, 27.042733939830214, 13.61720221489665, 77.81473493389782, 61.010586144402595, 30.91091687977314, 37.70231822319326, 70.04821197688577, 52.55517116189, 55.66404546238479, 81.44854799285531, 53.809793170541525, 79.06895792484282, 55.445895761251435, 40.25910576898603, 24.35741774551569, 30.183635078370557, 72.81525989901272, 100.6074570789933, 54.81891626550349, 76.72970214858648, 50.23882149253038, 58.85709233093074, 55.50536608695981, -259.1314719170332, 56.18256562948227, 53.611168479546876, 36.32126317918298, 84.84900727961212, 58.30909163877365, 40.47206746041775, 90.76198944356291, 68.59598234295842, 62.917863626265884, 48.90364116989075, 59.96369960345325, 32.31119751930234, 58.914441676810384, 41.16773390769956, 34.7411971464753, 63.39257007488048, 42.54695648979394, 72.76783824339509, 58.81305228546259, -314.96595004945993, 63.82524815108627, 68.80988309532404, 45.949420183897004, 65.54899225803089, 52.68392744101581, 24.419940739870043, 49.864520715549574, 68.5565176345408, 50.0138313360512, 53.172311648726435, 58.824784485623226, 75.47367307357487, -224.16393211390823, 44.67413065582511, 81.47812472283839, 86.82368048653005, 40.34705045819281, 57.39634453970936, 32.67959572188556, 41.40538874827325, 88.0939430836588, 92.94918186683208, 44.81642309483138, 74.00056425482033, 65.64858710765839, 65.72329428326336, 68.98304583877322, 41.8880281727761, 64.84317131061107, 95.3121470659971, 42.87112151598558, 74.16442365804684, 60.12986235693094, 47.97166953608394, 57.414029922336326, 58.85461296886203, 66.7294687144458, 30.654571820050478, 62.54235611483453, 63.170496020466075, 54.03821844980118, 60.51828966289759, 96.25610119104383, 50.57284473441541, 76.30581083148718, 66.23703216761349, 94.58160028047857, 49.18796864338216, 73.37191142514347], "episode_lengths": [500, 500, 500, 500, 500, 500, 358, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 349, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 72, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [17.202790235479668, 16.822325741251305, 17.33961012711127, 23.660646143058926, 23.392742226521165, 23.389981264869363, 16.734968995054558, 16.09659572442372, 16.606671301027134, 22.578915807108075, 22.961328646788985, 22.963097060720116, 11.931293358405426, 12.118797053893402, 12.600944147755698, 17.825521575907857, 18.19811505327621, 18.221668964872748, -78.98431692520778, -86.1174347649018, -75.94836527730028, 9.369064355734736, 8.918509192764759, 8.755160391330719, 4.939869786302239, 3.739587138096482, 4.937745290497929, 26.024453761676938, 25.365004325906426, 26.42527684631446, 20.14591260502735, 20.308982028315455, 20.55569151105979, 10.314908720552921, 10.243491068482399, 10.35251709073782, 12.69942154424885, 12.760165112713963, 12.242731566230447, 23.226721862951905, 23.764233792821557, 23.057256321112305, 17.384962695340306, 17.62161952878037, 17.548588937769324, 18.458712751666695, 18.4179964835445, 18.787336227173597, 27.10451190173626, 27.295963529497385, 27.048072561621666, 17.709489703178406, 18.37939701601863, 17.72090645134449, 26.588945781191185, 25.93012923498948, 26.549882908662156, 18.442610306044415, 18.745226067801312, 18.25805938740571, 13.637553174359098, 13.033929770191506, 13.587622824435428, 8.089599822958306, 7.856394266088799, 8.411423656468585, 9.754459430774048, 10.023035128911332, 10.406140518685177, 24.30954375738898, 24.476412580969424, 24.029303560654313, 33.65917198111613, 33.209180792172745, 33.73910430570443, 18.247402918835476, 18.328247018119626, 18.243266328548387, 25.444371203581483, 25.701647984484822, 25.58368296052018, 16.708352367083222, 16.483012462655694, 17.04745666279146, 19.633513316822544, 19.53217639153202, 19.691402622576177, 17.999082202712685, 18.73042035351196, 18.775863530735165, -83.54467671116194, -92.86365277816853, -82.72314242770275, 18.294130742549896, 19.096610724925995, 18.791824162006378, 18.19327985557416, 17.46693695584932, 17.950951668123395, 11.980549226204545, 12.515675927201897, 11.825038025776536, 28.337470546364784, 28.610974938608706, 27.900561794638634, 19.414881775776536, 19.053350920478493, 19.840858942518622, 13.372123345732689, 13.529536567628384, 13.570407547056675, 30.21514145036538, 30.260924113293484, 30.285923879904047, 22.704277063409478, 22.808836388091237, 23.082868891457707, 21.33038854373929, 20.40411405762036, 21.183361024906233, 16.006222938497856, 17.00475734037657, 15.89266089101632, 20.168980666125805, 19.81148017446199, 19.983238762865454, 10.945461715261132, 11.14873858789602, 10.216997216145188, 19.636127829551697, 19.916250558570027, 19.36206328868866, 13.757309744755418, 13.626888411740453, 13.783535751203686, 11.635547277828053, 11.633470353980854, 11.472179514666394, 21.508279794439048, 21.33094472934802, 20.553345551093415, 14.52471717478086, 14.433586222430066, 13.588653092583016, 24.18301396816969, 24.067622877657413, 24.517201397567987, 20.01798968637982, 19.05236570040384, 19.74269689867893, -101.44855315300326, -101.46184377806883, -112.05555311838786, 21.138139873743057, 21.19709751009941, 21.490010767243803, 23.185617819428444, 22.317776650190353, 23.306488625705242, 15.745351289709404, 15.204231714208916, 14.999837179978684, 22.2616495109784, 21.52780836323896, 21.75953438381353, 17.411373051504285, 17.632361565406114, 17.640192824105412, 8.180062035719544, 8.261175165573746, 7.978703538576752, 16.43606812258561, 16.623287597050265, 16.8051649959137, 23.131850961595774, 22.508266031742096, 22.916400641202927, 16.40039339164892, 17.216808362553508, 16.39662958184877, 17.77682741979757, 17.697590606907994, 17.69789362202087, 20.22295788240929, 19.997621302803353, 18.604205300410584, 25.08892661581436, 25.176859765003115, 25.2078866927574, -72.04821163415909, -81.36131459474564, -70.75440588500351, 15.216504501799733, 14.926926548282296, 14.53069960574308, 27.195011177410677, 27.24860145275791, 27.0345120926698, 29.11794109952946, 29.11314255309601, 28.59259683390458, 13.794353564580277, 13.672866781552628, 12.879830112059906, 18.909288505713135, 19.36550000278899, 19.121556031207234, 10.598305776715279, 10.819570809602737, 11.261719135567546, 14.027504740282893, 13.477371647953987, 13.900512360036373, 28.846561213334397, 29.6249273729821, 29.622454497342304, 31.351357837207615, 30.880431555211544, 30.717392474412918, 15.278245145144552, 14.770186538497597, 14.767991411189229, 24.834583563109234, 24.555904058118657, 24.610076633592442, 22.174538660794497, 22.031891372054815, 21.442157074809074, 21.608969608942658, 22.0989705879862, 22.015354086334497, 23.256469177703053, 22.90664746860662, 22.819929192463547, 14.168024964630604, 13.33625790476799, 14.38374530337751, 21.636551678180695, 21.31573425978422, 21.890885372646153, 31.989083519826323, 31.799359663079173, 31.5237038830916, 14.19501780718565, 14.043255887925625, 14.632847820874304, 24.53090605388084, 24.815153380079806, 24.818364224086196, 20.361882946143538, 19.62735756735006, 20.140621843437344, 15.95665892213583, 15.90874494612217, 16.106265667825937, 19.222113785644368, 18.880713542302445, 19.311202594389513, 19.605778536448867, 19.61968372265497, 19.629150709758193, 22.138479399184376, 22.325369036446006, 22.26562027881542, 9.98768463730812, 10.569424014538527, 10.09746316820383, 21.185811029126242, 20.573797484238938, 20.782747601469353, 21.195420542110995, 20.919285354514912, 21.05579012384017, 17.99868171537915, 18.070313813785702, 17.969222920636327, 20.157791391015053, 20.478162743151188, 19.882335528731346, 32.09076420838633, 32.24178613598147, 31.923550846676022, 16.806009598076344, 16.73985492438078, 17.02698021195829, 25.515621153637767, 25.513719560578465, 25.276470117270947, 21.86678000291188, 22.285719481607273, 22.084532683094338, 31.53029420475164, 32.085564193005354, 30.965741882721574, 16.293446260193974, 16.34579139451185, 16.54873098867634, 24.522094969948128, 24.679747634877756, 24.17006882031758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14536038894995224, "mean_inference_ms": 0.6890189926150286, "mean_action_processing_ms": 0.10009836175745523, "mean_env_wait_ms": 0.8456750886395377, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 420000, "timesteps_this_iter": 0, "agent_timesteps_total": 1260000, "timers": {"sample_time_ms": 10674.037, "sample_throughput": 468.426, "load_time_ms": 0.4, "load_throughput": 12500906.056, "learn_time_ms": 1531.256, "learn_throughput": 3265.293, "update_time_ms": 7.298}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3877787807814458e-18, "cur_lr": 0.0005000000000000001, "total_loss": 4.819644546508789, "policy_loss": -0.0017994124303990944, "vf_loss": 4.9096351146698, "vf_explained_var": -0.10997865200042725, "kl": 0.002786630438661631, "entropy": 8.819108772277833, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 420000, "num_agent_steps_sampled": 1260000, "num_steps_trained": 420000, "num_agent_steps_trained": 1260000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1689, "training_iteration": 84, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-24-10", "timestamp": 1706228650, "time_this_iter_s": 10.469781398773193, "time_total_s": 892.5886316299438, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202823BE670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 892.5886316299438, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 7.271428571428571, "ram_util_percent": 53.757142857142846}}
{"episode_reward_max": 100.6074570789933, "episode_reward_min": -314.96595004945993, "episode_reward_mean": 50.07400585631723, "episode_len_mean": 493.89, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -112.05555311838786}, "policy_reward_max": {"shared_policy": 33.73910430570443}, "policy_reward_mean": {"shared_policy": 16.691335285439074}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.010586144402595, 30.91091687977314, 37.70231822319326, 70.04821197688577, 52.55517116189, 55.66404546238479, 81.44854799285531, 53.809793170541525, 79.06895792484282, 55.445895761251435, 40.25910576898603, 24.35741774551569, 30.183635078370557, 72.81525989901272, 100.6074570789933, 54.81891626550349, 76.72970214858648, 50.23882149253038, 58.85709233093074, 55.50536608695981, -259.1314719170332, 56.18256562948227, 53.611168479546876, 36.32126317918298, 84.84900727961212, 58.30909163877365, 40.47206746041775, 90.76198944356291, 68.59598234295842, 62.917863626265884, 48.90364116989075, 59.96369960345325, 32.31119751930234, 58.914441676810384, 41.16773390769956, 34.7411971464753, 63.39257007488048, 42.54695648979394, 72.76783824339509, 58.81305228546259, -314.96595004945993, 63.82524815108627, 68.80988309532404, 45.949420183897004, 65.54899225803089, 52.68392744101581, 24.419940739870043, 49.864520715549574, 68.5565176345408, 50.0138313360512, 53.172311648726435, 58.824784485623226, 75.47367307357487, -224.16393211390823, 44.67413065582511, 81.47812472283839, 86.82368048653005, 40.34705045819281, 57.39634453970936, 32.67959572188556, 41.40538874827325, 88.0939430836588, 92.94918186683208, 44.81642309483138, 74.00056425482033, 65.64858710765839, 65.72329428326336, 68.98304583877322, 41.8880281727761, 64.84317131061107, 95.3121470659971, 42.87112151598558, 74.16442365804684, 60.12986235693094, 47.97166953608394, 57.414029922336326, 58.85461296886203, 66.7294687144458, 30.654571820050478, 62.54235611483453, 63.170496020466075, 54.03821844980118, 60.51828966289759, 96.25610119104383, 50.57284473441541, 76.30581083148718, 66.23703216761349, 94.58160028047857, 49.18796864338216, 73.37191142514347, 52.45757723599671, 85.67890383116898, 87.90208537504076, 68.49999921442941, 42.80717311799526, 70.08525667991486, 65.99041724577543, 60.56633087992667, 58.19092981703578, 56.12457833439109], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 349, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 72, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [20.14591260502735, 20.308982028315455, 20.55569151105979, 10.314908720552921, 10.243491068482399, 10.35251709073782, 12.69942154424885, 12.760165112713963, 12.242731566230447, 23.226721862951905, 23.764233792821557, 23.057256321112305, 17.384962695340306, 17.62161952878037, 17.548588937769324, 18.458712751666695, 18.4179964835445, 18.787336227173597, 27.10451190173626, 27.295963529497385, 27.048072561621666, 17.709489703178406, 18.37939701601863, 17.72090645134449, 26.588945781191185, 25.93012923498948, 26.549882908662156, 18.442610306044415, 18.745226067801312, 18.25805938740571, 13.637553174359098, 13.033929770191506, 13.587622824435428, 8.089599822958306, 7.856394266088799, 8.411423656468585, 9.754459430774048, 10.023035128911332, 10.406140518685177, 24.30954375738898, 24.476412580969424, 24.029303560654313, 33.65917198111613, 33.209180792172745, 33.73910430570443, 18.247402918835476, 18.328247018119626, 18.243266328548387, 25.444371203581483, 25.701647984484822, 25.58368296052018, 16.708352367083222, 16.483012462655694, 17.04745666279146, 19.633513316822544, 19.53217639153202, 19.691402622576177, 17.999082202712685, 18.73042035351196, 18.775863530735165, -83.54467671116194, -92.86365277816853, -82.72314242770275, 18.294130742549896, 19.096610724925995, 18.791824162006378, 18.19327985557416, 17.46693695584932, 17.950951668123395, 11.980549226204545, 12.515675927201897, 11.825038025776536, 28.337470546364784, 28.610974938608706, 27.900561794638634, 19.414881775776536, 19.053350920478493, 19.840858942518622, 13.372123345732689, 13.529536567628384, 13.570407547056675, 30.21514145036538, 30.260924113293484, 30.285923879904047, 22.704277063409478, 22.808836388091237, 23.082868891457707, 21.33038854373929, 20.40411405762036, 21.183361024906233, 16.006222938497856, 17.00475734037657, 15.89266089101632, 20.168980666125805, 19.81148017446199, 19.983238762865454, 10.945461715261132, 11.14873858789602, 10.216997216145188, 19.636127829551697, 19.916250558570027, 19.36206328868866, 13.757309744755418, 13.626888411740453, 13.783535751203686, 11.635547277828053, 11.633470353980854, 11.472179514666394, 21.508279794439048, 21.33094472934802, 20.553345551093415, 14.52471717478086, 14.433586222430066, 13.588653092583016, 24.18301396816969, 24.067622877657413, 24.517201397567987, 20.01798968637982, 19.05236570040384, 19.74269689867893, -101.44855315300326, -101.46184377806883, -112.05555311838786, 21.138139873743057, 21.19709751009941, 21.490010767243803, 23.185617819428444, 22.317776650190353, 23.306488625705242, 15.745351289709404, 15.204231714208916, 14.999837179978684, 22.2616495109784, 21.52780836323896, 21.75953438381353, 17.411373051504285, 17.632361565406114, 17.640192824105412, 8.180062035719544, 8.261175165573746, 7.978703538576752, 16.43606812258561, 16.623287597050265, 16.8051649959137, 23.131850961595774, 22.508266031742096, 22.916400641202927, 16.40039339164892, 17.216808362553508, 16.39662958184877, 17.77682741979757, 17.697590606907994, 17.69789362202087, 20.22295788240929, 19.997621302803353, 18.604205300410584, 25.08892661581436, 25.176859765003115, 25.2078866927574, -72.04821163415909, -81.36131459474564, -70.75440588500351, 15.216504501799733, 14.926926548282296, 14.53069960574308, 27.195011177410677, 27.24860145275791, 27.0345120926698, 29.11794109952946, 29.11314255309601, 28.59259683390458, 13.794353564580277, 13.672866781552628, 12.879830112059906, 18.909288505713135, 19.36550000278899, 19.121556031207234, 10.598305776715279, 10.819570809602737, 11.261719135567546, 14.027504740282893, 13.477371647953987, 13.900512360036373, 28.846561213334397, 29.6249273729821, 29.622454497342304, 31.351357837207615, 30.880431555211544, 30.717392474412918, 15.278245145144552, 14.770186538497597, 14.767991411189229, 24.834583563109234, 24.555904058118657, 24.610076633592442, 22.174538660794497, 22.031891372054815, 21.442157074809074, 21.608969608942658, 22.0989705879862, 22.015354086334497, 23.256469177703053, 22.90664746860662, 22.819929192463547, 14.168024964630604, 13.33625790476799, 14.38374530337751, 21.636551678180695, 21.31573425978422, 21.890885372646153, 31.989083519826323, 31.799359663079173, 31.5237038830916, 14.19501780718565, 14.043255887925625, 14.632847820874304, 24.53090605388084, 24.815153380079806, 24.818364224086196, 20.361882946143538, 19.62735756735006, 20.140621843437344, 15.95665892213583, 15.90874494612217, 16.106265667825937, 19.222113785644368, 18.880713542302445, 19.311202594389513, 19.605778536448867, 19.61968372265497, 19.629150709758193, 22.138479399184376, 22.325369036446006, 22.26562027881542, 9.98768463730812, 10.569424014538527, 10.09746316820383, 21.185811029126242, 20.573797484238938, 20.782747601469353, 21.195420542110995, 20.919285354514912, 21.05579012384017, 17.99868171537915, 18.070313813785702, 17.969222920636327, 20.157791391015053, 20.478162743151188, 19.882335528731346, 32.09076420838633, 32.24178613598147, 31.923550846676022, 16.806009598076344, 16.73985492438078, 17.02698021195829, 25.515621153637767, 25.513719560578465, 25.276470117270947, 21.86678000291188, 22.285719481607273, 22.084532683094338, 31.53029420475164, 32.085564193005354, 30.965741882721574, 16.293446260193974, 16.34579139451185, 16.54873098867634, 24.522094969948128, 24.679747634877756, 24.17006882031758, 17.614682783683136, 17.28898937006791, 17.553905082245663, 28.73218543144563, 28.451827245453984, 28.494891154269368, 29.243766983350113, 29.3635461119314, 29.294772279759243, 22.926852121949196, 23.170795727986842, 22.40235136449337, 13.73416830599308, 14.722089439630508, 14.350915372371674, 23.51541576689729, 23.197122330466897, 23.372718582550675, 21.754542315999657, 22.007926205794007, 22.22794872398177, 20.4759460662802, 20.167299655576542, 19.923085158069924, 19.50014210057755, 19.464608819534376, 19.226178896923855, 18.39856297771135, 18.640290434161813, 19.085724922517926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1453246969090189, "mean_inference_ms": 0.6893376768080526, "mean_action_processing_ms": 0.1001466806348146, "mean_env_wait_ms": 0.8462710066092863, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 425000, "timesteps_this_iter": 0, "agent_timesteps_total": 1275000, "timers": {"sample_time_ms": 10650.063, "sample_throughput": 469.481, "load_time_ms": 0.5, "load_throughput": 9993576.364, "learn_time_ms": 1534.23, "learn_throughput": 3258.965, "update_time_ms": 7.619}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.938893903907229e-19, "cur_lr": 0.0005000000000000001, "total_loss": 5.938290405273437, "policy_loss": -0.0035704636110240884, "vf_loss": 6.029928970336914, "vf_explained_var": -0.15500380992889404, "kl": 0.003231995132249038, "entropy": 8.806812381744384, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 425000, "num_agent_steps_sampled": 1275000, "num_steps_trained": 425000, "num_agent_steps_trained": 1275000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1699, "training_iteration": 85, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-24-20", "timestamp": 1706228660, "time_this_iter_s": 10.59207820892334, "time_total_s": 903.1807098388672, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202825D19D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 903.1807098388672, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 7.613333333333333, "ram_util_percent": 53.77333333333332}}
{"episode_reward_max": 102.20295623689887, "episode_reward_min": -314.96595004945993, "episode_reward_mean": 51.6303897854837, "episode_len_mean": 493.89, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -112.05555311838786}, "policy_reward_max": {"shared_policy": 34.21547774473825}, "policy_reward_mean": {"shared_policy": 17.210129928494563}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.25910576898603, 24.35741774551569, 30.183635078370557, 72.81525989901272, 100.6074570789933, 54.81891626550349, 76.72970214858648, 50.23882149253038, 58.85709233093074, 55.50536608695981, -259.1314719170332, 56.18256562948227, 53.611168479546876, 36.32126317918298, 84.84900727961212, 58.30909163877365, 40.47206746041775, 90.76198944356291, 68.59598234295842, 62.917863626265884, 48.90364116989075, 59.96369960345325, 32.31119751930234, 58.914441676810384, 41.16773390769956, 34.7411971464753, 63.39257007488048, 42.54695648979394, 72.76783824339509, 58.81305228546259, -314.96595004945993, 63.82524815108627, 68.80988309532404, 45.949420183897004, 65.54899225803089, 52.68392744101581, 24.419940739870043, 49.864520715549574, 68.5565176345408, 50.0138313360512, 53.172311648726435, 58.824784485623226, 75.47367307357487, -224.16393211390823, 44.67413065582511, 81.47812472283839, 86.82368048653005, 40.34705045819281, 57.39634453970936, 32.67959572188556, 41.40538874827325, 88.0939430836588, 92.94918186683208, 44.81642309483138, 74.00056425482033, 65.64858710765839, 65.72329428326336, 68.98304583877322, 41.8880281727761, 64.84317131061107, 95.3121470659971, 42.87112151598558, 74.16442365804684, 60.12986235693094, 47.97166953608394, 57.414029922336326, 58.85461296886203, 66.7294687144458, 30.654571820050478, 62.54235611483453, 63.170496020466075, 54.03821844980118, 60.51828966289759, 96.25610119104383, 50.57284473441541, 76.30581083148718, 66.23703216761349, 94.58160028047857, 49.18796864338216, 73.37191142514347, 52.45757723599671, 85.67890383116898, 87.90208537504076, 68.49999921442941, 42.80717311799526, 70.08525667991486, 65.99041724577543, 60.56633087992667, 58.19092981703578, 56.12457833439109, 33.50261549651623, 72.18023387342689, 54.93175202235578, 78.0992243522778, 71.96694276854393, 69.64660087972878, 88.56477176374753, 70.81246176734565, 91.39527845382689, 102.20295623689887], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 349, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 72, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [13.637553174359098, 13.033929770191506, 13.587622824435428, 8.089599822958306, 7.856394266088799, 8.411423656468585, 9.754459430774048, 10.023035128911332, 10.406140518685177, 24.30954375738898, 24.476412580969424, 24.029303560654313, 33.65917198111613, 33.209180792172745, 33.73910430570443, 18.247402918835476, 18.328247018119626, 18.243266328548387, 25.444371203581483, 25.701647984484822, 25.58368296052018, 16.708352367083222, 16.483012462655694, 17.04745666279146, 19.633513316822544, 19.53217639153202, 19.691402622576177, 17.999082202712685, 18.73042035351196, 18.775863530735165, -83.54467671116194, -92.86365277816853, -82.72314242770275, 18.294130742549896, 19.096610724925995, 18.791824162006378, 18.19327985557416, 17.46693695584932, 17.950951668123395, 11.980549226204545, 12.515675927201897, 11.825038025776536, 28.337470546364784, 28.610974938608706, 27.900561794638634, 19.414881775776536, 19.053350920478493, 19.840858942518622, 13.372123345732689, 13.529536567628384, 13.570407547056675, 30.21514145036538, 30.260924113293484, 30.285923879904047, 22.704277063409478, 22.808836388091237, 23.082868891457707, 21.33038854373929, 20.40411405762036, 21.183361024906233, 16.006222938497856, 17.00475734037657, 15.89266089101632, 20.168980666125805, 19.81148017446199, 19.983238762865454, 10.945461715261132, 11.14873858789602, 10.216997216145188, 19.636127829551697, 19.916250558570027, 19.36206328868866, 13.757309744755418, 13.626888411740453, 13.783535751203686, 11.635547277828053, 11.633470353980854, 11.472179514666394, 21.508279794439048, 21.33094472934802, 20.553345551093415, 14.52471717478086, 14.433586222430066, 13.588653092583016, 24.18301396816969, 24.067622877657413, 24.517201397567987, 20.01798968637982, 19.05236570040384, 19.74269689867893, -101.44855315300326, -101.46184377806883, -112.05555311838786, 21.138139873743057, 21.19709751009941, 21.490010767243803, 23.185617819428444, 22.317776650190353, 23.306488625705242, 15.745351289709404, 15.204231714208916, 14.999837179978684, 22.2616495109784, 21.52780836323896, 21.75953438381353, 17.411373051504285, 17.632361565406114, 17.640192824105412, 8.180062035719544, 8.261175165573746, 7.978703538576752, 16.43606812258561, 16.623287597050265, 16.8051649959137, 23.131850961595774, 22.508266031742096, 22.916400641202927, 16.40039339164892, 17.216808362553508, 16.39662958184877, 17.77682741979757, 17.697590606907994, 17.69789362202087, 20.22295788240929, 19.997621302803353, 18.604205300410584, 25.08892661581436, 25.176859765003115, 25.2078866927574, -72.04821163415909, -81.36131459474564, -70.75440588500351, 15.216504501799733, 14.926926548282296, 14.53069960574308, 27.195011177410677, 27.24860145275791, 27.0345120926698, 29.11794109952946, 29.11314255309601, 28.59259683390458, 13.794353564580277, 13.672866781552628, 12.879830112059906, 18.909288505713135, 19.36550000278899, 19.121556031207234, 10.598305776715279, 10.819570809602737, 11.261719135567546, 14.027504740282893, 13.477371647953987, 13.900512360036373, 28.846561213334397, 29.6249273729821, 29.622454497342304, 31.351357837207615, 30.880431555211544, 30.717392474412918, 15.278245145144552, 14.770186538497597, 14.767991411189229, 24.834583563109234, 24.555904058118657, 24.610076633592442, 22.174538660794497, 22.031891372054815, 21.442157074809074, 21.608969608942658, 22.0989705879862, 22.015354086334497, 23.256469177703053, 22.90664746860662, 22.819929192463547, 14.168024964630604, 13.33625790476799, 14.38374530337751, 21.636551678180695, 21.31573425978422, 21.890885372646153, 31.989083519826323, 31.799359663079173, 31.5237038830916, 14.19501780718565, 14.043255887925625, 14.632847820874304, 24.53090605388084, 24.815153380079806, 24.818364224086196, 20.361882946143538, 19.62735756735006, 20.140621843437344, 15.95665892213583, 15.90874494612217, 16.106265667825937, 19.222113785644368, 18.880713542302445, 19.311202594389513, 19.605778536448867, 19.61968372265497, 19.629150709758193, 22.138479399184376, 22.325369036446006, 22.26562027881542, 9.98768463730812, 10.569424014538527, 10.09746316820383, 21.185811029126242, 20.573797484238938, 20.782747601469353, 21.195420542110995, 20.919285354514912, 21.05579012384017, 17.99868171537915, 18.070313813785702, 17.969222920636327, 20.157791391015053, 20.478162743151188, 19.882335528731346, 32.09076420838633, 32.24178613598147, 31.923550846676022, 16.806009598076344, 16.73985492438078, 17.02698021195829, 25.515621153637767, 25.513719560578465, 25.276470117270947, 21.86678000291188, 22.285719481607273, 22.084532683094338, 31.53029420475164, 32.085564193005354, 30.965741882721574, 16.293446260193974, 16.34579139451185, 16.54873098867634, 24.522094969948128, 24.679747634877756, 24.17006882031758, 17.614682783683136, 17.28898937006791, 17.553905082245663, 28.73218543144563, 28.451827245453984, 28.494891154269368, 29.243766983350113, 29.3635461119314, 29.294772279759243, 22.926852121949196, 23.170795727986842, 22.40235136449337, 13.73416830599308, 14.722089439630508, 14.350915372371674, 23.51541576689729, 23.197122330466897, 23.372718582550675, 21.754542315999657, 22.007926205794007, 22.22794872398177, 20.4759460662802, 20.167299655576542, 19.923085158069924, 19.50014210057755, 19.464608819534376, 19.226178896923855, 18.39856297771135, 18.640290434161813, 19.085724922517926, 11.364670418202877, 11.047735832631588, 11.090209245681763, 23.81494020919004, 24.09685933838287, 24.268434325853974, 18.57174366464217, 18.69338659321268, 17.66662176450093, 25.963601806511477, 26.09237278470148, 26.043249761064843, 24.39391467596093, 24.220129604140908, 23.352898488442094, 23.076519576211766, 23.29322362442811, 23.276857679088906, 29.176248433689267, 29.71054044032158, 29.677982889736683, 23.330904891093567, 23.868058205892638, 23.613498670359448, 30.16974564393361, 30.806318556269005, 30.419214253624276, 33.788629362980515, 34.21547774473825, 34.198849129180104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1452866153892863, "mean_inference_ms": 0.689476935326035, "mean_action_processing_ms": 0.10018747189831491, "mean_env_wait_ms": 0.8466384276636885, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 430000, "timesteps_this_iter": 0, "agent_timesteps_total": 1290000, "timers": {"sample_time_ms": 10719.308, "sample_throughput": 466.448, "load_time_ms": 0.513, "load_throughput": 9743771.779, "learn_time_ms": 1541.64, "learn_throughput": 3243.299, "update_time_ms": 7.627}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4694469519536144e-19, "cur_lr": 0.0005000000000000001, "total_loss": 6.025224685668945, "policy_loss": -0.0019832277274527852, "vf_loss": 6.114281702041626, "vf_explained_var": -0.17366756200790406, "kl": 0.0023994678457014912, "entropy": 8.707372283935547, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 430000, "num_agent_steps_sampled": 1290000, "num_steps_trained": 430000, "num_agent_steps_trained": 1290000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1709, "training_iteration": 86, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-24-32", "timestamp": 1706228672, "time_this_iter_s": 11.2611722946167, "time_total_s": 914.4418821334839, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202823BE3A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 914.4418821334839, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 9.225, "ram_util_percent": 53.875}}
{"episode_reward_max": 105.9088550582528, "episode_reward_min": -314.96595004945993, "episode_reward_mean": 53.84871625500962, "episode_len_mean": 493.89, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -112.05555311838786}, "policy_reward_max": {"shared_policy": 35.34039962509026}, "policy_reward_mean": {"shared_policy": 17.949572085003208}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-259.1314719170332, 56.18256562948227, 53.611168479546876, 36.32126317918298, 84.84900727961212, 58.30909163877365, 40.47206746041775, 90.76198944356291, 68.59598234295842, 62.917863626265884, 48.90364116989075, 59.96369960345325, 32.31119751930234, 58.914441676810384, 41.16773390769956, 34.7411971464753, 63.39257007488048, 42.54695648979394, 72.76783824339509, 58.81305228546259, -314.96595004945993, 63.82524815108627, 68.80988309532404, 45.949420183897004, 65.54899225803089, 52.68392744101581, 24.419940739870043, 49.864520715549574, 68.5565176345408, 50.0138313360512, 53.172311648726435, 58.824784485623226, 75.47367307357487, -224.16393211390823, 44.67413065582511, 81.47812472283839, 86.82368048653005, 40.34705045819281, 57.39634453970936, 32.67959572188556, 41.40538874827325, 88.0939430836588, 92.94918186683208, 44.81642309483138, 74.00056425482033, 65.64858710765839, 65.72329428326336, 68.98304583877322, 41.8880281727761, 64.84317131061107, 95.3121470659971, 42.87112151598558, 74.16442365804684, 60.12986235693094, 47.97166953608394, 57.414029922336326, 58.85461296886203, 66.7294687144458, 30.654571820050478, 62.54235611483453, 63.170496020466075, 54.03821844980118, 60.51828966289759, 96.25610119104383, 50.57284473441541, 76.30581083148718, 66.23703216761349, 94.58160028047857, 49.18796864338216, 73.37191142514347, 52.45757723599671, 85.67890383116898, 87.90208537504076, 68.49999921442941, 42.80717311799526, 70.08525667991486, 65.99041724577543, 60.56633087992667, 58.19092981703578, 56.12457833439109, 33.50261549651623, 72.18023387342689, 54.93175202235578, 78.0992243522778, 71.96694276854393, 69.64660087972878, 88.56477176374753, 70.81246176734565, 91.39527845382689, 102.20295623689887, 78.05148069560528, 92.67175894230601, 67.82357346452771, 89.18503298237917, 92.39988806843758, 49.4584000762552, 81.22639067843556, 56.23016592115164, 73.24987496063112, 105.9088550582528], "episode_lengths": [349, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 72, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-83.54467671116194, -92.86365277816853, -82.72314242770275, 18.294130742549896, 19.096610724925995, 18.791824162006378, 18.19327985557416, 17.46693695584932, 17.950951668123395, 11.980549226204545, 12.515675927201897, 11.825038025776536, 28.337470546364784, 28.610974938608706, 27.900561794638634, 19.414881775776536, 19.053350920478493, 19.840858942518622, 13.372123345732689, 13.529536567628384, 13.570407547056675, 30.21514145036538, 30.260924113293484, 30.285923879904047, 22.704277063409478, 22.808836388091237, 23.082868891457707, 21.33038854373929, 20.40411405762036, 21.183361024906233, 16.006222938497856, 17.00475734037657, 15.89266089101632, 20.168980666125805, 19.81148017446199, 19.983238762865454, 10.945461715261132, 11.14873858789602, 10.216997216145188, 19.636127829551697, 19.916250558570027, 19.36206328868866, 13.757309744755418, 13.626888411740453, 13.783535751203686, 11.635547277828053, 11.633470353980854, 11.472179514666394, 21.508279794439048, 21.33094472934802, 20.553345551093415, 14.52471717478086, 14.433586222430066, 13.588653092583016, 24.18301396816969, 24.067622877657413, 24.517201397567987, 20.01798968637982, 19.05236570040384, 19.74269689867893, -101.44855315300326, -101.46184377806883, -112.05555311838786, 21.138139873743057, 21.19709751009941, 21.490010767243803, 23.185617819428444, 22.317776650190353, 23.306488625705242, 15.745351289709404, 15.204231714208916, 14.999837179978684, 22.2616495109784, 21.52780836323896, 21.75953438381353, 17.411373051504285, 17.632361565406114, 17.640192824105412, 8.180062035719544, 8.261175165573746, 7.978703538576752, 16.43606812258561, 16.623287597050265, 16.8051649959137, 23.131850961595774, 22.508266031742096, 22.916400641202927, 16.40039339164892, 17.216808362553508, 16.39662958184877, 17.77682741979757, 17.697590606907994, 17.69789362202087, 20.22295788240929, 19.997621302803353, 18.604205300410584, 25.08892661581436, 25.176859765003115, 25.2078866927574, -72.04821163415909, -81.36131459474564, -70.75440588500351, 15.216504501799733, 14.926926548282296, 14.53069960574308, 27.195011177410677, 27.24860145275791, 27.0345120926698, 29.11794109952946, 29.11314255309601, 28.59259683390458, 13.794353564580277, 13.672866781552628, 12.879830112059906, 18.909288505713135, 19.36550000278899, 19.121556031207234, 10.598305776715279, 10.819570809602737, 11.261719135567546, 14.027504740282893, 13.477371647953987, 13.900512360036373, 28.846561213334397, 29.6249273729821, 29.622454497342304, 31.351357837207615, 30.880431555211544, 30.717392474412918, 15.278245145144552, 14.770186538497597, 14.767991411189229, 24.834583563109234, 24.555904058118657, 24.610076633592442, 22.174538660794497, 22.031891372054815, 21.442157074809074, 21.608969608942658, 22.0989705879862, 22.015354086334497, 23.256469177703053, 22.90664746860662, 22.819929192463547, 14.168024964630604, 13.33625790476799, 14.38374530337751, 21.636551678180695, 21.31573425978422, 21.890885372646153, 31.989083519826323, 31.799359663079173, 31.5237038830916, 14.19501780718565, 14.043255887925625, 14.632847820874304, 24.53090605388084, 24.815153380079806, 24.818364224086196, 20.361882946143538, 19.62735756735006, 20.140621843437344, 15.95665892213583, 15.90874494612217, 16.106265667825937, 19.222113785644368, 18.880713542302445, 19.311202594389513, 19.605778536448867, 19.61968372265497, 19.629150709758193, 22.138479399184376, 22.325369036446006, 22.26562027881542, 9.98768463730812, 10.569424014538527, 10.09746316820383, 21.185811029126242, 20.573797484238938, 20.782747601469353, 21.195420542110995, 20.919285354514912, 21.05579012384017, 17.99868171537915, 18.070313813785702, 17.969222920636327, 20.157791391015053, 20.478162743151188, 19.882335528731346, 32.09076420838633, 32.24178613598147, 31.923550846676022, 16.806009598076344, 16.73985492438078, 17.02698021195829, 25.515621153637767, 25.513719560578465, 25.276470117270947, 21.86678000291188, 22.285719481607273, 22.084532683094338, 31.53029420475164, 32.085564193005354, 30.965741882721574, 16.293446260193974, 16.34579139451185, 16.54873098867634, 24.522094969948128, 24.679747634877756, 24.17006882031758, 17.614682783683136, 17.28898937006791, 17.553905082245663, 28.73218543144563, 28.451827245453984, 28.494891154269368, 29.243766983350113, 29.3635461119314, 29.294772279759243, 22.926852121949196, 23.170795727986842, 22.40235136449337, 13.73416830599308, 14.722089439630508, 14.350915372371674, 23.51541576689729, 23.197122330466897, 23.372718582550675, 21.754542315999657, 22.007926205794007, 22.22794872398177, 20.4759460662802, 20.167299655576542, 19.923085158069924, 19.50014210057755, 19.464608819534376, 19.226178896923855, 18.39856297771135, 18.640290434161813, 19.085724922517926, 11.364670418202877, 11.047735832631588, 11.090209245681763, 23.81494020919004, 24.09685933838287, 24.268434325853974, 18.57174366464217, 18.69338659321268, 17.66662176450093, 25.963601806511477, 26.09237278470148, 26.043249761064843, 24.39391467596093, 24.220129604140908, 23.352898488442094, 23.076519576211766, 23.29322362442811, 23.276857679088906, 29.176248433689267, 29.71054044032158, 29.677982889736683, 23.330904891093567, 23.868058205892638, 23.613498670359448, 30.16974564393361, 30.806318556269005, 30.419214253624276, 33.788629362980515, 34.21547774473825, 34.198849129180104, 26.02784338966012, 26.270840164273977, 25.75279714167118, 30.521913866202027, 31.130231625090033, 31.019613451013953, 22.82986094926794, 23.027924697225288, 21.965787818034485, 30.100321809450776, 29.135901818672806, 29.948809354255587, 30.838686175644398, 30.6724296733737, 30.88877221941948, 16.60341148264706, 16.542846392840147, 16.312142200767994, 27.224757147952914, 27.193087002262473, 26.808546528220177, 18.653519339859486, 18.67862608283758, 18.89802049845457, 24.55082406227787, 24.369103749593094, 24.329947148760155, 35.31895387390007, 35.24950155926247, 35.34039962509026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14525856558252634, "mean_inference_ms": 0.6896937088165849, "mean_action_processing_ms": 0.10022711105328988, "mean_env_wait_ms": 0.8470112236396389, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 435000, "timesteps_this_iter": 0, "agent_timesteps_total": 1305000, "timers": {"sample_time_ms": 10771.269, "sample_throughput": 464.198, "load_time_ms": 0.513, "load_throughput": 9743771.779, "learn_time_ms": 1545.055, "learn_throughput": 3236.13, "update_time_ms": 7.628}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7347234759768072e-19, "cur_lr": 0.0005000000000000001, "total_loss": 4.2832831859588625, "policy_loss": -0.0018710563426491689, "vf_loss": 4.371158695220947, "vf_explained_var": -0.11810377836227418, "kl": 0.002474325086242859, "entropy": 8.60043420791626, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 435000, "num_agent_steps_sampled": 1305000, "num_steps_trained": 435000, "num_agent_steps_trained": 1305000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1719, "training_iteration": 87, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-24-43", "timestamp": 1706228683, "time_this_iter_s": 10.911066055297852, "time_total_s": 925.3529481887817, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282569550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 925.3529481887817, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 8.2375, "ram_util_percent": 53.943749999999994}}
{"episode_reward_max": 105.9088550582528, "episode_reward_min": -314.96595004945993, "episode_reward_mean": 55.639250362106814, "episode_len_mean": 492.71, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -112.05555311838786}, "policy_reward_max": {"shared_policy": 35.34039962509026}, "policy_reward_mean": {"shared_policy": 18.546416787368937}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.90364116989075, 59.96369960345325, 32.31119751930234, 58.914441676810384, 41.16773390769956, 34.7411971464753, 63.39257007488048, 42.54695648979394, 72.76783824339509, 58.81305228546259, -314.96595004945993, 63.82524815108627, 68.80988309532404, 45.949420183897004, 65.54899225803089, 52.68392744101581, 24.419940739870043, 49.864520715549574, 68.5565176345408, 50.0138313360512, 53.172311648726435, 58.824784485623226, 75.47367307357487, -224.16393211390823, 44.67413065582511, 81.47812472283839, 86.82368048653005, 40.34705045819281, 57.39634453970936, 32.67959572188556, 41.40538874827325, 88.0939430836588, 92.94918186683208, 44.81642309483138, 74.00056425482033, 65.64858710765839, 65.72329428326336, 68.98304583877322, 41.8880281727761, 64.84317131061107, 95.3121470659971, 42.87112151598558, 74.16442365804684, 60.12986235693094, 47.97166953608394, 57.414029922336326, 58.85461296886203, 66.7294687144458, 30.654571820050478, 62.54235611483453, 63.170496020466075, 54.03821844980118, 60.51828966289759, 96.25610119104383, 50.57284473441541, 76.30581083148718, 66.23703216761349, 94.58160028047857, 49.18796864338216, 73.37191142514347, 52.45757723599671, 85.67890383116898, 87.90208537504076, 68.49999921442941, 42.80717311799526, 70.08525667991486, 65.99041724577543, 60.56633087992667, 58.19092981703578, 56.12457833439109, 33.50261549651623, 72.18023387342689, 54.93175202235578, 78.0992243522778, 71.96694276854393, 69.64660087972878, 88.56477176374753, 70.81246176734565, 91.39527845382689, 102.20295623689887, 78.05148069560528, 92.67175894230601, 67.82357346452771, 89.18503298237917, 92.39988806843758, 49.4584000762552, 81.22639067843556, 56.23016592115164, 73.24987496063112, 105.9088550582528, 73.94228541199115, 65.25790932402015, 85.16325265169144, 78.23264719545841, 79.21655189152806, -266.4323095586151, 86.30404634773731, 94.1525534178363, 83.38263410702348, 92.72336708381769], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 72, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 231, 500, 500, 500, 500], "policy_shared_policy_reward": [16.006222938497856, 17.00475734037657, 15.89266089101632, 20.168980666125805, 19.81148017446199, 19.983238762865454, 10.945461715261132, 11.14873858789602, 10.216997216145188, 19.636127829551697, 19.916250558570027, 19.36206328868866, 13.757309744755418, 13.626888411740453, 13.783535751203686, 11.635547277828053, 11.633470353980854, 11.472179514666394, 21.508279794439048, 21.33094472934802, 20.553345551093415, 14.52471717478086, 14.433586222430066, 13.588653092583016, 24.18301396816969, 24.067622877657413, 24.517201397567987, 20.01798968637982, 19.05236570040384, 19.74269689867893, -101.44855315300326, -101.46184377806883, -112.05555311838786, 21.138139873743057, 21.19709751009941, 21.490010767243803, 23.185617819428444, 22.317776650190353, 23.306488625705242, 15.745351289709404, 15.204231714208916, 14.999837179978684, 22.2616495109784, 21.52780836323896, 21.75953438381353, 17.411373051504285, 17.632361565406114, 17.640192824105412, 8.180062035719544, 8.261175165573746, 7.978703538576752, 16.43606812258561, 16.623287597050265, 16.8051649959137, 23.131850961595774, 22.508266031742096, 22.916400641202927, 16.40039339164892, 17.216808362553508, 16.39662958184877, 17.77682741979757, 17.697590606907994, 17.69789362202087, 20.22295788240929, 19.997621302803353, 18.604205300410584, 25.08892661581436, 25.176859765003115, 25.2078866927574, -72.04821163415909, -81.36131459474564, -70.75440588500351, 15.216504501799733, 14.926926548282296, 14.53069960574308, 27.195011177410677, 27.24860145275791, 27.0345120926698, 29.11794109952946, 29.11314255309601, 28.59259683390458, 13.794353564580277, 13.672866781552628, 12.879830112059906, 18.909288505713135, 19.36550000278899, 19.121556031207234, 10.598305776715279, 10.819570809602737, 11.261719135567546, 14.027504740282893, 13.477371647953987, 13.900512360036373, 28.846561213334397, 29.6249273729821, 29.622454497342304, 31.351357837207615, 30.880431555211544, 30.717392474412918, 15.278245145144552, 14.770186538497597, 14.767991411189229, 24.834583563109234, 24.555904058118657, 24.610076633592442, 22.174538660794497, 22.031891372054815, 21.442157074809074, 21.608969608942658, 22.0989705879862, 22.015354086334497, 23.256469177703053, 22.90664746860662, 22.819929192463547, 14.168024964630604, 13.33625790476799, 14.38374530337751, 21.636551678180695, 21.31573425978422, 21.890885372646153, 31.989083519826323, 31.799359663079173, 31.5237038830916, 14.19501780718565, 14.043255887925625, 14.632847820874304, 24.53090605388084, 24.815153380079806, 24.818364224086196, 20.361882946143538, 19.62735756735006, 20.140621843437344, 15.95665892213583, 15.90874494612217, 16.106265667825937, 19.222113785644368, 18.880713542302445, 19.311202594389513, 19.605778536448867, 19.61968372265497, 19.629150709758193, 22.138479399184376, 22.325369036446006, 22.26562027881542, 9.98768463730812, 10.569424014538527, 10.09746316820383, 21.185811029126242, 20.573797484238938, 20.782747601469353, 21.195420542110995, 20.919285354514912, 21.05579012384017, 17.99868171537915, 18.070313813785702, 17.969222920636327, 20.157791391015053, 20.478162743151188, 19.882335528731346, 32.09076420838633, 32.24178613598147, 31.923550846676022, 16.806009598076344, 16.73985492438078, 17.02698021195829, 25.515621153637767, 25.513719560578465, 25.276470117270947, 21.86678000291188, 22.285719481607273, 22.084532683094338, 31.53029420475164, 32.085564193005354, 30.965741882721574, 16.293446260193974, 16.34579139451185, 16.54873098867634, 24.522094969948128, 24.679747634877756, 24.17006882031758, 17.614682783683136, 17.28898937006791, 17.553905082245663, 28.73218543144563, 28.451827245453984, 28.494891154269368, 29.243766983350113, 29.3635461119314, 29.294772279759243, 22.926852121949196, 23.170795727986842, 22.40235136449337, 13.73416830599308, 14.722089439630508, 14.350915372371674, 23.51541576689729, 23.197122330466897, 23.372718582550675, 21.754542315999657, 22.007926205794007, 22.22794872398177, 20.4759460662802, 20.167299655576542, 19.923085158069924, 19.50014210057755, 19.464608819534376, 19.226178896923855, 18.39856297771135, 18.640290434161813, 19.085724922517926, 11.364670418202877, 11.047735832631588, 11.090209245681763, 23.81494020919004, 24.09685933838287, 24.268434325853974, 18.57174366464217, 18.69338659321268, 17.66662176450093, 25.963601806511477, 26.09237278470148, 26.043249761064843, 24.39391467596093, 24.220129604140908, 23.352898488442094, 23.076519576211766, 23.29322362442811, 23.276857679088906, 29.176248433689267, 29.71054044032158, 29.677982889736683, 23.330904891093567, 23.868058205892638, 23.613498670359448, 30.16974564393361, 30.806318556269005, 30.419214253624276, 33.788629362980515, 34.21547774473825, 34.198849129180104, 26.02784338966012, 26.270840164273977, 25.75279714167118, 30.521913866202027, 31.130231625090033, 31.019613451013953, 22.82986094926794, 23.027924697225288, 21.965787818034485, 30.100321809450776, 29.135901818672806, 29.948809354255587, 30.838686175644398, 30.6724296733737, 30.88877221941948, 16.60341148264706, 16.542846392840147, 16.312142200767994, 27.224757147952914, 27.193087002262473, 26.808546528220177, 18.653519339859486, 18.67862608283758, 18.89802049845457, 24.55082406227787, 24.369103749593094, 24.329947148760155, 35.31895387390007, 35.24950155926247, 35.34039962509026, 24.424574779967458, 24.842470585989446, 24.675240046034247, 22.213663827627897, 21.83638559281826, 21.20785990357399, 28.37379638105631, 28.53924371302128, 28.25021255761385, 26.185850167647004, 25.75867711752653, 26.288119910284877, 26.639926523280636, 26.524226666738585, 26.052398701508835, -85.51686223844688, -96.32001552979152, -84.59543179037671, 28.46796353161335, 28.93264275789261, 28.903440058231354, 31.761042459363424, 31.41662663718064, 30.974884321292237, 27.313250333070755, 28.110826212912798, 27.958557561039925, 30.778010586897523, 30.76445850233236, 31.18089799458781]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14524410597835538, "mean_inference_ms": 0.6899173097643713, "mean_action_processing_ms": 0.10026121901443537, "mean_env_wait_ms": 0.8473529982982682, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 440000, "timesteps_this_iter": 0, "agent_timesteps_total": 1320000, "timers": {"sample_time_ms": 10766.939, "sample_throughput": 464.385, "load_time_ms": 0.513, "load_throughput": 9743771.779, "learn_time_ms": 1548.603, "learn_throughput": 3228.716, "update_time_ms": 7.626}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.673617379884036e-20, "cur_lr": 0.0005000000000000001, "total_loss": 111.36121292114258, "policy_loss": -0.0012463981055390594, "vf_loss": 111.44902420043945, "vf_explained_var": -0.012792372703552246, "kl": 0.004039961812688582, "entropy": 8.656376361846924, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 440000, "num_agent_steps_sampled": 1320000, "num_steps_trained": 440000, "num_agent_steps_trained": 1320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1729, "training_iteration": 88, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-24-53", "timestamp": 1706228693, "time_this_iter_s": 10.34146499633789, "time_total_s": 935.6944131851196, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202837C3280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 935.6944131851196, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 7.814285714285714, "ram_util_percent": 53.89999999999999}}
{"episode_reward_max": 105.9088550582528, "episode_reward_min": -266.4323095586151, "episode_reward_mean": 59.454038266650166, "episode_len_mean": 494.07, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -96.32001552979152}, "policy_reward_max": {"shared_policy": 35.34039962509026}, "policy_reward_mean": {"shared_policy": 19.81801275555005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.82524815108627, 68.80988309532404, 45.949420183897004, 65.54899225803089, 52.68392744101581, 24.419940739870043, 49.864520715549574, 68.5565176345408, 50.0138313360512, 53.172311648726435, 58.824784485623226, 75.47367307357487, -224.16393211390823, 44.67413065582511, 81.47812472283839, 86.82368048653005, 40.34705045819281, 57.39634453970936, 32.67959572188556, 41.40538874827325, 88.0939430836588, 92.94918186683208, 44.81642309483138, 74.00056425482033, 65.64858710765839, 65.72329428326336, 68.98304583877322, 41.8880281727761, 64.84317131061107, 95.3121470659971, 42.87112151598558, 74.16442365804684, 60.12986235693094, 47.97166953608394, 57.414029922336326, 58.85461296886203, 66.7294687144458, 30.654571820050478, 62.54235611483453, 63.170496020466075, 54.03821844980118, 60.51828966289759, 96.25610119104383, 50.57284473441541, 76.30581083148718, 66.23703216761349, 94.58160028047857, 49.18796864338216, 73.37191142514347, 52.45757723599671, 85.67890383116898, 87.90208537504076, 68.49999921442941, 42.80717311799526, 70.08525667991486, 65.99041724577543, 60.56633087992667, 58.19092981703578, 56.12457833439109, 33.50261549651623, 72.18023387342689, 54.93175202235578, 78.0992243522778, 71.96694276854393, 69.64660087972878, 88.56477176374753, 70.81246176734565, 91.39527845382689, 102.20295623689887, 78.05148069560528, 92.67175894230601, 67.82357346452771, 89.18503298237917, 92.39988806843758, 49.4584000762552, 81.22639067843556, 56.23016592115164, 73.24987496063112, 105.9088550582528, 73.94228541199115, 65.25790932402015, 85.16325265169144, 78.23264719545841, 79.21655189152806, -266.4323095586151, 86.30404634773731, 94.1525534178363, 83.38263410702348, 92.72336708381769, 78.80117070744743, 63.53115180251186, 92.6412083012983, 68.83113802503792, -259.3477607034147, 86.4882004112005, 88.50891254097222, 84.05162813793865, 83.72465620189905, 91.43876004777847, 101.36610304936767], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 468, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 231, 500, 500, 500, 500, 500, 500, 500, 500, 208, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [21.138139873743057, 21.19709751009941, 21.490010767243803, 23.185617819428444, 22.317776650190353, 23.306488625705242, 15.745351289709404, 15.204231714208916, 14.999837179978684, 22.2616495109784, 21.52780836323896, 21.75953438381353, 17.411373051504285, 17.632361565406114, 17.640192824105412, 8.180062035719544, 8.261175165573746, 7.978703538576752, 16.43606812258561, 16.623287597050265, 16.8051649959137, 23.131850961595774, 22.508266031742096, 22.916400641202927, 16.40039339164892, 17.216808362553508, 16.39662958184877, 17.77682741979757, 17.697590606907994, 17.69789362202087, 20.22295788240929, 19.997621302803353, 18.604205300410584, 25.08892661581436, 25.176859765003115, 25.2078866927574, -72.04821163415909, -81.36131459474564, -70.75440588500351, 15.216504501799733, 14.926926548282296, 14.53069960574308, 27.195011177410677, 27.24860145275791, 27.0345120926698, 29.11794109952946, 29.11314255309601, 28.59259683390458, 13.794353564580277, 13.672866781552628, 12.879830112059906, 18.909288505713135, 19.36550000278899, 19.121556031207234, 10.598305776715279, 10.819570809602737, 11.261719135567546, 14.027504740282893, 13.477371647953987, 13.900512360036373, 28.846561213334397, 29.6249273729821, 29.622454497342304, 31.351357837207615, 30.880431555211544, 30.717392474412918, 15.278245145144552, 14.770186538497597, 14.767991411189229, 24.834583563109234, 24.555904058118657, 24.610076633592442, 22.174538660794497, 22.031891372054815, 21.442157074809074, 21.608969608942658, 22.0989705879862, 22.015354086334497, 23.256469177703053, 22.90664746860662, 22.819929192463547, 14.168024964630604, 13.33625790476799, 14.38374530337751, 21.636551678180695, 21.31573425978422, 21.890885372646153, 31.989083519826323, 31.799359663079173, 31.5237038830916, 14.19501780718565, 14.043255887925625, 14.632847820874304, 24.53090605388084, 24.815153380079806, 24.818364224086196, 20.361882946143538, 19.62735756735006, 20.140621843437344, 15.95665892213583, 15.90874494612217, 16.106265667825937, 19.222113785644368, 18.880713542302445, 19.311202594389513, 19.605778536448867, 19.61968372265497, 19.629150709758193, 22.138479399184376, 22.325369036446006, 22.26562027881542, 9.98768463730812, 10.569424014538527, 10.09746316820383, 21.185811029126242, 20.573797484238938, 20.782747601469353, 21.195420542110995, 20.919285354514912, 21.05579012384017, 17.99868171537915, 18.070313813785702, 17.969222920636327, 20.157791391015053, 20.478162743151188, 19.882335528731346, 32.09076420838633, 32.24178613598147, 31.923550846676022, 16.806009598076344, 16.73985492438078, 17.02698021195829, 25.515621153637767, 25.513719560578465, 25.276470117270947, 21.86678000291188, 22.285719481607273, 22.084532683094338, 31.53029420475164, 32.085564193005354, 30.965741882721574, 16.293446260193974, 16.34579139451185, 16.54873098867634, 24.522094969948128, 24.679747634877756, 24.17006882031758, 17.614682783683136, 17.28898937006791, 17.553905082245663, 28.73218543144563, 28.451827245453984, 28.494891154269368, 29.243766983350113, 29.3635461119314, 29.294772279759243, 22.926852121949196, 23.170795727986842, 22.40235136449337, 13.73416830599308, 14.722089439630508, 14.350915372371674, 23.51541576689729, 23.197122330466897, 23.372718582550675, 21.754542315999657, 22.007926205794007, 22.22794872398177, 20.4759460662802, 20.167299655576542, 19.923085158069924, 19.50014210057755, 19.464608819534376, 19.226178896923855, 18.39856297771135, 18.640290434161813, 19.085724922517926, 11.364670418202877, 11.047735832631588, 11.090209245681763, 23.81494020919004, 24.09685933838287, 24.268434325853974, 18.57174366464217, 18.69338659321268, 17.66662176450093, 25.963601806511477, 26.09237278470148, 26.043249761064843, 24.39391467596093, 24.220129604140908, 23.352898488442094, 23.076519576211766, 23.29322362442811, 23.276857679088906, 29.176248433689267, 29.71054044032158, 29.677982889736683, 23.330904891093567, 23.868058205892638, 23.613498670359448, 30.16974564393361, 30.806318556269005, 30.419214253624276, 33.788629362980515, 34.21547774473825, 34.198849129180104, 26.02784338966012, 26.270840164273977, 25.75279714167118, 30.521913866202027, 31.130231625090033, 31.019613451013953, 22.82986094926794, 23.027924697225288, 21.965787818034485, 30.100321809450776, 29.135901818672806, 29.948809354255587, 30.838686175644398, 30.6724296733737, 30.88877221941948, 16.60341148264706, 16.542846392840147, 16.312142200767994, 27.224757147952914, 27.193087002262473, 26.808546528220177, 18.653519339859486, 18.67862608283758, 18.89802049845457, 24.55082406227787, 24.369103749593094, 24.329947148760155, 35.31895387390007, 35.24950155926247, 35.34039962509026, 24.424574779967458, 24.842470585989446, 24.675240046034247, 22.213663827627897, 21.83638559281826, 21.20785990357399, 28.37379638105631, 28.53924371302128, 28.25021255761385, 26.185850167647004, 25.75867711752653, 26.288119910284877, 26.639926523280636, 26.524226666738585, 26.052398701508835, -85.51686223844688, -96.32001552979152, -84.59543179037671, 28.46796353161335, 28.93264275789261, 28.903440058231354, 31.761042459363424, 31.41662663718064, 30.974884321292237, 27.313250333070755, 28.110826212912798, 27.958557561039925, 30.778010586897523, 30.76445850233236, 31.18089799458781, 26.420979672499612, 26.283769678945333, 26.09642135600248, 20.92772191266218, 21.027693318823964, 21.575736571025715, 31.14387711634238, 31.481148355019585, 30.01618282993634, 23.015776741007954, 22.399629334608704, 23.415731949421257, -82.58397355303168, -83.73302364349365, -93.03076350688934, 28.613995383183152, 28.890070574978978, 28.984134453038365, 29.36260215689738, 29.565194023152188, 29.58111636092265, 27.536393488446862, 28.135798564801604, 28.379436084690184, 27.926660783588886, 27.829360485076904, 27.96863493323326, 30.584814790015415, 30.549115789433316, 30.304829468329743, 34.14585392922163, 33.14273543655872, 34.07751368358731]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14519088106292916, "mean_inference_ms": 0.6899264018225852, "mean_action_processing_ms": 0.10027654165763597, "mean_env_wait_ms": 0.847500764928204, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 445000, "timesteps_this_iter": 0, "agent_timesteps_total": 1335000, "timers": {"sample_time_ms": 10762.892, "sample_throughput": 464.559, "load_time_ms": 0.413, "load_throughput": 12101281.016, "learn_time_ms": 1552.515, "learn_throughput": 3220.58, "update_time_ms": 7.557}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.336808689942018e-20, "cur_lr": 0.0005000000000000001, "total_loss": 109.5033073425293, "policy_loss": -0.0019069168966589166, "vf_loss": 109.59385757446289, "vf_explained_var": -0.006585443019866943, "kl": 0.0069530003529727005, "entropy": 8.864596176147462, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 445000, "num_agent_steps_sampled": 1335000, "num_steps_trained": 445000, "num_agent_steps_trained": 1335000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1740, "training_iteration": 89, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-25-03", "timestamp": 1706228703, "time_this_iter_s": 10.36076545715332, "time_total_s": 946.055178642273, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824D0670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 946.055178642273, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 7.686666666666667, "ram_util_percent": 53.83999999999999}}
{"episode_reward_max": 105.9088550582528, "episode_reward_min": -322.51237818738446, "episode_reward_mean": 57.20569597189867, "episode_len_mean": 489.89, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -117.75032639503479}, "policy_reward_max": {"shared_policy": 35.34039962509026}, "policy_reward_mean": {"shared_policy": 19.06856532396622}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.47367307357487, -224.16393211390823, 44.67413065582511, 81.47812472283839, 86.82368048653005, 40.34705045819281, 57.39634453970936, 32.67959572188556, 41.40538874827325, 88.0939430836588, 92.94918186683208, 44.81642309483138, 74.00056425482033, 65.64858710765839, 65.72329428326336, 68.98304583877322, 41.8880281727761, 64.84317131061107, 95.3121470659971, 42.87112151598558, 74.16442365804684, 60.12986235693094, 47.97166953608394, 57.414029922336326, 58.85461296886203, 66.7294687144458, 30.654571820050478, 62.54235611483453, 63.170496020466075, 54.03821844980118, 60.51828966289759, 96.25610119104383, 50.57284473441541, 76.30581083148718, 66.23703216761349, 94.58160028047857, 49.18796864338216, 73.37191142514347, 52.45757723599671, 85.67890383116898, 87.90208537504076, 68.49999921442941, 42.80717311799526, 70.08525667991486, 65.99041724577543, 60.56633087992667, 58.19092981703578, 56.12457833439109, 33.50261549651623, 72.18023387342689, 54.93175202235578, 78.0992243522778, 71.96694276854393, 69.64660087972878, 88.56477176374753, 70.81246176734565, 91.39527845382689, 102.20295623689887, 78.05148069560528, 92.67175894230601, 67.82357346452771, 89.18503298237917, 92.39988806843758, 49.4584000762552, 81.22639067843556, 56.23016592115164, 73.24987496063112, 105.9088550582528, 73.94228541199115, 65.25790932402015, 85.16325265169144, 78.23264719545841, 79.21655189152806, -266.4323095586151, 86.30404634773731, 94.1525534178363, 83.38263410702348, 92.72336708381769, 78.80117070744743, 63.53115180251186, 92.6412083012983, 68.83113802503792, -259.3477607034147, 86.4882004112005, 88.50891254097222, 84.05162813793865, 83.72465620189905, 91.43876004777847, 101.36610304936767, 55.10876555740833, 72.31010071374476, 73.73944005370139, 69.39668009616435, -322.51237818738446, 56.07630643688026, 61.154358102008686, 75.0584480706602, 63.870318561792374, 92.09760046005249, 80.53550834953782], "episode_lengths": [500, 468, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 231, 500, 500, 500, 500, 500, 500, 500, 500, 208, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [25.08892661581436, 25.176859765003115, 25.2078866927574, -72.04821163415909, -81.36131459474564, -70.75440588500351, 15.216504501799733, 14.926926548282296, 14.53069960574308, 27.195011177410677, 27.24860145275791, 27.0345120926698, 29.11794109952946, 29.11314255309601, 28.59259683390458, 13.794353564580277, 13.672866781552628, 12.879830112059906, 18.909288505713135, 19.36550000278899, 19.121556031207234, 10.598305776715279, 10.819570809602737, 11.261719135567546, 14.027504740282893, 13.477371647953987, 13.900512360036373, 28.846561213334397, 29.6249273729821, 29.622454497342304, 31.351357837207615, 30.880431555211544, 30.717392474412918, 15.278245145144552, 14.770186538497597, 14.767991411189229, 24.834583563109234, 24.555904058118657, 24.610076633592442, 22.174538660794497, 22.031891372054815, 21.442157074809074, 21.608969608942658, 22.0989705879862, 22.015354086334497, 23.256469177703053, 22.90664746860662, 22.819929192463547, 14.168024964630604, 13.33625790476799, 14.38374530337751, 21.636551678180695, 21.31573425978422, 21.890885372646153, 31.989083519826323, 31.799359663079173, 31.5237038830916, 14.19501780718565, 14.043255887925625, 14.632847820874304, 24.53090605388084, 24.815153380079806, 24.818364224086196, 20.361882946143538, 19.62735756735006, 20.140621843437344, 15.95665892213583, 15.90874494612217, 16.106265667825937, 19.222113785644368, 18.880713542302445, 19.311202594389513, 19.605778536448867, 19.61968372265497, 19.629150709758193, 22.138479399184376, 22.325369036446006, 22.26562027881542, 9.98768463730812, 10.569424014538527, 10.09746316820383, 21.185811029126242, 20.573797484238938, 20.782747601469353, 21.195420542110995, 20.919285354514912, 21.05579012384017, 17.99868171537915, 18.070313813785702, 17.969222920636327, 20.157791391015053, 20.478162743151188, 19.882335528731346, 32.09076420838633, 32.24178613598147, 31.923550846676022, 16.806009598076344, 16.73985492438078, 17.02698021195829, 25.515621153637767, 25.513719560578465, 25.276470117270947, 21.86678000291188, 22.285719481607273, 22.084532683094338, 31.53029420475164, 32.085564193005354, 30.965741882721574, 16.293446260193974, 16.34579139451185, 16.54873098867634, 24.522094969948128, 24.679747634877756, 24.17006882031758, 17.614682783683136, 17.28898937006791, 17.553905082245663, 28.73218543144563, 28.451827245453984, 28.494891154269368, 29.243766983350113, 29.3635461119314, 29.294772279759243, 22.926852121949196, 23.170795727986842, 22.40235136449337, 13.73416830599308, 14.722089439630508, 14.350915372371674, 23.51541576689729, 23.197122330466897, 23.372718582550675, 21.754542315999657, 22.007926205794007, 22.22794872398177, 20.4759460662802, 20.167299655576542, 19.923085158069924, 19.50014210057755, 19.464608819534376, 19.226178896923855, 18.39856297771135, 18.640290434161813, 19.085724922517926, 11.364670418202877, 11.047735832631588, 11.090209245681763, 23.81494020919004, 24.09685933838287, 24.268434325853974, 18.57174366464217, 18.69338659321268, 17.66662176450093, 25.963601806511477, 26.09237278470148, 26.043249761064843, 24.39391467596093, 24.220129604140908, 23.352898488442094, 23.076519576211766, 23.29322362442811, 23.276857679088906, 29.176248433689267, 29.71054044032158, 29.677982889736683, 23.330904891093567, 23.868058205892638, 23.613498670359448, 30.16974564393361, 30.806318556269005, 30.419214253624276, 33.788629362980515, 34.21547774473825, 34.198849129180104, 26.02784338966012, 26.270840164273977, 25.75279714167118, 30.521913866202027, 31.130231625090033, 31.019613451013953, 22.82986094926794, 23.027924697225288, 21.965787818034485, 30.100321809450776, 29.135901818672806, 29.948809354255587, 30.838686175644398, 30.6724296733737, 30.88877221941948, 16.60341148264706, 16.542846392840147, 16.312142200767994, 27.224757147952914, 27.193087002262473, 26.808546528220177, 18.653519339859486, 18.67862608283758, 18.89802049845457, 24.55082406227787, 24.369103749593094, 24.329947148760155, 35.31895387390007, 35.24950155926247, 35.34039962509026, 24.424574779967458, 24.842470585989446, 24.675240046034247, 22.213663827627897, 21.83638559281826, 21.20785990357399, 28.37379638105631, 28.53924371302128, 28.25021255761385, 26.185850167647004, 25.75867711752653, 26.288119910284877, 26.639926523280636, 26.524226666738585, 26.052398701508835, -85.51686223844688, -96.32001552979152, -84.59543179037671, 28.46796353161335, 28.93264275789261, 28.903440058231354, 31.761042459363424, 31.41662663718064, 30.974884321292237, 27.313250333070755, 28.110826212912798, 27.958557561039925, 30.778010586897523, 30.76445850233236, 31.18089799458781, 26.420979672499612, 26.283769678945333, 26.09642135600248, 20.92772191266218, 21.027693318823964, 21.575736571025715, 31.14387711634238, 31.481148355019585, 30.01618282993634, 23.015776741007954, 22.399629334608704, 23.415731949421257, -82.58397355303168, -83.73302364349365, -93.03076350688934, 28.613995383183152, 28.890070574978978, 28.984134453038365, 29.36260215689738, 29.565194023152188, 29.58111636092265, 27.536393488446862, 28.135798564801604, 28.379436084690184, 27.926660783588886, 27.829360485076904, 27.96863493323326, 30.584814790015415, 30.549115789433316, 30.304829468329743, 34.14585392922163, 33.14273543655872, 34.07751368358731, 18.739550687372684, 18.403775744140148, 17.9654391258955, 23.94541595876217, 24.04659165814519, 24.3180930968374, 24.46538971861203, 24.674625379343823, 24.599424955745533, 23.13741284608841, 22.862993583083153, 23.396273666992784, -102.59821135550737, -102.16384043684229, -117.75032639503479, 18.647746667265892, 18.689558650366962, 18.739001119247405, 20.561105042075113, 20.498051234831408, 20.095201825102166, 24.52725079158941, 25.221651087204606, 25.30954619186619, 20.879202246665955, 21.25774098932743, 21.73337532579899, 30.85872159153223, 30.505503423511982, 30.733375445008278, 26.964610601464898, 26.511833826700837, 27.059063921372086]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14511951963754868, "mean_inference_ms": 0.6897539409870155, "mean_action_processing_ms": 0.10029317266926908, "mean_env_wait_ms": 0.8474473225362648, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 450000, "timesteps_this_iter": 0, "agent_timesteps_total": 1350000, "timers": {"sample_time_ms": 10740.023, "sample_throughput": 465.548, "load_time_ms": 0.313, "load_throughput": 15962490.486, "learn_time_ms": 1557.435, "learn_throughput": 3210.407, "update_time_ms": 7.557}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.336808689942018e-20, "cur_lr": 0.0005000000000000001, "total_loss": 101.23474731445313, "policy_loss": -0.00328206349472826, "vf_loss": 101.32482681274413, "vf_explained_var": 0.026616692543029785, "kl": 0.0072050758288453465, "entropy": 8.679652690887451, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 450000, "num_agent_steps_sampled": 1350000, "num_steps_trained": 450000, "num_agent_steps_trained": 1350000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1751, "training_iteration": 90, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-25-14", "timestamp": 1706228714, "time_this_iter_s": 10.459479808807373, "time_total_s": 956.5146584510803, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282490D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 956.5146584510803, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 7.4799999999999995, "ram_util_percent": 53.92666666666666}}
{"episode_reward_max": 121.45145941525696, "episode_reward_min": -322.51237818738446, "episode_reward_mean": 58.91643355837645, "episode_len_mean": 486.76, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -117.75032639503479}, "policy_reward_max": {"shared_policy": 40.845055145521954}, "policy_reward_mean": {"shared_policy": 19.63881118612548}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.81642309483138, 74.00056425482033, 65.64858710765839, 65.72329428326336, 68.98304583877322, 41.8880281727761, 64.84317131061107, 95.3121470659971, 42.87112151598558, 74.16442365804684, 60.12986235693094, 47.97166953608394, 57.414029922336326, 58.85461296886203, 66.7294687144458, 30.654571820050478, 62.54235611483453, 63.170496020466075, 54.03821844980118, 60.51828966289759, 96.25610119104383, 50.57284473441541, 76.30581083148718, 66.23703216761349, 94.58160028047857, 49.18796864338216, 73.37191142514347, 52.45757723599671, 85.67890383116898, 87.90208537504076, 68.49999921442941, 42.80717311799526, 70.08525667991486, 65.99041724577543, 60.56633087992667, 58.19092981703578, 56.12457833439109, 33.50261549651623, 72.18023387342689, 54.93175202235578, 78.0992243522778, 71.96694276854393, 69.64660087972878, 88.56477176374753, 70.81246176734565, 91.39527845382689, 102.20295623689887, 78.05148069560528, 92.67175894230601, 67.82357346452771, 89.18503298237917, 92.39988806843758, 49.4584000762552, 81.22639067843556, 56.23016592115164, 73.24987496063112, 105.9088550582528, 73.94228541199115, 65.25790932402015, 85.16325265169144, 78.23264719545841, 79.21655189152806, -266.4323095586151, 86.30404634773731, 94.1525534178363, 83.38263410702348, 92.72336708381769, 78.80117070744743, 63.53115180251186, 92.6412083012983, 68.83113802503792, -259.3477607034147, 86.4882004112005, 88.50891254097222, 84.05162813793865, 83.72465620189905, 91.43876004777847, 101.36610304936767, 55.10876555740833, 72.31010071374476, 73.73944005370139, 69.39668009616435, -322.51237818738446, 56.07630643688026, 61.154358102008686, 75.0584480706602, 63.870318561792374, 92.09760046005249, 80.53550834953782, 62.78159626200794, 75.5610892623663, 61.762735795229645, 88.14678856171666, 67.71530657541007, 97.4360636100173, -260.20170121639967, 121.45145941525696, 108.57950793579221, 70.55702281277627, 94.44107087701556], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 231, 500, 500, 500, 500, 500, 500, 500, 500, 208, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 155, 500, 500, 500, 500], "policy_shared_policy_reward": [15.278245145144552, 14.770186538497597, 14.767991411189229, 24.834583563109234, 24.555904058118657, 24.610076633592442, 22.174538660794497, 22.031891372054815, 21.442157074809074, 21.608969608942658, 22.0989705879862, 22.015354086334497, 23.256469177703053, 22.90664746860662, 22.819929192463547, 14.168024964630604, 13.33625790476799, 14.38374530337751, 21.636551678180695, 21.31573425978422, 21.890885372646153, 31.989083519826323, 31.799359663079173, 31.5237038830916, 14.19501780718565, 14.043255887925625, 14.632847820874304, 24.53090605388084, 24.815153380079806, 24.818364224086196, 20.361882946143538, 19.62735756735006, 20.140621843437344, 15.95665892213583, 15.90874494612217, 16.106265667825937, 19.222113785644368, 18.880713542302445, 19.311202594389513, 19.605778536448867, 19.61968372265497, 19.629150709758193, 22.138479399184376, 22.325369036446006, 22.26562027881542, 9.98768463730812, 10.569424014538527, 10.09746316820383, 21.185811029126242, 20.573797484238938, 20.782747601469353, 21.195420542110995, 20.919285354514912, 21.05579012384017, 17.99868171537915, 18.070313813785702, 17.969222920636327, 20.157791391015053, 20.478162743151188, 19.882335528731346, 32.09076420838633, 32.24178613598147, 31.923550846676022, 16.806009598076344, 16.73985492438078, 17.02698021195829, 25.515621153637767, 25.513719560578465, 25.276470117270947, 21.86678000291188, 22.285719481607273, 22.084532683094338, 31.53029420475164, 32.085564193005354, 30.965741882721574, 16.293446260193974, 16.34579139451185, 16.54873098867634, 24.522094969948128, 24.679747634877756, 24.17006882031758, 17.614682783683136, 17.28898937006791, 17.553905082245663, 28.73218543144563, 28.451827245453984, 28.494891154269368, 29.243766983350113, 29.3635461119314, 29.294772279759243, 22.926852121949196, 23.170795727986842, 22.40235136449337, 13.73416830599308, 14.722089439630508, 14.350915372371674, 23.51541576689729, 23.197122330466897, 23.372718582550675, 21.754542315999657, 22.007926205794007, 22.22794872398177, 20.4759460662802, 20.167299655576542, 19.923085158069924, 19.50014210057755, 19.464608819534376, 19.226178896923855, 18.39856297771135, 18.640290434161813, 19.085724922517926, 11.364670418202877, 11.047735832631588, 11.090209245681763, 23.81494020919004, 24.09685933838287, 24.268434325853974, 18.57174366464217, 18.69338659321268, 17.66662176450093, 25.963601806511477, 26.09237278470148, 26.043249761064843, 24.39391467596093, 24.220129604140908, 23.352898488442094, 23.076519576211766, 23.29322362442811, 23.276857679088906, 29.176248433689267, 29.71054044032158, 29.677982889736683, 23.330904891093567, 23.868058205892638, 23.613498670359448, 30.16974564393361, 30.806318556269005, 30.419214253624276, 33.788629362980515, 34.21547774473825, 34.198849129180104, 26.02784338966012, 26.270840164273977, 25.75279714167118, 30.521913866202027, 31.130231625090033, 31.019613451013953, 22.82986094926794, 23.027924697225288, 21.965787818034485, 30.100321809450776, 29.135901818672806, 29.948809354255587, 30.838686175644398, 30.6724296733737, 30.88877221941948, 16.60341148264706, 16.542846392840147, 16.312142200767994, 27.224757147952914, 27.193087002262473, 26.808546528220177, 18.653519339859486, 18.67862608283758, 18.89802049845457, 24.55082406227787, 24.369103749593094, 24.329947148760155, 35.31895387390007, 35.24950155926247, 35.34039962509026, 24.424574779967458, 24.842470585989446, 24.675240046034247, 22.213663827627897, 21.83638559281826, 21.20785990357399, 28.37379638105631, 28.53924371302128, 28.25021255761385, 26.185850167647004, 25.75867711752653, 26.288119910284877, 26.639926523280636, 26.524226666738585, 26.052398701508835, -85.51686223844688, -96.32001552979152, -84.59543179037671, 28.46796353161335, 28.93264275789261, 28.903440058231354, 31.761042459363424, 31.41662663718064, 30.974884321292237, 27.313250333070755, 28.110826212912798, 27.958557561039925, 30.778010586897523, 30.76445850233236, 31.18089799458781, 26.420979672499612, 26.283769678945333, 26.09642135600248, 20.92772191266218, 21.027693318823964, 21.575736571025715, 31.14387711634238, 31.481148355019585, 30.01618282993634, 23.015776741007954, 22.399629334608704, 23.415731949421257, -82.58397355303168, -83.73302364349365, -93.03076350688934, 28.613995383183152, 28.890070574978978, 28.984134453038365, 29.36260215689738, 29.565194023152188, 29.58111636092265, 27.536393488446862, 28.135798564801604, 28.379436084690184, 27.926660783588886, 27.829360485076904, 27.96863493323326, 30.584814790015415, 30.549115789433316, 30.304829468329743, 34.14585392922163, 33.14273543655872, 34.07751368358731, 18.739550687372684, 18.403775744140148, 17.9654391258955, 23.94541595876217, 24.04659165814519, 24.3180930968374, 24.46538971861203, 24.674625379343823, 24.599424955745533, 23.13741284608841, 22.862993583083153, 23.396273666992784, -102.59821135550737, -102.16384043684229, -117.75032639503479, 18.647746667265892, 18.689558650366962, 18.739001119247405, 20.561105042075113, 20.498051234831408, 20.095201825102166, 24.52725079158941, 25.221651087204606, 25.30954619186619, 20.879202246665955, 21.25774098932743, 21.73337532579899, 30.85872159153223, 30.505503423511982, 30.733375445008278, 26.964610601464898, 26.511833826700837, 27.059063921372086, 20.78283744057019, 21.150947661449507, 20.84781115998824, 25.527896150946617, 24.785875841975212, 25.247317269444466, 20.858112557480723, 20.498246925572545, 20.406376312176377, 29.351385732491806, 29.22987466057141, 29.565528168653444, 22.9235747968778, 22.16183438897133, 22.629897389560938, 32.63390411436558, 31.881898909807205, 32.92026058584452, -83.46847490469615, -93.67980846265952, -83.05341784904401, 40.845055145521954, 40.06731395920117, 40.53909031053384, 35.98465636372566, 36.52154879644513, 36.073302775621414, 23.352095291018486, 23.745201888494194, 23.459725633263588, 31.846617604295403, 30.746793816486985, 31.847659456233174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14499384540101753, "mean_inference_ms": 0.6897032884632753, "mean_action_processing_ms": 0.1003105633103786, "mean_env_wait_ms": 0.8474608648314195, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 455000, "timesteps_this_iter": 0, "agent_timesteps_total": 1365000, "timers": {"sample_time_ms": 10659.42, "sample_throughput": 469.069, "load_time_ms": 0.313, "load_throughput": 15962490.486, "learn_time_ms": 1554.623, "learn_throughput": 3216.214, "update_time_ms": 7.774}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.336808689942018e-20, "cur_lr": 0.0005000000000000001, "total_loss": 105.85392227172852, "policy_loss": -0.002058581299418627, "vf_loss": 105.94217376708984, "vf_explained_var": -0.010652518272399903, "kl": 0.006381270810400177, "entropy": 8.619197845458984, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 455000, "num_agent_steps_sampled": 1365000, "num_steps_trained": 455000, "num_agent_steps_trained": 1365000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1762, "training_iteration": 91, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-25-24", "timestamp": 1706228724, "time_this_iter_s": 10.270237445831299, "time_total_s": 966.7848958969116, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282575CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 966.7848958969116, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 6.878571428571428, "ram_util_percent": 53.92857142857143}}
{"episode_reward_max": 121.45145941525696, "episode_reward_min": -322.51237818738446, "episode_reward_mean": 61.38686763751641, "episode_len_mean": 486.76, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -117.75032639503479}, "policy_reward_max": {"shared_policy": 40.845055145521954}, "policy_reward_mean": {"shared_policy": 20.462289212505464}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.12986235693094, 47.97166953608394, 57.414029922336326, 58.85461296886203, 66.7294687144458, 30.654571820050478, 62.54235611483453, 63.170496020466075, 54.03821844980118, 60.51828966289759, 96.25610119104383, 50.57284473441541, 76.30581083148718, 66.23703216761349, 94.58160028047857, 49.18796864338216, 73.37191142514347, 52.45757723599671, 85.67890383116898, 87.90208537504076, 68.49999921442941, 42.80717311799526, 70.08525667991486, 65.99041724577543, 60.56633087992667, 58.19092981703578, 56.12457833439109, 33.50261549651623, 72.18023387342689, 54.93175202235578, 78.0992243522778, 71.96694276854393, 69.64660087972878, 88.56477176374753, 70.81246176734565, 91.39527845382689, 102.20295623689887, 78.05148069560528, 92.67175894230601, 67.82357346452771, 89.18503298237917, 92.39988806843758, 49.4584000762552, 81.22639067843556, 56.23016592115164, 73.24987496063112, 105.9088550582528, 73.94228541199115, 65.25790932402015, 85.16325265169144, 78.23264719545841, 79.21655189152806, -266.4323095586151, 86.30404634773731, 94.1525534178363, 83.38263410702348, 92.72336708381769, 78.80117070744743, 63.53115180251186, 92.6412083012983, 68.83113802503792, -259.3477607034147, 86.4882004112005, 88.50891254097222, 84.05162813793865, 83.72465620189905, 91.43876004777847, 101.36610304936767, 55.10876555740833, 72.31010071374476, 73.73944005370139, 69.39668009616435, -322.51237818738446, 56.07630643688026, 61.154358102008686, 75.0584480706602, 63.870318561792374, 92.09760046005249, 80.53550834953782, 62.78159626200794, 75.5610892623663, 61.762735795229645, 88.14678856171666, 67.71530657541007, 97.4360636100173, -260.20170121639967, 121.45145941525696, 108.57950793579221, 70.55702281277627, 94.44107087701556, 113.79963504127227, 80.63899218849835, 72.06673089414832, 103.10367273911831, 93.13829139340669, 58.8987144604325, 101.46359132789074, 85.12612449098378, 79.49382579699159, 97.56463588401675], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 231, 500, 500, 500, 500, 500, 500, 500, 500, 208, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 155, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [20.361882946143538, 19.62735756735006, 20.140621843437344, 15.95665892213583, 15.90874494612217, 16.106265667825937, 19.222113785644368, 18.880713542302445, 19.311202594389513, 19.605778536448867, 19.61968372265497, 19.629150709758193, 22.138479399184376, 22.325369036446006, 22.26562027881542, 9.98768463730812, 10.569424014538527, 10.09746316820383, 21.185811029126242, 20.573797484238938, 20.782747601469353, 21.195420542110995, 20.919285354514912, 21.05579012384017, 17.99868171537915, 18.070313813785702, 17.969222920636327, 20.157791391015053, 20.478162743151188, 19.882335528731346, 32.09076420838633, 32.24178613598147, 31.923550846676022, 16.806009598076344, 16.73985492438078, 17.02698021195829, 25.515621153637767, 25.513719560578465, 25.276470117270947, 21.86678000291188, 22.285719481607273, 22.084532683094338, 31.53029420475164, 32.085564193005354, 30.965741882721574, 16.293446260193974, 16.34579139451185, 16.54873098867634, 24.522094969948128, 24.679747634877756, 24.17006882031758, 17.614682783683136, 17.28898937006791, 17.553905082245663, 28.73218543144563, 28.451827245453984, 28.494891154269368, 29.243766983350113, 29.3635461119314, 29.294772279759243, 22.926852121949196, 23.170795727986842, 22.40235136449337, 13.73416830599308, 14.722089439630508, 14.350915372371674, 23.51541576689729, 23.197122330466897, 23.372718582550675, 21.754542315999657, 22.007926205794007, 22.22794872398177, 20.4759460662802, 20.167299655576542, 19.923085158069924, 19.50014210057755, 19.464608819534376, 19.226178896923855, 18.39856297771135, 18.640290434161813, 19.085724922517926, 11.364670418202877, 11.047735832631588, 11.090209245681763, 23.81494020919004, 24.09685933838287, 24.268434325853974, 18.57174366464217, 18.69338659321268, 17.66662176450093, 25.963601806511477, 26.09237278470148, 26.043249761064843, 24.39391467596093, 24.220129604140908, 23.352898488442094, 23.076519576211766, 23.29322362442811, 23.276857679088906, 29.176248433689267, 29.71054044032158, 29.677982889736683, 23.330904891093567, 23.868058205892638, 23.613498670359448, 30.16974564393361, 30.806318556269005, 30.419214253624276, 33.788629362980515, 34.21547774473825, 34.198849129180104, 26.02784338966012, 26.270840164273977, 25.75279714167118, 30.521913866202027, 31.130231625090033, 31.019613451013953, 22.82986094926794, 23.027924697225288, 21.965787818034485, 30.100321809450776, 29.135901818672806, 29.948809354255587, 30.838686175644398, 30.6724296733737, 30.88877221941948, 16.60341148264706, 16.542846392840147, 16.312142200767994, 27.224757147952914, 27.193087002262473, 26.808546528220177, 18.653519339859486, 18.67862608283758, 18.89802049845457, 24.55082406227787, 24.369103749593094, 24.329947148760155, 35.31895387390007, 35.24950155926247, 35.34039962509026, 24.424574779967458, 24.842470585989446, 24.675240046034247, 22.213663827627897, 21.83638559281826, 21.20785990357399, 28.37379638105631, 28.53924371302128, 28.25021255761385, 26.185850167647004, 25.75867711752653, 26.288119910284877, 26.639926523280636, 26.524226666738585, 26.052398701508835, -85.51686223844688, -96.32001552979152, -84.59543179037671, 28.46796353161335, 28.93264275789261, 28.903440058231354, 31.761042459363424, 31.41662663718064, 30.974884321292237, 27.313250333070755, 28.110826212912798, 27.958557561039925, 30.778010586897523, 30.76445850233236, 31.18089799458781, 26.420979672499612, 26.283769678945333, 26.09642135600248, 20.92772191266218, 21.027693318823964, 21.575736571025715, 31.14387711634238, 31.481148355019585, 30.01618282993634, 23.015776741007954, 22.399629334608704, 23.415731949421257, -82.58397355303168, -83.73302364349365, -93.03076350688934, 28.613995383183152, 28.890070574978978, 28.984134453038365, 29.36260215689738, 29.565194023152188, 29.58111636092265, 27.536393488446862, 28.135798564801604, 28.379436084690184, 27.926660783588886, 27.829360485076904, 27.96863493323326, 30.584814790015415, 30.549115789433316, 30.304829468329743, 34.14585392922163, 33.14273543655872, 34.07751368358731, 18.739550687372684, 18.403775744140148, 17.9654391258955, 23.94541595876217, 24.04659165814519, 24.3180930968374, 24.46538971861203, 24.674625379343823, 24.599424955745533, 23.13741284608841, 22.862993583083153, 23.396273666992784, -102.59821135550737, -102.16384043684229, -117.75032639503479, 18.647746667265892, 18.689558650366962, 18.739001119247405, 20.561105042075113, 20.498051234831408, 20.095201825102166, 24.52725079158941, 25.221651087204606, 25.30954619186619, 20.879202246665955, 21.25774098932743, 21.73337532579899, 30.85872159153223, 30.505503423511982, 30.733375445008278, 26.964610601464898, 26.511833826700837, 27.059063921372086, 20.78283744057019, 21.150947661449507, 20.84781115998824, 25.527896150946617, 24.785875841975212, 25.247317269444466, 20.858112557480723, 20.498246925572545, 20.406376312176377, 29.351385732491806, 29.22987466057141, 29.565528168653444, 22.9235747968778, 22.16183438897133, 22.629897389560938, 32.63390411436558, 31.881898909807205, 32.92026058584452, -83.46847490469615, -93.67980846265952, -83.05341784904401, 40.845055145521954, 40.06731395920117, 40.53909031053384, 35.98465636372566, 36.52154879644513, 36.073302775621414, 23.352095291018486, 23.745201888494194, 23.459725633263588, 31.846617604295403, 30.746793816486985, 31.847659456233174, 37.878741316497326, 38.0419725140091, 37.87892121076584, 26.96505461136499, 27.10671588095525, 26.56722169617811, 24.323193753759057, 23.283011118570954, 24.46052602181831, 34.76035470391312, 34.52827606598535, 33.815041969219834, 31.425327118486166, 31.474420526064932, 30.23854374885559, 19.353570769230515, 19.758301059405, 19.786842631796986, 33.90765615490575, 33.96228512500723, 33.59365004797776, 27.93301771581173, 28.863387254066765, 28.32971952110529, 25.930723786354065, 26.35638454556465, 27.20671746507287, 32.8193999491632, 32.15674637258053, 32.588489562273026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14493335743784067, "mean_inference_ms": 0.6897567569219524, "mean_action_processing_ms": 0.10033496637072195, "mean_env_wait_ms": 0.8475467804488287, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 460000, "timesteps_this_iter": 0, "agent_timesteps_total": 1380000, "timers": {"sample_time_ms": 10574.254, "sample_throughput": 472.847, "load_time_ms": 0.213, "load_throughput": 23431865.922, "learn_time_ms": 1566.743, "learn_throughput": 3191.334, "update_time_ms": 7.774}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.336808689942018e-20, "cur_lr": 0.0005000000000000001, "total_loss": 7.525752019882202, "policy_loss": -0.0026942688201616605, "vf_loss": 7.61638069152832, "vf_explained_var": -0.05464305877685547, "kl": 0.003360080416336091, "entropy": 8.793424320220947, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 460000, "num_agent_steps_sampled": 1380000, "num_steps_trained": 460000, "num_agent_steps_trained": 1380000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1772, "training_iteration": 92, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-25-35", "timestamp": 1706228735, "time_this_iter_s": 10.488646268844604, "time_total_s": 977.2735421657562, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028458A160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 977.2735421657562, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 7.866666666666668, "ram_util_percent": 53.92666666666666}}
{"episode_reward_max": 121.45145941525696, "episode_reward_min": -322.51237818738446, "episode_reward_mean": 62.93118447135056, "episode_len_mean": 486.76, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -117.75032639503479}, "policy_reward_max": {"shared_policy": 40.845055145521954}, "policy_reward_mean": {"shared_policy": 20.977061490450186}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.25610119104383, 50.57284473441541, 76.30581083148718, 66.23703216761349, 94.58160028047857, 49.18796864338216, 73.37191142514347, 52.45757723599671, 85.67890383116898, 87.90208537504076, 68.49999921442941, 42.80717311799526, 70.08525667991486, 65.99041724577543, 60.56633087992667, 58.19092981703578, 56.12457833439109, 33.50261549651623, 72.18023387342689, 54.93175202235578, 78.0992243522778, 71.96694276854393, 69.64660087972878, 88.56477176374753, 70.81246176734565, 91.39527845382689, 102.20295623689887, 78.05148069560528, 92.67175894230601, 67.82357346452771, 89.18503298237917, 92.39988806843758, 49.4584000762552, 81.22639067843556, 56.23016592115164, 73.24987496063112, 105.9088550582528, 73.94228541199115, 65.25790932402015, 85.16325265169144, 78.23264719545841, 79.21655189152806, -266.4323095586151, 86.30404634773731, 94.1525534178363, 83.38263410702348, 92.72336708381769, 78.80117070744743, 63.53115180251186, 92.6412083012983, 68.83113802503792, -259.3477607034147, 86.4882004112005, 88.50891254097222, 84.05162813793865, 83.72465620189905, 91.43876004777847, 101.36610304936767, 55.10876555740833, 72.31010071374476, 73.73944005370139, 69.39668009616435, -322.51237818738446, 56.07630643688026, 61.154358102008686, 75.0584480706602, 63.870318561792374, 92.09760046005249, 80.53550834953782, 62.78159626200794, 75.5610892623663, 61.762735795229645, 88.14678856171666, 67.71530657541007, 97.4360636100173, -260.20170121639967, 121.45145941525696, 108.57950793579221, 70.55702281277627, 94.44107087701556, 113.79963504127227, 80.63899218849835, 72.06673089414832, 103.10367273911831, 93.13829139340669, 58.8987144604325, 101.46359132789074, 85.12612449098378, 79.49382579699159, 97.56463588401675, 107.34396805427969, 42.256382368505, 72.8408549763262, 74.02078756317495, 60.85852190479635, 59.0201183706522, 73.87905141711232, 65.9622735492885, 80.17848180280997, 80.09481894318012], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 231, 500, 500, 500, 500, 500, 500, 500, 500, 208, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 155, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [32.09076420838633, 32.24178613598147, 31.923550846676022, 16.806009598076344, 16.73985492438078, 17.02698021195829, 25.515621153637767, 25.513719560578465, 25.276470117270947, 21.86678000291188, 22.285719481607273, 22.084532683094338, 31.53029420475164, 32.085564193005354, 30.965741882721574, 16.293446260193974, 16.34579139451185, 16.54873098867634, 24.522094969948128, 24.679747634877756, 24.17006882031758, 17.614682783683136, 17.28898937006791, 17.553905082245663, 28.73218543144563, 28.451827245453984, 28.494891154269368, 29.243766983350113, 29.3635461119314, 29.294772279759243, 22.926852121949196, 23.170795727986842, 22.40235136449337, 13.73416830599308, 14.722089439630508, 14.350915372371674, 23.51541576689729, 23.197122330466897, 23.372718582550675, 21.754542315999657, 22.007926205794007, 22.22794872398177, 20.4759460662802, 20.167299655576542, 19.923085158069924, 19.50014210057755, 19.464608819534376, 19.226178896923855, 18.39856297771135, 18.640290434161813, 19.085724922517926, 11.364670418202877, 11.047735832631588, 11.090209245681763, 23.81494020919004, 24.09685933838287, 24.268434325853974, 18.57174366464217, 18.69338659321268, 17.66662176450093, 25.963601806511477, 26.09237278470148, 26.043249761064843, 24.39391467596093, 24.220129604140908, 23.352898488442094, 23.076519576211766, 23.29322362442811, 23.276857679088906, 29.176248433689267, 29.71054044032158, 29.677982889736683, 23.330904891093567, 23.868058205892638, 23.613498670359448, 30.16974564393361, 30.806318556269005, 30.419214253624276, 33.788629362980515, 34.21547774473825, 34.198849129180104, 26.02784338966012, 26.270840164273977, 25.75279714167118, 30.521913866202027, 31.130231625090033, 31.019613451013953, 22.82986094926794, 23.027924697225288, 21.965787818034485, 30.100321809450776, 29.135901818672806, 29.948809354255587, 30.838686175644398, 30.6724296733737, 30.88877221941948, 16.60341148264706, 16.542846392840147, 16.312142200767994, 27.224757147952914, 27.193087002262473, 26.808546528220177, 18.653519339859486, 18.67862608283758, 18.89802049845457, 24.55082406227787, 24.369103749593094, 24.329947148760155, 35.31895387390007, 35.24950155926247, 35.34039962509026, 24.424574779967458, 24.842470585989446, 24.675240046034247, 22.213663827627897, 21.83638559281826, 21.20785990357399, 28.37379638105631, 28.53924371302128, 28.25021255761385, 26.185850167647004, 25.75867711752653, 26.288119910284877, 26.639926523280636, 26.524226666738585, 26.052398701508835, -85.51686223844688, -96.32001552979152, -84.59543179037671, 28.46796353161335, 28.93264275789261, 28.903440058231354, 31.761042459363424, 31.41662663718064, 30.974884321292237, 27.313250333070755, 28.110826212912798, 27.958557561039925, 30.778010586897523, 30.76445850233236, 31.18089799458781, 26.420979672499612, 26.283769678945333, 26.09642135600248, 20.92772191266218, 21.027693318823964, 21.575736571025715, 31.14387711634238, 31.481148355019585, 30.01618282993634, 23.015776741007954, 22.399629334608704, 23.415731949421257, -82.58397355303168, -83.73302364349365, -93.03076350688934, 28.613995383183152, 28.890070574978978, 28.984134453038365, 29.36260215689738, 29.565194023152188, 29.58111636092265, 27.536393488446862, 28.135798564801604, 28.379436084690184, 27.926660783588886, 27.829360485076904, 27.96863493323326, 30.584814790015415, 30.549115789433316, 30.304829468329743, 34.14585392922163, 33.14273543655872, 34.07751368358731, 18.739550687372684, 18.403775744140148, 17.9654391258955, 23.94541595876217, 24.04659165814519, 24.3180930968374, 24.46538971861203, 24.674625379343823, 24.599424955745533, 23.13741284608841, 22.862993583083153, 23.396273666992784, -102.59821135550737, -102.16384043684229, -117.75032639503479, 18.647746667265892, 18.689558650366962, 18.739001119247405, 20.561105042075113, 20.498051234831408, 20.095201825102166, 24.52725079158941, 25.221651087204606, 25.30954619186619, 20.879202246665955, 21.25774098932743, 21.73337532579899, 30.85872159153223, 30.505503423511982, 30.733375445008278, 26.964610601464898, 26.511833826700837, 27.059063921372086, 20.78283744057019, 21.150947661449507, 20.84781115998824, 25.527896150946617, 24.785875841975212, 25.247317269444466, 20.858112557480723, 20.498246925572545, 20.406376312176377, 29.351385732491806, 29.22987466057141, 29.565528168653444, 22.9235747968778, 22.16183438897133, 22.629897389560938, 32.63390411436558, 31.881898909807205, 32.92026058584452, -83.46847490469615, -93.67980846265952, -83.05341784904401, 40.845055145521954, 40.06731395920117, 40.53909031053384, 35.98465636372566, 36.52154879644513, 36.073302775621414, 23.352095291018486, 23.745201888494194, 23.459725633263588, 31.846617604295403, 30.746793816486985, 31.847659456233174, 37.878741316497326, 38.0419725140091, 37.87892121076584, 26.96505461136499, 27.10671588095525, 26.56722169617811, 24.323193753759057, 23.283011118570954, 24.46052602181831, 34.76035470391312, 34.52827606598535, 33.815041969219834, 31.425327118486166, 31.474420526064932, 30.23854374885559, 19.353570769230515, 19.758301059405, 19.786842631796986, 33.90765615490575, 33.96228512500723, 33.59365004797776, 27.93301771581173, 28.863387254066765, 28.32971952110529, 25.930723786354065, 26.35638454556465, 27.20671746507287, 32.8193999491632, 32.15674637258053, 32.588489562273026, 35.736178409308195, 35.880398692563176, 35.727390952408314, 14.115296080708504, 14.187355153262615, 13.953731134533882, 24.365808604905993, 24.12834785381952, 24.346698517600686, 23.885942508776978, 25.257769913723067, 24.877075140674904, 20.525212944795683, 19.98385653396447, 20.349452426036194, 19.94762370735407, 19.49931187927723, 19.5731827840209, 23.950872565309197, 24.96458720850447, 24.963591643298656, 22.317547188450888, 21.83171347280343, 21.81301288803418, 26.332385969658688, 26.914918212064848, 26.931177621086434, 26.596179517606885, 27.078068043726176, 26.420571381847054]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14488813703989478, "mean_inference_ms": 0.6898409414874124, "mean_action_processing_ms": 0.10034977832196758, "mean_env_wait_ms": 0.8476492917272964, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 465000, "timesteps_this_iter": 0, "agent_timesteps_total": 1395000, "timers": {"sample_time_ms": 10616.211, "sample_throughput": 470.978, "load_time_ms": 0.213, "load_throughput": 23431865.922, "learn_time_ms": 1575.147, "learn_throughput": 3174.308, "update_time_ms": 7.674}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.168404344971009e-20, "cur_lr": 0.0005000000000000001, "total_loss": 5.680389833450318, "policy_loss": -0.002105212402769041, "vf_loss": 5.769596910476684, "vf_explained_var": -0.0795973539352417, "kl": 0.0034214494197147343, "entropy": 8.710165977478027, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 465000, "num_agent_steps_sampled": 1395000, "num_steps_trained": 465000, "num_agent_steps_trained": 1395000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1782, "training_iteration": 93, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-25-45", "timestamp": 1706228745, "time_this_iter_s": 10.761029243469238, "time_total_s": 988.0345714092255, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202CC9A9550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 988.0345714092255, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 9.08, "ram_util_percent": 54.073333333333345}}
{"episode_reward_max": 121.45145941525696, "episode_reward_min": -322.51237818738446, "episode_reward_mean": 64.75384517174767, "episode_len_mean": 486.76, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -117.75032639503479}, "policy_reward_max": {"shared_policy": 40.845055145521954}, "policy_reward_mean": {"shared_policy": 21.584615057249216}, "custom_metrics": {}, "hist_stats": {"episode_reward": [68.49999921442941, 42.80717311799526, 70.08525667991486, 65.99041724577543, 60.56633087992667, 58.19092981703578, 56.12457833439109, 33.50261549651623, 72.18023387342689, 54.93175202235578, 78.0992243522778, 71.96694276854393, 69.64660087972878, 88.56477176374753, 70.81246176734565, 91.39527845382689, 102.20295623689887, 78.05148069560528, 92.67175894230601, 67.82357346452771, 89.18503298237917, 92.39988806843758, 49.4584000762552, 81.22639067843556, 56.23016592115164, 73.24987496063112, 105.9088550582528, 73.94228541199115, 65.25790932402015, 85.16325265169144, 78.23264719545841, 79.21655189152806, -266.4323095586151, 86.30404634773731, 94.1525534178363, 83.38263410702348, 92.72336708381769, 78.80117070744743, 63.53115180251186, 92.6412083012983, 68.83113802503792, -259.3477607034147, 86.4882004112005, 88.50891254097222, 84.05162813793865, 83.72465620189905, 91.43876004777847, 101.36610304936767, 55.10876555740833, 72.31010071374476, 73.73944005370139, 69.39668009616435, -322.51237818738446, 56.07630643688026, 61.154358102008686, 75.0584480706602, 63.870318561792374, 92.09760046005249, 80.53550834953782, 62.78159626200794, 75.5610892623663, 61.762735795229645, 88.14678856171666, 67.71530657541007, 97.4360636100173, -260.20170121639967, 121.45145941525696, 108.57950793579221, 70.55702281277627, 94.44107087701556, 113.79963504127227, 80.63899218849835, 72.06673089414832, 103.10367273911831, 93.13829139340669, 58.8987144604325, 101.46359132789074, 85.12612449098378, 79.49382579699159, 97.56463588401675, 107.34396805427969, 42.256382368505, 72.8408549763262, 74.02078756317495, 60.85852190479635, 59.0201183706522, 73.87905141711232, 65.9622735492885, 80.17848180280997, 80.09481894318012, 89.99101036041975, 117.98146678949703, 68.39381438493727, 105.71047719568011, 77.32862380519506, 106.60209530964491, 92.41039320640263, 85.45103722531347, 88.24105220101774, 82.70793527737257], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 231, 500, 500, 500, 500, 500, 500, 500, 500, 208, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 155, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [22.926852121949196, 23.170795727986842, 22.40235136449337, 13.73416830599308, 14.722089439630508, 14.350915372371674, 23.51541576689729, 23.197122330466897, 23.372718582550675, 21.754542315999657, 22.007926205794007, 22.22794872398177, 20.4759460662802, 20.167299655576542, 19.923085158069924, 19.50014210057755, 19.464608819534376, 19.226178896923855, 18.39856297771135, 18.640290434161813, 19.085724922517926, 11.364670418202877, 11.047735832631588, 11.090209245681763, 23.81494020919004, 24.09685933838287, 24.268434325853974, 18.57174366464217, 18.69338659321268, 17.66662176450093, 25.963601806511477, 26.09237278470148, 26.043249761064843, 24.39391467596093, 24.220129604140908, 23.352898488442094, 23.076519576211766, 23.29322362442811, 23.276857679088906, 29.176248433689267, 29.71054044032158, 29.677982889736683, 23.330904891093567, 23.868058205892638, 23.613498670359448, 30.16974564393361, 30.806318556269005, 30.419214253624276, 33.788629362980515, 34.21547774473825, 34.198849129180104, 26.02784338966012, 26.270840164273977, 25.75279714167118, 30.521913866202027, 31.130231625090033, 31.019613451013953, 22.82986094926794, 23.027924697225288, 21.965787818034485, 30.100321809450776, 29.135901818672806, 29.948809354255587, 30.838686175644398, 30.6724296733737, 30.88877221941948, 16.60341148264706, 16.542846392840147, 16.312142200767994, 27.224757147952914, 27.193087002262473, 26.808546528220177, 18.653519339859486, 18.67862608283758, 18.89802049845457, 24.55082406227787, 24.369103749593094, 24.329947148760155, 35.31895387390007, 35.24950155926247, 35.34039962509026, 24.424574779967458, 24.842470585989446, 24.675240046034247, 22.213663827627897, 21.83638559281826, 21.20785990357399, 28.37379638105631, 28.53924371302128, 28.25021255761385, 26.185850167647004, 25.75867711752653, 26.288119910284877, 26.639926523280636, 26.524226666738585, 26.052398701508835, -85.51686223844688, -96.32001552979152, -84.59543179037671, 28.46796353161335, 28.93264275789261, 28.903440058231354, 31.761042459363424, 31.41662663718064, 30.974884321292237, 27.313250333070755, 28.110826212912798, 27.958557561039925, 30.778010586897523, 30.76445850233236, 31.18089799458781, 26.420979672499612, 26.283769678945333, 26.09642135600248, 20.92772191266218, 21.027693318823964, 21.575736571025715, 31.14387711634238, 31.481148355019585, 30.01618282993634, 23.015776741007954, 22.399629334608704, 23.415731949421257, -82.58397355303168, -83.73302364349365, -93.03076350688934, 28.613995383183152, 28.890070574978978, 28.984134453038365, 29.36260215689738, 29.565194023152188, 29.58111636092265, 27.536393488446862, 28.135798564801604, 28.379436084690184, 27.926660783588886, 27.829360485076904, 27.96863493323326, 30.584814790015415, 30.549115789433316, 30.304829468329743, 34.14585392922163, 33.14273543655872, 34.07751368358731, 18.739550687372684, 18.403775744140148, 17.9654391258955, 23.94541595876217, 24.04659165814519, 24.3180930968374, 24.46538971861203, 24.674625379343823, 24.599424955745533, 23.13741284608841, 22.862993583083153, 23.396273666992784, -102.59821135550737, -102.16384043684229, -117.75032639503479, 18.647746667265892, 18.689558650366962, 18.739001119247405, 20.561105042075113, 20.498051234831408, 20.095201825102166, 24.52725079158941, 25.221651087204606, 25.30954619186619, 20.879202246665955, 21.25774098932743, 21.73337532579899, 30.85872159153223, 30.505503423511982, 30.733375445008278, 26.964610601464898, 26.511833826700837, 27.059063921372086, 20.78283744057019, 21.150947661449507, 20.84781115998824, 25.527896150946617, 24.785875841975212, 25.247317269444466, 20.858112557480723, 20.498246925572545, 20.406376312176377, 29.351385732491806, 29.22987466057141, 29.565528168653444, 22.9235747968778, 22.16183438897133, 22.629897389560938, 32.63390411436558, 31.881898909807205, 32.92026058584452, -83.46847490469615, -93.67980846265952, -83.05341784904401, 40.845055145521954, 40.06731395920117, 40.53909031053384, 35.98465636372566, 36.52154879644513, 36.073302775621414, 23.352095291018486, 23.745201888494194, 23.459725633263588, 31.846617604295403, 30.746793816486985, 31.847659456233174, 37.878741316497326, 38.0419725140091, 37.87892121076584, 26.96505461136499, 27.10671588095525, 26.56722169617811, 24.323193753759057, 23.283011118570954, 24.46052602181831, 34.76035470391312, 34.52827606598535, 33.815041969219834, 31.425327118486166, 31.474420526064932, 30.23854374885559, 19.353570769230515, 19.758301059405, 19.786842631796986, 33.90765615490575, 33.96228512500723, 33.59365004797776, 27.93301771581173, 28.863387254066765, 28.32971952110529, 25.930723786354065, 26.35638454556465, 27.20671746507287, 32.8193999491632, 32.15674637258053, 32.588489562273026, 35.736178409308195, 35.880398692563176, 35.727390952408314, 14.115296080708504, 14.187355153262615, 13.953731134533882, 24.365808604905993, 24.12834785381952, 24.346698517600686, 23.885942508776978, 25.257769913723067, 24.877075140674904, 20.525212944795683, 19.98385653396447, 20.349452426036194, 19.94762370735407, 19.49931187927723, 19.5731827840209, 23.950872565309197, 24.96458720850447, 24.963591643298656, 22.317547188450888, 21.83171347280343, 21.81301288803418, 26.332385969658688, 26.914918212064848, 26.931177621086434, 26.596179517606885, 27.078068043726176, 26.420571381847054, 29.78444868326187, 30.221245378255844, 29.985316298902035, 39.575270018928364, 38.995292025307805, 39.410904745260865, 23.025386733313397, 22.719879140456513, 22.648548511167363, 35.31688670317331, 35.04370393852392, 35.349886553982884, 25.775479125479848, 26.079704305777938, 25.47344037393728, 36.03354961300889, 35.717706518868596, 34.850839177767426, 30.845209288100392, 30.975526899720222, 30.589657018582017, 28.578928233434752, 28.296864209075764, 28.575244782802955, 29.44001989811659, 29.34492570720613, 29.45610659569502, 27.103527704874665, 27.76854523892203, 27.835862333575875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14484930391239295, "mean_inference_ms": 0.6899292056977577, "mean_action_processing_ms": 0.10036795190858258, "mean_env_wait_ms": 0.8477202710959578, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 470000, "timesteps_this_iter": 0, "agent_timesteps_total": 1410000, "timers": {"sample_time_ms": 10619.765, "sample_throughput": 470.82, "load_time_ms": 0.113, "load_throughput": 44178470.613, "learn_time_ms": 1577.225, "learn_throughput": 3170.126, "update_time_ms": 7.573}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0842021724855045e-20, "cur_lr": 0.0005000000000000001, "total_loss": 5.744571733474731, "policy_loss": -0.002832301228971801, "vf_loss": 5.832890748977661, "vf_explained_var": -0.044720160961151126, "kl": 0.0027809408726372784, "entropy": 8.548664855957032, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 470000, "num_agent_steps_sampled": 1410000, "num_steps_trained": 470000, "num_agent_steps_trained": 1410000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1792, "training_iteration": 94, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-25-56", "timestamp": 1706228756, "time_this_iter_s": 10.439697265625, "time_total_s": 998.4742686748505, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202821C6700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 998.4742686748505, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 8.046666666666665, "ram_util_percent": 54.06000000000001}}
{"episode_reward_max": 123.84032120462504, "episode_reward_min": -322.51237818738446, "episode_reward_mean": 67.35222023050387, "episode_len_mean": 486.76, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -117.75032639503479}, "policy_reward_max": {"shared_policy": 41.35959226793298}, "policy_reward_mean": {"shared_policy": 22.450740076834624}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.0992243522778, 71.96694276854393, 69.64660087972878, 88.56477176374753, 70.81246176734565, 91.39527845382689, 102.20295623689887, 78.05148069560528, 92.67175894230601, 67.82357346452771, 89.18503298237917, 92.39988806843758, 49.4584000762552, 81.22639067843556, 56.23016592115164, 73.24987496063112, 105.9088550582528, 73.94228541199115, 65.25790932402015, 85.16325265169144, 78.23264719545841, 79.21655189152806, -266.4323095586151, 86.30404634773731, 94.1525534178363, 83.38263410702348, 92.72336708381769, 78.80117070744743, 63.53115180251186, 92.6412083012983, 68.83113802503792, -259.3477607034147, 86.4882004112005, 88.50891254097222, 84.05162813793865, 83.72465620189905, 91.43876004777847, 101.36610304936767, 55.10876555740833, 72.31010071374476, 73.73944005370139, 69.39668009616435, -322.51237818738446, 56.07630643688026, 61.154358102008686, 75.0584480706602, 63.870318561792374, 92.09760046005249, 80.53550834953782, 62.78159626200794, 75.5610892623663, 61.762735795229645, 88.14678856171666, 67.71530657541007, 97.4360636100173, -260.20170121639967, 121.45145941525696, 108.57950793579221, 70.55702281277627, 94.44107087701556, 113.79963504127227, 80.63899218849835, 72.06673089414832, 103.10367273911831, 93.13829139340669, 58.8987144604325, 101.46359132789074, 85.12612449098378, 79.49382579699159, 97.56463588401675, 107.34396805427969, 42.256382368505, 72.8408549763262, 74.02078756317495, 60.85852190479635, 59.0201183706522, 73.87905141711232, 65.9622735492885, 80.17848180280997, 80.09481894318012, 89.99101036041975, 117.98146678949703, 68.39381438493727, 105.71047719568011, 77.32862380519506, 106.60209530964491, 92.41039320640263, 85.45103722531347, 88.24105220101774, 82.70793527737257, 67.37525464966892, 123.84032120462504, 81.6185591481626, 83.76891994476316, 65.7022986933589, 102.19965426903215, 102.69327470473944, 71.51352358609435, 76.6434833779931, 67.36150297895072], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 231, 500, 500, 500, 500, 500, 500, 500, 500, 208, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 155, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [25.963601806511477, 26.09237278470148, 26.043249761064843, 24.39391467596093, 24.220129604140908, 23.352898488442094, 23.076519576211766, 23.29322362442811, 23.276857679088906, 29.176248433689267, 29.71054044032158, 29.677982889736683, 23.330904891093567, 23.868058205892638, 23.613498670359448, 30.16974564393361, 30.806318556269005, 30.419214253624276, 33.788629362980515, 34.21547774473825, 34.198849129180104, 26.02784338966012, 26.270840164273977, 25.75279714167118, 30.521913866202027, 31.130231625090033, 31.019613451013953, 22.82986094926794, 23.027924697225288, 21.965787818034485, 30.100321809450776, 29.135901818672806, 29.948809354255587, 30.838686175644398, 30.6724296733737, 30.88877221941948, 16.60341148264706, 16.542846392840147, 16.312142200767994, 27.224757147952914, 27.193087002262473, 26.808546528220177, 18.653519339859486, 18.67862608283758, 18.89802049845457, 24.55082406227787, 24.369103749593094, 24.329947148760155, 35.31895387390007, 35.24950155926247, 35.34039962509026, 24.424574779967458, 24.842470585989446, 24.675240046034247, 22.213663827627897, 21.83638559281826, 21.20785990357399, 28.37379638105631, 28.53924371302128, 28.25021255761385, 26.185850167647004, 25.75867711752653, 26.288119910284877, 26.639926523280636, 26.524226666738585, 26.052398701508835, -85.51686223844688, -96.32001552979152, -84.59543179037671, 28.46796353161335, 28.93264275789261, 28.903440058231354, 31.761042459363424, 31.41662663718064, 30.974884321292237, 27.313250333070755, 28.110826212912798, 27.958557561039925, 30.778010586897523, 30.76445850233236, 31.18089799458781, 26.420979672499612, 26.283769678945333, 26.09642135600248, 20.92772191266218, 21.027693318823964, 21.575736571025715, 31.14387711634238, 31.481148355019585, 30.01618282993634, 23.015776741007954, 22.399629334608704, 23.415731949421257, -82.58397355303168, -83.73302364349365, -93.03076350688934, 28.613995383183152, 28.890070574978978, 28.984134453038365, 29.36260215689738, 29.565194023152188, 29.58111636092265, 27.536393488446862, 28.135798564801604, 28.379436084690184, 27.926660783588886, 27.829360485076904, 27.96863493323326, 30.584814790015415, 30.549115789433316, 30.304829468329743, 34.14585392922163, 33.14273543655872, 34.07751368358731, 18.739550687372684, 18.403775744140148, 17.9654391258955, 23.94541595876217, 24.04659165814519, 24.3180930968374, 24.46538971861203, 24.674625379343823, 24.599424955745533, 23.13741284608841, 22.862993583083153, 23.396273666992784, -102.59821135550737, -102.16384043684229, -117.75032639503479, 18.647746667265892, 18.689558650366962, 18.739001119247405, 20.561105042075113, 20.498051234831408, 20.095201825102166, 24.52725079158941, 25.221651087204606, 25.30954619186619, 20.879202246665955, 21.25774098932743, 21.73337532579899, 30.85872159153223, 30.505503423511982, 30.733375445008278, 26.964610601464898, 26.511833826700837, 27.059063921372086, 20.78283744057019, 21.150947661449507, 20.84781115998824, 25.527896150946617, 24.785875841975212, 25.247317269444466, 20.858112557480723, 20.498246925572545, 20.406376312176377, 29.351385732491806, 29.22987466057141, 29.565528168653444, 22.9235747968778, 22.16183438897133, 22.629897389560938, 32.63390411436558, 31.881898909807205, 32.92026058584452, -83.46847490469615, -93.67980846265952, -83.05341784904401, 40.845055145521954, 40.06731395920117, 40.53909031053384, 35.98465636372566, 36.52154879644513, 36.073302775621414, 23.352095291018486, 23.745201888494194, 23.459725633263588, 31.846617604295403, 30.746793816486985, 31.847659456233174, 37.878741316497326, 38.0419725140091, 37.87892121076584, 26.96505461136499, 27.10671588095525, 26.56722169617811, 24.323193753759057, 23.283011118570954, 24.46052602181831, 34.76035470391312, 34.52827606598535, 33.815041969219834, 31.425327118486166, 31.474420526064932, 30.23854374885559, 19.353570769230515, 19.758301059405, 19.786842631796986, 33.90765615490575, 33.96228512500723, 33.59365004797776, 27.93301771581173, 28.863387254066765, 28.32971952110529, 25.930723786354065, 26.35638454556465, 27.20671746507287, 32.8193999491632, 32.15674637258053, 32.588489562273026, 35.736178409308195, 35.880398692563176, 35.727390952408314, 14.115296080708504, 14.187355153262615, 13.953731134533882, 24.365808604905993, 24.12834785381952, 24.346698517600686, 23.885942508776978, 25.257769913723067, 24.877075140674904, 20.525212944795683, 19.98385653396447, 20.349452426036194, 19.94762370735407, 19.49931187927723, 19.5731827840209, 23.950872565309197, 24.96458720850447, 24.963591643298656, 22.317547188450888, 21.83171347280343, 21.81301288803418, 26.332385969658688, 26.914918212064848, 26.931177621086434, 26.596179517606885, 27.078068043726176, 26.420571381847054, 29.78444868326187, 30.221245378255844, 29.985316298902035, 39.575270018928364, 38.995292025307805, 39.410904745260865, 23.025386733313397, 22.719879140456513, 22.648548511167363, 35.31688670317331, 35.04370393852392, 35.349886553982884, 25.775479125479848, 26.079704305777938, 25.47344037393728, 36.03354961300889, 35.717706518868596, 34.850839177767426, 30.845209288100392, 30.975526899720222, 30.589657018582017, 28.578928233434752, 28.296864209075764, 28.575244782802955, 29.44001989811659, 29.34492570720613, 29.45610659569502, 27.103527704874665, 27.76854523892203, 27.835862333575875, 22.827934206773833, 22.758445156117276, 21.78887528677781, 41.35959226793298, 41.219277555743844, 41.261451380948216, 27.39252020046115, 27.0885401815176, 27.137498766183853, 28.000394533077866, 27.605938444534928, 28.16258696715036, 21.98075272142887, 22.144593112170696, 21.57695285975933, 33.75111066798368, 33.84153702358404, 34.60700657746443, 34.38001380426188, 34.35301212718089, 33.96024877329667, 23.813833797971398, 23.79236344123879, 23.90732634688416, 25.66686963662505, 25.503999795764685, 25.47261394560337, 22.515957621236637, 22.16104172666867, 22.684503631045416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14480075755334146, "mean_inference_ms": 0.6900025190520398, "mean_action_processing_ms": 0.10038395526582594, "mean_env_wait_ms": 0.8477858543279153, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 475000, "timesteps_this_iter": 0, "agent_timesteps_total": 1425000, "timers": {"sample_time_ms": 10593.881, "sample_throughput": 471.971, "load_time_ms": 0.113, "load_throughput": 44327879.941, "learn_time_ms": 1576.075, "learn_throughput": 3172.439, "update_time_ms": 7.252}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.4210108624275225e-21, "cur_lr": 0.0005000000000000001, "total_loss": 3.732374119758606, "policy_loss": -0.0024962113552416286, "vf_loss": 3.8202080011367796, "vf_explained_var": -0.11807934045791627, "kl": 0.0032359483360981855, "entropy": 8.533757591247559, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 475000, "num_agent_steps_sampled": 1425000, "num_steps_trained": 475000, "num_agent_steps_trained": 1425000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1802, "training_iteration": 95, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-26-06", "timestamp": 1706228766, "time_this_iter_s": 10.306155443191528, "time_total_s": 1008.780424118042, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824BA820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1008.780424118042, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 7.8428571428571425, "ram_util_percent": 53.77142857142858}}
{"episode_reward_max": 131.96966460347164, "episode_reward_min": -322.51237818738446, "episode_reward_mean": 63.6019453582805, "episode_len_mean": 482.27, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -117.75032639503479}, "policy_reward_max": {"shared_policy": 44.34215947488943}, "policy_reward_mean": {"shared_policy": 21.20064845276016}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.39988806843758, 49.4584000762552, 81.22639067843556, 56.23016592115164, 73.24987496063112, 105.9088550582528, 73.94228541199115, 65.25790932402015, 85.16325265169144, 78.23264719545841, 79.21655189152806, -266.4323095586151, 86.30404634773731, 94.1525534178363, 83.38263410702348, 92.72336708381769, 78.80117070744743, 63.53115180251186, 92.6412083012983, 68.83113802503792, -259.3477607034147, 86.4882004112005, 88.50891254097222, 84.05162813793865, 83.72465620189905, 91.43876004777847, 101.36610304936767, 55.10876555740833, 72.31010071374476, 73.73944005370139, 69.39668009616435, -322.51237818738446, 56.07630643688026, 61.154358102008686, 75.0584480706602, 63.870318561792374, 92.09760046005249, 80.53550834953782, 62.78159626200794, 75.5610892623663, 61.762735795229645, 88.14678856171666, 67.71530657541007, 97.4360636100173, -260.20170121639967, 121.45145941525696, 108.57950793579221, 70.55702281277627, 94.44107087701556, 113.79963504127227, 80.63899218849835, 72.06673089414832, 103.10367273911831, 93.13829139340669, 58.8987144604325, 101.46359132789074, 85.12612449098378, 79.49382579699159, 97.56463588401675, 107.34396805427969, 42.256382368505, 72.8408549763262, 74.02078756317495, 60.85852190479635, 59.0201183706522, 73.87905141711232, 65.9622735492885, 80.17848180280997, 80.09481894318012, 89.99101036041975, 117.98146678949703, 68.39381438493727, 105.71047719568011, 77.32862380519506, 106.60209530964491, 92.41039320640263, 85.45103722531347, 88.24105220101774, 82.70793527737257, 67.37525464966892, 123.84032120462504, 81.6185591481626, 83.76891994476316, 65.7022986933589, 102.19965426903215, 102.69327470473944, 71.51352358609435, 76.6434833779931, 67.36150297895072, 131.96966460347164, 60.66855124710128, 74.16248961631209, -307.21723604016006, 87.44837727583943, 85.0449875295162, 61.05107593163848, 103.56229829788207, 85.32317959517239, 66.07755293510853, 77.30165409296748], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 231, 500, 500, 500, 500, 500, 500, 500, 500, 208, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 155, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 51, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [30.838686175644398, 30.6724296733737, 30.88877221941948, 16.60341148264706, 16.542846392840147, 16.312142200767994, 27.224757147952914, 27.193087002262473, 26.808546528220177, 18.653519339859486, 18.67862608283758, 18.89802049845457, 24.55082406227787, 24.369103749593094, 24.329947148760155, 35.31895387390007, 35.24950155926247, 35.34039962509026, 24.424574779967458, 24.842470585989446, 24.675240046034247, 22.213663827627897, 21.83638559281826, 21.20785990357399, 28.37379638105631, 28.53924371302128, 28.25021255761385, 26.185850167647004, 25.75867711752653, 26.288119910284877, 26.639926523280636, 26.524226666738585, 26.052398701508835, -85.51686223844688, -96.32001552979152, -84.59543179037671, 28.46796353161335, 28.93264275789261, 28.903440058231354, 31.761042459363424, 31.41662663718064, 30.974884321292237, 27.313250333070755, 28.110826212912798, 27.958557561039925, 30.778010586897523, 30.76445850233236, 31.18089799458781, 26.420979672499612, 26.283769678945333, 26.09642135600248, 20.92772191266218, 21.027693318823964, 21.575736571025715, 31.14387711634238, 31.481148355019585, 30.01618282993634, 23.015776741007954, 22.399629334608704, 23.415731949421257, -82.58397355303168, -83.73302364349365, -93.03076350688934, 28.613995383183152, 28.890070574978978, 28.984134453038365, 29.36260215689738, 29.565194023152188, 29.58111636092265, 27.536393488446862, 28.135798564801604, 28.379436084690184, 27.926660783588886, 27.829360485076904, 27.96863493323326, 30.584814790015415, 30.549115789433316, 30.304829468329743, 34.14585392922163, 33.14273543655872, 34.07751368358731, 18.739550687372684, 18.403775744140148, 17.9654391258955, 23.94541595876217, 24.04659165814519, 24.3180930968374, 24.46538971861203, 24.674625379343823, 24.599424955745533, 23.13741284608841, 22.862993583083153, 23.396273666992784, -102.59821135550737, -102.16384043684229, -117.75032639503479, 18.647746667265892, 18.689558650366962, 18.739001119247405, 20.561105042075113, 20.498051234831408, 20.095201825102166, 24.52725079158941, 25.221651087204606, 25.30954619186619, 20.879202246665955, 21.25774098932743, 21.73337532579899, 30.85872159153223, 30.505503423511982, 30.733375445008278, 26.964610601464898, 26.511833826700837, 27.059063921372086, 20.78283744057019, 21.150947661449507, 20.84781115998824, 25.527896150946617, 24.785875841975212, 25.247317269444466, 20.858112557480723, 20.498246925572545, 20.406376312176377, 29.351385732491806, 29.22987466057141, 29.565528168653444, 22.9235747968778, 22.16183438897133, 22.629897389560938, 32.63390411436558, 31.881898909807205, 32.92026058584452, -83.46847490469615, -93.67980846265952, -83.05341784904401, 40.845055145521954, 40.06731395920117, 40.53909031053384, 35.98465636372566, 36.52154879644513, 36.073302775621414, 23.352095291018486, 23.745201888494194, 23.459725633263588, 31.846617604295403, 30.746793816486985, 31.847659456233174, 37.878741316497326, 38.0419725140091, 37.87892121076584, 26.96505461136499, 27.10671588095525, 26.56722169617811, 24.323193753759057, 23.283011118570954, 24.46052602181831, 34.76035470391312, 34.52827606598535, 33.815041969219834, 31.425327118486166, 31.474420526064932, 30.23854374885559, 19.353570769230515, 19.758301059405, 19.786842631796986, 33.90765615490575, 33.96228512500723, 33.59365004797776, 27.93301771581173, 28.863387254066765, 28.32971952110529, 25.930723786354065, 26.35638454556465, 27.20671746507287, 32.8193999491632, 32.15674637258053, 32.588489562273026, 35.736178409308195, 35.880398692563176, 35.727390952408314, 14.115296080708504, 14.187355153262615, 13.953731134533882, 24.365808604905993, 24.12834785381952, 24.346698517600686, 23.885942508776978, 25.257769913723067, 24.877075140674904, 20.525212944795683, 19.98385653396447, 20.349452426036194, 19.94762370735407, 19.49931187927723, 19.5731827840209, 23.950872565309197, 24.96458720850447, 24.963591643298656, 22.317547188450888, 21.83171347280343, 21.81301288803418, 26.332385969658688, 26.914918212064848, 26.931177621086434, 26.596179517606885, 27.078068043726176, 26.420571381847054, 29.78444868326187, 30.221245378255844, 29.985316298902035, 39.575270018928364, 38.995292025307805, 39.410904745260865, 23.025386733313397, 22.719879140456513, 22.648548511167363, 35.31688670317331, 35.04370393852392, 35.349886553982884, 25.775479125479848, 26.079704305777938, 25.47344037393728, 36.03354961300889, 35.717706518868596, 34.850839177767426, 30.845209288100392, 30.975526899720222, 30.589657018582017, 28.578928233434752, 28.296864209075764, 28.575244782802955, 29.44001989811659, 29.34492570720613, 29.45610659569502, 27.103527704874665, 27.76854523892203, 27.835862333575875, 22.827934206773833, 22.758445156117276, 21.78887528677781, 41.35959226793298, 41.219277555743844, 41.261451380948216, 27.39252020046115, 27.0885401815176, 27.137498766183853, 28.000394533077866, 27.605938444534928, 28.16258696715036, 21.98075272142887, 22.144593112170696, 21.57695285975933, 33.75111066798368, 33.84153702358404, 34.60700657746443, 34.38001380426188, 34.35301212718089, 33.96024877329667, 23.813833797971398, 23.79236344123879, 23.90732634688416, 25.66686963662505, 25.503999795764685, 25.47261394560337, 22.515957621236637, 22.16104172666867, 22.684503631045416, 43.884994755188615, 43.742510373393685, 44.34215947488943, 20.15264382213354, 20.54824401019141, 19.967663414776325, 24.789096332155168, 24.71172076277435, 24.66167252138257, -97.65315329966447, -97.71453908955058, -111.84954365094504, 28.832868372400597, 29.196417366464928, 29.41909153697391, 28.27710576107104, 28.130078946550682, 28.637802821894482, 20.34608317166567, 20.21148068457842, 20.493512075394392, 34.34956919153531, 34.59268696357806, 34.620042142768696, 28.78147742648919, 27.96304992338021, 28.57865224530299, 22.02882360791166, 21.929310039927557, 22.11941928726931, 25.992770003775746, 25.89718564848104, 25.411698440710694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1447623391839402, "mean_inference_ms": 0.6901378292125102, "mean_action_processing_ms": 0.10039769839925858, "mean_env_wait_ms": 0.8478985890904075, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 480000, "timesteps_this_iter": 0, "agent_timesteps_total": 1440000, "timers": {"sample_time_ms": 10511.348, "sample_throughput": 475.676, "load_time_ms": 0.2, "load_throughput": 25025680.191, "learn_time_ms": 1570.336, "learn_throughput": 3184.032, "update_time_ms": 7.245}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7105054312137612e-21, "cur_lr": 0.0005000000000000001, "total_loss": 76.22941131591797, "policy_loss": -0.0034877584102358306, "vf_loss": 76.31739807128906, "vf_explained_var": 0.0427893877029419, "kl": 0.006288214982506889, "entropy": 8.449740791320801, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 480000, "num_agent_steps_sampled": 1440000, "num_steps_trained": 480000, "num_agent_steps_trained": 1440000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1813, "training_iteration": 96, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-26-17", "timestamp": 1706228777, "time_this_iter_s": 10.393301248550415, "time_total_s": 1019.1737253665924, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020280834A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1019.1737253665924, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 8.086666666666666, "ram_util_percent": 53.64666666666667}}
{"episode_reward_max": 131.96966460347164, "episode_reward_min": -322.51237818738446, "episode_reward_mean": 65.46067376613472, "episode_len_mean": 482.27, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -117.75032639503479}, "policy_reward_max": {"shared_policy": 44.34215947488943}, "policy_reward_mean": {"shared_policy": 21.820224588711564}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.21655189152806, -266.4323095586151, 86.30404634773731, 94.1525534178363, 83.38263410702348, 92.72336708381769, 78.80117070744743, 63.53115180251186, 92.6412083012983, 68.83113802503792, -259.3477607034147, 86.4882004112005, 88.50891254097222, 84.05162813793865, 83.72465620189905, 91.43876004777847, 101.36610304936767, 55.10876555740833, 72.31010071374476, 73.73944005370139, 69.39668009616435, -322.51237818738446, 56.07630643688026, 61.154358102008686, 75.0584480706602, 63.870318561792374, 92.09760046005249, 80.53550834953782, 62.78159626200794, 75.5610892623663, 61.762735795229645, 88.14678856171666, 67.71530657541007, 97.4360636100173, -260.20170121639967, 121.45145941525696, 108.57950793579221, 70.55702281277627, 94.44107087701556, 113.79963504127227, 80.63899218849835, 72.06673089414832, 103.10367273911831, 93.13829139340669, 58.8987144604325, 101.46359132789074, 85.12612449098378, 79.49382579699159, 97.56463588401675, 107.34396805427969, 42.256382368505, 72.8408549763262, 74.02078756317495, 60.85852190479635, 59.0201183706522, 73.87905141711232, 65.9622735492885, 80.17848180280997, 80.09481894318012, 89.99101036041975, 117.98146678949703, 68.39381438493727, 105.71047719568011, 77.32862380519506, 106.60209530964491, 92.41039320640263, 85.45103722531347, 88.24105220101774, 82.70793527737257, 67.37525464966892, 123.84032120462504, 81.6185591481626, 83.76891994476316, 65.7022986933589, 102.19965426903215, 102.69327470473944, 71.51352358609435, 76.6434833779931, 67.36150297895072, 131.96966460347164, 60.66855124710128, 74.16248961631209, -307.21723604016006, 87.44837727583943, 85.0449875295162, 61.05107593163848, 103.56229829788207, 85.32317959517239, 66.07755293510853, 77.30165409296748, 76.68184901587664, 115.7752716965042, 99.35384424775836, 88.03473993390797, 82.16126871760933, 117.71249925345182, 119.98186823725699, 76.09138670563696, 87.81574205448851, 83.33404026925564], "episode_lengths": [500, 231, 500, 500, 500, 500, 500, 500, 500, 500, 208, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 155, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 51, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [26.639926523280636, 26.524226666738585, 26.052398701508835, -85.51686223844688, -96.32001552979152, -84.59543179037671, 28.46796353161335, 28.93264275789261, 28.903440058231354, 31.761042459363424, 31.41662663718064, 30.974884321292237, 27.313250333070755, 28.110826212912798, 27.958557561039925, 30.778010586897523, 30.76445850233236, 31.18089799458781, 26.420979672499612, 26.283769678945333, 26.09642135600248, 20.92772191266218, 21.027693318823964, 21.575736571025715, 31.14387711634238, 31.481148355019585, 30.01618282993634, 23.015776741007954, 22.399629334608704, 23.415731949421257, -82.58397355303168, -83.73302364349365, -93.03076350688934, 28.613995383183152, 28.890070574978978, 28.984134453038365, 29.36260215689738, 29.565194023152188, 29.58111636092265, 27.536393488446862, 28.135798564801604, 28.379436084690184, 27.926660783588886, 27.829360485076904, 27.96863493323326, 30.584814790015415, 30.549115789433316, 30.304829468329743, 34.14585392922163, 33.14273543655872, 34.07751368358731, 18.739550687372684, 18.403775744140148, 17.9654391258955, 23.94541595876217, 24.04659165814519, 24.3180930968374, 24.46538971861203, 24.674625379343823, 24.599424955745533, 23.13741284608841, 22.862993583083153, 23.396273666992784, -102.59821135550737, -102.16384043684229, -117.75032639503479, 18.647746667265892, 18.689558650366962, 18.739001119247405, 20.561105042075113, 20.498051234831408, 20.095201825102166, 24.52725079158941, 25.221651087204606, 25.30954619186619, 20.879202246665955, 21.25774098932743, 21.73337532579899, 30.85872159153223, 30.505503423511982, 30.733375445008278, 26.964610601464898, 26.511833826700837, 27.059063921372086, 20.78283744057019, 21.150947661449507, 20.84781115998824, 25.527896150946617, 24.785875841975212, 25.247317269444466, 20.858112557480723, 20.498246925572545, 20.406376312176377, 29.351385732491806, 29.22987466057141, 29.565528168653444, 22.9235747968778, 22.16183438897133, 22.629897389560938, 32.63390411436558, 31.881898909807205, 32.92026058584452, -83.46847490469615, -93.67980846265952, -83.05341784904401, 40.845055145521954, 40.06731395920117, 40.53909031053384, 35.98465636372566, 36.52154879644513, 36.073302775621414, 23.352095291018486, 23.745201888494194, 23.459725633263588, 31.846617604295403, 30.746793816486985, 31.847659456233174, 37.878741316497326, 38.0419725140091, 37.87892121076584, 26.96505461136499, 27.10671588095525, 26.56722169617811, 24.323193753759057, 23.283011118570954, 24.46052602181831, 34.76035470391312, 34.52827606598535, 33.815041969219834, 31.425327118486166, 31.474420526064932, 30.23854374885559, 19.353570769230515, 19.758301059405, 19.786842631796986, 33.90765615490575, 33.96228512500723, 33.59365004797776, 27.93301771581173, 28.863387254066765, 28.32971952110529, 25.930723786354065, 26.35638454556465, 27.20671746507287, 32.8193999491632, 32.15674637258053, 32.588489562273026, 35.736178409308195, 35.880398692563176, 35.727390952408314, 14.115296080708504, 14.187355153262615, 13.953731134533882, 24.365808604905993, 24.12834785381952, 24.346698517600686, 23.885942508776978, 25.257769913723067, 24.877075140674904, 20.525212944795683, 19.98385653396447, 20.349452426036194, 19.94762370735407, 19.49931187927723, 19.5731827840209, 23.950872565309197, 24.96458720850447, 24.963591643298656, 22.317547188450888, 21.83171347280343, 21.81301288803418, 26.332385969658688, 26.914918212064848, 26.931177621086434, 26.596179517606885, 27.078068043726176, 26.420571381847054, 29.78444868326187, 30.221245378255844, 29.985316298902035, 39.575270018928364, 38.995292025307805, 39.410904745260865, 23.025386733313397, 22.719879140456513, 22.648548511167363, 35.31688670317331, 35.04370393852392, 35.349886553982884, 25.775479125479848, 26.079704305777938, 25.47344037393728, 36.03354961300889, 35.717706518868596, 34.850839177767426, 30.845209288100392, 30.975526899720222, 30.589657018582017, 28.578928233434752, 28.296864209075764, 28.575244782802955, 29.44001989811659, 29.34492570720613, 29.45610659569502, 27.103527704874665, 27.76854523892203, 27.835862333575875, 22.827934206773833, 22.758445156117276, 21.78887528677781, 41.35959226793298, 41.219277555743844, 41.261451380948216, 27.39252020046115, 27.0885401815176, 27.137498766183853, 28.000394533077866, 27.605938444534928, 28.16258696715036, 21.98075272142887, 22.144593112170696, 21.57695285975933, 33.75111066798368, 33.84153702358404, 34.60700657746443, 34.38001380426188, 34.35301212718089, 33.96024877329667, 23.813833797971398, 23.79236344123879, 23.90732634688416, 25.66686963662505, 25.503999795764685, 25.47261394560337, 22.515957621236637, 22.16104172666867, 22.684503631045416, 43.884994755188615, 43.742510373393685, 44.34215947488943, 20.15264382213354, 20.54824401019141, 19.967663414776325, 24.789096332155168, 24.71172076277435, 24.66167252138257, -97.65315329966447, -97.71453908955058, -111.84954365094504, 28.832868372400597, 29.196417366464928, 29.41909153697391, 28.27710576107104, 28.130078946550682, 28.637802821894482, 20.34608317166567, 20.21148068457842, 20.493512075394392, 34.34956919153531, 34.59268696357806, 34.620042142768696, 28.78147742648919, 27.96304992338021, 28.57865224530299, 22.02882360791166, 21.929310039927557, 22.11941928726931, 25.992770003775746, 25.89718564848104, 25.411698440710694, 25.057916690905884, 25.60632636149724, 26.017605963473514, 38.24771375954151, 38.7460942575708, 38.78146367939189, 33.161407694841415, 33.00507403413454, 33.18736251878241, 29.462599230309323, 29.270314161976174, 29.301826541622475, 27.398460557063416, 26.746274580558136, 28.01653357998778, 38.84642939269543, 39.5815944224596, 39.284475438296795, 40.134184313317135, 39.990107220908, 39.85757670303185, 25.358591598769024, 25.51947809507449, 25.21331701179345, 29.165326602756977, 29.614792430307716, 29.035623021423817, 27.6537711545825, 27.911821380257607, 27.76844773441553]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14469191800352926, "mean_inference_ms": 0.6900544595916491, "mean_action_processing_ms": 0.10039658914258753, "mean_env_wait_ms": 0.8478337578436842, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 485000, "timesteps_this_iter": 0, "agent_timesteps_total": 1455000, "timers": {"sample_time_ms": 10450.675, "sample_throughput": 478.438, "load_time_ms": 0.2, "load_throughput": 25025680.191, "learn_time_ms": 1569.406, "learn_throughput": 3185.918, "update_time_ms": 7.245}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7105054312137612e-21, "cur_lr": 0.0005000000000000001, "total_loss": 5.403835439682007, "policy_loss": -0.0023808927388659917, "vf_loss": 5.492341613769531, "vf_explained_var": -0.05971423387527466, "kl": 0.0029392563970967564, "entropy": 8.612525844573975, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 485000, "num_agent_steps_sampled": 1455000, "num_steps_trained": 485000, "num_agent_steps_trained": 1455000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1823, "training_iteration": 97, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-26-27", "timestamp": 1706228787, "time_this_iter_s": 10.352047204971313, "time_total_s": 1029.5257725715637, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824B2F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1029.5257725715637, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 7.6071428571428585, "ram_util_percent": 53.75714285714287}}
{"episode_reward_max": 131.96966460347164, "episode_reward_min": -322.51237818738446, "episode_reward_mean": 70.46404285675584, "episode_len_mean": 484.96, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -117.75032639503479}, "policy_reward_max": {"shared_policy": 44.34215947488943}, "policy_reward_mean": {"shared_policy": 23.488014285585276}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-259.3477607034147, 86.4882004112005, 88.50891254097222, 84.05162813793865, 83.72465620189905, 91.43876004777847, 101.36610304936767, 55.10876555740833, 72.31010071374476, 73.73944005370139, 69.39668009616435, -322.51237818738446, 56.07630643688026, 61.154358102008686, 75.0584480706602, 63.870318561792374, 92.09760046005249, 80.53550834953782, 62.78159626200794, 75.5610892623663, 61.762735795229645, 88.14678856171666, 67.71530657541007, 97.4360636100173, -260.20170121639967, 121.45145941525696, 108.57950793579221, 70.55702281277627, 94.44107087701556, 113.79963504127227, 80.63899218849835, 72.06673089414832, 103.10367273911831, 93.13829139340669, 58.8987144604325, 101.46359132789074, 85.12612449098378, 79.49382579699159, 97.56463588401675, 107.34396805427969, 42.256382368505, 72.8408549763262, 74.02078756317495, 60.85852190479635, 59.0201183706522, 73.87905141711232, 65.9622735492885, 80.17848180280997, 80.09481894318012, 89.99101036041975, 117.98146678949703, 68.39381438493727, 105.71047719568011, 77.32862380519506, 106.60209530964491, 92.41039320640263, 85.45103722531347, 88.24105220101774, 82.70793527737257, 67.37525464966892, 123.84032120462504, 81.6185591481626, 83.76891994476316, 65.7022986933589, 102.19965426903215, 102.69327470473944, 71.51352358609435, 76.6434833779931, 67.36150297895072, 131.96966460347164, 60.66855124710128, 74.16248961631209, -307.21723604016006, 87.44837727583943, 85.0449875295162, 61.05107593163848, 103.56229829788207, 85.32317959517239, 66.07755293510853, 77.30165409296748, 76.68184901587664, 115.7752716965042, 99.35384424775836, 88.03473993390797, 82.16126871760933, 117.71249925345182, 119.98186823725699, 76.09138670563696, 87.81574205448851, 83.33404026925564, 71.1313142105937, 96.18067881464958, 92.28202924970535, 95.26333602517842, 123.47181745525447, 93.28226638585326, 107.91381828114389, 97.80315769463776, 104.23323613405228, 91.92676693666726], "episode_lengths": [208, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 155, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 51, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [-82.58397355303168, -83.73302364349365, -93.03076350688934, 28.613995383183152, 28.890070574978978, 28.984134453038365, 29.36260215689738, 29.565194023152188, 29.58111636092265, 27.536393488446862, 28.135798564801604, 28.379436084690184, 27.926660783588886, 27.829360485076904, 27.96863493323326, 30.584814790015415, 30.549115789433316, 30.304829468329743, 34.14585392922163, 33.14273543655872, 34.07751368358731, 18.739550687372684, 18.403775744140148, 17.9654391258955, 23.94541595876217, 24.04659165814519, 24.3180930968374, 24.46538971861203, 24.674625379343823, 24.599424955745533, 23.13741284608841, 22.862993583083153, 23.396273666992784, -102.59821135550737, -102.16384043684229, -117.75032639503479, 18.647746667265892, 18.689558650366962, 18.739001119247405, 20.561105042075113, 20.498051234831408, 20.095201825102166, 24.52725079158941, 25.221651087204606, 25.30954619186619, 20.879202246665955, 21.25774098932743, 21.73337532579899, 30.85872159153223, 30.505503423511982, 30.733375445008278, 26.964610601464898, 26.511833826700837, 27.059063921372086, 20.78283744057019, 21.150947661449507, 20.84781115998824, 25.527896150946617, 24.785875841975212, 25.247317269444466, 20.858112557480723, 20.498246925572545, 20.406376312176377, 29.351385732491806, 29.22987466057141, 29.565528168653444, 22.9235747968778, 22.16183438897133, 22.629897389560938, 32.63390411436558, 31.881898909807205, 32.92026058584452, -83.46847490469615, -93.67980846265952, -83.05341784904401, 40.845055145521954, 40.06731395920117, 40.53909031053384, 35.98465636372566, 36.52154879644513, 36.073302775621414, 23.352095291018486, 23.745201888494194, 23.459725633263588, 31.846617604295403, 30.746793816486985, 31.847659456233174, 37.878741316497326, 38.0419725140091, 37.87892121076584, 26.96505461136499, 27.10671588095525, 26.56722169617811, 24.323193753759057, 23.283011118570954, 24.46052602181831, 34.76035470391312, 34.52827606598535, 33.815041969219834, 31.425327118486166, 31.474420526064932, 30.23854374885559, 19.353570769230515, 19.758301059405, 19.786842631796986, 33.90765615490575, 33.96228512500723, 33.59365004797776, 27.93301771581173, 28.863387254066765, 28.32971952110529, 25.930723786354065, 26.35638454556465, 27.20671746507287, 32.8193999491632, 32.15674637258053, 32.588489562273026, 35.736178409308195, 35.880398692563176, 35.727390952408314, 14.115296080708504, 14.187355153262615, 13.953731134533882, 24.365808604905993, 24.12834785381952, 24.346698517600686, 23.885942508776978, 25.257769913723067, 24.877075140674904, 20.525212944795683, 19.98385653396447, 20.349452426036194, 19.94762370735407, 19.49931187927723, 19.5731827840209, 23.950872565309197, 24.96458720850447, 24.963591643298656, 22.317547188450888, 21.83171347280343, 21.81301288803418, 26.332385969658688, 26.914918212064848, 26.931177621086434, 26.596179517606885, 27.078068043726176, 26.420571381847054, 29.78444868326187, 30.221245378255844, 29.985316298902035, 39.575270018928364, 38.995292025307805, 39.410904745260865, 23.025386733313397, 22.719879140456513, 22.648548511167363, 35.31688670317331, 35.04370393852392, 35.349886553982884, 25.775479125479848, 26.079704305777938, 25.47344037393728, 36.03354961300889, 35.717706518868596, 34.850839177767426, 30.845209288100392, 30.975526899720222, 30.589657018582017, 28.578928233434752, 28.296864209075764, 28.575244782802955, 29.44001989811659, 29.34492570720613, 29.45610659569502, 27.103527704874665, 27.76854523892203, 27.835862333575875, 22.827934206773833, 22.758445156117276, 21.78887528677781, 41.35959226793298, 41.219277555743844, 41.261451380948216, 27.39252020046115, 27.0885401815176, 27.137498766183853, 28.000394533077866, 27.605938444534928, 28.16258696715036, 21.98075272142887, 22.144593112170696, 21.57695285975933, 33.75111066798368, 33.84153702358404, 34.60700657746443, 34.38001380426188, 34.35301212718089, 33.96024877329667, 23.813833797971398, 23.79236344123879, 23.90732634688416, 25.66686963662505, 25.503999795764685, 25.47261394560337, 22.515957621236637, 22.16104172666867, 22.684503631045416, 43.884994755188615, 43.742510373393685, 44.34215947488943, 20.15264382213354, 20.54824401019141, 19.967663414776325, 24.789096332155168, 24.71172076277435, 24.66167252138257, -97.65315329966447, -97.71453908955058, -111.84954365094504, 28.832868372400597, 29.196417366464928, 29.41909153697391, 28.27710576107104, 28.130078946550682, 28.637802821894482, 20.34608317166567, 20.21148068457842, 20.493512075394392, 34.34956919153531, 34.59268696357806, 34.620042142768696, 28.78147742648919, 27.96304992338021, 28.57865224530299, 22.02882360791166, 21.929310039927557, 22.11941928726931, 25.992770003775746, 25.89718564848104, 25.411698440710694, 25.057916690905884, 25.60632636149724, 26.017605963473514, 38.24771375954151, 38.7460942575708, 38.78146367939189, 33.161407694841415, 33.00507403413454, 33.18736251878241, 29.462599230309323, 29.270314161976174, 29.301826541622475, 27.398460557063416, 26.746274580558136, 28.01653357998778, 38.84642939269543, 39.5815944224596, 39.284475438296795, 40.134184313317135, 39.990107220908, 39.85757670303185, 25.358591598769024, 25.51947809507449, 25.21331701179345, 29.165326602756977, 29.614792430307716, 29.035623021423817, 27.6537711545825, 27.911821380257607, 27.76844773441553, 24.071641460061073, 24.04103071242571, 23.01864203810692, 31.817244186997414, 32.072032287716866, 32.2914023399353, 30.714670563737542, 30.518598998586327, 31.048759687381477, 31.605423857768372, 31.573626046379403, 32.084286121030644, 41.015633317331464, 41.15206197897592, 41.30412215894708, 31.345087232689053, 30.958769078056008, 30.9784100751082, 35.908783716460064, 36.016796720524624, 35.9882378441592, 32.76607636859019, 32.37672158082326, 32.66035974522431, 34.5746241658926, 34.756832137703896, 34.90177983045578, 30.843731802888215, 30.461499504745007, 30.621535629034042]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14463008710199396, "mean_inference_ms": 0.6899803990892742, "mean_action_processing_ms": 0.10040236976898276, "mean_env_wait_ms": 0.8477482775557524, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 490000, "timesteps_this_iter": 0, "agent_timesteps_total": 1470000, "timers": {"sample_time_ms": 10443.291, "sample_throughput": 478.776, "load_time_ms": 0.2, "load_throughput": 25025680.191, "learn_time_ms": 1571.448, "learn_throughput": 3181.778, "update_time_ms": 7.346}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3552527156068806e-21, "cur_lr": 0.0005000000000000001, "total_loss": 5.553780269622803, "policy_loss": -0.002355288040132031, "vf_loss": 5.6422913551330565, "vf_explained_var": -0.06426378488540649, "kl": 0.0029562217183610904, "entropy": 8.61559238433838, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 490000, "num_agent_steps_sampled": 1470000, "num_steps_trained": 490000, "num_agent_steps_trained": 1470000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1833, "training_iteration": 98, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-26-37", "timestamp": 1706228797, "time_this_iter_s": 10.296254396438599, "time_total_s": 1039.8220269680023, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028379E700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1039.8220269680023, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 7.533333333333333, "ram_util_percent": 53.71333333333334}}
{"episode_reward_max": 131.96966460347164, "episode_reward_min": -322.51237818738446, "episode_reward_mean": 74.98244696222362, "episode_len_mean": 487.88, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -117.75032639503479}, "policy_reward_max": {"shared_policy": 44.34215947488943}, "policy_reward_mean": {"shared_policy": 24.99414898740787}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.39668009616435, -322.51237818738446, 56.07630643688026, 61.154358102008686, 75.0584480706602, 63.870318561792374, 92.09760046005249, 80.53550834953782, 62.78159626200794, 75.5610892623663, 61.762735795229645, 88.14678856171666, 67.71530657541007, 97.4360636100173, -260.20170121639967, 121.45145941525696, 108.57950793579221, 70.55702281277627, 94.44107087701556, 113.79963504127227, 80.63899218849835, 72.06673089414832, 103.10367273911831, 93.13829139340669, 58.8987144604325, 101.46359132789074, 85.12612449098378, 79.49382579699159, 97.56463588401675, 107.34396805427969, 42.256382368505, 72.8408549763262, 74.02078756317495, 60.85852190479635, 59.0201183706522, 73.87905141711232, 65.9622735492885, 80.17848180280997, 80.09481894318012, 89.99101036041975, 117.98146678949703, 68.39381438493727, 105.71047719568011, 77.32862380519506, 106.60209530964491, 92.41039320640263, 85.45103722531347, 88.24105220101774, 82.70793527737257, 67.37525464966892, 123.84032120462504, 81.6185591481626, 83.76891994476316, 65.7022986933589, 102.19965426903215, 102.69327470473944, 71.51352358609435, 76.6434833779931, 67.36150297895072, 131.96966460347164, 60.66855124710128, 74.16248961631209, -307.21723604016006, 87.44837727583943, 85.0449875295162, 61.05107593163848, 103.56229829788207, 85.32317959517239, 66.07755293510853, 77.30165409296748, 76.68184901587664, 115.7752716965042, 99.35384424775836, 88.03473993390797, 82.16126871760933, 117.71249925345182, 119.98186823725699, 76.09138670563696, 87.81574205448851, 83.33404026925564, 71.1313142105937, 96.18067881464958, 92.28202924970535, 95.26333602517842, 123.47181745525447, 93.28226638585326, 107.91381828114389, 97.80315769463776, 104.23323613405228, 91.92676693666726, 82.42674178723244, 80.24428330734372, 106.80728589944192, 97.3419654034078, 69.16567992791532, 82.99561611749229, 120.64509073644876, 101.76216802746055, 78.73835514858362, 109.10203020204789], "episode_lengths": [500, 82, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 155, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 51, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [23.13741284608841, 22.862993583083153, 23.396273666992784, -102.59821135550737, -102.16384043684229, -117.75032639503479, 18.647746667265892, 18.689558650366962, 18.739001119247405, 20.561105042075113, 20.498051234831408, 20.095201825102166, 24.52725079158941, 25.221651087204606, 25.30954619186619, 20.879202246665955, 21.25774098932743, 21.73337532579899, 30.85872159153223, 30.505503423511982, 30.733375445008278, 26.964610601464898, 26.511833826700837, 27.059063921372086, 20.78283744057019, 21.150947661449507, 20.84781115998824, 25.527896150946617, 24.785875841975212, 25.247317269444466, 20.858112557480723, 20.498246925572545, 20.406376312176377, 29.351385732491806, 29.22987466057141, 29.565528168653444, 22.9235747968778, 22.16183438897133, 22.629897389560938, 32.63390411436558, 31.881898909807205, 32.92026058584452, -83.46847490469615, -93.67980846265952, -83.05341784904401, 40.845055145521954, 40.06731395920117, 40.53909031053384, 35.98465636372566, 36.52154879644513, 36.073302775621414, 23.352095291018486, 23.745201888494194, 23.459725633263588, 31.846617604295403, 30.746793816486985, 31.847659456233174, 37.878741316497326, 38.0419725140091, 37.87892121076584, 26.96505461136499, 27.10671588095525, 26.56722169617811, 24.323193753759057, 23.283011118570954, 24.46052602181831, 34.76035470391312, 34.52827606598535, 33.815041969219834, 31.425327118486166, 31.474420526064932, 30.23854374885559, 19.353570769230515, 19.758301059405, 19.786842631796986, 33.90765615490575, 33.96228512500723, 33.59365004797776, 27.93301771581173, 28.863387254066765, 28.32971952110529, 25.930723786354065, 26.35638454556465, 27.20671746507287, 32.8193999491632, 32.15674637258053, 32.588489562273026, 35.736178409308195, 35.880398692563176, 35.727390952408314, 14.115296080708504, 14.187355153262615, 13.953731134533882, 24.365808604905993, 24.12834785381952, 24.346698517600686, 23.885942508776978, 25.257769913723067, 24.877075140674904, 20.525212944795683, 19.98385653396447, 20.349452426036194, 19.94762370735407, 19.49931187927723, 19.5731827840209, 23.950872565309197, 24.96458720850447, 24.963591643298656, 22.317547188450888, 21.83171347280343, 21.81301288803418, 26.332385969658688, 26.914918212064848, 26.931177621086434, 26.596179517606885, 27.078068043726176, 26.420571381847054, 29.78444868326187, 30.221245378255844, 29.985316298902035, 39.575270018928364, 38.995292025307805, 39.410904745260865, 23.025386733313397, 22.719879140456513, 22.648548511167363, 35.31688670317331, 35.04370393852392, 35.349886553982884, 25.775479125479848, 26.079704305777938, 25.47344037393728, 36.03354961300889, 35.717706518868596, 34.850839177767426, 30.845209288100392, 30.975526899720222, 30.589657018582017, 28.578928233434752, 28.296864209075764, 28.575244782802955, 29.44001989811659, 29.34492570720613, 29.45610659569502, 27.103527704874665, 27.76854523892203, 27.835862333575875, 22.827934206773833, 22.758445156117276, 21.78887528677781, 41.35959226793298, 41.219277555743844, 41.261451380948216, 27.39252020046115, 27.0885401815176, 27.137498766183853, 28.000394533077866, 27.605938444534928, 28.16258696715036, 21.98075272142887, 22.144593112170696, 21.57695285975933, 33.75111066798368, 33.84153702358404, 34.60700657746443, 34.38001380426188, 34.35301212718089, 33.96024877329667, 23.813833797971398, 23.79236344123879, 23.90732634688416, 25.66686963662505, 25.503999795764685, 25.47261394560337, 22.515957621236637, 22.16104172666867, 22.684503631045416, 43.884994755188615, 43.742510373393685, 44.34215947488943, 20.15264382213354, 20.54824401019141, 19.967663414776325, 24.789096332155168, 24.71172076277435, 24.66167252138257, -97.65315329966447, -97.71453908955058, -111.84954365094504, 28.832868372400597, 29.196417366464928, 29.41909153697391, 28.27710576107104, 28.130078946550682, 28.637802821894482, 20.34608317166567, 20.21148068457842, 20.493512075394392, 34.34956919153531, 34.59268696357806, 34.620042142768696, 28.78147742648919, 27.96304992338021, 28.57865224530299, 22.02882360791166, 21.929310039927557, 22.11941928726931, 25.992770003775746, 25.89718564848104, 25.411698440710694, 25.057916690905884, 25.60632636149724, 26.017605963473514, 38.24771375954151, 38.7460942575708, 38.78146367939189, 33.161407694841415, 33.00507403413454, 33.18736251878241, 29.462599230309323, 29.270314161976174, 29.301826541622475, 27.398460557063416, 26.746274580558136, 28.01653357998778, 38.84642939269543, 39.5815944224596, 39.284475438296795, 40.134184313317135, 39.990107220908, 39.85757670303185, 25.358591598769024, 25.51947809507449, 25.21331701179345, 29.165326602756977, 29.614792430307716, 29.035623021423817, 27.6537711545825, 27.911821380257607, 27.76844773441553, 24.071641460061073, 24.04103071242571, 23.01864203810692, 31.817244186997414, 32.072032287716866, 32.2914023399353, 30.714670563737542, 30.518598998586327, 31.048759687381477, 31.605423857768372, 31.573626046379403, 32.084286121030644, 41.015633317331464, 41.15206197897592, 41.30412215894708, 31.345087232689053, 30.958769078056008, 30.9784100751082, 35.908783716460064, 36.016796720524624, 35.9882378441592, 32.76607636859019, 32.37672158082326, 32.66035974522431, 34.5746241658926, 34.756832137703896, 34.90177983045578, 30.843731802888215, 30.461499504745007, 30.621535629034042, 27.3852078517278, 27.314454940458134, 27.72707899504651, 26.333469197154045, 26.977547572925687, 26.93326653726399, 35.20164357125759, 35.91060443423339, 35.69503789395094, 32.51872757573922, 32.74815708522995, 32.07508074243863, 23.040741739173725, 23.218134829153612, 22.906803359587983, 27.706053512791783, 27.81336930083731, 27.476193303863198, 40.07590436190367, 40.4286342933774, 40.1405520811677, 33.75948340694109, 34.09886141369739, 33.90382320682207, 26.324881779650838, 26.217113471279532, 26.196359897653252, 35.90480965872605, 36.74996119419423, 36.447259349127606]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1445787422055272, "mean_inference_ms": 0.6899202837300663, "mean_action_processing_ms": 0.1003985685857033, "mean_env_wait_ms": 0.8476564880493523, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 495000, "timesteps_this_iter": 0, "agent_timesteps_total": 1485000, "timers": {"sample_time_ms": 10456.409, "sample_throughput": 478.176, "load_time_ms": 0.2, "load_throughput": 25025680.191, "learn_time_ms": 1576.963, "learn_throughput": 3170.651, "update_time_ms": 7.515}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.776263578034403e-22, "cur_lr": 0.0005000000000000001, "total_loss": 7.208747386932373, "policy_loss": -0.0022670951523150683, "vf_loss": 7.296378803253174, "vf_explained_var": -0.04756780862808228, "kl": 0.0024450244032979984, "entropy": 8.536417865753174, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 495000, "num_agent_steps_sampled": 1485000, "num_steps_trained": 495000, "num_agent_steps_trained": 1485000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1843, "training_iteration": 99, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-26-48", "timestamp": 1706228808, "time_this_iter_s": 10.528565645217896, "time_total_s": 1050.3505926132202, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202825D1DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1050.3505926132202, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 9.16, "ram_util_percent": 53.733333333333334}}
{"episode_reward_max": 148.69403919577593, "episode_reward_min": -307.21723604016006, "episode_reward_mean": 78.30052506830457, "episode_len_mean": 488.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -111.84954365094504}, "policy_reward_max": {"shared_policy": 49.73392227788766}, "policy_reward_mean": {"shared_policy": 26.10017502276818}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.762735795229645, 88.14678856171666, 67.71530657541007, 97.4360636100173, -260.20170121639967, 121.45145941525696, 108.57950793579221, 70.55702281277627, 94.44107087701556, 113.79963504127227, 80.63899218849835, 72.06673089414832, 103.10367273911831, 93.13829139340669, 58.8987144604325, 101.46359132789074, 85.12612449098378, 79.49382579699159, 97.56463588401675, 107.34396805427969, 42.256382368505, 72.8408549763262, 74.02078756317495, 60.85852190479635, 59.0201183706522, 73.87905141711232, 65.9622735492885, 80.17848180280997, 80.09481894318012, 89.99101036041975, 117.98146678949703, 68.39381438493727, 105.71047719568011, 77.32862380519506, 106.60209530964491, 92.41039320640263, 85.45103722531347, 88.24105220101774, 82.70793527737257, 67.37525464966892, 123.84032120462504, 81.6185591481626, 83.76891994476316, 65.7022986933589, 102.19965426903215, 102.69327470473944, 71.51352358609435, 76.6434833779931, 67.36150297895072, 131.96966460347164, 60.66855124710128, 74.16248961631209, -307.21723604016006, 87.44837727583943, 85.0449875295162, 61.05107593163848, 103.56229829788207, 85.32317959517239, 66.07755293510853, 77.30165409296748, 76.68184901587664, 115.7752716965042, 99.35384424775836, 88.03473993390797, 82.16126871760933, 117.71249925345182, 119.98186823725699, 76.09138670563696, 87.81574205448851, 83.33404026925564, 71.1313142105937, 96.18067881464958, 92.28202924970535, 95.26333602517842, 123.47181745525447, 93.28226638585326, 107.91381828114389, 97.80315769463776, 104.23323613405228, 91.92676693666726, 82.42674178723244, 80.24428330734372, 106.80728589944192, 97.3419654034078, 69.16567992791532, 82.99561611749229, 120.64509073644876, 101.76216802746055, 78.73835514858362, 109.10203020204789, 91.56705934368073, 148.69403919577593, 117.4999733008444, -284.37190292030573, 89.060969106853, 110.20349486172196, 99.35263526067135, 104.92113094031811, 86.77229240536687, 82.12764652725309], "episode_lengths": [500, 500, 500, 500, 155, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 51, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 174, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [20.858112557480723, 20.498246925572545, 20.406376312176377, 29.351385732491806, 29.22987466057141, 29.565528168653444, 22.9235747968778, 22.16183438897133, 22.629897389560938, 32.63390411436558, 31.881898909807205, 32.92026058584452, -83.46847490469615, -93.67980846265952, -83.05341784904401, 40.845055145521954, 40.06731395920117, 40.53909031053384, 35.98465636372566, 36.52154879644513, 36.073302775621414, 23.352095291018486, 23.745201888494194, 23.459725633263588, 31.846617604295403, 30.746793816486985, 31.847659456233174, 37.878741316497326, 38.0419725140091, 37.87892121076584, 26.96505461136499, 27.10671588095525, 26.56722169617811, 24.323193753759057, 23.283011118570954, 24.46052602181831, 34.76035470391312, 34.52827606598535, 33.815041969219834, 31.425327118486166, 31.474420526064932, 30.23854374885559, 19.353570769230515, 19.758301059405, 19.786842631796986, 33.90765615490575, 33.96228512500723, 33.59365004797776, 27.93301771581173, 28.863387254066765, 28.32971952110529, 25.930723786354065, 26.35638454556465, 27.20671746507287, 32.8193999491632, 32.15674637258053, 32.588489562273026, 35.736178409308195, 35.880398692563176, 35.727390952408314, 14.115296080708504, 14.187355153262615, 13.953731134533882, 24.365808604905993, 24.12834785381952, 24.346698517600686, 23.885942508776978, 25.257769913723067, 24.877075140674904, 20.525212944795683, 19.98385653396447, 20.349452426036194, 19.94762370735407, 19.49931187927723, 19.5731827840209, 23.950872565309197, 24.96458720850447, 24.963591643298656, 22.317547188450888, 21.83171347280343, 21.81301288803418, 26.332385969658688, 26.914918212064848, 26.931177621086434, 26.596179517606885, 27.078068043726176, 26.420571381847054, 29.78444868326187, 30.221245378255844, 29.985316298902035, 39.575270018928364, 38.995292025307805, 39.410904745260865, 23.025386733313397, 22.719879140456513, 22.648548511167363, 35.31688670317331, 35.04370393852392, 35.349886553982884, 25.775479125479848, 26.079704305777938, 25.47344037393728, 36.03354961300889, 35.717706518868596, 34.850839177767426, 30.845209288100392, 30.975526899720222, 30.589657018582017, 28.578928233434752, 28.296864209075764, 28.575244782802955, 29.44001989811659, 29.34492570720613, 29.45610659569502, 27.103527704874665, 27.76854523892203, 27.835862333575875, 22.827934206773833, 22.758445156117276, 21.78887528677781, 41.35959226793298, 41.219277555743844, 41.261451380948216, 27.39252020046115, 27.0885401815176, 27.137498766183853, 28.000394533077866, 27.605938444534928, 28.16258696715036, 21.98075272142887, 22.144593112170696, 21.57695285975933, 33.75111066798368, 33.84153702358404, 34.60700657746443, 34.38001380426188, 34.35301212718089, 33.96024877329667, 23.813833797971398, 23.79236344123879, 23.90732634688416, 25.66686963662505, 25.503999795764685, 25.47261394560337, 22.515957621236637, 22.16104172666867, 22.684503631045416, 43.884994755188615, 43.742510373393685, 44.34215947488943, 20.15264382213354, 20.54824401019141, 19.967663414776325, 24.789096332155168, 24.71172076277435, 24.66167252138257, -97.65315329966447, -97.71453908955058, -111.84954365094504, 28.832868372400597, 29.196417366464928, 29.41909153697391, 28.27710576107104, 28.130078946550682, 28.637802821894482, 20.34608317166567, 20.21148068457842, 20.493512075394392, 34.34956919153531, 34.59268696357806, 34.620042142768696, 28.78147742648919, 27.96304992338021, 28.57865224530299, 22.02882360791166, 21.929310039927557, 22.11941928726931, 25.992770003775746, 25.89718564848104, 25.411698440710694, 25.057916690905884, 25.60632636149724, 26.017605963473514, 38.24771375954151, 38.7460942575708, 38.78146367939189, 33.161407694841415, 33.00507403413454, 33.18736251878241, 29.462599230309323, 29.270314161976174, 29.301826541622475, 27.398460557063416, 26.746274580558136, 28.01653357998778, 38.84642939269543, 39.5815944224596, 39.284475438296795, 40.134184313317135, 39.990107220908, 39.85757670303185, 25.358591598769024, 25.51947809507449, 25.21331701179345, 29.165326602756977, 29.614792430307716, 29.035623021423817, 27.6537711545825, 27.911821380257607, 27.76844773441553, 24.071641460061073, 24.04103071242571, 23.01864203810692, 31.817244186997414, 32.072032287716866, 32.2914023399353, 30.714670563737542, 30.518598998586327, 31.048759687381477, 31.605423857768372, 31.573626046379403, 32.084286121030644, 41.015633317331464, 41.15206197897592, 41.30412215894708, 31.345087232689053, 30.958769078056008, 30.9784100751082, 35.908783716460064, 36.016796720524624, 35.9882378441592, 32.76607636859019, 32.37672158082326, 32.66035974522431, 34.5746241658926, 34.756832137703896, 34.90177983045578, 30.843731802888215, 30.461499504745007, 30.621535629034042, 27.3852078517278, 27.314454940458134, 27.72707899504651, 26.333469197154045, 26.977547572925687, 26.93326653726399, 35.20164357125759, 35.91060443423339, 35.69503789395094, 32.51872757573922, 32.74815708522995, 32.07508074243863, 23.040741739173725, 23.218134829153612, 22.906803359587983, 27.706053512791783, 27.81336930083731, 27.476193303863198, 40.07590436190367, 40.4286342933774, 40.1405520811677, 33.75948340694109, 34.09886141369739, 33.90382320682207, 26.324881779650838, 26.217113471279532, 26.196359897653252, 35.90480965872605, 36.74996119419423, 36.447259349127606, 30.613048988704875, 30.664545734723404, 30.289464620252446, 49.26266664763291, 49.73392227788766, 49.6974502702554, 39.25290017450848, 39.107768694559724, 39.139304431776196, -104.08026852210364, -90.13327379276356, -90.15836060543856, 29.74045514625807, 29.6060049769779, 29.714508983617023, 36.88245318333307, 36.54184206823507, 36.779199610153825, 33.01729816446701, 33.24348834777871, 33.09184874842563, 35.18550670146942, 34.90356168150902, 34.83206255733967, 28.908975074688584, 29.10910657296577, 28.754210757712514, 27.31821598112583, 27.344844840466976, 27.464585705660284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14456959037044145, "mean_inference_ms": 0.6900827245507462, "mean_action_processing_ms": 0.10041335369934408, "mean_env_wait_ms": 0.8477126988807963, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 500000, "timesteps_this_iter": 0, "agent_timesteps_total": 1500000, "timers": {"sample_time_ms": 10462.454, "sample_throughput": 477.899, "load_time_ms": 0.2, "load_throughput": 25025680.191, "learn_time_ms": 1579.745, "learn_throughput": 3165.068, "update_time_ms": 7.515}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.3881317890172015e-22, "cur_lr": 0.0005000000000000001, "total_loss": 84.2464599609375, "policy_loss": -0.0027335684768886813, "vf_loss": 84.33433074951172, "vf_explained_var": 0.04314740300178528, "kl": 0.01178216305563393, "entropy": 8.513458061218262, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 500000, "num_agent_steps_sampled": 1500000, "num_steps_trained": 500000, "num_agent_steps_trained": 1500000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 138.22417931631213, "episode_reward_min": 67.77038987353443, "episode_reward_mean": 108.3175025233533, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 22.08739348252614}, "policy_reward_max": {"shared_policy": 46.53844743346174}, "policy_reward_mean": {"shared_policy": 36.1058341744511}, "custom_metrics": {}, "hist_stats": {"episode_reward": [82.50459375046191, 113.41067986423148, 134.22438841685647, 110.99497311934826, 80.05273332074285, 137.74844761192782, 118.30723185092211, 99.9374081091955, 138.22417931631213, 67.77038987353443], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [27.653073315198213, 27.5391954469184, 27.312324988345296, 37.546854843695954, 38.053578890704856, 37.810246129830674, 44.6654335980614, 44.536280055840805, 45.02267476295431, 37.147814715902, 36.80598360548416, 37.0411747979621, 26.454406924545765, 26.736219584941864, 26.862106811255217, 46.036343603084475, 45.565736452738435, 46.14636755610505, 39.49491489678621, 39.54452693462372, 39.26779001951218, 33.03004919985929, 33.14566999177137, 33.76168891756484, 46.13350746532281, 46.53844743346174, 45.55222441752751, 22.08739348252614, 23.129538619269923, 22.553457771738366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14588423054667188, "mean_inference_ms": 0.7472619237023441, "mean_action_processing_ms": 0.1076954434530912, "mean_env_wait_ms": 0.8775284142270587, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 1853, "training_iteration": 100, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-27-08", "timestamp": 1706228828, "time_this_iter_s": 20.422717809677124, "time_total_s": 1070.7733104228973, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202808BA280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1070.7733104228973, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 8.803448275862069, "ram_util_percent": 53.93448275862069}}
{"episode_reward_max": 163.15497693885123, "episode_reward_min": -307.21723604016006, "episode_reward_mean": 83.46838538101592, "episode_len_mean": 492.25, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -111.84954365094504}, "policy_reward_max": {"shared_policy": 54.44424689219643}, "policy_reward_mean": {"shared_policy": 27.822795127005303}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.63899218849835, 72.06673089414832, 103.10367273911831, 93.13829139340669, 58.8987144604325, 101.46359132789074, 85.12612449098378, 79.49382579699159, 97.56463588401675, 107.34396805427969, 42.256382368505, 72.8408549763262, 74.02078756317495, 60.85852190479635, 59.0201183706522, 73.87905141711232, 65.9622735492885, 80.17848180280997, 80.09481894318012, 89.99101036041975, 117.98146678949703, 68.39381438493727, 105.71047719568011, 77.32862380519506, 106.60209530964491, 92.41039320640263, 85.45103722531347, 88.24105220101774, 82.70793527737257, 67.37525464966892, 123.84032120462504, 81.6185591481626, 83.76891994476316, 65.7022986933589, 102.19965426903215, 102.69327470473944, 71.51352358609435, 76.6434833779931, 67.36150297895072, 131.96966460347164, 60.66855124710128, 74.16248961631209, -307.21723604016006, 87.44837727583943, 85.0449875295162, 61.05107593163848, 103.56229829788207, 85.32317959517239, 66.07755293510853, 77.30165409296748, 76.68184901587664, 115.7752716965042, 99.35384424775836, 88.03473993390797, 82.16126871760933, 117.71249925345182, 119.98186823725699, 76.09138670563696, 87.81574205448851, 83.33404026925564, 71.1313142105937, 96.18067881464958, 92.28202924970535, 95.26333602517842, 123.47181745525447, 93.28226638585326, 107.91381828114389, 97.80315769463776, 104.23323613405228, 91.92676693666726, 82.42674178723244, 80.24428330734372, 106.80728589944192, 97.3419654034078, 69.16567992791532, 82.99561611749229, 120.64509073644876, 101.76216802746055, 78.73835514858362, 109.10203020204789, 91.56705934368073, 148.69403919577593, 117.4999733008444, -284.37190292030573, 89.060969106853, 110.20349486172196, 99.35263526067135, 104.92113094031811, 86.77229240536687, 82.12764652725309, 163.15497693885123, 105.19598558777942, 78.68767260760067, 109.88020337035414, 132.34977156203223, 114.13357096165416, 70.3225046508014, 110.50594047425875, 96.72607472911476, 99.51721979677674], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 51, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 174, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [26.96505461136499, 27.10671588095525, 26.56722169617811, 24.323193753759057, 23.283011118570954, 24.46052602181831, 34.76035470391312, 34.52827606598535, 33.815041969219834, 31.425327118486166, 31.474420526064932, 30.23854374885559, 19.353570769230515, 19.758301059405, 19.786842631796986, 33.90765615490575, 33.96228512500723, 33.59365004797776, 27.93301771581173, 28.863387254066765, 28.32971952110529, 25.930723786354065, 26.35638454556465, 27.20671746507287, 32.8193999491632, 32.15674637258053, 32.588489562273026, 35.736178409308195, 35.880398692563176, 35.727390952408314, 14.115296080708504, 14.187355153262615, 13.953731134533882, 24.365808604905993, 24.12834785381952, 24.346698517600686, 23.885942508776978, 25.257769913723067, 24.877075140674904, 20.525212944795683, 19.98385653396447, 20.349452426036194, 19.94762370735407, 19.49931187927723, 19.5731827840209, 23.950872565309197, 24.96458720850447, 24.963591643298656, 22.317547188450888, 21.83171347280343, 21.81301288803418, 26.332385969658688, 26.914918212064848, 26.931177621086434, 26.596179517606885, 27.078068043726176, 26.420571381847054, 29.78444868326187, 30.221245378255844, 29.985316298902035, 39.575270018928364, 38.995292025307805, 39.410904745260865, 23.025386733313397, 22.719879140456513, 22.648548511167363, 35.31688670317331, 35.04370393852392, 35.349886553982884, 25.775479125479848, 26.079704305777938, 25.47344037393728, 36.03354961300889, 35.717706518868596, 34.850839177767426, 30.845209288100392, 30.975526899720222, 30.589657018582017, 28.578928233434752, 28.296864209075764, 28.575244782802955, 29.44001989811659, 29.34492570720613, 29.45610659569502, 27.103527704874665, 27.76854523892203, 27.835862333575875, 22.827934206773833, 22.758445156117276, 21.78887528677781, 41.35959226793298, 41.219277555743844, 41.261451380948216, 27.39252020046115, 27.0885401815176, 27.137498766183853, 28.000394533077866, 27.605938444534928, 28.16258696715036, 21.98075272142887, 22.144593112170696, 21.57695285975933, 33.75111066798368, 33.84153702358404, 34.60700657746443, 34.38001380426188, 34.35301212718089, 33.96024877329667, 23.813833797971398, 23.79236344123879, 23.90732634688416, 25.66686963662505, 25.503999795764685, 25.47261394560337, 22.515957621236637, 22.16104172666867, 22.684503631045416, 43.884994755188615, 43.742510373393685, 44.34215947488943, 20.15264382213354, 20.54824401019141, 19.967663414776325, 24.789096332155168, 24.71172076277435, 24.66167252138257, -97.65315329966447, -97.71453908955058, -111.84954365094504, 28.832868372400597, 29.196417366464928, 29.41909153697391, 28.27710576107104, 28.130078946550682, 28.637802821894482, 20.34608317166567, 20.21148068457842, 20.493512075394392, 34.34956919153531, 34.59268696357806, 34.620042142768696, 28.78147742648919, 27.96304992338021, 28.57865224530299, 22.02882360791166, 21.929310039927557, 22.11941928726931, 25.992770003775746, 25.89718564848104, 25.411698440710694, 25.057916690905884, 25.60632636149724, 26.017605963473514, 38.24771375954151, 38.7460942575708, 38.78146367939189, 33.161407694841415, 33.00507403413454, 33.18736251878241, 29.462599230309323, 29.270314161976174, 29.301826541622475, 27.398460557063416, 26.746274580558136, 28.01653357998778, 38.84642939269543, 39.5815944224596, 39.284475438296795, 40.134184313317135, 39.990107220908, 39.85757670303185, 25.358591598769024, 25.51947809507449, 25.21331701179345, 29.165326602756977, 29.614792430307716, 29.035623021423817, 27.6537711545825, 27.911821380257607, 27.76844773441553, 24.071641460061073, 24.04103071242571, 23.01864203810692, 31.817244186997414, 32.072032287716866, 32.2914023399353, 30.714670563737542, 30.518598998586327, 31.048759687381477, 31.605423857768372, 31.573626046379403, 32.084286121030644, 41.015633317331464, 41.15206197897592, 41.30412215894708, 31.345087232689053, 30.958769078056008, 30.9784100751082, 35.908783716460064, 36.016796720524624, 35.9882378441592, 32.76607636859019, 32.37672158082326, 32.66035974522431, 34.5746241658926, 34.756832137703896, 34.90177983045578, 30.843731802888215, 30.461499504745007, 30.621535629034042, 27.3852078517278, 27.314454940458134, 27.72707899504651, 26.333469197154045, 26.977547572925687, 26.93326653726399, 35.20164357125759, 35.91060443423339, 35.69503789395094, 32.51872757573922, 32.74815708522995, 32.07508074243863, 23.040741739173725, 23.218134829153612, 22.906803359587983, 27.706053512791783, 27.81336930083731, 27.476193303863198, 40.07590436190367, 40.4286342933774, 40.1405520811677, 33.75948340694109, 34.09886141369739, 33.90382320682207, 26.324881779650838, 26.217113471279532, 26.196359897653252, 35.90480965872605, 36.74996119419423, 36.447259349127606, 30.613048988704875, 30.664545734723404, 30.289464620252446, 49.26266664763291, 49.73392227788766, 49.6974502702554, 39.25290017450848, 39.107768694559724, 39.139304431776196, -104.08026852210364, -90.13327379276356, -90.15836060543856, 29.74045514625807, 29.6060049769779, 29.714508983617023, 36.88245318333307, 36.54184206823507, 36.779199610153825, 33.01729816446701, 33.24348834777871, 33.09184874842563, 35.18550670146942, 34.90356168150902, 34.83206255733967, 28.908975074688584, 29.10910657296577, 28.754210757712514, 27.31821598112583, 27.344844840466976, 27.464585705660284, 54.36470199314256, 54.34602805351217, 54.44424689219643, 35.04094337423642, 34.97238369037707, 35.18265852316593, 26.2591806401809, 25.836731304725006, 26.591760662694767, 36.61962826550007, 36.1969433426857, 37.06363176216837, 43.83207357426484, 43.981334072848156, 44.53636391491939, 38.13694770882526, 38.191781784097344, 37.80484146873155, 22.904920165737465, 23.642608390500143, 23.774976094563797, 36.69451881200075, 36.77905010059476, 37.03237156166324, 31.773758595188454, 32.439327071731284, 32.51298906219502, 33.25053335602084, 33.13645924876133, 33.13022719199458]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1446103278922582, "mean_inference_ms": 0.690432926579933, "mean_action_processing_ms": 0.10042773533161428, "mean_env_wait_ms": 0.8479514375184825, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 505000, "timesteps_this_iter": 0, "agent_timesteps_total": 1515000, "timers": {"sample_time_ms": 11584.901, "sample_throughput": 431.596, "load_time_ms": 0.2, "load_throughput": 25025680.191, "learn_time_ms": 1593.365, "learn_throughput": 3138.012, "update_time_ms": 7.349}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.3881317890172015e-22, "cur_lr": 0.0005000000000000001, "total_loss": 5.4507482051849365, "policy_loss": -0.0015418225198192913, "vf_loss": 5.5359978675842285, "vf_explained_var": -0.028230977058410645, "kl": 0.002618581696898529, "entropy": 8.370775604248047, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 505000, "num_agent_steps_sampled": 1515000, "num_steps_trained": 505000, "num_agent_steps_trained": 1515000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1863, "training_iteration": 101, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-27-20", "timestamp": 1706228840, "time_this_iter_s": 11.643164157867432, "time_total_s": 1082.4164745807648, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202825D1CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1082.4164745807648, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 8.80625, "ram_util_percent": 54.6125}}
{"episode_reward_max": 163.15497693885123, "episode_reward_min": -307.21723604016006, "episode_reward_mean": 84.33036514421117, "episode_len_mean": 492.25, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -111.84954365094504}, "policy_reward_max": {"shared_policy": 54.44424689219643}, "policy_reward_mean": {"shared_policy": 28.11012171473706}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.256382368505, 72.8408549763262, 74.02078756317495, 60.85852190479635, 59.0201183706522, 73.87905141711232, 65.9622735492885, 80.17848180280997, 80.09481894318012, 89.99101036041975, 117.98146678949703, 68.39381438493727, 105.71047719568011, 77.32862380519506, 106.60209530964491, 92.41039320640263, 85.45103722531347, 88.24105220101774, 82.70793527737257, 67.37525464966892, 123.84032120462504, 81.6185591481626, 83.76891994476316, 65.7022986933589, 102.19965426903215, 102.69327470473944, 71.51352358609435, 76.6434833779931, 67.36150297895072, 131.96966460347164, 60.66855124710128, 74.16248961631209, -307.21723604016006, 87.44837727583943, 85.0449875295162, 61.05107593163848, 103.56229829788207, 85.32317959517239, 66.07755293510853, 77.30165409296748, 76.68184901587664, 115.7752716965042, 99.35384424775836, 88.03473993390797, 82.16126871760933, 117.71249925345182, 119.98186823725699, 76.09138670563696, 87.81574205448851, 83.33404026925564, 71.1313142105937, 96.18067881464958, 92.28202924970535, 95.26333602517842, 123.47181745525447, 93.28226638585326, 107.91381828114389, 97.80315769463776, 104.23323613405228, 91.92676693666726, 82.42674178723244, 80.24428330734372, 106.80728589944192, 97.3419654034078, 69.16567992791532, 82.99561611749229, 120.64509073644876, 101.76216802746055, 78.73835514858362, 109.10203020204789, 91.56705934368073, 148.69403919577593, 117.4999733008444, -284.37190292030573, 89.060969106853, 110.20349486172196, 99.35263526067135, 104.92113094031811, 86.77229240536687, 82.12764652725309, 163.15497693885123, 105.19598558777942, 78.68767260760067, 109.88020337035414, 132.34977156203223, 114.13357096165416, 70.3225046508014, 110.50594047425875, 96.72607472911476, 99.51721979677674, 102.82031964510676, 99.3921688389382, 104.07076564338055, 75.90300826355815, 99.2901241108775, 114.06614480074492, 96.06833409890531, 105.77659453451633, 72.59933494403955, 95.04972866922616], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 51, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 174, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [14.115296080708504, 14.187355153262615, 13.953731134533882, 24.365808604905993, 24.12834785381952, 24.346698517600686, 23.885942508776978, 25.257769913723067, 24.877075140674904, 20.525212944795683, 19.98385653396447, 20.349452426036194, 19.94762370735407, 19.49931187927723, 19.5731827840209, 23.950872565309197, 24.96458720850447, 24.963591643298656, 22.317547188450888, 21.83171347280343, 21.81301288803418, 26.332385969658688, 26.914918212064848, 26.931177621086434, 26.596179517606885, 27.078068043726176, 26.420571381847054, 29.78444868326187, 30.221245378255844, 29.985316298902035, 39.575270018928364, 38.995292025307805, 39.410904745260865, 23.025386733313397, 22.719879140456513, 22.648548511167363, 35.31688670317331, 35.04370393852392, 35.349886553982884, 25.775479125479848, 26.079704305777938, 25.47344037393728, 36.03354961300889, 35.717706518868596, 34.850839177767426, 30.845209288100392, 30.975526899720222, 30.589657018582017, 28.578928233434752, 28.296864209075764, 28.575244782802955, 29.44001989811659, 29.34492570720613, 29.45610659569502, 27.103527704874665, 27.76854523892203, 27.835862333575875, 22.827934206773833, 22.758445156117276, 21.78887528677781, 41.35959226793298, 41.219277555743844, 41.261451380948216, 27.39252020046115, 27.0885401815176, 27.137498766183853, 28.000394533077866, 27.605938444534928, 28.16258696715036, 21.98075272142887, 22.144593112170696, 21.57695285975933, 33.75111066798368, 33.84153702358404, 34.60700657746443, 34.38001380426188, 34.35301212718089, 33.96024877329667, 23.813833797971398, 23.79236344123879, 23.90732634688416, 25.66686963662505, 25.503999795764685, 25.47261394560337, 22.515957621236637, 22.16104172666867, 22.684503631045416, 43.884994755188615, 43.742510373393685, 44.34215947488943, 20.15264382213354, 20.54824401019141, 19.967663414776325, 24.789096332155168, 24.71172076277435, 24.66167252138257, -97.65315329966447, -97.71453908955058, -111.84954365094504, 28.832868372400597, 29.196417366464928, 29.41909153697391, 28.27710576107104, 28.130078946550682, 28.637802821894482, 20.34608317166567, 20.21148068457842, 20.493512075394392, 34.34956919153531, 34.59268696357806, 34.620042142768696, 28.78147742648919, 27.96304992338021, 28.57865224530299, 22.02882360791166, 21.929310039927557, 22.11941928726931, 25.992770003775746, 25.89718564848104, 25.411698440710694, 25.057916690905884, 25.60632636149724, 26.017605963473514, 38.24771375954151, 38.7460942575708, 38.78146367939189, 33.161407694841415, 33.00507403413454, 33.18736251878241, 29.462599230309323, 29.270314161976174, 29.301826541622475, 27.398460557063416, 26.746274580558136, 28.01653357998778, 38.84642939269543, 39.5815944224596, 39.284475438296795, 40.134184313317135, 39.990107220908, 39.85757670303185, 25.358591598769024, 25.51947809507449, 25.21331701179345, 29.165326602756977, 29.614792430307716, 29.035623021423817, 27.6537711545825, 27.911821380257607, 27.76844773441553, 24.071641460061073, 24.04103071242571, 23.01864203810692, 31.817244186997414, 32.072032287716866, 32.2914023399353, 30.714670563737542, 30.518598998586327, 31.048759687381477, 31.605423857768372, 31.573626046379403, 32.084286121030644, 41.015633317331464, 41.15206197897592, 41.30412215894708, 31.345087232689053, 30.958769078056008, 30.9784100751082, 35.908783716460064, 36.016796720524624, 35.9882378441592, 32.76607636859019, 32.37672158082326, 32.66035974522431, 34.5746241658926, 34.756832137703896, 34.90177983045578, 30.843731802888215, 30.461499504745007, 30.621535629034042, 27.3852078517278, 27.314454940458134, 27.72707899504651, 26.333469197154045, 26.977547572925687, 26.93326653726399, 35.20164357125759, 35.91060443423339, 35.69503789395094, 32.51872757573922, 32.74815708522995, 32.07508074243863, 23.040741739173725, 23.218134829153612, 22.906803359587983, 27.706053512791783, 27.81336930083731, 27.476193303863198, 40.07590436190367, 40.4286342933774, 40.1405520811677, 33.75948340694109, 34.09886141369739, 33.90382320682207, 26.324881779650838, 26.217113471279532, 26.196359897653252, 35.90480965872605, 36.74996119419423, 36.447259349127606, 30.613048988704875, 30.664545734723404, 30.289464620252446, 49.26266664763291, 49.73392227788766, 49.6974502702554, 39.25290017450848, 39.107768694559724, 39.139304431776196, -104.08026852210364, -90.13327379276356, -90.15836060543856, 29.74045514625807, 29.6060049769779, 29.714508983617023, 36.88245318333307, 36.54184206823507, 36.779199610153825, 33.01729816446701, 33.24348834777871, 33.09184874842563, 35.18550670146942, 34.90356168150902, 34.83206255733967, 28.908975074688584, 29.10910657296577, 28.754210757712514, 27.31821598112583, 27.344844840466976, 27.464585705660284, 54.36470199314256, 54.34602805351217, 54.44424689219643, 35.04094337423642, 34.97238369037707, 35.18265852316593, 26.2591806401809, 25.836731304725006, 26.591760662694767, 36.61962826550007, 36.1969433426857, 37.06363176216837, 43.83207357426484, 43.981334072848156, 44.53636391491939, 38.13694770882526, 38.191781784097344, 37.80484146873155, 22.904920165737465, 23.642608390500143, 23.774976094563797, 36.69451881200075, 36.77905010059476, 37.03237156166324, 31.773758595188454, 32.439327071731284, 32.51298906219502, 33.25053335602084, 33.13645924876133, 33.13022719199458, 34.292887585858495, 34.35741132746139, 34.17002073178688, 33.3710890735189, 32.28250504533449, 33.73857472008481, 34.72911110209921, 34.79352514787266, 34.548129393408686, 25.41040889918804, 25.181592479348183, 25.311006885021925, 33.61034705241521, 33.441837829848126, 32.23793922861417, 37.95361957202354, 37.87206425021091, 38.24046097851047, 31.857578997810677, 32.07213269670804, 32.138622404386595, 34.98896910250187, 35.63652215898037, 35.151103273034096, 24.4613742592434, 24.015477667252213, 24.122483017543942, 31.615806256731346, 31.739478928347424, 31.694443484147385]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1446206782209309, "mean_inference_ms": 0.690614535322133, "mean_action_processing_ms": 0.10045097771024614, "mean_env_wait_ms": 0.8479725250100255, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 510000, "timesteps_this_iter": 0, "agent_timesteps_total": 1530000, "timers": {"sample_time_ms": 11709.494, "sample_throughput": 427.004, "load_time_ms": 0.3, "load_throughput": 16683786.794, "learn_time_ms": 1592.476, "learn_throughput": 3139.765, "update_time_ms": 7.499}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6940658945086008e-22, "cur_lr": 0.0005000000000000001, "total_loss": 4.933457469940185, "policy_loss": -0.0021319392786951106, "vf_loss": 5.018564653396607, "vf_explained_var": -0.054182910919189455, "kl": 0.0030446795397627716, "entropy": 8.297511100769043, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 510000, "num_agent_steps_sampled": 1530000, "num_steps_trained": 510000, "num_agent_steps_trained": 1530000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1873, "training_iteration": 102, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-27-32", "timestamp": 1706228852, "time_this_iter_s": 11.56784725189209, "time_total_s": 1093.9843218326569, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282552DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1093.9843218326569, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 9.805882352941175, "ram_util_percent": 54.517647058823535}}
{"episode_reward_max": 163.15497693885123, "episode_reward_min": -307.21723604016006, "episode_reward_mean": 87.70355704320313, "episode_len_mean": 492.25, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -111.84954365094504}, "policy_reward_max": {"shared_policy": 54.44424689219643}, "policy_reward_mean": {"shared_policy": 29.234519014401037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [117.98146678949703, 68.39381438493727, 105.71047719568011, 77.32862380519506, 106.60209530964491, 92.41039320640263, 85.45103722531347, 88.24105220101774, 82.70793527737257, 67.37525464966892, 123.84032120462504, 81.6185591481626, 83.76891994476316, 65.7022986933589, 102.19965426903215, 102.69327470473944, 71.51352358609435, 76.6434833779931, 67.36150297895072, 131.96966460347164, 60.66855124710128, 74.16248961631209, -307.21723604016006, 87.44837727583943, 85.0449875295162, 61.05107593163848, 103.56229829788207, 85.32317959517239, 66.07755293510853, 77.30165409296748, 76.68184901587664, 115.7752716965042, 99.35384424775836, 88.03473993390797, 82.16126871760933, 117.71249925345182, 119.98186823725699, 76.09138670563696, 87.81574205448851, 83.33404026925564, 71.1313142105937, 96.18067881464958, 92.28202924970535, 95.26333602517842, 123.47181745525447, 93.28226638585326, 107.91381828114389, 97.80315769463776, 104.23323613405228, 91.92676693666726, 82.42674178723244, 80.24428330734372, 106.80728589944192, 97.3419654034078, 69.16567992791532, 82.99561611749229, 120.64509073644876, 101.76216802746055, 78.73835514858362, 109.10203020204789, 91.56705934368073, 148.69403919577593, 117.4999733008444, -284.37190292030573, 89.060969106853, 110.20349486172196, 99.35263526067135, 104.92113094031811, 86.77229240536687, 82.12764652725309, 163.15497693885123, 105.19598558777942, 78.68767260760067, 109.88020337035414, 132.34977156203223, 114.13357096165416, 70.3225046508014, 110.50594047425875, 96.72607472911476, 99.51721979677674, 102.82031964510676, 99.3921688389382, 104.07076564338055, 75.90300826355815, 99.2901241108775, 114.06614480074492, 96.06833409890531, 105.77659453451633, 72.59933494403955, 95.04972866922616, 108.48829077742994, 99.93849189579484, 92.69829327147453, 110.83570458652683, 108.21902708522975, 105.81301291659472, 105.46369347255676, 124.4620552137494, 85.51953839045018, 94.983383545652], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 51, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 174, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [39.575270018928364, 38.995292025307805, 39.410904745260865, 23.025386733313397, 22.719879140456513, 22.648548511167363, 35.31688670317331, 35.04370393852392, 35.349886553982884, 25.775479125479848, 26.079704305777938, 25.47344037393728, 36.03354961300889, 35.717706518868596, 34.850839177767426, 30.845209288100392, 30.975526899720222, 30.589657018582017, 28.578928233434752, 28.296864209075764, 28.575244782802955, 29.44001989811659, 29.34492570720613, 29.45610659569502, 27.103527704874665, 27.76854523892203, 27.835862333575875, 22.827934206773833, 22.758445156117276, 21.78887528677781, 41.35959226793298, 41.219277555743844, 41.261451380948216, 27.39252020046115, 27.0885401815176, 27.137498766183853, 28.000394533077866, 27.605938444534928, 28.16258696715036, 21.98075272142887, 22.144593112170696, 21.57695285975933, 33.75111066798368, 33.84153702358404, 34.60700657746443, 34.38001380426188, 34.35301212718089, 33.96024877329667, 23.813833797971398, 23.79236344123879, 23.90732634688416, 25.66686963662505, 25.503999795764685, 25.47261394560337, 22.515957621236637, 22.16104172666867, 22.684503631045416, 43.884994755188615, 43.742510373393685, 44.34215947488943, 20.15264382213354, 20.54824401019141, 19.967663414776325, 24.789096332155168, 24.71172076277435, 24.66167252138257, -97.65315329966447, -97.71453908955058, -111.84954365094504, 28.832868372400597, 29.196417366464928, 29.41909153697391, 28.27710576107104, 28.130078946550682, 28.637802821894482, 20.34608317166567, 20.21148068457842, 20.493512075394392, 34.34956919153531, 34.59268696357806, 34.620042142768696, 28.78147742648919, 27.96304992338021, 28.57865224530299, 22.02882360791166, 21.929310039927557, 22.11941928726931, 25.992770003775746, 25.89718564848104, 25.411698440710694, 25.057916690905884, 25.60632636149724, 26.017605963473514, 38.24771375954151, 38.7460942575708, 38.78146367939189, 33.161407694841415, 33.00507403413454, 33.18736251878241, 29.462599230309323, 29.270314161976174, 29.301826541622475, 27.398460557063416, 26.746274580558136, 28.01653357998778, 38.84642939269543, 39.5815944224596, 39.284475438296795, 40.134184313317135, 39.990107220908, 39.85757670303185, 25.358591598769024, 25.51947809507449, 25.21331701179345, 29.165326602756977, 29.614792430307716, 29.035623021423817, 27.6537711545825, 27.911821380257607, 27.76844773441553, 24.071641460061073, 24.04103071242571, 23.01864203810692, 31.817244186997414, 32.072032287716866, 32.2914023399353, 30.714670563737542, 30.518598998586327, 31.048759687381477, 31.605423857768372, 31.573626046379403, 32.084286121030644, 41.015633317331464, 41.15206197897592, 41.30412215894708, 31.345087232689053, 30.958769078056008, 30.9784100751082, 35.908783716460064, 36.016796720524624, 35.9882378441592, 32.76607636859019, 32.37672158082326, 32.66035974522431, 34.5746241658926, 34.756832137703896, 34.90177983045578, 30.843731802888215, 30.461499504745007, 30.621535629034042, 27.3852078517278, 27.314454940458134, 27.72707899504651, 26.333469197154045, 26.977547572925687, 26.93326653726399, 35.20164357125759, 35.91060443423339, 35.69503789395094, 32.51872757573922, 32.74815708522995, 32.07508074243863, 23.040741739173725, 23.218134829153612, 22.906803359587983, 27.706053512791783, 27.81336930083731, 27.476193303863198, 40.07590436190367, 40.4286342933774, 40.1405520811677, 33.75948340694109, 34.09886141369739, 33.90382320682207, 26.324881779650838, 26.217113471279532, 26.196359897653252, 35.90480965872605, 36.74996119419423, 36.447259349127606, 30.613048988704875, 30.664545734723404, 30.289464620252446, 49.26266664763291, 49.73392227788766, 49.6974502702554, 39.25290017450848, 39.107768694559724, 39.139304431776196, -104.08026852210364, -90.13327379276356, -90.15836060543856, 29.74045514625807, 29.6060049769779, 29.714508983617023, 36.88245318333307, 36.54184206823507, 36.779199610153825, 33.01729816446701, 33.24348834777871, 33.09184874842563, 35.18550670146942, 34.90356168150902, 34.83206255733967, 28.908975074688584, 29.10910657296577, 28.754210757712514, 27.31821598112583, 27.344844840466976, 27.464585705660284, 54.36470199314256, 54.34602805351217, 54.44424689219643, 35.04094337423642, 34.97238369037707, 35.18265852316593, 26.2591806401809, 25.836731304725006, 26.591760662694767, 36.61962826550007, 36.1969433426857, 37.06363176216837, 43.83207357426484, 43.981334072848156, 44.53636391491939, 38.13694770882526, 38.191781784097344, 37.80484146873155, 22.904920165737465, 23.642608390500143, 23.774976094563797, 36.69451881200075, 36.77905010059476, 37.03237156166324, 31.773758595188454, 32.439327071731284, 32.51298906219502, 33.25053335602084, 33.13645924876133, 33.13022719199458, 34.292887585858495, 34.35741132746139, 34.17002073178688, 33.3710890735189, 32.28250504533449, 33.73857472008481, 34.72911110209921, 34.79352514787266, 34.548129393408686, 25.41040889918804, 25.181592479348183, 25.311006885021925, 33.61034705241521, 33.441837829848126, 32.23793922861417, 37.95361957202354, 37.87206425021091, 38.24046097851047, 31.857578997810677, 32.07213269670804, 32.138622404386595, 34.98896910250187, 35.63652215898037, 35.151103273034096, 24.4613742592434, 24.015477667252213, 24.122483017543942, 31.615806256731346, 31.739478928347424, 31.694443484147385, 36.530423168092966, 36.53123359568417, 35.4266340136528, 33.22693122426668, 33.32531021783748, 33.38625045369068, 30.23367704947789, 31.297279862997428, 31.167336358999208, 37.01962520073478, 36.7703479056557, 37.045731480136354, 36.226570408791304, 35.5650422424078, 36.42741443403065, 35.19565154860416, 35.331498003254325, 35.28586336473623, 35.29514228304227, 34.89259490122397, 35.275956288290516, 41.62968410303195, 41.38832548757394, 41.44404562314351, 28.32558047771454, 29.30088140349835, 27.89307650923729, 31.508098284403474, 31.563287826875836, 31.911997434372694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14464260707829973, "mean_inference_ms": 0.6908436982948138, "mean_action_processing_ms": 0.10048100038489824, "mean_env_wait_ms": 0.8480014137850699, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 515000, "timesteps_this_iter": 0, "agent_timesteps_total": 1545000, "timers": {"sample_time_ms": 11745.891, "sample_throughput": 425.681, "load_time_ms": 0.4, "load_throughput": 12509108.261, "learn_time_ms": 1597.811, "learn_throughput": 3129.281, "update_time_ms": 7.565}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.470329472543004e-23, "cur_lr": 0.0005000000000000001, "total_loss": 6.837677383422852, "policy_loss": -0.002269346569009745, "vf_loss": 6.9224823951721195, "vf_explained_var": -0.06774300336837769, "kl": 0.0025566178665220873, "entropy": 8.253578567504883, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 515000, "num_agent_steps_sampled": 1545000, "num_steps_trained": 515000, "num_agent_steps_trained": 1545000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1883, "training_iteration": 103, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-27-43", "timestamp": 1706228863, "time_this_iter_s": 11.183600664138794, "time_total_s": 1105.1679224967957, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202823BEDC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1105.1679224967957, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 9.819999999999999, "ram_util_percent": 54.54}}
{"episode_reward_max": 163.15497693885123, "episode_reward_min": -316.0380596667528, "episode_reward_mean": 85.93150815143666, "episode_len_mean": 487.83, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -115.06968170404434}, "policy_reward_max": {"shared_policy": 54.44424689219643}, "policy_reward_mean": {"shared_policy": 28.643836050478882}, "custom_metrics": {}, "hist_stats": {"episode_reward": [81.6185591481626, 83.76891994476316, 65.7022986933589, 102.19965426903215, 102.69327470473944, 71.51352358609435, 76.6434833779931, 67.36150297895072, 131.96966460347164, 60.66855124710128, 74.16248961631209, -307.21723604016006, 87.44837727583943, 85.0449875295162, 61.05107593163848, 103.56229829788207, 85.32317959517239, 66.07755293510853, 77.30165409296748, 76.68184901587664, 115.7752716965042, 99.35384424775836, 88.03473993390797, 82.16126871760933, 117.71249925345182, 119.98186823725699, 76.09138670563696, 87.81574205448851, 83.33404026925564, 71.1313142105937, 96.18067881464958, 92.28202924970535, 95.26333602517842, 123.47181745525447, 93.28226638585326, 107.91381828114389, 97.80315769463776, 104.23323613405228, 91.92676693666726, 82.42674178723244, 80.24428330734372, 106.80728589944192, 97.3419654034078, 69.16567992791532, 82.99561611749229, 120.64509073644876, 101.76216802746055, 78.73835514858362, 109.10203020204789, 91.56705934368073, 148.69403919577593, 117.4999733008444, -284.37190292030573, 89.060969106853, 110.20349486172196, 99.35263526067135, 104.92113094031811, 86.77229240536687, 82.12764652725309, 163.15497693885123, 105.19598558777942, 78.68767260760067, 109.88020337035414, 132.34977156203223, 114.13357096165416, 70.3225046508014, 110.50594047425875, 96.72607472911476, 99.51721979677674, 102.82031964510676, 99.3921688389382, 104.07076564338055, 75.90300826355815, 99.2901241108775, 114.06614480074492, 96.06833409890531, 105.77659453451633, 72.59933494403955, 95.04972866922616, 108.48829077742994, 99.93849189579484, 92.69829327147453, 110.83570458652683, 108.21902708522975, 105.81301291659472, 105.46369347255676, 124.4620552137494, 85.51953839045018, 94.983383545652, 99.74530274420977, 104.14523483812808, 97.62395099550486, 120.37359341979025, 109.82672999799252, 110.35862399684262, 120.9130656942725, 133.04219249822197, 133.4653557017444, -316.0380596667528, 125.38159185275435], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 51, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 174, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 58, 500], "policy_shared_policy_reward": [27.39252020046115, 27.0885401815176, 27.137498766183853, 28.000394533077866, 27.605938444534928, 28.16258696715036, 21.98075272142887, 22.144593112170696, 21.57695285975933, 33.75111066798368, 33.84153702358404, 34.60700657746443, 34.38001380426188, 34.35301212718089, 33.96024877329667, 23.813833797971398, 23.79236344123879, 23.90732634688416, 25.66686963662505, 25.503999795764685, 25.47261394560337, 22.515957621236637, 22.16104172666867, 22.684503631045416, 43.884994755188615, 43.742510373393685, 44.34215947488943, 20.15264382213354, 20.54824401019141, 19.967663414776325, 24.789096332155168, 24.71172076277435, 24.66167252138257, -97.65315329966447, -97.71453908955058, -111.84954365094504, 28.832868372400597, 29.196417366464928, 29.41909153697391, 28.27710576107104, 28.130078946550682, 28.637802821894482, 20.34608317166567, 20.21148068457842, 20.493512075394392, 34.34956919153531, 34.59268696357806, 34.620042142768696, 28.78147742648919, 27.96304992338021, 28.57865224530299, 22.02882360791166, 21.929310039927557, 22.11941928726931, 25.992770003775746, 25.89718564848104, 25.411698440710694, 25.057916690905884, 25.60632636149724, 26.017605963473514, 38.24771375954151, 38.7460942575708, 38.78146367939189, 33.161407694841415, 33.00507403413454, 33.18736251878241, 29.462599230309323, 29.270314161976174, 29.301826541622475, 27.398460557063416, 26.746274580558136, 28.01653357998778, 38.84642939269543, 39.5815944224596, 39.284475438296795, 40.134184313317135, 39.990107220908, 39.85757670303185, 25.358591598769024, 25.51947809507449, 25.21331701179345, 29.165326602756977, 29.614792430307716, 29.035623021423817, 27.6537711545825, 27.911821380257607, 27.76844773441553, 24.071641460061073, 24.04103071242571, 23.01864203810692, 31.817244186997414, 32.072032287716866, 32.2914023399353, 30.714670563737542, 30.518598998586327, 31.048759687381477, 31.605423857768372, 31.573626046379403, 32.084286121030644, 41.015633317331464, 41.15206197897592, 41.30412215894708, 31.345087232689053, 30.958769078056008, 30.9784100751082, 35.908783716460064, 36.016796720524624, 35.9882378441592, 32.76607636859019, 32.37672158082326, 32.66035974522431, 34.5746241658926, 34.756832137703896, 34.90177983045578, 30.843731802888215, 30.461499504745007, 30.621535629034042, 27.3852078517278, 27.314454940458134, 27.72707899504651, 26.333469197154045, 26.977547572925687, 26.93326653726399, 35.20164357125759, 35.91060443423339, 35.69503789395094, 32.51872757573922, 32.74815708522995, 32.07508074243863, 23.040741739173725, 23.218134829153612, 22.906803359587983, 27.706053512791783, 27.81336930083731, 27.476193303863198, 40.07590436190367, 40.4286342933774, 40.1405520811677, 33.75948340694109, 34.09886141369739, 33.90382320682207, 26.324881779650838, 26.217113471279532, 26.196359897653252, 35.90480965872605, 36.74996119419423, 36.447259349127606, 30.613048988704875, 30.664545734723404, 30.289464620252446, 49.26266664763291, 49.73392227788766, 49.6974502702554, 39.25290017450848, 39.107768694559724, 39.139304431776196, -104.08026852210364, -90.13327379276356, -90.15836060543856, 29.74045514625807, 29.6060049769779, 29.714508983617023, 36.88245318333307, 36.54184206823507, 36.779199610153825, 33.01729816446701, 33.24348834777871, 33.09184874842563, 35.18550670146942, 34.90356168150902, 34.83206255733967, 28.908975074688584, 29.10910657296577, 28.754210757712514, 27.31821598112583, 27.344844840466976, 27.464585705660284, 54.36470199314256, 54.34602805351217, 54.44424689219643, 35.04094337423642, 34.97238369037707, 35.18265852316593, 26.2591806401809, 25.836731304725006, 26.591760662694767, 36.61962826550007, 36.1969433426857, 37.06363176216837, 43.83207357426484, 43.981334072848156, 44.53636391491939, 38.13694770882526, 38.191781784097344, 37.80484146873155, 22.904920165737465, 23.642608390500143, 23.774976094563797, 36.69451881200075, 36.77905010059476, 37.03237156166324, 31.773758595188454, 32.439327071731284, 32.51298906219502, 33.25053335602084, 33.13645924876133, 33.13022719199458, 34.292887585858495, 34.35741132746139, 34.17002073178688, 33.3710890735189, 32.28250504533449, 33.73857472008481, 34.72911110209921, 34.79352514787266, 34.548129393408686, 25.41040889918804, 25.181592479348183, 25.311006885021925, 33.61034705241521, 33.441837829848126, 32.23793922861417, 37.95361957202354, 37.87206425021091, 38.24046097851047, 31.857578997810677, 32.07213269670804, 32.138622404386595, 34.98896910250187, 35.63652215898037, 35.151103273034096, 24.4613742592434, 24.015477667252213, 24.122483017543942, 31.615806256731346, 31.739478928347424, 31.694443484147385, 36.530423168092966, 36.53123359568417, 35.4266340136528, 33.22693122426668, 33.32531021783748, 33.38625045369068, 30.23367704947789, 31.297279862997428, 31.167336358999208, 37.01962520073478, 36.7703479056557, 37.045731480136354, 36.226570408791304, 35.5650422424078, 36.42741443403065, 35.19565154860416, 35.331498003254325, 35.28586336473623, 35.29514228304227, 34.89259490122397, 35.275956288290516, 41.62968410303195, 41.38832548757394, 41.44404562314351, 28.32558047771454, 29.30088140349835, 27.89307650923729, 31.508098284403474, 31.563287826875836, 31.911997434372694, 33.105017215013504, 33.24852877110243, 33.391756758093834, 34.73901894440253, 34.53061998387177, 34.87559590985377, 32.79839822649956, 32.72889559715986, 32.096657171845436, 40.06799591084321, 39.92096712191899, 40.384630387028054, 36.348661951720715, 36.7451886869967, 36.7328793592751, 37.038760169564426, 36.54134755084911, 36.77851627642909, 39.89404598375161, 40.35801550497611, 40.661004205544785, 43.974370817343384, 44.60726210909584, 44.46055957178274, 44.60380435983339, 44.48731754968563, 44.37423379222551, -115.06968170404434, -100.4295314103365, -100.53884655237198, 41.40797248482704, 42.005096677690744, 41.96852269023657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14469313034762415, "mean_inference_ms": 0.6909996812760498, "mean_action_processing_ms": 0.10053745547621089, "mean_env_wait_ms": 0.8478559182171789, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 520000, "timesteps_this_iter": 0, "agent_timesteps_total": 1560000, "timers": {"sample_time_ms": 11877.511, "sample_throughput": 420.964, "load_time_ms": 0.4, "load_throughput": 12509108.261, "learn_time_ms": 1604.396, "learn_throughput": 3116.438, "update_time_ms": 7.568}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.235164736271502e-23, "cur_lr": 0.0005000000000000001, "total_loss": 87.8163444519043, "policy_loss": -0.002980776630595791, "vf_loss": 87.90115814208984, "vf_explained_var": 0.04744346141815185, "kl": 0.009353547124210458, "entropy": 8.183225059509278, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 520000, "num_agent_steps_sampled": 1560000, "num_steps_trained": 520000, "num_agent_steps_trained": 1560000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1894, "training_iteration": 104, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-27-55", "timestamp": 1706228875, "time_this_iter_s": 11.764933586120605, "time_total_s": 1116.9328560829163, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202823BE670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1116.9328560829163, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 10.211764705882354, "ram_util_percent": 54.5529411764706}}
{"episode_reward_max": 163.15497693885123, "episode_reward_min": -316.0380596667528, "episode_reward_mean": 88.71429488778065, "episode_len_mean": 487.83, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -115.06968170404434}, "policy_reward_max": {"shared_policy": 54.44424689219643}, "policy_reward_mean": {"shared_policy": 29.571431629260218}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.16248961631209, -307.21723604016006, 87.44837727583943, 85.0449875295162, 61.05107593163848, 103.56229829788207, 85.32317959517239, 66.07755293510853, 77.30165409296748, 76.68184901587664, 115.7752716965042, 99.35384424775836, 88.03473993390797, 82.16126871760933, 117.71249925345182, 119.98186823725699, 76.09138670563696, 87.81574205448851, 83.33404026925564, 71.1313142105937, 96.18067881464958, 92.28202924970535, 95.26333602517842, 123.47181745525447, 93.28226638585326, 107.91381828114389, 97.80315769463776, 104.23323613405228, 91.92676693666726, 82.42674178723244, 80.24428330734372, 106.80728589944192, 97.3419654034078, 69.16567992791532, 82.99561611749229, 120.64509073644876, 101.76216802746055, 78.73835514858362, 109.10203020204789, 91.56705934368073, 148.69403919577593, 117.4999733008444, -284.37190292030573, 89.060969106853, 110.20349486172196, 99.35263526067135, 104.92113094031811, 86.77229240536687, 82.12764652725309, 163.15497693885123, 105.19598558777942, 78.68767260760067, 109.88020337035414, 132.34977156203223, 114.13357096165416, 70.3225046508014, 110.50594047425875, 96.72607472911476, 99.51721979677674, 102.82031964510676, 99.3921688389382, 104.07076564338055, 75.90300826355815, 99.2901241108775, 114.06614480074492, 96.06833409890531, 105.77659453451633, 72.59933494403955, 95.04972866922616, 108.48829077742994, 99.93849189579484, 92.69829327147453, 110.83570458652683, 108.21902708522975, 105.81301291659472, 105.46369347255676, 124.4620552137494, 85.51953839045018, 94.983383545652, 99.74530274420977, 104.14523483812808, 97.62395099550486, 120.37359341979025, 109.82672999799252, 110.35862399684262, 120.9130656942725, 133.04219249822197, 133.4653557017444, -316.0380596667528, 125.38159185275435, 115.69698829855768, 88.04344660509378, 111.21051757410169, 127.24944781884548, 97.04126400593668, 132.31151176616538, 127.33122145570815, 95.67957590892908, 103.49591187387702, 124.35822088085114], "episode_lengths": [500, 51, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 174, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [24.789096332155168, 24.71172076277435, 24.66167252138257, -97.65315329966447, -97.71453908955058, -111.84954365094504, 28.832868372400597, 29.196417366464928, 29.41909153697391, 28.27710576107104, 28.130078946550682, 28.637802821894482, 20.34608317166567, 20.21148068457842, 20.493512075394392, 34.34956919153531, 34.59268696357806, 34.620042142768696, 28.78147742648919, 27.96304992338021, 28.57865224530299, 22.02882360791166, 21.929310039927557, 22.11941928726931, 25.992770003775746, 25.89718564848104, 25.411698440710694, 25.057916690905884, 25.60632636149724, 26.017605963473514, 38.24771375954151, 38.7460942575708, 38.78146367939189, 33.161407694841415, 33.00507403413454, 33.18736251878241, 29.462599230309323, 29.270314161976174, 29.301826541622475, 27.398460557063416, 26.746274580558136, 28.01653357998778, 38.84642939269543, 39.5815944224596, 39.284475438296795, 40.134184313317135, 39.990107220908, 39.85757670303185, 25.358591598769024, 25.51947809507449, 25.21331701179345, 29.165326602756977, 29.614792430307716, 29.035623021423817, 27.6537711545825, 27.911821380257607, 27.76844773441553, 24.071641460061073, 24.04103071242571, 23.01864203810692, 31.817244186997414, 32.072032287716866, 32.2914023399353, 30.714670563737542, 30.518598998586327, 31.048759687381477, 31.605423857768372, 31.573626046379403, 32.084286121030644, 41.015633317331464, 41.15206197897592, 41.30412215894708, 31.345087232689053, 30.958769078056008, 30.9784100751082, 35.908783716460064, 36.016796720524624, 35.9882378441592, 32.76607636859019, 32.37672158082326, 32.66035974522431, 34.5746241658926, 34.756832137703896, 34.90177983045578, 30.843731802888215, 30.461499504745007, 30.621535629034042, 27.3852078517278, 27.314454940458134, 27.72707899504651, 26.333469197154045, 26.977547572925687, 26.93326653726399, 35.20164357125759, 35.91060443423339, 35.69503789395094, 32.51872757573922, 32.74815708522995, 32.07508074243863, 23.040741739173725, 23.218134829153612, 22.906803359587983, 27.706053512791783, 27.81336930083731, 27.476193303863198, 40.07590436190367, 40.4286342933774, 40.1405520811677, 33.75948340694109, 34.09886141369739, 33.90382320682207, 26.324881779650838, 26.217113471279532, 26.196359897653252, 35.90480965872605, 36.74996119419423, 36.447259349127606, 30.613048988704875, 30.664545734723404, 30.289464620252446, 49.26266664763291, 49.73392227788766, 49.6974502702554, 39.25290017450848, 39.107768694559724, 39.139304431776196, -104.08026852210364, -90.13327379276356, -90.15836060543856, 29.74045514625807, 29.6060049769779, 29.714508983617023, 36.88245318333307, 36.54184206823507, 36.779199610153825, 33.01729816446701, 33.24348834777871, 33.09184874842563, 35.18550670146942, 34.90356168150902, 34.83206255733967, 28.908975074688584, 29.10910657296577, 28.754210757712514, 27.31821598112583, 27.344844840466976, 27.464585705660284, 54.36470199314256, 54.34602805351217, 54.44424689219643, 35.04094337423642, 34.97238369037707, 35.18265852316593, 26.2591806401809, 25.836731304725006, 26.591760662694767, 36.61962826550007, 36.1969433426857, 37.06363176216837, 43.83207357426484, 43.981334072848156, 44.53636391491939, 38.13694770882526, 38.191781784097344, 37.80484146873155, 22.904920165737465, 23.642608390500143, 23.774976094563797, 36.69451881200075, 36.77905010059476, 37.03237156166324, 31.773758595188454, 32.439327071731284, 32.51298906219502, 33.25053335602084, 33.13645924876133, 33.13022719199458, 34.292887585858495, 34.35741132746139, 34.17002073178688, 33.3710890735189, 32.28250504533449, 33.73857472008481, 34.72911110209921, 34.79352514787266, 34.548129393408686, 25.41040889918804, 25.181592479348183, 25.311006885021925, 33.61034705241521, 33.441837829848126, 32.23793922861417, 37.95361957202354, 37.87206425021091, 38.24046097851047, 31.857578997810677, 32.07213269670804, 32.138622404386595, 34.98896910250187, 35.63652215898037, 35.151103273034096, 24.4613742592434, 24.015477667252213, 24.122483017543942, 31.615806256731346, 31.739478928347424, 31.694443484147385, 36.530423168092966, 36.53123359568417, 35.4266340136528, 33.22693122426668, 33.32531021783748, 33.38625045369068, 30.23367704947789, 31.297279862997428, 31.167336358999208, 37.01962520073478, 36.7703479056557, 37.045731480136354, 36.226570408791304, 35.5650422424078, 36.42741443403065, 35.19565154860416, 35.331498003254325, 35.28586336473623, 35.29514228304227, 34.89259490122397, 35.275956288290516, 41.62968410303195, 41.38832548757394, 41.44404562314351, 28.32558047771454, 29.30088140349835, 27.89307650923729, 31.508098284403474, 31.563287826875836, 31.911997434372694, 33.105017215013504, 33.24852877110243, 33.391756758093834, 34.73901894440253, 34.53061998387177, 34.87559590985377, 32.79839822649956, 32.72889559715986, 32.096657171845436, 40.06799591084321, 39.92096712191899, 40.384630387028054, 36.348661951720715, 36.7451886869967, 36.7328793592751, 37.038760169564426, 36.54134755084911, 36.77851627642909, 39.89404598375161, 40.35801550497611, 40.661004205544785, 43.974370817343384, 44.60726210909584, 44.46055957178274, 44.60380435983339, 44.48731754968563, 44.37423379222551, -115.06968170404434, -100.4295314103365, -100.53884655237198, 41.40797248482704, 42.005096677690744, 41.96852269023657, 38.68637194142987, 38.35002556194861, 38.6605907951792, 29.172125689685345, 29.175537571310997, 29.695783344097435, 37.32935893908143, 36.56718672811985, 37.313971906900406, 42.394610228637845, 42.23077445725599, 42.62406313295165, 32.201697550714016, 32.60663759801537, 32.2329288572073, 44.13758466641107, 43.97442477444807, 44.19950232530633, 42.148704916238785, 42.33953730762005, 42.84297923184931, 32.20865312839547, 31.466882357994706, 32.00404042253891, 34.26250153283277, 34.860173809031636, 34.37323653201261, 41.617220602308706, 41.404055253913, 41.33694502462943]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1447609071784738, "mean_inference_ms": 0.6914205457689762, "mean_action_processing_ms": 0.10060286786065191, "mean_env_wait_ms": 0.8480113695984521, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 525000, "timesteps_this_iter": 0, "agent_timesteps_total": 1575000, "timers": {"sample_time_ms": 11959.915, "sample_throughput": 418.063, "load_time_ms": 0.3, "load_throughput": 16681132.676, "learn_time_ms": 1612.053, "learn_throughput": 3101.635, "update_time_ms": 7.568}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.235164736271502e-23, "cur_lr": 0.0005000000000000001, "total_loss": 6.375855541229248, "policy_loss": -0.0017852516647226314, "vf_loss": 6.458243322372437, "vf_explained_var": -0.095378577709198, "kl": 0.0030750000151051043, "entropy": 8.060245704650878, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 525000, "num_agent_steps_sampled": 1575000, "num_steps_trained": 525000, "num_agent_steps_trained": 1575000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1904, "training_iteration": 105, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-28-06", "timestamp": 1706228886, "time_this_iter_s": 11.139219284057617, "time_total_s": 1128.0720753669739, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028227A040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1128.0720753669739, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 9.34375, "ram_util_percent": 54.51875}}
{"episode_reward_max": 163.15497693885123, "episode_reward_min": -316.0380596667528, "episode_reward_mean": 96.35861546506591, "episode_len_mean": 492.32, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -115.06968170404434}, "policy_reward_max": {"shared_policy": 54.44424689219643}, "policy_reward_mean": {"shared_policy": 32.1195384883553}, "custom_metrics": {}, "hist_stats": {"episode_reward": [115.7752716965042, 99.35384424775836, 88.03473993390797, 82.16126871760933, 117.71249925345182, 119.98186823725699, 76.09138670563696, 87.81574205448851, 83.33404026925564, 71.1313142105937, 96.18067881464958, 92.28202924970535, 95.26333602517842, 123.47181745525447, 93.28226638585326, 107.91381828114389, 97.80315769463776, 104.23323613405228, 91.92676693666726, 82.42674178723244, 80.24428330734372, 106.80728589944192, 97.3419654034078, 69.16567992791532, 82.99561611749229, 120.64509073644876, 101.76216802746055, 78.73835514858362, 109.10203020204789, 91.56705934368073, 148.69403919577593, 117.4999733008444, -284.37190292030573, 89.060969106853, 110.20349486172196, 99.35263526067135, 104.92113094031811, 86.77229240536687, 82.12764652725309, 163.15497693885123, 105.19598558777942, 78.68767260760067, 109.88020337035414, 132.34977156203223, 114.13357096165416, 70.3225046508014, 110.50594047425875, 96.72607472911476, 99.51721979677674, 102.82031964510676, 99.3921688389382, 104.07076564338055, 75.90300826355815, 99.2901241108775, 114.06614480074492, 96.06833409890531, 105.77659453451633, 72.59933494403955, 95.04972866922616, 108.48829077742994, 99.93849189579484, 92.69829327147453, 110.83570458652683, 108.21902708522975, 105.81301291659472, 105.46369347255676, 124.4620552137494, 85.51953839045018, 94.983383545652, 99.74530274420977, 104.14523483812808, 97.62395099550486, 120.37359341979025, 109.82672999799252, 110.35862399684262, 120.9130656942725, 133.04219249822197, 133.4653557017444, -316.0380596667528, 125.38159185275435, 115.69698829855768, 88.04344660509378, 111.21051757410169, 127.24944781884548, 97.04126400593668, 132.31151176616538, 127.33122145570815, 95.67957590892908, 103.49591187387702, 124.35822088085114, 120.36481075733899, 96.09375498117878, 115.51485852152106, 106.04788133502005, 117.85908069461581, 112.69566632062194, 138.8199036940934, 116.49812393449245, 117.04659646749495, 132.92760927230108], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 174, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [38.24771375954151, 38.7460942575708, 38.78146367939189, 33.161407694841415, 33.00507403413454, 33.18736251878241, 29.462599230309323, 29.270314161976174, 29.301826541622475, 27.398460557063416, 26.746274580558136, 28.01653357998778, 38.84642939269543, 39.5815944224596, 39.284475438296795, 40.134184313317135, 39.990107220908, 39.85757670303185, 25.358591598769024, 25.51947809507449, 25.21331701179345, 29.165326602756977, 29.614792430307716, 29.035623021423817, 27.6537711545825, 27.911821380257607, 27.76844773441553, 24.071641460061073, 24.04103071242571, 23.01864203810692, 31.817244186997414, 32.072032287716866, 32.2914023399353, 30.714670563737542, 30.518598998586327, 31.048759687381477, 31.605423857768372, 31.573626046379403, 32.084286121030644, 41.015633317331464, 41.15206197897592, 41.30412215894708, 31.345087232689053, 30.958769078056008, 30.9784100751082, 35.908783716460064, 36.016796720524624, 35.9882378441592, 32.76607636859019, 32.37672158082326, 32.66035974522431, 34.5746241658926, 34.756832137703896, 34.90177983045578, 30.843731802888215, 30.461499504745007, 30.621535629034042, 27.3852078517278, 27.314454940458134, 27.72707899504651, 26.333469197154045, 26.977547572925687, 26.93326653726399, 35.20164357125759, 35.91060443423339, 35.69503789395094, 32.51872757573922, 32.74815708522995, 32.07508074243863, 23.040741739173725, 23.218134829153612, 22.906803359587983, 27.706053512791783, 27.81336930083731, 27.476193303863198, 40.07590436190367, 40.4286342933774, 40.1405520811677, 33.75948340694109, 34.09886141369739, 33.90382320682207, 26.324881779650838, 26.217113471279532, 26.196359897653252, 35.90480965872605, 36.74996119419423, 36.447259349127606, 30.613048988704875, 30.664545734723404, 30.289464620252446, 49.26266664763291, 49.73392227788766, 49.6974502702554, 39.25290017450848, 39.107768694559724, 39.139304431776196, -104.08026852210364, -90.13327379276356, -90.15836060543856, 29.74045514625807, 29.6060049769779, 29.714508983617023, 36.88245318333307, 36.54184206823507, 36.779199610153825, 33.01729816446701, 33.24348834777871, 33.09184874842563, 35.18550670146942, 34.90356168150902, 34.83206255733967, 28.908975074688584, 29.10910657296577, 28.754210757712514, 27.31821598112583, 27.344844840466976, 27.464585705660284, 54.36470199314256, 54.34602805351217, 54.44424689219643, 35.04094337423642, 34.97238369037707, 35.18265852316593, 26.2591806401809, 25.836731304725006, 26.591760662694767, 36.61962826550007, 36.1969433426857, 37.06363176216837, 43.83207357426484, 43.981334072848156, 44.53636391491939, 38.13694770882526, 38.191781784097344, 37.80484146873155, 22.904920165737465, 23.642608390500143, 23.774976094563797, 36.69451881200075, 36.77905010059476, 37.03237156166324, 31.773758595188454, 32.439327071731284, 32.51298906219502, 33.25053335602084, 33.13645924876133, 33.13022719199458, 34.292887585858495, 34.35741132746139, 34.17002073178688, 33.3710890735189, 32.28250504533449, 33.73857472008481, 34.72911110209921, 34.79352514787266, 34.548129393408686, 25.41040889918804, 25.181592479348183, 25.311006885021925, 33.61034705241521, 33.441837829848126, 32.23793922861417, 37.95361957202354, 37.87206425021091, 38.24046097851047, 31.857578997810677, 32.07213269670804, 32.138622404386595, 34.98896910250187, 35.63652215898037, 35.151103273034096, 24.4613742592434, 24.015477667252213, 24.122483017543942, 31.615806256731346, 31.739478928347424, 31.694443484147385, 36.530423168092966, 36.53123359568417, 35.4266340136528, 33.22693122426668, 33.32531021783748, 33.38625045369068, 30.23367704947789, 31.297279862997428, 31.167336358999208, 37.01962520073478, 36.7703479056557, 37.045731480136354, 36.226570408791304, 35.5650422424078, 36.42741443403065, 35.19565154860416, 35.331498003254325, 35.28586336473623, 35.29514228304227, 34.89259490122397, 35.275956288290516, 41.62968410303195, 41.38832548757394, 41.44404562314351, 28.32558047771454, 29.30088140349835, 27.89307650923729, 31.508098284403474, 31.563287826875836, 31.911997434372694, 33.105017215013504, 33.24852877110243, 33.391756758093834, 34.73901894440253, 34.53061998387177, 34.87559590985377, 32.79839822649956, 32.72889559715986, 32.096657171845436, 40.06799591084321, 39.92096712191899, 40.384630387028054, 36.348661951720715, 36.7451886869967, 36.7328793592751, 37.038760169564426, 36.54134755084911, 36.77851627642909, 39.89404598375161, 40.35801550497611, 40.661004205544785, 43.974370817343384, 44.60726210909584, 44.46055957178274, 44.60380435983339, 44.48731754968563, 44.37423379222551, -115.06968170404434, -100.4295314103365, -100.53884655237198, 41.40797248482704, 42.005096677690744, 41.96852269023657, 38.68637194142987, 38.35002556194861, 38.6605907951792, 29.172125689685345, 29.175537571310997, 29.695783344097435, 37.32935893908143, 36.56718672811985, 37.313971906900406, 42.394610228637845, 42.23077445725599, 42.62406313295165, 32.201697550714016, 32.60663759801537, 32.2329288572073, 44.13758466641107, 43.97442477444807, 44.19950232530633, 42.148704916238785, 42.33953730762005, 42.84297923184931, 32.20865312839547, 31.466882357994706, 32.00404042253891, 34.26250153283277, 34.860173809031636, 34.37323653201261, 41.617220602308706, 41.404055253913, 41.33694502462943, 40.137887670968965, 40.126094538097576, 40.100828548272446, 32.20489292203759, 31.782529657085732, 32.10633240205546, 38.17789007226625, 38.705534918854624, 38.63143353040019, 35.66523802032073, 35.194336888690785, 35.18830642600854, 39.48632689813772, 39.476064952711255, 38.89668884376684, 37.49050487826267, 37.68136818955341, 37.52379325280586, 46.08387362211943, 46.314978171139956, 46.421051900833845, 38.58660027881463, 38.823036072154835, 39.08848758352299, 39.06282307704289, 38.79343019922574, 39.19034319122632, 44.65133463342984, 43.72490343948205, 44.551371199389294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14485557491842913, "mean_inference_ms": 0.6920613657245035, "mean_action_processing_ms": 0.10067384315232164, "mean_env_wait_ms": 0.8483525960807529, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 530000, "timesteps_this_iter": 0, "agent_timesteps_total": 1590000, "timers": {"sample_time_ms": 12017.073, "sample_throughput": 416.075, "load_time_ms": 0.2, "load_throughput": 25010757.305, "learn_time_ms": 1621.85, "learn_throughput": 3082.9, "update_time_ms": 7.568}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.117582368135751e-23, "cur_lr": 0.0005000000000000001, "total_loss": 6.966499137878418, "policy_loss": -0.0011386044038645903, "vf_loss": 7.047990942001343, "vf_explained_var": -0.053666532039642334, "kl": 0.002900763868836774, "entropy": 8.035312461853028, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 530000, "num_agent_steps_sampled": 1590000, "num_steps_trained": 530000, "num_agent_steps_trained": 1590000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1914, "training_iteration": 106, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-28-17", "timestamp": 1706228897, "time_this_iter_s": 10.985595464706421, "time_total_s": 1139.0576708316803, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028227AA60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1139.0576708316803, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 10.053333333333335, "ram_util_percent": 54.56000000000001}}
{"episode_reward_max": 163.15497693885123, "episode_reward_min": -316.0380596667528, "episode_reward_mean": 94.20768075178792, "episode_len_mean": 488.22, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -115.06968170404434}, "policy_reward_max": {"shared_policy": 54.44424689219643}, "policy_reward_mean": {"shared_policy": 31.402560250595972}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.28202924970535, 95.26333602517842, 123.47181745525447, 93.28226638585326, 107.91381828114389, 97.80315769463776, 104.23323613405228, 91.92676693666726, 82.42674178723244, 80.24428330734372, 106.80728589944192, 97.3419654034078, 69.16567992791532, 82.99561611749229, 120.64509073644876, 101.76216802746055, 78.73835514858362, 109.10203020204789, 91.56705934368073, 148.69403919577593, 117.4999733008444, -284.37190292030573, 89.060969106853, 110.20349486172196, 99.35263526067135, 104.92113094031811, 86.77229240536687, 82.12764652725309, 163.15497693885123, 105.19598558777942, 78.68767260760067, 109.88020337035414, 132.34977156203223, 114.13357096165416, 70.3225046508014, 110.50594047425875, 96.72607472911476, 99.51721979677674, 102.82031964510676, 99.3921688389382, 104.07076564338055, 75.90300826355815, 99.2901241108775, 114.06614480074492, 96.06833409890531, 105.77659453451633, 72.59933494403955, 95.04972866922616, 108.48829077742994, 99.93849189579484, 92.69829327147453, 110.83570458652683, 108.21902708522975, 105.81301291659472, 105.46369347255676, 124.4620552137494, 85.51953839045018, 94.983383545652, 99.74530274420977, 104.14523483812808, 97.62395099550486, 120.37359341979025, 109.82672999799252, 110.35862399684262, 120.9130656942725, 133.04219249822197, 133.4653557017444, -316.0380596667528, 125.38159185275435, 115.69698829855768, 88.04344660509378, 111.21051757410169, 127.24944781884548, 97.04126400593668, 132.31151176616538, 127.33122145570815, 95.67957590892908, 103.49591187387702, 124.35822088085114, 120.36481075733899, 96.09375498117878, 115.51485852152106, 106.04788133502005, 117.85908069461581, 112.69566632062194, 138.8199036940934, 116.49812393449245, 117.04659646749495, 132.92760927230108, 142.97627612575894, 102.32700830698013, 92.36667877901345, 120.3529083933681, 84.27370363101362, 120.91474188771097, 116.86929873749614, -302.3953186906874, 104.43100808933377, 134.8353034537285, 105.52757409960029], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 174, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 90, 500, 500, 500], "policy_shared_policy_reward": [30.714670563737542, 30.518598998586327, 31.048759687381477, 31.605423857768372, 31.573626046379403, 32.084286121030644, 41.015633317331464, 41.15206197897592, 41.30412215894708, 31.345087232689053, 30.958769078056008, 30.9784100751082, 35.908783716460064, 36.016796720524624, 35.9882378441592, 32.76607636859019, 32.37672158082326, 32.66035974522431, 34.5746241658926, 34.756832137703896, 34.90177983045578, 30.843731802888215, 30.461499504745007, 30.621535629034042, 27.3852078517278, 27.314454940458134, 27.72707899504651, 26.333469197154045, 26.977547572925687, 26.93326653726399, 35.20164357125759, 35.91060443423339, 35.69503789395094, 32.51872757573922, 32.74815708522995, 32.07508074243863, 23.040741739173725, 23.218134829153612, 22.906803359587983, 27.706053512791783, 27.81336930083731, 27.476193303863198, 40.07590436190367, 40.4286342933774, 40.1405520811677, 33.75948340694109, 34.09886141369739, 33.90382320682207, 26.324881779650838, 26.217113471279532, 26.196359897653252, 35.90480965872605, 36.74996119419423, 36.447259349127606, 30.613048988704875, 30.664545734723404, 30.289464620252446, 49.26266664763291, 49.73392227788766, 49.6974502702554, 39.25290017450848, 39.107768694559724, 39.139304431776196, -104.08026852210364, -90.13327379276356, -90.15836060543856, 29.74045514625807, 29.6060049769779, 29.714508983617023, 36.88245318333307, 36.54184206823507, 36.779199610153825, 33.01729816446701, 33.24348834777871, 33.09184874842563, 35.18550670146942, 34.90356168150902, 34.83206255733967, 28.908975074688584, 29.10910657296577, 28.754210757712514, 27.31821598112583, 27.344844840466976, 27.464585705660284, 54.36470199314256, 54.34602805351217, 54.44424689219643, 35.04094337423642, 34.97238369037707, 35.18265852316593, 26.2591806401809, 25.836731304725006, 26.591760662694767, 36.61962826550007, 36.1969433426857, 37.06363176216837, 43.83207357426484, 43.981334072848156, 44.53636391491939, 38.13694770882526, 38.191781784097344, 37.80484146873155, 22.904920165737465, 23.642608390500143, 23.774976094563797, 36.69451881200075, 36.77905010059476, 37.03237156166324, 31.773758595188454, 32.439327071731284, 32.51298906219502, 33.25053335602084, 33.13645924876133, 33.13022719199458, 34.292887585858495, 34.35741132746139, 34.17002073178688, 33.3710890735189, 32.28250504533449, 33.73857472008481, 34.72911110209921, 34.79352514787266, 34.548129393408686, 25.41040889918804, 25.181592479348183, 25.311006885021925, 33.61034705241521, 33.441837829848126, 32.23793922861417, 37.95361957202354, 37.87206425021091, 38.24046097851047, 31.857578997810677, 32.07213269670804, 32.138622404386595, 34.98896910250187, 35.63652215898037, 35.151103273034096, 24.4613742592434, 24.015477667252213, 24.122483017543942, 31.615806256731346, 31.739478928347424, 31.694443484147385, 36.530423168092966, 36.53123359568417, 35.4266340136528, 33.22693122426668, 33.32531021783748, 33.38625045369068, 30.23367704947789, 31.297279862997428, 31.167336358999208, 37.01962520073478, 36.7703479056557, 37.045731480136354, 36.226570408791304, 35.5650422424078, 36.42741443403065, 35.19565154860416, 35.331498003254325, 35.28586336473623, 35.29514228304227, 34.89259490122397, 35.275956288290516, 41.62968410303195, 41.38832548757394, 41.44404562314351, 28.32558047771454, 29.30088140349835, 27.89307650923729, 31.508098284403474, 31.563287826875836, 31.911997434372694, 33.105017215013504, 33.24852877110243, 33.391756758093834, 34.73901894440253, 34.53061998387177, 34.87559590985377, 32.79839822649956, 32.72889559715986, 32.096657171845436, 40.06799591084321, 39.92096712191899, 40.384630387028054, 36.348661951720715, 36.7451886869967, 36.7328793592751, 37.038760169564426, 36.54134755084911, 36.77851627642909, 39.89404598375161, 40.35801550497611, 40.661004205544785, 43.974370817343384, 44.60726210909584, 44.46055957178274, 44.60380435983339, 44.48731754968563, 44.37423379222551, -115.06968170404434, -100.4295314103365, -100.53884655237198, 41.40797248482704, 42.005096677690744, 41.96852269023657, 38.68637194142987, 38.35002556194861, 38.6605907951792, 29.172125689685345, 29.175537571310997, 29.695783344097435, 37.32935893908143, 36.56718672811985, 37.313971906900406, 42.394610228637845, 42.23077445725599, 42.62406313295165, 32.201697550714016, 32.60663759801537, 32.2329288572073, 44.13758466641107, 43.97442477444807, 44.19950232530633, 42.148704916238785, 42.33953730762005, 42.84297923184931, 32.20865312839547, 31.466882357994706, 32.00404042253891, 34.26250153283277, 34.860173809031636, 34.37323653201261, 41.617220602308706, 41.404055253913, 41.33694502462943, 40.137887670968965, 40.126094538097576, 40.100828548272446, 32.20489292203759, 31.782529657085732, 32.10633240205546, 38.17789007226625, 38.705534918854624, 38.63143353040019, 35.66523802032073, 35.194336888690785, 35.18830642600854, 39.48632689813772, 39.476064952711255, 38.89668884376684, 37.49050487826267, 37.68136818955341, 37.52379325280586, 46.08387362211943, 46.314978171139956, 46.421051900833845, 38.58660027881463, 38.823036072154835, 39.08848758352299, 39.06282307704289, 38.79343019922574, 39.19034319122632, 44.65133463342984, 43.72490343948205, 44.551371199389294, 47.60825903962056, 47.65368347863357, 47.71433360750477, 34.119820676743984, 34.09884958341718, 34.10833804681897, 30.51400814950466, 30.77542719244957, 31.077243437059224, 40.424221717442066, 39.82496031622091, 40.10372635970512, 28.000471291442707, 28.297887125362948, 27.975345214207962, 39.95703875025113, 40.43961838756998, 40.518084749889866, 38.88273115456104, 38.959866689518094, 39.026700893417, -103.1777037618061, -105.68111618359885, -93.5364987452825, 34.619220808148384, 34.913759004324675, 34.898028276860714, 44.92764429499705, 44.85758253683646, 45.05007662189503, 35.19962243611613, 35.17687192062536, 35.1510797428588]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14495901639220388, "mean_inference_ms": 0.692409628222506, "mean_action_processing_ms": 0.10075630090492944, "mean_env_wait_ms": 0.8482849223253305, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 535000, "timesteps_this_iter": 0, "agent_timesteps_total": 1605000, "timers": {"sample_time_ms": 12081.562, "sample_throughput": 413.854, "load_time_ms": 0.2, "load_throughput": 25010757.305, "learn_time_ms": 1631.474, "learn_throughput": 3064.713, "update_time_ms": 7.67}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0587911840678755e-23, "cur_lr": 0.0005000000000000001, "total_loss": 108.47021560668945, "policy_loss": -0.0032089161197157877, "vf_loss": 108.55368347167969, "vf_explained_var": 0.03795217275619507, "kl": 0.0045343979029157325, "entropy": 8.026531553268432, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 535000, "num_agent_steps_sampled": 1605000, "num_steps_trained": 535000, "num_agent_steps_trained": 1605000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1925, "training_iteration": 107, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-28-28", "timestamp": 1706228908, "time_this_iter_s": 10.993036031723022, "time_total_s": 1150.0507068634033, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282542700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1150.0507068634033, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 10.8, "ram_util_percent": 54.6}}
{"episode_reward_max": 163.15497693885123, "episode_reward_min": -316.0380596667528, "episode_reward_mean": 96.17167822536497, "episode_len_mean": 488.22, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -115.06968170404434}, "policy_reward_max": {"shared_policy": 54.44424689219643}, "policy_reward_mean": {"shared_policy": 32.057226075121655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.80728589944192, 97.3419654034078, 69.16567992791532, 82.99561611749229, 120.64509073644876, 101.76216802746055, 78.73835514858362, 109.10203020204789, 91.56705934368073, 148.69403919577593, 117.4999733008444, -284.37190292030573, 89.060969106853, 110.20349486172196, 99.35263526067135, 104.92113094031811, 86.77229240536687, 82.12764652725309, 163.15497693885123, 105.19598558777942, 78.68767260760067, 109.88020337035414, 132.34977156203223, 114.13357096165416, 70.3225046508014, 110.50594047425875, 96.72607472911476, 99.51721979677674, 102.82031964510676, 99.3921688389382, 104.07076564338055, 75.90300826355815, 99.2901241108775, 114.06614480074492, 96.06833409890531, 105.77659453451633, 72.59933494403955, 95.04972866922616, 108.48829077742994, 99.93849189579484, 92.69829327147453, 110.83570458652683, 108.21902708522975, 105.81301291659472, 105.46369347255676, 124.4620552137494, 85.51953839045018, 94.983383545652, 99.74530274420977, 104.14523483812808, 97.62395099550486, 120.37359341979025, 109.82672999799252, 110.35862399684262, 120.9130656942725, 133.04219249822197, 133.4653557017444, -316.0380596667528, 125.38159185275435, 115.69698829855768, 88.04344660509378, 111.21051757410169, 127.24944781884548, 97.04126400593668, 132.31151176616538, 127.33122145570815, 95.67957590892908, 103.49591187387702, 124.35822088085114, 120.36481075733899, 96.09375498117878, 115.51485852152106, 106.04788133502005, 117.85908069461581, 112.69566632062194, 138.8199036940934, 116.49812393449245, 117.04659646749495, 132.92760927230108, 142.97627612575894, 102.32700830698013, 92.36667877901345, 120.3529083933681, 84.27370363101362, 120.91474188771097, 116.86929873749614, -302.3953186906874, 104.43100808933377, 134.8353034537285, 105.52757409960029, 100.07726322114466, 124.2111614551395, 121.85254524089395, 135.497797742486, 70.9424480088055, 130.73072972893706, 149.50170758366576, 112.97054562810807, 105.36394161917269, 114.09906038641928], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 174, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 90, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [35.20164357125759, 35.91060443423339, 35.69503789395094, 32.51872757573922, 32.74815708522995, 32.07508074243863, 23.040741739173725, 23.218134829153612, 22.906803359587983, 27.706053512791783, 27.81336930083731, 27.476193303863198, 40.07590436190367, 40.4286342933774, 40.1405520811677, 33.75948340694109, 34.09886141369739, 33.90382320682207, 26.324881779650838, 26.217113471279532, 26.196359897653252, 35.90480965872605, 36.74996119419423, 36.447259349127606, 30.613048988704875, 30.664545734723404, 30.289464620252446, 49.26266664763291, 49.73392227788766, 49.6974502702554, 39.25290017450848, 39.107768694559724, 39.139304431776196, -104.08026852210364, -90.13327379276356, -90.15836060543856, 29.74045514625807, 29.6060049769779, 29.714508983617023, 36.88245318333307, 36.54184206823507, 36.779199610153825, 33.01729816446701, 33.24348834777871, 33.09184874842563, 35.18550670146942, 34.90356168150902, 34.83206255733967, 28.908975074688584, 29.10910657296577, 28.754210757712514, 27.31821598112583, 27.344844840466976, 27.464585705660284, 54.36470199314256, 54.34602805351217, 54.44424689219643, 35.04094337423642, 34.97238369037707, 35.18265852316593, 26.2591806401809, 25.836731304725006, 26.591760662694767, 36.61962826550007, 36.1969433426857, 37.06363176216837, 43.83207357426484, 43.981334072848156, 44.53636391491939, 38.13694770882526, 38.191781784097344, 37.80484146873155, 22.904920165737465, 23.642608390500143, 23.774976094563797, 36.69451881200075, 36.77905010059476, 37.03237156166324, 31.773758595188454, 32.439327071731284, 32.51298906219502, 33.25053335602084, 33.13645924876133, 33.13022719199458, 34.292887585858495, 34.35741132746139, 34.17002073178688, 33.3710890735189, 32.28250504533449, 33.73857472008481, 34.72911110209921, 34.79352514787266, 34.548129393408686, 25.41040889918804, 25.181592479348183, 25.311006885021925, 33.61034705241521, 33.441837829848126, 32.23793922861417, 37.95361957202354, 37.87206425021091, 38.24046097851047, 31.857578997810677, 32.07213269670804, 32.138622404386595, 34.98896910250187, 35.63652215898037, 35.151103273034096, 24.4613742592434, 24.015477667252213, 24.122483017543942, 31.615806256731346, 31.739478928347424, 31.694443484147385, 36.530423168092966, 36.53123359568417, 35.4266340136528, 33.22693122426668, 33.32531021783748, 33.38625045369068, 30.23367704947789, 31.297279862997428, 31.167336358999208, 37.01962520073478, 36.7703479056557, 37.045731480136354, 36.226570408791304, 35.5650422424078, 36.42741443403065, 35.19565154860416, 35.331498003254325, 35.28586336473623, 35.29514228304227, 34.89259490122397, 35.275956288290516, 41.62968410303195, 41.38832548757394, 41.44404562314351, 28.32558047771454, 29.30088140349835, 27.89307650923729, 31.508098284403474, 31.563287826875836, 31.911997434372694, 33.105017215013504, 33.24852877110243, 33.391756758093834, 34.73901894440253, 34.53061998387177, 34.87559590985377, 32.79839822649956, 32.72889559715986, 32.096657171845436, 40.06799591084321, 39.92096712191899, 40.384630387028054, 36.348661951720715, 36.7451886869967, 36.7328793592751, 37.038760169564426, 36.54134755084911, 36.77851627642909, 39.89404598375161, 40.35801550497611, 40.661004205544785, 43.974370817343384, 44.60726210909584, 44.46055957178274, 44.60380435983339, 44.48731754968563, 44.37423379222551, -115.06968170404434, -100.4295314103365, -100.53884655237198, 41.40797248482704, 42.005096677690744, 41.96852269023657, 38.68637194142987, 38.35002556194861, 38.6605907951792, 29.172125689685345, 29.175537571310997, 29.695783344097435, 37.32935893908143, 36.56718672811985, 37.313971906900406, 42.394610228637845, 42.23077445725599, 42.62406313295165, 32.201697550714016, 32.60663759801537, 32.2329288572073, 44.13758466641107, 43.97442477444807, 44.19950232530633, 42.148704916238785, 42.33953730762005, 42.84297923184931, 32.20865312839547, 31.466882357994706, 32.00404042253891, 34.26250153283277, 34.860173809031636, 34.37323653201261, 41.617220602308706, 41.404055253913, 41.33694502462943, 40.137887670968965, 40.126094538097576, 40.100828548272446, 32.20489292203759, 31.782529657085732, 32.10633240205546, 38.17789007226625, 38.705534918854624, 38.63143353040019, 35.66523802032073, 35.194336888690785, 35.18830642600854, 39.48632689813772, 39.476064952711255, 38.89668884376684, 37.49050487826267, 37.68136818955341, 37.52379325280586, 46.08387362211943, 46.314978171139956, 46.421051900833845, 38.58660027881463, 38.823036072154835, 39.08848758352299, 39.06282307704289, 38.79343019922574, 39.19034319122632, 44.65133463342984, 43.72490343948205, 44.551371199389294, 47.60825903962056, 47.65368347863357, 47.71433360750477, 34.119820676743984, 34.09884958341718, 34.10833804681897, 30.51400814950466, 30.77542719244957, 31.077243437059224, 40.424221717442066, 39.82496031622091, 40.10372635970512, 28.000471291442707, 28.297887125362948, 27.975345214207962, 39.95703875025113, 40.43961838756998, 40.518084749889866, 38.88273115456104, 38.959866689518094, 39.026700893417, -103.1777037618061, -105.68111618359885, -93.5364987452825, 34.619220808148384, 34.913759004324675, 34.898028276860714, 44.92764429499705, 44.85758253683646, 45.05007662189503, 35.19962243611613, 35.17687192062536, 35.1510797428588, 33.412726118539766, 33.270710350324705, 33.39382675228019, 41.48287762639423, 41.28221060832341, 41.446073220421866, 40.65402778362234, 40.496140388151005, 40.7023770691206, 44.80669317642847, 45.34391665707031, 45.347187908987195, 23.947655783345297, 23.535367009540394, 23.459425215919808, 43.60770082473755, 43.54509229212999, 43.57793661206961, 50.094115284581974, 49.62785508235295, 49.77973721673091, 37.77210072645296, 37.73287123565872, 37.46557366599639, 35.21436722576618, 35.4045621547848, 34.74501223862171, 37.95577623446782, 38.106579562028244, 38.03670458992322]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14507027764262467, "mean_inference_ms": 0.6930111516821799, "mean_action_processing_ms": 0.10084596388922551, "mean_env_wait_ms": 0.8485178699502495, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 540000, "timesteps_this_iter": 0, "agent_timesteps_total": 1620000, "timers": {"sample_time_ms": 12174.601, "sample_throughput": 410.691, "load_time_ms": 0.2, "load_throughput": 25010757.305, "learn_time_ms": 1641.159, "learn_throughput": 3046.628, "update_time_ms": 8.123}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.2939559203393774e-24, "cur_lr": 0.0005000000000000001, "total_loss": 8.147764873504638, "policy_loss": -0.0018584811622928798, "vf_loss": 8.229604625701905, "vf_explained_var": -0.12488934993743897, "kl": 0.0029689840157680813, "entropy": 7.998124694824218, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 540000, "num_agent_steps_sampled": 1620000, "num_steps_trained": 540000, "num_agent_steps_trained": 1620000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1935, "training_iteration": 108, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-28-39", "timestamp": 1706228919, "time_this_iter_s": 11.235260963439941, "time_total_s": 1161.2859678268433, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202846E4310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1161.2859678268433, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 10.41875, "ram_util_percent": 54.706250000000004}}
{"episode_reward_max": 163.15497693885123, "episode_reward_min": -316.0380596667528, "episode_reward_mean": 97.97831950851287, "episode_len_mean": 488.22, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -115.06968170404434}, "policy_reward_max": {"shared_policy": 54.44424689219643}, "policy_reward_mean": {"shared_policy": 32.659439836170954}, "custom_metrics": {}, "hist_stats": {"episode_reward": [117.4999733008444, -284.37190292030573, 89.060969106853, 110.20349486172196, 99.35263526067135, 104.92113094031811, 86.77229240536687, 82.12764652725309, 163.15497693885123, 105.19598558777942, 78.68767260760067, 109.88020337035414, 132.34977156203223, 114.13357096165416, 70.3225046508014, 110.50594047425875, 96.72607472911476, 99.51721979677674, 102.82031964510676, 99.3921688389382, 104.07076564338055, 75.90300826355815, 99.2901241108775, 114.06614480074492, 96.06833409890531, 105.77659453451633, 72.59933494403955, 95.04972866922616, 108.48829077742994, 99.93849189579484, 92.69829327147453, 110.83570458652683, 108.21902708522975, 105.81301291659472, 105.46369347255676, 124.4620552137494, 85.51953839045018, 94.983383545652, 99.74530274420977, 104.14523483812808, 97.62395099550486, 120.37359341979025, 109.82672999799252, 110.35862399684262, 120.9130656942725, 133.04219249822197, 133.4653557017444, -316.0380596667528, 125.38159185275435, 115.69698829855768, 88.04344660509378, 111.21051757410169, 127.24944781884548, 97.04126400593668, 132.31151176616538, 127.33122145570815, 95.67957590892908, 103.49591187387702, 124.35822088085114, 120.36481075733899, 96.09375498117878, 115.51485852152106, 106.04788133502005, 117.85908069461581, 112.69566632062194, 138.8199036940934, 116.49812393449245, 117.04659646749495, 132.92760927230108, 142.97627612575894, 102.32700830698013, 92.36667877901345, 120.3529083933681, 84.27370363101362, 120.91474188771097, 116.86929873749614, -302.3953186906874, 104.43100808933377, 134.8353034537285, 105.52757409960029, 100.07726322114466, 124.2111614551395, 121.85254524089395, 135.497797742486, 70.9424480088055, 130.73072972893706, 149.50170758366576, 112.97054562810807, 105.36394161917269, 114.09906038641928, 130.10945206135506, 130.36885790154335, 127.10486770793793, 108.06648107804358, 121.5767654716037, 106.84122193977235, 99.2028010264039, 125.10365475714205, 131.5583513919263, 107.55096498131752], "episode_lengths": [500, 174, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 90, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [39.25290017450848, 39.107768694559724, 39.139304431776196, -104.08026852210364, -90.13327379276356, -90.15836060543856, 29.74045514625807, 29.6060049769779, 29.714508983617023, 36.88245318333307, 36.54184206823507, 36.779199610153825, 33.01729816446701, 33.24348834777871, 33.09184874842563, 35.18550670146942, 34.90356168150902, 34.83206255733967, 28.908975074688584, 29.10910657296577, 28.754210757712514, 27.31821598112583, 27.344844840466976, 27.464585705660284, 54.36470199314256, 54.34602805351217, 54.44424689219643, 35.04094337423642, 34.97238369037707, 35.18265852316593, 26.2591806401809, 25.836731304725006, 26.591760662694767, 36.61962826550007, 36.1969433426857, 37.06363176216837, 43.83207357426484, 43.981334072848156, 44.53636391491939, 38.13694770882526, 38.191781784097344, 37.80484146873155, 22.904920165737465, 23.642608390500143, 23.774976094563797, 36.69451881200075, 36.77905010059476, 37.03237156166324, 31.773758595188454, 32.439327071731284, 32.51298906219502, 33.25053335602084, 33.13645924876133, 33.13022719199458, 34.292887585858495, 34.35741132746139, 34.17002073178688, 33.3710890735189, 32.28250504533449, 33.73857472008481, 34.72911110209921, 34.79352514787266, 34.548129393408686, 25.41040889918804, 25.181592479348183, 25.311006885021925, 33.61034705241521, 33.441837829848126, 32.23793922861417, 37.95361957202354, 37.87206425021091, 38.24046097851047, 31.857578997810677, 32.07213269670804, 32.138622404386595, 34.98896910250187, 35.63652215898037, 35.151103273034096, 24.4613742592434, 24.015477667252213, 24.122483017543942, 31.615806256731346, 31.739478928347424, 31.694443484147385, 36.530423168092966, 36.53123359568417, 35.4266340136528, 33.22693122426668, 33.32531021783748, 33.38625045369068, 30.23367704947789, 31.297279862997428, 31.167336358999208, 37.01962520073478, 36.7703479056557, 37.045731480136354, 36.226570408791304, 35.5650422424078, 36.42741443403065, 35.19565154860416, 35.331498003254325, 35.28586336473623, 35.29514228304227, 34.89259490122397, 35.275956288290516, 41.62968410303195, 41.38832548757394, 41.44404562314351, 28.32558047771454, 29.30088140349835, 27.89307650923729, 31.508098284403474, 31.563287826875836, 31.911997434372694, 33.105017215013504, 33.24852877110243, 33.391756758093834, 34.73901894440253, 34.53061998387177, 34.87559590985377, 32.79839822649956, 32.72889559715986, 32.096657171845436, 40.06799591084321, 39.92096712191899, 40.384630387028054, 36.348661951720715, 36.7451886869967, 36.7328793592751, 37.038760169564426, 36.54134755084911, 36.77851627642909, 39.89404598375161, 40.35801550497611, 40.661004205544785, 43.974370817343384, 44.60726210909584, 44.46055957178274, 44.60380435983339, 44.48731754968563, 44.37423379222551, -115.06968170404434, -100.4295314103365, -100.53884655237198, 41.40797248482704, 42.005096677690744, 41.96852269023657, 38.68637194142987, 38.35002556194861, 38.6605907951792, 29.172125689685345, 29.175537571310997, 29.695783344097435, 37.32935893908143, 36.56718672811985, 37.313971906900406, 42.394610228637845, 42.23077445725599, 42.62406313295165, 32.201697550714016, 32.60663759801537, 32.2329288572073, 44.13758466641107, 43.97442477444807, 44.19950232530633, 42.148704916238785, 42.33953730762005, 42.84297923184931, 32.20865312839547, 31.466882357994706, 32.00404042253891, 34.26250153283277, 34.860173809031636, 34.37323653201261, 41.617220602308706, 41.404055253913, 41.33694502462943, 40.137887670968965, 40.126094538097576, 40.100828548272446, 32.20489292203759, 31.782529657085732, 32.10633240205546, 38.17789007226625, 38.705534918854624, 38.63143353040019, 35.66523802032073, 35.194336888690785, 35.18830642600854, 39.48632689813772, 39.476064952711255, 38.89668884376684, 37.49050487826267, 37.68136818955341, 37.52379325280586, 46.08387362211943, 46.314978171139956, 46.421051900833845, 38.58660027881463, 38.823036072154835, 39.08848758352299, 39.06282307704289, 38.79343019922574, 39.19034319122632, 44.65133463342984, 43.72490343948205, 44.551371199389294, 47.60825903962056, 47.65368347863357, 47.71433360750477, 34.119820676743984, 34.09884958341718, 34.10833804681897, 30.51400814950466, 30.77542719244957, 31.077243437059224, 40.424221717442066, 39.82496031622091, 40.10372635970512, 28.000471291442707, 28.297887125362948, 27.975345214207962, 39.95703875025113, 40.43961838756998, 40.518084749889866, 38.88273115456104, 38.959866689518094, 39.026700893417, -103.1777037618061, -105.68111618359885, -93.5364987452825, 34.619220808148384, 34.913759004324675, 34.898028276860714, 44.92764429499705, 44.85758253683646, 45.05007662189503, 35.19962243611613, 35.17687192062536, 35.1510797428588, 33.412726118539766, 33.270710350324705, 33.39382675228019, 41.48287762639423, 41.28221060832341, 41.446073220421866, 40.65402778362234, 40.496140388151005, 40.7023770691206, 44.80669317642847, 45.34391665707031, 45.347187908987195, 23.947655783345297, 23.535367009540394, 23.459425215919808, 43.60770082473755, 43.54509229212999, 43.57793661206961, 50.094115284581974, 49.62785508235295, 49.77973721673091, 37.77210072645296, 37.73287123565872, 37.46557366599639, 35.21436722576618, 35.4045621547848, 34.74501223862171, 37.95577623446782, 38.106579562028244, 38.03670458992322, 43.2771350989739, 43.37629476437965, 43.456022198001534, 43.724959410727024, 43.093262419104576, 43.55063607171178, 42.0611322770516, 42.50532853479186, 42.53840689609447, 35.797756642103195, 35.92041625827551, 36.348308177664876, 40.742024135465414, 40.10696044067541, 40.72778089546287, 35.772380140920475, 35.02625795205434, 36.04258384679754, 33.06370558217168, 33.03080214187503, 33.1082933023572, 41.681739566226796, 41.55332750578721, 41.86858768512805, 43.58607349793115, 43.80239678422609, 44.169881109769136, 35.574137553572655, 35.96896728873253, 36.00786013901234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14519749117781233, "mean_inference_ms": 0.6936849080915586, "mean_action_processing_ms": 0.10095633646000718, "mean_env_wait_ms": 0.8487870951913454, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 545000, "timesteps_this_iter": 0, "agent_timesteps_total": 1635000, "timers": {"sample_time_ms": 12268.408, "sample_throughput": 407.551, "load_time_ms": 0.2, "load_throughput": 25010757.305, "learn_time_ms": 1649.361, "learn_throughput": 3031.476, "update_time_ms": 8.075}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.6469779601696887e-24, "cur_lr": 0.0005000000000000001, "total_loss": 6.857710981369019, "policy_loss": -0.002578928685709769, "vf_loss": 6.940277099609375, "vf_explained_var": -0.12798590660095216, "kl": 0.0030033996212466283, "entropy": 7.998703908920288, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 545000, "num_agent_steps_sampled": 1635000, "num_steps_trained": 545000, "num_agent_steps_trained": 1635000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1945, "training_iteration": 109, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-28-51", "timestamp": 1706228931, "time_this_iter_s": 11.442772388458252, "time_total_s": 1172.7287402153015, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028458AEE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1172.7287402153015, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 11.45, "ram_util_percent": 54.63125}}
{"episode_reward_max": 149.50170758366576, "episode_reward_min": -316.0380596667528, "episode_reward_mean": 103.28081424667303, "episode_len_mean": 491.48, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -115.06968170404434}, "policy_reward_max": {"shared_policy": 50.094115284581974}, "policy_reward_mean": {"shared_policy": 34.42693808222434}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.68767260760067, 109.88020337035414, 132.34977156203223, 114.13357096165416, 70.3225046508014, 110.50594047425875, 96.72607472911476, 99.51721979677674, 102.82031964510676, 99.3921688389382, 104.07076564338055, 75.90300826355815, 99.2901241108775, 114.06614480074492, 96.06833409890531, 105.77659453451633, 72.59933494403955, 95.04972866922616, 108.48829077742994, 99.93849189579484, 92.69829327147453, 110.83570458652683, 108.21902708522975, 105.81301291659472, 105.46369347255676, 124.4620552137494, 85.51953839045018, 94.983383545652, 99.74530274420977, 104.14523483812808, 97.62395099550486, 120.37359341979025, 109.82672999799252, 110.35862399684262, 120.9130656942725, 133.04219249822197, 133.4653557017444, -316.0380596667528, 125.38159185275435, 115.69698829855768, 88.04344660509378, 111.21051757410169, 127.24944781884548, 97.04126400593668, 132.31151176616538, 127.33122145570815, 95.67957590892908, 103.49591187387702, 124.35822088085114, 120.36481075733899, 96.09375498117878, 115.51485852152106, 106.04788133502005, 117.85908069461581, 112.69566632062194, 138.8199036940934, 116.49812393449245, 117.04659646749495, 132.92760927230108, 142.97627612575894, 102.32700830698013, 92.36667877901345, 120.3529083933681, 84.27370363101362, 120.91474188771097, 116.86929873749614, -302.3953186906874, 104.43100808933377, 134.8353034537285, 105.52757409960029, 100.07726322114466, 124.2111614551395, 121.85254524089395, 135.497797742486, 70.9424480088055, 130.73072972893706, 149.50170758366576, 112.97054562810807, 105.36394161917269, 114.09906038641928, 130.10945206135506, 130.36885790154335, 127.10486770793793, 108.06648107804358, 121.5767654716037, 106.84122193977235, 99.2028010264039, 125.10365475714205, 131.5583513919263, 107.55096498131752, 107.75731501728296, 71.7606046590954, 117.40869555994867, 148.75971422344455, 136.50356616079813, 109.53692232072353, 135.26056125015012, 147.27619397640225, 99.8839104976505, 130.0191921598743], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 90, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [26.2591806401809, 25.836731304725006, 26.591760662694767, 36.61962826550007, 36.1969433426857, 37.06363176216837, 43.83207357426484, 43.981334072848156, 44.53636391491939, 38.13694770882526, 38.191781784097344, 37.80484146873155, 22.904920165737465, 23.642608390500143, 23.774976094563797, 36.69451881200075, 36.77905010059476, 37.03237156166324, 31.773758595188454, 32.439327071731284, 32.51298906219502, 33.25053335602084, 33.13645924876133, 33.13022719199458, 34.292887585858495, 34.35741132746139, 34.17002073178688, 33.3710890735189, 32.28250504533449, 33.73857472008481, 34.72911110209921, 34.79352514787266, 34.548129393408686, 25.41040889918804, 25.181592479348183, 25.311006885021925, 33.61034705241521, 33.441837829848126, 32.23793922861417, 37.95361957202354, 37.87206425021091, 38.24046097851047, 31.857578997810677, 32.07213269670804, 32.138622404386595, 34.98896910250187, 35.63652215898037, 35.151103273034096, 24.4613742592434, 24.015477667252213, 24.122483017543942, 31.615806256731346, 31.739478928347424, 31.694443484147385, 36.530423168092966, 36.53123359568417, 35.4266340136528, 33.22693122426668, 33.32531021783748, 33.38625045369068, 30.23367704947789, 31.297279862997428, 31.167336358999208, 37.01962520073478, 36.7703479056557, 37.045731480136354, 36.226570408791304, 35.5650422424078, 36.42741443403065, 35.19565154860416, 35.331498003254325, 35.28586336473623, 35.29514228304227, 34.89259490122397, 35.275956288290516, 41.62968410303195, 41.38832548757394, 41.44404562314351, 28.32558047771454, 29.30088140349835, 27.89307650923729, 31.508098284403474, 31.563287826875836, 31.911997434372694, 33.105017215013504, 33.24852877110243, 33.391756758093834, 34.73901894440253, 34.53061998387177, 34.87559590985377, 32.79839822649956, 32.72889559715986, 32.096657171845436, 40.06799591084321, 39.92096712191899, 40.384630387028054, 36.348661951720715, 36.7451886869967, 36.7328793592751, 37.038760169564426, 36.54134755084911, 36.77851627642909, 39.89404598375161, 40.35801550497611, 40.661004205544785, 43.974370817343384, 44.60726210909584, 44.46055957178274, 44.60380435983339, 44.48731754968563, 44.37423379222551, -115.06968170404434, -100.4295314103365, -100.53884655237198, 41.40797248482704, 42.005096677690744, 41.96852269023657, 38.68637194142987, 38.35002556194861, 38.6605907951792, 29.172125689685345, 29.175537571310997, 29.695783344097435, 37.32935893908143, 36.56718672811985, 37.313971906900406, 42.394610228637845, 42.23077445725599, 42.62406313295165, 32.201697550714016, 32.60663759801537, 32.2329288572073, 44.13758466641107, 43.97442477444807, 44.19950232530633, 42.148704916238785, 42.33953730762005, 42.84297923184931, 32.20865312839547, 31.466882357994706, 32.00404042253891, 34.26250153283277, 34.860173809031636, 34.37323653201261, 41.617220602308706, 41.404055253913, 41.33694502462943, 40.137887670968965, 40.126094538097576, 40.100828548272446, 32.20489292203759, 31.782529657085732, 32.10633240205546, 38.17789007226625, 38.705534918854624, 38.63143353040019, 35.66523802032073, 35.194336888690785, 35.18830642600854, 39.48632689813772, 39.476064952711255, 38.89668884376684, 37.49050487826267, 37.68136818955341, 37.52379325280586, 46.08387362211943, 46.314978171139956, 46.421051900833845, 38.58660027881463, 38.823036072154835, 39.08848758352299, 39.06282307704289, 38.79343019922574, 39.19034319122632, 44.65133463342984, 43.72490343948205, 44.551371199389294, 47.60825903962056, 47.65368347863357, 47.71433360750477, 34.119820676743984, 34.09884958341718, 34.10833804681897, 30.51400814950466, 30.77542719244957, 31.077243437059224, 40.424221717442066, 39.82496031622091, 40.10372635970512, 28.000471291442707, 28.297887125362948, 27.975345214207962, 39.95703875025113, 40.43961838756998, 40.518084749889866, 38.88273115456104, 38.959866689518094, 39.026700893417, -103.1777037618061, -105.68111618359885, -93.5364987452825, 34.619220808148384, 34.913759004324675, 34.898028276860714, 44.92764429499705, 44.85758253683646, 45.05007662189503, 35.19962243611613, 35.17687192062536, 35.1510797428588, 33.412726118539766, 33.270710350324705, 33.39382675228019, 41.48287762639423, 41.28221060832341, 41.446073220421866, 40.65402778362234, 40.496140388151005, 40.7023770691206, 44.80669317642847, 45.34391665707031, 45.347187908987195, 23.947655783345297, 23.535367009540394, 23.459425215919808, 43.60770082473755, 43.54509229212999, 43.57793661206961, 50.094115284581974, 49.62785508235295, 49.77973721673091, 37.77210072645296, 37.73287123565872, 37.46557366599639, 35.21436722576618, 35.4045621547848, 34.74501223862171, 37.95577623446782, 38.106579562028244, 38.03670458992322, 43.2771350989739, 43.37629476437965, 43.456022198001534, 43.724959410727024, 43.093262419104576, 43.55063607171178, 42.0611322770516, 42.50532853479186, 42.53840689609447, 35.797756642103195, 35.92041625827551, 36.348308177664876, 40.742024135465414, 40.10696044067541, 40.72778089546287, 35.772380140920475, 35.02625795205434, 36.04258384679754, 33.06370558217168, 33.03080214187503, 33.1082933023572, 41.681739566226796, 41.55332750578721, 41.86858768512805, 43.58607349793115, 43.80239678422609, 44.169881109769136, 35.574137553572655, 35.96896728873253, 36.00786013901234, 35.805646285414696, 35.98650421202183, 35.96516451984644, 23.77160345762968, 23.97023379430175, 24.018767407163978, 39.269777984668806, 39.360631724198655, 38.77828585108121, 49.96522143731515, 49.54945791761081, 49.245034868518516, 45.6573161954681, 45.35353989402452, 45.492710071305424, 36.62037295848131, 36.27147586643696, 36.64507349580526, 44.761813789606094, 45.59324013441801, 44.9055073261261, 48.95281620075305, 49.21050339688857, 49.11287437876065, 33.23263430222869, 33.37010489962995, 33.281171295791864, 43.52784952529085, 43.520958791797355, 42.97038384278615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14535061166662616, "mean_inference_ms": 0.6944917885299415, "mean_action_processing_ms": 0.10107982181154371, "mean_env_wait_ms": 0.8491352060621798, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 550000, "timesteps_this_iter": 0, "agent_timesteps_total": 1650000, "timers": {"sample_time_ms": 12459.614, "sample_throughput": 401.297, "load_time_ms": 0.2, "load_throughput": 25010757.305, "learn_time_ms": 1660.935, "learn_throughput": 3010.352, "update_time_ms": 8.036}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3234889800848444e-24, "cur_lr": 0.0005000000000000001, "total_loss": 8.512720394134522, "policy_loss": -0.001747060958920077, "vf_loss": 8.593455791473389, "vf_explained_var": -0.1063069224357605, "kl": 0.0034073904855349835, "entropy": 7.898859167098999, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 550000, "num_agent_steps_sampled": 1650000, "num_steps_trained": 550000, "num_agent_steps_trained": 1650000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1955, "training_iteration": 110, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-29-03", "timestamp": 1706228943, "time_this_iter_s": 12.428619146347046, "time_total_s": 1185.1573593616486, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202823C5EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1185.1573593616486, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 10.905555555555559, "ram_util_percent": 54.96111111111111}}
{"episode_reward_max": 161.9598611965776, "episode_reward_min": -316.0380596667528, "episode_reward_mean": 105.60253095810593, "episode_len_mean": 491.48, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -115.06968170404434}, "policy_reward_max": {"shared_policy": 54.137368219594165}, "policy_reward_mean": {"shared_policy": 35.20084365270197}, "custom_metrics": {}, "hist_stats": {"episode_reward": [104.07076564338055, 75.90300826355815, 99.2901241108775, 114.06614480074492, 96.06833409890531, 105.77659453451633, 72.59933494403955, 95.04972866922616, 108.48829077742994, 99.93849189579484, 92.69829327147453, 110.83570458652683, 108.21902708522975, 105.81301291659472, 105.46369347255676, 124.4620552137494, 85.51953839045018, 94.983383545652, 99.74530274420977, 104.14523483812808, 97.62395099550486, 120.37359341979025, 109.82672999799252, 110.35862399684262, 120.9130656942725, 133.04219249822197, 133.4653557017444, -316.0380596667528, 125.38159185275435, 115.69698829855768, 88.04344660509378, 111.21051757410169, 127.24944781884548, 97.04126400593668, 132.31151176616538, 127.33122145570815, 95.67957590892908, 103.49591187387702, 124.35822088085114, 120.36481075733899, 96.09375498117878, 115.51485852152106, 106.04788133502005, 117.85908069461581, 112.69566632062194, 138.8199036940934, 116.49812393449245, 117.04659646749495, 132.92760927230108, 142.97627612575894, 102.32700830698013, 92.36667877901345, 120.3529083933681, 84.27370363101362, 120.91474188771097, 116.86929873749614, -302.3953186906874, 104.43100808933377, 134.8353034537285, 105.52757409960029, 100.07726322114466, 124.2111614551395, 121.85254524089395, 135.497797742486, 70.9424480088055, 130.73072972893706, 149.50170758366576, 112.97054562810807, 105.36394161917269, 114.09906038641928, 130.10945206135506, 130.36885790154335, 127.10486770793793, 108.06648107804358, 121.5767654716037, 106.84122193977235, 99.2028010264039, 125.10365475714205, 131.5583513919263, 107.55096498131752, 107.75731501728296, 71.7606046590954, 117.40869555994867, 148.75971422344455, 136.50356616079813, 109.53692232072353, 135.26056125015012, 147.27619397640225, 99.8839104976505, 130.0191921598743, 161.9598611965776, 108.53976753912863, 117.99952412582934, 117.56625006720424, 103.61782982759178, 119.78496633283791, 116.80083256028593, 132.669252410531, 137.01192272827024, 130.55691099166881], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 90, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [34.72911110209921, 34.79352514787266, 34.548129393408686, 25.41040889918804, 25.181592479348183, 25.311006885021925, 33.61034705241521, 33.441837829848126, 32.23793922861417, 37.95361957202354, 37.87206425021091, 38.24046097851047, 31.857578997810677, 32.07213269670804, 32.138622404386595, 34.98896910250187, 35.63652215898037, 35.151103273034096, 24.4613742592434, 24.015477667252213, 24.122483017543942, 31.615806256731346, 31.739478928347424, 31.694443484147385, 36.530423168092966, 36.53123359568417, 35.4266340136528, 33.22693122426668, 33.32531021783748, 33.38625045369068, 30.23367704947789, 31.297279862997428, 31.167336358999208, 37.01962520073478, 36.7703479056557, 37.045731480136354, 36.226570408791304, 35.5650422424078, 36.42741443403065, 35.19565154860416, 35.331498003254325, 35.28586336473623, 35.29514228304227, 34.89259490122397, 35.275956288290516, 41.62968410303195, 41.38832548757394, 41.44404562314351, 28.32558047771454, 29.30088140349835, 27.89307650923729, 31.508098284403474, 31.563287826875836, 31.911997434372694, 33.105017215013504, 33.24852877110243, 33.391756758093834, 34.73901894440253, 34.53061998387177, 34.87559590985377, 32.79839822649956, 32.72889559715986, 32.096657171845436, 40.06799591084321, 39.92096712191899, 40.384630387028054, 36.348661951720715, 36.7451886869967, 36.7328793592751, 37.038760169564426, 36.54134755084911, 36.77851627642909, 39.89404598375161, 40.35801550497611, 40.661004205544785, 43.974370817343384, 44.60726210909584, 44.46055957178274, 44.60380435983339, 44.48731754968563, 44.37423379222551, -115.06968170404434, -100.4295314103365, -100.53884655237198, 41.40797248482704, 42.005096677690744, 41.96852269023657, 38.68637194142987, 38.35002556194861, 38.6605907951792, 29.172125689685345, 29.175537571310997, 29.695783344097435, 37.32935893908143, 36.56718672811985, 37.313971906900406, 42.394610228637845, 42.23077445725599, 42.62406313295165, 32.201697550714016, 32.60663759801537, 32.2329288572073, 44.13758466641107, 43.97442477444807, 44.19950232530633, 42.148704916238785, 42.33953730762005, 42.84297923184931, 32.20865312839547, 31.466882357994706, 32.00404042253891, 34.26250153283277, 34.860173809031636, 34.37323653201261, 41.617220602308706, 41.404055253913, 41.33694502462943, 40.137887670968965, 40.126094538097576, 40.100828548272446, 32.20489292203759, 31.782529657085732, 32.10633240205546, 38.17789007226625, 38.705534918854624, 38.63143353040019, 35.66523802032073, 35.194336888690785, 35.18830642600854, 39.48632689813772, 39.476064952711255, 38.89668884376684, 37.49050487826267, 37.68136818955341, 37.52379325280586, 46.08387362211943, 46.314978171139956, 46.421051900833845, 38.58660027881463, 38.823036072154835, 39.08848758352299, 39.06282307704289, 38.79343019922574, 39.19034319122632, 44.65133463342984, 43.72490343948205, 44.551371199389294, 47.60825903962056, 47.65368347863357, 47.71433360750477, 34.119820676743984, 34.09884958341718, 34.10833804681897, 30.51400814950466, 30.77542719244957, 31.077243437059224, 40.424221717442066, 39.82496031622091, 40.10372635970512, 28.000471291442707, 28.297887125362948, 27.975345214207962, 39.95703875025113, 40.43961838756998, 40.518084749889866, 38.88273115456104, 38.959866689518094, 39.026700893417, -103.1777037618061, -105.68111618359885, -93.5364987452825, 34.619220808148384, 34.913759004324675, 34.898028276860714, 44.92764429499705, 44.85758253683646, 45.05007662189503, 35.19962243611613, 35.17687192062536, 35.1510797428588, 33.412726118539766, 33.270710350324705, 33.39382675228019, 41.48287762639423, 41.28221060832341, 41.446073220421866, 40.65402778362234, 40.496140388151005, 40.7023770691206, 44.80669317642847, 45.34391665707031, 45.347187908987195, 23.947655783345297, 23.535367009540394, 23.459425215919808, 43.60770082473755, 43.54509229212999, 43.57793661206961, 50.094115284581974, 49.62785508235295, 49.77973721673091, 37.77210072645296, 37.73287123565872, 37.46557366599639, 35.21436722576618, 35.4045621547848, 34.74501223862171, 37.95577623446782, 38.106579562028244, 38.03670458992322, 43.2771350989739, 43.37629476437965, 43.456022198001534, 43.724959410727024, 43.093262419104576, 43.55063607171178, 42.0611322770516, 42.50532853479186, 42.53840689609447, 35.797756642103195, 35.92041625827551, 36.348308177664876, 40.742024135465414, 40.10696044067541, 40.72778089546287, 35.772380140920475, 35.02625795205434, 36.04258384679754, 33.06370558217168, 33.03080214187503, 33.1082933023572, 41.681739566226796, 41.55332750578721, 41.86858768512805, 43.58607349793115, 43.80239678422609, 44.169881109769136, 35.574137553572655, 35.96896728873253, 36.00786013901234, 35.805646285414696, 35.98650421202183, 35.96516451984644, 23.77160345762968, 23.97023379430175, 24.018767407163978, 39.269777984668806, 39.360631724198655, 38.77828585108121, 49.96522143731515, 49.54945791761081, 49.245034868518516, 45.6573161954681, 45.35353989402452, 45.492710071305424, 36.62037295848131, 36.27147586643696, 36.64507349580526, 44.761813789606094, 45.59324013441801, 44.9055073261261, 48.95281620075305, 49.21050339688857, 49.11287437876065, 33.23263430222869, 33.37010489962995, 33.281171295791864, 43.52784952529085, 43.520958791797355, 42.97038384278615, 53.86255590120952, 54.137368219594165, 53.95993707577388, 35.868113110462815, 36.44286305146912, 36.2287913771967, 39.48491435684264, 39.183480620384216, 39.331129148602486, 39.048524141311646, 39.053392723202705, 39.464333202689886, 34.47655500471592, 34.760075775906444, 34.381199046969414, 40.0472371118764, 40.056384403879434, 39.68134481708208, 38.47618059813976, 39.11426145210862, 39.21039051003754, 44.2596810782949, 44.302294115225465, 44.10727721701065, 45.081320106983185, 46.06703033670783, 45.86357228457928, 43.62315194805463, 43.47819948693116, 43.4555595566829]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14549910051531575, "mean_inference_ms": 0.6952932036618806, "mean_action_processing_ms": 0.10120046701371323, "mean_env_wait_ms": 0.8494506245980716, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 555000, "timesteps_this_iter": 0, "agent_timesteps_total": 1665000, "timers": {"sample_time_ms": 11443.58, "sample_throughput": 436.926, "load_time_ms": 0.2, "load_throughput": 25010757.305, "learn_time_ms": 1651.856, "learn_throughput": 3026.898, "update_time_ms": 8.036}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.617444900424222e-25, "cur_lr": 0.0005000000000000001, "total_loss": 7.309313535690308, "policy_loss": -0.0017091984683856865, "vf_loss": 7.392048406600952, "vf_explained_var": -0.06838219165802002, "kl": 0.004144878615644269, "entropy": 8.102565574645997, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 555000, "num_agent_steps_sampled": 1665000, "num_steps_trained": 555000, "num_agent_steps_trained": 1665000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1965, "training_iteration": 111, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-29-14", "timestamp": 1706228954, "time_this_iter_s": 11.230789422988892, "time_total_s": 1196.3881487846375, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202825D13A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1196.3881487846375, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 9.74375, "ram_util_percent": 55.175000000000004}}
{"episode_reward_max": 161.9598611965776, "episode_reward_min": -316.0380596667528, "episode_reward_mean": 107.77923729984846, "episode_len_mean": 491.48, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -115.06968170404434}, "policy_reward_max": {"shared_policy": 54.137368219594165}, "policy_reward_mean": {"shared_policy": 35.92641243328282}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.69829327147453, 110.83570458652683, 108.21902708522975, 105.81301291659472, 105.46369347255676, 124.4620552137494, 85.51953839045018, 94.983383545652, 99.74530274420977, 104.14523483812808, 97.62395099550486, 120.37359341979025, 109.82672999799252, 110.35862399684262, 120.9130656942725, 133.04219249822197, 133.4653557017444, -316.0380596667528, 125.38159185275435, 115.69698829855768, 88.04344660509378, 111.21051757410169, 127.24944781884548, 97.04126400593668, 132.31151176616538, 127.33122145570815, 95.67957590892908, 103.49591187387702, 124.35822088085114, 120.36481075733899, 96.09375498117878, 115.51485852152106, 106.04788133502005, 117.85908069461581, 112.69566632062194, 138.8199036940934, 116.49812393449245, 117.04659646749495, 132.92760927230108, 142.97627612575894, 102.32700830698013, 92.36667877901345, 120.3529083933681, 84.27370363101362, 120.91474188771097, 116.86929873749614, -302.3953186906874, 104.43100808933377, 134.8353034537285, 105.52757409960029, 100.07726322114466, 124.2111614551395, 121.85254524089395, 135.497797742486, 70.9424480088055, 130.73072972893706, 149.50170758366576, 112.97054562810807, 105.36394161917269, 114.09906038641928, 130.10945206135506, 130.36885790154335, 127.10486770793793, 108.06648107804358, 121.5767654716037, 106.84122193977235, 99.2028010264039, 125.10365475714205, 131.5583513919263, 107.55096498131752, 107.75731501728296, 71.7606046590954, 117.40869555994867, 148.75971422344455, 136.50356616079813, 109.53692232072353, 135.26056125015012, 147.27619397640225, 99.8839104976505, 130.0191921598743, 161.9598611965776, 108.53976753912863, 117.99952412582934, 117.56625006720424, 103.61782982759178, 119.78496633283791, 116.80083256028593, 132.669252410531, 137.01192272827024, 130.55691099166881, 117.87362497486173, 95.81132604135198, 90.47620072215796, 137.28076073899837, 119.25659400969742, 141.00026809424193, 119.9999713525176, 115.21334620565173, 129.85340148955567, 122.1559582836926], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 90, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [30.23367704947789, 31.297279862997428, 31.167336358999208, 37.01962520073478, 36.7703479056557, 37.045731480136354, 36.226570408791304, 35.5650422424078, 36.42741443403065, 35.19565154860416, 35.331498003254325, 35.28586336473623, 35.29514228304227, 34.89259490122397, 35.275956288290516, 41.62968410303195, 41.38832548757394, 41.44404562314351, 28.32558047771454, 29.30088140349835, 27.89307650923729, 31.508098284403474, 31.563287826875836, 31.911997434372694, 33.105017215013504, 33.24852877110243, 33.391756758093834, 34.73901894440253, 34.53061998387177, 34.87559590985377, 32.79839822649956, 32.72889559715986, 32.096657171845436, 40.06799591084321, 39.92096712191899, 40.384630387028054, 36.348661951720715, 36.7451886869967, 36.7328793592751, 37.038760169564426, 36.54134755084911, 36.77851627642909, 39.89404598375161, 40.35801550497611, 40.661004205544785, 43.974370817343384, 44.60726210909584, 44.46055957178274, 44.60380435983339, 44.48731754968563, 44.37423379222551, -115.06968170404434, -100.4295314103365, -100.53884655237198, 41.40797248482704, 42.005096677690744, 41.96852269023657, 38.68637194142987, 38.35002556194861, 38.6605907951792, 29.172125689685345, 29.175537571310997, 29.695783344097435, 37.32935893908143, 36.56718672811985, 37.313971906900406, 42.394610228637845, 42.23077445725599, 42.62406313295165, 32.201697550714016, 32.60663759801537, 32.2329288572073, 44.13758466641107, 43.97442477444807, 44.19950232530633, 42.148704916238785, 42.33953730762005, 42.84297923184931, 32.20865312839547, 31.466882357994706, 32.00404042253891, 34.26250153283277, 34.860173809031636, 34.37323653201261, 41.617220602308706, 41.404055253913, 41.33694502462943, 40.137887670968965, 40.126094538097576, 40.100828548272446, 32.20489292203759, 31.782529657085732, 32.10633240205546, 38.17789007226625, 38.705534918854624, 38.63143353040019, 35.66523802032073, 35.194336888690785, 35.18830642600854, 39.48632689813772, 39.476064952711255, 38.89668884376684, 37.49050487826267, 37.68136818955341, 37.52379325280586, 46.08387362211943, 46.314978171139956, 46.421051900833845, 38.58660027881463, 38.823036072154835, 39.08848758352299, 39.06282307704289, 38.79343019922574, 39.19034319122632, 44.65133463342984, 43.72490343948205, 44.551371199389294, 47.60825903962056, 47.65368347863357, 47.71433360750477, 34.119820676743984, 34.09884958341718, 34.10833804681897, 30.51400814950466, 30.77542719244957, 31.077243437059224, 40.424221717442066, 39.82496031622091, 40.10372635970512, 28.000471291442707, 28.297887125362948, 27.975345214207962, 39.95703875025113, 40.43961838756998, 40.518084749889866, 38.88273115456104, 38.959866689518094, 39.026700893417, -103.1777037618061, -105.68111618359885, -93.5364987452825, 34.619220808148384, 34.913759004324675, 34.898028276860714, 44.92764429499705, 44.85758253683646, 45.05007662189503, 35.19962243611613, 35.17687192062536, 35.1510797428588, 33.412726118539766, 33.270710350324705, 33.39382675228019, 41.48287762639423, 41.28221060832341, 41.446073220421866, 40.65402778362234, 40.496140388151005, 40.7023770691206, 44.80669317642847, 45.34391665707031, 45.347187908987195, 23.947655783345297, 23.535367009540394, 23.459425215919808, 43.60770082473755, 43.54509229212999, 43.57793661206961, 50.094115284581974, 49.62785508235295, 49.77973721673091, 37.77210072645296, 37.73287123565872, 37.46557366599639, 35.21436722576618, 35.4045621547848, 34.74501223862171, 37.95577623446782, 38.106579562028244, 38.03670458992322, 43.2771350989739, 43.37629476437965, 43.456022198001534, 43.724959410727024, 43.093262419104576, 43.55063607171178, 42.0611322770516, 42.50532853479186, 42.53840689609447, 35.797756642103195, 35.92041625827551, 36.348308177664876, 40.742024135465414, 40.10696044067541, 40.72778089546287, 35.772380140920475, 35.02625795205434, 36.04258384679754, 33.06370558217168, 33.03080214187503, 33.1082933023572, 41.681739566226796, 41.55332750578721, 41.86858768512805, 43.58607349793115, 43.80239678422609, 44.169881109769136, 35.574137553572655, 35.96896728873253, 36.00786013901234, 35.805646285414696, 35.98650421202183, 35.96516451984644, 23.77160345762968, 23.97023379430175, 24.018767407163978, 39.269777984668806, 39.360631724198655, 38.77828585108121, 49.96522143731515, 49.54945791761081, 49.245034868518516, 45.6573161954681, 45.35353989402452, 45.492710071305424, 36.62037295848131, 36.27147586643696, 36.64507349580526, 44.761813789606094, 45.59324013441801, 44.9055073261261, 48.95281620075305, 49.21050339688857, 49.11287437876065, 33.23263430222869, 33.37010489962995, 33.281171295791864, 43.52784952529085, 43.520958791797355, 42.97038384278615, 53.86255590120952, 54.137368219594165, 53.95993707577388, 35.868113110462815, 36.44286305146912, 36.2287913771967, 39.48491435684264, 39.183480620384216, 39.331129148602486, 39.048524141311646, 39.053392723202705, 39.464333202689886, 34.47655500471592, 34.760075775906444, 34.381199046969414, 40.0472371118764, 40.056384403879434, 39.68134481708208, 38.47618059813976, 39.11426145210862, 39.21039051003754, 44.2596810782949, 44.302294115225465, 44.10727721701065, 45.081320106983185, 46.06703033670783, 45.86357228457928, 43.62315194805463, 43.47819948693116, 43.4555595566829, 39.14146728565295, 39.34902447958787, 39.38313320962091, 32.144978613282234, 31.462991217772156, 32.203356210297585, 30.182513561099768, 30.284244645386934, 30.009442515671253, 45.94194237018624, 45.92590907464424, 45.412909294168145, 39.807320577402905, 39.727312852938965, 39.72196057935555, 46.785832223792866, 47.12302728494008, 47.09140858550866, 39.859319515526295, 40.22026501595974, 39.92038682103157, 38.56244958440462, 38.37101805458465, 38.27987856666246, 43.24660294006267, 43.41223262498775, 43.19456592450538, 40.881271278485656, 40.49066971987486, 40.784017285332084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14564379941447708, "mean_inference_ms": 0.6960892441667121, "mean_action_processing_ms": 0.10131836416385648, "mean_env_wait_ms": 0.8497585772146852, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 560000, "timesteps_this_iter": 0, "agent_timesteps_total": 1680000, "timers": {"sample_time_ms": 11430.847, "sample_throughput": 437.413, "load_time_ms": 0.1, "load_throughput": 49991704.41, "learn_time_ms": 1654.313, "learn_throughput": 3022.402, "update_time_ms": 8.039}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.308722450212111e-25, "cur_lr": 0.0005000000000000001, "total_loss": 7.01629605293274, "policy_loss": -0.0012318583319103737, "vf_loss": 7.096605539321899, "vf_explained_var": -0.054964888095855716, "kl": 0.0034798733657409285, "entropy": 7.90778751373291, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 560000, "num_agent_steps_sampled": 1680000, "num_steps_trained": 560000, "num_agent_steps_trained": 1680000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1975, "training_iteration": 112, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-29-26", "timestamp": 1706228966, "time_this_iter_s": 11.585083484649658, "time_total_s": 1207.973232269287, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028235DC10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1207.973232269287, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 10.41875, "ram_util_percent": 55.0}}
{"episode_reward_max": 161.9598611965776, "episode_reward_min": -316.0380596667528, "episode_reward_mean": 109.56403735776199, "episode_len_mean": 491.48, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -115.06968170404434}, "policy_reward_max": {"shared_policy": 54.137368219594165}, "policy_reward_mean": {"shared_policy": 36.521345785920666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [97.62395099550486, 120.37359341979025, 109.82672999799252, 110.35862399684262, 120.9130656942725, 133.04219249822197, 133.4653557017444, -316.0380596667528, 125.38159185275435, 115.69698829855768, 88.04344660509378, 111.21051757410169, 127.24944781884548, 97.04126400593668, 132.31151176616538, 127.33122145570815, 95.67957590892908, 103.49591187387702, 124.35822088085114, 120.36481075733899, 96.09375498117878, 115.51485852152106, 106.04788133502005, 117.85908069461581, 112.69566632062194, 138.8199036940934, 116.49812393449245, 117.04659646749495, 132.92760927230108, 142.97627612575894, 102.32700830698013, 92.36667877901345, 120.3529083933681, 84.27370363101362, 120.91474188771097, 116.86929873749614, -302.3953186906874, 104.43100808933377, 134.8353034537285, 105.52757409960029, 100.07726322114466, 124.2111614551395, 121.85254524089395, 135.497797742486, 70.9424480088055, 130.73072972893706, 149.50170758366576, 112.97054562810807, 105.36394161917269, 114.09906038641928, 130.10945206135506, 130.36885790154335, 127.10486770793793, 108.06648107804358, 121.5767654716037, 106.84122193977235, 99.2028010264039, 125.10365475714205, 131.5583513919263, 107.55096498131752, 107.75731501728296, 71.7606046590954, 117.40869555994867, 148.75971422344455, 136.50356616079813, 109.53692232072353, 135.26056125015012, 147.27619397640225, 99.8839104976505, 130.0191921598743, 161.9598611965776, 108.53976753912863, 117.99952412582934, 117.56625006720424, 103.61782982759178, 119.78496633283791, 116.80083256028593, 132.669252410531, 137.01192272827024, 130.55691099166881, 117.87362497486173, 95.81132604135198, 90.47620072215796, 137.28076073899837, 119.25659400969742, 141.00026809424193, 119.9999713525176, 115.21334620565173, 129.85340148955567, 122.1559582836926, 133.39953621104345, 116.27055570483205, 121.87429097667334, 96.56118831411003, 138.56642739847297, 127.39687095209955, 116.17269980721174, 119.55654261820015, 124.35211840458211, 116.21502146869896], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 58, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 90, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [32.79839822649956, 32.72889559715986, 32.096657171845436, 40.06799591084321, 39.92096712191899, 40.384630387028054, 36.348661951720715, 36.7451886869967, 36.7328793592751, 37.038760169564426, 36.54134755084911, 36.77851627642909, 39.89404598375161, 40.35801550497611, 40.661004205544785, 43.974370817343384, 44.60726210909584, 44.46055957178274, 44.60380435983339, 44.48731754968563, 44.37423379222551, -115.06968170404434, -100.4295314103365, -100.53884655237198, 41.40797248482704, 42.005096677690744, 41.96852269023657, 38.68637194142987, 38.35002556194861, 38.6605907951792, 29.172125689685345, 29.175537571310997, 29.695783344097435, 37.32935893908143, 36.56718672811985, 37.313971906900406, 42.394610228637845, 42.23077445725599, 42.62406313295165, 32.201697550714016, 32.60663759801537, 32.2329288572073, 44.13758466641107, 43.97442477444807, 44.19950232530633, 42.148704916238785, 42.33953730762005, 42.84297923184931, 32.20865312839547, 31.466882357994706, 32.00404042253891, 34.26250153283277, 34.860173809031636, 34.37323653201261, 41.617220602308706, 41.404055253913, 41.33694502462943, 40.137887670968965, 40.126094538097576, 40.100828548272446, 32.20489292203759, 31.782529657085732, 32.10633240205546, 38.17789007226625, 38.705534918854624, 38.63143353040019, 35.66523802032073, 35.194336888690785, 35.18830642600854, 39.48632689813772, 39.476064952711255, 38.89668884376684, 37.49050487826267, 37.68136818955341, 37.52379325280586, 46.08387362211943, 46.314978171139956, 46.421051900833845, 38.58660027881463, 38.823036072154835, 39.08848758352299, 39.06282307704289, 38.79343019922574, 39.19034319122632, 44.65133463342984, 43.72490343948205, 44.551371199389294, 47.60825903962056, 47.65368347863357, 47.71433360750477, 34.119820676743984, 34.09884958341718, 34.10833804681897, 30.51400814950466, 30.77542719244957, 31.077243437059224, 40.424221717442066, 39.82496031622091, 40.10372635970512, 28.000471291442707, 28.297887125362948, 27.975345214207962, 39.95703875025113, 40.43961838756998, 40.518084749889866, 38.88273115456104, 38.959866689518094, 39.026700893417, -103.1777037618061, -105.68111618359885, -93.5364987452825, 34.619220808148384, 34.913759004324675, 34.898028276860714, 44.92764429499705, 44.85758253683646, 45.05007662189503, 35.19962243611613, 35.17687192062536, 35.1510797428588, 33.412726118539766, 33.270710350324705, 33.39382675228019, 41.48287762639423, 41.28221060832341, 41.446073220421866, 40.65402778362234, 40.496140388151005, 40.7023770691206, 44.80669317642847, 45.34391665707031, 45.347187908987195, 23.947655783345297, 23.535367009540394, 23.459425215919808, 43.60770082473755, 43.54509229212999, 43.57793661206961, 50.094115284581974, 49.62785508235295, 49.77973721673091, 37.77210072645296, 37.73287123565872, 37.46557366599639, 35.21436722576618, 35.4045621547848, 34.74501223862171, 37.95577623446782, 38.106579562028244, 38.03670458992322, 43.2771350989739, 43.37629476437965, 43.456022198001534, 43.724959410727024, 43.093262419104576, 43.55063607171178, 42.0611322770516, 42.50532853479186, 42.53840689609447, 35.797756642103195, 35.92041625827551, 36.348308177664876, 40.742024135465414, 40.10696044067541, 40.72778089546287, 35.772380140920475, 35.02625795205434, 36.04258384679754, 33.06370558217168, 33.03080214187503, 33.1082933023572, 41.681739566226796, 41.55332750578721, 41.86858768512805, 43.58607349793115, 43.80239678422609, 44.169881109769136, 35.574137553572655, 35.96896728873253, 36.00786013901234, 35.805646285414696, 35.98650421202183, 35.96516451984644, 23.77160345762968, 23.97023379430175, 24.018767407163978, 39.269777984668806, 39.360631724198655, 38.77828585108121, 49.96522143731515, 49.54945791761081, 49.245034868518516, 45.6573161954681, 45.35353989402452, 45.492710071305424, 36.62037295848131, 36.27147586643696, 36.64507349580526, 44.761813789606094, 45.59324013441801, 44.9055073261261, 48.95281620075305, 49.21050339688857, 49.11287437876065, 33.23263430222869, 33.37010489962995, 33.281171295791864, 43.52784952529085, 43.520958791797355, 42.97038384278615, 53.86255590120952, 54.137368219594165, 53.95993707577388, 35.868113110462815, 36.44286305146912, 36.2287913771967, 39.48491435684264, 39.183480620384216, 39.331129148602486, 39.048524141311646, 39.053392723202705, 39.464333202689886, 34.47655500471592, 34.760075775906444, 34.381199046969414, 40.0472371118764, 40.056384403879434, 39.68134481708208, 38.47618059813976, 39.11426145210862, 39.21039051003754, 44.2596810782949, 44.302294115225465, 44.10727721701065, 45.081320106983185, 46.06703033670783, 45.86357228457928, 43.62315194805463, 43.47819948693116, 43.4555595566829, 39.14146728565295, 39.34902447958787, 39.38313320962091, 32.144978613282234, 31.462991217772156, 32.203356210297585, 30.182513561099768, 30.284244645386934, 30.009442515671253, 45.94194237018624, 45.92590907464424, 45.412909294168145, 39.807320577402905, 39.727312852938965, 39.72196057935555, 46.785832223792866, 47.12302728494008, 47.09140858550866, 39.859319515526295, 40.22026501595974, 39.92038682103157, 38.56244958440462, 38.37101805458465, 38.27987856666246, 43.24660294006267, 43.41223262498775, 43.19456592450538, 40.881271278485656, 40.49066971987486, 40.784017285332084, 44.74447586014867, 44.34164425730705, 44.313416093587875, 38.75233194480339, 38.58593689898649, 38.93228686104217, 40.70868277053037, 40.407632562021405, 40.75797564412156, 32.182605908562735, 32.32695213456948, 32.05163027097781, 45.97474017490943, 46.30814553548892, 46.28354168807466, 42.235524644454316, 42.432607290645436, 42.728739016999796, 38.76940386680265, 38.77201275279124, 38.63128318761785, 40.201528277869016, 39.26023089389005, 40.094783446441085, 41.760396738226206, 40.9194823304812, 41.67223933587471, 38.869343147923544, 38.42875762780507, 38.91692069297035]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14577622748659447, "mean_inference_ms": 0.6968348826423748, "mean_action_processing_ms": 0.10142512141907867, "mean_env_wait_ms": 0.8500263131223353, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 565000, "timesteps_this_iter": 0, "agent_timesteps_total": 1695000, "timers": {"sample_time_ms": 11390.098, "sample_throughput": 438.978, "load_time_ms": 0.1, "load_throughput": 49955979.038, "learn_time_ms": 1650.709, "learn_throughput": 3029.001, "update_time_ms": 8.2}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6543612251060554e-25, "cur_lr": 0.0005000000000000001, "total_loss": 5.816805601119995, "policy_loss": -0.0004441151957431444, "vf_loss": 5.898140573501587, "vf_explained_var": -0.04119507074356079, "kl": 0.004251683945786324, "entropy": 8.08907995223999, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 565000, "num_agent_steps_sampled": 1695000, "num_steps_trained": 565000, "num_agent_steps_trained": 1695000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1985, "training_iteration": 113, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-29-37", "timestamp": 1706228977, "time_this_iter_s": 10.718418836593628, "time_total_s": 1218.6916511058807, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028458A160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1218.6916511058807, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 9.706666666666667, "ram_util_percent": 55.053333333333335}}
{"episode_reward_max": 161.9598611965776, "episode_reward_min": -302.3953186906874, "episode_reward_mean": 110.20976824063634, "episode_len_mean": 493.25, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -105.68111618359885}, "policy_reward_max": {"shared_policy": 54.137368219594165}, "policy_reward_mean": {"shared_policy": 36.73658941354543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [111.21051757410169, 127.24944781884548, 97.04126400593668, 132.31151176616538, 127.33122145570815, 95.67957590892908, 103.49591187387702, 124.35822088085114, 120.36481075733899, 96.09375498117878, 115.51485852152106, 106.04788133502005, 117.85908069461581, 112.69566632062194, 138.8199036940934, 116.49812393449245, 117.04659646749495, 132.92760927230108, 142.97627612575894, 102.32700830698013, 92.36667877901345, 120.3529083933681, 84.27370363101362, 120.91474188771097, 116.86929873749614, -302.3953186906874, 104.43100808933377, 134.8353034537285, 105.52757409960029, 100.07726322114466, 124.2111614551395, 121.85254524089395, 135.497797742486, 70.9424480088055, 130.73072972893706, 149.50170758366576, 112.97054562810807, 105.36394161917269, 114.09906038641928, 130.10945206135506, 130.36885790154335, 127.10486770793793, 108.06648107804358, 121.5767654716037, 106.84122193977235, 99.2028010264039, 125.10365475714205, 131.5583513919263, 107.55096498131752, 107.75731501728296, 71.7606046590954, 117.40869555994867, 148.75971422344455, 136.50356616079813, 109.53692232072353, 135.26056125015012, 147.27619397640225, 99.8839104976505, 130.0191921598743, 161.9598611965776, 108.53976753912863, 117.99952412582934, 117.56625006720424, 103.61782982759178, 119.78496633283791, 116.80083256028593, 132.669252410531, 137.01192272827024, 130.55691099166881, 117.87362497486173, 95.81132604135198, 90.47620072215796, 137.28076073899837, 119.25659400969742, 141.00026809424193, 119.9999713525176, 115.21334620565173, 129.85340148955567, 122.1559582836926, 133.39953621104345, 116.27055570483205, 121.87429097667334, 96.56118831411003, 138.56642739847297, 127.39687095209955, 116.17269980721174, 119.55654261820015, 124.35211840458211, 116.21502146869896, 69.14006203226742, 143.7387602292002, 145.3735549077392, 127.69050493463874, -250.7989996895194, 95.70901176478947, 81.7997822500765, 137.10328528843826, 118.4647129131481, 101.58169127255675, 133.45820177812115], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 90, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 235, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [37.32935893908143, 36.56718672811985, 37.313971906900406, 42.394610228637845, 42.23077445725599, 42.62406313295165, 32.201697550714016, 32.60663759801537, 32.2329288572073, 44.13758466641107, 43.97442477444807, 44.19950232530633, 42.148704916238785, 42.33953730762005, 42.84297923184931, 32.20865312839547, 31.466882357994706, 32.00404042253891, 34.26250153283277, 34.860173809031636, 34.37323653201261, 41.617220602308706, 41.404055253913, 41.33694502462943, 40.137887670968965, 40.126094538097576, 40.100828548272446, 32.20489292203759, 31.782529657085732, 32.10633240205546, 38.17789007226625, 38.705534918854624, 38.63143353040019, 35.66523802032073, 35.194336888690785, 35.18830642600854, 39.48632689813772, 39.476064952711255, 38.89668884376684, 37.49050487826267, 37.68136818955341, 37.52379325280586, 46.08387362211943, 46.314978171139956, 46.421051900833845, 38.58660027881463, 38.823036072154835, 39.08848758352299, 39.06282307704289, 38.79343019922574, 39.19034319122632, 44.65133463342984, 43.72490343948205, 44.551371199389294, 47.60825903962056, 47.65368347863357, 47.71433360750477, 34.119820676743984, 34.09884958341718, 34.10833804681897, 30.51400814950466, 30.77542719244957, 31.077243437059224, 40.424221717442066, 39.82496031622091, 40.10372635970512, 28.000471291442707, 28.297887125362948, 27.975345214207962, 39.95703875025113, 40.43961838756998, 40.518084749889866, 38.88273115456104, 38.959866689518094, 39.026700893417, -103.1777037618061, -105.68111618359885, -93.5364987452825, 34.619220808148384, 34.913759004324675, 34.898028276860714, 44.92764429499705, 44.85758253683646, 45.05007662189503, 35.19962243611613, 35.17687192062536, 35.1510797428588, 33.412726118539766, 33.270710350324705, 33.39382675228019, 41.48287762639423, 41.28221060832341, 41.446073220421866, 40.65402778362234, 40.496140388151005, 40.7023770691206, 44.80669317642847, 45.34391665707031, 45.347187908987195, 23.947655783345297, 23.535367009540394, 23.459425215919808, 43.60770082473755, 43.54509229212999, 43.57793661206961, 50.094115284581974, 49.62785508235295, 49.77973721673091, 37.77210072645296, 37.73287123565872, 37.46557366599639, 35.21436722576618, 35.4045621547848, 34.74501223862171, 37.95577623446782, 38.106579562028244, 38.03670458992322, 43.2771350989739, 43.37629476437965, 43.456022198001534, 43.724959410727024, 43.093262419104576, 43.55063607171178, 42.0611322770516, 42.50532853479186, 42.53840689609447, 35.797756642103195, 35.92041625827551, 36.348308177664876, 40.742024135465414, 40.10696044067541, 40.72778089546287, 35.772380140920475, 35.02625795205434, 36.04258384679754, 33.06370558217168, 33.03080214187503, 33.1082933023572, 41.681739566226796, 41.55332750578721, 41.86858768512805, 43.58607349793115, 43.80239678422609, 44.169881109769136, 35.574137553572655, 35.96896728873253, 36.00786013901234, 35.805646285414696, 35.98650421202183, 35.96516451984644, 23.77160345762968, 23.97023379430175, 24.018767407163978, 39.269777984668806, 39.360631724198655, 38.77828585108121, 49.96522143731515, 49.54945791761081, 49.245034868518516, 45.6573161954681, 45.35353989402452, 45.492710071305424, 36.62037295848131, 36.27147586643696, 36.64507349580526, 44.761813789606094, 45.59324013441801, 44.9055073261261, 48.95281620075305, 49.21050339688857, 49.11287437876065, 33.23263430222869, 33.37010489962995, 33.281171295791864, 43.52784952529085, 43.520958791797355, 42.97038384278615, 53.86255590120952, 54.137368219594165, 53.95993707577388, 35.868113110462815, 36.44286305146912, 36.2287913771967, 39.48491435684264, 39.183480620384216, 39.331129148602486, 39.048524141311646, 39.053392723202705, 39.464333202689886, 34.47655500471592, 34.760075775906444, 34.381199046969414, 40.0472371118764, 40.056384403879434, 39.68134481708208, 38.47618059813976, 39.11426145210862, 39.21039051003754, 44.2596810782949, 44.302294115225465, 44.10727721701065, 45.081320106983185, 46.06703033670783, 45.86357228457928, 43.62315194805463, 43.47819948693116, 43.4555595566829, 39.14146728565295, 39.34902447958787, 39.38313320962091, 32.144978613282234, 31.462991217772156, 32.203356210297585, 30.182513561099768, 30.284244645386934, 30.009442515671253, 45.94194237018624, 45.92590907464424, 45.412909294168145, 39.807320577402905, 39.727312852938965, 39.72196057935555, 46.785832223792866, 47.12302728494008, 47.09140858550866, 39.859319515526295, 40.22026501595974, 39.92038682103157, 38.56244958440462, 38.37101805458465, 38.27987856666246, 43.24660294006267, 43.41223262498775, 43.19456592450538, 40.881271278485656, 40.49066971987486, 40.784017285332084, 44.74447586014867, 44.34164425730705, 44.313416093587875, 38.75233194480339, 38.58593689898649, 38.93228686104217, 40.70868277053037, 40.407632562021405, 40.75797564412156, 32.182605908562735, 32.32695213456948, 32.05163027097781, 45.97474017490943, 46.30814553548892, 46.28354168807466, 42.235524644454316, 42.432607290645436, 42.728739016999796, 38.76940386680265, 38.77201275279124, 38.63128318761785, 40.201528277869016, 39.26023089389005, 40.094783446441085, 41.760396738226206, 40.9194823304812, 41.67223933587471, 38.869343147923544, 38.42875762780507, 38.91692069297035, 23.026836069921643, 22.864521893362195, 23.248704068983585, 47.92937135572235, 47.95340668658416, 47.85598218689363, 48.50716800987719, 48.26494404673575, 48.60144285112618, 42.52871982008219, 42.49729714542627, 42.66448796913028, -83.76056668162346, -83.77582733333111, -83.26260567456484, 31.722811430692673, 32.15896644588793, 31.827233888208866, 26.77355198065439, 27.559445238361747, 27.46678503106037, 45.54584639519453, 45.74419543519616, 45.81324345804751, 39.17542466521263, 39.70260850246996, 39.58667974546552, 33.640398318568856, 33.92240696648756, 34.01888598750034, 44.58035958154747, 44.408393210420996, 44.4694489861528]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1458508563742427, "mean_inference_ms": 0.6973957375108568, "mean_action_processing_ms": 0.10149881633045442, "mean_env_wait_ms": 0.8501814500976574, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 570000, "timesteps_this_iter": 0, "agent_timesteps_total": 1710000, "timers": {"sample_time_ms": 11261.298, "sample_throughput": 443.999, "load_time_ms": 0.1, "load_throughput": 49955979.038, "learn_time_ms": 1654.698, "learn_throughput": 3021.699, "update_time_ms": 8.451}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.271806125530277e-26, "cur_lr": 0.0005000000000000001, "total_loss": 116.4539894104004, "policy_loss": -0.0013656288452057908, "vf_loss": 116.53585891723633, "vf_explained_var": 0.007040482759475708, "kl": 0.009247818123569219, "entropy": 8.049885797500611, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 570000, "num_agent_steps_sampled": 1710000, "num_steps_trained": 570000, "num_agent_steps_trained": 1710000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1996, "training_iteration": 114, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-29-47", "timestamp": 1706228987, "time_this_iter_s": 10.554929494857788, "time_total_s": 1229.2465806007385, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028379E5E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1229.2465806007385, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 11.753333333333332, "ram_util_percent": 51.373333333333335}}
{"episode_reward_max": 161.9598611965776, "episode_reward_min": -302.3953186906874, "episode_reward_mean": 110.25695089903658, "episode_len_mean": 493.25, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -105.68111618359885}, "policy_reward_max": {"shared_policy": 54.137368219594165}, "policy_reward_mean": {"shared_policy": 36.75231696634553}, "custom_metrics": {}, "hist_stats": {"episode_reward": [115.51485852152106, 106.04788133502005, 117.85908069461581, 112.69566632062194, 138.8199036940934, 116.49812393449245, 117.04659646749495, 132.92760927230108, 142.97627612575894, 102.32700830698013, 92.36667877901345, 120.3529083933681, 84.27370363101362, 120.91474188771097, 116.86929873749614, -302.3953186906874, 104.43100808933377, 134.8353034537285, 105.52757409960029, 100.07726322114466, 124.2111614551395, 121.85254524089395, 135.497797742486, 70.9424480088055, 130.73072972893706, 149.50170758366576, 112.97054562810807, 105.36394161917269, 114.09906038641928, 130.10945206135506, 130.36885790154335, 127.10486770793793, 108.06648107804358, 121.5767654716037, 106.84122193977235, 99.2028010264039, 125.10365475714205, 131.5583513919263, 107.55096498131752, 107.75731501728296, 71.7606046590954, 117.40869555994867, 148.75971422344455, 136.50356616079813, 109.53692232072353, 135.26056125015012, 147.27619397640225, 99.8839104976505, 130.0191921598743, 161.9598611965776, 108.53976753912863, 117.99952412582934, 117.56625006720424, 103.61782982759178, 119.78496633283791, 116.80083256028593, 132.669252410531, 137.01192272827024, 130.55691099166881, 117.87362497486173, 95.81132604135198, 90.47620072215796, 137.28076073899837, 119.25659400969742, 141.00026809424193, 119.9999713525176, 115.21334620565173, 129.85340148955567, 122.1559582836926, 133.39953621104345, 116.27055570483205, 121.87429097667334, 96.56118831411003, 138.56642739847297, 127.39687095209955, 116.17269980721174, 119.55654261820015, 124.35211840458211, 116.21502146869896, 69.14006203226742, 143.7387602292002, 145.3735549077392, 127.69050493463874, -250.7989996895194, 95.70901176478947, 81.7997822500765, 137.10328528843826, 118.4647129131481, 101.58169127255675, 133.45820177812115, 98.5008979141712, 100.5973730906844, 140.20652315393087, 140.6996225602922, 82.34168512438191, 114.47752099484205, 106.52057143673301, 117.80547672510144, 126.47309480048713, 112.23173706233501], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 90, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 235, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [38.17789007226625, 38.705534918854624, 38.63143353040019, 35.66523802032073, 35.194336888690785, 35.18830642600854, 39.48632689813772, 39.476064952711255, 38.89668884376684, 37.49050487826267, 37.68136818955341, 37.52379325280586, 46.08387362211943, 46.314978171139956, 46.421051900833845, 38.58660027881463, 38.823036072154835, 39.08848758352299, 39.06282307704289, 38.79343019922574, 39.19034319122632, 44.65133463342984, 43.72490343948205, 44.551371199389294, 47.60825903962056, 47.65368347863357, 47.71433360750477, 34.119820676743984, 34.09884958341718, 34.10833804681897, 30.51400814950466, 30.77542719244957, 31.077243437059224, 40.424221717442066, 39.82496031622091, 40.10372635970512, 28.000471291442707, 28.297887125362948, 27.975345214207962, 39.95703875025113, 40.43961838756998, 40.518084749889866, 38.88273115456104, 38.959866689518094, 39.026700893417, -103.1777037618061, -105.68111618359885, -93.5364987452825, 34.619220808148384, 34.913759004324675, 34.898028276860714, 44.92764429499705, 44.85758253683646, 45.05007662189503, 35.19962243611613, 35.17687192062536, 35.1510797428588, 33.412726118539766, 33.270710350324705, 33.39382675228019, 41.48287762639423, 41.28221060832341, 41.446073220421866, 40.65402778362234, 40.496140388151005, 40.7023770691206, 44.80669317642847, 45.34391665707031, 45.347187908987195, 23.947655783345297, 23.535367009540394, 23.459425215919808, 43.60770082473755, 43.54509229212999, 43.57793661206961, 50.094115284581974, 49.62785508235295, 49.77973721673091, 37.77210072645296, 37.73287123565872, 37.46557366599639, 35.21436722576618, 35.4045621547848, 34.74501223862171, 37.95577623446782, 38.106579562028244, 38.03670458992322, 43.2771350989739, 43.37629476437965, 43.456022198001534, 43.724959410727024, 43.093262419104576, 43.55063607171178, 42.0611322770516, 42.50532853479186, 42.53840689609447, 35.797756642103195, 35.92041625827551, 36.348308177664876, 40.742024135465414, 40.10696044067541, 40.72778089546287, 35.772380140920475, 35.02625795205434, 36.04258384679754, 33.06370558217168, 33.03080214187503, 33.1082933023572, 41.681739566226796, 41.55332750578721, 41.86858768512805, 43.58607349793115, 43.80239678422609, 44.169881109769136, 35.574137553572655, 35.96896728873253, 36.00786013901234, 35.805646285414696, 35.98650421202183, 35.96516451984644, 23.77160345762968, 23.97023379430175, 24.018767407163978, 39.269777984668806, 39.360631724198655, 38.77828585108121, 49.96522143731515, 49.54945791761081, 49.245034868518516, 45.6573161954681, 45.35353989402452, 45.492710071305424, 36.62037295848131, 36.27147586643696, 36.64507349580526, 44.761813789606094, 45.59324013441801, 44.9055073261261, 48.95281620075305, 49.21050339688857, 49.11287437876065, 33.23263430222869, 33.37010489962995, 33.281171295791864, 43.52784952529085, 43.520958791797355, 42.97038384278615, 53.86255590120952, 54.137368219594165, 53.95993707577388, 35.868113110462815, 36.44286305146912, 36.2287913771967, 39.48491435684264, 39.183480620384216, 39.331129148602486, 39.048524141311646, 39.053392723202705, 39.464333202689886, 34.47655500471592, 34.760075775906444, 34.381199046969414, 40.0472371118764, 40.056384403879434, 39.68134481708208, 38.47618059813976, 39.11426145210862, 39.21039051003754, 44.2596810782949, 44.302294115225465, 44.10727721701065, 45.081320106983185, 46.06703033670783, 45.86357228457928, 43.62315194805463, 43.47819948693116, 43.4555595566829, 39.14146728565295, 39.34902447958787, 39.38313320962091, 32.144978613282234, 31.462991217772156, 32.203356210297585, 30.182513561099768, 30.284244645386934, 30.009442515671253, 45.94194237018624, 45.92590907464424, 45.412909294168145, 39.807320577402905, 39.727312852938965, 39.72196057935555, 46.785832223792866, 47.12302728494008, 47.09140858550866, 39.859319515526295, 40.22026501595974, 39.92038682103157, 38.56244958440462, 38.37101805458465, 38.27987856666246, 43.24660294006267, 43.41223262498775, 43.19456592450538, 40.881271278485656, 40.49066971987486, 40.784017285332084, 44.74447586014867, 44.34164425730705, 44.313416093587875, 38.75233194480339, 38.58593689898649, 38.93228686104217, 40.70868277053037, 40.407632562021405, 40.75797564412156, 32.182605908562735, 32.32695213456948, 32.05163027097781, 45.97474017490943, 46.30814553548892, 46.28354168807466, 42.235524644454316, 42.432607290645436, 42.728739016999796, 38.76940386680265, 38.77201275279124, 38.63128318761785, 40.201528277869016, 39.26023089389005, 40.094783446441085, 41.760396738226206, 40.9194823304812, 41.67223933587471, 38.869343147923544, 38.42875762780507, 38.91692069297035, 23.026836069921643, 22.864521893362195, 23.248704068983585, 47.92937135572235, 47.95340668658416, 47.85598218689363, 48.50716800987719, 48.26494404673575, 48.60144285112618, 42.52871982008219, 42.49729714542627, 42.66448796913028, -83.76056668162346, -83.77582733333111, -83.26260567456484, 31.722811430692673, 32.15896644588793, 31.827233888208866, 26.77355198065439, 27.559445238361747, 27.46678503106037, 45.54584639519453, 45.74419543519616, 45.81324345804751, 39.17542466521263, 39.70260850246996, 39.58667974546552, 33.640398318568856, 33.92240696648756, 34.01888598750034, 44.58035958154747, 44.408393210420996, 44.4694489861528, 32.51778021206458, 32.96217860405643, 33.02093909805019, 33.314827789862946, 33.48277900119622, 33.79976629962523, 47.37905848398803, 46.49340638518332, 46.33405828475951, 47.18553817644714, 46.4550460577011, 47.059038326144204, 27.49047379469266, 27.37081077322364, 27.48040055646561, 38.17672695964575, 38.08399226516485, 38.21680177003145, 35.69082127511501, 35.66004052385688, 35.169709637761116, 39.50781556653479, 38.8269083003203, 39.47075285824636, 42.076632178078086, 42.09156973535815, 42.3048928870509, 37.26823066174984, 37.452644769102335, 37.51086163148284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14592998502619017, "mean_inference_ms": 0.6979637355914413, "mean_action_processing_ms": 0.10156885062891881, "mean_env_wait_ms": 0.8502849103784256, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 575000, "timesteps_this_iter": 0, "agent_timesteps_total": 1725000, "timers": {"sample_time_ms": 11154.677, "sample_throughput": 448.242, "load_time_ms": 0.1, "load_throughput": 49955979.038, "learn_time_ms": 1650.489, "learn_throughput": 3029.404, "update_time_ms": 8.502}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.271806125530277e-26, "cur_lr": 0.0005000000000000001, "total_loss": 6.397618913650513, "policy_loss": -0.0014255732825398492, "vf_loss": 6.479904460906982, "vf_explained_var": -0.059690797328948976, "kl": 0.0033429837320187116, "entropy": 8.086028003692627, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 575000, "num_agent_steps_sampled": 1725000, "num_steps_trained": 575000, "num_agent_steps_trained": 1725000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2006, "training_iteration": 115, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-29-57", "timestamp": 1706228997, "time_this_iter_s": 9.985963821411133, "time_total_s": 1239.2325444221497, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202825774C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1239.2325444221497, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 8.264285714285714, "ram_util_percent": 47.6357142857143}}
{"episode_reward_max": 174.06556234229348, "episode_reward_min": -302.3953186906874, "episode_reward_mean": 110.0438313377602, "episode_len_mean": 493.25, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -105.68111618359885}, "policy_reward_max": {"shared_policy": 58.13700355434169}, "policy_reward_mean": {"shared_policy": 36.681277112586734}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.36667877901345, 120.3529083933681, 84.27370363101362, 120.91474188771097, 116.86929873749614, -302.3953186906874, 104.43100808933377, 134.8353034537285, 105.52757409960029, 100.07726322114466, 124.2111614551395, 121.85254524089395, 135.497797742486, 70.9424480088055, 130.73072972893706, 149.50170758366576, 112.97054562810807, 105.36394161917269, 114.09906038641928, 130.10945206135506, 130.36885790154335, 127.10486770793793, 108.06648107804358, 121.5767654716037, 106.84122193977235, 99.2028010264039, 125.10365475714205, 131.5583513919263, 107.55096498131752, 107.75731501728296, 71.7606046590954, 117.40869555994867, 148.75971422344455, 136.50356616079813, 109.53692232072353, 135.26056125015012, 147.27619397640225, 99.8839104976505, 130.0191921598743, 161.9598611965776, 108.53976753912863, 117.99952412582934, 117.56625006720424, 103.61782982759178, 119.78496633283791, 116.80083256028593, 132.669252410531, 137.01192272827024, 130.55691099166881, 117.87362497486173, 95.81132604135198, 90.47620072215796, 137.28076073899837, 119.25659400969742, 141.00026809424193, 119.9999713525176, 115.21334620565173, 129.85340148955567, 122.1559582836926, 133.39953621104345, 116.27055570483205, 121.87429097667334, 96.56118831411003, 138.56642739847297, 127.39687095209955, 116.17269980721174, 119.55654261820015, 124.35211840458211, 116.21502146869896, 69.14006203226742, 143.7387602292002, 145.3735549077392, 127.69050493463874, -250.7989996895194, 95.70901176478947, 81.7997822500765, 137.10328528843826, 118.4647129131481, 101.58169127255675, 133.45820177812115, 98.5008979141712, 100.5973730906844, 140.20652315393087, 140.6996225602922, 82.34168512438191, 114.47752099484205, 106.52057143673301, 117.80547672510144, 126.47309480048713, 112.23173706233501, 108.11489749699828, 107.11874271789563, 124.3071745969355, 115.27711706608534, 80.27116041630504, 103.8171029537916, 131.42558490205562, 128.11452589929092, 108.88918015360831, 174.06556234229348], "episode_lengths": [500, 500, 500, 500, 500, 90, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 235, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [30.51400814950466, 30.77542719244957, 31.077243437059224, 40.424221717442066, 39.82496031622091, 40.10372635970512, 28.000471291442707, 28.297887125362948, 27.975345214207962, 39.95703875025113, 40.43961838756998, 40.518084749889866, 38.88273115456104, 38.959866689518094, 39.026700893417, -103.1777037618061, -105.68111618359885, -93.5364987452825, 34.619220808148384, 34.913759004324675, 34.898028276860714, 44.92764429499705, 44.85758253683646, 45.05007662189503, 35.19962243611613, 35.17687192062536, 35.1510797428588, 33.412726118539766, 33.270710350324705, 33.39382675228019, 41.48287762639423, 41.28221060832341, 41.446073220421866, 40.65402778362234, 40.496140388151005, 40.7023770691206, 44.80669317642847, 45.34391665707031, 45.347187908987195, 23.947655783345297, 23.535367009540394, 23.459425215919808, 43.60770082473755, 43.54509229212999, 43.57793661206961, 50.094115284581974, 49.62785508235295, 49.77973721673091, 37.77210072645296, 37.73287123565872, 37.46557366599639, 35.21436722576618, 35.4045621547848, 34.74501223862171, 37.95577623446782, 38.106579562028244, 38.03670458992322, 43.2771350989739, 43.37629476437965, 43.456022198001534, 43.724959410727024, 43.093262419104576, 43.55063607171178, 42.0611322770516, 42.50532853479186, 42.53840689609447, 35.797756642103195, 35.92041625827551, 36.348308177664876, 40.742024135465414, 40.10696044067541, 40.72778089546287, 35.772380140920475, 35.02625795205434, 36.04258384679754, 33.06370558217168, 33.03080214187503, 33.1082933023572, 41.681739566226796, 41.55332750578721, 41.86858768512805, 43.58607349793115, 43.80239678422609, 44.169881109769136, 35.574137553572655, 35.96896728873253, 36.00786013901234, 35.805646285414696, 35.98650421202183, 35.96516451984644, 23.77160345762968, 23.97023379430175, 24.018767407163978, 39.269777984668806, 39.360631724198655, 38.77828585108121, 49.96522143731515, 49.54945791761081, 49.245034868518516, 45.6573161954681, 45.35353989402452, 45.492710071305424, 36.62037295848131, 36.27147586643696, 36.64507349580526, 44.761813789606094, 45.59324013441801, 44.9055073261261, 48.95281620075305, 49.21050339688857, 49.11287437876065, 33.23263430222869, 33.37010489962995, 33.281171295791864, 43.52784952529085, 43.520958791797355, 42.97038384278615, 53.86255590120952, 54.137368219594165, 53.95993707577388, 35.868113110462815, 36.44286305146912, 36.2287913771967, 39.48491435684264, 39.183480620384216, 39.331129148602486, 39.048524141311646, 39.053392723202705, 39.464333202689886, 34.47655500471592, 34.760075775906444, 34.381199046969414, 40.0472371118764, 40.056384403879434, 39.68134481708208, 38.47618059813976, 39.11426145210862, 39.21039051003754, 44.2596810782949, 44.302294115225465, 44.10727721701065, 45.081320106983185, 46.06703033670783, 45.86357228457928, 43.62315194805463, 43.47819948693116, 43.4555595566829, 39.14146728565295, 39.34902447958787, 39.38313320962091, 32.144978613282234, 31.462991217772156, 32.203356210297585, 30.182513561099768, 30.284244645386934, 30.009442515671253, 45.94194237018624, 45.92590907464424, 45.412909294168145, 39.807320577402905, 39.727312852938965, 39.72196057935555, 46.785832223792866, 47.12302728494008, 47.09140858550866, 39.859319515526295, 40.22026501595974, 39.92038682103157, 38.56244958440462, 38.37101805458465, 38.27987856666246, 43.24660294006267, 43.41223262498775, 43.19456592450538, 40.881271278485656, 40.49066971987486, 40.784017285332084, 44.74447586014867, 44.34164425730705, 44.313416093587875, 38.75233194480339, 38.58593689898649, 38.93228686104217, 40.70868277053037, 40.407632562021405, 40.75797564412156, 32.182605908562735, 32.32695213456948, 32.05163027097781, 45.97474017490943, 46.30814553548892, 46.28354168807466, 42.235524644454316, 42.432607290645436, 42.728739016999796, 38.76940386680265, 38.77201275279124, 38.63128318761785, 40.201528277869016, 39.26023089389005, 40.094783446441085, 41.760396738226206, 40.9194823304812, 41.67223933587471, 38.869343147923544, 38.42875762780507, 38.91692069297035, 23.026836069921643, 22.864521893362195, 23.248704068983585, 47.92937135572235, 47.95340668658416, 47.85598218689363, 48.50716800987719, 48.26494404673575, 48.60144285112618, 42.52871982008219, 42.49729714542627, 42.66448796913028, -83.76056668162346, -83.77582733333111, -83.26260567456484, 31.722811430692673, 32.15896644588793, 31.827233888208866, 26.77355198065439, 27.559445238361747, 27.46678503106037, 45.54584639519453, 45.74419543519616, 45.81324345804751, 39.17542466521263, 39.70260850246996, 39.58667974546552, 33.640398318568856, 33.92240696648756, 34.01888598750034, 44.58035958154747, 44.408393210420996, 44.4694489861528, 32.51778021206458, 32.96217860405643, 33.02093909805019, 33.314827789862946, 33.48277900119622, 33.79976629962523, 47.37905848398803, 46.49340638518332, 46.33405828475951, 47.18553817644714, 46.4550460577011, 47.059038326144204, 27.49047379469266, 27.37081077322364, 27.48040055646561, 38.17672695964575, 38.08399226516485, 38.21680177003145, 35.69082127511501, 35.66004052385688, 35.169709637761116, 39.50781556653479, 38.8269083003203, 39.47075285824636, 42.076632178078086, 42.09156973535815, 42.3048928870509, 37.26823066174984, 37.452644769102335, 37.51086163148284, 35.90283184001842, 36.150763804713876, 36.061301852265984, 35.93997369070226, 35.73125623414913, 35.44751279304424, 41.32105468710263, 41.466921017815665, 41.5191988920172, 38.3574630394578, 38.56925331801176, 38.35040070861578, 26.73740583161512, 26.761333557466656, 26.77242102722326, 34.47115833808978, 34.68309684594472, 34.66284776975711, 43.78179568424821, 43.849226656369865, 43.79456256143749, 42.494409680366516, 42.851492650806904, 42.76862356811762, 36.40247758229573, 36.36497281243403, 36.121729758878544, 58.13700355434169, 57.95953157668312, 57.96902721126874]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14600235354752697, "mean_inference_ms": 0.6985264346256489, "mean_action_processing_ms": 0.10163560885383627, "mean_env_wait_ms": 0.8503949794682856, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 580000, "timesteps_this_iter": 0, "agent_timesteps_total": 1740000, "timers": {"sample_time_ms": 11152.478, "sample_throughput": 448.331, "load_time_ms": 0.1, "load_throughput": 49955979.038, "learn_time_ms": 1645.131, "learn_throughput": 3039.272, "update_time_ms": 9.349}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.1359030627651386e-26, "cur_lr": 0.0005000000000000001, "total_loss": 6.520272350311279, "policy_loss": 0.0011782633191843805, "vf_loss": 6.6017663955688475, "vf_explained_var": -0.0330013632774353, "kl": 0.006122563523259664, "entropy": 8.26722412109375, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 580000, "num_agent_steps_sampled": 1740000, "num_steps_trained": 580000, "num_agent_steps_trained": 1740000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2016, "training_iteration": 116, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-30-08", "timestamp": 1706229008, "time_this_iter_s": 10.969783306121826, "time_total_s": 1250.2023277282715, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202846EF040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1250.2023277282715, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 14.556250000000002, "ram_util_percent": 49.431250000000006}}
{"episode_reward_max": 174.06556234229348, "episode_reward_min": -250.7989996895194, "episode_reward_mean": 114.1300643477519, "episode_len_mean": 497.35, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -83.77582733333111}, "policy_reward_max": {"shared_policy": 58.13700355434169}, "policy_reward_mean": {"shared_policy": 38.04335478258397}, "custom_metrics": {}, "hist_stats": {"episode_reward": [124.2111614551395, 121.85254524089395, 135.497797742486, 70.9424480088055, 130.73072972893706, 149.50170758366576, 112.97054562810807, 105.36394161917269, 114.09906038641928, 130.10945206135506, 130.36885790154335, 127.10486770793793, 108.06648107804358, 121.5767654716037, 106.84122193977235, 99.2028010264039, 125.10365475714205, 131.5583513919263, 107.55096498131752, 107.75731501728296, 71.7606046590954, 117.40869555994867, 148.75971422344455, 136.50356616079813, 109.53692232072353, 135.26056125015012, 147.27619397640225, 99.8839104976505, 130.0191921598743, 161.9598611965776, 108.53976753912863, 117.99952412582934, 117.56625006720424, 103.61782982759178, 119.78496633283791, 116.80083256028593, 132.669252410531, 137.01192272827024, 130.55691099166881, 117.87362497486173, 95.81132604135198, 90.47620072215796, 137.28076073899837, 119.25659400969742, 141.00026809424193, 119.9999713525176, 115.21334620565173, 129.85340148955567, 122.1559582836926, 133.39953621104345, 116.27055570483205, 121.87429097667334, 96.56118831411003, 138.56642739847297, 127.39687095209955, 116.17269980721174, 119.55654261820015, 124.35211840458211, 116.21502146869896, 69.14006203226742, 143.7387602292002, 145.3735549077392, 127.69050493463874, -250.7989996895194, 95.70901176478947, 81.7997822500765, 137.10328528843826, 118.4647129131481, 101.58169127255675, 133.45820177812115, 98.5008979141712, 100.5973730906844, 140.20652315393087, 140.6996225602922, 82.34168512438191, 114.47752099484205, 106.52057143673301, 117.80547672510144, 126.47309480048713, 112.23173706233501, 108.11489749699828, 107.11874271789563, 124.3071745969355, 115.27711706608534, 80.27116041630504, 103.8171029537916, 131.42558490205562, 128.11452589929092, 108.88918015360831, 174.06556234229348, 126.07863729912785, 83.61651208251713, 95.3029816970229, 110.33636136911808, 115.27121586166321, 128.87584234587848, 132.3500617966056, 99.95899866521358, 85.72883798996916, 108.35701349377631], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 235, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [41.48287762639423, 41.28221060832341, 41.446073220421866, 40.65402778362234, 40.496140388151005, 40.7023770691206, 44.80669317642847, 45.34391665707031, 45.347187908987195, 23.947655783345297, 23.535367009540394, 23.459425215919808, 43.60770082473755, 43.54509229212999, 43.57793661206961, 50.094115284581974, 49.62785508235295, 49.77973721673091, 37.77210072645296, 37.73287123565872, 37.46557366599639, 35.21436722576618, 35.4045621547848, 34.74501223862171, 37.95577623446782, 38.106579562028244, 38.03670458992322, 43.2771350989739, 43.37629476437965, 43.456022198001534, 43.724959410727024, 43.093262419104576, 43.55063607171178, 42.0611322770516, 42.50532853479186, 42.53840689609447, 35.797756642103195, 35.92041625827551, 36.348308177664876, 40.742024135465414, 40.10696044067541, 40.72778089546287, 35.772380140920475, 35.02625795205434, 36.04258384679754, 33.06370558217168, 33.03080214187503, 33.1082933023572, 41.681739566226796, 41.55332750578721, 41.86858768512805, 43.58607349793115, 43.80239678422609, 44.169881109769136, 35.574137553572655, 35.96896728873253, 36.00786013901234, 35.805646285414696, 35.98650421202183, 35.96516451984644, 23.77160345762968, 23.97023379430175, 24.018767407163978, 39.269777984668806, 39.360631724198655, 38.77828585108121, 49.96522143731515, 49.54945791761081, 49.245034868518516, 45.6573161954681, 45.35353989402452, 45.492710071305424, 36.62037295848131, 36.27147586643696, 36.64507349580526, 44.761813789606094, 45.59324013441801, 44.9055073261261, 48.95281620075305, 49.21050339688857, 49.11287437876065, 33.23263430222869, 33.37010489962995, 33.281171295791864, 43.52784952529085, 43.520958791797355, 42.97038384278615, 53.86255590120952, 54.137368219594165, 53.95993707577388, 35.868113110462815, 36.44286305146912, 36.2287913771967, 39.48491435684264, 39.183480620384216, 39.331129148602486, 39.048524141311646, 39.053392723202705, 39.464333202689886, 34.47655500471592, 34.760075775906444, 34.381199046969414, 40.0472371118764, 40.056384403879434, 39.68134481708208, 38.47618059813976, 39.11426145210862, 39.21039051003754, 44.2596810782949, 44.302294115225465, 44.10727721701065, 45.081320106983185, 46.06703033670783, 45.86357228457928, 43.62315194805463, 43.47819948693116, 43.4555595566829, 39.14146728565295, 39.34902447958787, 39.38313320962091, 32.144978613282234, 31.462991217772156, 32.203356210297585, 30.182513561099768, 30.284244645386934, 30.009442515671253, 45.94194237018624, 45.92590907464424, 45.412909294168145, 39.807320577402905, 39.727312852938965, 39.72196057935555, 46.785832223792866, 47.12302728494008, 47.09140858550866, 39.859319515526295, 40.22026501595974, 39.92038682103157, 38.56244958440462, 38.37101805458465, 38.27987856666246, 43.24660294006267, 43.41223262498775, 43.19456592450538, 40.881271278485656, 40.49066971987486, 40.784017285332084, 44.74447586014867, 44.34164425730705, 44.313416093587875, 38.75233194480339, 38.58593689898649, 38.93228686104217, 40.70868277053037, 40.407632562021405, 40.75797564412156, 32.182605908562735, 32.32695213456948, 32.05163027097781, 45.97474017490943, 46.30814553548892, 46.28354168807466, 42.235524644454316, 42.432607290645436, 42.728739016999796, 38.76940386680265, 38.77201275279124, 38.63128318761785, 40.201528277869016, 39.26023089389005, 40.094783446441085, 41.760396738226206, 40.9194823304812, 41.67223933587471, 38.869343147923544, 38.42875762780507, 38.91692069297035, 23.026836069921643, 22.864521893362195, 23.248704068983585, 47.92937135572235, 47.95340668658416, 47.85598218689363, 48.50716800987719, 48.26494404673575, 48.60144285112618, 42.52871982008219, 42.49729714542627, 42.66448796913028, -83.76056668162346, -83.77582733333111, -83.26260567456484, 31.722811430692673, 32.15896644588793, 31.827233888208866, 26.77355198065439, 27.559445238361747, 27.46678503106037, 45.54584639519453, 45.74419543519616, 45.81324345804751, 39.17542466521263, 39.70260850246996, 39.58667974546552, 33.640398318568856, 33.92240696648756, 34.01888598750034, 44.58035958154747, 44.408393210420996, 44.4694489861528, 32.51778021206458, 32.96217860405643, 33.02093909805019, 33.314827789862946, 33.48277900119622, 33.79976629962523, 47.37905848398803, 46.49340638518332, 46.33405828475951, 47.18553817644714, 46.4550460577011, 47.059038326144204, 27.49047379469266, 27.37081077322364, 27.48040055646561, 38.17672695964575, 38.08399226516485, 38.21680177003145, 35.69082127511501, 35.66004052385688, 35.169709637761116, 39.50781556653479, 38.8269083003203, 39.47075285824636, 42.076632178078086, 42.09156973535815, 42.3048928870509, 37.26823066174984, 37.452644769102335, 37.51086163148284, 35.90283184001842, 36.150763804713876, 36.061301852265984, 35.93997369070226, 35.73125623414913, 35.44751279304424, 41.32105468710263, 41.466921017815665, 41.5191988920172, 38.3574630394578, 38.56925331801176, 38.35040070861578, 26.73740583161512, 26.761333557466656, 26.77242102722326, 34.47115833808978, 34.68309684594472, 34.66284776975711, 43.78179568424821, 43.849226656369865, 43.79456256143749, 42.494409680366516, 42.851492650806904, 42.76862356811762, 36.40247758229573, 36.36497281243403, 36.121729758878544, 58.13700355434169, 57.95953157668312, 57.96902721126874, 42.106105274210364, 42.182589549260825, 41.78994247565666, 27.64392827947934, 27.99565204729636, 27.976931755741433, 31.319574018319443, 32.01178621811171, 31.97162146059175, 36.85412123178442, 36.56330758084853, 36.91893255648513, 38.16072533031304, 38.58351999086638, 38.52697054048379, 42.540725618600845, 43.13534871675074, 43.199768010526896, 44.22949923823276, 44.04858997712532, 44.07197258124748, 33.27412138134241, 33.16952186077833, 33.51535542309284, 28.53067236145337, 28.491606098910168, 28.706559529605627, 36.25212885191043, 36.12136021008094, 35.98352443178494]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14607689745563965, "mean_inference_ms": 0.6992630352223129, "mean_action_processing_ms": 0.1016948534227227, "mean_env_wait_ms": 0.8507045153169677, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 585000, "timesteps_this_iter": 0, "agent_timesteps_total": 1755000, "timers": {"sample_time_ms": 11094.521, "sample_throughput": 450.673, "load_time_ms": 0.1, "load_throughput": 49955979.038, "learn_time_ms": 1633.285, "learn_throughput": 3061.315, "update_time_ms": 9.199}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.1359030627651386e-26, "cur_lr": 0.0005000000000000001, "total_loss": 6.665497875213623, "policy_loss": 0.0006370487052093532, "vf_loss": 6.748798608779907, "vf_explained_var": -0.032105112075805665, "kl": 0.005525169614722777, "entropy": 8.393771171569824, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 585000, "num_agent_steps_sampled": 1755000, "num_steps_trained": 585000, "num_agent_steps_trained": 1755000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2026, "training_iteration": 117, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-30-19", "timestamp": 1706229019, "time_this_iter_s": 10.300041913986206, "time_total_s": 1260.5023696422577, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282542C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1260.5023696422577, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 12.466666666666667, "ram_util_percent": 48.839999999999996}}
{"episode_reward_max": 174.06556234229348, "episode_reward_min": -250.7989996895194, "episode_reward_mean": 113.69484586717809, "episode_len_mean": 497.35, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -83.77582733333111}, "policy_reward_max": {"shared_policy": 58.13700355434169}, "policy_reward_mean": {"shared_policy": 37.89828195572601}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.36885790154335, 127.10486770793793, 108.06648107804358, 121.5767654716037, 106.84122193977235, 99.2028010264039, 125.10365475714205, 131.5583513919263, 107.55096498131752, 107.75731501728296, 71.7606046590954, 117.40869555994867, 148.75971422344455, 136.50356616079813, 109.53692232072353, 135.26056125015012, 147.27619397640225, 99.8839104976505, 130.0191921598743, 161.9598611965776, 108.53976753912863, 117.99952412582934, 117.56625006720424, 103.61782982759178, 119.78496633283791, 116.80083256028593, 132.669252410531, 137.01192272827024, 130.55691099166881, 117.87362497486173, 95.81132604135198, 90.47620072215796, 137.28076073899837, 119.25659400969742, 141.00026809424193, 119.9999713525176, 115.21334620565173, 129.85340148955567, 122.1559582836926, 133.39953621104345, 116.27055570483205, 121.87429097667334, 96.56118831411003, 138.56642739847297, 127.39687095209955, 116.17269980721174, 119.55654261820015, 124.35211840458211, 116.21502146869896, 69.14006203226742, 143.7387602292002, 145.3735549077392, 127.69050493463874, -250.7989996895194, 95.70901176478947, 81.7997822500765, 137.10328528843826, 118.4647129131481, 101.58169127255675, 133.45820177812115, 98.5008979141712, 100.5973730906844, 140.20652315393087, 140.6996225602922, 82.34168512438191, 114.47752099484205, 106.52057143673301, 117.80547672510144, 126.47309480048713, 112.23173706233501, 108.11489749699828, 107.11874271789563, 124.3071745969355, 115.27711706608534, 80.27116041630504, 103.8171029537916, 131.42558490205562, 128.11452589929092, 108.88918015360831, 174.06556234229348, 126.07863729912785, 83.61651208251713, 95.3029816970229, 110.33636136911808, 115.27121586166321, 128.87584234587848, 132.3500617966056, 99.95899866521358, 85.72883798996916, 108.35701349377631, 129.94695825502274, 104.36894028820097, 96.40480674710122, 109.79986480623481, 104.37918731942773, 118.21321404063198, 100.22193590505046, 124.24150775617454, 145.43262958340352, 118.74849669635293], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 235, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [43.724959410727024, 43.093262419104576, 43.55063607171178, 42.0611322770516, 42.50532853479186, 42.53840689609447, 35.797756642103195, 35.92041625827551, 36.348308177664876, 40.742024135465414, 40.10696044067541, 40.72778089546287, 35.772380140920475, 35.02625795205434, 36.04258384679754, 33.06370558217168, 33.03080214187503, 33.1082933023572, 41.681739566226796, 41.55332750578721, 41.86858768512805, 43.58607349793115, 43.80239678422609, 44.169881109769136, 35.574137553572655, 35.96896728873253, 36.00786013901234, 35.805646285414696, 35.98650421202183, 35.96516451984644, 23.77160345762968, 23.97023379430175, 24.018767407163978, 39.269777984668806, 39.360631724198655, 38.77828585108121, 49.96522143731515, 49.54945791761081, 49.245034868518516, 45.6573161954681, 45.35353989402452, 45.492710071305424, 36.62037295848131, 36.27147586643696, 36.64507349580526, 44.761813789606094, 45.59324013441801, 44.9055073261261, 48.95281620075305, 49.21050339688857, 49.11287437876065, 33.23263430222869, 33.37010489962995, 33.281171295791864, 43.52784952529085, 43.520958791797355, 42.97038384278615, 53.86255590120952, 54.137368219594165, 53.95993707577388, 35.868113110462815, 36.44286305146912, 36.2287913771967, 39.48491435684264, 39.183480620384216, 39.331129148602486, 39.048524141311646, 39.053392723202705, 39.464333202689886, 34.47655500471592, 34.760075775906444, 34.381199046969414, 40.0472371118764, 40.056384403879434, 39.68134481708208, 38.47618059813976, 39.11426145210862, 39.21039051003754, 44.2596810782949, 44.302294115225465, 44.10727721701065, 45.081320106983185, 46.06703033670783, 45.86357228457928, 43.62315194805463, 43.47819948693116, 43.4555595566829, 39.14146728565295, 39.34902447958787, 39.38313320962091, 32.144978613282234, 31.462991217772156, 32.203356210297585, 30.182513561099768, 30.284244645386934, 30.009442515671253, 45.94194237018624, 45.92590907464424, 45.412909294168145, 39.807320577402905, 39.727312852938965, 39.72196057935555, 46.785832223792866, 47.12302728494008, 47.09140858550866, 39.859319515526295, 40.22026501595974, 39.92038682103157, 38.56244958440462, 38.37101805458465, 38.27987856666246, 43.24660294006267, 43.41223262498775, 43.19456592450538, 40.881271278485656, 40.49066971987486, 40.784017285332084, 44.74447586014867, 44.34164425730705, 44.313416093587875, 38.75233194480339, 38.58593689898649, 38.93228686104217, 40.70868277053037, 40.407632562021405, 40.75797564412156, 32.182605908562735, 32.32695213456948, 32.05163027097781, 45.97474017490943, 46.30814553548892, 46.28354168807466, 42.235524644454316, 42.432607290645436, 42.728739016999796, 38.76940386680265, 38.77201275279124, 38.63128318761785, 40.201528277869016, 39.26023089389005, 40.094783446441085, 41.760396738226206, 40.9194823304812, 41.67223933587471, 38.869343147923544, 38.42875762780507, 38.91692069297035, 23.026836069921643, 22.864521893362195, 23.248704068983585, 47.92937135572235, 47.95340668658416, 47.85598218689363, 48.50716800987719, 48.26494404673575, 48.60144285112618, 42.52871982008219, 42.49729714542627, 42.66448796913028, -83.76056668162346, -83.77582733333111, -83.26260567456484, 31.722811430692673, 32.15896644588793, 31.827233888208866, 26.77355198065439, 27.559445238361747, 27.46678503106037, 45.54584639519453, 45.74419543519616, 45.81324345804751, 39.17542466521263, 39.70260850246996, 39.58667974546552, 33.640398318568856, 33.92240696648756, 34.01888598750034, 44.58035958154747, 44.408393210420996, 44.4694489861528, 32.51778021206458, 32.96217860405643, 33.02093909805019, 33.314827789862946, 33.48277900119622, 33.79976629962523, 47.37905848398803, 46.49340638518332, 46.33405828475951, 47.18553817644714, 46.4550460577011, 47.059038326144204, 27.49047379469266, 27.37081077322364, 27.48040055646561, 38.17672695964575, 38.08399226516485, 38.21680177003145, 35.69082127511501, 35.66004052385688, 35.169709637761116, 39.50781556653479, 38.8269083003203, 39.47075285824636, 42.076632178078086, 42.09156973535815, 42.3048928870509, 37.26823066174984, 37.452644769102335, 37.51086163148284, 35.90283184001842, 36.150763804713876, 36.061301852265984, 35.93997369070226, 35.73125623414913, 35.44751279304424, 41.32105468710263, 41.466921017815665, 41.5191988920172, 38.3574630394578, 38.56925331801176, 38.35040070861578, 26.73740583161512, 26.761333557466656, 26.77242102722326, 34.47115833808978, 34.68309684594472, 34.66284776975711, 43.78179568424821, 43.849226656369865, 43.79456256143749, 42.494409680366516, 42.851492650806904, 42.76862356811762, 36.40247758229573, 36.36497281243403, 36.121729758878544, 58.13700355434169, 57.95953157668312, 57.96902721126874, 42.106105274210364, 42.182589549260825, 41.78994247565666, 27.64392827947934, 27.99565204729636, 27.976931755741433, 31.319574018319443, 32.01178621811171, 31.97162146059175, 36.85412123178442, 36.56330758084853, 36.91893255648513, 38.16072533031304, 38.58351999086638, 38.52697054048379, 42.540725618600845, 43.13534871675074, 43.199768010526896, 44.22949923823276, 44.04858997712532, 44.07197258124748, 33.27412138134241, 33.16952186077833, 33.51535542309284, 28.53067236145337, 28.491606098910168, 28.706559529605627, 36.25212885191043, 36.12136021008094, 35.98352443178494, 43.05477298796177, 43.58074666932225, 43.31143859773874, 34.6558106765151, 34.87060218397528, 34.84252742771059, 31.944020124773175, 32.17182524005571, 32.28896138227233, 36.38851900647083, 36.62914895514646, 36.782196844617516, 34.99068344011903, 34.977463483810425, 34.411040395498276, 39.62299812916413, 39.16704465697208, 39.42317125449577, 33.4860925899508, 33.378002875174076, 33.35784043992558, 41.63805347273592, 41.578429772518575, 41.02502451092005, 48.41096685205896, 48.59281409469743, 48.42884863664706, 39.25846772889295, 39.87021292249361, 39.61981604496637]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1461125678268827, "mean_inference_ms": 0.6996618494417071, "mean_action_processing_ms": 0.10173053698762029, "mean_env_wait_ms": 0.8506849407310996, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 590000, "timesteps_this_iter": 0, "agent_timesteps_total": 1770000, "timers": {"sample_time_ms": 10957.896, "sample_throughput": 456.292, "load_time_ms": 0.1, "load_throughput": 49955979.038, "learn_time_ms": 1621.071, "learn_throughput": 3084.38, "update_time_ms": 8.698}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.1359030627651386e-26, "cur_lr": 0.0005000000000000001, "total_loss": 6.493870639801026, "policy_loss": -0.0015536947902419663, "vf_loss": 6.577900552749634, "vf_explained_var": -0.0473615288734436, "kl": 0.002950422058367577, "entropy": 8.247589778900146, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 590000, "num_agent_steps_sampled": 1770000, "num_steps_trained": 590000, "num_agent_steps_trained": 1770000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2036, "training_iteration": 118, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-30-29", "timestamp": 1706229029, "time_this_iter_s": 9.858753442764282, "time_total_s": 1270.361123085022, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202846EF9D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1270.361123085022, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 11.72857142857143, "ram_util_percent": 49.3}}
{"episode_reward_max": 174.06556234229348, "episode_reward_min": -250.7989996895194, "episode_reward_mean": 114.72100443794174, "episode_len_mean": 497.35, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -83.77582733333111}, "policy_reward_max": {"shared_policy": 58.13700355434169}, "policy_reward_mean": {"shared_policy": 38.24033481264724}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.7606046590954, 117.40869555994867, 148.75971422344455, 136.50356616079813, 109.53692232072353, 135.26056125015012, 147.27619397640225, 99.8839104976505, 130.0191921598743, 161.9598611965776, 108.53976753912863, 117.99952412582934, 117.56625006720424, 103.61782982759178, 119.78496633283791, 116.80083256028593, 132.669252410531, 137.01192272827024, 130.55691099166881, 117.87362497486173, 95.81132604135198, 90.47620072215796, 137.28076073899837, 119.25659400969742, 141.00026809424193, 119.9999713525176, 115.21334620565173, 129.85340148955567, 122.1559582836926, 133.39953621104345, 116.27055570483205, 121.87429097667334, 96.56118831411003, 138.56642739847297, 127.39687095209955, 116.17269980721174, 119.55654261820015, 124.35211840458211, 116.21502146869896, 69.14006203226742, 143.7387602292002, 145.3735549077392, 127.69050493463874, -250.7989996895194, 95.70901176478947, 81.7997822500765, 137.10328528843826, 118.4647129131481, 101.58169127255675, 133.45820177812115, 98.5008979141712, 100.5973730906844, 140.20652315393087, 140.6996225602922, 82.34168512438191, 114.47752099484205, 106.52057143673301, 117.80547672510144, 126.47309480048713, 112.23173706233501, 108.11489749699828, 107.11874271789563, 124.3071745969355, 115.27711706608534, 80.27116041630504, 103.8171029537916, 131.42558490205562, 128.11452589929092, 108.88918015360831, 174.06556234229348, 126.07863729912785, 83.61651208251713, 95.3029816970229, 110.33636136911808, 115.27121586166321, 128.87584234587848, 132.3500617966056, 99.95899866521358, 85.72883798996916, 108.35701349377631, 129.94695825502274, 104.36894028820097, 96.40480674710122, 109.79986480623481, 104.37918731942773, 118.21321404063198, 100.22193590505046, 124.24150775617454, 145.43262958340352, 118.74849669635293, 109.36565037071703, 144.6406906917691, 103.9353267997503, 117.59267680719495, 116.43937301635742, 127.98621773347257, 142.25963707640776, 128.9995998106897, 116.01279223896562, 160.5151738040149], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 235, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [23.77160345762968, 23.97023379430175, 24.018767407163978, 39.269777984668806, 39.360631724198655, 38.77828585108121, 49.96522143731515, 49.54945791761081, 49.245034868518516, 45.6573161954681, 45.35353989402452, 45.492710071305424, 36.62037295848131, 36.27147586643696, 36.64507349580526, 44.761813789606094, 45.59324013441801, 44.9055073261261, 48.95281620075305, 49.21050339688857, 49.11287437876065, 33.23263430222869, 33.37010489962995, 33.281171295791864, 43.52784952529085, 43.520958791797355, 42.97038384278615, 53.86255590120952, 54.137368219594165, 53.95993707577388, 35.868113110462815, 36.44286305146912, 36.2287913771967, 39.48491435684264, 39.183480620384216, 39.331129148602486, 39.048524141311646, 39.053392723202705, 39.464333202689886, 34.47655500471592, 34.760075775906444, 34.381199046969414, 40.0472371118764, 40.056384403879434, 39.68134481708208, 38.47618059813976, 39.11426145210862, 39.21039051003754, 44.2596810782949, 44.302294115225465, 44.10727721701065, 45.081320106983185, 46.06703033670783, 45.86357228457928, 43.62315194805463, 43.47819948693116, 43.4555595566829, 39.14146728565295, 39.34902447958787, 39.38313320962091, 32.144978613282234, 31.462991217772156, 32.203356210297585, 30.182513561099768, 30.284244645386934, 30.009442515671253, 45.94194237018624, 45.92590907464424, 45.412909294168145, 39.807320577402905, 39.727312852938965, 39.72196057935555, 46.785832223792866, 47.12302728494008, 47.09140858550866, 39.859319515526295, 40.22026501595974, 39.92038682103157, 38.56244958440462, 38.37101805458465, 38.27987856666246, 43.24660294006267, 43.41223262498775, 43.19456592450538, 40.881271278485656, 40.49066971987486, 40.784017285332084, 44.74447586014867, 44.34164425730705, 44.313416093587875, 38.75233194480339, 38.58593689898649, 38.93228686104217, 40.70868277053037, 40.407632562021405, 40.75797564412156, 32.182605908562735, 32.32695213456948, 32.05163027097781, 45.97474017490943, 46.30814553548892, 46.28354168807466, 42.235524644454316, 42.432607290645436, 42.728739016999796, 38.76940386680265, 38.77201275279124, 38.63128318761785, 40.201528277869016, 39.26023089389005, 40.094783446441085, 41.760396738226206, 40.9194823304812, 41.67223933587471, 38.869343147923544, 38.42875762780507, 38.91692069297035, 23.026836069921643, 22.864521893362195, 23.248704068983585, 47.92937135572235, 47.95340668658416, 47.85598218689363, 48.50716800987719, 48.26494404673575, 48.60144285112618, 42.52871982008219, 42.49729714542627, 42.66448796913028, -83.76056668162346, -83.77582733333111, -83.26260567456484, 31.722811430692673, 32.15896644588793, 31.827233888208866, 26.77355198065439, 27.559445238361747, 27.46678503106037, 45.54584639519453, 45.74419543519616, 45.81324345804751, 39.17542466521263, 39.70260850246996, 39.58667974546552, 33.640398318568856, 33.92240696648756, 34.01888598750034, 44.58035958154747, 44.408393210420996, 44.4694489861528, 32.51778021206458, 32.96217860405643, 33.02093909805019, 33.314827789862946, 33.48277900119622, 33.79976629962523, 47.37905848398803, 46.49340638518332, 46.33405828475951, 47.18553817644714, 46.4550460577011, 47.059038326144204, 27.49047379469266, 27.37081077322364, 27.48040055646561, 38.17672695964575, 38.08399226516485, 38.21680177003145, 35.69082127511501, 35.66004052385688, 35.169709637761116, 39.50781556653479, 38.8269083003203, 39.47075285824636, 42.076632178078086, 42.09156973535815, 42.3048928870509, 37.26823066174984, 37.452644769102335, 37.51086163148284, 35.90283184001842, 36.150763804713876, 36.061301852265984, 35.93997369070226, 35.73125623414913, 35.44751279304424, 41.32105468710263, 41.466921017815665, 41.5191988920172, 38.3574630394578, 38.56925331801176, 38.35040070861578, 26.73740583161512, 26.761333557466656, 26.77242102722326, 34.47115833808978, 34.68309684594472, 34.66284776975711, 43.78179568424821, 43.849226656369865, 43.79456256143749, 42.494409680366516, 42.851492650806904, 42.76862356811762, 36.40247758229573, 36.36497281243403, 36.121729758878544, 58.13700355434169, 57.95953157668312, 57.96902721126874, 42.106105274210364, 42.182589549260825, 41.78994247565666, 27.64392827947934, 27.99565204729636, 27.976931755741433, 31.319574018319443, 32.01178621811171, 31.97162146059175, 36.85412123178442, 36.56330758084853, 36.91893255648513, 38.16072533031304, 38.58351999086638, 38.52697054048379, 42.540725618600845, 43.13534871675074, 43.199768010526896, 44.22949923823276, 44.04858997712532, 44.07197258124748, 33.27412138134241, 33.16952186077833, 33.51535542309284, 28.53067236145337, 28.491606098910168, 28.706559529605627, 36.25212885191043, 36.12136021008094, 35.98352443178494, 43.05477298796177, 43.58074666932225, 43.31143859773874, 34.6558106765151, 34.87060218397528, 34.84252742771059, 31.944020124773175, 32.17182524005571, 32.28896138227233, 36.38851900647083, 36.62914895514646, 36.782196844617516, 34.99068344011903, 34.977463483810425, 34.411040395498276, 39.62299812916413, 39.16704465697208, 39.42317125449577, 33.4860925899508, 33.378002875174076, 33.35784043992558, 41.63805347273592, 41.578429772518575, 41.02502451092005, 48.41096685205896, 48.59281409469743, 48.42884863664706, 39.25846772889295, 39.87021292249361, 39.61981604496637, 36.36084712793429, 36.50209167723854, 36.5027115655442, 48.29250959306954, 48.097308143973336, 48.250872954726205, 34.55489402512708, 34.53998258213201, 34.840450192491204, 39.085448913276196, 39.23506296053529, 39.272164933383465, 38.92275360971689, 38.879593290388584, 38.637026116251945, 42.87221482520302, 42.76581846674283, 42.348184441526726, 47.41642451410492, 47.55553037424882, 47.28768218805392, 43.047148652374744, 42.903206415474415, 43.04924474284053, 38.74548898575206, 38.445874643822506, 38.82142860939105, 53.64992748325069, 53.75575227042039, 53.10949405034383]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14612592943912664, "mean_inference_ms": 0.6999508049796235, "mean_action_processing_ms": 0.10174786513395462, "mean_env_wait_ms": 0.8505929679137428, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 595000, "timesteps_this_iter": 0, "agent_timesteps_total": 1785000, "timers": {"sample_time_ms": 10811.885, "sample_throughput": 462.454, "load_time_ms": 0.1, "load_throughput": 49955979.038, "learn_time_ms": 1632.191, "learn_throughput": 3063.367, "update_time_ms": 8.801}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.0679515313825693e-26, "cur_lr": 0.0005000000000000001, "total_loss": 7.53661847114563, "policy_loss": 0.00042589252522677866, "vf_loss": 7.618870544433594, "vf_explained_var": -0.0261019229888916, "kl": 0.004582176264394966, "entropy": 8.267777919769287, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 595000, "num_agent_steps_sampled": 1785000, "num_steps_trained": 595000, "num_agent_steps_trained": 1785000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2046, "training_iteration": 119, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-30-39", "timestamp": 1706229039, "time_this_iter_s": 10.232424974441528, "time_total_s": 1280.5935480594635, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202823BECA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1280.5935480594635, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 10.871428571428572, "ram_util_percent": 49.464285714285715}}
{"episode_reward_max": 174.06556234229348, "episode_reward_min": -250.7989996895194, "episode_reward_mean": 113.79298482199214, "episode_len_mean": 497.35, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -83.77582733333111}, "policy_reward_max": {"shared_policy": 58.13700355434169}, "policy_reward_mean": {"shared_policy": 37.93099494066404}, "custom_metrics": {}, "hist_stats": {"episode_reward": [108.53976753912863, 117.99952412582934, 117.56625006720424, 103.61782982759178, 119.78496633283791, 116.80083256028593, 132.669252410531, 137.01192272827024, 130.55691099166881, 117.87362497486173, 95.81132604135198, 90.47620072215796, 137.28076073899837, 119.25659400969742, 141.00026809424193, 119.9999713525176, 115.21334620565173, 129.85340148955567, 122.1559582836926, 133.39953621104345, 116.27055570483205, 121.87429097667334, 96.56118831411003, 138.56642739847297, 127.39687095209955, 116.17269980721174, 119.55654261820015, 124.35211840458211, 116.21502146869896, 69.14006203226742, 143.7387602292002, 145.3735549077392, 127.69050493463874, -250.7989996895194, 95.70901176478947, 81.7997822500765, 137.10328528843826, 118.4647129131481, 101.58169127255675, 133.45820177812115, 98.5008979141712, 100.5973730906844, 140.20652315393087, 140.6996225602922, 82.34168512438191, 114.47752099484205, 106.52057143673301, 117.80547672510144, 126.47309480048713, 112.23173706233501, 108.11489749699828, 107.11874271789563, 124.3071745969355, 115.27711706608534, 80.27116041630504, 103.8171029537916, 131.42558490205562, 128.11452589929092, 108.88918015360831, 174.06556234229348, 126.07863729912785, 83.61651208251713, 95.3029816970229, 110.33636136911808, 115.27121586166321, 128.87584234587848, 132.3500617966056, 99.95899866521358, 85.72883798996916, 108.35701349377631, 129.94695825502274, 104.36894028820097, 96.40480674710122, 109.79986480623481, 104.37918731942773, 118.21321404063198, 100.22193590505046, 124.24150775617454, 145.43262958340352, 118.74849669635293, 109.36565037071703, 144.6406906917691, 103.9353267997503, 117.59267680719495, 116.43937301635742, 127.98621773347257, 142.25963707640776, 128.9995998106897, 116.01279223896562, 160.5151738040149, 147.06603925395783, 106.49832113273439, 106.69006910920143, 116.86587880179283, 108.02742756716906, 112.73123339563608, 121.74710150808093, 111.54445324465632, 121.7799439281225, 112.61679246835409], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 235, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [35.868113110462815, 36.44286305146912, 36.2287913771967, 39.48491435684264, 39.183480620384216, 39.331129148602486, 39.048524141311646, 39.053392723202705, 39.464333202689886, 34.47655500471592, 34.760075775906444, 34.381199046969414, 40.0472371118764, 40.056384403879434, 39.68134481708208, 38.47618059813976, 39.11426145210862, 39.21039051003754, 44.2596810782949, 44.302294115225465, 44.10727721701065, 45.081320106983185, 46.06703033670783, 45.86357228457928, 43.62315194805463, 43.47819948693116, 43.4555595566829, 39.14146728565295, 39.34902447958787, 39.38313320962091, 32.144978613282234, 31.462991217772156, 32.203356210297585, 30.182513561099768, 30.284244645386934, 30.009442515671253, 45.94194237018624, 45.92590907464424, 45.412909294168145, 39.807320577402905, 39.727312852938965, 39.72196057935555, 46.785832223792866, 47.12302728494008, 47.09140858550866, 39.859319515526295, 40.22026501595974, 39.92038682103157, 38.56244958440462, 38.37101805458465, 38.27987856666246, 43.24660294006267, 43.41223262498775, 43.19456592450538, 40.881271278485656, 40.49066971987486, 40.784017285332084, 44.74447586014867, 44.34164425730705, 44.313416093587875, 38.75233194480339, 38.58593689898649, 38.93228686104217, 40.70868277053037, 40.407632562021405, 40.75797564412156, 32.182605908562735, 32.32695213456948, 32.05163027097781, 45.97474017490943, 46.30814553548892, 46.28354168807466, 42.235524644454316, 42.432607290645436, 42.728739016999796, 38.76940386680265, 38.77201275279124, 38.63128318761785, 40.201528277869016, 39.26023089389005, 40.094783446441085, 41.760396738226206, 40.9194823304812, 41.67223933587471, 38.869343147923544, 38.42875762780507, 38.91692069297035, 23.026836069921643, 22.864521893362195, 23.248704068983585, 47.92937135572235, 47.95340668658416, 47.85598218689363, 48.50716800987719, 48.26494404673575, 48.60144285112618, 42.52871982008219, 42.49729714542627, 42.66448796913028, -83.76056668162346, -83.77582733333111, -83.26260567456484, 31.722811430692673, 32.15896644588793, 31.827233888208866, 26.77355198065439, 27.559445238361747, 27.46678503106037, 45.54584639519453, 45.74419543519616, 45.81324345804751, 39.17542466521263, 39.70260850246996, 39.58667974546552, 33.640398318568856, 33.92240696648756, 34.01888598750034, 44.58035958154747, 44.408393210420996, 44.4694489861528, 32.51778021206458, 32.96217860405643, 33.02093909805019, 33.314827789862946, 33.48277900119622, 33.79976629962523, 47.37905848398803, 46.49340638518332, 46.33405828475951, 47.18553817644714, 46.4550460577011, 47.059038326144204, 27.49047379469266, 27.37081077322364, 27.48040055646561, 38.17672695964575, 38.08399226516485, 38.21680177003145, 35.69082127511501, 35.66004052385688, 35.169709637761116, 39.50781556653479, 38.8269083003203, 39.47075285824636, 42.076632178078086, 42.09156973535815, 42.3048928870509, 37.26823066174984, 37.452644769102335, 37.51086163148284, 35.90283184001842, 36.150763804713876, 36.061301852265984, 35.93997369070226, 35.73125623414913, 35.44751279304424, 41.32105468710263, 41.466921017815665, 41.5191988920172, 38.3574630394578, 38.56925331801176, 38.35040070861578, 26.73740583161512, 26.761333557466656, 26.77242102722326, 34.47115833808978, 34.68309684594472, 34.66284776975711, 43.78179568424821, 43.849226656369865, 43.79456256143749, 42.494409680366516, 42.851492650806904, 42.76862356811762, 36.40247758229573, 36.36497281243403, 36.121729758878544, 58.13700355434169, 57.95953157668312, 57.96902721126874, 42.106105274210364, 42.182589549260825, 41.78994247565666, 27.64392827947934, 27.99565204729636, 27.976931755741433, 31.319574018319443, 32.01178621811171, 31.97162146059175, 36.85412123178442, 36.56330758084853, 36.91893255648513, 38.16072533031304, 38.58351999086638, 38.52697054048379, 42.540725618600845, 43.13534871675074, 43.199768010526896, 44.22949923823276, 44.04858997712532, 44.07197258124748, 33.27412138134241, 33.16952186077833, 33.51535542309284, 28.53067236145337, 28.491606098910168, 28.706559529605627, 36.25212885191043, 36.12136021008094, 35.98352443178494, 43.05477298796177, 43.58074666932225, 43.31143859773874, 34.6558106765151, 34.87060218397528, 34.84252742771059, 31.944020124773175, 32.17182524005571, 32.28896138227233, 36.38851900647083, 36.62914895514646, 36.782196844617516, 34.99068344011903, 34.977463483810425, 34.411040395498276, 39.62299812916413, 39.16704465697208, 39.42317125449577, 33.4860925899508, 33.378002875174076, 33.35784043992558, 41.63805347273592, 41.578429772518575, 41.02502451092005, 48.41096685205896, 48.59281409469743, 48.42884863664706, 39.25846772889295, 39.87021292249361, 39.61981604496637, 36.36084712793429, 36.50209167723854, 36.5027115655442, 48.29250959306954, 48.097308143973336, 48.250872954726205, 34.55489402512708, 34.53998258213201, 34.840450192491204, 39.085448913276196, 39.23506296053529, 39.272164933383465, 38.92275360971689, 38.879593290388584, 38.637026116251945, 42.87221482520302, 42.76581846674283, 42.348184441526726, 47.41642451410492, 47.55553037424882, 47.28768218805392, 43.047148652374744, 42.903206415474415, 43.04924474284053, 38.74548898575206, 38.445874643822506, 38.82142860939105, 53.64992748325069, 53.75575227042039, 53.10949405034383, 49.277510694849, 49.30513230214517, 48.48339625696342, 35.58294401379922, 35.36632830152908, 35.54904881740609, 35.61239895969629, 35.62007160484791, 35.45759854465723, 38.75911373893419, 39.00320353234807, 39.103561530510575, 35.89021702234943, 36.15564487812419, 35.98156566669543, 37.80247477442026, 37.55683296918869, 37.37192565202713, 40.38740987579027, 40.658525868008525, 40.70116576428214, 37.2972955442965, 36.91380661725998, 37.33335108309984, 40.548598666985825, 40.5561235298713, 40.67522173126538, 37.19837087144454, 37.725419764717415, 37.69300183219214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14611168564211552, "mean_inference_ms": 0.7001272980408616, "mean_action_processing_ms": 0.10174864981739164, "mean_env_wait_ms": 0.8503966238581966, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 600000, "timesteps_this_iter": 0, "agent_timesteps_total": 1800000, "timers": {"sample_time_ms": 10700.261, "sample_throughput": 467.278, "load_time_ms": 0.1, "load_throughput": 49955979.038, "learn_time_ms": 1618.387, "learn_throughput": 3089.495, "update_time_ms": 9.034}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0339757656912847e-26, "cur_lr": 0.0005000000000000001, "total_loss": 6.027768087387085, "policy_loss": 0.0022604716398442193, "vf_loss": 6.109995555877686, "vf_explained_var": -0.03762199878692627, "kl": 0.006855831784218477, "entropy": 8.448763656616212, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 600000, "num_agent_steps_sampled": 1800000, "num_steps_trained": 600000, "num_agent_steps_trained": 1800000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2056, "training_iteration": 120, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-30-50", "timestamp": 1706229050, "time_this_iter_s": 11.068010568618774, "time_total_s": 1291.6615586280823, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028379E310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1291.6615586280823, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 11.2125, "ram_util_percent": 50.03125}}
{"episode_reward_max": 174.06556234229348, "episode_reward_min": -250.7989996895194, "episode_reward_mean": 112.88012800238343, "episode_len_mean": 497.35, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -83.77582733333111}, "policy_reward_max": {"shared_policy": 58.13700355434169}, "policy_reward_mean": {"shared_policy": 37.6267093341278}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.81132604135198, 90.47620072215796, 137.28076073899837, 119.25659400969742, 141.00026809424193, 119.9999713525176, 115.21334620565173, 129.85340148955567, 122.1559582836926, 133.39953621104345, 116.27055570483205, 121.87429097667334, 96.56118831411003, 138.56642739847297, 127.39687095209955, 116.17269980721174, 119.55654261820015, 124.35211840458211, 116.21502146869896, 69.14006203226742, 143.7387602292002, 145.3735549077392, 127.69050493463874, -250.7989996895194, 95.70901176478947, 81.7997822500765, 137.10328528843826, 118.4647129131481, 101.58169127255675, 133.45820177812115, 98.5008979141712, 100.5973730906844, 140.20652315393087, 140.6996225602922, 82.34168512438191, 114.47752099484205, 106.52057143673301, 117.80547672510144, 126.47309480048713, 112.23173706233501, 108.11489749699828, 107.11874271789563, 124.3071745969355, 115.27711706608534, 80.27116041630504, 103.8171029537916, 131.42558490205562, 128.11452589929092, 108.88918015360831, 174.06556234229348, 126.07863729912785, 83.61651208251713, 95.3029816970229, 110.33636136911808, 115.27121586166321, 128.87584234587848, 132.3500617966056, 99.95899866521358, 85.72883798996916, 108.35701349377631, 129.94695825502274, 104.36894028820097, 96.40480674710122, 109.79986480623481, 104.37918731942773, 118.21321404063198, 100.22193590505046, 124.24150775617454, 145.43262958340352, 118.74849669635293, 109.36565037071703, 144.6406906917691, 103.9353267997503, 117.59267680719495, 116.43937301635742, 127.98621773347257, 142.25963707640776, 128.9995998106897, 116.01279223896562, 160.5151738040149, 147.06603925395783, 106.49832113273439, 106.69006910920143, 116.86587880179283, 108.02742756716906, 112.73123339563608, 121.74710150808093, 111.54445324465632, 121.7799439281225, 112.61679246835409, 88.72840552031992, 70.22832819749601, 102.15127281844613, 109.34436332434414, 140.4678030759096, 104.28352235257623, 107.80762945301828, 116.84816411044447, 129.7212400045246, 141.55447074025872], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 235, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [32.144978613282234, 31.462991217772156, 32.203356210297585, 30.182513561099768, 30.284244645386934, 30.009442515671253, 45.94194237018624, 45.92590907464424, 45.412909294168145, 39.807320577402905, 39.727312852938965, 39.72196057935555, 46.785832223792866, 47.12302728494008, 47.09140858550866, 39.859319515526295, 40.22026501595974, 39.92038682103157, 38.56244958440462, 38.37101805458465, 38.27987856666246, 43.24660294006267, 43.41223262498775, 43.19456592450538, 40.881271278485656, 40.49066971987486, 40.784017285332084, 44.74447586014867, 44.34164425730705, 44.313416093587875, 38.75233194480339, 38.58593689898649, 38.93228686104217, 40.70868277053037, 40.407632562021405, 40.75797564412156, 32.182605908562735, 32.32695213456948, 32.05163027097781, 45.97474017490943, 46.30814553548892, 46.28354168807466, 42.235524644454316, 42.432607290645436, 42.728739016999796, 38.76940386680265, 38.77201275279124, 38.63128318761785, 40.201528277869016, 39.26023089389005, 40.094783446441085, 41.760396738226206, 40.9194823304812, 41.67223933587471, 38.869343147923544, 38.42875762780507, 38.91692069297035, 23.026836069921643, 22.864521893362195, 23.248704068983585, 47.92937135572235, 47.95340668658416, 47.85598218689363, 48.50716800987719, 48.26494404673575, 48.60144285112618, 42.52871982008219, 42.49729714542627, 42.66448796913028, -83.76056668162346, -83.77582733333111, -83.26260567456484, 31.722811430692673, 32.15896644588793, 31.827233888208866, 26.77355198065439, 27.559445238361747, 27.46678503106037, 45.54584639519453, 45.74419543519616, 45.81324345804751, 39.17542466521263, 39.70260850246996, 39.58667974546552, 33.640398318568856, 33.92240696648756, 34.01888598750034, 44.58035958154747, 44.408393210420996, 44.4694489861528, 32.51778021206458, 32.96217860405643, 33.02093909805019, 33.314827789862946, 33.48277900119622, 33.79976629962523, 47.37905848398803, 46.49340638518332, 46.33405828475951, 47.18553817644714, 46.4550460577011, 47.059038326144204, 27.49047379469266, 27.37081077322364, 27.48040055646561, 38.17672695964575, 38.08399226516485, 38.21680177003145, 35.69082127511501, 35.66004052385688, 35.169709637761116, 39.50781556653479, 38.8269083003203, 39.47075285824636, 42.076632178078086, 42.09156973535815, 42.3048928870509, 37.26823066174984, 37.452644769102335, 37.51086163148284, 35.90283184001842, 36.150763804713876, 36.061301852265984, 35.93997369070226, 35.73125623414913, 35.44751279304424, 41.32105468710263, 41.466921017815665, 41.5191988920172, 38.3574630394578, 38.56925331801176, 38.35040070861578, 26.73740583161512, 26.761333557466656, 26.77242102722326, 34.47115833808978, 34.68309684594472, 34.66284776975711, 43.78179568424821, 43.849226656369865, 43.79456256143749, 42.494409680366516, 42.851492650806904, 42.76862356811762, 36.40247758229573, 36.36497281243403, 36.121729758878544, 58.13700355434169, 57.95953157668312, 57.96902721126874, 42.106105274210364, 42.182589549260825, 41.78994247565666, 27.64392827947934, 27.99565204729636, 27.976931755741433, 31.319574018319443, 32.01178621811171, 31.97162146059175, 36.85412123178442, 36.56330758084853, 36.91893255648513, 38.16072533031304, 38.58351999086638, 38.52697054048379, 42.540725618600845, 43.13534871675074, 43.199768010526896, 44.22949923823276, 44.04858997712532, 44.07197258124748, 33.27412138134241, 33.16952186077833, 33.51535542309284, 28.53067236145337, 28.491606098910168, 28.706559529605627, 36.25212885191043, 36.12136021008094, 35.98352443178494, 43.05477298796177, 43.58074666932225, 43.31143859773874, 34.6558106765151, 34.87060218397528, 34.84252742771059, 31.944020124773175, 32.17182524005571, 32.28896138227233, 36.38851900647083, 36.62914895514646, 36.782196844617516, 34.99068344011903, 34.977463483810425, 34.411040395498276, 39.62299812916413, 39.16704465697208, 39.42317125449577, 33.4860925899508, 33.378002875174076, 33.35784043992558, 41.63805347273592, 41.578429772518575, 41.02502451092005, 48.41096685205896, 48.59281409469743, 48.42884863664706, 39.25846772889295, 39.87021292249361, 39.61981604496637, 36.36084712793429, 36.50209167723854, 36.5027115655442, 48.29250959306954, 48.097308143973336, 48.250872954726205, 34.55489402512708, 34.53998258213201, 34.840450192491204, 39.085448913276196, 39.23506296053529, 39.272164933383465, 38.92275360971689, 38.879593290388584, 38.637026116251945, 42.87221482520302, 42.76581846674283, 42.348184441526726, 47.41642451410492, 47.55553037424882, 47.28768218805392, 43.047148652374744, 42.903206415474415, 43.04924474284053, 38.74548898575206, 38.445874643822506, 38.82142860939105, 53.64992748325069, 53.75575227042039, 53.10949405034383, 49.277510694849, 49.30513230214517, 48.48339625696342, 35.58294401379922, 35.36632830152908, 35.54904881740609, 35.61239895969629, 35.62007160484791, 35.45759854465723, 38.75911373893419, 39.00320353234807, 39.103561530510575, 35.89021702234943, 36.15564487812419, 35.98156566669543, 37.80247477442026, 37.55683296918869, 37.37192565202713, 40.38740987579027, 40.658525868008525, 40.70116576428214, 37.2972955442965, 36.91380661725998, 37.33335108309984, 40.548598666985825, 40.5561235298713, 40.67522173126538, 37.19837087144454, 37.725419764717415, 37.69300183219214, 29.615825434525803, 29.602417034407452, 29.51016305138667, 23.066096499562263, 23.383341252803802, 23.778890445129946, 33.84938559184471, 34.16135680551329, 34.14053042108813, 36.391720858712986, 36.392338437338665, 36.56030402829249, 46.769789273540184, 46.82850454250972, 46.869509259859726, 34.956169756750256, 34.80217162022987, 34.5251809755961, 35.973293480152876, 35.997377565751464, 35.83695840711394, 38.875989121695355, 39.09477692500998, 38.877398063739136, 43.26524768769741, 42.803305208683014, 43.652687108144164, 46.890288879474, 47.284804237385586, 47.379377623399094]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14608506400997873, "mean_inference_ms": 0.7002056163233569, "mean_action_processing_ms": 0.1017429877157159, "mean_env_wait_ms": 0.8501266786010454, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 605000, "timesteps_this_iter": 0, "agent_timesteps_total": 1815000, "timers": {"sample_time_ms": 10570.93, "sample_throughput": 472.995, "load_time_ms": 0.1, "load_throughput": 49955979.038, "learn_time_ms": 1613.114, "learn_throughput": 3099.596, "update_time_ms": 8.883}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0339757656912847e-26, "cur_lr": 0.0005000000000000001, "total_loss": 7.9016844749450685, "policy_loss": 0.004014637455665116, "vf_loss": 7.982391023635865, "vf_explained_var": -0.04508076906204224, "kl": 0.010416158475003899, "entropy": 8.472108745574952, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 605000, "num_agent_steps_sampled": 1815000, "num_steps_trained": 605000, "num_agent_steps_trained": 1815000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2066, "training_iteration": 121, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-31-00", "timestamp": 1706229060, "time_this_iter_s": 10.014442682266235, "time_total_s": 1301.6760013103485, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202821C6C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1301.6760013103485, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 12.492857142857144, "ram_util_percent": 49.77857142857143}}
{"episode_reward_max": 174.06556234229348, "episode_reward_min": -250.7989996895194, "episode_reward_mean": 113.9446442677897, "episode_len_mean": 497.35, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -83.77582733333111}, "policy_reward_max": {"shared_policy": 58.13700355434169}, "policy_reward_mean": {"shared_policy": 37.98154808926323}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.27055570483205, 121.87429097667334, 96.56118831411003, 138.56642739847297, 127.39687095209955, 116.17269980721174, 119.55654261820015, 124.35211840458211, 116.21502146869896, 69.14006203226742, 143.7387602292002, 145.3735549077392, 127.69050493463874, -250.7989996895194, 95.70901176478947, 81.7997822500765, 137.10328528843826, 118.4647129131481, 101.58169127255675, 133.45820177812115, 98.5008979141712, 100.5973730906844, 140.20652315393087, 140.6996225602922, 82.34168512438191, 114.47752099484205, 106.52057143673301, 117.80547672510144, 126.47309480048713, 112.23173706233501, 108.11489749699828, 107.11874271789563, 124.3071745969355, 115.27711706608534, 80.27116041630504, 103.8171029537916, 131.42558490205562, 128.11452589929092, 108.88918015360831, 174.06556234229348, 126.07863729912785, 83.61651208251713, 95.3029816970229, 110.33636136911808, 115.27121586166321, 128.87584234587848, 132.3500617966056, 99.95899866521358, 85.72883798996916, 108.35701349377631, 129.94695825502274, 104.36894028820097, 96.40480674710122, 109.79986480623481, 104.37918731942773, 118.21321404063198, 100.22193590505046, 124.24150775617454, 145.43262958340352, 118.74849669635293, 109.36565037071703, 144.6406906917691, 103.9353267997503, 117.59267680719495, 116.43937301635742, 127.98621773347257, 142.25963707640776, 128.9995998106897, 116.01279223896562, 160.5151738040149, 147.06603925395783, 106.49832113273439, 106.69006910920143, 116.86587880179283, 108.02742756716906, 112.73123339563608, 121.74710150808093, 111.54445324465632, 121.7799439281225, 112.61679246835409, 88.72840552031992, 70.22832819749601, 102.15127281844613, 109.34436332434414, 140.4678030759096, 104.28352235257623, 107.80762945301828, 116.84816411044447, 129.7212400045246, 141.55447074025872, 119.53904600813985, 149.64654360711575, 122.34391370415685, 125.35649470984934, 134.76787125319242, 112.35251400619744, 142.69468170031925, 123.67356677353382, 142.24995026085548, 138.27440766617664], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 235, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [38.75233194480339, 38.58593689898649, 38.93228686104217, 40.70868277053037, 40.407632562021405, 40.75797564412156, 32.182605908562735, 32.32695213456948, 32.05163027097781, 45.97474017490943, 46.30814553548892, 46.28354168807466, 42.235524644454316, 42.432607290645436, 42.728739016999796, 38.76940386680265, 38.77201275279124, 38.63128318761785, 40.201528277869016, 39.26023089389005, 40.094783446441085, 41.760396738226206, 40.9194823304812, 41.67223933587471, 38.869343147923544, 38.42875762780507, 38.91692069297035, 23.026836069921643, 22.864521893362195, 23.248704068983585, 47.92937135572235, 47.95340668658416, 47.85598218689363, 48.50716800987719, 48.26494404673575, 48.60144285112618, 42.52871982008219, 42.49729714542627, 42.66448796913028, -83.76056668162346, -83.77582733333111, -83.26260567456484, 31.722811430692673, 32.15896644588793, 31.827233888208866, 26.77355198065439, 27.559445238361747, 27.46678503106037, 45.54584639519453, 45.74419543519616, 45.81324345804751, 39.17542466521263, 39.70260850246996, 39.58667974546552, 33.640398318568856, 33.92240696648756, 34.01888598750034, 44.58035958154747, 44.408393210420996, 44.4694489861528, 32.51778021206458, 32.96217860405643, 33.02093909805019, 33.314827789862946, 33.48277900119622, 33.79976629962523, 47.37905848398803, 46.49340638518332, 46.33405828475951, 47.18553817644714, 46.4550460577011, 47.059038326144204, 27.49047379469266, 27.37081077322364, 27.48040055646561, 38.17672695964575, 38.08399226516485, 38.21680177003145, 35.69082127511501, 35.66004052385688, 35.169709637761116, 39.50781556653479, 38.8269083003203, 39.47075285824636, 42.076632178078086, 42.09156973535815, 42.3048928870509, 37.26823066174984, 37.452644769102335, 37.51086163148284, 35.90283184001842, 36.150763804713876, 36.061301852265984, 35.93997369070226, 35.73125623414913, 35.44751279304424, 41.32105468710263, 41.466921017815665, 41.5191988920172, 38.3574630394578, 38.56925331801176, 38.35040070861578, 26.73740583161512, 26.761333557466656, 26.77242102722326, 34.47115833808978, 34.68309684594472, 34.66284776975711, 43.78179568424821, 43.849226656369865, 43.79456256143749, 42.494409680366516, 42.851492650806904, 42.76862356811762, 36.40247758229573, 36.36497281243403, 36.121729758878544, 58.13700355434169, 57.95953157668312, 57.96902721126874, 42.106105274210364, 42.182589549260825, 41.78994247565666, 27.64392827947934, 27.99565204729636, 27.976931755741433, 31.319574018319443, 32.01178621811171, 31.97162146059175, 36.85412123178442, 36.56330758084853, 36.91893255648513, 38.16072533031304, 38.58351999086638, 38.52697054048379, 42.540725618600845, 43.13534871675074, 43.199768010526896, 44.22949923823276, 44.04858997712532, 44.07197258124748, 33.27412138134241, 33.16952186077833, 33.51535542309284, 28.53067236145337, 28.491606098910168, 28.706559529605627, 36.25212885191043, 36.12136021008094, 35.98352443178494, 43.05477298796177, 43.58074666932225, 43.31143859773874, 34.6558106765151, 34.87060218397528, 34.84252742771059, 31.944020124773175, 32.17182524005571, 32.28896138227233, 36.38851900647083, 36.62914895514646, 36.782196844617516, 34.99068344011903, 34.977463483810425, 34.411040395498276, 39.62299812916413, 39.16704465697208, 39.42317125449577, 33.4860925899508, 33.378002875174076, 33.35784043992558, 41.63805347273592, 41.578429772518575, 41.02502451092005, 48.41096685205896, 48.59281409469743, 48.42884863664706, 39.25846772889295, 39.87021292249361, 39.61981604496637, 36.36084712793429, 36.50209167723854, 36.5027115655442, 48.29250959306954, 48.097308143973336, 48.250872954726205, 34.55489402512708, 34.53998258213201, 34.840450192491204, 39.085448913276196, 39.23506296053529, 39.272164933383465, 38.92275360971689, 38.879593290388584, 38.637026116251945, 42.87221482520302, 42.76581846674283, 42.348184441526726, 47.41642451410492, 47.55553037424882, 47.28768218805392, 43.047148652374744, 42.903206415474415, 43.04924474284053, 38.74548898575206, 38.445874643822506, 38.82142860939105, 53.64992748325069, 53.75575227042039, 53.10949405034383, 49.277510694849, 49.30513230214517, 48.48339625696342, 35.58294401379922, 35.36632830152908, 35.54904881740609, 35.61239895969629, 35.62007160484791, 35.45759854465723, 38.75911373893419, 39.00320353234807, 39.103561530510575, 35.89021702234943, 36.15564487812419, 35.98156566669543, 37.80247477442026, 37.55683296918869, 37.37192565202713, 40.38740987579027, 40.658525868008525, 40.70116576428214, 37.2972955442965, 36.91380661725998, 37.33335108309984, 40.548598666985825, 40.5561235298713, 40.67522173126538, 37.19837087144454, 37.725419764717415, 37.69300183219214, 29.615825434525803, 29.602417034407452, 29.51016305138667, 23.066096499562263, 23.383341252803802, 23.778890445129946, 33.84938559184471, 34.16135680551329, 34.14053042108813, 36.391720858712986, 36.392338437338665, 36.56030402829249, 46.769789273540184, 46.82850454250972, 46.869509259859726, 34.956169756750256, 34.80217162022987, 34.5251809755961, 35.973293480152876, 35.997377565751464, 35.83695840711394, 38.875989121695355, 39.09477692500998, 38.877398063739136, 43.26524768769741, 42.803305208683014, 43.652687108144164, 46.890288879474, 47.284804237385586, 47.379377623399094, 39.422437995672226, 40.00628888607025, 40.11031912639737, 49.89877066512902, 49.936231327553585, 49.811541614433125, 41.023131812612206, 40.376157889763505, 40.944624001781136, 41.92661130179961, 41.588539642592266, 41.84134376545747, 45.04083831359942, 44.83729661007722, 44.88973632951577, 37.42107247312863, 37.59238169838984, 37.33905983467896, 47.707020585735634, 47.40551861127217, 47.58214250331123, 41.38920450210571, 40.92592769861221, 41.358434572815895, 47.271869627137974, 47.669906338987246, 47.30817429473002, 46.15041710436344, 46.29400407895446, 45.82998648285866]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14604354005777748, "mean_inference_ms": 0.7001977041354864, "mean_action_processing_ms": 0.10171945378165949, "mean_env_wait_ms": 0.8497980620161598, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 610000, "timesteps_this_iter": 0, "agent_timesteps_total": 1830000, "timers": {"sample_time_ms": 10450.804, "sample_throughput": 478.432, "load_time_ms": 0.1, "load_throughput": 49955979.038, "learn_time_ms": 1600.528, "learn_throughput": 3123.968, "update_time_ms": 8.831}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0339757656912847e-26, "cur_lr": 0.0005000000000000001, "total_loss": 7.105461978912354, "policy_loss": 0.0039791707481249715, "vf_loss": 7.183422803878784, "vf_explained_var": -0.011841309070587159, "kl": 0.013021945464445451, "entropy": 8.19396276473999, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 610000, "num_agent_steps_sampled": 1830000, "num_steps_trained": 610000, "num_agent_steps_trained": 1830000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2076, "training_iteration": 122, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-31-10", "timestamp": 1706229070, "time_this_iter_s": 10.279152154922485, "time_total_s": 1311.955153465271, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028379E790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1311.955153465271, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 12.806666666666668, "ram_util_percent": 49.50666666666667}}
{"episode_reward_max": 174.06556234229348, "episode_reward_min": -250.7989996895194, "episode_reward_mean": 114.92611422871778, "episode_len_mean": 497.35, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -83.77582733333111}, "policy_reward_max": {"shared_policy": 58.13700355434169}, "policy_reward_mean": {"shared_policy": 38.30870474290592}, "custom_metrics": {}, "hist_stats": {"episode_reward": [143.7387602292002, 145.3735549077392, 127.69050493463874, -250.7989996895194, 95.70901176478947, 81.7997822500765, 137.10328528843826, 118.4647129131481, 101.58169127255675, 133.45820177812115, 98.5008979141712, 100.5973730906844, 140.20652315393087, 140.6996225602922, 82.34168512438191, 114.47752099484205, 106.52057143673301, 117.80547672510144, 126.47309480048713, 112.23173706233501, 108.11489749699828, 107.11874271789563, 124.3071745969355, 115.27711706608534, 80.27116041630504, 103.8171029537916, 131.42558490205562, 128.11452589929092, 108.88918015360831, 174.06556234229348, 126.07863729912785, 83.61651208251713, 95.3029816970229, 110.33636136911808, 115.27121586166321, 128.87584234587848, 132.3500617966056, 99.95899866521358, 85.72883798996916, 108.35701349377631, 129.94695825502274, 104.36894028820097, 96.40480674710122, 109.79986480623481, 104.37918731942773, 118.21321404063198, 100.22193590505046, 124.24150775617454, 145.43262958340352, 118.74849669635293, 109.36565037071703, 144.6406906917691, 103.9353267997503, 117.59267680719495, 116.43937301635742, 127.98621773347257, 142.25963707640776, 128.9995998106897, 116.01279223896562, 160.5151738040149, 147.06603925395783, 106.49832113273439, 106.69006910920143, 116.86587880179283, 108.02742756716906, 112.73123339563608, 121.74710150808093, 111.54445324465632, 121.7799439281225, 112.61679246835409, 88.72840552031992, 70.22832819749601, 102.15127281844613, 109.34436332434414, 140.4678030759096, 104.28352235257623, 107.80762945301828, 116.84816411044447, 129.7212400045246, 141.55447074025872, 119.53904600813985, 149.64654360711575, 122.34391370415685, 125.35649470984934, 134.76787125319242, 112.35251400619744, 142.69468170031925, 123.67356677353382, 142.24995026085548, 138.27440766617664, 134.51528865098956, 140.57421465963102, 136.22506828792368, 117.41440011840312, 129.47317632660258, 115.8021227796562, 104.4018268547952, 115.41816382855176, 134.2262409658286, 116.20227129757404], "episode_lengths": [500, 500, 500, 235, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [47.92937135572235, 47.95340668658416, 47.85598218689363, 48.50716800987719, 48.26494404673575, 48.60144285112618, 42.52871982008219, 42.49729714542627, 42.66448796913028, -83.76056668162346, -83.77582733333111, -83.26260567456484, 31.722811430692673, 32.15896644588793, 31.827233888208866, 26.77355198065439, 27.559445238361747, 27.46678503106037, 45.54584639519453, 45.74419543519616, 45.81324345804751, 39.17542466521263, 39.70260850246996, 39.58667974546552, 33.640398318568856, 33.92240696648756, 34.01888598750034, 44.58035958154747, 44.408393210420996, 44.4694489861528, 32.51778021206458, 32.96217860405643, 33.02093909805019, 33.314827789862946, 33.48277900119622, 33.79976629962523, 47.37905848398803, 46.49340638518332, 46.33405828475951, 47.18553817644714, 46.4550460577011, 47.059038326144204, 27.49047379469266, 27.37081077322364, 27.48040055646561, 38.17672695964575, 38.08399226516485, 38.21680177003145, 35.69082127511501, 35.66004052385688, 35.169709637761116, 39.50781556653479, 38.8269083003203, 39.47075285824636, 42.076632178078086, 42.09156973535815, 42.3048928870509, 37.26823066174984, 37.452644769102335, 37.51086163148284, 35.90283184001842, 36.150763804713876, 36.061301852265984, 35.93997369070226, 35.73125623414913, 35.44751279304424, 41.32105468710263, 41.466921017815665, 41.5191988920172, 38.3574630394578, 38.56925331801176, 38.35040070861578, 26.73740583161512, 26.761333557466656, 26.77242102722326, 34.47115833808978, 34.68309684594472, 34.66284776975711, 43.78179568424821, 43.849226656369865, 43.79456256143749, 42.494409680366516, 42.851492650806904, 42.76862356811762, 36.40247758229573, 36.36497281243403, 36.121729758878544, 58.13700355434169, 57.95953157668312, 57.96902721126874, 42.106105274210364, 42.182589549260825, 41.78994247565666, 27.64392827947934, 27.99565204729636, 27.976931755741433, 31.319574018319443, 32.01178621811171, 31.97162146059175, 36.85412123178442, 36.56330758084853, 36.91893255648513, 38.16072533031304, 38.58351999086638, 38.52697054048379, 42.540725618600845, 43.13534871675074, 43.199768010526896, 44.22949923823276, 44.04858997712532, 44.07197258124748, 33.27412138134241, 33.16952186077833, 33.51535542309284, 28.53067236145337, 28.491606098910168, 28.706559529605627, 36.25212885191043, 36.12136021008094, 35.98352443178494, 43.05477298796177, 43.58074666932225, 43.31143859773874, 34.6558106765151, 34.87060218397528, 34.84252742771059, 31.944020124773175, 32.17182524005571, 32.28896138227233, 36.38851900647083, 36.62914895514646, 36.782196844617516, 34.99068344011903, 34.977463483810425, 34.411040395498276, 39.62299812916413, 39.16704465697208, 39.42317125449577, 33.4860925899508, 33.378002875174076, 33.35784043992558, 41.63805347273592, 41.578429772518575, 41.02502451092005, 48.41096685205896, 48.59281409469743, 48.42884863664706, 39.25846772889295, 39.87021292249361, 39.61981604496637, 36.36084712793429, 36.50209167723854, 36.5027115655442, 48.29250959306954, 48.097308143973336, 48.250872954726205, 34.55489402512708, 34.53998258213201, 34.840450192491204, 39.085448913276196, 39.23506296053529, 39.272164933383465, 38.92275360971689, 38.879593290388584, 38.637026116251945, 42.87221482520302, 42.76581846674283, 42.348184441526726, 47.41642451410492, 47.55553037424882, 47.28768218805392, 43.047148652374744, 42.903206415474415, 43.04924474284053, 38.74548898575206, 38.445874643822506, 38.82142860939105, 53.64992748325069, 53.75575227042039, 53.10949405034383, 49.277510694849, 49.30513230214517, 48.48339625696342, 35.58294401379922, 35.36632830152908, 35.54904881740609, 35.61239895969629, 35.62007160484791, 35.45759854465723, 38.75911373893419, 39.00320353234807, 39.103561530510575, 35.89021702234943, 36.15564487812419, 35.98156566669543, 37.80247477442026, 37.55683296918869, 37.37192565202713, 40.38740987579027, 40.658525868008525, 40.70116576428214, 37.2972955442965, 36.91380661725998, 37.33335108309984, 40.548598666985825, 40.5561235298713, 40.67522173126538, 37.19837087144454, 37.725419764717415, 37.69300183219214, 29.615825434525803, 29.602417034407452, 29.51016305138667, 23.066096499562263, 23.383341252803802, 23.778890445129946, 33.84938559184471, 34.16135680551329, 34.14053042108813, 36.391720858712986, 36.392338437338665, 36.56030402829249, 46.769789273540184, 46.82850454250972, 46.869509259859726, 34.956169756750256, 34.80217162022987, 34.5251809755961, 35.973293480152876, 35.997377565751464, 35.83695840711394, 38.875989121695355, 39.09477692500998, 38.877398063739136, 43.26524768769741, 42.803305208683014, 43.652687108144164, 46.890288879474, 47.284804237385586, 47.379377623399094, 39.422437995672226, 40.00628888607025, 40.11031912639737, 49.89877066512902, 49.936231327553585, 49.811541614433125, 41.023131812612206, 40.376157889763505, 40.944624001781136, 41.92661130179961, 41.588539642592266, 41.84134376545747, 45.04083831359942, 44.83729661007722, 44.88973632951577, 37.42107247312863, 37.59238169838984, 37.33905983467896, 47.707020585735634, 47.40551861127217, 47.58214250331123, 41.38920450210571, 40.92592769861221, 41.358434572815895, 47.271869627137974, 47.669906338987246, 47.30817429473002, 46.15041710436344, 46.29400407895446, 45.82998648285866, 45.30655103176832, 43.85532608628273, 45.35341153293848, 46.93548460056384, 46.6659932633241, 46.9727367957433, 45.49519291706383, 45.35597724467516, 45.37389812618494, 38.858723898728684, 39.287481659402445, 39.26819456027199, 42.821946928898484, 43.19689385841289, 43.45433553929129, 38.74298254074529, 38.63791237398982, 38.42122786492109, 34.86443872128923, 34.76964362462361, 34.76774450888236, 38.04788831373055, 38.66212002684672, 38.70815548797448, 43.94499127070108, 45.179989093895216, 45.10126060123244, 38.432850643992424, 38.597165897488594, 39.172254756093025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1459891424699002, "mean_inference_ms": 0.700167862334096, "mean_action_processing_ms": 0.10169570551856805, "mean_env_wait_ms": 0.8494522067886254, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 615000, "timesteps_this_iter": 0, "agent_timesteps_total": 1845000, "timers": {"sample_time_ms": 10399.835, "sample_throughput": 480.777, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1590.551, "learn_throughput": 3143.565, "update_time_ms": 8.704}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0339757656912847e-26, "cur_lr": 0.0005000000000000001, "total_loss": 6.9717930316925045, "policy_loss": 0.0032503948121964223, "vf_loss": 7.052187395095825, "vf_explained_var": -0.013270628452301026, "kl": 0.011085266247413742, "entropy": 8.364455890655517, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 615000, "num_agent_steps_sampled": 1845000, "num_steps_trained": 615000, "num_agent_steps_trained": 1845000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2086, "training_iteration": 123, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-31-21", "timestamp": 1706229081, "time_this_iter_s": 10.234306335449219, "time_total_s": 1322.1894598007202, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824D0160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1322.1894598007202, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 11.585714285714287, "ram_util_percent": 49.51428571428572}}
{"episode_reward_max": 174.06556234229348, "episode_reward_min": 70.22832819749601, "episode_reward_mean": 119.73012685302658, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 23.066096499562263}, "policy_reward_max": {"shared_policy": 58.13700355434169}, "policy_reward_mean": {"shared_policy": 39.91004228434219}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.5008979141712, 100.5973730906844, 140.20652315393087, 140.6996225602922, 82.34168512438191, 114.47752099484205, 106.52057143673301, 117.80547672510144, 126.47309480048713, 112.23173706233501, 108.11489749699828, 107.11874271789563, 124.3071745969355, 115.27711706608534, 80.27116041630504, 103.8171029537916, 131.42558490205562, 128.11452589929092, 108.88918015360831, 174.06556234229348, 126.07863729912785, 83.61651208251713, 95.3029816970229, 110.33636136911808, 115.27121586166321, 128.87584234587848, 132.3500617966056, 99.95899866521358, 85.72883798996916, 108.35701349377631, 129.94695825502274, 104.36894028820097, 96.40480674710122, 109.79986480623481, 104.37918731942773, 118.21321404063198, 100.22193590505046, 124.24150775617454, 145.43262958340352, 118.74849669635293, 109.36565037071703, 144.6406906917691, 103.9353267997503, 117.59267680719495, 116.43937301635742, 127.98621773347257, 142.25963707640776, 128.9995998106897, 116.01279223896562, 160.5151738040149, 147.06603925395783, 106.49832113273439, 106.69006910920143, 116.86587880179283, 108.02742756716906, 112.73123339563608, 121.74710150808093, 111.54445324465632, 121.7799439281225, 112.61679246835409, 88.72840552031992, 70.22832819749601, 102.15127281844613, 109.34436332434414, 140.4678030759096, 104.28352235257623, 107.80762945301828, 116.84816411044447, 129.7212400045246, 141.55447074025872, 119.53904600813985, 149.64654360711575, 122.34391370415685, 125.35649470984934, 134.76787125319242, 112.35251400619744, 142.69468170031925, 123.67356677353382, 142.24995026085548, 138.27440766617664, 134.51528865098956, 140.57421465963102, 136.22506828792368, 117.41440011840312, 129.47317632660258, 115.8021227796562, 104.4018268547952, 115.41816382855176, 134.2262409658286, 116.20227129757404, 92.71096004499123, 135.27185721136635, 99.52421239390966, 131.19641629979, 124.67439898103473, 152.467752005905, 147.25969470338848, 128.3454762175678, 159.01490200310943, 144.05609821900737], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [32.51778021206458, 32.96217860405643, 33.02093909805019, 33.314827789862946, 33.48277900119622, 33.79976629962523, 47.37905848398803, 46.49340638518332, 46.33405828475951, 47.18553817644714, 46.4550460577011, 47.059038326144204, 27.49047379469266, 27.37081077322364, 27.48040055646561, 38.17672695964575, 38.08399226516485, 38.21680177003145, 35.69082127511501, 35.66004052385688, 35.169709637761116, 39.50781556653479, 38.8269083003203, 39.47075285824636, 42.076632178078086, 42.09156973535815, 42.3048928870509, 37.26823066174984, 37.452644769102335, 37.51086163148284, 35.90283184001842, 36.150763804713876, 36.061301852265984, 35.93997369070226, 35.73125623414913, 35.44751279304424, 41.32105468710263, 41.466921017815665, 41.5191988920172, 38.3574630394578, 38.56925331801176, 38.35040070861578, 26.73740583161512, 26.761333557466656, 26.77242102722326, 34.47115833808978, 34.68309684594472, 34.66284776975711, 43.78179568424821, 43.849226656369865, 43.79456256143749, 42.494409680366516, 42.851492650806904, 42.76862356811762, 36.40247758229573, 36.36497281243403, 36.121729758878544, 58.13700355434169, 57.95953157668312, 57.96902721126874, 42.106105274210364, 42.182589549260825, 41.78994247565666, 27.64392827947934, 27.99565204729636, 27.976931755741433, 31.319574018319443, 32.01178621811171, 31.97162146059175, 36.85412123178442, 36.56330758084853, 36.91893255648513, 38.16072533031304, 38.58351999086638, 38.52697054048379, 42.540725618600845, 43.13534871675074, 43.199768010526896, 44.22949923823276, 44.04858997712532, 44.07197258124748, 33.27412138134241, 33.16952186077833, 33.51535542309284, 28.53067236145337, 28.491606098910168, 28.706559529605627, 36.25212885191043, 36.12136021008094, 35.98352443178494, 43.05477298796177, 43.58074666932225, 43.31143859773874, 34.6558106765151, 34.87060218397528, 34.84252742771059, 31.944020124773175, 32.17182524005571, 32.28896138227233, 36.38851900647083, 36.62914895514646, 36.782196844617516, 34.99068344011903, 34.977463483810425, 34.411040395498276, 39.62299812916413, 39.16704465697208, 39.42317125449577, 33.4860925899508, 33.378002875174076, 33.35784043992558, 41.63805347273592, 41.578429772518575, 41.02502451092005, 48.41096685205896, 48.59281409469743, 48.42884863664706, 39.25846772889295, 39.87021292249361, 39.61981604496637, 36.36084712793429, 36.50209167723854, 36.5027115655442, 48.29250959306954, 48.097308143973336, 48.250872954726205, 34.55489402512708, 34.53998258213201, 34.840450192491204, 39.085448913276196, 39.23506296053529, 39.272164933383465, 38.92275360971689, 38.879593290388584, 38.637026116251945, 42.87221482520302, 42.76581846674283, 42.348184441526726, 47.41642451410492, 47.55553037424882, 47.28768218805392, 43.047148652374744, 42.903206415474415, 43.04924474284053, 38.74548898575206, 38.445874643822506, 38.82142860939105, 53.64992748325069, 53.75575227042039, 53.10949405034383, 49.277510694849, 49.30513230214517, 48.48339625696342, 35.58294401379922, 35.36632830152908, 35.54904881740609, 35.61239895969629, 35.62007160484791, 35.45759854465723, 38.75911373893419, 39.00320353234807, 39.103561530510575, 35.89021702234943, 36.15564487812419, 35.98156566669543, 37.80247477442026, 37.55683296918869, 37.37192565202713, 40.38740987579027, 40.658525868008525, 40.70116576428214, 37.2972955442965, 36.91380661725998, 37.33335108309984, 40.548598666985825, 40.5561235298713, 40.67522173126538, 37.19837087144454, 37.725419764717415, 37.69300183219214, 29.615825434525803, 29.602417034407452, 29.51016305138667, 23.066096499562263, 23.383341252803802, 23.778890445129946, 33.84938559184471, 34.16135680551329, 34.14053042108813, 36.391720858712986, 36.392338437338665, 36.56030402829249, 46.769789273540184, 46.82850454250972, 46.869509259859726, 34.956169756750256, 34.80217162022987, 34.5251809755961, 35.973293480152876, 35.997377565751464, 35.83695840711394, 38.875989121695355, 39.09477692500998, 38.877398063739136, 43.26524768769741, 42.803305208683014, 43.652687108144164, 46.890288879474, 47.284804237385586, 47.379377623399094, 39.422437995672226, 40.00628888607025, 40.11031912639737, 49.89877066512902, 49.936231327553585, 49.811541614433125, 41.023131812612206, 40.376157889763505, 40.944624001781136, 41.92661130179961, 41.588539642592266, 41.84134376545747, 45.04083831359942, 44.83729661007722, 44.88973632951577, 37.42107247312863, 37.59238169838984, 37.33905983467896, 47.707020585735634, 47.40551861127217, 47.58214250331123, 41.38920450210571, 40.92592769861221, 41.358434572815895, 47.271869627137974, 47.669906338987246, 47.30817429473002, 46.15041710436344, 46.29400407895446, 45.82998648285866, 45.30655103176832, 43.85532608628273, 45.35341153293848, 46.93548460056384, 46.6659932633241, 46.9727367957433, 45.49519291706383, 45.35597724467516, 45.37389812618494, 38.858723898728684, 39.287481659402445, 39.26819456027199, 42.821946928898484, 43.19689385841289, 43.45433553929129, 38.74298254074529, 38.63791237398982, 38.42122786492109, 34.86443872128923, 34.76964362462361, 34.76774450888236, 38.04788831373055, 38.66212002684672, 38.70815548797448, 43.94499127070108, 45.179989093895216, 45.10126060123244, 38.432850643992424, 38.597165897488594, 39.172254756093025, 30.479935735464096, 30.884380891919136, 31.346643417607993, 44.86346119642258, 45.14721456542611, 45.26118144951761, 32.84450818101564, 33.16341139624515, 33.51629281664887, 43.894718773663044, 43.38479906320572, 43.91689846292138, 41.59620819861689, 41.375747251013905, 41.70244353140393, 50.92021107052763, 50.57590206464131, 50.97163887073596, 49.478349082637564, 48.82055044174193, 48.96079517900942, 42.971289231131465, 42.59084707001844, 42.78333991641799, 52.98249719043572, 53.22124519695838, 52.81115961571534, 47.960907891392694, 47.954077720642076, 48.14111260697244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14598804690314432, "mean_inference_ms": 0.7004170641721982, "mean_action_processing_ms": 0.10168926265586904, "mean_env_wait_ms": 0.8493040384873356, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 620000, "timesteps_this_iter": 0, "agent_timesteps_total": 1860000, "timers": {"sample_time_ms": 10408.744, "sample_throughput": 480.365, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 1580.474, "learn_throughput": 3163.608, "update_time_ms": 8.552}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0339757656912847e-26, "cur_lr": 0.0005000000000000001, "total_loss": 6.3862780094146725, "policy_loss": -0.001182344236740196, "vf_loss": 6.471711254119873, "vf_explained_var": -0.02728581428527832, "kl": 0.003536336100681817, "entropy": 8.425102996826173, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 620000, "num_agent_steps_sampled": 1860000, "num_steps_trained": 620000, "num_agent_steps_trained": 1860000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2096, "training_iteration": 124, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-31-31", "timestamp": 1706229091, "time_this_iter_s": 10.644269227981567, "time_total_s": 1332.8337290287018, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282218310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1332.8337290287018, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 10.793333333333333, "ram_util_percent": 49.70000000000001}}
{"episode_reward_max": 174.06556234229348, "episode_reward_min": 70.22832819749601, "episode_reward_mean": 120.67670861229604, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 23.066096499562263}, "policy_reward_max": {"shared_policy": 58.13700355434169}, "policy_reward_mean": {"shared_policy": 40.22556953743202}, "custom_metrics": {}, "hist_stats": {"episode_reward": [108.11489749699828, 107.11874271789563, 124.3071745969355, 115.27711706608534, 80.27116041630504, 103.8171029537916, 131.42558490205562, 128.11452589929092, 108.88918015360831, 174.06556234229348, 126.07863729912785, 83.61651208251713, 95.3029816970229, 110.33636136911808, 115.27121586166321, 128.87584234587848, 132.3500617966056, 99.95899866521358, 85.72883798996916, 108.35701349377631, 129.94695825502274, 104.36894028820097, 96.40480674710122, 109.79986480623481, 104.37918731942773, 118.21321404063198, 100.22193590505046, 124.24150775617454, 145.43262958340352, 118.74849669635293, 109.36565037071703, 144.6406906917691, 103.9353267997503, 117.59267680719495, 116.43937301635742, 127.98621773347257, 142.25963707640776, 128.9995998106897, 116.01279223896562, 160.5151738040149, 147.06603925395783, 106.49832113273439, 106.69006910920143, 116.86587880179283, 108.02742756716906, 112.73123339563608, 121.74710150808093, 111.54445324465632, 121.7799439281225, 112.61679246835409, 88.72840552031992, 70.22832819749601, 102.15127281844613, 109.34436332434414, 140.4678030759096, 104.28352235257623, 107.80762945301828, 116.84816411044447, 129.7212400045246, 141.55447074025872, 119.53904600813985, 149.64654360711575, 122.34391370415685, 125.35649470984934, 134.76787125319242, 112.35251400619744, 142.69468170031925, 123.67356677353382, 142.24995026085548, 138.27440766617664, 134.51528865098956, 140.57421465963102, 136.22506828792368, 117.41440011840312, 129.47317632660258, 115.8021227796562, 104.4018268547952, 115.41816382855176, 134.2262409658286, 116.20227129757404, 92.71096004499123, 135.27185721136635, 99.52421239390966, 131.19641629979, 124.67439898103473, 152.467752005905, 147.25969470338848, 128.3454762175678, 159.01490200310943, 144.05609821900737, 126.1283779963851, 111.19558272510764, 130.98783832415933, 113.26548402011392, 173.82957199960933, 122.78210047632454, 127.34848123043776, 86.97493076976389, 120.18880564719436, 121.81150560081004], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [35.90283184001842, 36.150763804713876, 36.061301852265984, 35.93997369070226, 35.73125623414913, 35.44751279304424, 41.32105468710263, 41.466921017815665, 41.5191988920172, 38.3574630394578, 38.56925331801176, 38.35040070861578, 26.73740583161512, 26.761333557466656, 26.77242102722326, 34.47115833808978, 34.68309684594472, 34.66284776975711, 43.78179568424821, 43.849226656369865, 43.79456256143749, 42.494409680366516, 42.851492650806904, 42.76862356811762, 36.40247758229573, 36.36497281243403, 36.121729758878544, 58.13700355434169, 57.95953157668312, 57.96902721126874, 42.106105274210364, 42.182589549260825, 41.78994247565666, 27.64392827947934, 27.99565204729636, 27.976931755741433, 31.319574018319443, 32.01178621811171, 31.97162146059175, 36.85412123178442, 36.56330758084853, 36.91893255648513, 38.16072533031304, 38.58351999086638, 38.52697054048379, 42.540725618600845, 43.13534871675074, 43.199768010526896, 44.22949923823276, 44.04858997712532, 44.07197258124748, 33.27412138134241, 33.16952186077833, 33.51535542309284, 28.53067236145337, 28.491606098910168, 28.706559529605627, 36.25212885191043, 36.12136021008094, 35.98352443178494, 43.05477298796177, 43.58074666932225, 43.31143859773874, 34.6558106765151, 34.87060218397528, 34.84252742771059, 31.944020124773175, 32.17182524005571, 32.28896138227233, 36.38851900647083, 36.62914895514646, 36.782196844617516, 34.99068344011903, 34.977463483810425, 34.411040395498276, 39.62299812916413, 39.16704465697208, 39.42317125449577, 33.4860925899508, 33.378002875174076, 33.35784043992558, 41.63805347273592, 41.578429772518575, 41.02502451092005, 48.41096685205896, 48.59281409469743, 48.42884863664706, 39.25846772889295, 39.87021292249361, 39.61981604496637, 36.36084712793429, 36.50209167723854, 36.5027115655442, 48.29250959306954, 48.097308143973336, 48.250872954726205, 34.55489402512708, 34.53998258213201, 34.840450192491204, 39.085448913276196, 39.23506296053529, 39.272164933383465, 38.92275360971689, 38.879593290388584, 38.637026116251945, 42.87221482520302, 42.76581846674283, 42.348184441526726, 47.41642451410492, 47.55553037424882, 47.28768218805392, 43.047148652374744, 42.903206415474415, 43.04924474284053, 38.74548898575206, 38.445874643822506, 38.82142860939105, 53.64992748325069, 53.75575227042039, 53.10949405034383, 49.277510694849, 49.30513230214517, 48.48339625696342, 35.58294401379922, 35.36632830152908, 35.54904881740609, 35.61239895969629, 35.62007160484791, 35.45759854465723, 38.75911373893419, 39.00320353234807, 39.103561530510575, 35.89021702234943, 36.15564487812419, 35.98156566669543, 37.80247477442026, 37.55683296918869, 37.37192565202713, 40.38740987579027, 40.658525868008525, 40.70116576428214, 37.2972955442965, 36.91380661725998, 37.33335108309984, 40.548598666985825, 40.5561235298713, 40.67522173126538, 37.19837087144454, 37.725419764717415, 37.69300183219214, 29.615825434525803, 29.602417034407452, 29.51016305138667, 23.066096499562263, 23.383341252803802, 23.778890445129946, 33.84938559184471, 34.16135680551329, 34.14053042108813, 36.391720858712986, 36.392338437338665, 36.56030402829249, 46.769789273540184, 46.82850454250972, 46.869509259859726, 34.956169756750256, 34.80217162022987, 34.5251809755961, 35.973293480152876, 35.997377565751464, 35.83695840711394, 38.875989121695355, 39.09477692500998, 38.877398063739136, 43.26524768769741, 42.803305208683014, 43.652687108144164, 46.890288879474, 47.284804237385586, 47.379377623399094, 39.422437995672226, 40.00628888607025, 40.11031912639737, 49.89877066512902, 49.936231327553585, 49.811541614433125, 41.023131812612206, 40.376157889763505, 40.944624001781136, 41.92661130179961, 41.588539642592266, 41.84134376545747, 45.04083831359942, 44.83729661007722, 44.88973632951577, 37.42107247312863, 37.59238169838984, 37.33905983467896, 47.707020585735634, 47.40551861127217, 47.58214250331123, 41.38920450210571, 40.92592769861221, 41.358434572815895, 47.271869627137974, 47.669906338987246, 47.30817429473002, 46.15041710436344, 46.29400407895446, 45.82998648285866, 45.30655103176832, 43.85532608628273, 45.35341153293848, 46.93548460056384, 46.6659932633241, 46.9727367957433, 45.49519291706383, 45.35597724467516, 45.37389812618494, 38.858723898728684, 39.287481659402445, 39.26819456027199, 42.821946928898484, 43.19689385841289, 43.45433553929129, 38.74298254074529, 38.63791237398982, 38.42122786492109, 34.86443872128923, 34.76964362462361, 34.76774450888236, 38.04788831373055, 38.66212002684672, 38.70815548797448, 43.94499127070108, 45.179989093895216, 45.10126060123244, 38.432850643992424, 38.597165897488594, 39.172254756093025, 30.479935735464096, 30.884380891919136, 31.346643417607993, 44.86346119642258, 45.14721456542611, 45.26118144951761, 32.84450818101564, 33.16341139624515, 33.51629281664887, 43.894718773663044, 43.38479906320572, 43.91689846292138, 41.59620819861689, 41.375747251013905, 41.70244353140393, 50.92021107052763, 50.57590206464131, 50.97163887073596, 49.478349082637564, 48.82055044174193, 48.96079517900942, 42.971289231131465, 42.59084707001844, 42.78333991641799, 52.98249719043572, 53.22124519695838, 52.81115961571534, 47.960907891392694, 47.954077720642076, 48.14111260697244, 42.13245125114918, 41.83329136669636, 42.16263537853956, 37.050167861084134, 37.080014551679284, 37.065400312344224, 43.50735964377721, 43.84331349407633, 43.637165186305836, 37.665509956578404, 37.73381747553745, 37.86615658799806, 57.852402895688996, 57.843347460031495, 58.133821643888936, 40.866254319747284, 40.72882508238156, 41.1870210741957, 42.53050923347473, 42.73432444781065, 42.083647549152374, 28.682023160159588, 29.14301162492484, 29.14989598467946, 39.887555489937455, 40.23464589069286, 40.06660426656404, 40.559492511053875, 40.63384513308604, 40.61816795667012]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14594757716762122, "mean_inference_ms": 0.7003969874261968, "mean_action_processing_ms": 0.10166482634262212, "mean_env_wait_ms": 0.8489420469916747, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 625000, "timesteps_this_iter": 0, "agent_timesteps_total": 1875000, "timers": {"sample_time_ms": 10376.213, "sample_throughput": 481.871, "load_time_ms": 0.102, "load_throughput": 48998878.505, "learn_time_ms": 1570.487, "learn_throughput": 3183.725, "update_time_ms": 8.5}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.169878828456423e-27, "cur_lr": 0.0005000000000000001, "total_loss": 8.062030410766601, "policy_loss": -0.0011488975884051734, "vf_loss": 8.147874641418458, "vf_explained_var": -0.01892354488372803, "kl": 0.0030917511496444325, "entropy": 8.469530582427979, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 625000, "num_agent_steps_sampled": 1875000, "num_steps_trained": 625000, "num_agent_steps_trained": 1875000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2106, "training_iteration": 125, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-31-41", "timestamp": 1706229101, "time_this_iter_s": 9.671939373016357, "time_total_s": 1342.5056684017181, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202823BEB80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1342.5056684017181, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 10.714285714285714, "ram_util_percent": 49.60000000000001}}
{"episode_reward_max": 173.82957199960933, "episode_reward_min": 70.22832819749601, "episode_reward_mean": 121.6532334217809, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 23.066096499562263}, "policy_reward_max": {"shared_policy": 58.133821643888936}, "policy_reward_mean": {"shared_policy": 40.5510778072603}, "custom_metrics": {}, "hist_stats": {"episode_reward": [126.07863729912785, 83.61651208251713, 95.3029816970229, 110.33636136911808, 115.27121586166321, 128.87584234587848, 132.3500617966056, 99.95899866521358, 85.72883798996916, 108.35701349377631, 129.94695825502274, 104.36894028820097, 96.40480674710122, 109.79986480623481, 104.37918731942773, 118.21321404063198, 100.22193590505046, 124.24150775617454, 145.43262958340352, 118.74849669635293, 109.36565037071703, 144.6406906917691, 103.9353267997503, 117.59267680719495, 116.43937301635742, 127.98621773347257, 142.25963707640776, 128.9995998106897, 116.01279223896562, 160.5151738040149, 147.06603925395783, 106.49832113273439, 106.69006910920143, 116.86587880179283, 108.02742756716906, 112.73123339563608, 121.74710150808093, 111.54445324465632, 121.7799439281225, 112.61679246835409, 88.72840552031992, 70.22832819749601, 102.15127281844613, 109.34436332434414, 140.4678030759096, 104.28352235257623, 107.80762945301828, 116.84816411044447, 129.7212400045246, 141.55447074025872, 119.53904600813985, 149.64654360711575, 122.34391370415685, 125.35649470984934, 134.76787125319242, 112.35251400619744, 142.69468170031925, 123.67356677353382, 142.24995026085548, 138.27440766617664, 134.51528865098956, 140.57421465963102, 136.22506828792368, 117.41440011840312, 129.47317632660258, 115.8021227796562, 104.4018268547952, 115.41816382855176, 134.2262409658286, 116.20227129757404, 92.71096004499123, 135.27185721136635, 99.52421239390966, 131.19641629979, 124.67439898103473, 152.467752005905, 147.25969470338848, 128.3454762175678, 159.01490200310943, 144.05609821900737, 126.1283779963851, 111.19558272510764, 130.98783832415933, 113.26548402011392, 173.82957199960933, 122.78210047632454, 127.34848123043776, 86.97493076976389, 120.18880564719436, 121.81150560081004, 129.21119749173522, 127.4095652140677, 141.8908125590535, 117.67976566404104, 133.2023814767599, 119.54688272997736, 134.41187637299288, 126.65763510018587, 131.07461547851562, 117.96879740641451], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [42.106105274210364, 42.182589549260825, 41.78994247565666, 27.64392827947934, 27.99565204729636, 27.976931755741433, 31.319574018319443, 32.01178621811171, 31.97162146059175, 36.85412123178442, 36.56330758084853, 36.91893255648513, 38.16072533031304, 38.58351999086638, 38.52697054048379, 42.540725618600845, 43.13534871675074, 43.199768010526896, 44.22949923823276, 44.04858997712532, 44.07197258124748, 33.27412138134241, 33.16952186077833, 33.51535542309284, 28.53067236145337, 28.491606098910168, 28.706559529605627, 36.25212885191043, 36.12136021008094, 35.98352443178494, 43.05477298796177, 43.58074666932225, 43.31143859773874, 34.6558106765151, 34.87060218397528, 34.84252742771059, 31.944020124773175, 32.17182524005571, 32.28896138227233, 36.38851900647083, 36.62914895514646, 36.782196844617516, 34.99068344011903, 34.977463483810425, 34.411040395498276, 39.62299812916413, 39.16704465697208, 39.42317125449577, 33.4860925899508, 33.378002875174076, 33.35784043992558, 41.63805347273592, 41.578429772518575, 41.02502451092005, 48.41096685205896, 48.59281409469743, 48.42884863664706, 39.25846772889295, 39.87021292249361, 39.61981604496637, 36.36084712793429, 36.50209167723854, 36.5027115655442, 48.29250959306954, 48.097308143973336, 48.250872954726205, 34.55489402512708, 34.53998258213201, 34.840450192491204, 39.085448913276196, 39.23506296053529, 39.272164933383465, 38.92275360971689, 38.879593290388584, 38.637026116251945, 42.87221482520302, 42.76581846674283, 42.348184441526726, 47.41642451410492, 47.55553037424882, 47.28768218805392, 43.047148652374744, 42.903206415474415, 43.04924474284053, 38.74548898575206, 38.445874643822506, 38.82142860939105, 53.64992748325069, 53.75575227042039, 53.10949405034383, 49.277510694849, 49.30513230214517, 48.48339625696342, 35.58294401379922, 35.36632830152908, 35.54904881740609, 35.61239895969629, 35.62007160484791, 35.45759854465723, 38.75911373893419, 39.00320353234807, 39.103561530510575, 35.89021702234943, 36.15564487812419, 35.98156566669543, 37.80247477442026, 37.55683296918869, 37.37192565202713, 40.38740987579027, 40.658525868008525, 40.70116576428214, 37.2972955442965, 36.91380661725998, 37.33335108309984, 40.548598666985825, 40.5561235298713, 40.67522173126538, 37.19837087144454, 37.725419764717415, 37.69300183219214, 29.615825434525803, 29.602417034407452, 29.51016305138667, 23.066096499562263, 23.383341252803802, 23.778890445129946, 33.84938559184471, 34.16135680551329, 34.14053042108813, 36.391720858712986, 36.392338437338665, 36.56030402829249, 46.769789273540184, 46.82850454250972, 46.869509259859726, 34.956169756750256, 34.80217162022987, 34.5251809755961, 35.973293480152876, 35.997377565751464, 35.83695840711394, 38.875989121695355, 39.09477692500998, 38.877398063739136, 43.26524768769741, 42.803305208683014, 43.652687108144164, 46.890288879474, 47.284804237385586, 47.379377623399094, 39.422437995672226, 40.00628888607025, 40.11031912639737, 49.89877066512902, 49.936231327553585, 49.811541614433125, 41.023131812612206, 40.376157889763505, 40.944624001781136, 41.92661130179961, 41.588539642592266, 41.84134376545747, 45.04083831359942, 44.83729661007722, 44.88973632951577, 37.42107247312863, 37.59238169838984, 37.33905983467896, 47.707020585735634, 47.40551861127217, 47.58214250331123, 41.38920450210571, 40.92592769861221, 41.358434572815895, 47.271869627137974, 47.669906338987246, 47.30817429473002, 46.15041710436344, 46.29400407895446, 45.82998648285866, 45.30655103176832, 43.85532608628273, 45.35341153293848, 46.93548460056384, 46.6659932633241, 46.9727367957433, 45.49519291706383, 45.35597724467516, 45.37389812618494, 38.858723898728684, 39.287481659402445, 39.26819456027199, 42.821946928898484, 43.19689385841289, 43.45433553929129, 38.74298254074529, 38.63791237398982, 38.42122786492109, 34.86443872128923, 34.76964362462361, 34.76774450888236, 38.04788831373055, 38.66212002684672, 38.70815548797448, 43.94499127070108, 45.179989093895216, 45.10126060123244, 38.432850643992424, 38.597165897488594, 39.172254756093025, 30.479935735464096, 30.884380891919136, 31.346643417607993, 44.86346119642258, 45.14721456542611, 45.26118144951761, 32.84450818101564, 33.16341139624515, 33.51629281664887, 43.894718773663044, 43.38479906320572, 43.91689846292138, 41.59620819861689, 41.375747251013905, 41.70244353140393, 50.92021107052763, 50.57590206464131, 50.97163887073596, 49.478349082637564, 48.82055044174193, 48.96079517900942, 42.971289231131465, 42.59084707001844, 42.78333991641799, 52.98249719043572, 53.22124519695838, 52.81115961571534, 47.960907891392694, 47.954077720642076, 48.14111260697244, 42.13245125114918, 41.83329136669636, 42.16263537853956, 37.050167861084134, 37.080014551679284, 37.065400312344224, 43.50735964377721, 43.84331349407633, 43.637165186305836, 37.665509956578404, 37.73381747553745, 37.86615658799806, 57.852402895688996, 57.843347460031495, 58.133821643888936, 40.866254319747284, 40.72882508238156, 41.1870210741957, 42.53050923347473, 42.73432444781065, 42.083647549152374, 28.682023160159588, 29.14301162492484, 29.14989598467946, 39.887555489937455, 40.23464589069286, 40.06660426656404, 40.559492511053875, 40.63384513308604, 40.61816795667012, 43.315671668698386, 42.88393825789292, 43.0115875651439, 42.129950538277626, 42.80467975512147, 42.4749349206686, 47.433202814931676, 47.28085420901577, 47.17675553510587, 39.16920217126608, 39.36676608771086, 39.143797405064106, 44.28314436475435, 44.291683251659066, 44.62755386034647, 40.11201067393024, 39.79044795533021, 39.644424100716904, 44.80058419952789, 45.10807319978872, 44.503218973676354, 41.651482090353966, 42.27250701934099, 42.73364599049091, 43.506021221478775, 43.650039454301194, 43.91855480273564, 39.280591975276664, 39.360430502876014, 39.32777492826183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14588954714072638, "mean_inference_ms": 0.7003221772171665, "mean_action_processing_ms": 0.1016298418875497, "mean_env_wait_ms": 0.8485293899480874, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 630000, "timesteps_this_iter": 0, "agent_timesteps_total": 1890000, "timers": {"sample_time_ms": 10280.381, "sample_throughput": 486.363, "load_time_ms": 0.102, "load_throughput": 48998878.505, "learn_time_ms": 1561.174, "learn_throughput": 3202.718, "update_time_ms": 7.645}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.5849394142282116e-27, "cur_lr": 0.0005000000000000001, "total_loss": 6.222581768035889, "policy_loss": -0.0011811318063969622, "vf_loss": 6.3076478958129885, "vf_explained_var": -0.017502140998840333, "kl": 0.002879837714158178, "entropy": 8.388503265380859, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 630000, "num_agent_steps_sampled": 1890000, "num_steps_trained": 630000, "num_agent_steps_trained": 1890000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2116, "training_iteration": 126, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-31-51", "timestamp": 1706229111, "time_this_iter_s": 10.011595726013184, "time_total_s": 1352.5172641277313, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202823BE5E0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1352.5172641277313, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 10.985714285714286, "ram_util_percent": 49.53571428571429}}
{"episode_reward_max": 173.82957199960933, "episode_reward_min": 70.22832819749601, "episode_reward_mean": 123.6921609833122, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 23.066096499562263}, "policy_reward_max": {"shared_policy": 58.133821643888936}, "policy_reward_mean": {"shared_policy": 41.230720327770726}, "custom_metrics": {}, "hist_stats": {"episode_reward": [129.94695825502274, 104.36894028820097, 96.40480674710122, 109.79986480623481, 104.37918731942773, 118.21321404063198, 100.22193590505046, 124.24150775617454, 145.43262958340352, 118.74849669635293, 109.36565037071703, 144.6406906917691, 103.9353267997503, 117.59267680719495, 116.43937301635742, 127.98621773347257, 142.25963707640776, 128.9995998106897, 116.01279223896562, 160.5151738040149, 147.06603925395783, 106.49832113273439, 106.69006910920143, 116.86587880179283, 108.02742756716906, 112.73123339563608, 121.74710150808093, 111.54445324465632, 121.7799439281225, 112.61679246835409, 88.72840552031992, 70.22832819749601, 102.15127281844613, 109.34436332434414, 140.4678030759096, 104.28352235257623, 107.80762945301828, 116.84816411044447, 129.7212400045246, 141.55447074025872, 119.53904600813985, 149.64654360711575, 122.34391370415685, 125.35649470984934, 134.76787125319242, 112.35251400619744, 142.69468170031925, 123.67356677353382, 142.24995026085548, 138.27440766617664, 134.51528865098956, 140.57421465963102, 136.22506828792368, 117.41440011840312, 129.47317632660258, 115.8021227796562, 104.4018268547952, 115.41816382855176, 134.2262409658286, 116.20227129757404, 92.71096004499123, 135.27185721136635, 99.52421239390966, 131.19641629979, 124.67439898103473, 152.467752005905, 147.25969470338848, 128.3454762175678, 159.01490200310943, 144.05609821900737, 126.1283779963851, 111.19558272510764, 130.98783832415933, 113.26548402011392, 173.82957199960933, 122.78210047632454, 127.34848123043776, 86.97493076976389, 120.18880564719436, 121.81150560081004, 129.21119749173522, 127.4095652140677, 141.8908125590535, 117.67976566404104, 133.2023814767599, 119.54688272997736, 134.41187637299288, 126.65763510018587, 131.07461547851562, 117.96879740641451, 121.72680112347007, 117.36270106770095, 131.78792738914484, 130.78280947869638, 122.95038057072088, 128.90430982969707, 116.61983090266584, 144.52777877450006, 131.94601242523655, 143.16066719219072], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [43.05477298796177, 43.58074666932225, 43.31143859773874, 34.6558106765151, 34.87060218397528, 34.84252742771059, 31.944020124773175, 32.17182524005571, 32.28896138227233, 36.38851900647083, 36.62914895514646, 36.782196844617516, 34.99068344011903, 34.977463483810425, 34.411040395498276, 39.62299812916413, 39.16704465697208, 39.42317125449577, 33.4860925899508, 33.378002875174076, 33.35784043992558, 41.63805347273592, 41.578429772518575, 41.02502451092005, 48.41096685205896, 48.59281409469743, 48.42884863664706, 39.25846772889295, 39.87021292249361, 39.61981604496637, 36.36084712793429, 36.50209167723854, 36.5027115655442, 48.29250959306954, 48.097308143973336, 48.250872954726205, 34.55489402512708, 34.53998258213201, 34.840450192491204, 39.085448913276196, 39.23506296053529, 39.272164933383465, 38.92275360971689, 38.879593290388584, 38.637026116251945, 42.87221482520302, 42.76581846674283, 42.348184441526726, 47.41642451410492, 47.55553037424882, 47.28768218805392, 43.047148652374744, 42.903206415474415, 43.04924474284053, 38.74548898575206, 38.445874643822506, 38.82142860939105, 53.64992748325069, 53.75575227042039, 53.10949405034383, 49.277510694849, 49.30513230214517, 48.48339625696342, 35.58294401379922, 35.36632830152908, 35.54904881740609, 35.61239895969629, 35.62007160484791, 35.45759854465723, 38.75911373893419, 39.00320353234807, 39.103561530510575, 35.89021702234943, 36.15564487812419, 35.98156566669543, 37.80247477442026, 37.55683296918869, 37.37192565202713, 40.38740987579027, 40.658525868008525, 40.70116576428214, 37.2972955442965, 36.91380661725998, 37.33335108309984, 40.548598666985825, 40.5561235298713, 40.67522173126538, 37.19837087144454, 37.725419764717415, 37.69300183219214, 29.615825434525803, 29.602417034407452, 29.51016305138667, 23.066096499562263, 23.383341252803802, 23.778890445129946, 33.84938559184471, 34.16135680551329, 34.14053042108813, 36.391720858712986, 36.392338437338665, 36.56030402829249, 46.769789273540184, 46.82850454250972, 46.869509259859726, 34.956169756750256, 34.80217162022987, 34.5251809755961, 35.973293480152876, 35.997377565751464, 35.83695840711394, 38.875989121695355, 39.09477692500998, 38.877398063739136, 43.26524768769741, 42.803305208683014, 43.652687108144164, 46.890288879474, 47.284804237385586, 47.379377623399094, 39.422437995672226, 40.00628888607025, 40.11031912639737, 49.89877066512902, 49.936231327553585, 49.811541614433125, 41.023131812612206, 40.376157889763505, 40.944624001781136, 41.92661130179961, 41.588539642592266, 41.84134376545747, 45.04083831359942, 44.83729661007722, 44.88973632951577, 37.42107247312863, 37.59238169838984, 37.33905983467896, 47.707020585735634, 47.40551861127217, 47.58214250331123, 41.38920450210571, 40.92592769861221, 41.358434572815895, 47.271869627137974, 47.669906338987246, 47.30817429473002, 46.15041710436344, 46.29400407895446, 45.82998648285866, 45.30655103176832, 43.85532608628273, 45.35341153293848, 46.93548460056384, 46.6659932633241, 46.9727367957433, 45.49519291706383, 45.35597724467516, 45.37389812618494, 38.858723898728684, 39.287481659402445, 39.26819456027199, 42.821946928898484, 43.19689385841289, 43.45433553929129, 38.74298254074529, 38.63791237398982, 38.42122786492109, 34.86443872128923, 34.76964362462361, 34.76774450888236, 38.04788831373055, 38.66212002684672, 38.70815548797448, 43.94499127070108, 45.179989093895216, 45.10126060123244, 38.432850643992424, 38.597165897488594, 39.172254756093025, 30.479935735464096, 30.884380891919136, 31.346643417607993, 44.86346119642258, 45.14721456542611, 45.26118144951761, 32.84450818101564, 33.16341139624515, 33.51629281664887, 43.894718773663044, 43.38479906320572, 43.91689846292138, 41.59620819861689, 41.375747251013905, 41.70244353140393, 50.92021107052763, 50.57590206464131, 50.97163887073596, 49.478349082637564, 48.82055044174193, 48.96079517900942, 42.971289231131465, 42.59084707001844, 42.78333991641799, 52.98249719043572, 53.22124519695838, 52.81115961571534, 47.960907891392694, 47.954077720642076, 48.14111260697244, 42.13245125114918, 41.83329136669636, 42.16263537853956, 37.050167861084134, 37.080014551679284, 37.065400312344224, 43.50735964377721, 43.84331349407633, 43.637165186305836, 37.665509956578404, 37.73381747553745, 37.86615658799806, 57.852402895688996, 57.843347460031495, 58.133821643888936, 40.866254319747284, 40.72882508238156, 41.1870210741957, 42.53050923347473, 42.73432444781065, 42.083647549152374, 28.682023160159588, 29.14301162492484, 29.14989598467946, 39.887555489937455, 40.23464589069286, 40.06660426656404, 40.559492511053875, 40.63384513308604, 40.61816795667012, 43.315671668698386, 42.88393825789292, 43.0115875651439, 42.129950538277626, 42.80467975512147, 42.4749349206686, 47.433202814931676, 47.28085420901577, 47.17675553510587, 39.16920217126608, 39.36676608771086, 39.143797405064106, 44.28314436475435, 44.291683251659066, 44.62755386034647, 40.11201067393024, 39.79044795533021, 39.644424100716904, 44.80058419952789, 45.10807319978872, 44.503218973676354, 41.651482090353966, 42.27250701934099, 42.73364599049091, 43.506021221478775, 43.650039454301194, 43.91855480273564, 39.280591975276664, 39.360430502876014, 39.32777492826183, 40.431184485554695, 40.60494964569807, 40.6906669922173, 39.04436859736839, 39.1903968664507, 39.127935603881866, 43.52244546512762, 44.15470078463355, 44.110781139383704, 43.367189342776925, 43.44816974053779, 43.96745039538169, 41.11768706096336, 40.89625361934304, 40.936439890414476, 42.79841163754463, 43.01582986116409, 43.09006833098829, 38.7766671826442, 39.218396366884306, 38.62476735313733, 48.10393907750647, 48.28322269643347, 48.14061700055997, 43.85124822954336, 43.809274079898984, 44.28549011579403, 47.77194645131628, 47.66950068871181, 47.71922005216281]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14581943244032178, "mean_inference_ms": 0.7001928966503584, "mean_action_processing_ms": 0.1015928351200623, "mean_env_wait_ms": 0.8480806367208455, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 635000, "timesteps_this_iter": 0, "agent_timesteps_total": 1905000, "timers": {"sample_time_ms": 10193.951, "sample_throughput": 490.487, "load_time_ms": 0.102, "load_throughput": 48998878.505, "learn_time_ms": 1561.569, "learn_throughput": 3201.907, "update_time_ms": 7.687}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2924697071141058e-27, "cur_lr": 0.0005000000000000001, "total_loss": 6.2290716648101805, "policy_loss": -0.0003238499294702546, "vf_loss": 6.313882875442505, "vf_explained_var": -0.02721630334854126, "kl": 0.004204176249936905, "entropy": 8.448765182495118, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 635000, "num_agent_steps_sampled": 1905000, "num_steps_trained": 635000, "num_agent_steps_trained": 1905000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2126, "training_iteration": 127, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-32-01", "timestamp": 1706229121, "time_this_iter_s": 9.586496114730835, "time_total_s": 1362.1037602424622, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202823BE9D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1362.1037602424622, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 11.476923076923079, "ram_util_percent": 49.56153846153847}}
{"episode_reward_max": 173.82957199960933, "episode_reward_min": 70.22832819749601, "episode_reward_mean": 124.37927335015439, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 23.066096499562263}, "policy_reward_max": {"shared_policy": 58.133821643888936}, "policy_reward_mean": {"shared_policy": 41.45975778338479}, "custom_metrics": {}, "hist_stats": {"episode_reward": [109.36565037071703, 144.6406906917691, 103.9353267997503, 117.59267680719495, 116.43937301635742, 127.98621773347257, 142.25963707640776, 128.9995998106897, 116.01279223896562, 160.5151738040149, 147.06603925395783, 106.49832113273439, 106.69006910920143, 116.86587880179283, 108.02742756716906, 112.73123339563608, 121.74710150808093, 111.54445324465632, 121.7799439281225, 112.61679246835409, 88.72840552031992, 70.22832819749601, 102.15127281844613, 109.34436332434414, 140.4678030759096, 104.28352235257623, 107.80762945301828, 116.84816411044447, 129.7212400045246, 141.55447074025872, 119.53904600813985, 149.64654360711575, 122.34391370415685, 125.35649470984934, 134.76787125319242, 112.35251400619744, 142.69468170031925, 123.67356677353382, 142.24995026085548, 138.27440766617664, 134.51528865098956, 140.57421465963102, 136.22506828792368, 117.41440011840312, 129.47317632660258, 115.8021227796562, 104.4018268547952, 115.41816382855176, 134.2262409658286, 116.20227129757404, 92.71096004499123, 135.27185721136635, 99.52421239390966, 131.19641629979, 124.67439898103473, 152.467752005905, 147.25969470338848, 128.3454762175678, 159.01490200310943, 144.05609821900737, 126.1283779963851, 111.19558272510764, 130.98783832415933, 113.26548402011392, 173.82957199960933, 122.78210047632454, 127.34848123043776, 86.97493076976389, 120.18880564719436, 121.81150560081004, 129.21119749173522, 127.4095652140677, 141.8908125590535, 117.67976566404104, 133.2023814767599, 119.54688272997736, 134.41187637299288, 126.65763510018587, 131.07461547851562, 117.96879740641451, 121.72680112347007, 117.36270106770095, 131.78792738914484, 130.78280947869638, 122.95038057072088, 128.90430982969707, 116.61983090266584, 144.52777877450006, 131.94601242523655, 143.16066719219072, 90.07083957083523, 136.52643101662395, 128.87626864761114, 128.0585608286783, 122.91844249679707, 132.74130351468915, 128.89689637720588, 109.18540123838466, 104.08928413689135, 139.10535025410326], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [36.36084712793429, 36.50209167723854, 36.5027115655442, 48.29250959306954, 48.097308143973336, 48.250872954726205, 34.55489402512708, 34.53998258213201, 34.840450192491204, 39.085448913276196, 39.23506296053529, 39.272164933383465, 38.92275360971689, 38.879593290388584, 38.637026116251945, 42.87221482520302, 42.76581846674283, 42.348184441526726, 47.41642451410492, 47.55553037424882, 47.28768218805392, 43.047148652374744, 42.903206415474415, 43.04924474284053, 38.74548898575206, 38.445874643822506, 38.82142860939105, 53.64992748325069, 53.75575227042039, 53.10949405034383, 49.277510694849, 49.30513230214517, 48.48339625696342, 35.58294401379922, 35.36632830152908, 35.54904881740609, 35.61239895969629, 35.62007160484791, 35.45759854465723, 38.75911373893419, 39.00320353234807, 39.103561530510575, 35.89021702234943, 36.15564487812419, 35.98156566669543, 37.80247477442026, 37.55683296918869, 37.37192565202713, 40.38740987579027, 40.658525868008525, 40.70116576428214, 37.2972955442965, 36.91380661725998, 37.33335108309984, 40.548598666985825, 40.5561235298713, 40.67522173126538, 37.19837087144454, 37.725419764717415, 37.69300183219214, 29.615825434525803, 29.602417034407452, 29.51016305138667, 23.066096499562263, 23.383341252803802, 23.778890445129946, 33.84938559184471, 34.16135680551329, 34.14053042108813, 36.391720858712986, 36.392338437338665, 36.56030402829249, 46.769789273540184, 46.82850454250972, 46.869509259859726, 34.956169756750256, 34.80217162022987, 34.5251809755961, 35.973293480152876, 35.997377565751464, 35.83695840711394, 38.875989121695355, 39.09477692500998, 38.877398063739136, 43.26524768769741, 42.803305208683014, 43.652687108144164, 46.890288879474, 47.284804237385586, 47.379377623399094, 39.422437995672226, 40.00628888607025, 40.11031912639737, 49.89877066512902, 49.936231327553585, 49.811541614433125, 41.023131812612206, 40.376157889763505, 40.944624001781136, 41.92661130179961, 41.588539642592266, 41.84134376545747, 45.04083831359942, 44.83729661007722, 44.88973632951577, 37.42107247312863, 37.59238169838984, 37.33905983467896, 47.707020585735634, 47.40551861127217, 47.58214250331123, 41.38920450210571, 40.92592769861221, 41.358434572815895, 47.271869627137974, 47.669906338987246, 47.30817429473002, 46.15041710436344, 46.29400407895446, 45.82998648285866, 45.30655103176832, 43.85532608628273, 45.35341153293848, 46.93548460056384, 46.6659932633241, 46.9727367957433, 45.49519291706383, 45.35597724467516, 45.37389812618494, 38.858723898728684, 39.287481659402445, 39.26819456027199, 42.821946928898484, 43.19689385841289, 43.45433553929129, 38.74298254074529, 38.63791237398982, 38.42122786492109, 34.86443872128923, 34.76964362462361, 34.76774450888236, 38.04788831373055, 38.66212002684672, 38.70815548797448, 43.94499127070108, 45.179989093895216, 45.10126060123244, 38.432850643992424, 38.597165897488594, 39.172254756093025, 30.479935735464096, 30.884380891919136, 31.346643417607993, 44.86346119642258, 45.14721456542611, 45.26118144951761, 32.84450818101564, 33.16341139624515, 33.51629281664887, 43.894718773663044, 43.38479906320572, 43.91689846292138, 41.59620819861689, 41.375747251013905, 41.70244353140393, 50.92021107052763, 50.57590206464131, 50.97163887073596, 49.478349082637564, 48.82055044174193, 48.96079517900942, 42.971289231131465, 42.59084707001844, 42.78333991641799, 52.98249719043572, 53.22124519695838, 52.81115961571534, 47.960907891392694, 47.954077720642076, 48.14111260697244, 42.13245125114918, 41.83329136669636, 42.16263537853956, 37.050167861084134, 37.080014551679284, 37.065400312344224, 43.50735964377721, 43.84331349407633, 43.637165186305836, 37.665509956578404, 37.73381747553745, 37.86615658799806, 57.852402895688996, 57.843347460031495, 58.133821643888936, 40.866254319747284, 40.72882508238156, 41.1870210741957, 42.53050923347473, 42.73432444781065, 42.083647549152374, 28.682023160159588, 29.14301162492484, 29.14989598467946, 39.887555489937455, 40.23464589069286, 40.06660426656404, 40.559492511053875, 40.63384513308604, 40.61816795667012, 43.315671668698386, 42.88393825789292, 43.0115875651439, 42.129950538277626, 42.80467975512147, 42.4749349206686, 47.433202814931676, 47.28085420901577, 47.17675553510587, 39.16920217126608, 39.36676608771086, 39.143797405064106, 44.28314436475435, 44.291683251659066, 44.62755386034647, 40.11201067393024, 39.79044795533021, 39.644424100716904, 44.80058419952789, 45.10807319978872, 44.503218973676354, 41.651482090353966, 42.27250701934099, 42.73364599049091, 43.506021221478775, 43.650039454301194, 43.91855480273564, 39.280591975276664, 39.360430502876014, 39.32777492826183, 40.431184485554695, 40.60494964569807, 40.6906669922173, 39.04436859736839, 39.1903968664507, 39.127935603881866, 43.52244546512762, 44.15470078463355, 44.110781139383704, 43.367189342776925, 43.44816974053779, 43.96745039538169, 41.11768706096336, 40.89625361934304, 40.936439890414476, 42.79841163754463, 43.01582986116409, 43.09006833098829, 38.7766671826442, 39.218396366884306, 38.62476735313733, 48.10393907750647, 48.28322269643347, 48.14061700055997, 43.85124822954336, 43.809274079898984, 44.28549011579403, 47.77194645131628, 47.66950068871181, 47.71922005216281, 30.074119893833995, 29.970092717558146, 30.026626959443092, 45.41888929406801, 45.671257632474095, 45.43628409008184, 42.90363495796919, 43.05131470412016, 42.92131898552179, 42.66913337570925, 42.61207991217573, 42.777347540793315, 40.970056887716055, 40.74938154965639, 41.199004059424624, 43.99394469211498, 44.33226168031493, 44.41509714225927, 42.861886392037064, 42.95089821765819, 43.084111767510564, 36.31809865683317, 36.11141347885132, 36.755889102700166, 34.56696818520625, 34.68911143889029, 34.83320451279481, 46.640747465814144, 46.20830836395422, 46.25629442433515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1457666721560439, "mean_inference_ms": 0.700148911476418, "mean_action_processing_ms": 0.10156500919357718, "mean_env_wait_ms": 0.8476813110466863, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 640000, "timesteps_this_iter": 0, "agent_timesteps_total": 1920000, "timers": {"sample_time_ms": 10287.061, "sample_throughput": 486.047, "load_time_ms": 0.102, "load_throughput": 48998878.505, "learn_time_ms": 1578.06, "learn_throughput": 3168.447, "update_time_ms": 7.658}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.462348535570529e-28, "cur_lr": 0.0005000000000000001, "total_loss": 6.781455183029175, "policy_loss": -0.0017320704444622414, "vf_loss": 6.865856170654297, "vf_explained_var": -0.014056515693664551, "kl": 0.003802316135283916, "entropy": 8.266898059844971, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 640000, "num_agent_steps_sampled": 1920000, "num_steps_trained": 640000, "num_agent_steps_trained": 1920000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2136, "training_iteration": 128, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-32-12", "timestamp": 1706229132, "time_this_iter_s": 10.95725965499878, "time_total_s": 1373.061019897461, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202808BA310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1373.061019897461, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 12.168750000000001, "ram_util_percent": 49.787499999999994}}
{"episode_reward_max": 173.82957199960933, "episode_reward_min": 70.22832819749601, "episode_reward_mean": 124.75932492150169, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 23.066096499562263}, "policy_reward_max": {"shared_policy": 58.133821643888936}, "policy_reward_mean": {"shared_policy": 41.586441640500546}, "custom_metrics": {}, "hist_stats": {"episode_reward": [147.06603925395783, 106.49832113273439, 106.69006910920143, 116.86587880179283, 108.02742756716906, 112.73123339563608, 121.74710150808093, 111.54445324465632, 121.7799439281225, 112.61679246835409, 88.72840552031992, 70.22832819749601, 102.15127281844613, 109.34436332434414, 140.4678030759096, 104.28352235257623, 107.80762945301828, 116.84816411044447, 129.7212400045246, 141.55447074025872, 119.53904600813985, 149.64654360711575, 122.34391370415685, 125.35649470984934, 134.76787125319242, 112.35251400619744, 142.69468170031925, 123.67356677353382, 142.24995026085548, 138.27440766617664, 134.51528865098956, 140.57421465963102, 136.22506828792368, 117.41440011840312, 129.47317632660258, 115.8021227796562, 104.4018268547952, 115.41816382855176, 134.2262409658286, 116.20227129757404, 92.71096004499123, 135.27185721136635, 99.52421239390966, 131.19641629979, 124.67439898103473, 152.467752005905, 147.25969470338848, 128.3454762175678, 159.01490200310943, 144.05609821900737, 126.1283779963851, 111.19558272510764, 130.98783832415933, 113.26548402011392, 173.82957199960933, 122.78210047632454, 127.34848123043776, 86.97493076976389, 120.18880564719436, 121.81150560081004, 129.21119749173522, 127.4095652140677, 141.8908125590535, 117.67976566404104, 133.2023814767599, 119.54688272997736, 134.41187637299288, 126.65763510018587, 131.07461547851562, 117.96879740641451, 121.72680112347007, 117.36270106770095, 131.78792738914484, 130.78280947869638, 122.95038057072088, 128.90430982969707, 116.61983090266584, 144.52777877450006, 131.94601242523655, 143.16066719219072, 90.07083957083523, 136.52643101662395, 128.87626864761114, 128.0585608286783, 122.91844249679707, 132.74130351468915, 128.89689637720588, 109.18540123838466, 104.08928413689135, 139.10535025410326, 135.45465931668895, 154.59527812898165, 120.5764863695949, 96.16887657460754, 163.65187531709682, 129.6979827713221, 126.76117511838673, 158.30328232049933, 116.25364772975442, 104.28903183713555], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [49.277510694849, 49.30513230214517, 48.48339625696342, 35.58294401379922, 35.36632830152908, 35.54904881740609, 35.61239895969629, 35.62007160484791, 35.45759854465723, 38.75911373893419, 39.00320353234807, 39.103561530510575, 35.89021702234943, 36.15564487812419, 35.98156566669543, 37.80247477442026, 37.55683296918869, 37.37192565202713, 40.38740987579027, 40.658525868008525, 40.70116576428214, 37.2972955442965, 36.91380661725998, 37.33335108309984, 40.548598666985825, 40.5561235298713, 40.67522173126538, 37.19837087144454, 37.725419764717415, 37.69300183219214, 29.615825434525803, 29.602417034407452, 29.51016305138667, 23.066096499562263, 23.383341252803802, 23.778890445129946, 33.84938559184471, 34.16135680551329, 34.14053042108813, 36.391720858712986, 36.392338437338665, 36.56030402829249, 46.769789273540184, 46.82850454250972, 46.869509259859726, 34.956169756750256, 34.80217162022987, 34.5251809755961, 35.973293480152876, 35.997377565751464, 35.83695840711394, 38.875989121695355, 39.09477692500998, 38.877398063739136, 43.26524768769741, 42.803305208683014, 43.652687108144164, 46.890288879474, 47.284804237385586, 47.379377623399094, 39.422437995672226, 40.00628888607025, 40.11031912639737, 49.89877066512902, 49.936231327553585, 49.811541614433125, 41.023131812612206, 40.376157889763505, 40.944624001781136, 41.92661130179961, 41.588539642592266, 41.84134376545747, 45.04083831359942, 44.83729661007722, 44.88973632951577, 37.42107247312863, 37.59238169838984, 37.33905983467896, 47.707020585735634, 47.40551861127217, 47.58214250331123, 41.38920450210571, 40.92592769861221, 41.358434572815895, 47.271869627137974, 47.669906338987246, 47.30817429473002, 46.15041710436344, 46.29400407895446, 45.82998648285866, 45.30655103176832, 43.85532608628273, 45.35341153293848, 46.93548460056384, 46.6659932633241, 46.9727367957433, 45.49519291706383, 45.35597724467516, 45.37389812618494, 38.858723898728684, 39.287481659402445, 39.26819456027199, 42.821946928898484, 43.19689385841289, 43.45433553929129, 38.74298254074529, 38.63791237398982, 38.42122786492109, 34.86443872128923, 34.76964362462361, 34.76774450888236, 38.04788831373055, 38.66212002684672, 38.70815548797448, 43.94499127070108, 45.179989093895216, 45.10126060123244, 38.432850643992424, 38.597165897488594, 39.172254756093025, 30.479935735464096, 30.884380891919136, 31.346643417607993, 44.86346119642258, 45.14721456542611, 45.26118144951761, 32.84450818101564, 33.16341139624515, 33.51629281664887, 43.894718773663044, 43.38479906320572, 43.91689846292138, 41.59620819861689, 41.375747251013905, 41.70244353140393, 50.92021107052763, 50.57590206464131, 50.97163887073596, 49.478349082637564, 48.82055044174193, 48.96079517900942, 42.971289231131465, 42.59084707001844, 42.78333991641799, 52.98249719043572, 53.22124519695838, 52.81115961571534, 47.960907891392694, 47.954077720642076, 48.14111260697244, 42.13245125114918, 41.83329136669636, 42.16263537853956, 37.050167861084134, 37.080014551679284, 37.065400312344224, 43.50735964377721, 43.84331349407633, 43.637165186305836, 37.665509956578404, 37.73381747553745, 37.86615658799806, 57.852402895688996, 57.843347460031495, 58.133821643888936, 40.866254319747284, 40.72882508238156, 41.1870210741957, 42.53050923347473, 42.73432444781065, 42.083647549152374, 28.682023160159588, 29.14301162492484, 29.14989598467946, 39.887555489937455, 40.23464589069286, 40.06660426656404, 40.559492511053875, 40.63384513308604, 40.61816795667012, 43.315671668698386, 42.88393825789292, 43.0115875651439, 42.129950538277626, 42.80467975512147, 42.4749349206686, 47.433202814931676, 47.28085420901577, 47.17675553510587, 39.16920217126608, 39.36676608771086, 39.143797405064106, 44.28314436475435, 44.291683251659066, 44.62755386034647, 40.11201067393024, 39.79044795533021, 39.644424100716904, 44.80058419952789, 45.10807319978872, 44.503218973676354, 41.651482090353966, 42.27250701934099, 42.73364599049091, 43.506021221478775, 43.650039454301194, 43.91855480273564, 39.280591975276664, 39.360430502876014, 39.32777492826183, 40.431184485554695, 40.60494964569807, 40.6906669922173, 39.04436859736839, 39.1903968664507, 39.127935603881866, 43.52244546512762, 44.15470078463355, 44.110781139383704, 43.367189342776925, 43.44816974053779, 43.96745039538169, 41.11768706096336, 40.89625361934304, 40.936439890414476, 42.79841163754463, 43.01582986116409, 43.09006833098829, 38.7766671826442, 39.218396366884306, 38.62476735313733, 48.10393907750647, 48.28322269643347, 48.14061700055997, 43.85124822954336, 43.809274079898984, 44.28549011579403, 47.77194645131628, 47.66950068871181, 47.71922005216281, 30.074119893833995, 29.970092717558146, 30.026626959443092, 45.41888929406801, 45.671257632474095, 45.43628409008184, 42.90363495796919, 43.05131470412016, 42.92131898552179, 42.66913337570925, 42.61207991217573, 42.777347540793315, 40.970056887716055, 40.74938154965639, 41.199004059424624, 43.99394469211498, 44.33226168031493, 44.41509714225927, 42.861886392037064, 42.95089821765819, 43.084111767510564, 36.31809865683317, 36.11141347885132, 36.755889102700166, 34.56696818520625, 34.68911143889029, 34.83320451279481, 46.640747465814144, 46.20830836395422, 46.25629442433515, 45.06498595823844, 45.61351195101936, 44.77616140743096, 51.52942950526874, 51.35518788049619, 51.71066074321668, 40.20416317383447, 40.006700100998074, 40.365623094762356, 31.966829406718404, 31.823557982842118, 32.378489185047016, 54.59169712041815, 54.49939455961187, 54.56078363706668, 43.51001362937191, 43.26566447193423, 42.92230467001596, 42.38577032585938, 42.23144954194625, 42.1439552505811, 52.79685134192307, 52.77275612701972, 52.733674851556614, 39.00847064952055, 38.73066286245981, 38.514514217774064, 34.591622069478035, 34.55331401526928, 35.14409575238824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.145719970726928, "mean_inference_ms": 0.7001776493204847, "mean_action_processing_ms": 0.10154942529201398, "mean_env_wait_ms": 0.8473379913656945, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 645000, "timesteps_this_iter": 0, "agent_timesteps_total": 1935000, "timers": {"sample_time_ms": 10391.224, "sample_throughput": 481.175, "load_time_ms": 0.102, "load_throughput": 48998878.505, "learn_time_ms": 1566.466, "learn_throughput": 3191.899, "update_time_ms": 7.597}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.2311742677852645e-28, "cur_lr": 0.0005000000000000001, "total_loss": 8.20478343963623, "policy_loss": 0.0019303337030889267, "vf_loss": 8.28644256591797, "vf_explained_var": -0.0074431061744689945, "kl": 0.007896416983590096, "entropy": 8.358945655822755, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 645000, "num_agent_steps_sampled": 1935000, "num_steps_trained": 645000, "num_agent_steps_trained": 1935000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2146, "training_iteration": 129, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-32-23", "timestamp": 1706229143, "time_this_iter_s": 10.989347696304321, "time_total_s": 1384.0503675937653, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282542AF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1384.0503675937653, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 11.2375, "ram_util_percent": 49.775}}
{"episode_reward_max": 173.82957199960933, "episode_reward_min": -271.0409400239587, "episode_reward_mean": 123.20383430008017, "episode_len_mean": 497.66, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -93.7287082274755}, "policy_reward_max": {"shared_policy": 58.133821643888936}, "policy_reward_mean": {"shared_policy": 41.067944766693394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [88.72840552031992, 70.22832819749601, 102.15127281844613, 109.34436332434414, 140.4678030759096, 104.28352235257623, 107.80762945301828, 116.84816411044447, 129.7212400045246, 141.55447074025872, 119.53904600813985, 149.64654360711575, 122.34391370415685, 125.35649470984934, 134.76787125319242, 112.35251400619744, 142.69468170031925, 123.67356677353382, 142.24995026085548, 138.27440766617664, 134.51528865098956, 140.57421465963102, 136.22506828792368, 117.41440011840312, 129.47317632660258, 115.8021227796562, 104.4018268547952, 115.41816382855176, 134.2262409658286, 116.20227129757404, 92.71096004499123, 135.27185721136635, 99.52421239390966, 131.19641629979, 124.67439898103473, 152.467752005905, 147.25969470338848, 128.3454762175678, 159.01490200310943, 144.05609821900737, 126.1283779963851, 111.19558272510764, 130.98783832415933, 113.26548402011392, 173.82957199960933, 122.78210047632454, 127.34848123043776, 86.97493076976389, 120.18880564719436, 121.81150560081004, 129.21119749173522, 127.4095652140677, 141.8908125590535, 117.67976566404104, 133.2023814767599, 119.54688272997736, 134.41187637299288, 126.65763510018587, 131.07461547851562, 117.96879740641451, 121.72680112347007, 117.36270106770095, 131.78792738914484, 130.78280947869638, 122.95038057072088, 128.90430982969707, 116.61983090266584, 144.52777877450006, 131.94601242523655, 143.16066719219072, 90.07083957083523, 136.52643101662395, 128.87626864761114, 128.0585608286783, 122.91844249679707, 132.74130351468915, 128.89689637720588, 109.18540123838466, 104.08928413689135, 139.10535025410326, 135.45465931668895, 154.59527812898165, 120.5764863695949, 96.16887657460754, 163.65187531709682, 129.6979827713221, 126.76117511838673, 158.30328232049933, 116.25364772975442, 104.28903183713555, 167.75661764852686, 167.89767466671753, 144.85579979419714, 125.60183969885111, 98.6074091643095, 129.6458957642315, 145.50421710312318, -271.0409400239587, 151.35685819014913, 149.8328262614086], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 266, 500, 500], "policy_shared_policy_reward": [29.615825434525803, 29.602417034407452, 29.51016305138667, 23.066096499562263, 23.383341252803802, 23.778890445129946, 33.84938559184471, 34.16135680551329, 34.14053042108813, 36.391720858712986, 36.392338437338665, 36.56030402829249, 46.769789273540184, 46.82850454250972, 46.869509259859726, 34.956169756750256, 34.80217162022987, 34.5251809755961, 35.973293480152876, 35.997377565751464, 35.83695840711394, 38.875989121695355, 39.09477692500998, 38.877398063739136, 43.26524768769741, 42.803305208683014, 43.652687108144164, 46.890288879474, 47.284804237385586, 47.379377623399094, 39.422437995672226, 40.00628888607025, 40.11031912639737, 49.89877066512902, 49.936231327553585, 49.811541614433125, 41.023131812612206, 40.376157889763505, 40.944624001781136, 41.92661130179961, 41.588539642592266, 41.84134376545747, 45.04083831359942, 44.83729661007722, 44.88973632951577, 37.42107247312863, 37.59238169838984, 37.33905983467896, 47.707020585735634, 47.40551861127217, 47.58214250331123, 41.38920450210571, 40.92592769861221, 41.358434572815895, 47.271869627137974, 47.669906338987246, 47.30817429473002, 46.15041710436344, 46.29400407895446, 45.82998648285866, 45.30655103176832, 43.85532608628273, 45.35341153293848, 46.93548460056384, 46.6659932633241, 46.9727367957433, 45.49519291706383, 45.35597724467516, 45.37389812618494, 38.858723898728684, 39.287481659402445, 39.26819456027199, 42.821946928898484, 43.19689385841289, 43.45433553929129, 38.74298254074529, 38.63791237398982, 38.42122786492109, 34.86443872128923, 34.76964362462361, 34.76774450888236, 38.04788831373055, 38.66212002684672, 38.70815548797448, 43.94499127070108, 45.179989093895216, 45.10126060123244, 38.432850643992424, 38.597165897488594, 39.172254756093025, 30.479935735464096, 30.884380891919136, 31.346643417607993, 44.86346119642258, 45.14721456542611, 45.26118144951761, 32.84450818101564, 33.16341139624515, 33.51629281664887, 43.894718773663044, 43.38479906320572, 43.91689846292138, 41.59620819861689, 41.375747251013905, 41.70244353140393, 50.92021107052763, 50.57590206464131, 50.97163887073596, 49.478349082637564, 48.82055044174193, 48.96079517900942, 42.971289231131465, 42.59084707001844, 42.78333991641799, 52.98249719043572, 53.22124519695838, 52.81115961571534, 47.960907891392694, 47.954077720642076, 48.14111260697244, 42.13245125114918, 41.83329136669636, 42.16263537853956, 37.050167861084134, 37.080014551679284, 37.065400312344224, 43.50735964377721, 43.84331349407633, 43.637165186305836, 37.665509956578404, 37.73381747553745, 37.86615658799806, 57.852402895688996, 57.843347460031495, 58.133821643888936, 40.866254319747284, 40.72882508238156, 41.1870210741957, 42.53050923347473, 42.73432444781065, 42.083647549152374, 28.682023160159588, 29.14301162492484, 29.14989598467946, 39.887555489937455, 40.23464589069286, 40.06660426656404, 40.559492511053875, 40.63384513308604, 40.61816795667012, 43.315671668698386, 42.88393825789292, 43.0115875651439, 42.129950538277626, 42.80467975512147, 42.4749349206686, 47.433202814931676, 47.28085420901577, 47.17675553510587, 39.16920217126608, 39.36676608771086, 39.143797405064106, 44.28314436475435, 44.291683251659066, 44.62755386034647, 40.11201067393024, 39.79044795533021, 39.644424100716904, 44.80058419952789, 45.10807319978872, 44.503218973676354, 41.651482090353966, 42.27250701934099, 42.73364599049091, 43.506021221478775, 43.650039454301194, 43.91855480273564, 39.280591975276664, 39.360430502876014, 39.32777492826183, 40.431184485554695, 40.60494964569807, 40.6906669922173, 39.04436859736839, 39.1903968664507, 39.127935603881866, 43.52244546512762, 44.15470078463355, 44.110781139383704, 43.367189342776925, 43.44816974053779, 43.96745039538169, 41.11768706096336, 40.89625361934304, 40.936439890414476, 42.79841163754463, 43.01582986116409, 43.09006833098829, 38.7766671826442, 39.218396366884306, 38.62476735313733, 48.10393907750647, 48.28322269643347, 48.14061700055997, 43.85124822954336, 43.809274079898984, 44.28549011579403, 47.77194645131628, 47.66950068871181, 47.71922005216281, 30.074119893833995, 29.970092717558146, 30.026626959443092, 45.41888929406801, 45.671257632474095, 45.43628409008184, 42.90363495796919, 43.05131470412016, 42.92131898552179, 42.66913337570925, 42.61207991217573, 42.777347540793315, 40.970056887716055, 40.74938154965639, 41.199004059424624, 43.99394469211498, 44.33226168031493, 44.41509714225927, 42.861886392037064, 42.95089821765819, 43.084111767510564, 36.31809865683317, 36.11141347885132, 36.755889102700166, 34.56696818520625, 34.68911143889029, 34.83320451279481, 46.640747465814144, 46.20830836395422, 46.25629442433515, 45.06498595823844, 45.61351195101936, 44.77616140743096, 51.52942950526874, 51.35518788049619, 51.71066074321668, 40.20416317383447, 40.006700100998074, 40.365623094762356, 31.966829406718404, 31.823557982842118, 32.378489185047016, 54.59169712041815, 54.49939455961187, 54.56078363706668, 43.51001362937191, 43.26566447193423, 42.92230467001596, 42.38577032585938, 42.23144954194625, 42.1439552505811, 52.79685134192307, 52.77275612701972, 52.733674851556614, 39.00847064952055, 38.73066286245981, 38.514514217774064, 34.591622069478035, 34.55331401526928, 35.14409575238824, 55.99466743941109, 55.656808848182365, 56.10514136093359, 55.916561233500644, 55.686814794937774, 56.294298638279244, 48.2099980264902, 48.34393163770436, 48.301870130002484, 41.81712049245834, 41.768062964081764, 42.016656242311, 32.76326309144497, 32.894920997321606, 32.94922507554293, 42.982631782690675, 43.355323570470006, 43.30794041107097, 48.61371742933987, 48.488596402108655, 48.401903271675096, -88.61601368834576, -88.69621810813746, -93.7287082274755, 50.74428443734844, 50.14040633042653, 50.472167422374085, 49.54294679065545, 50.159920946074024, 50.12995852467914]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14565496791410276, "mean_inference_ms": 0.7001034112832417, "mean_action_processing_ms": 0.10151964247543573, "mean_env_wait_ms": 0.8469348280894432, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 650000, "timesteps_this_iter": 0, "agent_timesteps_total": 1950000, "timers": {"sample_time_ms": 10252.534, "sample_throughput": 487.684, "load_time_ms": 0.102, "load_throughput": 48998878.505, "learn_time_ms": 1569.231, "learn_throughput": 3186.274, "update_time_ms": 7.551}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.2311742677852645e-28, "cur_lr": 0.0005000000000000001, "total_loss": 124.41554565429688, "policy_loss": 0.0019060059925292804, "vf_loss": 124.4943000793457, "vf_explained_var": 0.00913507342338562, "kl": 0.18893419802191375, "entropy": 8.06598720550537, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 650000, "num_agent_steps_sampled": 1950000, "num_steps_trained": 650000, "num_agent_steps_trained": 1950000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2156, "training_iteration": 130, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-32-33", "timestamp": 1706229153, "time_this_iter_s": 9.831116676330566, "time_total_s": 1393.8814842700958, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028227A040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1393.8814842700958, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 10.346153846153847, "ram_util_percent": 49.76923076923077}}
{"episode_reward_max": 173.82957199960933, "episode_reward_min": -271.0409400239587, "episode_reward_mean": 125.08024649418134, "episode_len_mean": 497.66, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -93.7287082274755}, "policy_reward_max": {"shared_policy": 58.133821643888936}, "policy_reward_mean": {"shared_policy": 41.69341549806043}, "custom_metrics": {}, "hist_stats": {"episode_reward": [119.53904600813985, 149.64654360711575, 122.34391370415685, 125.35649470984934, 134.76787125319242, 112.35251400619744, 142.69468170031925, 123.67356677353382, 142.24995026085548, 138.27440766617664, 134.51528865098956, 140.57421465963102, 136.22506828792368, 117.41440011840312, 129.47317632660258, 115.8021227796562, 104.4018268547952, 115.41816382855176, 134.2262409658286, 116.20227129757404, 92.71096004499123, 135.27185721136635, 99.52421239390966, 131.19641629979, 124.67439898103473, 152.467752005905, 147.25969470338848, 128.3454762175678, 159.01490200310943, 144.05609821900737, 126.1283779963851, 111.19558272510764, 130.98783832415933, 113.26548402011392, 173.82957199960933, 122.78210047632454, 127.34848123043776, 86.97493076976389, 120.18880564719436, 121.81150560081004, 129.21119749173522, 127.4095652140677, 141.8908125590535, 117.67976566404104, 133.2023814767599, 119.54688272997736, 134.41187637299288, 126.65763510018587, 131.07461547851562, 117.96879740641451, 121.72680112347007, 117.36270106770095, 131.78792738914484, 130.78280947869638, 122.95038057072088, 128.90430982969707, 116.61983090266584, 144.52777877450006, 131.94601242523655, 143.16066719219072, 90.07083957083523, 136.52643101662395, 128.87626864761114, 128.0585608286783, 122.91844249679707, 132.74130351468915, 128.89689637720588, 109.18540123838466, 104.08928413689135, 139.10535025410326, 135.45465931668895, 154.59527812898165, 120.5764863695949, 96.16887657460754, 163.65187531709682, 129.6979827713221, 126.76117511838673, 158.30328232049933, 116.25364772975442, 104.28903183713555, 167.75661764852686, 167.89767466671753, 144.85579979419714, 125.60183969885111, 98.6074091643095, 129.6458957642315, 145.50421710312318, -271.0409400239587, 151.35685819014913, 149.8328262614086, 112.04908834234809, 154.78532445803282, 137.7549224793912, 110.27082038484514, 131.81913538463402, 129.44476425647736, 131.11788378655905, 134.71854474116125, 114.00911807268857, 142.80681710131483], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 266, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [39.422437995672226, 40.00628888607025, 40.11031912639737, 49.89877066512902, 49.936231327553585, 49.811541614433125, 41.023131812612206, 40.376157889763505, 40.944624001781136, 41.92661130179961, 41.588539642592266, 41.84134376545747, 45.04083831359942, 44.83729661007722, 44.88973632951577, 37.42107247312863, 37.59238169838984, 37.33905983467896, 47.707020585735634, 47.40551861127217, 47.58214250331123, 41.38920450210571, 40.92592769861221, 41.358434572815895, 47.271869627137974, 47.669906338987246, 47.30817429473002, 46.15041710436344, 46.29400407895446, 45.82998648285866, 45.30655103176832, 43.85532608628273, 45.35341153293848, 46.93548460056384, 46.6659932633241, 46.9727367957433, 45.49519291706383, 45.35597724467516, 45.37389812618494, 38.858723898728684, 39.287481659402445, 39.26819456027199, 42.821946928898484, 43.19689385841289, 43.45433553929129, 38.74298254074529, 38.63791237398982, 38.42122786492109, 34.86443872128923, 34.76964362462361, 34.76774450888236, 38.04788831373055, 38.66212002684672, 38.70815548797448, 43.94499127070108, 45.179989093895216, 45.10126060123244, 38.432850643992424, 38.597165897488594, 39.172254756093025, 30.479935735464096, 30.884380891919136, 31.346643417607993, 44.86346119642258, 45.14721456542611, 45.26118144951761, 32.84450818101564, 33.16341139624515, 33.51629281664887, 43.894718773663044, 43.38479906320572, 43.91689846292138, 41.59620819861689, 41.375747251013905, 41.70244353140393, 50.92021107052763, 50.57590206464131, 50.97163887073596, 49.478349082637564, 48.82055044174193, 48.96079517900942, 42.971289231131465, 42.59084707001844, 42.78333991641799, 52.98249719043572, 53.22124519695838, 52.81115961571534, 47.960907891392694, 47.954077720642076, 48.14111260697244, 42.13245125114918, 41.83329136669636, 42.16263537853956, 37.050167861084134, 37.080014551679284, 37.065400312344224, 43.50735964377721, 43.84331349407633, 43.637165186305836, 37.665509956578404, 37.73381747553745, 37.86615658799806, 57.852402895688996, 57.843347460031495, 58.133821643888936, 40.866254319747284, 40.72882508238156, 41.1870210741957, 42.53050923347473, 42.73432444781065, 42.083647549152374, 28.682023160159588, 29.14301162492484, 29.14989598467946, 39.887555489937455, 40.23464589069286, 40.06660426656404, 40.559492511053875, 40.63384513308604, 40.61816795667012, 43.315671668698386, 42.88393825789292, 43.0115875651439, 42.129950538277626, 42.80467975512147, 42.4749349206686, 47.433202814931676, 47.28085420901577, 47.17675553510587, 39.16920217126608, 39.36676608771086, 39.143797405064106, 44.28314436475435, 44.291683251659066, 44.62755386034647, 40.11201067393024, 39.79044795533021, 39.644424100716904, 44.80058419952789, 45.10807319978872, 44.503218973676354, 41.651482090353966, 42.27250701934099, 42.73364599049091, 43.506021221478775, 43.650039454301194, 43.91855480273564, 39.280591975276664, 39.360430502876014, 39.32777492826183, 40.431184485554695, 40.60494964569807, 40.6906669922173, 39.04436859736839, 39.1903968664507, 39.127935603881866, 43.52244546512762, 44.15470078463355, 44.110781139383704, 43.367189342776925, 43.44816974053779, 43.96745039538169, 41.11768706096336, 40.89625361934304, 40.936439890414476, 42.79841163754463, 43.01582986116409, 43.09006833098829, 38.7766671826442, 39.218396366884306, 38.62476735313733, 48.10393907750647, 48.28322269643347, 48.14061700055997, 43.85124822954336, 43.809274079898984, 44.28549011579403, 47.77194645131628, 47.66950068871181, 47.71922005216281, 30.074119893833995, 29.970092717558146, 30.026626959443092, 45.41888929406801, 45.671257632474095, 45.43628409008184, 42.90363495796919, 43.05131470412016, 42.92131898552179, 42.66913337570925, 42.61207991217573, 42.777347540793315, 40.970056887716055, 40.74938154965639, 41.199004059424624, 43.99394469211498, 44.33226168031493, 44.41509714225927, 42.861886392037064, 42.95089821765819, 43.084111767510564, 36.31809865683317, 36.11141347885132, 36.755889102700166, 34.56696818520625, 34.68911143889029, 34.83320451279481, 46.640747465814144, 46.20830836395422, 46.25629442433515, 45.06498595823844, 45.61351195101936, 44.77616140743096, 51.52942950526874, 51.35518788049619, 51.71066074321668, 40.20416317383447, 40.006700100998074, 40.365623094762356, 31.966829406718404, 31.823557982842118, 32.378489185047016, 54.59169712041815, 54.49939455961187, 54.56078363706668, 43.51001362937191, 43.26566447193423, 42.92230467001596, 42.38577032585938, 42.23144954194625, 42.1439552505811, 52.79685134192307, 52.77275612701972, 52.733674851556614, 39.00847064952055, 38.73066286245981, 38.514514217774064, 34.591622069478035, 34.55331401526928, 35.14409575238824, 55.99466743941109, 55.656808848182365, 56.10514136093359, 55.916561233500644, 55.686814794937774, 56.294298638279244, 48.2099980264902, 48.34393163770436, 48.301870130002484, 41.81712049245834, 41.768062964081764, 42.016656242311, 32.76326309144497, 32.894920997321606, 32.94922507554293, 42.982631782690675, 43.355323570470006, 43.30794041107097, 48.61371742933987, 48.488596402108655, 48.401903271675096, -88.61601368834576, -88.69621810813746, -93.7287082274755, 50.74428443734844, 50.14040633042653, 50.472167422374085, 49.54294679065545, 50.159920946074024, 50.12995852467914, 37.2253665352861, 37.245779077212006, 37.57794272984998, 51.79382242634891, 51.54286591708659, 51.448636114597306, 46.10736473401387, 45.791085836788014, 45.8564719085892, 36.997753566130996, 36.65076096355915, 36.62230585515499, 43.88748014221588, 43.63641222814718, 44.29524301427105, 43.283167742192745, 42.655131071805954, 43.50646544247866, 43.77146972219148, 43.74265184501806, 43.603762219349534, 44.952864706516266, 44.55093985795975, 45.214740176685154, 37.815325667460755, 37.886727934082344, 38.307064471145466, 47.27889261643092, 47.6431461746494, 47.88477831023435]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14557685281518518, "mean_inference_ms": 0.7000068870469923, "mean_action_processing_ms": 0.10148786979908975, "mean_env_wait_ms": 0.8465273477106848, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 655000, "timesteps_this_iter": 0, "agent_timesteps_total": 1965000, "timers": {"sample_time_ms": 10217.478, "sample_throughput": 489.358, "load_time_ms": 0.102, "load_throughput": 48998878.505, "learn_time_ms": 1569.391, "learn_throughput": 3185.949, "update_time_ms": 7.651}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.846761401677896e-28, "cur_lr": 0.0005000000000000001, "total_loss": 8.31822853088379, "policy_loss": 0.0024521497253421564, "vf_loss": 8.400803279876708, "vf_explained_var": -0.004362046718597412, "kl": 0.010280518606329192, "entropy": 8.5026930809021, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 655000, "num_agent_steps_sampled": 1965000, "num_steps_trained": 655000, "num_agent_steps_trained": 1965000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2166, "training_iteration": 131, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-32-42", "timestamp": 1706229162, "time_this_iter_s": 9.65149188041687, "time_total_s": 1403.5329761505127, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028379E0D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1403.5329761505127, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 10.192857142857145, "ram_util_percent": 49.80714285714284}}
{"episode_reward_max": 173.82957199960933, "episode_reward_min": -271.0409400239587, "episode_reward_mean": 124.9743281512166, "episode_len_mean": 497.66, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -93.7287082274755}, "policy_reward_max": {"shared_policy": 58.133821643888936}, "policy_reward_mean": {"shared_policy": 41.65810938373887}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.51528865098956, 140.57421465963102, 136.22506828792368, 117.41440011840312, 129.47317632660258, 115.8021227796562, 104.4018268547952, 115.41816382855176, 134.2262409658286, 116.20227129757404, 92.71096004499123, 135.27185721136635, 99.52421239390966, 131.19641629979, 124.67439898103473, 152.467752005905, 147.25969470338848, 128.3454762175678, 159.01490200310943, 144.05609821900737, 126.1283779963851, 111.19558272510764, 130.98783832415933, 113.26548402011392, 173.82957199960933, 122.78210047632454, 127.34848123043776, 86.97493076976389, 120.18880564719436, 121.81150560081004, 129.21119749173522, 127.4095652140677, 141.8908125590535, 117.67976566404104, 133.2023814767599, 119.54688272997736, 134.41187637299288, 126.65763510018587, 131.07461547851562, 117.96879740641451, 121.72680112347007, 117.36270106770095, 131.78792738914484, 130.78280947869638, 122.95038057072088, 128.90430982969707, 116.61983090266584, 144.52777877450006, 131.94601242523655, 143.16066719219072, 90.07083957083523, 136.52643101662395, 128.87626864761114, 128.0585608286783, 122.91844249679707, 132.74130351468915, 128.89689637720588, 109.18540123838466, 104.08928413689135, 139.10535025410326, 135.45465931668895, 154.59527812898165, 120.5764863695949, 96.16887657460754, 163.65187531709682, 129.6979827713221, 126.76117511838673, 158.30328232049933, 116.25364772975442, 104.28903183713555, 167.75661764852686, 167.89767466671753, 144.85579979419714, 125.60183969885111, 98.6074091643095, 129.6458957642315, 145.50421710312318, -271.0409400239587, 151.35685819014913, 149.8328262614086, 112.04908834234809, 154.78532445803282, 137.7549224793912, 110.27082038484514, 131.81913538463402, 129.44476425647736, 131.11788378655905, 134.71854474116125, 114.00911807268857, 142.80681710131483, 137.62255625100806, 127.90208644419909, 121.13010664656757, 120.84051058441399, 137.7459141719154, 153.5410344004626, 128.61702033504844, 122.23495800793168, 148.10227871686214, 102.5706898346543], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 266, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [45.30655103176832, 43.85532608628273, 45.35341153293848, 46.93548460056384, 46.6659932633241, 46.9727367957433, 45.49519291706383, 45.35597724467516, 45.37389812618494, 38.858723898728684, 39.287481659402445, 39.26819456027199, 42.821946928898484, 43.19689385841289, 43.45433553929129, 38.74298254074529, 38.63791237398982, 38.42122786492109, 34.86443872128923, 34.76964362462361, 34.76774450888236, 38.04788831373055, 38.66212002684672, 38.70815548797448, 43.94499127070108, 45.179989093895216, 45.10126060123244, 38.432850643992424, 38.597165897488594, 39.172254756093025, 30.479935735464096, 30.884380891919136, 31.346643417607993, 44.86346119642258, 45.14721456542611, 45.26118144951761, 32.84450818101564, 33.16341139624515, 33.51629281664887, 43.894718773663044, 43.38479906320572, 43.91689846292138, 41.59620819861689, 41.375747251013905, 41.70244353140393, 50.92021107052763, 50.57590206464131, 50.97163887073596, 49.478349082637564, 48.82055044174193, 48.96079517900942, 42.971289231131465, 42.59084707001844, 42.78333991641799, 52.98249719043572, 53.22124519695838, 52.81115961571534, 47.960907891392694, 47.954077720642076, 48.14111260697244, 42.13245125114918, 41.83329136669636, 42.16263537853956, 37.050167861084134, 37.080014551679284, 37.065400312344224, 43.50735964377721, 43.84331349407633, 43.637165186305836, 37.665509956578404, 37.73381747553745, 37.86615658799806, 57.852402895688996, 57.843347460031495, 58.133821643888936, 40.866254319747284, 40.72882508238156, 41.1870210741957, 42.53050923347473, 42.73432444781065, 42.083647549152374, 28.682023160159588, 29.14301162492484, 29.14989598467946, 39.887555489937455, 40.23464589069286, 40.06660426656404, 40.559492511053875, 40.63384513308604, 40.61816795667012, 43.315671668698386, 42.88393825789292, 43.0115875651439, 42.129950538277626, 42.80467975512147, 42.4749349206686, 47.433202814931676, 47.28085420901577, 47.17675553510587, 39.16920217126608, 39.36676608771086, 39.143797405064106, 44.28314436475435, 44.291683251659066, 44.62755386034647, 40.11201067393024, 39.79044795533021, 39.644424100716904, 44.80058419952789, 45.10807319978872, 44.503218973676354, 41.651482090353966, 42.27250701934099, 42.73364599049091, 43.506021221478775, 43.650039454301194, 43.91855480273564, 39.280591975276664, 39.360430502876014, 39.32777492826183, 40.431184485554695, 40.60494964569807, 40.6906669922173, 39.04436859736839, 39.1903968664507, 39.127935603881866, 43.52244546512762, 44.15470078463355, 44.110781139383704, 43.367189342776925, 43.44816974053779, 43.96745039538169, 41.11768706096336, 40.89625361934304, 40.936439890414476, 42.79841163754463, 43.01582986116409, 43.09006833098829, 38.7766671826442, 39.218396366884306, 38.62476735313733, 48.10393907750647, 48.28322269643347, 48.14061700055997, 43.85124822954336, 43.809274079898984, 44.28549011579403, 47.77194645131628, 47.66950068871181, 47.71922005216281, 30.074119893833995, 29.970092717558146, 30.026626959443092, 45.41888929406801, 45.671257632474095, 45.43628409008184, 42.90363495796919, 43.05131470412016, 42.92131898552179, 42.66913337570925, 42.61207991217573, 42.777347540793315, 40.970056887716055, 40.74938154965639, 41.199004059424624, 43.99394469211498, 44.33226168031493, 44.41509714225927, 42.861886392037064, 42.95089821765819, 43.084111767510564, 36.31809865683317, 36.11141347885132, 36.755889102700166, 34.56696818520625, 34.68911143889029, 34.83320451279481, 46.640747465814144, 46.20830836395422, 46.25629442433515, 45.06498595823844, 45.61351195101936, 44.77616140743096, 51.52942950526874, 51.35518788049619, 51.71066074321668, 40.20416317383447, 40.006700100998074, 40.365623094762356, 31.966829406718404, 31.823557982842118, 32.378489185047016, 54.59169712041815, 54.49939455961187, 54.56078363706668, 43.51001362937191, 43.26566447193423, 42.92230467001596, 42.38577032585938, 42.23144954194625, 42.1439552505811, 52.79685134192307, 52.77275612701972, 52.733674851556614, 39.00847064952055, 38.73066286245981, 38.514514217774064, 34.591622069478035, 34.55331401526928, 35.14409575238824, 55.99466743941109, 55.656808848182365, 56.10514136093359, 55.916561233500644, 55.686814794937774, 56.294298638279244, 48.2099980264902, 48.34393163770436, 48.301870130002484, 41.81712049245834, 41.768062964081764, 42.016656242311, 32.76326309144497, 32.894920997321606, 32.94922507554293, 42.982631782690675, 43.355323570470006, 43.30794041107097, 48.61371742933987, 48.488596402108655, 48.401903271675096, -88.61601368834576, -88.69621810813746, -93.7287082274755, 50.74428443734844, 50.14040633042653, 50.472167422374085, 49.54294679065545, 50.159920946074024, 50.12995852467914, 37.2253665352861, 37.245779077212006, 37.57794272984998, 51.79382242634891, 51.54286591708659, 51.448636114597306, 46.10736473401387, 45.791085836788014, 45.8564719085892, 36.997753566130996, 36.65076096355915, 36.62230585515499, 43.88748014221588, 43.63641222814718, 44.29524301427105, 43.283167742192745, 42.655131071805954, 43.50646544247866, 43.77146972219148, 43.74265184501806, 43.603762219349534, 44.952864706516266, 44.55093985795975, 45.214740176685154, 37.815325667460755, 37.886727934082344, 38.307064471145466, 47.27889261643092, 47.6431461746494, 47.88477831023435, 46.062895435219005, 45.474202906092, 46.08545790969704, 42.7819844558835, 42.69311434030533, 42.426987648010254, 40.05457706501086, 40.42991289620598, 40.64561668535073, 40.203077410658196, 40.687296492358044, 39.95013668139775, 45.795031774789095, 45.966697412543, 45.98418498458341, 51.10698921481769, 51.312154660622284, 51.12189052502315, 42.82406853263576, 42.87506552164753, 42.91788628076513, 40.449124241868645, 40.952865930895, 40.832967835168034, 49.59103127568959, 49.049253255128846, 49.461994186043725, 33.86421577135721, 34.35829733560482, 34.34817672769228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1455043009721722, "mean_inference_ms": 0.6999728565979276, "mean_action_processing_ms": 0.10146848417544979, "mean_env_wait_ms": 0.8461707003813262, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 660000, "timesteps_this_iter": 0, "agent_timesteps_total": 1980000, "timers": {"sample_time_ms": 10295.641, "sample_throughput": 485.642, "load_time_ms": 0.102, "load_throughput": 48998878.505, "learn_time_ms": 1586.81, "learn_throughput": 3150.975, "update_time_ms": 7.903}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.846761401677896e-28, "cur_lr": 0.0005000000000000001, "total_loss": 8.601364040374756, "policy_loss": 0.0027905799058210333, "vf_loss": 8.682163906097411, "vf_explained_var": -0.023954761028289796, "kl": 0.014891391573498312, "entropy": 8.359076499938965, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 660000, "num_agent_steps_sampled": 1980000, "num_steps_trained": 660000, "num_agent_steps_trained": 1980000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2176, "training_iteration": 132, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-32-54", "timestamp": 1706229174, "time_this_iter_s": 11.267088890075684, "time_total_s": 1414.8000650405884, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202846E4550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1414.8000650405884, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 11.08125, "ram_util_percent": 49.8125}}
{"episode_reward_max": 173.82957199960933, "episode_reward_min": -271.0409400239587, "episode_reward_mean": 126.99330911037391, "episode_len_mean": 497.66, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -93.7287082274755}, "policy_reward_max": {"shared_policy": 58.133821643888936}, "policy_reward_mean": {"shared_policy": 42.33110303679132}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.71096004499123, 135.27185721136635, 99.52421239390966, 131.19641629979, 124.67439898103473, 152.467752005905, 147.25969470338848, 128.3454762175678, 159.01490200310943, 144.05609821900737, 126.1283779963851, 111.19558272510764, 130.98783832415933, 113.26548402011392, 173.82957199960933, 122.78210047632454, 127.34848123043776, 86.97493076976389, 120.18880564719436, 121.81150560081004, 129.21119749173522, 127.4095652140677, 141.8908125590535, 117.67976566404104, 133.2023814767599, 119.54688272997736, 134.41187637299288, 126.65763510018587, 131.07461547851562, 117.96879740641451, 121.72680112347007, 117.36270106770095, 131.78792738914484, 130.78280947869638, 122.95038057072088, 128.90430982969707, 116.61983090266584, 144.52777877450006, 131.94601242523655, 143.16066719219072, 90.07083957083523, 136.52643101662395, 128.87626864761114, 128.0585608286783, 122.91844249679707, 132.74130351468915, 128.89689637720588, 109.18540123838466, 104.08928413689135, 139.10535025410326, 135.45465931668895, 154.59527812898165, 120.5764863695949, 96.16887657460754, 163.65187531709682, 129.6979827713221, 126.76117511838673, 158.30328232049933, 116.25364772975442, 104.28903183713555, 167.75661764852686, 167.89767466671753, 144.85579979419714, 125.60183969885111, 98.6074091643095, 129.6458957642315, 145.50421710312318, -271.0409400239587, 151.35685819014913, 149.8328262614086, 112.04908834234809, 154.78532445803282, 137.7549224793912, 110.27082038484514, 131.81913538463402, 129.44476425647736, 131.11788378655905, 134.71854474116125, 114.00911807268857, 142.80681710131483, 137.62255625100806, 127.90208644419909, 121.13010664656757, 120.84051058441399, 137.7459141719154, 153.5410344004626, 128.61702033504844, 122.23495800793168, 148.10227871686214, 102.5706898346543, 161.9356682132928, 140.60558438301084, 155.68477183347537, 156.7514685858042, 140.0287080425768, 140.31757280230516, 118.1272618882358, 153.0498130843041, 147.46418796479674, 132.18583288788804], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 266, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [30.479935735464096, 30.884380891919136, 31.346643417607993, 44.86346119642258, 45.14721456542611, 45.26118144951761, 32.84450818101564, 33.16341139624515, 33.51629281664887, 43.894718773663044, 43.38479906320572, 43.91689846292138, 41.59620819861689, 41.375747251013905, 41.70244353140393, 50.92021107052763, 50.57590206464131, 50.97163887073596, 49.478349082637564, 48.82055044174193, 48.96079517900942, 42.971289231131465, 42.59084707001844, 42.78333991641799, 52.98249719043572, 53.22124519695838, 52.81115961571534, 47.960907891392694, 47.954077720642076, 48.14111260697244, 42.13245125114918, 41.83329136669636, 42.16263537853956, 37.050167861084134, 37.080014551679284, 37.065400312344224, 43.50735964377721, 43.84331349407633, 43.637165186305836, 37.665509956578404, 37.73381747553745, 37.86615658799806, 57.852402895688996, 57.843347460031495, 58.133821643888936, 40.866254319747284, 40.72882508238156, 41.1870210741957, 42.53050923347473, 42.73432444781065, 42.083647549152374, 28.682023160159588, 29.14301162492484, 29.14989598467946, 39.887555489937455, 40.23464589069286, 40.06660426656404, 40.559492511053875, 40.63384513308604, 40.61816795667012, 43.315671668698386, 42.88393825789292, 43.0115875651439, 42.129950538277626, 42.80467975512147, 42.4749349206686, 47.433202814931676, 47.28085420901577, 47.17675553510587, 39.16920217126608, 39.36676608771086, 39.143797405064106, 44.28314436475435, 44.291683251659066, 44.62755386034647, 40.11201067393024, 39.79044795533021, 39.644424100716904, 44.80058419952789, 45.10807319978872, 44.503218973676354, 41.651482090353966, 42.27250701934099, 42.73364599049091, 43.506021221478775, 43.650039454301194, 43.91855480273564, 39.280591975276664, 39.360430502876014, 39.32777492826183, 40.431184485554695, 40.60494964569807, 40.6906669922173, 39.04436859736839, 39.1903968664507, 39.127935603881866, 43.52244546512762, 44.15470078463355, 44.110781139383704, 43.367189342776925, 43.44816974053779, 43.96745039538169, 41.11768706096336, 40.89625361934304, 40.936439890414476, 42.79841163754463, 43.01582986116409, 43.09006833098829, 38.7766671826442, 39.218396366884306, 38.62476735313733, 48.10393907750647, 48.28322269643347, 48.14061700055997, 43.85124822954336, 43.809274079898984, 44.28549011579403, 47.77194645131628, 47.66950068871181, 47.71922005216281, 30.074119893833995, 29.970092717558146, 30.026626959443092, 45.41888929406801, 45.671257632474095, 45.43628409008184, 42.90363495796919, 43.05131470412016, 42.92131898552179, 42.66913337570925, 42.61207991217573, 42.777347540793315, 40.970056887716055, 40.74938154965639, 41.199004059424624, 43.99394469211498, 44.33226168031493, 44.41509714225927, 42.861886392037064, 42.95089821765819, 43.084111767510564, 36.31809865683317, 36.11141347885132, 36.755889102700166, 34.56696818520625, 34.68911143889029, 34.83320451279481, 46.640747465814144, 46.20830836395422, 46.25629442433515, 45.06498595823844, 45.61351195101936, 44.77616140743096, 51.52942950526874, 51.35518788049619, 51.71066074321668, 40.20416317383447, 40.006700100998074, 40.365623094762356, 31.966829406718404, 31.823557982842118, 32.378489185047016, 54.59169712041815, 54.49939455961187, 54.56078363706668, 43.51001362937191, 43.26566447193423, 42.92230467001596, 42.38577032585938, 42.23144954194625, 42.1439552505811, 52.79685134192307, 52.77275612701972, 52.733674851556614, 39.00847064952055, 38.73066286245981, 38.514514217774064, 34.591622069478035, 34.55331401526928, 35.14409575238824, 55.99466743941109, 55.656808848182365, 56.10514136093359, 55.916561233500644, 55.686814794937774, 56.294298638279244, 48.2099980264902, 48.34393163770436, 48.301870130002484, 41.81712049245834, 41.768062964081764, 42.016656242311, 32.76326309144497, 32.894920997321606, 32.94922507554293, 42.982631782690675, 43.355323570470006, 43.30794041107097, 48.61371742933987, 48.488596402108655, 48.401903271675096, -88.61601368834576, -88.69621810813746, -93.7287082274755, 50.74428443734844, 50.14040633042653, 50.472167422374085, 49.54294679065545, 50.159920946074024, 50.12995852467914, 37.2253665352861, 37.245779077212006, 37.57794272984998, 51.79382242634891, 51.54286591708659, 51.448636114597306, 46.10736473401387, 45.791085836788014, 45.8564719085892, 36.997753566130996, 36.65076096355915, 36.62230585515499, 43.88748014221588, 43.63641222814718, 44.29524301427105, 43.283167742192745, 42.655131071805954, 43.50646544247866, 43.77146972219148, 43.74265184501806, 43.603762219349534, 44.952864706516266, 44.55093985795975, 45.214740176685154, 37.815325667460755, 37.886727934082344, 38.307064471145466, 47.27889261643092, 47.6431461746494, 47.88477831023435, 46.062895435219005, 45.474202906092, 46.08545790969704, 42.7819844558835, 42.69311434030533, 42.426987648010254, 40.05457706501086, 40.42991289620598, 40.64561668535073, 40.203077410658196, 40.687296492358044, 39.95013668139775, 45.795031774789095, 45.966697412543, 45.98418498458341, 51.10698921481769, 51.312154660622284, 51.12189052502315, 42.82406853263576, 42.87506552164753, 42.91788628076513, 40.449124241868645, 40.952865930895, 40.832967835168034, 49.59103127568959, 49.049253255128846, 49.461994186043725, 33.86421577135721, 34.35829733560482, 34.34817672769228, 54.183289417376116, 53.53361300130685, 54.21876579460998, 46.825145545105144, 46.794662053386375, 46.98577678451936, 51.95406912515561, 52.08838267639901, 51.642320031921074, 51.74995615581672, 52.37425421799223, 52.62725821199517, 46.672607090945036, 46.664325868400425, 46.69177508323142, 46.48221472899118, 46.92844189393023, 46.906916179383785, 39.19925632079442, 39.33904992540677, 39.588955642034605, 50.77068457504113, 51.202800815304116, 51.07632769395907, 49.12653300911187, 48.86763341724871, 49.4700215384364, 44.013832854727895, 44.07280297080675, 44.099197062353284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14545621341593448, "mean_inference_ms": 0.7000223294497374, "mean_action_processing_ms": 0.10146348337465282, "mean_env_wait_ms": 0.845872083984402, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 665000, "timesteps_this_iter": 0, "agent_timesteps_total": 1995000, "timers": {"sample_time_ms": 10429.463, "sample_throughput": 479.411, "load_time_ms": 0.102, "load_throughput": 48998878.505, "learn_time_ms": 1590.778, "learn_throughput": 3143.116, "update_time_ms": 7.856}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.846761401677896e-28, "cur_lr": 0.0005000000000000001, "total_loss": 8.90142526626587, "policy_loss": 0.003282592984347588, "vf_loss": 8.980925464630127, "vf_explained_var": -0.00789639949798584, "kl": 0.01307385400871328, "entropy": 8.278285598754882, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 665000, "num_agent_steps_sampled": 1995000, "num_steps_trained": 665000, "num_agent_steps_trained": 1995000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2186, "training_iteration": 133, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-33-05", "timestamp": 1706229185, "time_this_iter_s": 11.425124168395996, "time_total_s": 1426.2251892089844, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020280834820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1426.2251892089844, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 13.8125, "ram_util_percent": 50.01875}}
{"episode_reward_max": 175.6030363440516, "episode_reward_min": -271.0409400239587, "episode_reward_mean": 128.17775913617456, "episode_len_mean": 497.66, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -93.7287082274755}, "policy_reward_max": {"shared_policy": 58.598346804579094}, "policy_reward_mean": {"shared_policy": 42.72591971205819}, "custom_metrics": {}, "hist_stats": {"episode_reward": [126.1283779963851, 111.19558272510764, 130.98783832415933, 113.26548402011392, 173.82957199960933, 122.78210047632454, 127.34848123043776, 86.97493076976389, 120.18880564719436, 121.81150560081004, 129.21119749173522, 127.4095652140677, 141.8908125590535, 117.67976566404104, 133.2023814767599, 119.54688272997736, 134.41187637299288, 126.65763510018587, 131.07461547851562, 117.96879740641451, 121.72680112347007, 117.36270106770095, 131.78792738914484, 130.78280947869638, 122.95038057072088, 128.90430982969707, 116.61983090266584, 144.52777877450006, 131.94601242523655, 143.16066719219072, 90.07083957083523, 136.52643101662395, 128.87626864761114, 128.0585608286783, 122.91844249679707, 132.74130351468915, 128.89689637720588, 109.18540123838466, 104.08928413689135, 139.10535025410326, 135.45465931668895, 154.59527812898165, 120.5764863695949, 96.16887657460754, 163.65187531709682, 129.6979827713221, 126.76117511838673, 158.30328232049933, 116.25364772975442, 104.28903183713555, 167.75661764852686, 167.89767466671753, 144.85579979419714, 125.60183969885111, 98.6074091643095, 129.6458957642315, 145.50421710312318, -271.0409400239587, 151.35685819014913, 149.8328262614086, 112.04908834234809, 154.78532445803282, 137.7549224793912, 110.27082038484514, 131.81913538463402, 129.44476425647736, 131.11788378655905, 134.71854474116125, 114.00911807268857, 142.80681710131483, 137.62255625100806, 127.90208644419909, 121.13010664656757, 120.84051058441399, 137.7459141719154, 153.5410344004626, 128.61702033504844, 122.23495800793168, 148.10227871686214, 102.5706898346543, 161.9356682132928, 140.60558438301084, 155.68477183347537, 156.7514685858042, 140.0287080425768, 140.31757280230516, 118.1272618882358, 153.0498130843041, 147.46418796479674, 132.18583288788804, 163.00748359039423, 175.6030363440516, 132.24410562962282, 102.73906883597374, 146.85551647841916, 135.3157788384706, 157.1437683198603, 128.75456797331574, 137.356368251145, 153.94707639887918], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 266, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [42.13245125114918, 41.83329136669636, 42.16263537853956, 37.050167861084134, 37.080014551679284, 37.065400312344224, 43.50735964377721, 43.84331349407633, 43.637165186305836, 37.665509956578404, 37.73381747553745, 37.86615658799806, 57.852402895688996, 57.843347460031495, 58.133821643888936, 40.866254319747284, 40.72882508238156, 41.1870210741957, 42.53050923347473, 42.73432444781065, 42.083647549152374, 28.682023160159588, 29.14301162492484, 29.14989598467946, 39.887555489937455, 40.23464589069286, 40.06660426656404, 40.559492511053875, 40.63384513308604, 40.61816795667012, 43.315671668698386, 42.88393825789292, 43.0115875651439, 42.129950538277626, 42.80467975512147, 42.4749349206686, 47.433202814931676, 47.28085420901577, 47.17675553510587, 39.16920217126608, 39.36676608771086, 39.143797405064106, 44.28314436475435, 44.291683251659066, 44.62755386034647, 40.11201067393024, 39.79044795533021, 39.644424100716904, 44.80058419952789, 45.10807319978872, 44.503218973676354, 41.651482090353966, 42.27250701934099, 42.73364599049091, 43.506021221478775, 43.650039454301194, 43.91855480273564, 39.280591975276664, 39.360430502876014, 39.32777492826183, 40.431184485554695, 40.60494964569807, 40.6906669922173, 39.04436859736839, 39.1903968664507, 39.127935603881866, 43.52244546512762, 44.15470078463355, 44.110781139383704, 43.367189342776925, 43.44816974053779, 43.96745039538169, 41.11768706096336, 40.89625361934304, 40.936439890414476, 42.79841163754463, 43.01582986116409, 43.09006833098829, 38.7766671826442, 39.218396366884306, 38.62476735313733, 48.10393907750647, 48.28322269643347, 48.14061700055997, 43.85124822954336, 43.809274079898984, 44.28549011579403, 47.77194645131628, 47.66950068871181, 47.71922005216281, 30.074119893833995, 29.970092717558146, 30.026626959443092, 45.41888929406801, 45.671257632474095, 45.43628409008184, 42.90363495796919, 43.05131470412016, 42.92131898552179, 42.66913337570925, 42.61207991217573, 42.777347540793315, 40.970056887716055, 40.74938154965639, 41.199004059424624, 43.99394469211498, 44.33226168031493, 44.41509714225927, 42.861886392037064, 42.95089821765819, 43.084111767510564, 36.31809865683317, 36.11141347885132, 36.755889102700166, 34.56696818520625, 34.68911143889029, 34.83320451279481, 46.640747465814144, 46.20830836395422, 46.25629442433515, 45.06498595823844, 45.61351195101936, 44.77616140743096, 51.52942950526874, 51.35518788049619, 51.71066074321668, 40.20416317383447, 40.006700100998074, 40.365623094762356, 31.966829406718404, 31.823557982842118, 32.378489185047016, 54.59169712041815, 54.49939455961187, 54.56078363706668, 43.51001362937191, 43.26566447193423, 42.92230467001596, 42.38577032585938, 42.23144954194625, 42.1439552505811, 52.79685134192307, 52.77275612701972, 52.733674851556614, 39.00847064952055, 38.73066286245981, 38.514514217774064, 34.591622069478035, 34.55331401526928, 35.14409575238824, 55.99466743941109, 55.656808848182365, 56.10514136093359, 55.916561233500644, 55.686814794937774, 56.294298638279244, 48.2099980264902, 48.34393163770436, 48.301870130002484, 41.81712049245834, 41.768062964081764, 42.016656242311, 32.76326309144497, 32.894920997321606, 32.94922507554293, 42.982631782690675, 43.355323570470006, 43.30794041107097, 48.61371742933987, 48.488596402108655, 48.401903271675096, -88.61601368834576, -88.69621810813746, -93.7287082274755, 50.74428443734844, 50.14040633042653, 50.472167422374085, 49.54294679065545, 50.159920946074024, 50.12995852467914, 37.2253665352861, 37.245779077212006, 37.57794272984998, 51.79382242634891, 51.54286591708659, 51.448636114597306, 46.10736473401387, 45.791085836788014, 45.8564719085892, 36.997753566130996, 36.65076096355915, 36.62230585515499, 43.88748014221588, 43.63641222814718, 44.29524301427105, 43.283167742192745, 42.655131071805954, 43.50646544247866, 43.77146972219148, 43.74265184501806, 43.603762219349534, 44.952864706516266, 44.55093985795975, 45.214740176685154, 37.815325667460755, 37.886727934082344, 38.307064471145466, 47.27889261643092, 47.6431461746494, 47.88477831023435, 46.062895435219005, 45.474202906092, 46.08545790969704, 42.7819844558835, 42.69311434030533, 42.426987648010254, 40.05457706501086, 40.42991289620598, 40.64561668535073, 40.203077410658196, 40.687296492358044, 39.95013668139775, 45.795031774789095, 45.966697412543, 45.98418498458341, 51.10698921481769, 51.312154660622284, 51.12189052502315, 42.82406853263576, 42.87506552164753, 42.91788628076513, 40.449124241868645, 40.952865930895, 40.832967835168034, 49.59103127568959, 49.049253255128846, 49.461994186043725, 33.86421577135721, 34.35829733560482, 34.34817672769228, 54.183289417376116, 53.53361300130685, 54.21876579460998, 46.825145545105144, 46.794662053386375, 46.98577678451936, 51.95406912515561, 52.08838267639901, 51.642320031921074, 51.74995615581672, 52.37425421799223, 52.62725821199517, 46.672607090945036, 46.664325868400425, 46.69177508323142, 46.48221472899118, 46.92844189393023, 46.906916179383785, 39.19925632079442, 39.33904992540677, 39.588955642034605, 50.77068457504113, 51.202800815304116, 51.07632769395907, 49.12653300911187, 48.86763341724871, 49.4700215384364, 44.013832854727895, 44.07280297080675, 44.099197062353284, 54.36160475201903, 54.32611425593494, 54.31976458244024, 58.49553244312604, 58.509157096346215, 58.598346804579094, 44.10887125010291, 43.994315574566514, 44.140918804953486, 34.43576970696449, 33.75082166492939, 34.55247746407986, 49.137966821591064, 48.795022035638496, 48.92252762118976, 45.06728136787811, 44.78432504336038, 45.46417242723206, 52.52382114405434, 52.46686302932601, 52.15308414647977, 42.80619419614473, 42.80634898195663, 43.142024795214326, 45.69735684245825, 45.78128319978714, 45.8777282088995, 51.31445452322562, 51.082063277562455, 51.5505585980912]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14539726748134177, "mean_inference_ms": 0.7000252450747463, "mean_action_processing_ms": 0.10145693067468008, "mean_env_wait_ms": 0.8455440127934731, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 670000, "timesteps_this_iter": 0, "agent_timesteps_total": 2010000, "timers": {"sample_time_ms": 10373.614, "sample_throughput": 481.992, "load_time_ms": 0.102, "load_throughput": 48998878.505, "learn_time_ms": 1601.354, "learn_throughput": 3122.358, "update_time_ms": 7.755}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.846761401677896e-28, "cur_lr": 0.0005000000000000001, "total_loss": 9.444062042236329, "policy_loss": 0.0004193555358339207, "vf_loss": 9.526297664642334, "vf_explained_var": -0.015432870388031006, "kl": 0.005325793591351364, "entropy": 8.265500259399413, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 670000, "num_agent_steps_sampled": 2010000, "num_steps_trained": 670000, "num_agent_steps_trained": 2010000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2196, "training_iteration": 134, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-33-15", "timestamp": 1706229195, "time_this_iter_s": 10.150464296340942, "time_total_s": 1436.3756535053253, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202845CE430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1436.3756535053253, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 12.413333333333334, "ram_util_percent": 50.12}}
{"episode_reward_max": 186.43213457905205, "episode_reward_min": -271.0409400239587, "episode_reward_mean": 130.03727390220502, "episode_len_mean": 497.66, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -93.7287082274755}, "policy_reward_max": {"shared_policy": 62.434312388106875}, "policy_reward_mean": {"shared_policy": 43.34575796740168}, "custom_metrics": {}, "hist_stats": {"episode_reward": [129.21119749173522, 127.4095652140677, 141.8908125590535, 117.67976566404104, 133.2023814767599, 119.54688272997736, 134.41187637299288, 126.65763510018587, 131.07461547851562, 117.96879740641451, 121.72680112347007, 117.36270106770095, 131.78792738914484, 130.78280947869638, 122.95038057072088, 128.90430982969707, 116.61983090266584, 144.52777877450006, 131.94601242523655, 143.16066719219072, 90.07083957083523, 136.52643101662395, 128.87626864761114, 128.0585608286783, 122.91844249679707, 132.74130351468915, 128.89689637720588, 109.18540123838466, 104.08928413689135, 139.10535025410326, 135.45465931668895, 154.59527812898165, 120.5764863695949, 96.16887657460754, 163.65187531709682, 129.6979827713221, 126.76117511838673, 158.30328232049933, 116.25364772975442, 104.28903183713555, 167.75661764852686, 167.89767466671753, 144.85579979419714, 125.60183969885111, 98.6074091643095, 129.6458957642315, 145.50421710312318, -271.0409400239587, 151.35685819014913, 149.8328262614086, 112.04908834234809, 154.78532445803282, 137.7549224793912, 110.27082038484514, 131.81913538463402, 129.44476425647736, 131.11788378655905, 134.71854474116125, 114.00911807268857, 142.80681710131483, 137.62255625100806, 127.90208644419909, 121.13010664656757, 120.84051058441399, 137.7459141719154, 153.5410344004626, 128.61702033504844, 122.23495800793168, 148.10227871686214, 102.5706898346543, 161.9356682132928, 140.60558438301084, 155.68477183347537, 156.7514685858042, 140.0287080425768, 140.31757280230516, 118.1272618882358, 153.0498130843041, 147.46418796479674, 132.18583288788804, 163.00748359039423, 175.6030363440516, 132.24410562962282, 102.73906883597374, 146.85551647841916, 135.3157788384706, 157.1437683198603, 128.75456797331574, 137.356368251145, 153.94707639887918, 143.54428117815385, 126.67682002298534, 151.51519706286476, 132.22980724740773, 134.61968480050575, 140.59594114753423, 138.87369583174586, 186.43213457905205, 121.60968893242534, 144.36690459027872], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 266, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [43.315671668698386, 42.88393825789292, 43.0115875651439, 42.129950538277626, 42.80467975512147, 42.4749349206686, 47.433202814931676, 47.28085420901577, 47.17675553510587, 39.16920217126608, 39.36676608771086, 39.143797405064106, 44.28314436475435, 44.291683251659066, 44.62755386034647, 40.11201067393024, 39.79044795533021, 39.644424100716904, 44.80058419952789, 45.10807319978872, 44.503218973676354, 41.651482090353966, 42.27250701934099, 42.73364599049091, 43.506021221478775, 43.650039454301194, 43.91855480273564, 39.280591975276664, 39.360430502876014, 39.32777492826183, 40.431184485554695, 40.60494964569807, 40.6906669922173, 39.04436859736839, 39.1903968664507, 39.127935603881866, 43.52244546512762, 44.15470078463355, 44.110781139383704, 43.367189342776925, 43.44816974053779, 43.96745039538169, 41.11768706096336, 40.89625361934304, 40.936439890414476, 42.79841163754463, 43.01582986116409, 43.09006833098829, 38.7766671826442, 39.218396366884306, 38.62476735313733, 48.10393907750647, 48.28322269643347, 48.14061700055997, 43.85124822954336, 43.809274079898984, 44.28549011579403, 47.77194645131628, 47.66950068871181, 47.71922005216281, 30.074119893833995, 29.970092717558146, 30.026626959443092, 45.41888929406801, 45.671257632474095, 45.43628409008184, 42.90363495796919, 43.05131470412016, 42.92131898552179, 42.66913337570925, 42.61207991217573, 42.777347540793315, 40.970056887716055, 40.74938154965639, 41.199004059424624, 43.99394469211498, 44.33226168031493, 44.41509714225927, 42.861886392037064, 42.95089821765819, 43.084111767510564, 36.31809865683317, 36.11141347885132, 36.755889102700166, 34.56696818520625, 34.68911143889029, 34.83320451279481, 46.640747465814144, 46.20830836395422, 46.25629442433515, 45.06498595823844, 45.61351195101936, 44.77616140743096, 51.52942950526874, 51.35518788049619, 51.71066074321668, 40.20416317383447, 40.006700100998074, 40.365623094762356, 31.966829406718404, 31.823557982842118, 32.378489185047016, 54.59169712041815, 54.49939455961187, 54.56078363706668, 43.51001362937191, 43.26566447193423, 42.92230467001596, 42.38577032585938, 42.23144954194625, 42.1439552505811, 52.79685134192307, 52.77275612701972, 52.733674851556614, 39.00847064952055, 38.73066286245981, 38.514514217774064, 34.591622069478035, 34.55331401526928, 35.14409575238824, 55.99466743941109, 55.656808848182365, 56.10514136093359, 55.916561233500644, 55.686814794937774, 56.294298638279244, 48.2099980264902, 48.34393163770436, 48.301870130002484, 41.81712049245834, 41.768062964081764, 42.016656242311, 32.76326309144497, 32.894920997321606, 32.94922507554293, 42.982631782690675, 43.355323570470006, 43.30794041107097, 48.61371742933987, 48.488596402108655, 48.401903271675096, -88.61601368834576, -88.69621810813746, -93.7287082274755, 50.74428443734844, 50.14040633042653, 50.472167422374085, 49.54294679065545, 50.159920946074024, 50.12995852467914, 37.2253665352861, 37.245779077212006, 37.57794272984998, 51.79382242634891, 51.54286591708659, 51.448636114597306, 46.10736473401387, 45.791085836788014, 45.8564719085892, 36.997753566130996, 36.65076096355915, 36.62230585515499, 43.88748014221588, 43.63641222814718, 44.29524301427105, 43.283167742192745, 42.655131071805954, 43.50646544247866, 43.77146972219148, 43.74265184501806, 43.603762219349534, 44.952864706516266, 44.55093985795975, 45.214740176685154, 37.815325667460755, 37.886727934082344, 38.307064471145466, 47.27889261643092, 47.6431461746494, 47.88477831023435, 46.062895435219005, 45.474202906092, 46.08545790969704, 42.7819844558835, 42.69311434030533, 42.426987648010254, 40.05457706501086, 40.42991289620598, 40.64561668535073, 40.203077410658196, 40.687296492358044, 39.95013668139775, 45.795031774789095, 45.966697412543, 45.98418498458341, 51.10698921481769, 51.312154660622284, 51.12189052502315, 42.82406853263576, 42.87506552164753, 42.91788628076513, 40.449124241868645, 40.952865930895, 40.832967835168034, 49.59103127568959, 49.049253255128846, 49.461994186043725, 33.86421577135721, 34.35829733560482, 34.34817672769228, 54.183289417376116, 53.53361300130685, 54.21876579460998, 46.825145545105144, 46.794662053386375, 46.98577678451936, 51.95406912515561, 52.08838267639901, 51.642320031921074, 51.74995615581672, 52.37425421799223, 52.62725821199517, 46.672607090945036, 46.664325868400425, 46.69177508323142, 46.48221472899118, 46.92844189393023, 46.906916179383785, 39.19925632079442, 39.33904992540677, 39.588955642034605, 50.77068457504113, 51.202800815304116, 51.07632769395907, 49.12653300911187, 48.86763341724871, 49.4700215384364, 44.013832854727895, 44.07280297080675, 44.099197062353284, 54.36160475201903, 54.32611425593494, 54.31976458244024, 58.49553244312604, 58.509157096346215, 58.598346804579094, 44.10887125010291, 43.994315574566514, 44.140918804953486, 34.43576970696449, 33.75082166492939, 34.55247746407986, 49.137966821591064, 48.795022035638496, 48.92252762118976, 45.06728136787811, 44.78432504336038, 45.46417242723206, 52.52382114405434, 52.46686302932601, 52.15308414647977, 42.80619419614473, 42.80634898195663, 43.142024795214326, 45.69735684245825, 45.78128319978714, 45.8777282088995, 51.31445452322562, 51.082063277562455, 51.5505585980912, 47.426117469867066, 47.86685637881358, 48.25130732947339, 42.08851058036089, 42.35978149808943, 42.22852794453502, 50.54460771630208, 50.45295845965545, 50.517630886907384, 44.36620407768835, 43.874492091437176, 43.98911107828219, 44.938242362191275, 44.81550933917363, 44.86593309914072, 46.57575550675391, 46.814756795763955, 47.20542884501627, 46.12462545682986, 46.167734665175274, 46.58133570974071, 62.434312388106875, 61.632018471757576, 62.36580371918778, 40.88584749621805, 40.479427345097065, 40.24441409111023, 48.032761973639325, 48.17073072617252, 48.163411890467]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14534241324322697, "mean_inference_ms": 0.7000447393977823, "mean_action_processing_ms": 0.10144433883249805, "mean_env_wait_ms": 0.8452636880367005, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 675000, "timesteps_this_iter": 0, "agent_timesteps_total": 2025000, "timers": {"sample_time_ms": 10418.397, "sample_throughput": 479.92, "load_time_ms": 0.1, "load_throughput": 50003624.225, "learn_time_ms": 1617.262, "learn_throughput": 3091.645, "update_time_ms": 7.907}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.846761401677896e-28, "cur_lr": 0.0005000000000000001, "total_loss": 8.573583793640136, "policy_loss": -0.001263611616697169, "vf_loss": 8.658201313018798, "vf_explained_var": -0.007035255432128906, "kl": 0.003910682059382807, "entropy": 8.335367679595947, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 675000, "num_agent_steps_sampled": 2025000, "num_steps_trained": 675000, "num_agent_steps_trained": 2025000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2206, "training_iteration": 135, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-33-25", "timestamp": 1706229205, "time_this_iter_s": 10.169681549072266, "time_total_s": 1446.5453350543976, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824D0AF0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1446.5453350543976, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 10.985714285714286, "ram_util_percent": 49.957142857142856}}
{"episode_reward_max": 186.43213457905205, "episode_reward_min": -271.0409400239587, "episode_reward_mean": 130.8075717381702, "episode_len_mean": 497.66, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -93.7287082274755}, "policy_reward_max": {"shared_policy": 62.434312388106875}, "policy_reward_mean": {"shared_policy": 43.602523912723406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [121.72680112347007, 117.36270106770095, 131.78792738914484, 130.78280947869638, 122.95038057072088, 128.90430982969707, 116.61983090266584, 144.52777877450006, 131.94601242523655, 143.16066719219072, 90.07083957083523, 136.52643101662395, 128.87626864761114, 128.0585608286783, 122.91844249679707, 132.74130351468915, 128.89689637720588, 109.18540123838466, 104.08928413689135, 139.10535025410326, 135.45465931668895, 154.59527812898165, 120.5764863695949, 96.16887657460754, 163.65187531709682, 129.6979827713221, 126.76117511838673, 158.30328232049933, 116.25364772975442, 104.28903183713555, 167.75661764852686, 167.89767466671753, 144.85579979419714, 125.60183969885111, 98.6074091643095, 129.6458957642315, 145.50421710312318, -271.0409400239587, 151.35685819014913, 149.8328262614086, 112.04908834234809, 154.78532445803282, 137.7549224793912, 110.27082038484514, 131.81913538463402, 129.44476425647736, 131.11788378655905, 134.71854474116125, 114.00911807268857, 142.80681710131483, 137.62255625100806, 127.90208644419909, 121.13010664656757, 120.84051058441399, 137.7459141719154, 153.5410344004626, 128.61702033504844, 122.23495800793168, 148.10227871686214, 102.5706898346543, 161.9356682132928, 140.60558438301084, 155.68477183347537, 156.7514685858042, 140.0287080425768, 140.31757280230516, 118.1272618882358, 153.0498130843041, 147.46418796479674, 132.18583288788804, 163.00748359039423, 175.6030363440516, 132.24410562962282, 102.73906883597374, 146.85551647841916, 135.3157788384706, 157.1437683198603, 128.75456797331574, 137.356368251145, 153.94707639887918, 143.54428117815385, 126.67682002298534, 151.51519706286476, 132.22980724740773, 134.61968480050575, 140.59594114753423, 138.87369583174586, 186.43213457905205, 121.60968893242534, 144.36690459027872, 114.64727322757244, 143.2121422626077, 134.77122410945572, 168.43142340332275, 116.83629297791049, 134.07892413437366, 152.0999465547502, 133.69028533995163, 148.90123263746517, 109.4145684428513], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 266, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [40.431184485554695, 40.60494964569807, 40.6906669922173, 39.04436859736839, 39.1903968664507, 39.127935603881866, 43.52244546512762, 44.15470078463355, 44.110781139383704, 43.367189342776925, 43.44816974053779, 43.96745039538169, 41.11768706096336, 40.89625361934304, 40.936439890414476, 42.79841163754463, 43.01582986116409, 43.09006833098829, 38.7766671826442, 39.218396366884306, 38.62476735313733, 48.10393907750647, 48.28322269643347, 48.14061700055997, 43.85124822954336, 43.809274079898984, 44.28549011579403, 47.77194645131628, 47.66950068871181, 47.71922005216281, 30.074119893833995, 29.970092717558146, 30.026626959443092, 45.41888929406801, 45.671257632474095, 45.43628409008184, 42.90363495796919, 43.05131470412016, 42.92131898552179, 42.66913337570925, 42.61207991217573, 42.777347540793315, 40.970056887716055, 40.74938154965639, 41.199004059424624, 43.99394469211498, 44.33226168031493, 44.41509714225927, 42.861886392037064, 42.95089821765819, 43.084111767510564, 36.31809865683317, 36.11141347885132, 36.755889102700166, 34.56696818520625, 34.68911143889029, 34.83320451279481, 46.640747465814144, 46.20830836395422, 46.25629442433515, 45.06498595823844, 45.61351195101936, 44.77616140743096, 51.52942950526874, 51.35518788049619, 51.71066074321668, 40.20416317383447, 40.006700100998074, 40.365623094762356, 31.966829406718404, 31.823557982842118, 32.378489185047016, 54.59169712041815, 54.49939455961187, 54.56078363706668, 43.51001362937191, 43.26566447193423, 42.92230467001596, 42.38577032585938, 42.23144954194625, 42.1439552505811, 52.79685134192307, 52.77275612701972, 52.733674851556614, 39.00847064952055, 38.73066286245981, 38.514514217774064, 34.591622069478035, 34.55331401526928, 35.14409575238824, 55.99466743941109, 55.656808848182365, 56.10514136093359, 55.916561233500644, 55.686814794937774, 56.294298638279244, 48.2099980264902, 48.34393163770436, 48.301870130002484, 41.81712049245834, 41.768062964081764, 42.016656242311, 32.76326309144497, 32.894920997321606, 32.94922507554293, 42.982631782690675, 43.355323570470006, 43.30794041107097, 48.61371742933987, 48.488596402108655, 48.401903271675096, -88.61601368834576, -88.69621810813746, -93.7287082274755, 50.74428443734844, 50.14040633042653, 50.472167422374085, 49.54294679065545, 50.159920946074024, 50.12995852467914, 37.2253665352861, 37.245779077212006, 37.57794272984998, 51.79382242634891, 51.54286591708659, 51.448636114597306, 46.10736473401387, 45.791085836788014, 45.8564719085892, 36.997753566130996, 36.65076096355915, 36.62230585515499, 43.88748014221588, 43.63641222814718, 44.29524301427105, 43.283167742192745, 42.655131071805954, 43.50646544247866, 43.77146972219148, 43.74265184501806, 43.603762219349534, 44.952864706516266, 44.55093985795975, 45.214740176685154, 37.815325667460755, 37.886727934082344, 38.307064471145466, 47.27889261643092, 47.6431461746494, 47.88477831023435, 46.062895435219005, 45.474202906092, 46.08545790969704, 42.7819844558835, 42.69311434030533, 42.426987648010254, 40.05457706501086, 40.42991289620598, 40.64561668535073, 40.203077410658196, 40.687296492358044, 39.95013668139775, 45.795031774789095, 45.966697412543, 45.98418498458341, 51.10698921481769, 51.312154660622284, 51.12189052502315, 42.82406853263576, 42.87506552164753, 42.91788628076513, 40.449124241868645, 40.952865930895, 40.832967835168034, 49.59103127568959, 49.049253255128846, 49.461994186043725, 33.86421577135721, 34.35829733560482, 34.34817672769228, 54.183289417376116, 53.53361300130685, 54.21876579460998, 46.825145545105144, 46.794662053386375, 46.98577678451936, 51.95406912515561, 52.08838267639901, 51.642320031921074, 51.74995615581672, 52.37425421799223, 52.62725821199517, 46.672607090945036, 46.664325868400425, 46.69177508323142, 46.48221472899118, 46.92844189393023, 46.906916179383785, 39.19925632079442, 39.33904992540677, 39.588955642034605, 50.77068457504113, 51.202800815304116, 51.07632769395907, 49.12653300911187, 48.86763341724871, 49.4700215384364, 44.013832854727895, 44.07280297080675, 44.099197062353284, 54.36160475201903, 54.32611425593494, 54.31976458244024, 58.49553244312604, 58.509157096346215, 58.598346804579094, 44.10887125010291, 43.994315574566514, 44.140918804953486, 34.43576970696449, 33.75082166492939, 34.55247746407986, 49.137966821591064, 48.795022035638496, 48.92252762118976, 45.06728136787811, 44.78432504336038, 45.46417242723206, 52.52382114405434, 52.46686302932601, 52.15308414647977, 42.80619419614473, 42.80634898195663, 43.142024795214326, 45.69735684245825, 45.78128319978714, 45.8777282088995, 51.31445452322562, 51.082063277562455, 51.5505585980912, 47.426117469867066, 47.86685637881358, 48.25130732947339, 42.08851058036089, 42.35978149808943, 42.22852794453502, 50.54460771630208, 50.45295845965545, 50.517630886907384, 44.36620407768835, 43.874492091437176, 43.98911107828219, 44.938242362191275, 44.81550933917363, 44.86593309914072, 46.57575550675391, 46.814756795763955, 47.20542884501627, 46.12462545682986, 46.167734665175274, 46.58133570974071, 62.434312388106875, 61.632018471757576, 62.36580371918778, 40.88584749621805, 40.479427345097065, 40.24441409111023, 48.032761973639325, 48.17073072617252, 48.163411890467, 38.13637422770262, 38.58439268916845, 37.92650631070137, 47.364173839489624, 47.89316003272931, 47.95480839038889, 44.746978806952626, 45.22601339283088, 44.79823190967241, 56.27039311577876, 56.11205270638068, 56.04897758116324, 38.80494204163551, 38.751846224069595, 39.27950471220538, 44.824269178013, 44.850416394571454, 44.404238561789185, 50.655308000743375, 50.894599396735416, 50.55003915727137, 44.71815474083026, 44.436328818400696, 44.53580178072055, 49.348284890254334, 49.8839958657821, 49.668951881428555, 36.61595359817147, 36.41477359831333, 36.3838412463665]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1452986552535788, "mean_inference_ms": 0.700072134531541, "mean_action_processing_ms": 0.10143343280759519, "mean_env_wait_ms": 0.8449978590241064, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 680000, "timesteps_this_iter": 0, "agent_timesteps_total": 2040000, "timers": {"sample_time_ms": 10454.864, "sample_throughput": 478.246, "load_time_ms": 0.1, "load_throughput": 50003624.225, "learn_time_ms": 1643.353, "learn_throughput": 3042.56, "update_time_ms": 7.967}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.423380700838948e-28, "cur_lr": 0.0005000000000000001, "total_loss": 7.534549808502197, "policy_loss": 0.003934596051077044, "vf_loss": 7.613893270492554, "vf_explained_var": -0.010185182094573975, "kl": 0.014574557309995365, "entropy": 8.327803802490234, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 680000, "num_agent_steps_sampled": 2040000, "num_steps_trained": 680000, "num_agent_steps_trained": 2040000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2216, "training_iteration": 136, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-33-36", "timestamp": 1706229216, "time_this_iter_s": 10.467445611953735, "time_total_s": 1457.0127806663513, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824BA790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1457.0127806663513, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 9.773333333333333, "ram_util_percent": 50.02}}
{"episode_reward_max": 186.43213457905205, "episode_reward_min": -271.0409400239587, "episode_reward_mean": 131.23869284251353, "episode_len_mean": 497.66, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -93.7287082274755}, "policy_reward_max": {"shared_policy": 62.434312388106875}, "policy_reward_mean": {"shared_policy": 43.74623094750452}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.07083957083523, 136.52643101662395, 128.87626864761114, 128.0585608286783, 122.91844249679707, 132.74130351468915, 128.89689637720588, 109.18540123838466, 104.08928413689135, 139.10535025410326, 135.45465931668895, 154.59527812898165, 120.5764863695949, 96.16887657460754, 163.65187531709682, 129.6979827713221, 126.76117511838673, 158.30328232049933, 116.25364772975442, 104.28903183713555, 167.75661764852686, 167.89767466671753, 144.85579979419714, 125.60183969885111, 98.6074091643095, 129.6458957642315, 145.50421710312318, -271.0409400239587, 151.35685819014913, 149.8328262614086, 112.04908834234809, 154.78532445803282, 137.7549224793912, 110.27082038484514, 131.81913538463402, 129.44476425647736, 131.11788378655905, 134.71854474116125, 114.00911807268857, 142.80681710131483, 137.62255625100806, 127.90208644419909, 121.13010664656757, 120.84051058441399, 137.7459141719154, 153.5410344004626, 128.61702033504844, 122.23495800793168, 148.10227871686214, 102.5706898346543, 161.9356682132928, 140.60558438301084, 155.68477183347537, 156.7514685858042, 140.0287080425768, 140.31757280230516, 118.1272618882358, 153.0498130843041, 147.46418796479674, 132.18583288788804, 163.00748359039423, 175.6030363440516, 132.24410562962282, 102.73906883597374, 146.85551647841916, 135.3157788384706, 157.1437683198603, 128.75456797331574, 137.356368251145, 153.94707639887918, 143.54428117815385, 126.67682002298534, 151.51519706286476, 132.22980724740773, 134.61968480050575, 140.59594114753423, 138.87369583174586, 186.43213457905205, 121.60968893242534, 144.36690459027872, 114.64727322757244, 143.2121422626077, 134.77122410945572, 168.43142340332275, 116.83629297791049, 134.07892413437366, 152.0999465547502, 133.69028533995163, 148.90123263746517, 109.4145684428513, 131.1695353649555, 144.49010072275993, 121.57590840384361, 142.23299851268519, 142.1129876542837, 132.27335551939905, 154.388396619819, 118.36822646856305, 133.9272874705494, 112.34253245149736], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 266, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [30.074119893833995, 29.970092717558146, 30.026626959443092, 45.41888929406801, 45.671257632474095, 45.43628409008184, 42.90363495796919, 43.05131470412016, 42.92131898552179, 42.66913337570925, 42.61207991217573, 42.777347540793315, 40.970056887716055, 40.74938154965639, 41.199004059424624, 43.99394469211498, 44.33226168031493, 44.41509714225927, 42.861886392037064, 42.95089821765819, 43.084111767510564, 36.31809865683317, 36.11141347885132, 36.755889102700166, 34.56696818520625, 34.68911143889029, 34.83320451279481, 46.640747465814144, 46.20830836395422, 46.25629442433515, 45.06498595823844, 45.61351195101936, 44.77616140743096, 51.52942950526874, 51.35518788049619, 51.71066074321668, 40.20416317383447, 40.006700100998074, 40.365623094762356, 31.966829406718404, 31.823557982842118, 32.378489185047016, 54.59169712041815, 54.49939455961187, 54.56078363706668, 43.51001362937191, 43.26566447193423, 42.92230467001596, 42.38577032585938, 42.23144954194625, 42.1439552505811, 52.79685134192307, 52.77275612701972, 52.733674851556614, 39.00847064952055, 38.73066286245981, 38.514514217774064, 34.591622069478035, 34.55331401526928, 35.14409575238824, 55.99466743941109, 55.656808848182365, 56.10514136093359, 55.916561233500644, 55.686814794937774, 56.294298638279244, 48.2099980264902, 48.34393163770436, 48.301870130002484, 41.81712049245834, 41.768062964081764, 42.016656242311, 32.76326309144497, 32.894920997321606, 32.94922507554293, 42.982631782690675, 43.355323570470006, 43.30794041107097, 48.61371742933987, 48.488596402108655, 48.401903271675096, -88.61601368834576, -88.69621810813746, -93.7287082274755, 50.74428443734844, 50.14040633042653, 50.472167422374085, 49.54294679065545, 50.159920946074024, 50.12995852467914, 37.2253665352861, 37.245779077212006, 37.57794272984998, 51.79382242634891, 51.54286591708659, 51.448636114597306, 46.10736473401387, 45.791085836788014, 45.8564719085892, 36.997753566130996, 36.65076096355915, 36.62230585515499, 43.88748014221588, 43.63641222814718, 44.29524301427105, 43.283167742192745, 42.655131071805954, 43.50646544247866, 43.77146972219148, 43.74265184501806, 43.603762219349534, 44.952864706516266, 44.55093985795975, 45.214740176685154, 37.815325667460755, 37.886727934082344, 38.307064471145466, 47.27889261643092, 47.6431461746494, 47.88477831023435, 46.062895435219005, 45.474202906092, 46.08545790969704, 42.7819844558835, 42.69311434030533, 42.426987648010254, 40.05457706501086, 40.42991289620598, 40.64561668535073, 40.203077410658196, 40.687296492358044, 39.95013668139775, 45.795031774789095, 45.966697412543, 45.98418498458341, 51.10698921481769, 51.312154660622284, 51.12189052502315, 42.82406853263576, 42.87506552164753, 42.91788628076513, 40.449124241868645, 40.952865930895, 40.832967835168034, 49.59103127568959, 49.049253255128846, 49.461994186043725, 33.86421577135721, 34.35829733560482, 34.34817672769228, 54.183289417376116, 53.53361300130685, 54.21876579460998, 46.825145545105144, 46.794662053386375, 46.98577678451936, 51.95406912515561, 52.08838267639901, 51.642320031921074, 51.74995615581672, 52.37425421799223, 52.62725821199517, 46.672607090945036, 46.664325868400425, 46.69177508323142, 46.48221472899118, 46.92844189393023, 46.906916179383785, 39.19925632079442, 39.33904992540677, 39.588955642034605, 50.77068457504113, 51.202800815304116, 51.07632769395907, 49.12653300911187, 48.86763341724871, 49.4700215384364, 44.013832854727895, 44.07280297080675, 44.099197062353284, 54.36160475201903, 54.32611425593494, 54.31976458244024, 58.49553244312604, 58.509157096346215, 58.598346804579094, 44.10887125010291, 43.994315574566514, 44.140918804953486, 34.43576970696449, 33.75082166492939, 34.55247746407986, 49.137966821591064, 48.795022035638496, 48.92252762118976, 45.06728136787811, 44.78432504336038, 45.46417242723206, 52.52382114405434, 52.46686302932601, 52.15308414647977, 42.80619419614473, 42.80634898195663, 43.142024795214326, 45.69735684245825, 45.78128319978714, 45.8777282088995, 51.31445452322562, 51.082063277562455, 51.5505585980912, 47.426117469867066, 47.86685637881358, 48.25130732947339, 42.08851058036089, 42.35978149808943, 42.22852794453502, 50.54460771630208, 50.45295845965545, 50.517630886907384, 44.36620407768835, 43.874492091437176, 43.98911107828219, 44.938242362191275, 44.81550933917363, 44.86593309914072, 46.57575550675391, 46.814756795763955, 47.20542884501627, 46.12462545682986, 46.167734665175274, 46.58133570974071, 62.434312388106875, 61.632018471757576, 62.36580371918778, 40.88584749621805, 40.479427345097065, 40.24441409111023, 48.032761973639325, 48.17073072617252, 48.163411890467, 38.13637422770262, 38.58439268916845, 37.92650631070137, 47.364173839489624, 47.89316003272931, 47.95480839038889, 44.746978806952626, 45.22601339283088, 44.79823190967241, 56.27039311577876, 56.11205270638068, 56.04897758116324, 38.80494204163551, 38.751846224069595, 39.27950471220538, 44.824269178013, 44.850416394571454, 44.404238561789185, 50.655308000743375, 50.894599396735416, 50.55003915727137, 44.71815474083026, 44.436328818400696, 44.53580178072055, 49.348284890254334, 49.8839958657821, 49.668951881428555, 36.61595359817147, 36.41477359831333, 36.3838412463665, 43.71285019318262, 44.13924384738007, 43.317441324392945, 48.4456364872555, 48.28824522594611, 47.756219009558365, 40.91928308332959, 40.66561080018678, 39.99101452032724, 47.10684727132319, 47.55172225832938, 47.57442898303269, 47.17028537392615, 47.24485037475823, 47.69785190559922, 44.12607066084941, 44.32846336377163, 43.81882149477799, 51.72022993707408, 51.05877504249413, 51.60939164025088, 39.40349944929281, 40.01700141529241, 38.94772560397783, 44.67917489260435, 44.24793376028538, 45.00017881765962, 37.0356663117806, 37.62000099165985, 37.68686514805691]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14529145093182658, "mean_inference_ms": 0.7002448289623229, "mean_action_processing_ms": 0.10143879601008297, "mean_env_wait_ms": 0.8448535112869853, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 685000, "timesteps_this_iter": 0, "agent_timesteps_total": 2055000, "timers": {"sample_time_ms": 10691.845, "sample_throughput": 467.646, "load_time_ms": 0.1, "load_throughput": 50003624.225, "learn_time_ms": 1663.326, "learn_throughput": 3006.026, "update_time_ms": 8.024}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.423380700838948e-28, "cur_lr": 0.0005000000000000001, "total_loss": 7.370142602920533, "policy_loss": -0.0007345136415453979, "vf_loss": 7.454893159866333, "vf_explained_var": -0.005512082576751709, "kl": 0.002918232604886139, "entropy": 8.401605796813964, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 685000, "num_agent_steps_sampled": 2055000, "num_steps_trained": 685000, "num_agent_steps_trained": 2055000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2226, "training_iteration": 137, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-33-48", "timestamp": 1706229228, "time_this_iter_s": 11.890864610671997, "time_total_s": 1468.9036452770233, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282492EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1468.9036452770233, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 9.911764705882355, "ram_util_percent": 50.15882352941178}}
{"episode_reward_max": 186.43213457905205, "episode_reward_min": -271.0409400239587, "episode_reward_mean": 132.64900782963258, "episode_len_mean": 497.66, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -93.7287082274755}, "policy_reward_max": {"shared_policy": 62.434312388106875}, "policy_reward_mean": {"shared_policy": 44.21633594321087}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.45465931668895, 154.59527812898165, 120.5764863695949, 96.16887657460754, 163.65187531709682, 129.6979827713221, 126.76117511838673, 158.30328232049933, 116.25364772975442, 104.28903183713555, 167.75661764852686, 167.89767466671753, 144.85579979419714, 125.60183969885111, 98.6074091643095, 129.6458957642315, 145.50421710312318, -271.0409400239587, 151.35685819014913, 149.8328262614086, 112.04908834234809, 154.78532445803282, 137.7549224793912, 110.27082038484514, 131.81913538463402, 129.44476425647736, 131.11788378655905, 134.71854474116125, 114.00911807268857, 142.80681710131483, 137.62255625100806, 127.90208644419909, 121.13010664656757, 120.84051058441399, 137.7459141719154, 153.5410344004626, 128.61702033504844, 122.23495800793168, 148.10227871686214, 102.5706898346543, 161.9356682132928, 140.60558438301084, 155.68477183347537, 156.7514685858042, 140.0287080425768, 140.31757280230516, 118.1272618882358, 153.0498130843041, 147.46418796479674, 132.18583288788804, 163.00748359039423, 175.6030363440516, 132.24410562962282, 102.73906883597374, 146.85551647841916, 135.3157788384706, 157.1437683198603, 128.75456797331574, 137.356368251145, 153.94707639887918, 143.54428117815385, 126.67682002298534, 151.51519706286476, 132.22980724740773, 134.61968480050575, 140.59594114753423, 138.87369583174586, 186.43213457905205, 121.60968893242534, 144.36690459027872, 114.64727322757244, 143.2121422626077, 134.77122410945572, 168.43142340332275, 116.83629297791049, 134.07892413437366, 152.0999465547502, 133.69028533995163, 148.90123263746517, 109.4145684428513, 131.1695353649555, 144.49010072275993, 121.57590840384361, 142.23299851268519, 142.1129876542837, 132.27335551939905, 154.388396619819, 118.36822646856305, 133.9272874705494, 112.34253245149736, 136.71871903538715, 139.72509447857726, 133.5783370379359, 135.80723135918373, 134.61743038520225, 110.5748792318627, 148.43431965634238, 162.00468191877013, 132.78854495286947, 127.25103873759508], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 266, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [45.06498595823844, 45.61351195101936, 44.77616140743096, 51.52942950526874, 51.35518788049619, 51.71066074321668, 40.20416317383447, 40.006700100998074, 40.365623094762356, 31.966829406718404, 31.823557982842118, 32.378489185047016, 54.59169712041815, 54.49939455961187, 54.56078363706668, 43.51001362937191, 43.26566447193423, 42.92230467001596, 42.38577032585938, 42.23144954194625, 42.1439552505811, 52.79685134192307, 52.77275612701972, 52.733674851556614, 39.00847064952055, 38.73066286245981, 38.514514217774064, 34.591622069478035, 34.55331401526928, 35.14409575238824, 55.99466743941109, 55.656808848182365, 56.10514136093359, 55.916561233500644, 55.686814794937774, 56.294298638279244, 48.2099980264902, 48.34393163770436, 48.301870130002484, 41.81712049245834, 41.768062964081764, 42.016656242311, 32.76326309144497, 32.894920997321606, 32.94922507554293, 42.982631782690675, 43.355323570470006, 43.30794041107097, 48.61371742933987, 48.488596402108655, 48.401903271675096, -88.61601368834576, -88.69621810813746, -93.7287082274755, 50.74428443734844, 50.14040633042653, 50.472167422374085, 49.54294679065545, 50.159920946074024, 50.12995852467914, 37.2253665352861, 37.245779077212006, 37.57794272984998, 51.79382242634891, 51.54286591708659, 51.448636114597306, 46.10736473401387, 45.791085836788014, 45.8564719085892, 36.997753566130996, 36.65076096355915, 36.62230585515499, 43.88748014221588, 43.63641222814718, 44.29524301427105, 43.283167742192745, 42.655131071805954, 43.50646544247866, 43.77146972219148, 43.74265184501806, 43.603762219349534, 44.952864706516266, 44.55093985795975, 45.214740176685154, 37.815325667460755, 37.886727934082344, 38.307064471145466, 47.27889261643092, 47.6431461746494, 47.88477831023435, 46.062895435219005, 45.474202906092, 46.08545790969704, 42.7819844558835, 42.69311434030533, 42.426987648010254, 40.05457706501086, 40.42991289620598, 40.64561668535073, 40.203077410658196, 40.687296492358044, 39.95013668139775, 45.795031774789095, 45.966697412543, 45.98418498458341, 51.10698921481769, 51.312154660622284, 51.12189052502315, 42.82406853263576, 42.87506552164753, 42.91788628076513, 40.449124241868645, 40.952865930895, 40.832967835168034, 49.59103127568959, 49.049253255128846, 49.461994186043725, 33.86421577135721, 34.35829733560482, 34.34817672769228, 54.183289417376116, 53.53361300130685, 54.21876579460998, 46.825145545105144, 46.794662053386375, 46.98577678451936, 51.95406912515561, 52.08838267639901, 51.642320031921074, 51.74995615581672, 52.37425421799223, 52.62725821199517, 46.672607090945036, 46.664325868400425, 46.69177508323142, 46.48221472899118, 46.92844189393023, 46.906916179383785, 39.19925632079442, 39.33904992540677, 39.588955642034605, 50.77068457504113, 51.202800815304116, 51.07632769395907, 49.12653300911187, 48.86763341724871, 49.4700215384364, 44.013832854727895, 44.07280297080675, 44.099197062353284, 54.36160475201903, 54.32611425593494, 54.31976458244024, 58.49553244312604, 58.509157096346215, 58.598346804579094, 44.10887125010291, 43.994315574566514, 44.140918804953486, 34.43576970696449, 33.75082166492939, 34.55247746407986, 49.137966821591064, 48.795022035638496, 48.92252762118976, 45.06728136787811, 44.78432504336038, 45.46417242723206, 52.52382114405434, 52.46686302932601, 52.15308414647977, 42.80619419614473, 42.80634898195663, 43.142024795214326, 45.69735684245825, 45.78128319978714, 45.8777282088995, 51.31445452322562, 51.082063277562455, 51.5505585980912, 47.426117469867066, 47.86685637881358, 48.25130732947339, 42.08851058036089, 42.35978149808943, 42.22852794453502, 50.54460771630208, 50.45295845965545, 50.517630886907384, 44.36620407768835, 43.874492091437176, 43.98911107828219, 44.938242362191275, 44.81550933917363, 44.86593309914072, 46.57575550675391, 46.814756795763955, 47.20542884501627, 46.12462545682986, 46.167734665175274, 46.58133570974071, 62.434312388106875, 61.632018471757576, 62.36580371918778, 40.88584749621805, 40.479427345097065, 40.24441409111023, 48.032761973639325, 48.17073072617252, 48.163411890467, 38.13637422770262, 38.58439268916845, 37.92650631070137, 47.364173839489624, 47.89316003272931, 47.95480839038889, 44.746978806952626, 45.22601339283088, 44.79823190967241, 56.27039311577876, 56.11205270638068, 56.04897758116324, 38.80494204163551, 38.751846224069595, 39.27950471220538, 44.824269178013, 44.850416394571454, 44.404238561789185, 50.655308000743375, 50.894599396735416, 50.55003915727137, 44.71815474083026, 44.436328818400696, 44.53580178072055, 49.348284890254334, 49.8839958657821, 49.668951881428555, 36.61595359817147, 36.41477359831333, 36.3838412463665, 43.71285019318262, 44.13924384738007, 43.317441324392945, 48.4456364872555, 48.28824522594611, 47.756219009558365, 40.91928308332959, 40.66561080018678, 39.99101452032724, 47.10684727132319, 47.55172225832938, 47.57442898303269, 47.17028537392615, 47.24485037475823, 47.69785190559922, 44.12607066084941, 44.32846336377163, 43.81882149477799, 51.72022993707408, 51.05877504249413, 51.60939164025088, 39.40349944929281, 40.01700141529241, 38.94772560397783, 44.67917489260435, 44.24793376028538, 45.00017881765962, 37.0356663117806, 37.62000099165985, 37.68686514805691, 45.2772834499677, 45.73370149110754, 45.70773409431179, 46.59106447796026, 46.653273491809756, 46.48075650880733, 44.17932781328757, 44.65895430122812, 44.740054923420146, 45.76600206146637, 45.257982472578675, 44.78324682513872, 44.93411903704205, 44.885577293733746, 44.79773405442634, 37.027180070678384, 37.12905658564219, 36.41864257554212, 49.222302074233696, 49.51319777468841, 49.69881980742018, 53.8964541008075, 53.979886186619595, 54.12834163134296, 44.378354767958314, 44.09376359979311, 44.316426585117966, 42.460985258221626, 42.44971890002489, 42.340334579348564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14528557852924184, "mean_inference_ms": 0.700389694384068, "mean_action_processing_ms": 0.10144712689100997, "mean_env_wait_ms": 0.8447011245704661, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 690000, "timesteps_this_iter": 0, "agent_timesteps_total": 2070000, "timers": {"sample_time_ms": 10692.657, "sample_throughput": 467.611, "load_time_ms": 0.1, "load_throughput": 50003624.225, "learn_time_ms": 1653.73, "learn_throughput": 3023.468, "update_time_ms": 8.055}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.211690350419474e-28, "cur_lr": 0.0005000000000000001, "total_loss": 6.769206380844116, "policy_loss": -0.0007899331667736043, "vf_loss": 6.853611135482788, "vf_explained_var": -0.01007516384124756, "kl": 0.005616349820072334, "entropy": 8.361480712890625, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 690000, "num_agent_steps_sampled": 2070000, "num_steps_trained": 690000, "num_agent_steps_trained": 2070000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2236, "training_iteration": 138, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-33-59", "timestamp": 1706229239, "time_this_iter_s": 10.660851240158081, "time_total_s": 1479.5644965171814, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282490F70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1479.5644965171814, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 9.46, "ram_util_percent": 50.153333333333336}}
{"episode_reward_max": 186.43213457905205, "episode_reward_min": -271.0409400239587, "episode_reward_mean": 133.2114463503449, "episode_len_mean": 497.66, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -93.7287082274755}, "policy_reward_max": {"shared_policy": 62.434312388106875}, "policy_reward_mean": {"shared_policy": 44.40381545011496}, "custom_metrics": {}, "hist_stats": {"episode_reward": [167.75661764852686, 167.89767466671753, 144.85579979419714, 125.60183969885111, 98.6074091643095, 129.6458957642315, 145.50421710312318, -271.0409400239587, 151.35685819014913, 149.8328262614086, 112.04908834234809, 154.78532445803282, 137.7549224793912, 110.27082038484514, 131.81913538463402, 129.44476425647736, 131.11788378655905, 134.71854474116125, 114.00911807268857, 142.80681710131483, 137.62255625100806, 127.90208644419909, 121.13010664656757, 120.84051058441399, 137.7459141719154, 153.5410344004626, 128.61702033504844, 122.23495800793168, 148.10227871686214, 102.5706898346543, 161.9356682132928, 140.60558438301084, 155.68477183347537, 156.7514685858042, 140.0287080425768, 140.31757280230516, 118.1272618882358, 153.0498130843041, 147.46418796479674, 132.18583288788804, 163.00748359039423, 175.6030363440516, 132.24410562962282, 102.73906883597374, 146.85551647841916, 135.3157788384706, 157.1437683198603, 128.75456797331574, 137.356368251145, 153.94707639887918, 143.54428117815385, 126.67682002298534, 151.51519706286476, 132.22980724740773, 134.61968480050575, 140.59594114753423, 138.87369583174586, 186.43213457905205, 121.60968893242534, 144.36690459027872, 114.64727322757244, 143.2121422626077, 134.77122410945572, 168.43142340332275, 116.83629297791049, 134.07892413437366, 152.0999465547502, 133.69028533995163, 148.90123263746517, 109.4145684428513, 131.1695353649555, 144.49010072275993, 121.57590840384361, 142.23299851268519, 142.1129876542837, 132.27335551939905, 154.388396619819, 118.36822646856305, 133.9272874705494, 112.34253245149736, 136.71871903538715, 139.72509447857726, 133.5783370379359, 135.80723135918373, 134.61743038520225, 110.5748792318627, 148.43431965634238, 162.00468191877013, 132.78854495286947, 127.25103873759508, 127.05917110294102, 155.69575847685326, 116.47335912100971, 151.5658366382123, 126.57313235104083, 132.66780219692737, 155.34198004007314, 145.48703280091286, 130.14545645937324, 120.98661836795506], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 266, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [55.99466743941109, 55.656808848182365, 56.10514136093359, 55.916561233500644, 55.686814794937774, 56.294298638279244, 48.2099980264902, 48.34393163770436, 48.301870130002484, 41.81712049245834, 41.768062964081764, 42.016656242311, 32.76326309144497, 32.894920997321606, 32.94922507554293, 42.982631782690675, 43.355323570470006, 43.30794041107097, 48.61371742933987, 48.488596402108655, 48.401903271675096, -88.61601368834576, -88.69621810813746, -93.7287082274755, 50.74428443734844, 50.14040633042653, 50.472167422374085, 49.54294679065545, 50.159920946074024, 50.12995852467914, 37.2253665352861, 37.245779077212006, 37.57794272984998, 51.79382242634891, 51.54286591708659, 51.448636114597306, 46.10736473401387, 45.791085836788014, 45.8564719085892, 36.997753566130996, 36.65076096355915, 36.62230585515499, 43.88748014221588, 43.63641222814718, 44.29524301427105, 43.283167742192745, 42.655131071805954, 43.50646544247866, 43.77146972219148, 43.74265184501806, 43.603762219349534, 44.952864706516266, 44.55093985795975, 45.214740176685154, 37.815325667460755, 37.886727934082344, 38.307064471145466, 47.27889261643092, 47.6431461746494, 47.88477831023435, 46.062895435219005, 45.474202906092, 46.08545790969704, 42.7819844558835, 42.69311434030533, 42.426987648010254, 40.05457706501086, 40.42991289620598, 40.64561668535073, 40.203077410658196, 40.687296492358044, 39.95013668139775, 45.795031774789095, 45.966697412543, 45.98418498458341, 51.10698921481769, 51.312154660622284, 51.12189052502315, 42.82406853263576, 42.87506552164753, 42.91788628076513, 40.449124241868645, 40.952865930895, 40.832967835168034, 49.59103127568959, 49.049253255128846, 49.461994186043725, 33.86421577135721, 34.35829733560482, 34.34817672769228, 54.183289417376116, 53.53361300130685, 54.21876579460998, 46.825145545105144, 46.794662053386375, 46.98577678451936, 51.95406912515561, 52.08838267639901, 51.642320031921074, 51.74995615581672, 52.37425421799223, 52.62725821199517, 46.672607090945036, 46.664325868400425, 46.69177508323142, 46.48221472899118, 46.92844189393023, 46.906916179383785, 39.19925632079442, 39.33904992540677, 39.588955642034605, 50.77068457504113, 51.202800815304116, 51.07632769395907, 49.12653300911187, 48.86763341724871, 49.4700215384364, 44.013832854727895, 44.07280297080675, 44.099197062353284, 54.36160475201903, 54.32611425593494, 54.31976458244024, 58.49553244312604, 58.509157096346215, 58.598346804579094, 44.10887125010291, 43.994315574566514, 44.140918804953486, 34.43576970696449, 33.75082166492939, 34.55247746407986, 49.137966821591064, 48.795022035638496, 48.92252762118976, 45.06728136787811, 44.78432504336038, 45.46417242723206, 52.52382114405434, 52.46686302932601, 52.15308414647977, 42.80619419614473, 42.80634898195663, 43.142024795214326, 45.69735684245825, 45.78128319978714, 45.8777282088995, 51.31445452322562, 51.082063277562455, 51.5505585980912, 47.426117469867066, 47.86685637881358, 48.25130732947339, 42.08851058036089, 42.35978149808943, 42.22852794453502, 50.54460771630208, 50.45295845965545, 50.517630886907384, 44.36620407768835, 43.874492091437176, 43.98911107828219, 44.938242362191275, 44.81550933917363, 44.86593309914072, 46.57575550675391, 46.814756795763955, 47.20542884501627, 46.12462545682986, 46.167734665175274, 46.58133570974071, 62.434312388106875, 61.632018471757576, 62.36580371918778, 40.88584749621805, 40.479427345097065, 40.24441409111023, 48.032761973639325, 48.17073072617252, 48.163411890467, 38.13637422770262, 38.58439268916845, 37.92650631070137, 47.364173839489624, 47.89316003272931, 47.95480839038889, 44.746978806952626, 45.22601339283088, 44.79823190967241, 56.27039311577876, 56.11205270638068, 56.04897758116324, 38.80494204163551, 38.751846224069595, 39.27950471220538, 44.824269178013, 44.850416394571454, 44.404238561789185, 50.655308000743375, 50.894599396735416, 50.55003915727137, 44.71815474083026, 44.436328818400696, 44.53580178072055, 49.348284890254334, 49.8839958657821, 49.668951881428555, 36.61595359817147, 36.41477359831333, 36.3838412463665, 43.71285019318262, 44.13924384738007, 43.317441324392945, 48.4456364872555, 48.28824522594611, 47.756219009558365, 40.91928308332959, 40.66561080018678, 39.99101452032724, 47.10684727132319, 47.55172225832938, 47.57442898303269, 47.17028537392615, 47.24485037475823, 47.69785190559922, 44.12607066084941, 44.32846336377163, 43.81882149477799, 51.72022993707408, 51.05877504249413, 51.60939164025088, 39.40349944929281, 40.01700141529241, 38.94772560397783, 44.67917489260435, 44.24793376028538, 45.00017881765962, 37.0356663117806, 37.62000099165985, 37.68686514805691, 45.2772834499677, 45.73370149110754, 45.70773409431179, 46.59106447796026, 46.653273491809756, 46.48075650880733, 44.17932781328757, 44.65895430122812, 44.740054923420146, 45.76600206146637, 45.257982472578675, 44.78324682513872, 44.93411903704205, 44.885577293733746, 44.79773405442634, 37.027180070678384, 37.12905658564219, 36.41864257554212, 49.222302074233696, 49.51319777468841, 49.69881980742018, 53.8964541008075, 53.979886186619595, 54.12834163134296, 44.378354767958314, 44.09376359979311, 44.316426585117966, 42.460985258221626, 42.44971890002489, 42.340334579348564, 42.44174127032359, 42.25538183500369, 42.36204799761374, 51.64542779823144, 51.85870923598607, 52.19162144263585, 38.51335696876049, 39.089715061709285, 38.87028709053993, 50.56380116939543, 50.398342885076985, 50.60369258373974, 42.074102361996964, 42.11594884594281, 42.38308114310105, 43.82323596378167, 44.719211982873574, 44.12535425027211, 51.757748819887624, 51.70019099861382, 51.88404022157191, 48.50537588447331, 48.461054801940904, 48.5206021144986, 43.47743665302792, 43.54151702920595, 43.126502777139336, 40.01474691430727, 40.30201269189516, 40.669858761752636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14529670162388647, "mean_inference_ms": 0.7005489940493409, "mean_action_processing_ms": 0.10145198112362949, "mean_env_wait_ms": 0.8445528442305923, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 695000, "timesteps_this_iter": 0, "agent_timesteps_total": 2085000, "timers": {"sample_time_ms": 10708.424, "sample_throughput": 466.922, "load_time_ms": 0.1, "load_throughput": 50003624.225, "learn_time_ms": 1651.103, "learn_throughput": 3028.279, "update_time_ms": 8.113}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.211690350419474e-28, "cur_lr": 0.0005000000000000001, "total_loss": 7.814224004745483, "policy_loss": 0.002598277002181071, "vf_loss": 7.895903778076172, "vf_explained_var": 0.007905721664428711, "kl": 0.01333832377570478, "entropy": 8.42782382965088, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 695000, "num_agent_steps_sampled": 2085000, "num_steps_trained": 695000, "num_agent_steps_trained": 2085000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2246, "training_iteration": 139, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-34-10", "timestamp": 1706229250, "time_this_iter_s": 11.21153736114502, "time_total_s": 1490.7760338783264, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028379EA60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1490.7760338783264, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 9.13125, "ram_util_percent": 50.175000000000004}}
{"episode_reward_max": 186.43213457905205, "episode_reward_min": 102.5706898346543, "episode_reward_mean": 137.3638721456617, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 33.75082166492939}, "policy_reward_max": {"shared_policy": 62.434312388106875}, "policy_reward_mean": {"shared_policy": 45.787957381887246}, "custom_metrics": {}, "hist_stats": {"episode_reward": [112.04908834234809, 154.78532445803282, 137.7549224793912, 110.27082038484514, 131.81913538463402, 129.44476425647736, 131.11788378655905, 134.71854474116125, 114.00911807268857, 142.80681710131483, 137.62255625100806, 127.90208644419909, 121.13010664656757, 120.84051058441399, 137.7459141719154, 153.5410344004626, 128.61702033504844, 122.23495800793168, 148.10227871686214, 102.5706898346543, 161.9356682132928, 140.60558438301084, 155.68477183347537, 156.7514685858042, 140.0287080425768, 140.31757280230516, 118.1272618882358, 153.0498130843041, 147.46418796479674, 132.18583288788804, 163.00748359039423, 175.6030363440516, 132.24410562962282, 102.73906883597374, 146.85551647841916, 135.3157788384706, 157.1437683198603, 128.75456797331574, 137.356368251145, 153.94707639887918, 143.54428117815385, 126.67682002298534, 151.51519706286476, 132.22980724740773, 134.61968480050575, 140.59594114753423, 138.87369583174586, 186.43213457905205, 121.60968893242534, 144.36690459027872, 114.64727322757244, 143.2121422626077, 134.77122410945572, 168.43142340332275, 116.83629297791049, 134.07892413437366, 152.0999465547502, 133.69028533995163, 148.90123263746517, 109.4145684428513, 131.1695353649555, 144.49010072275993, 121.57590840384361, 142.23299851268519, 142.1129876542837, 132.27335551939905, 154.388396619819, 118.36822646856305, 133.9272874705494, 112.34253245149736, 136.71871903538715, 139.72509447857726, 133.5783370379359, 135.80723135918373, 134.61743038520225, 110.5748792318627, 148.43431965634238, 162.00468191877013, 132.78854495286947, 127.25103873759508, 127.05917110294102, 155.69575847685326, 116.47335912100971, 151.5658366382123, 126.57313235104083, 132.66780219692737, 155.34198004007314, 145.48703280091286, 130.14545645937324, 120.98661836795506, 135.42721158714264, 116.40718443319201, 123.97540933173148, 164.40441876649834, 153.18299389258027, 161.25657337158907, 157.9073642306031, 119.8318168800324, 138.63773857802119, 154.2300667278467], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [37.2253665352861, 37.245779077212006, 37.57794272984998, 51.79382242634891, 51.54286591708659, 51.448636114597306, 46.10736473401387, 45.791085836788014, 45.8564719085892, 36.997753566130996, 36.65076096355915, 36.62230585515499, 43.88748014221588, 43.63641222814718, 44.29524301427105, 43.283167742192745, 42.655131071805954, 43.50646544247866, 43.77146972219148, 43.74265184501806, 43.603762219349534, 44.952864706516266, 44.55093985795975, 45.214740176685154, 37.815325667460755, 37.886727934082344, 38.307064471145466, 47.27889261643092, 47.6431461746494, 47.88477831023435, 46.062895435219005, 45.474202906092, 46.08545790969704, 42.7819844558835, 42.69311434030533, 42.426987648010254, 40.05457706501086, 40.42991289620598, 40.64561668535073, 40.203077410658196, 40.687296492358044, 39.95013668139775, 45.795031774789095, 45.966697412543, 45.98418498458341, 51.10698921481769, 51.312154660622284, 51.12189052502315, 42.82406853263576, 42.87506552164753, 42.91788628076513, 40.449124241868645, 40.952865930895, 40.832967835168034, 49.59103127568959, 49.049253255128846, 49.461994186043725, 33.86421577135721, 34.35829733560482, 34.34817672769228, 54.183289417376116, 53.53361300130685, 54.21876579460998, 46.825145545105144, 46.794662053386375, 46.98577678451936, 51.95406912515561, 52.08838267639901, 51.642320031921074, 51.74995615581672, 52.37425421799223, 52.62725821199517, 46.672607090945036, 46.664325868400425, 46.69177508323142, 46.48221472899118, 46.92844189393023, 46.906916179383785, 39.19925632079442, 39.33904992540677, 39.588955642034605, 50.77068457504113, 51.202800815304116, 51.07632769395907, 49.12653300911187, 48.86763341724871, 49.4700215384364, 44.013832854727895, 44.07280297080675, 44.099197062353284, 54.36160475201903, 54.32611425593494, 54.31976458244024, 58.49553244312604, 58.509157096346215, 58.598346804579094, 44.10887125010291, 43.994315574566514, 44.140918804953486, 34.43576970696449, 33.75082166492939, 34.55247746407986, 49.137966821591064, 48.795022035638496, 48.92252762118976, 45.06728136787811, 44.78432504336038, 45.46417242723206, 52.52382114405434, 52.46686302932601, 52.15308414647977, 42.80619419614473, 42.80634898195663, 43.142024795214326, 45.69735684245825, 45.78128319978714, 45.8777282088995, 51.31445452322562, 51.082063277562455, 51.5505585980912, 47.426117469867066, 47.86685637881358, 48.25130732947339, 42.08851058036089, 42.35978149808943, 42.22852794453502, 50.54460771630208, 50.45295845965545, 50.517630886907384, 44.36620407768835, 43.874492091437176, 43.98911107828219, 44.938242362191275, 44.81550933917363, 44.86593309914072, 46.57575550675391, 46.814756795763955, 47.20542884501627, 46.12462545682986, 46.167734665175274, 46.58133570974071, 62.434312388106875, 61.632018471757576, 62.36580371918778, 40.88584749621805, 40.479427345097065, 40.24441409111023, 48.032761973639325, 48.17073072617252, 48.163411890467, 38.13637422770262, 38.58439268916845, 37.92650631070137, 47.364173839489624, 47.89316003272931, 47.95480839038889, 44.746978806952626, 45.22601339283088, 44.79823190967241, 56.27039311577876, 56.11205270638068, 56.04897758116324, 38.80494204163551, 38.751846224069595, 39.27950471220538, 44.824269178013, 44.850416394571454, 44.404238561789185, 50.655308000743375, 50.894599396735416, 50.55003915727137, 44.71815474083026, 44.436328818400696, 44.53580178072055, 49.348284890254334, 49.8839958657821, 49.668951881428555, 36.61595359817147, 36.41477359831333, 36.3838412463665, 43.71285019318262, 44.13924384738007, 43.317441324392945, 48.4456364872555, 48.28824522594611, 47.756219009558365, 40.91928308332959, 40.66561080018678, 39.99101452032724, 47.10684727132319, 47.55172225832938, 47.57442898303269, 47.17028537392615, 47.24485037475823, 47.69785190559922, 44.12607066084941, 44.32846336377163, 43.81882149477799, 51.72022993707408, 51.05877504249413, 51.60939164025088, 39.40349944929281, 40.01700141529241, 38.94772560397783, 44.67917489260435, 44.24793376028538, 45.00017881765962, 37.0356663117806, 37.62000099165985, 37.68686514805691, 45.2772834499677, 45.73370149110754, 45.70773409431179, 46.59106447796026, 46.653273491809756, 46.48075650880733, 44.17932781328757, 44.65895430122812, 44.740054923420146, 45.76600206146637, 45.257982472578675, 44.78324682513872, 44.93411903704205, 44.885577293733746, 44.79773405442634, 37.027180070678384, 37.12905658564219, 36.41864257554212, 49.222302074233696, 49.51319777468841, 49.69881980742018, 53.8964541008075, 53.979886186619595, 54.12834163134296, 44.378354767958314, 44.09376359979311, 44.316426585117966, 42.460985258221626, 42.44971890002489, 42.340334579348564, 42.44174127032359, 42.25538183500369, 42.36204799761374, 51.64542779823144, 51.85870923598607, 52.19162144263585, 38.51335696876049, 39.089715061709285, 38.87028709053993, 50.56380116939543, 50.398342885076985, 50.60369258373974, 42.074102361996964, 42.11594884594281, 42.38308114310105, 43.82323596378167, 44.719211982873574, 44.12535425027211, 51.757748819887624, 51.70019099861382, 51.88404022157191, 48.50537588447331, 48.461054801940904, 48.5206021144986, 43.47743665302792, 43.54151702920595, 43.126502777139336, 40.01474691430727, 40.30201269189516, 40.669858761752636, 45.03659726306796, 45.120624613016844, 45.26998971105786, 38.98031169548631, 38.74365217983723, 38.68322055786848, 41.00857112308343, 41.36865414430697, 41.59818406434108, 54.825688252846405, 54.750716226796314, 54.82801428685586, 51.108365837484584, 50.75398033112286, 51.32064772397278, 53.7639575401942, 53.65199550489585, 53.84062032649915, 52.743636174748346, 52.48986081282298, 52.673867243031665, 40.306592847531036, 39.603567396601036, 39.921656635900334, 46.10371020187934, 46.4131717433532, 46.12085663278897, 51.38877327367662, 51.42345809191464, 51.41783536225556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14532901820078367, "mean_inference_ms": 0.7007986513999174, "mean_action_processing_ms": 0.10146511352141131, "mean_env_wait_ms": 0.8444845318410807, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 700000, "timesteps_this_iter": 0, "agent_timesteps_total": 2100000, "timers": {"sample_time_ms": 10841.065, "sample_throughput": 461.209, "load_time_ms": 0.2, "load_throughput": 25016724.323, "learn_time_ms": 1661.471, "learn_throughput": 3009.381, "update_time_ms": 8.118}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.211690350419474e-28, "cur_lr": 0.0005000000000000001, "total_loss": 10.965161037445068, "policy_loss": 0.0010425378706699461, "vf_loss": 11.048308753967286, "vf_explained_var": -0.008068203926086426, "kl": 0.007594694057506239, "entropy": 8.419087600708007, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 700000, "num_agent_steps_sampled": 2100000, "num_steps_trained": 700000, "num_agent_steps_trained": 2100000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2256, "training_iteration": 140, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-34-21", "timestamp": 1706229261, "time_this_iter_s": 11.27946138381958, "time_total_s": 1502.055495262146, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282306940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1502.055495262146, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 11.23125, "ram_util_percent": 50.275000000000006}}
{"episode_reward_max": 186.43213457905205, "episode_reward_min": 97.29839042201637, "episode_reward_mean": 138.68759689248455, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 32.13314728935559}, "policy_reward_max": {"shared_policy": 62.434312388106875}, "policy_reward_mean": {"shared_policy": 46.22919896416151}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.62255625100806, 127.90208644419909, 121.13010664656757, 120.84051058441399, 137.7459141719154, 153.5410344004626, 128.61702033504844, 122.23495800793168, 148.10227871686214, 102.5706898346543, 161.9356682132928, 140.60558438301084, 155.68477183347537, 156.7514685858042, 140.0287080425768, 140.31757280230516, 118.1272618882358, 153.0498130843041, 147.46418796479674, 132.18583288788804, 163.00748359039423, 175.6030363440516, 132.24410562962282, 102.73906883597374, 146.85551647841916, 135.3157788384706, 157.1437683198603, 128.75456797331574, 137.356368251145, 153.94707639887918, 143.54428117815385, 126.67682002298534, 151.51519706286476, 132.22980724740773, 134.61968480050575, 140.59594114753423, 138.87369583174586, 186.43213457905205, 121.60968893242534, 144.36690459027872, 114.64727322757244, 143.2121422626077, 134.77122410945572, 168.43142340332275, 116.83629297791049, 134.07892413437366, 152.0999465547502, 133.69028533995163, 148.90123263746517, 109.4145684428513, 131.1695353649555, 144.49010072275993, 121.57590840384361, 142.23299851268519, 142.1129876542837, 132.27335551939905, 154.388396619819, 118.36822646856305, 133.9272874705494, 112.34253245149736, 136.71871903538715, 139.72509447857726, 133.5783370379359, 135.80723135918373, 134.61743038520225, 110.5748792318627, 148.43431965634238, 162.00468191877013, 132.78854495286947, 127.25103873759508, 127.05917110294102, 155.69575847685326, 116.47335912100971, 151.5658366382123, 126.57313235104083, 132.66780219692737, 155.34198004007314, 145.48703280091286, 130.14545645937324, 120.98661836795506, 135.42721158714264, 116.40718443319201, 123.97540933173148, 164.40441876649834, 153.18299389258027, 161.25657337158907, 157.9073642306031, 119.8318168800324, 138.63773857802119, 154.2300667278467, 164.8695129081607, 143.8584717512129, 177.76034324243673, 97.29839042201637, 143.19101995974782, 170.94491278007618, 133.54066868685192, 111.03443151712418, 150.8247961504388, 137.82634627167093], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [46.062895435219005, 45.474202906092, 46.08545790969704, 42.7819844558835, 42.69311434030533, 42.426987648010254, 40.05457706501086, 40.42991289620598, 40.64561668535073, 40.203077410658196, 40.687296492358044, 39.95013668139775, 45.795031774789095, 45.966697412543, 45.98418498458341, 51.10698921481769, 51.312154660622284, 51.12189052502315, 42.82406853263576, 42.87506552164753, 42.91788628076513, 40.449124241868645, 40.952865930895, 40.832967835168034, 49.59103127568959, 49.049253255128846, 49.461994186043725, 33.86421577135721, 34.35829733560482, 34.34817672769228, 54.183289417376116, 53.53361300130685, 54.21876579460998, 46.825145545105144, 46.794662053386375, 46.98577678451936, 51.95406912515561, 52.08838267639901, 51.642320031921074, 51.74995615581672, 52.37425421799223, 52.62725821199517, 46.672607090945036, 46.664325868400425, 46.69177508323142, 46.48221472899118, 46.92844189393023, 46.906916179383785, 39.19925632079442, 39.33904992540677, 39.588955642034605, 50.77068457504113, 51.202800815304116, 51.07632769395907, 49.12653300911187, 48.86763341724871, 49.4700215384364, 44.013832854727895, 44.07280297080675, 44.099197062353284, 54.36160475201903, 54.32611425593494, 54.31976458244024, 58.49553244312604, 58.509157096346215, 58.598346804579094, 44.10887125010291, 43.994315574566514, 44.140918804953486, 34.43576970696449, 33.75082166492939, 34.55247746407986, 49.137966821591064, 48.795022035638496, 48.92252762118976, 45.06728136787811, 44.78432504336038, 45.46417242723206, 52.52382114405434, 52.46686302932601, 52.15308414647977, 42.80619419614473, 42.80634898195663, 43.142024795214326, 45.69735684245825, 45.78128319978714, 45.8777282088995, 51.31445452322562, 51.082063277562455, 51.5505585980912, 47.426117469867066, 47.86685637881358, 48.25130732947339, 42.08851058036089, 42.35978149808943, 42.22852794453502, 50.54460771630208, 50.45295845965545, 50.517630886907384, 44.36620407768835, 43.874492091437176, 43.98911107828219, 44.938242362191275, 44.81550933917363, 44.86593309914072, 46.57575550675391, 46.814756795763955, 47.20542884501627, 46.12462545682986, 46.167734665175274, 46.58133570974071, 62.434312388106875, 61.632018471757576, 62.36580371918778, 40.88584749621805, 40.479427345097065, 40.24441409111023, 48.032761973639325, 48.17073072617252, 48.163411890467, 38.13637422770262, 38.58439268916845, 37.92650631070137, 47.364173839489624, 47.89316003272931, 47.95480839038889, 44.746978806952626, 45.22601339283088, 44.79823190967241, 56.27039311577876, 56.11205270638068, 56.04897758116324, 38.80494204163551, 38.751846224069595, 39.27950471220538, 44.824269178013, 44.850416394571454, 44.404238561789185, 50.655308000743375, 50.894599396735416, 50.55003915727137, 44.71815474083026, 44.436328818400696, 44.53580178072055, 49.348284890254334, 49.8839958657821, 49.668951881428555, 36.61595359817147, 36.41477359831333, 36.3838412463665, 43.71285019318262, 44.13924384738007, 43.317441324392945, 48.4456364872555, 48.28824522594611, 47.756219009558365, 40.91928308332959, 40.66561080018678, 39.99101452032724, 47.10684727132319, 47.55172225832938, 47.57442898303269, 47.17028537392615, 47.24485037475823, 47.69785190559922, 44.12607066084941, 44.32846336377163, 43.81882149477799, 51.72022993707408, 51.05877504249413, 51.60939164025088, 39.40349944929281, 40.01700141529241, 38.94772560397783, 44.67917489260435, 44.24793376028538, 45.00017881765962, 37.0356663117806, 37.62000099165985, 37.68686514805691, 45.2772834499677, 45.73370149110754, 45.70773409431179, 46.59106447796026, 46.653273491809756, 46.48075650880733, 44.17932781328757, 44.65895430122812, 44.740054923420146, 45.76600206146637, 45.257982472578675, 44.78324682513872, 44.93411903704205, 44.885577293733746, 44.79773405442634, 37.027180070678384, 37.12905658564219, 36.41864257554212, 49.222302074233696, 49.51319777468841, 49.69881980742018, 53.8964541008075, 53.979886186619595, 54.12834163134296, 44.378354767958314, 44.09376359979311, 44.316426585117966, 42.460985258221626, 42.44971890002489, 42.340334579348564, 42.44174127032359, 42.25538183500369, 42.36204799761374, 51.64542779823144, 51.85870923598607, 52.19162144263585, 38.51335696876049, 39.089715061709285, 38.87028709053993, 50.56380116939543, 50.398342885076985, 50.60369258373974, 42.074102361996964, 42.11594884594281, 42.38308114310105, 43.82323596378167, 44.719211982873574, 44.12535425027211, 51.757748819887624, 51.70019099861382, 51.88404022157191, 48.50537588447331, 48.461054801940904, 48.5206021144986, 43.47743665302792, 43.54151702920595, 43.126502777139336, 40.01474691430727, 40.30201269189516, 40.669858761752636, 45.03659726306796, 45.120624613016844, 45.26998971105786, 38.98031169548631, 38.74365217983723, 38.68322055786848, 41.00857112308343, 41.36865414430697, 41.59818406434108, 54.825688252846405, 54.750716226796314, 54.82801428685586, 51.108365837484584, 50.75398033112286, 51.32064772397278, 53.7639575401942, 53.65199550489585, 53.84062032649915, 52.743636174748346, 52.48986081282298, 52.673867243031665, 40.306592847531036, 39.603567396601036, 39.921656635900334, 46.10371020187934, 46.4131717433532, 46.12085663278897, 51.38877327367662, 51.42345809191464, 51.41783536225556, 55.096342287957654, 54.859771788120256, 54.913398832082734, 48.110827175279454, 47.924493966003254, 47.82315060993035, 58.83899871508281, 59.36652198682229, 59.55482254053156, 32.660916709651545, 32.13314728935559, 32.50432642300923, 47.54368256529172, 48.01271915187438, 47.63461824258168, 57.22383797541259, 56.665550306439386, 57.055524498224244, 44.11083926260471, 44.51677379012108, 44.91305563412607, 37.50762251019478, 36.25258308649063, 37.27422592043877, 49.70733264088629, 50.59270446281879, 50.524759046733365, 46.104758627402276, 46.00693754727641, 45.71465009699264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14538111907322826, "mean_inference_ms": 0.7011355647746356, "mean_action_processing_ms": 0.10148567698028446, "mean_env_wait_ms": 0.8444985805754841, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 705000, "timesteps_this_iter": 0, "agent_timesteps_total": 2115000, "timers": {"sample_time_ms": 10987.083, "sample_throughput": 455.08, "load_time_ms": 0.2, "load_throughput": 25016724.323, "learn_time_ms": 1674.675, "learn_throughput": 2985.654, "update_time_ms": 8.172}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.211690350419474e-28, "cur_lr": 0.0005000000000000001, "total_loss": 7.412514591217041, "policy_loss": 0.002162172601132983, "vf_loss": 7.493891620635987, "vf_explained_var": 0.006308853626251221, "kl": 0.010771830612818991, "entropy": 8.353920173645019, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 705000, "num_agent_steps_sampled": 2115000, "num_steps_trained": 705000, "num_agent_steps_trained": 2115000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2266, "training_iteration": 141, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-34-32", "timestamp": 1706229272, "time_this_iter_s": 11.1287202835083, "time_total_s": 1513.1842155456543, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020284553550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1513.1842155456543, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 9.5, "ram_util_percent": 50.48125}}
{"episode_reward_max": 186.43213457905205, "episode_reward_min": 97.29839042201637, "episode_reward_mean": 139.2594736246805, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 32.13314728935559}, "policy_reward_max": {"shared_policy": 62.434312388106875}, "policy_reward_mean": {"shared_policy": 46.41982454156018}, "custom_metrics": {}, "hist_stats": {"episode_reward": [161.9356682132928, 140.60558438301084, 155.68477183347537, 156.7514685858042, 140.0287080425768, 140.31757280230516, 118.1272618882358, 153.0498130843041, 147.46418796479674, 132.18583288788804, 163.00748359039423, 175.6030363440516, 132.24410562962282, 102.73906883597374, 146.85551647841916, 135.3157788384706, 157.1437683198603, 128.75456797331574, 137.356368251145, 153.94707639887918, 143.54428117815385, 126.67682002298534, 151.51519706286476, 132.22980724740773, 134.61968480050575, 140.59594114753423, 138.87369583174586, 186.43213457905205, 121.60968893242534, 144.36690459027872, 114.64727322757244, 143.2121422626077, 134.77122410945572, 168.43142340332275, 116.83629297791049, 134.07892413437366, 152.0999465547502, 133.69028533995163, 148.90123263746517, 109.4145684428513, 131.1695353649555, 144.49010072275993, 121.57590840384361, 142.23299851268519, 142.1129876542837, 132.27335551939905, 154.388396619819, 118.36822646856305, 133.9272874705494, 112.34253245149736, 136.71871903538715, 139.72509447857726, 133.5783370379359, 135.80723135918373, 134.61743038520225, 110.5748792318627, 148.43431965634238, 162.00468191877013, 132.78854495286947, 127.25103873759508, 127.05917110294102, 155.69575847685326, 116.47335912100971, 151.5658366382123, 126.57313235104083, 132.66780219692737, 155.34198004007314, 145.48703280091286, 130.14545645937324, 120.98661836795506, 135.42721158714264, 116.40718443319201, 123.97540933173148, 164.40441876649834, 153.18299389258027, 161.25657337158907, 157.9073642306031, 119.8318168800324, 138.63773857802119, 154.2300667278467, 164.8695129081607, 143.8584717512129, 177.76034324243673, 97.29839042201637, 143.19101995974782, 170.94491278007618, 133.54066868685192, 111.03443151712418, 150.8247961504388, 137.82634627167093, 114.01700243353841, 151.527911223471, 133.976661135559, 126.70854399353263, 150.53745679184806, 130.2188545763492, 140.0488937310875, 166.1023392826317, 114.48240126855669, 129.8747641760856], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [54.183289417376116, 53.53361300130685, 54.21876579460998, 46.825145545105144, 46.794662053386375, 46.98577678451936, 51.95406912515561, 52.08838267639901, 51.642320031921074, 51.74995615581672, 52.37425421799223, 52.62725821199517, 46.672607090945036, 46.664325868400425, 46.69177508323142, 46.48221472899118, 46.92844189393023, 46.906916179383785, 39.19925632079442, 39.33904992540677, 39.588955642034605, 50.77068457504113, 51.202800815304116, 51.07632769395907, 49.12653300911187, 48.86763341724871, 49.4700215384364, 44.013832854727895, 44.07280297080675, 44.099197062353284, 54.36160475201903, 54.32611425593494, 54.31976458244024, 58.49553244312604, 58.509157096346215, 58.598346804579094, 44.10887125010291, 43.994315574566514, 44.140918804953486, 34.43576970696449, 33.75082166492939, 34.55247746407986, 49.137966821591064, 48.795022035638496, 48.92252762118976, 45.06728136787811, 44.78432504336038, 45.46417242723206, 52.52382114405434, 52.46686302932601, 52.15308414647977, 42.80619419614473, 42.80634898195663, 43.142024795214326, 45.69735684245825, 45.78128319978714, 45.8777282088995, 51.31445452322562, 51.082063277562455, 51.5505585980912, 47.426117469867066, 47.86685637881358, 48.25130732947339, 42.08851058036089, 42.35978149808943, 42.22852794453502, 50.54460771630208, 50.45295845965545, 50.517630886907384, 44.36620407768835, 43.874492091437176, 43.98911107828219, 44.938242362191275, 44.81550933917363, 44.86593309914072, 46.57575550675391, 46.814756795763955, 47.20542884501627, 46.12462545682986, 46.167734665175274, 46.58133570974071, 62.434312388106875, 61.632018471757576, 62.36580371918778, 40.88584749621805, 40.479427345097065, 40.24441409111023, 48.032761973639325, 48.17073072617252, 48.163411890467, 38.13637422770262, 38.58439268916845, 37.92650631070137, 47.364173839489624, 47.89316003272931, 47.95480839038889, 44.746978806952626, 45.22601339283088, 44.79823190967241, 56.27039311577876, 56.11205270638068, 56.04897758116324, 38.80494204163551, 38.751846224069595, 39.27950471220538, 44.824269178013, 44.850416394571454, 44.404238561789185, 50.655308000743375, 50.894599396735416, 50.55003915727137, 44.71815474083026, 44.436328818400696, 44.53580178072055, 49.348284890254334, 49.8839958657821, 49.668951881428555, 36.61595359817147, 36.41477359831333, 36.3838412463665, 43.71285019318262, 44.13924384738007, 43.317441324392945, 48.4456364872555, 48.28824522594611, 47.756219009558365, 40.91928308332959, 40.66561080018678, 39.99101452032724, 47.10684727132319, 47.55172225832938, 47.57442898303269, 47.17028537392615, 47.24485037475823, 47.69785190559922, 44.12607066084941, 44.32846336377163, 43.81882149477799, 51.72022993707408, 51.05877504249413, 51.60939164025088, 39.40349944929281, 40.01700141529241, 38.94772560397783, 44.67917489260435, 44.24793376028538, 45.00017881765962, 37.0356663117806, 37.62000099165985, 37.68686514805691, 45.2772834499677, 45.73370149110754, 45.70773409431179, 46.59106447796026, 46.653273491809756, 46.48075650880733, 44.17932781328757, 44.65895430122812, 44.740054923420146, 45.76600206146637, 45.257982472578675, 44.78324682513872, 44.93411903704205, 44.885577293733746, 44.79773405442634, 37.027180070678384, 37.12905658564219, 36.41864257554212, 49.222302074233696, 49.51319777468841, 49.69881980742018, 53.8964541008075, 53.979886186619595, 54.12834163134296, 44.378354767958314, 44.09376359979311, 44.316426585117966, 42.460985258221626, 42.44971890002489, 42.340334579348564, 42.44174127032359, 42.25538183500369, 42.36204799761374, 51.64542779823144, 51.85870923598607, 52.19162144263585, 38.51335696876049, 39.089715061709285, 38.87028709053993, 50.56380116939543, 50.398342885076985, 50.60369258373974, 42.074102361996964, 42.11594884594281, 42.38308114310105, 43.82323596378167, 44.719211982873574, 44.12535425027211, 51.757748819887624, 51.70019099861382, 51.88404022157191, 48.50537588447331, 48.461054801940904, 48.5206021144986, 43.47743665302792, 43.54151702920595, 43.126502777139336, 40.01474691430727, 40.30201269189516, 40.669858761752636, 45.03659726306796, 45.120624613016844, 45.26998971105786, 38.98031169548631, 38.74365217983723, 38.68322055786848, 41.00857112308343, 41.36865414430697, 41.59818406434108, 54.825688252846405, 54.750716226796314, 54.82801428685586, 51.108365837484584, 50.75398033112286, 51.32064772397278, 53.7639575401942, 53.65199550489585, 53.84062032649915, 52.743636174748346, 52.48986081282298, 52.673867243031665, 40.306592847531036, 39.603567396601036, 39.921656635900334, 46.10371020187934, 46.4131717433532, 46.12085663278897, 51.38877327367662, 51.42345809191464, 51.41783536225556, 55.096342287957654, 54.859771788120256, 54.913398832082734, 48.110827175279454, 47.924493966003254, 47.82315060993035, 58.83899871508281, 59.36652198682229, 59.55482254053156, 32.660916709651545, 32.13314728935559, 32.50432642300923, 47.54368256529172, 48.01271915187438, 47.63461824258168, 57.22383797541259, 56.665550306439386, 57.055524498224244, 44.11083926260471, 44.51677379012108, 44.91305563412607, 37.50762251019478, 36.25258308649063, 37.27422592043877, 49.70733264088629, 50.59270446281879, 50.524759046733365, 46.104758627402276, 46.00693754727641, 45.71465009699264, 37.87345031897226, 38.056584807733685, 38.08696730683246, 50.051131963729844, 50.44324126839636, 51.033537991344915, 44.47393950323263, 44.80299595351485, 44.69972567881146, 42.317435214916856, 42.071871044735104, 42.31923773388067, 50.09404383475582, 50.17935491042833, 50.264058046663806, 43.28802376737197, 43.50073154767354, 43.43009926130374, 47.10783874119322, 46.53740263978641, 46.40365235010783, 55.40892003476618, 55.38215412199496, 55.31126512587069, 38.38906325834492, 38.11678599069515, 37.97655201951662, 43.37947932941218, 43.30984429394205, 43.18544055273135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1454354818137949, "mean_inference_ms": 0.7014570312338937, "mean_action_processing_ms": 0.10150047090521808, "mean_env_wait_ms": 0.8445101743302046, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 710000, "timesteps_this_iter": 0, "agent_timesteps_total": 2130000, "timers": {"sample_time_ms": 10995.693, "sample_throughput": 454.724, "load_time_ms": 0.2, "load_throughput": 25016724.323, "learn_time_ms": 1675.158, "learn_throughput": 2984.793, "update_time_ms": 7.926}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.211690350419474e-28, "cur_lr": 0.0005000000000000001, "total_loss": 7.456546831130981, "policy_loss": 0.0008380760669025378, "vf_loss": 7.540112590789795, "vf_explained_var": -0.011618173122406006, "kl": 0.005564478971092144, "entropy": 8.440400314331054, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 710000, "num_agent_steps_sampled": 2130000, "num_steps_trained": 710000, "num_agent_steps_trained": 2130000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2276, "training_iteration": 142, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-34-44", "timestamp": 1706229284, "time_this_iter_s": 11.18904185295105, "time_total_s": 1524.3732573986053, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202822183A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1524.3732573986053, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 8.987499999999999, "ram_util_percent": 50.425}}
{"episode_reward_max": 186.43213457905205, "episode_reward_min": -226.86492830328643, "episode_reward_mean": 135.99113945374668, "episode_len_mean": 498.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.89594047702849}, "policy_reward_max": {"shared_policy": 62.434312388106875}, "policy_reward_mean": {"shared_policy": 45.33037981791556}, "custom_metrics": {}, "hist_stats": {"episode_reward": [163.00748359039423, 175.6030363440516, 132.24410562962282, 102.73906883597374, 146.85551647841916, 135.3157788384706, 157.1437683198603, 128.75456797331574, 137.356368251145, 153.94707639887918, 143.54428117815385, 126.67682002298534, 151.51519706286476, 132.22980724740773, 134.61968480050575, 140.59594114753423, 138.87369583174586, 186.43213457905205, 121.60968893242534, 144.36690459027872, 114.64727322757244, 143.2121422626077, 134.77122410945572, 168.43142340332275, 116.83629297791049, 134.07892413437366, 152.0999465547502, 133.69028533995163, 148.90123263746517, 109.4145684428513, 131.1695353649555, 144.49010072275993, 121.57590840384361, 142.23299851268519, 142.1129876542837, 132.27335551939905, 154.388396619819, 118.36822646856305, 133.9272874705494, 112.34253245149736, 136.71871903538715, 139.72509447857726, 133.5783370379359, 135.80723135918373, 134.61743038520225, 110.5748792318627, 148.43431965634238, 162.00468191877013, 132.78854495286947, 127.25103873759508, 127.05917110294102, 155.69575847685326, 116.47335912100971, 151.5658366382123, 126.57313235104083, 132.66780219692737, 155.34198004007314, 145.48703280091286, 130.14545645937324, 120.98661836795506, 135.42721158714264, 116.40718443319201, 123.97540933173148, 164.40441876649834, 153.18299389258027, 161.25657337158907, 157.9073642306031, 119.8318168800324, 138.63773857802119, 154.2300667278467, 164.8695129081607, 143.8584717512129, 177.76034324243673, 97.29839042201637, 143.19101995974782, 170.94491278007618, 133.54066868685192, 111.03443151712418, 150.8247961504388, 137.82634627167093, 114.01700243353841, 151.527911223471, 133.976661135559, 126.70854399353263, 150.53745679184806, 130.2188545763492, 140.0488937310875, 166.1023392826317, 114.48240126855669, 129.8747641760856, 142.6267927139994, 158.14660183340294, -226.86492830328643, 164.00881864130477, 170.17768881376816, 146.36652821861207, 142.27911720424882, 123.95217544771728, 127.18856738135219, 171.43609064118928], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 380, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [54.36160475201903, 54.32611425593494, 54.31976458244024, 58.49553244312604, 58.509157096346215, 58.598346804579094, 44.10887125010291, 43.994315574566514, 44.140918804953486, 34.43576970696449, 33.75082166492939, 34.55247746407986, 49.137966821591064, 48.795022035638496, 48.92252762118976, 45.06728136787811, 44.78432504336038, 45.46417242723206, 52.52382114405434, 52.46686302932601, 52.15308414647977, 42.80619419614473, 42.80634898195663, 43.142024795214326, 45.69735684245825, 45.78128319978714, 45.8777282088995, 51.31445452322562, 51.082063277562455, 51.5505585980912, 47.426117469867066, 47.86685637881358, 48.25130732947339, 42.08851058036089, 42.35978149808943, 42.22852794453502, 50.54460771630208, 50.45295845965545, 50.517630886907384, 44.36620407768835, 43.874492091437176, 43.98911107828219, 44.938242362191275, 44.81550933917363, 44.86593309914072, 46.57575550675391, 46.814756795763955, 47.20542884501627, 46.12462545682986, 46.167734665175274, 46.58133570974071, 62.434312388106875, 61.632018471757576, 62.36580371918778, 40.88584749621805, 40.479427345097065, 40.24441409111023, 48.032761973639325, 48.17073072617252, 48.163411890467, 38.13637422770262, 38.58439268916845, 37.92650631070137, 47.364173839489624, 47.89316003272931, 47.95480839038889, 44.746978806952626, 45.22601339283088, 44.79823190967241, 56.27039311577876, 56.11205270638068, 56.04897758116324, 38.80494204163551, 38.751846224069595, 39.27950471220538, 44.824269178013, 44.850416394571454, 44.404238561789185, 50.655308000743375, 50.894599396735416, 50.55003915727137, 44.71815474083026, 44.436328818400696, 44.53580178072055, 49.348284890254334, 49.8839958657821, 49.668951881428555, 36.61595359817147, 36.41477359831333, 36.3838412463665, 43.71285019318262, 44.13924384738007, 43.317441324392945, 48.4456364872555, 48.28824522594611, 47.756219009558365, 40.91928308332959, 40.66561080018678, 39.99101452032724, 47.10684727132319, 47.55172225832938, 47.57442898303269, 47.17028537392615, 47.24485037475823, 47.69785190559922, 44.12607066084941, 44.32846336377163, 43.81882149477799, 51.72022993707408, 51.05877504249413, 51.60939164025088, 39.40349944929281, 40.01700141529241, 38.94772560397783, 44.67917489260435, 44.24793376028538, 45.00017881765962, 37.0356663117806, 37.62000099165985, 37.68686514805691, 45.2772834499677, 45.73370149110754, 45.70773409431179, 46.59106447796026, 46.653273491809756, 46.48075650880733, 44.17932781328757, 44.65895430122812, 44.740054923420146, 45.76600206146637, 45.257982472578675, 44.78324682513872, 44.93411903704205, 44.885577293733746, 44.79773405442634, 37.027180070678384, 37.12905658564219, 36.41864257554212, 49.222302074233696, 49.51319777468841, 49.69881980742018, 53.8964541008075, 53.979886186619595, 54.12834163134296, 44.378354767958314, 44.09376359979311, 44.316426585117966, 42.460985258221626, 42.44971890002489, 42.340334579348564, 42.44174127032359, 42.25538183500369, 42.36204799761374, 51.64542779823144, 51.85870923598607, 52.19162144263585, 38.51335696876049, 39.089715061709285, 38.87028709053993, 50.56380116939543, 50.398342885076985, 50.60369258373974, 42.074102361996964, 42.11594884594281, 42.38308114310105, 43.82323596378167, 44.719211982873574, 44.12535425027211, 51.757748819887624, 51.70019099861382, 51.88404022157191, 48.50537588447331, 48.461054801940904, 48.5206021144986, 43.47743665302792, 43.54151702920595, 43.126502777139336, 40.01474691430727, 40.30201269189516, 40.669858761752636, 45.03659726306796, 45.120624613016844, 45.26998971105786, 38.98031169548631, 38.74365217983723, 38.68322055786848, 41.00857112308343, 41.36865414430697, 41.59818406434108, 54.825688252846405, 54.750716226796314, 54.82801428685586, 51.108365837484584, 50.75398033112286, 51.32064772397278, 53.7639575401942, 53.65199550489585, 53.84062032649915, 52.743636174748346, 52.48986081282298, 52.673867243031665, 40.306592847531036, 39.603567396601036, 39.921656635900334, 46.10371020187934, 46.4131717433532, 46.12085663278897, 51.38877327367662, 51.42345809191464, 51.41783536225556, 55.096342287957654, 54.859771788120256, 54.913398832082734, 48.110827175279454, 47.924493966003254, 47.82315060993035, 58.83899871508281, 59.36652198682229, 59.55482254053156, 32.660916709651545, 32.13314728935559, 32.50432642300923, 47.54368256529172, 48.01271915187438, 47.63461824258168, 57.22383797541259, 56.665550306439386, 57.055524498224244, 44.11083926260471, 44.51677379012108, 44.91305563412607, 37.50762251019478, 36.25258308649063, 37.27422592043877, 49.70733264088629, 50.59270446281879, 50.524759046733365, 46.104758627402276, 46.00693754727641, 45.71465009699264, 37.87345031897226, 38.056584807733685, 38.08696730683246, 50.051131963729844, 50.44324126839636, 51.033537991344915, 44.47393950323263, 44.80299595351485, 44.69972567881146, 42.317435214916856, 42.071871044735104, 42.31923773388067, 50.09404383475582, 50.17935491042833, 50.264058046663806, 43.28802376737197, 43.50073154767354, 43.43009926130374, 47.10783874119322, 46.53740263978641, 46.40365235010783, 55.40892003476618, 55.38215412199496, 55.31126512587069, 38.38906325834492, 38.11678599069515, 37.97655201951662, 43.37947932941218, 43.30984429394205, 43.18544055273135, 47.42966167628764, 47.49793611466883, 47.69919492304324, 52.89790522679685, 53.00325837358831, 52.24543823301791, -71.97750787809491, -72.99147994816303, -81.89594047702849, 54.64251247545083, 54.63844199975331, 54.727864166100815, 56.29759498437245, 56.93720312354465, 56.94289070585121, 48.91984648754199, 48.489989077051476, 48.956692654018596, 47.44735261549552, 47.430761737128094, 47.40100285162528, 41.3212702559928, 41.44355753871301, 41.18734765301147, 42.72995390370488, 42.27268012613058, 42.185933351516724, 56.6383119771878, 57.39013247486825, 57.40764618913333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14548405996288935, "mean_inference_ms": 0.7017724725906721, "mean_action_processing_ms": 0.10150479880540195, "mean_env_wait_ms": 0.8445244427947084, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 715000, "timesteps_this_iter": 0, "agent_timesteps_total": 2145000, "timers": {"sample_time_ms": 10989.61, "sample_throughput": 454.975, "load_time_ms": 0.2, "load_throughput": 25016724.323, "learn_time_ms": 1694.197, "learn_throughput": 2951.25, "update_time_ms": 8.125}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.211690350419474e-28, "cur_lr": 0.0005000000000000001, "total_loss": 95.69636764526368, "policy_loss": 0.000542401534425263, "vf_loss": 95.77943725585938, "vf_explained_var": -0.004496955871582031, "kl": 0.011356467101749484, "entropy": 8.361660289764405, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 715000, "num_agent_steps_sampled": 2145000, "num_steps_trained": 715000, "num_agent_steps_trained": 2145000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2286, "training_iteration": 143, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-34-55", "timestamp": 1706229295, "time_this_iter_s": 11.563161849975586, "time_total_s": 1535.936419248581, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020284553DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1535.936419248581, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 7.9375, "ram_util_percent": 50.46875}}
{"episode_reward_max": 190.83517089858654, "episode_reward_min": -226.86492830328643, "episode_reward_mean": 136.77880648523157, "episode_len_mean": 498.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.89594047702849}, "policy_reward_max": {"shared_policy": 64.02163578942417}, "policy_reward_mean": {"shared_policy": 45.59293549507721}, "custom_metrics": {}, "hist_stats": {"episode_reward": [143.54428117815385, 126.67682002298534, 151.51519706286476, 132.22980724740773, 134.61968480050575, 140.59594114753423, 138.87369583174586, 186.43213457905205, 121.60968893242534, 144.36690459027872, 114.64727322757244, 143.2121422626077, 134.77122410945572, 168.43142340332275, 116.83629297791049, 134.07892413437366, 152.0999465547502, 133.69028533995163, 148.90123263746517, 109.4145684428513, 131.1695353649555, 144.49010072275993, 121.57590840384361, 142.23299851268519, 142.1129876542837, 132.27335551939905, 154.388396619819, 118.36822646856305, 133.9272874705494, 112.34253245149736, 136.71871903538715, 139.72509447857726, 133.5783370379359, 135.80723135918373, 134.61743038520225, 110.5748792318627, 148.43431965634238, 162.00468191877013, 132.78854495286947, 127.25103873759508, 127.05917110294102, 155.69575847685326, 116.47335912100971, 151.5658366382123, 126.57313235104083, 132.66780219692737, 155.34198004007314, 145.48703280091286, 130.14545645937324, 120.98661836795506, 135.42721158714264, 116.40718443319201, 123.97540933173148, 164.40441876649834, 153.18299389258027, 161.25657337158907, 157.9073642306031, 119.8318168800324, 138.63773857802119, 154.2300667278467, 164.8695129081607, 143.8584717512129, 177.76034324243673, 97.29839042201637, 143.19101995974782, 170.94491278007618, 133.54066868685192, 111.03443151712418, 150.8247961504388, 137.82634627167093, 114.01700243353841, 151.527911223471, 133.976661135559, 126.70854399353263, 150.53745679184806, 130.2188545763492, 140.0488937310875, 166.1023392826317, 114.48240126855669, 129.8747641760856, 142.6267927139994, 158.14660183340294, -226.86492830328643, 164.00881864130477, 170.17768881376816, 146.36652821861207, 142.27911720424882, 123.95217544771728, 127.18856738135219, 171.43609064118928, 125.35414229438173, 126.8464468810707, 132.57077575754374, 181.29264631867383, 121.30729546397924, 172.02443401515478, 154.62756038270905, 144.57198004052006, 162.30302175600096, 190.83517089858654], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 380, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [47.426117469867066, 47.86685637881358, 48.25130732947339, 42.08851058036089, 42.35978149808943, 42.22852794453502, 50.54460771630208, 50.45295845965545, 50.517630886907384, 44.36620407768835, 43.874492091437176, 43.98911107828219, 44.938242362191275, 44.81550933917363, 44.86593309914072, 46.57575550675391, 46.814756795763955, 47.20542884501627, 46.12462545682986, 46.167734665175274, 46.58133570974071, 62.434312388106875, 61.632018471757576, 62.36580371918778, 40.88584749621805, 40.479427345097065, 40.24441409111023, 48.032761973639325, 48.17073072617252, 48.163411890467, 38.13637422770262, 38.58439268916845, 37.92650631070137, 47.364173839489624, 47.89316003272931, 47.95480839038889, 44.746978806952626, 45.22601339283088, 44.79823190967241, 56.27039311577876, 56.11205270638068, 56.04897758116324, 38.80494204163551, 38.751846224069595, 39.27950471220538, 44.824269178013, 44.850416394571454, 44.404238561789185, 50.655308000743375, 50.894599396735416, 50.55003915727137, 44.71815474083026, 44.436328818400696, 44.53580178072055, 49.348284890254334, 49.8839958657821, 49.668951881428555, 36.61595359817147, 36.41477359831333, 36.3838412463665, 43.71285019318262, 44.13924384738007, 43.317441324392945, 48.4456364872555, 48.28824522594611, 47.756219009558365, 40.91928308332959, 40.66561080018678, 39.99101452032724, 47.10684727132319, 47.55172225832938, 47.57442898303269, 47.17028537392615, 47.24485037475823, 47.69785190559922, 44.12607066084941, 44.32846336377163, 43.81882149477799, 51.72022993707408, 51.05877504249413, 51.60939164025088, 39.40349944929281, 40.01700141529241, 38.94772560397783, 44.67917489260435, 44.24793376028538, 45.00017881765962, 37.0356663117806, 37.62000099165985, 37.68686514805691, 45.2772834499677, 45.73370149110754, 45.70773409431179, 46.59106447796026, 46.653273491809756, 46.48075650880733, 44.17932781328757, 44.65895430122812, 44.740054923420146, 45.76600206146637, 45.257982472578675, 44.78324682513872, 44.93411903704205, 44.885577293733746, 44.79773405442634, 37.027180070678384, 37.12905658564219, 36.41864257554212, 49.222302074233696, 49.51319777468841, 49.69881980742018, 53.8964541008075, 53.979886186619595, 54.12834163134296, 44.378354767958314, 44.09376359979311, 44.316426585117966, 42.460985258221626, 42.44971890002489, 42.340334579348564, 42.44174127032359, 42.25538183500369, 42.36204799761374, 51.64542779823144, 51.85870923598607, 52.19162144263585, 38.51335696876049, 39.089715061709285, 38.87028709053993, 50.56380116939543, 50.398342885076985, 50.60369258373974, 42.074102361996964, 42.11594884594281, 42.38308114310105, 43.82323596378167, 44.719211982873574, 44.12535425027211, 51.757748819887624, 51.70019099861382, 51.88404022157191, 48.50537588447331, 48.461054801940904, 48.5206021144986, 43.47743665302792, 43.54151702920595, 43.126502777139336, 40.01474691430727, 40.30201269189516, 40.669858761752636, 45.03659726306796, 45.120624613016844, 45.26998971105786, 38.98031169548631, 38.74365217983723, 38.68322055786848, 41.00857112308343, 41.36865414430697, 41.59818406434108, 54.825688252846405, 54.750716226796314, 54.82801428685586, 51.108365837484584, 50.75398033112286, 51.32064772397278, 53.7639575401942, 53.65199550489585, 53.84062032649915, 52.743636174748346, 52.48986081282298, 52.673867243031665, 40.306592847531036, 39.603567396601036, 39.921656635900334, 46.10371020187934, 46.4131717433532, 46.12085663278897, 51.38877327367662, 51.42345809191464, 51.41783536225556, 55.096342287957654, 54.859771788120256, 54.913398832082734, 48.110827175279454, 47.924493966003254, 47.82315060993035, 58.83899871508281, 59.36652198682229, 59.55482254053156, 32.660916709651545, 32.13314728935559, 32.50432642300923, 47.54368256529172, 48.01271915187438, 47.63461824258168, 57.22383797541259, 56.665550306439386, 57.055524498224244, 44.11083926260471, 44.51677379012108, 44.91305563412607, 37.50762251019478, 36.25258308649063, 37.27422592043877, 49.70733264088629, 50.59270446281879, 50.524759046733365, 46.104758627402276, 46.00693754727641, 45.71465009699264, 37.87345031897226, 38.056584807733685, 38.08696730683246, 50.051131963729844, 50.44324126839636, 51.033537991344915, 44.47393950323263, 44.80299595351485, 44.69972567881146, 42.317435214916856, 42.071871044735104, 42.31923773388067, 50.09404383475582, 50.17935491042833, 50.264058046663806, 43.28802376737197, 43.50073154767354, 43.43009926130374, 47.10783874119322, 46.53740263978641, 46.40365235010783, 55.40892003476618, 55.38215412199496, 55.31126512587069, 38.38906325834492, 38.11678599069515, 37.97655201951662, 43.37947932941218, 43.30984429394205, 43.18544055273135, 47.42966167628764, 47.49793611466883, 47.69919492304324, 52.89790522679685, 53.00325837358831, 52.24543823301791, -71.97750787809491, -72.99147994816303, -81.89594047702849, 54.64251247545083, 54.63844199975331, 54.727864166100815, 56.29759498437245, 56.93720312354465, 56.94289070585121, 48.91984648754199, 48.489989077051476, 48.956692654018596, 47.44735261549552, 47.430761737128094, 47.40100285162528, 41.3212702559928, 41.44355753871301, 41.18734765301147, 42.72995390370488, 42.27268012613058, 42.185933351516724, 56.6383119771878, 57.39013247486825, 57.40764618913333, 41.489351143439606, 41.87220453595121, 41.99258661499091, 42.672664616877825, 42.52480679253736, 41.64897547165552, 44.38697586487979, 43.974721275269985, 44.20907861739397, 60.612815387547, 60.15649884194134, 60.5233320891857, 40.70695814862847, 39.976881474256516, 40.623455841094255, 57.198360050717994, 57.191661531726524, 57.634412432710334, 51.94278974893193, 51.458982656399414, 51.22578797737758, 47.81853637595971, 47.928301607569054, 48.82514205699165, 53.49255229532717, 54.21829096227883, 54.59217849839477, 62.97435921430586, 64.02163578942417, 63.83917589485644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14554473747063976, "mean_inference_ms": 0.7021397690306429, "mean_action_processing_ms": 0.10151311391384056, "mean_env_wait_ms": 0.8445807170260422, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 720000, "timesteps_this_iter": 0, "agent_timesteps_total": 2160000, "timers": {"sample_time_ms": 11085.839, "sample_throughput": 451.026, "load_time_ms": 0.2, "load_throughput": 25016724.323, "learn_time_ms": 1694.311, "learn_throughput": 2951.052, "update_time_ms": 8.226}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.211690350419474e-28, "cur_lr": 0.0005000000000000001, "total_loss": 10.746698093414306, "policy_loss": -0.0011969388323761377, "vf_loss": 10.832272148132324, "vf_explained_var": 0.0023763537406921386, "kl": 0.0033394955215312085, "entropy": 8.437729454040527, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 720000, "num_agent_steps_sampled": 2160000, "num_steps_trained": 720000, "num_agent_steps_trained": 2160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2296, "training_iteration": 144, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-35-06", "timestamp": 1706229306, "time_this_iter_s": 10.9192636013031, "time_total_s": 1546.855682849884, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202821C6700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1546.855682849884, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 9.643749999999999, "ram_util_percent": 50.49375}}
{"episode_reward_max": 190.83517089858654, "episode_reward_min": -226.86492830328643, "episode_reward_mean": 137.75366226501046, "episode_len_mean": 498.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.89594047702849}, "policy_reward_max": {"shared_policy": 64.02163578942417}, "policy_reward_mean": {"shared_policy": 45.917887421670166}, "custom_metrics": {}, "hist_stats": {"episode_reward": [114.64727322757244, 143.2121422626077, 134.77122410945572, 168.43142340332275, 116.83629297791049, 134.07892413437366, 152.0999465547502, 133.69028533995163, 148.90123263746517, 109.4145684428513, 131.1695353649555, 144.49010072275993, 121.57590840384361, 142.23299851268519, 142.1129876542837, 132.27335551939905, 154.388396619819, 118.36822646856305, 133.9272874705494, 112.34253245149736, 136.71871903538715, 139.72509447857726, 133.5783370379359, 135.80723135918373, 134.61743038520225, 110.5748792318627, 148.43431965634238, 162.00468191877013, 132.78854495286947, 127.25103873759508, 127.05917110294102, 155.69575847685326, 116.47335912100971, 151.5658366382123, 126.57313235104083, 132.66780219692737, 155.34198004007314, 145.48703280091286, 130.14545645937324, 120.98661836795506, 135.42721158714264, 116.40718443319201, 123.97540933173148, 164.40441876649834, 153.18299389258027, 161.25657337158907, 157.9073642306031, 119.8318168800324, 138.63773857802119, 154.2300667278467, 164.8695129081607, 143.8584717512129, 177.76034324243673, 97.29839042201637, 143.19101995974782, 170.94491278007618, 133.54066868685192, 111.03443151712418, 150.8247961504388, 137.82634627167093, 114.01700243353841, 151.527911223471, 133.976661135559, 126.70854399353263, 150.53745679184806, 130.2188545763492, 140.0488937310875, 166.1023392826317, 114.48240126855669, 129.8747641760856, 142.6267927139994, 158.14660183340294, -226.86492830328643, 164.00881864130477, 170.17768881376816, 146.36652821861207, 142.27911720424882, 123.95217544771728, 127.18856738135219, 171.43609064118928, 125.35414229438173, 126.8464468810707, 132.57077575754374, 181.29264631867383, 121.30729546397924, 172.02443401515478, 154.62756038270905, 144.57198004052006, 162.30302175600096, 190.83517089858654, 120.32852266915143, 189.736801698091, 163.5073192827406, 173.05772858549625, 134.21570397354665, 137.86460843309737, 166.26278215087953, 139.4403836987915, 160.70424660295257, 132.831636276096], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 380, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [38.13637422770262, 38.58439268916845, 37.92650631070137, 47.364173839489624, 47.89316003272931, 47.95480839038889, 44.746978806952626, 45.22601339283088, 44.79823190967241, 56.27039311577876, 56.11205270638068, 56.04897758116324, 38.80494204163551, 38.751846224069595, 39.27950471220538, 44.824269178013, 44.850416394571454, 44.404238561789185, 50.655308000743375, 50.894599396735416, 50.55003915727137, 44.71815474083026, 44.436328818400696, 44.53580178072055, 49.348284890254334, 49.8839958657821, 49.668951881428555, 36.61595359817147, 36.41477359831333, 36.3838412463665, 43.71285019318262, 44.13924384738007, 43.317441324392945, 48.4456364872555, 48.28824522594611, 47.756219009558365, 40.91928308332959, 40.66561080018678, 39.99101452032724, 47.10684727132319, 47.55172225832938, 47.57442898303269, 47.17028537392615, 47.24485037475823, 47.69785190559922, 44.12607066084941, 44.32846336377163, 43.81882149477799, 51.72022993707408, 51.05877504249413, 51.60939164025088, 39.40349944929281, 40.01700141529241, 38.94772560397783, 44.67917489260435, 44.24793376028538, 45.00017881765962, 37.0356663117806, 37.62000099165985, 37.68686514805691, 45.2772834499677, 45.73370149110754, 45.70773409431179, 46.59106447796026, 46.653273491809756, 46.48075650880733, 44.17932781328757, 44.65895430122812, 44.740054923420146, 45.76600206146637, 45.257982472578675, 44.78324682513872, 44.93411903704205, 44.885577293733746, 44.79773405442634, 37.027180070678384, 37.12905658564219, 36.41864257554212, 49.222302074233696, 49.51319777468841, 49.69881980742018, 53.8964541008075, 53.979886186619595, 54.12834163134296, 44.378354767958314, 44.09376359979311, 44.316426585117966, 42.460985258221626, 42.44971890002489, 42.340334579348564, 42.44174127032359, 42.25538183500369, 42.36204799761374, 51.64542779823144, 51.85870923598607, 52.19162144263585, 38.51335696876049, 39.089715061709285, 38.87028709053993, 50.56380116939543, 50.398342885076985, 50.60369258373974, 42.074102361996964, 42.11594884594281, 42.38308114310105, 43.82323596378167, 44.719211982873574, 44.12535425027211, 51.757748819887624, 51.70019099861382, 51.88404022157191, 48.50537588447331, 48.461054801940904, 48.5206021144986, 43.47743665302792, 43.54151702920595, 43.126502777139336, 40.01474691430727, 40.30201269189516, 40.669858761752636, 45.03659726306796, 45.120624613016844, 45.26998971105786, 38.98031169548631, 38.74365217983723, 38.68322055786848, 41.00857112308343, 41.36865414430697, 41.59818406434108, 54.825688252846405, 54.750716226796314, 54.82801428685586, 51.108365837484584, 50.75398033112286, 51.32064772397278, 53.7639575401942, 53.65199550489585, 53.84062032649915, 52.743636174748346, 52.48986081282298, 52.673867243031665, 40.306592847531036, 39.603567396601036, 39.921656635900334, 46.10371020187934, 46.4131717433532, 46.12085663278897, 51.38877327367662, 51.42345809191464, 51.41783536225556, 55.096342287957654, 54.859771788120256, 54.913398832082734, 48.110827175279454, 47.924493966003254, 47.82315060993035, 58.83899871508281, 59.36652198682229, 59.55482254053156, 32.660916709651545, 32.13314728935559, 32.50432642300923, 47.54368256529172, 48.01271915187438, 47.63461824258168, 57.22383797541259, 56.665550306439386, 57.055524498224244, 44.11083926260471, 44.51677379012108, 44.91305563412607, 37.50762251019478, 36.25258308649063, 37.27422592043877, 49.70733264088629, 50.59270446281879, 50.524759046733365, 46.104758627402276, 46.00693754727641, 45.71465009699264, 37.87345031897226, 38.056584807733685, 38.08696730683246, 50.051131963729844, 50.44324126839636, 51.033537991344915, 44.47393950323263, 44.80299595351485, 44.69972567881146, 42.317435214916856, 42.071871044735104, 42.31923773388067, 50.09404383475582, 50.17935491042833, 50.264058046663806, 43.28802376737197, 43.50073154767354, 43.43009926130374, 47.10783874119322, 46.53740263978641, 46.40365235010783, 55.40892003476618, 55.38215412199496, 55.31126512587069, 38.38906325834492, 38.11678599069515, 37.97655201951662, 43.37947932941218, 43.30984429394205, 43.18544055273135, 47.42966167628764, 47.49793611466883, 47.69919492304324, 52.89790522679685, 53.00325837358831, 52.24543823301791, -71.97750787809491, -72.99147994816303, -81.89594047702849, 54.64251247545083, 54.63844199975331, 54.727864166100815, 56.29759498437245, 56.93720312354465, 56.94289070585121, 48.91984648754199, 48.489989077051476, 48.956692654018596, 47.44735261549552, 47.430761737128094, 47.40100285162528, 41.3212702559928, 41.44355753871301, 41.18734765301147, 42.72995390370488, 42.27268012613058, 42.185933351516724, 56.6383119771878, 57.39013247486825, 57.40764618913333, 41.489351143439606, 41.87220453595121, 41.99258661499091, 42.672664616877825, 42.52480679253736, 41.64897547165552, 44.38697586487979, 43.974721275269985, 44.20907861739397, 60.612815387547, 60.15649884194134, 60.5233320891857, 40.70695814862847, 39.976881474256516, 40.623455841094255, 57.198360050717994, 57.191661531726524, 57.634412432710334, 51.94278974893193, 51.458982656399414, 51.22578797737758, 47.81853637595971, 47.928301607569054, 48.82514205699165, 53.49255229532717, 54.21829096227883, 54.59217849839477, 62.97435921430586, 64.02163578942417, 63.83917589485644, 39.913124442100525, 40.17405027523637, 40.24134795181453, 62.81302260855834, 63.249348501364395, 63.674430588168136, 54.406044242282704, 54.5368241717418, 54.56445086871584, 57.68005047428112, 57.56947244952123, 57.80820566169375, 44.78189635835588, 44.64324655756354, 44.7905610576272, 44.96340624491373, 46.57584834347168, 46.32535384471217, 55.358789401749775, 55.34476174662511, 55.55923100250463, 46.42989966770013, 46.536739112188414, 46.47374491890271, 53.54748492191236, 53.57187976191442, 53.58488191912572, 44.3212786813577, 44.1401903082927, 44.37016728644569]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14561187557994773, "mean_inference_ms": 0.7025458324999359, "mean_action_processing_ms": 0.10152613698344032, "mean_env_wait_ms": 0.8446639994042775, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 725000, "timesteps_this_iter": 0, "agent_timesteps_total": 2175000, "timers": {"sample_time_ms": 11139.645, "sample_throughput": 448.847, "load_time_ms": 0.199, "load_throughput": 25082549.934, "learn_time_ms": 1690.449, "learn_throughput": 2957.794, "update_time_ms": 8.224}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.05845175209737e-29, "cur_lr": 0.0005000000000000001, "total_loss": 7.648252487182617, "policy_loss": 0.0014919079528900258, "vf_loss": 7.7333272933959964, "vf_explained_var": 0.008463919162750244, "kl": 0.006937907973799684, "entropy": 8.656671619415283, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 725000, "num_agent_steps_sampled": 2175000, "num_steps_trained": 725000, "num_agent_steps_trained": 2175000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2306, "training_iteration": 145, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-35-17", "timestamp": 1706229317, "time_this_iter_s": 10.668186902999878, "time_total_s": 1557.523869752884, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202845CE3A0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1557.523869752884, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 9.466666666666667, "ram_util_percent": 50.57333333333334}}
{"episode_reward_max": 190.83517089858654, "episode_reward_min": -226.86492830328643, "episode_reward_mean": 139.02104600401228, "episode_len_mean": 498.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.89594047702849}, "policy_reward_max": {"shared_policy": 64.02163578942417}, "policy_reward_mean": {"shared_policy": 46.34034866800409}, "custom_metrics": {}, "hist_stats": {"episode_reward": [131.1695353649555, 144.49010072275993, 121.57590840384361, 142.23299851268519, 142.1129876542837, 132.27335551939905, 154.388396619819, 118.36822646856305, 133.9272874705494, 112.34253245149736, 136.71871903538715, 139.72509447857726, 133.5783370379359, 135.80723135918373, 134.61743038520225, 110.5748792318627, 148.43431965634238, 162.00468191877013, 132.78854495286947, 127.25103873759508, 127.05917110294102, 155.69575847685326, 116.47335912100971, 151.5658366382123, 126.57313235104083, 132.66780219692737, 155.34198004007314, 145.48703280091286, 130.14545645937324, 120.98661836795506, 135.42721158714264, 116.40718443319201, 123.97540933173148, 164.40441876649834, 153.18299389258027, 161.25657337158907, 157.9073642306031, 119.8318168800324, 138.63773857802119, 154.2300667278467, 164.8695129081607, 143.8584717512129, 177.76034324243673, 97.29839042201637, 143.19101995974782, 170.94491278007618, 133.54066868685192, 111.03443151712418, 150.8247961504388, 137.82634627167093, 114.01700243353841, 151.527911223471, 133.976661135559, 126.70854399353263, 150.53745679184806, 130.2188545763492, 140.0488937310875, 166.1023392826317, 114.48240126855669, 129.8747641760856, 142.6267927139994, 158.14660183340294, -226.86492830328643, 164.00881864130477, 170.17768881376816, 146.36652821861207, 142.27911720424882, 123.95217544771728, 127.18856738135219, 171.43609064118928, 125.35414229438173, 126.8464468810707, 132.57077575754374, 181.29264631867383, 121.30729546397924, 172.02443401515478, 154.62756038270905, 144.57198004052006, 162.30302175600096, 190.83517089858654, 120.32852266915143, 189.736801698091, 163.5073192827406, 173.05772858549625, 134.21570397354665, 137.86460843309737, 166.26278215087953, 139.4403836987915, 160.70424660295257, 132.831636276096, 144.22866804897788, 138.85884294658922, 118.23865871876478, 171.9425156861546, 141.23024947557136, 145.6387950167989, 183.23568604467408, 146.47452440112866, 136.04299007914938, 156.93075657263378], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 380, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [43.71285019318262, 44.13924384738007, 43.317441324392945, 48.4456364872555, 48.28824522594611, 47.756219009558365, 40.91928308332959, 40.66561080018678, 39.99101452032724, 47.10684727132319, 47.55172225832938, 47.57442898303269, 47.17028537392615, 47.24485037475823, 47.69785190559922, 44.12607066084941, 44.32846336377163, 43.81882149477799, 51.72022993707408, 51.05877504249413, 51.60939164025088, 39.40349944929281, 40.01700141529241, 38.94772560397783, 44.67917489260435, 44.24793376028538, 45.00017881765962, 37.0356663117806, 37.62000099165985, 37.68686514805691, 45.2772834499677, 45.73370149110754, 45.70773409431179, 46.59106447796026, 46.653273491809756, 46.48075650880733, 44.17932781328757, 44.65895430122812, 44.740054923420146, 45.76600206146637, 45.257982472578675, 44.78324682513872, 44.93411903704205, 44.885577293733746, 44.79773405442634, 37.027180070678384, 37.12905658564219, 36.41864257554212, 49.222302074233696, 49.51319777468841, 49.69881980742018, 53.8964541008075, 53.979886186619595, 54.12834163134296, 44.378354767958314, 44.09376359979311, 44.316426585117966, 42.460985258221626, 42.44971890002489, 42.340334579348564, 42.44174127032359, 42.25538183500369, 42.36204799761374, 51.64542779823144, 51.85870923598607, 52.19162144263585, 38.51335696876049, 39.089715061709285, 38.87028709053993, 50.56380116939543, 50.398342885076985, 50.60369258373974, 42.074102361996964, 42.11594884594281, 42.38308114310105, 43.82323596378167, 44.719211982873574, 44.12535425027211, 51.757748819887624, 51.70019099861382, 51.88404022157191, 48.50537588447331, 48.461054801940904, 48.5206021144986, 43.47743665302792, 43.54151702920595, 43.126502777139336, 40.01474691430727, 40.30201269189516, 40.669858761752636, 45.03659726306796, 45.120624613016844, 45.26998971105786, 38.98031169548631, 38.74365217983723, 38.68322055786848, 41.00857112308343, 41.36865414430697, 41.59818406434108, 54.825688252846405, 54.750716226796314, 54.82801428685586, 51.108365837484584, 50.75398033112286, 51.32064772397278, 53.7639575401942, 53.65199550489585, 53.84062032649915, 52.743636174748346, 52.48986081282298, 52.673867243031665, 40.306592847531036, 39.603567396601036, 39.921656635900334, 46.10371020187934, 46.4131717433532, 46.12085663278897, 51.38877327367662, 51.42345809191464, 51.41783536225556, 55.096342287957654, 54.859771788120256, 54.913398832082734, 48.110827175279454, 47.924493966003254, 47.82315060993035, 58.83899871508281, 59.36652198682229, 59.55482254053156, 32.660916709651545, 32.13314728935559, 32.50432642300923, 47.54368256529172, 48.01271915187438, 47.63461824258168, 57.22383797541259, 56.665550306439386, 57.055524498224244, 44.11083926260471, 44.51677379012108, 44.91305563412607, 37.50762251019478, 36.25258308649063, 37.27422592043877, 49.70733264088629, 50.59270446281879, 50.524759046733365, 46.104758627402276, 46.00693754727641, 45.71465009699264, 37.87345031897226, 38.056584807733685, 38.08696730683246, 50.051131963729844, 50.44324126839636, 51.033537991344915, 44.47393950323263, 44.80299595351485, 44.69972567881146, 42.317435214916856, 42.071871044735104, 42.31923773388067, 50.09404383475582, 50.17935491042833, 50.264058046663806, 43.28802376737197, 43.50073154767354, 43.43009926130374, 47.10783874119322, 46.53740263978641, 46.40365235010783, 55.40892003476618, 55.38215412199496, 55.31126512587069, 38.38906325834492, 38.11678599069515, 37.97655201951662, 43.37947932941218, 43.30984429394205, 43.18544055273135, 47.42966167628764, 47.49793611466883, 47.69919492304324, 52.89790522679685, 53.00325837358831, 52.24543823301791, -71.97750787809491, -72.99147994816303, -81.89594047702849, 54.64251247545083, 54.63844199975331, 54.727864166100815, 56.29759498437245, 56.93720312354465, 56.94289070585121, 48.91984648754199, 48.489989077051476, 48.956692654018596, 47.44735261549552, 47.430761737128094, 47.40100285162528, 41.3212702559928, 41.44355753871301, 41.18734765301147, 42.72995390370488, 42.27268012613058, 42.185933351516724, 56.6383119771878, 57.39013247486825, 57.40764618913333, 41.489351143439606, 41.87220453595121, 41.99258661499091, 42.672664616877825, 42.52480679253736, 41.64897547165552, 44.38697586487979, 43.974721275269985, 44.20907861739397, 60.612815387547, 60.15649884194134, 60.5233320891857, 40.70695814862847, 39.976881474256516, 40.623455841094255, 57.198360050717994, 57.191661531726524, 57.634412432710334, 51.94278974893193, 51.458982656399414, 51.22578797737758, 47.81853637595971, 47.928301607569054, 48.82514205699165, 53.49255229532717, 54.21829096227883, 54.59217849839477, 62.97435921430586, 64.02163578942417, 63.83917589485644, 39.913124442100525, 40.17405027523637, 40.24134795181453, 62.81302260855834, 63.249348501364395, 63.674430588168136, 54.406044242282704, 54.5368241717418, 54.56445086871584, 57.68005047428112, 57.56947244952123, 57.80820566169375, 44.78189635835588, 44.64324655756354, 44.7905610576272, 44.96340624491373, 46.57584834347168, 46.32535384471217, 55.358789401749775, 55.34476174662511, 55.55923100250463, 46.42989966770013, 46.536739112188414, 46.47374491890271, 53.54748492191236, 53.57187976191442, 53.58488191912572, 44.3212786813577, 44.1401903082927, 44.37016728644569, 47.963549452523395, 48.09400855998199, 48.171110036472484, 46.146468602120876, 46.34365360066295, 46.36872074380517, 39.31776199489832, 39.329022876918316, 39.59187384694815, 57.528083751599, 57.24685350308816, 57.16757843146722, 47.28858834120909, 46.686551131308065, 47.25511000305413, 48.47852257204552, 48.587622725249574, 48.572649719504014, 60.747079789638505, 61.390312354546026, 61.09829390048979, 49.067599425713226, 48.62533713380496, 48.78158784161012, 45.286146129171044, 45.850876436258346, 44.905967513720185, 52.57667487611373, 51.85989098747571, 52.49419070904453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14569081768210776, "mean_inference_ms": 0.7029805199752309, "mean_action_processing_ms": 0.10154922052935156, "mean_env_wait_ms": 0.8447656781808149, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 730000, "timesteps_this_iter": 0, "agent_timesteps_total": 2190000, "timers": {"sample_time_ms": 11186.527, "sample_throughput": 446.966, "load_time_ms": 0.199, "load_throughput": 25082549.934, "learn_time_ms": 1678.142, "learn_throughput": 2979.485, "update_time_ms": 8.138}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.05845175209737e-29, "cur_lr": 0.0005000000000000001, "total_loss": 9.950289726257324, "policy_loss": -0.0007277345595383622, "vf_loss": 10.034925079345703, "vf_explained_var": 0.004221087694168091, "kl": 0.005700709903639714, "entropy": 8.390755558013916, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 730000, "num_agent_steps_sampled": 2190000, "num_steps_trained": 730000, "num_agent_steps_trained": 2190000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2316, "training_iteration": 146, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-35-28", "timestamp": 1706229328, "time_this_iter_s": 10.847959756851196, "time_total_s": 1568.371829509735, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282490C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1568.371829509735, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 10.76666666666667, "ram_util_percent": 50.52}}
{"episode_reward_max": 190.83517089858654, "episode_reward_min": -226.86492830328643, "episode_reward_mean": 140.81589818610675, "episode_len_mean": 498.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.89594047702849}, "policy_reward_max": {"shared_policy": 64.02163578942417}, "policy_reward_mean": {"shared_policy": 46.93863272870226}, "custom_metrics": {}, "hist_stats": {"episode_reward": [136.71871903538715, 139.72509447857726, 133.5783370379359, 135.80723135918373, 134.61743038520225, 110.5748792318627, 148.43431965634238, 162.00468191877013, 132.78854495286947, 127.25103873759508, 127.05917110294102, 155.69575847685326, 116.47335912100971, 151.5658366382123, 126.57313235104083, 132.66780219692737, 155.34198004007314, 145.48703280091286, 130.14545645937324, 120.98661836795506, 135.42721158714264, 116.40718443319201, 123.97540933173148, 164.40441876649834, 153.18299389258027, 161.25657337158907, 157.9073642306031, 119.8318168800324, 138.63773857802119, 154.2300667278467, 164.8695129081607, 143.8584717512129, 177.76034324243673, 97.29839042201637, 143.19101995974782, 170.94491278007618, 133.54066868685192, 111.03443151712418, 150.8247961504388, 137.82634627167093, 114.01700243353841, 151.527911223471, 133.976661135559, 126.70854399353263, 150.53745679184806, 130.2188545763492, 140.0488937310875, 166.1023392826317, 114.48240126855669, 129.8747641760856, 142.6267927139994, 158.14660183340294, -226.86492830328643, 164.00881864130477, 170.17768881376816, 146.36652821861207, 142.27911720424882, 123.95217544771728, 127.18856738135219, 171.43609064118928, 125.35414229438173, 126.8464468810707, 132.57077575754374, 181.29264631867383, 121.30729546397924, 172.02443401515478, 154.62756038270905, 144.57198004052006, 162.30302175600096, 190.83517089858654, 120.32852266915143, 189.736801698091, 163.5073192827406, 173.05772858549625, 134.21570397354665, 137.86460843309737, 166.26278215087953, 139.4403836987915, 160.70424660295257, 132.831636276096, 144.22866804897788, 138.85884294658922, 118.23865871876478, 171.9425156861546, 141.23024947557136, 145.6387950167989, 183.23568604467408, 146.47452440112866, 136.04299007914938, 156.93075657263378, 151.88124284893277, 147.70007305592281, 151.25925552472484, 150.97883236315087, 149.67422686517224, 138.83259011805083, 154.10413919761777, 158.15169725567117, 175.65638051973636, 134.12810964882345], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 380, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [45.2772834499677, 45.73370149110754, 45.70773409431179, 46.59106447796026, 46.653273491809756, 46.48075650880733, 44.17932781328757, 44.65895430122812, 44.740054923420146, 45.76600206146637, 45.257982472578675, 44.78324682513872, 44.93411903704205, 44.885577293733746, 44.79773405442634, 37.027180070678384, 37.12905658564219, 36.41864257554212, 49.222302074233696, 49.51319777468841, 49.69881980742018, 53.8964541008075, 53.979886186619595, 54.12834163134296, 44.378354767958314, 44.09376359979311, 44.316426585117966, 42.460985258221626, 42.44971890002489, 42.340334579348564, 42.44174127032359, 42.25538183500369, 42.36204799761374, 51.64542779823144, 51.85870923598607, 52.19162144263585, 38.51335696876049, 39.089715061709285, 38.87028709053993, 50.56380116939543, 50.398342885076985, 50.60369258373974, 42.074102361996964, 42.11594884594281, 42.38308114310105, 43.82323596378167, 44.719211982873574, 44.12535425027211, 51.757748819887624, 51.70019099861382, 51.88404022157191, 48.50537588447331, 48.461054801940904, 48.5206021144986, 43.47743665302792, 43.54151702920595, 43.126502777139336, 40.01474691430727, 40.30201269189516, 40.669858761752636, 45.03659726306796, 45.120624613016844, 45.26998971105786, 38.98031169548631, 38.74365217983723, 38.68322055786848, 41.00857112308343, 41.36865414430697, 41.59818406434108, 54.825688252846405, 54.750716226796314, 54.82801428685586, 51.108365837484584, 50.75398033112286, 51.32064772397278, 53.7639575401942, 53.65199550489585, 53.84062032649915, 52.743636174748346, 52.48986081282298, 52.673867243031665, 40.306592847531036, 39.603567396601036, 39.921656635900334, 46.10371020187934, 46.4131717433532, 46.12085663278897, 51.38877327367662, 51.42345809191464, 51.41783536225556, 55.096342287957654, 54.859771788120256, 54.913398832082734, 48.110827175279454, 47.924493966003254, 47.82315060993035, 58.83899871508281, 59.36652198682229, 59.55482254053156, 32.660916709651545, 32.13314728935559, 32.50432642300923, 47.54368256529172, 48.01271915187438, 47.63461824258168, 57.22383797541259, 56.665550306439386, 57.055524498224244, 44.11083926260471, 44.51677379012108, 44.91305563412607, 37.50762251019478, 36.25258308649063, 37.27422592043877, 49.70733264088629, 50.59270446281879, 50.524759046733365, 46.104758627402276, 46.00693754727641, 45.71465009699264, 37.87345031897226, 38.056584807733685, 38.08696730683246, 50.051131963729844, 50.44324126839636, 51.033537991344915, 44.47393950323263, 44.80299595351485, 44.69972567881146, 42.317435214916856, 42.071871044735104, 42.31923773388067, 50.09404383475582, 50.17935491042833, 50.264058046663806, 43.28802376737197, 43.50073154767354, 43.43009926130374, 47.10783874119322, 46.53740263978641, 46.40365235010783, 55.40892003476618, 55.38215412199496, 55.31126512587069, 38.38906325834492, 38.11678599069515, 37.97655201951662, 43.37947932941218, 43.30984429394205, 43.18544055273135, 47.42966167628764, 47.49793611466883, 47.69919492304324, 52.89790522679685, 53.00325837358831, 52.24543823301791, -71.97750787809491, -72.99147994816303, -81.89594047702849, 54.64251247545083, 54.63844199975331, 54.727864166100815, 56.29759498437245, 56.93720312354465, 56.94289070585121, 48.91984648754199, 48.489989077051476, 48.956692654018596, 47.44735261549552, 47.430761737128094, 47.40100285162528, 41.3212702559928, 41.44355753871301, 41.18734765301147, 42.72995390370488, 42.27268012613058, 42.185933351516724, 56.6383119771878, 57.39013247486825, 57.40764618913333, 41.489351143439606, 41.87220453595121, 41.99258661499091, 42.672664616877825, 42.52480679253736, 41.64897547165552, 44.38697586487979, 43.974721275269985, 44.20907861739397, 60.612815387547, 60.15649884194134, 60.5233320891857, 40.70695814862847, 39.976881474256516, 40.623455841094255, 57.198360050717994, 57.191661531726524, 57.634412432710334, 51.94278974893193, 51.458982656399414, 51.22578797737758, 47.81853637595971, 47.928301607569054, 48.82514205699165, 53.49255229532717, 54.21829096227883, 54.59217849839477, 62.97435921430586, 64.02163578942417, 63.83917589485644, 39.913124442100525, 40.17405027523637, 40.24134795181453, 62.81302260855834, 63.249348501364395, 63.674430588168136, 54.406044242282704, 54.5368241717418, 54.56445086871584, 57.68005047428112, 57.56947244952123, 57.80820566169375, 44.78189635835588, 44.64324655756354, 44.7905610576272, 44.96340624491373, 46.57584834347168, 46.32535384471217, 55.358789401749775, 55.34476174662511, 55.55923100250463, 46.42989966770013, 46.536739112188414, 46.47374491890271, 53.54748492191236, 53.57187976191442, 53.58488191912572, 44.3212786813577, 44.1401903082927, 44.37016728644569, 47.963549452523395, 48.09400855998199, 48.171110036472484, 46.146468602120876, 46.34365360066295, 46.36872074380517, 39.31776199489832, 39.329022876918316, 39.59187384694815, 57.528083751599, 57.24685350308816, 57.16757843146722, 47.28858834120909, 46.686551131308065, 47.25511000305413, 48.47852257204552, 48.587622725249574, 48.572649719504014, 60.747079789638505, 61.390312354546026, 61.09829390048979, 49.067599425713226, 48.62533713380496, 48.78158784161012, 45.286146129171044, 45.850876436258346, 44.905967513720185, 52.57667487611373, 51.85989098747571, 52.49419070904453, 50.195348948240266, 50.789324227720485, 50.89656967297195, 49.43598049320279, 49.440061790868626, 48.824030771851525, 50.607780380795404, 50.41374120364587, 50.23773394028346, 50.29742456103365, 50.182923647264644, 50.49848415485273, 49.78540665159623, 49.89294866720836, 49.99587154636781, 45.956792081395776, 46.42317022631565, 46.45262781033912, 51.57214622572063, 51.17336833477019, 51.35862463712691, 52.700043457249805, 52.834836045900985, 52.61681775252025, 58.22357696294783, 58.30069330334662, 59.132110253442065, 44.5656039516131, 44.64567508051792, 44.91683061669269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14576518167294583, "mean_inference_ms": 0.703340531692771, "mean_action_processing_ms": 0.10156179214970985, "mean_env_wait_ms": 0.8448174046521841, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 735000, "timesteps_this_iter": 0, "agent_timesteps_total": 2205000, "timers": {"sample_time_ms": 11082.679, "sample_throughput": 451.154, "load_time_ms": 0.199, "load_throughput": 25082549.934, "learn_time_ms": 1670.357, "learn_throughput": 2993.373, "update_time_ms": 8.225}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.05845175209737e-29, "cur_lr": 0.0005000000000000001, "total_loss": 9.032661533355713, "policy_loss": -0.0016121077450551135, "vf_loss": 9.118654346466064, "vf_explained_var": 0.021179986000061036, "kl": 0.004437233338858709, "entropy": 8.438085651397705, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 735000, "num_agent_steps_sampled": 2205000, "num_steps_trained": 735000, "num_agent_steps_trained": 2205000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2326, "training_iteration": 147, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-35-39", "timestamp": 1706229339, "time_this_iter_s": 10.902425289154053, "time_total_s": 1579.2742547988892, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028379E940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1579.2742547988892, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 10.65, "ram_util_percent": 50.5625}}
{"episode_reward_max": 190.83517089858654, "episode_reward_min": -226.86492830328643, "episode_reward_mean": 141.8440651989453, "episode_len_mean": 498.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.89594047702849}, "policy_reward_max": {"shared_policy": 64.02163578942417}, "policy_reward_mean": {"shared_policy": 47.28135506631509}, "custom_metrics": {}, "hist_stats": {"episode_reward": [127.05917110294102, 155.69575847685326, 116.47335912100971, 151.5658366382123, 126.57313235104083, 132.66780219692737, 155.34198004007314, 145.48703280091286, 130.14545645937324, 120.98661836795506, 135.42721158714264, 116.40718443319201, 123.97540933173148, 164.40441876649834, 153.18299389258027, 161.25657337158907, 157.9073642306031, 119.8318168800324, 138.63773857802119, 154.2300667278467, 164.8695129081607, 143.8584717512129, 177.76034324243673, 97.29839042201637, 143.19101995974782, 170.94491278007618, 133.54066868685192, 111.03443151712418, 150.8247961504388, 137.82634627167093, 114.01700243353841, 151.527911223471, 133.976661135559, 126.70854399353263, 150.53745679184806, 130.2188545763492, 140.0488937310875, 166.1023392826317, 114.48240126855669, 129.8747641760856, 142.6267927139994, 158.14660183340294, -226.86492830328643, 164.00881864130477, 170.17768881376816, 146.36652821861207, 142.27911720424882, 123.95217544771728, 127.18856738135219, 171.43609064118928, 125.35414229438173, 126.8464468810707, 132.57077575754374, 181.29264631867383, 121.30729546397924, 172.02443401515478, 154.62756038270905, 144.57198004052006, 162.30302175600096, 190.83517089858654, 120.32852266915143, 189.736801698091, 163.5073192827406, 173.05772858549625, 134.21570397354665, 137.86460843309737, 166.26278215087953, 139.4403836987915, 160.70424660295257, 132.831636276096, 144.22866804897788, 138.85884294658922, 118.23865871876478, 171.9425156861546, 141.23024947557136, 145.6387950167989, 183.23568604467408, 146.47452440112866, 136.04299007914938, 156.93075657263378, 151.88124284893277, 147.70007305592281, 151.25925552472484, 150.97883236315087, 149.67422686517224, 138.83259011805083, 154.10413919761777, 158.15169725567117, 175.65638051973636, 134.12810964882345, 112.54566702619194, 168.15726970508715, 166.2227442786095, 166.36270800232873, 137.2502657929437, 115.45441776700315, 127.27008739300072, 130.83074385277, 172.69361599907276, 167.52945826057083], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 380, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [42.44174127032359, 42.25538183500369, 42.36204799761374, 51.64542779823144, 51.85870923598607, 52.19162144263585, 38.51335696876049, 39.089715061709285, 38.87028709053993, 50.56380116939543, 50.398342885076985, 50.60369258373974, 42.074102361996964, 42.11594884594281, 42.38308114310105, 43.82323596378167, 44.719211982873574, 44.12535425027211, 51.757748819887624, 51.70019099861382, 51.88404022157191, 48.50537588447331, 48.461054801940904, 48.5206021144986, 43.47743665302792, 43.54151702920595, 43.126502777139336, 40.01474691430727, 40.30201269189516, 40.669858761752636, 45.03659726306796, 45.120624613016844, 45.26998971105786, 38.98031169548631, 38.74365217983723, 38.68322055786848, 41.00857112308343, 41.36865414430697, 41.59818406434108, 54.825688252846405, 54.750716226796314, 54.82801428685586, 51.108365837484584, 50.75398033112286, 51.32064772397278, 53.7639575401942, 53.65199550489585, 53.84062032649915, 52.743636174748346, 52.48986081282298, 52.673867243031665, 40.306592847531036, 39.603567396601036, 39.921656635900334, 46.10371020187934, 46.4131717433532, 46.12085663278897, 51.38877327367662, 51.42345809191464, 51.41783536225556, 55.096342287957654, 54.859771788120256, 54.913398832082734, 48.110827175279454, 47.924493966003254, 47.82315060993035, 58.83899871508281, 59.36652198682229, 59.55482254053156, 32.660916709651545, 32.13314728935559, 32.50432642300923, 47.54368256529172, 48.01271915187438, 47.63461824258168, 57.22383797541259, 56.665550306439386, 57.055524498224244, 44.11083926260471, 44.51677379012108, 44.91305563412607, 37.50762251019478, 36.25258308649063, 37.27422592043877, 49.70733264088629, 50.59270446281879, 50.524759046733365, 46.104758627402276, 46.00693754727641, 45.71465009699264, 37.87345031897226, 38.056584807733685, 38.08696730683246, 50.051131963729844, 50.44324126839636, 51.033537991344915, 44.47393950323263, 44.80299595351485, 44.69972567881146, 42.317435214916856, 42.071871044735104, 42.31923773388067, 50.09404383475582, 50.17935491042833, 50.264058046663806, 43.28802376737197, 43.50073154767354, 43.43009926130374, 47.10783874119322, 46.53740263978641, 46.40365235010783, 55.40892003476618, 55.38215412199496, 55.31126512587069, 38.38906325834492, 38.11678599069515, 37.97655201951662, 43.37947932941218, 43.30984429394205, 43.18544055273135, 47.42966167628764, 47.49793611466883, 47.69919492304324, 52.89790522679685, 53.00325837358831, 52.24543823301791, -71.97750787809491, -72.99147994816303, -81.89594047702849, 54.64251247545083, 54.63844199975331, 54.727864166100815, 56.29759498437245, 56.93720312354465, 56.94289070585121, 48.91984648754199, 48.489989077051476, 48.956692654018596, 47.44735261549552, 47.430761737128094, 47.40100285162528, 41.3212702559928, 41.44355753871301, 41.18734765301147, 42.72995390370488, 42.27268012613058, 42.185933351516724, 56.6383119771878, 57.39013247486825, 57.40764618913333, 41.489351143439606, 41.87220453595121, 41.99258661499091, 42.672664616877825, 42.52480679253736, 41.64897547165552, 44.38697586487979, 43.974721275269985, 44.20907861739397, 60.612815387547, 60.15649884194134, 60.5233320891857, 40.70695814862847, 39.976881474256516, 40.623455841094255, 57.198360050717994, 57.191661531726524, 57.634412432710334, 51.94278974893193, 51.458982656399414, 51.22578797737758, 47.81853637595971, 47.928301607569054, 48.82514205699165, 53.49255229532717, 54.21829096227883, 54.59217849839477, 62.97435921430586, 64.02163578942417, 63.83917589485644, 39.913124442100525, 40.17405027523637, 40.24134795181453, 62.81302260855834, 63.249348501364395, 63.674430588168136, 54.406044242282704, 54.5368241717418, 54.56445086871584, 57.68005047428112, 57.56947244952123, 57.80820566169375, 44.78189635835588, 44.64324655756354, 44.7905610576272, 44.96340624491373, 46.57584834347168, 46.32535384471217, 55.358789401749775, 55.34476174662511, 55.55923100250463, 46.42989966770013, 46.536739112188414, 46.47374491890271, 53.54748492191236, 53.57187976191442, 53.58488191912572, 44.3212786813577, 44.1401903082927, 44.37016728644569, 47.963549452523395, 48.09400855998199, 48.171110036472484, 46.146468602120876, 46.34365360066295, 46.36872074380517, 39.31776199489832, 39.329022876918316, 39.59187384694815, 57.528083751599, 57.24685350308816, 57.16757843146722, 47.28858834120909, 46.686551131308065, 47.25511000305413, 48.47852257204552, 48.587622725249574, 48.572649719504014, 60.747079789638505, 61.390312354546026, 61.09829390048979, 49.067599425713226, 48.62533713380496, 48.78158784161012, 45.286146129171044, 45.850876436258346, 44.905967513720185, 52.57667487611373, 51.85989098747571, 52.49419070904453, 50.195348948240266, 50.789324227720485, 50.89656967297195, 49.43598049320279, 49.440061790868626, 48.824030771851525, 50.607780380795404, 50.41374120364587, 50.23773394028346, 50.29742456103365, 50.182923647264644, 50.49848415485273, 49.78540665159623, 49.89294866720836, 49.99587154636781, 45.956792081395776, 46.42317022631565, 46.45262781033912, 51.57214622572063, 51.17336833477019, 51.35862463712691, 52.700043457249805, 52.834836045900985, 52.61681775252025, 58.22357696294783, 58.30069330334662, 59.132110253442065, 44.5656039516131, 44.64567508051792, 44.91683061669269, 37.433664468427494, 37.657870934655264, 37.45413162310918, 55.80118922889231, 56.21198880858718, 56.14409166760741, 55.26339209079741, 55.75557174533604, 55.20378044247626, 55.08817231158416, 55.67433906594913, 55.6001966247956, 45.66285956402619, 45.52892021586497, 46.05848601305236, 38.30060825745264, 38.627024051422865, 38.52678545812765, 42.27678386121988, 42.193790167570114, 42.799513364210725, 43.924971790130556, 43.298832704623536, 43.60693935801585, 57.357624116043255, 57.57798066238563, 57.75801122064392, 56.36970338824902, 55.909007653594, 55.25074721872805]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14583728032729343, "mean_inference_ms": 0.7036974676515575, "mean_action_processing_ms": 0.10157177565993634, "mean_env_wait_ms": 0.8448746366875443, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 740000, "timesteps_this_iter": 0, "agent_timesteps_total": 2220000, "timers": {"sample_time_ms": 11076.74, "sample_throughput": 451.396, "load_time_ms": 0.311, "load_throughput": 16076289.766, "learn_time_ms": 1669.539, "learn_throughput": 2994.839, "update_time_ms": 8.225}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.029225876048685e-29, "cur_lr": 0.0005000000000000001, "total_loss": 10.804186058044433, "policy_loss": -0.0010564501028058615, "vf_loss": 10.890415668487549, "vf_explained_var": 0.004881411790847778, "kl": 0.002670281601632452, "entropy": 8.517319011688233, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 740000, "num_agent_steps_sampled": 2220000, "num_steps_trained": 740000, "num_agent_steps_trained": 2220000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2336, "training_iteration": 148, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-35-49", "timestamp": 1706229349, "time_this_iter_s": 10.669454336166382, "time_total_s": 1589.9437091350555, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020284585D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1589.9437091350555, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 8.706666666666667, "ram_util_percent": 50.63333333333335}}
{"episode_reward_max": 190.83517089858654, "episode_reward_min": -226.86492830328643, "episode_reward_mean": 142.67584397149895, "episode_len_mean": 498.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.89594047702849}, "policy_reward_max": {"shared_policy": 64.02163578942417}, "policy_reward_mean": {"shared_policy": 47.55861465716632}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.42721158714264, 116.40718443319201, 123.97540933173148, 164.40441876649834, 153.18299389258027, 161.25657337158907, 157.9073642306031, 119.8318168800324, 138.63773857802119, 154.2300667278467, 164.8695129081607, 143.8584717512129, 177.76034324243673, 97.29839042201637, 143.19101995974782, 170.94491278007618, 133.54066868685192, 111.03443151712418, 150.8247961504388, 137.82634627167093, 114.01700243353841, 151.527911223471, 133.976661135559, 126.70854399353263, 150.53745679184806, 130.2188545763492, 140.0488937310875, 166.1023392826317, 114.48240126855669, 129.8747641760856, 142.6267927139994, 158.14660183340294, -226.86492830328643, 164.00881864130477, 170.17768881376816, 146.36652821861207, 142.27911720424882, 123.95217544771728, 127.18856738135219, 171.43609064118928, 125.35414229438173, 126.8464468810707, 132.57077575754374, 181.29264631867383, 121.30729546397924, 172.02443401515478, 154.62756038270905, 144.57198004052006, 162.30302175600096, 190.83517089858654, 120.32852266915143, 189.736801698091, 163.5073192827406, 173.05772858549625, 134.21570397354665, 137.86460843309737, 166.26278215087953, 139.4403836987915, 160.70424660295257, 132.831636276096, 144.22866804897788, 138.85884294658922, 118.23865871876478, 171.9425156861546, 141.23024947557136, 145.6387950167989, 183.23568604467408, 146.47452440112866, 136.04299007914938, 156.93075657263378, 151.88124284893277, 147.70007305592281, 151.25925552472484, 150.97883236315087, 149.67422686517224, 138.83259011805083, 154.10413919761777, 158.15169725567117, 175.65638051973636, 134.12810964882345, 112.54566702619194, 168.15726970508715, 166.2227442786095, 166.36270800232873, 137.2502657929437, 115.45441776700315, 127.27008739300072, 130.83074385277, 172.69361599907276, 167.52945826057083, 154.32500755786884, 125.22592872753737, 155.96359985694266, 142.4297986354211, 177.2064415290951, 145.82515918649727, 129.04278539121148, 143.69036270026115, 134.25870074878924, 137.2062404770403], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 380, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [45.03659726306796, 45.120624613016844, 45.26998971105786, 38.98031169548631, 38.74365217983723, 38.68322055786848, 41.00857112308343, 41.36865414430697, 41.59818406434108, 54.825688252846405, 54.750716226796314, 54.82801428685586, 51.108365837484584, 50.75398033112286, 51.32064772397278, 53.7639575401942, 53.65199550489585, 53.84062032649915, 52.743636174748346, 52.48986081282298, 52.673867243031665, 40.306592847531036, 39.603567396601036, 39.921656635900334, 46.10371020187934, 46.4131717433532, 46.12085663278897, 51.38877327367662, 51.42345809191464, 51.41783536225556, 55.096342287957654, 54.859771788120256, 54.913398832082734, 48.110827175279454, 47.924493966003254, 47.82315060993035, 58.83899871508281, 59.36652198682229, 59.55482254053156, 32.660916709651545, 32.13314728935559, 32.50432642300923, 47.54368256529172, 48.01271915187438, 47.63461824258168, 57.22383797541259, 56.665550306439386, 57.055524498224244, 44.11083926260471, 44.51677379012108, 44.91305563412607, 37.50762251019478, 36.25258308649063, 37.27422592043877, 49.70733264088629, 50.59270446281879, 50.524759046733365, 46.104758627402276, 46.00693754727641, 45.71465009699264, 37.87345031897226, 38.056584807733685, 38.08696730683246, 50.051131963729844, 50.44324126839636, 51.033537991344915, 44.47393950323263, 44.80299595351485, 44.69972567881146, 42.317435214916856, 42.071871044735104, 42.31923773388067, 50.09404383475582, 50.17935491042833, 50.264058046663806, 43.28802376737197, 43.50073154767354, 43.43009926130374, 47.10783874119322, 46.53740263978641, 46.40365235010783, 55.40892003476618, 55.38215412199496, 55.31126512587069, 38.38906325834492, 38.11678599069515, 37.97655201951662, 43.37947932941218, 43.30984429394205, 43.18544055273135, 47.42966167628764, 47.49793611466883, 47.69919492304324, 52.89790522679685, 53.00325837358831, 52.24543823301791, -71.97750787809491, -72.99147994816303, -81.89594047702849, 54.64251247545083, 54.63844199975331, 54.727864166100815, 56.29759498437245, 56.93720312354465, 56.94289070585121, 48.91984648754199, 48.489989077051476, 48.956692654018596, 47.44735261549552, 47.430761737128094, 47.40100285162528, 41.3212702559928, 41.44355753871301, 41.18734765301147, 42.72995390370488, 42.27268012613058, 42.185933351516724, 56.6383119771878, 57.39013247486825, 57.40764618913333, 41.489351143439606, 41.87220453595121, 41.99258661499091, 42.672664616877825, 42.52480679253736, 41.64897547165552, 44.38697586487979, 43.974721275269985, 44.20907861739397, 60.612815387547, 60.15649884194134, 60.5233320891857, 40.70695814862847, 39.976881474256516, 40.623455841094255, 57.198360050717994, 57.191661531726524, 57.634412432710334, 51.94278974893193, 51.458982656399414, 51.22578797737758, 47.81853637595971, 47.928301607569054, 48.82514205699165, 53.49255229532717, 54.21829096227883, 54.59217849839477, 62.97435921430586, 64.02163578942417, 63.83917589485644, 39.913124442100525, 40.17405027523637, 40.24134795181453, 62.81302260855834, 63.249348501364395, 63.674430588168136, 54.406044242282704, 54.5368241717418, 54.56445086871584, 57.68005047428112, 57.56947244952123, 57.80820566169375, 44.78189635835588, 44.64324655756354, 44.7905610576272, 44.96340624491373, 46.57584834347168, 46.32535384471217, 55.358789401749775, 55.34476174662511, 55.55923100250463, 46.42989966770013, 46.536739112188414, 46.47374491890271, 53.54748492191236, 53.57187976191442, 53.58488191912572, 44.3212786813577, 44.1401903082927, 44.37016728644569, 47.963549452523395, 48.09400855998199, 48.171110036472484, 46.146468602120876, 46.34365360066295, 46.36872074380517, 39.31776199489832, 39.329022876918316, 39.59187384694815, 57.528083751599, 57.24685350308816, 57.16757843146722, 47.28858834120909, 46.686551131308065, 47.25511000305413, 48.47852257204552, 48.587622725249574, 48.572649719504014, 60.747079789638505, 61.390312354546026, 61.09829390048979, 49.067599425713226, 48.62533713380496, 48.78158784161012, 45.286146129171044, 45.850876436258346, 44.905967513720185, 52.57667487611373, 51.85989098747571, 52.49419070904453, 50.195348948240266, 50.789324227720485, 50.89656967297195, 49.43598049320279, 49.440061790868626, 48.824030771851525, 50.607780380795404, 50.41374120364587, 50.23773394028346, 50.29742456103365, 50.182923647264644, 50.49848415485273, 49.78540665159623, 49.89294866720836, 49.99587154636781, 45.956792081395776, 46.42317022631565, 46.45262781033912, 51.57214622572063, 51.17336833477019, 51.35862463712691, 52.700043457249805, 52.834836045900985, 52.61681775252025, 58.22357696294783, 58.30069330334662, 59.132110253442065, 44.5656039516131, 44.64567508051792, 44.91683061669269, 37.433664468427494, 37.657870934655264, 37.45413162310918, 55.80118922889231, 56.21198880858718, 56.14409166760741, 55.26339209079741, 55.75557174533604, 55.20378044247626, 55.08817231158416, 55.67433906594913, 55.6001966247956, 45.66285956402619, 45.52892021586497, 46.05848601305236, 38.30060825745264, 38.627024051422865, 38.52678545812765, 42.27678386121988, 42.193790167570114, 42.799513364210725, 43.924971790130556, 43.298832704623536, 43.60693935801585, 57.357624116043255, 57.57798066238563, 57.75801122064392, 56.36970338824902, 55.909007653594, 55.25074721872805, 51.52265101174514, 51.429920824865505, 51.37243572125833, 41.66365697483221, 41.58659580598274, 41.97567594672242, 51.76389946540196, 52.10240988930066, 52.097290502240256, 47.49159745872019, 47.188699729740605, 47.74950144696048, 59.478577863425, 59.46076508983968, 58.267098575830445, 48.532691287497684, 48.51762587825458, 48.77484202074508, 43.025222420692444, 42.73225925862789, 43.285303711891174, 47.87339924275874, 48.24747637752442, 47.569487079977975, 44.371378672619656, 44.93264274143924, 44.954679334730216, 45.992773893599704, 45.79769078766306, 45.415775795777634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14591354069110177, "mean_inference_ms": 0.7040837423666275, "mean_action_processing_ms": 0.10158472676276807, "mean_env_wait_ms": 0.8449738477623367, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 745000, "timesteps_this_iter": 0, "agent_timesteps_total": 2235000, "timers": {"sample_time_ms": 11140.108, "sample_throughput": 448.829, "load_time_ms": 0.311, "load_throughput": 16076289.766, "learn_time_ms": 1669.413, "learn_throughput": 2995.065, "update_time_ms": 8.18}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5146129380243426e-29, "cur_lr": 0.0005000000000000001, "total_loss": 8.971940803527833, "policy_loss": -0.0004325208222740962, "vf_loss": 9.057918262481689, "vf_explained_var": -9.958148002624512e-05, "kl": 0.004377542459436797, "entropy": 8.554489898681641, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 745000, "num_agent_steps_sampled": 2235000, "num_steps_trained": 745000, "num_agent_steps_trained": 2235000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2346, "training_iteration": 149, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-36-01", "timestamp": 1706229361, "time_this_iter_s": 11.855340003967285, "time_total_s": 1601.7990491390228, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282490C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1601.7990491390228, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 9.799999999999999, "ram_util_percent": 50.817647058823525}}
{"episode_reward_max": 190.83517089858654, "episode_reward_min": -226.86492830328643, "episode_reward_mean": 142.17679635545804, "episode_len_mean": 498.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.89594047702849}, "policy_reward_max": {"shared_policy": 64.02163578942417}, "policy_reward_mean": {"shared_policy": 47.392265451819355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [164.8695129081607, 143.8584717512129, 177.76034324243673, 97.29839042201637, 143.19101995974782, 170.94491278007618, 133.54066868685192, 111.03443151712418, 150.8247961504388, 137.82634627167093, 114.01700243353841, 151.527911223471, 133.976661135559, 126.70854399353263, 150.53745679184806, 130.2188545763492, 140.0488937310875, 166.1023392826317, 114.48240126855669, 129.8747641760856, 142.6267927139994, 158.14660183340294, -226.86492830328643, 164.00881864130477, 170.17768881376816, 146.36652821861207, 142.27911720424882, 123.95217544771728, 127.18856738135219, 171.43609064118928, 125.35414229438173, 126.8464468810707, 132.57077575754374, 181.29264631867383, 121.30729546397924, 172.02443401515478, 154.62756038270905, 144.57198004052006, 162.30302175600096, 190.83517089858654, 120.32852266915143, 189.736801698091, 163.5073192827406, 173.05772858549625, 134.21570397354665, 137.86460843309737, 166.26278215087953, 139.4403836987915, 160.70424660295257, 132.831636276096, 144.22866804897788, 138.85884294658922, 118.23865871876478, 171.9425156861546, 141.23024947557136, 145.6387950167989, 183.23568604467408, 146.47452440112866, 136.04299007914938, 156.93075657263378, 151.88124284893277, 147.70007305592281, 151.25925552472484, 150.97883236315087, 149.67422686517224, 138.83259011805083, 154.10413919761777, 158.15169725567117, 175.65638051973636, 134.12810964882345, 112.54566702619194, 168.15726970508715, 166.2227442786095, 166.36270800232873, 137.2502657929437, 115.45441776700315, 127.27008739300072, 130.83074385277, 172.69361599907276, 167.52945826057083, 154.32500755786884, 125.22592872753737, 155.96359985694266, 142.4297986354211, 177.2064415290951, 145.82515918649727, 129.04278539121148, 143.69036270026115, 134.25870074878924, 137.2062404770403, 141.0432262793181, 138.30965552851544, 98.96139871678314, 142.28391939681043, 162.8527155201883, 165.130174562335, 134.2178065665067, 113.58867526799439, 124.71795557066798, 154.25048878602664], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 380, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [55.096342287957654, 54.859771788120256, 54.913398832082734, 48.110827175279454, 47.924493966003254, 47.82315060993035, 58.83899871508281, 59.36652198682229, 59.55482254053156, 32.660916709651545, 32.13314728935559, 32.50432642300923, 47.54368256529172, 48.01271915187438, 47.63461824258168, 57.22383797541259, 56.665550306439386, 57.055524498224244, 44.11083926260471, 44.51677379012108, 44.91305563412607, 37.50762251019478, 36.25258308649063, 37.27422592043877, 49.70733264088629, 50.59270446281879, 50.524759046733365, 46.104758627402276, 46.00693754727641, 45.71465009699264, 37.87345031897226, 38.056584807733685, 38.08696730683246, 50.051131963729844, 50.44324126839636, 51.033537991344915, 44.47393950323263, 44.80299595351485, 44.69972567881146, 42.317435214916856, 42.071871044735104, 42.31923773388067, 50.09404383475582, 50.17935491042833, 50.264058046663806, 43.28802376737197, 43.50073154767354, 43.43009926130374, 47.10783874119322, 46.53740263978641, 46.40365235010783, 55.40892003476618, 55.38215412199496, 55.31126512587069, 38.38906325834492, 38.11678599069515, 37.97655201951662, 43.37947932941218, 43.30984429394205, 43.18544055273135, 47.42966167628764, 47.49793611466883, 47.69919492304324, 52.89790522679685, 53.00325837358831, 52.24543823301791, -71.97750787809491, -72.99147994816303, -81.89594047702849, 54.64251247545083, 54.63844199975331, 54.727864166100815, 56.29759498437245, 56.93720312354465, 56.94289070585121, 48.91984648754199, 48.489989077051476, 48.956692654018596, 47.44735261549552, 47.430761737128094, 47.40100285162528, 41.3212702559928, 41.44355753871301, 41.18734765301147, 42.72995390370488, 42.27268012613058, 42.185933351516724, 56.6383119771878, 57.39013247486825, 57.40764618913333, 41.489351143439606, 41.87220453595121, 41.99258661499091, 42.672664616877825, 42.52480679253736, 41.64897547165552, 44.38697586487979, 43.974721275269985, 44.20907861739397, 60.612815387547, 60.15649884194134, 60.5233320891857, 40.70695814862847, 39.976881474256516, 40.623455841094255, 57.198360050717994, 57.191661531726524, 57.634412432710334, 51.94278974893193, 51.458982656399414, 51.22578797737758, 47.81853637595971, 47.928301607569054, 48.82514205699165, 53.49255229532717, 54.21829096227883, 54.59217849839477, 62.97435921430586, 64.02163578942417, 63.83917589485644, 39.913124442100525, 40.17405027523637, 40.24134795181453, 62.81302260855834, 63.249348501364395, 63.674430588168136, 54.406044242282704, 54.5368241717418, 54.56445086871584, 57.68005047428112, 57.56947244952123, 57.80820566169375, 44.78189635835588, 44.64324655756354, 44.7905610576272, 44.96340624491373, 46.57584834347168, 46.32535384471217, 55.358789401749775, 55.34476174662511, 55.55923100250463, 46.42989966770013, 46.536739112188414, 46.47374491890271, 53.54748492191236, 53.57187976191442, 53.58488191912572, 44.3212786813577, 44.1401903082927, 44.37016728644569, 47.963549452523395, 48.09400855998199, 48.171110036472484, 46.146468602120876, 46.34365360066295, 46.36872074380517, 39.31776199489832, 39.329022876918316, 39.59187384694815, 57.528083751599, 57.24685350308816, 57.16757843146722, 47.28858834120909, 46.686551131308065, 47.25511000305413, 48.47852257204552, 48.587622725249574, 48.572649719504014, 60.747079789638505, 61.390312354546026, 61.09829390048979, 49.067599425713226, 48.62533713380496, 48.78158784161012, 45.286146129171044, 45.850876436258346, 44.905967513720185, 52.57667487611373, 51.85989098747571, 52.49419070904453, 50.195348948240266, 50.789324227720485, 50.89656967297195, 49.43598049320279, 49.440061790868626, 48.824030771851525, 50.607780380795404, 50.41374120364587, 50.23773394028346, 50.29742456103365, 50.182923647264644, 50.49848415485273, 49.78540665159623, 49.89294866720836, 49.99587154636781, 45.956792081395776, 46.42317022631565, 46.45262781033912, 51.57214622572063, 51.17336833477019, 51.35862463712691, 52.700043457249805, 52.834836045900985, 52.61681775252025, 58.22357696294783, 58.30069330334662, 59.132110253442065, 44.5656039516131, 44.64567508051792, 44.91683061669269, 37.433664468427494, 37.657870934655264, 37.45413162310918, 55.80118922889231, 56.21198880858718, 56.14409166760741, 55.26339209079741, 55.75557174533604, 55.20378044247626, 55.08817231158416, 55.67433906594913, 55.6001966247956, 45.66285956402619, 45.52892021586497, 46.05848601305236, 38.30060825745264, 38.627024051422865, 38.52678545812765, 42.27678386121988, 42.193790167570114, 42.799513364210725, 43.924971790130556, 43.298832704623536, 43.60693935801585, 57.357624116043255, 57.57798066238563, 57.75801122064392, 56.36970338824902, 55.909007653594, 55.25074721872805, 51.52265101174514, 51.429920824865505, 51.37243572125833, 41.66365697483221, 41.58659580598274, 41.97567594672242, 51.76389946540196, 52.10240988930066, 52.097290502240256, 47.49159745872019, 47.188699729740605, 47.74950144696048, 59.478577863425, 59.46076508983968, 58.267098575830445, 48.532691287497684, 48.51762587825458, 48.77484202074508, 43.025222420692444, 42.73225925862789, 43.285303711891174, 47.87339924275874, 48.24747637752442, 47.569487079977975, 44.371378672619656, 44.93264274143924, 44.954679334730216, 45.992773893599704, 45.79769078766306, 45.415775795777634, 47.051225095987306, 46.95168980956076, 47.04031137377022, 46.148794412612915, 46.4295190833509, 45.731342032551765, 33.25744315710229, 33.10560702656706, 32.59834853311379, 47.27306324491899, 47.59436187303315, 47.41649427885811, 54.36369875632225, 54.35902490466832, 54.1299918591976, 55.18602316329877, 55.188067826131984, 54.756083572904274, 44.83911707873145, 44.64078083510199, 44.737908652673156, 37.99869242062171, 37.76085766901572, 37.82912517835696, 41.081368774175644, 41.618270091712475, 42.01831670477986, 51.41998023943354, 51.453142633972064, 51.377365912621215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14597911352866638, "mean_inference_ms": 0.7044434511907234, "mean_action_processing_ms": 0.10159724009847926, "mean_env_wait_ms": 0.8450502217297743, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 750000, "timesteps_this_iter": 0, "agent_timesteps_total": 2250000, "timers": {"sample_time_ms": 11100.682, "sample_throughput": 450.423, "load_time_ms": 0.211, "load_throughput": 23680578.139, "learn_time_ms": 1677.209, "learn_throughput": 2981.142, "update_time_ms": 8.327}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.573064690121713e-30, "cur_lr": 0.0005000000000000001, "total_loss": 8.351936149597169, "policy_loss": 0.0022516973040369592, "vf_loss": 8.435468673706055, "vf_explained_var": 0.005892354249954224, "kl": 0.012565320776804497, "entropy": 8.578423309326173, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 750000, "num_agent_steps_sampled": 2250000, "num_steps_trained": 750000, "num_agent_steps_trained": 2250000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 207.95087059773488, "episode_reward_min": 93.6102436222136, "episode_reward_mean": 157.13426191969768, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 30.407207667827606}, "policy_reward_max": {"shared_policy": 69.52811310005684}, "policy_reward_mean": {"shared_policy": 52.37808730656591}, "custom_metrics": {}, "hist_stats": {"episode_reward": [162.0124177932739, 140.85425820574167, 159.4212552830579, 158.62766599655137, 166.7233637650496, 207.95087059773488, 93.6102436222136, 162.6217460893094, 163.74795102421203, 155.7728468198327], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [54.0090889831384, 54.16035171349843, 53.842977096637085, 46.86198337748645, 46.98132470995186, 47.010950118303285, 53.061465730269745, 53.334456493457154, 53.02533305933078, 53.02452531456946, 52.81388801336287, 52.78925266861914, 55.5563365202397, 55.61043130466713, 55.556595940142856, 69.52811310005684, 69.26976972197492, 69.15298777570327, 31.66902419552207, 31.534011758863926, 30.407207667827606, 54.32939627145727, 54.12525325020154, 54.16709656765063, 54.45048966258763, 54.57015718147157, 54.7273041801527, 52.249871229752884, 51.45548154413699, 52.06749404594301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15231800289140066, "mean_inference_ms": 0.7732274031513541, "mean_action_processing_ms": 0.10921988326083439, "mean_env_wait_ms": 0.8788920507360463, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 2356, "training_iteration": 150, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-36-22", "timestamp": 1706229382, "time_this_iter_s": 20.910994291305542, "time_total_s": 1622.7100434303284, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020284554280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1622.7100434303284, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 9.583333333333336, "ram_util_percent": 50.959999999999994}}
{"episode_reward_max": 190.83517089858654, "episode_reward_min": -226.86492830328643, "episode_reward_mean": 142.5339230313418, "episode_len_mean": 498.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.89594047702849}, "policy_reward_max": {"shared_policy": 64.02163578942417}, "policy_reward_mean": {"shared_policy": 47.51130767711395}, "custom_metrics": {}, "hist_stats": {"episode_reward": [114.01700243353841, 151.527911223471, 133.976661135559, 126.70854399353263, 150.53745679184806, 130.2188545763492, 140.0488937310875, 166.1023392826317, 114.48240126855669, 129.8747641760856, 142.6267927139994, 158.14660183340294, -226.86492830328643, 164.00881864130477, 170.17768881376816, 146.36652821861207, 142.27911720424882, 123.95217544771728, 127.18856738135219, 171.43609064118928, 125.35414229438173, 126.8464468810707, 132.57077575754374, 181.29264631867383, 121.30729546397924, 172.02443401515478, 154.62756038270905, 144.57198004052006, 162.30302175600096, 190.83517089858654, 120.32852266915143, 189.736801698091, 163.5073192827406, 173.05772858549625, 134.21570397354665, 137.86460843309737, 166.26278215087953, 139.4403836987915, 160.70424660295257, 132.831636276096, 144.22866804897788, 138.85884294658922, 118.23865871876478, 171.9425156861546, 141.23024947557136, 145.6387950167989, 183.23568604467408, 146.47452440112866, 136.04299007914938, 156.93075657263378, 151.88124284893277, 147.70007305592281, 151.25925552472484, 150.97883236315087, 149.67422686517224, 138.83259011805083, 154.10413919761777, 158.15169725567117, 175.65638051973636, 134.12810964882345, 112.54566702619194, 168.15726970508715, 166.2227442786095, 166.36270800232873, 137.2502657929437, 115.45441776700315, 127.27008739300072, 130.83074385277, 172.69361599907276, 167.52945826057083, 154.32500755786884, 125.22592872753737, 155.96359985694266, 142.4297986354211, 177.2064415290951, 145.82515918649727, 129.04278539121148, 143.69036270026115, 134.25870074878924, 137.2062404770403, 141.0432262793181, 138.30965552851544, 98.96139871678314, 142.28391939681043, 162.8527155201883, 165.130174562335, 134.2178065665067, 113.58867526799439, 124.71795557066798, 154.25048878602664, 149.9788582511245, 159.69247544463715, 147.98436296172454, 165.65664058923724, 161.54090266674748, 147.46245200443062, 160.6209659683518, 150.38144159596385, 111.40446131303904, 112.13900048285723], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 380, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [37.87345031897226, 38.056584807733685, 38.08696730683246, 50.051131963729844, 50.44324126839636, 51.033537991344915, 44.47393950323263, 44.80299595351485, 44.69972567881146, 42.317435214916856, 42.071871044735104, 42.31923773388067, 50.09404383475582, 50.17935491042833, 50.264058046663806, 43.28802376737197, 43.50073154767354, 43.43009926130374, 47.10783874119322, 46.53740263978641, 46.40365235010783, 55.40892003476618, 55.38215412199496, 55.31126512587069, 38.38906325834492, 38.11678599069515, 37.97655201951662, 43.37947932941218, 43.30984429394205, 43.18544055273135, 47.42966167628764, 47.49793611466883, 47.69919492304324, 52.89790522679685, 53.00325837358831, 52.24543823301791, -71.97750787809491, -72.99147994816303, -81.89594047702849, 54.64251247545083, 54.63844199975331, 54.727864166100815, 56.29759498437245, 56.93720312354465, 56.94289070585121, 48.91984648754199, 48.489989077051476, 48.956692654018596, 47.44735261549552, 47.430761737128094, 47.40100285162528, 41.3212702559928, 41.44355753871301, 41.18734765301147, 42.72995390370488, 42.27268012613058, 42.185933351516724, 56.6383119771878, 57.39013247486825, 57.40764618913333, 41.489351143439606, 41.87220453595121, 41.99258661499091, 42.672664616877825, 42.52480679253736, 41.64897547165552, 44.38697586487979, 43.974721275269985, 44.20907861739397, 60.612815387547, 60.15649884194134, 60.5233320891857, 40.70695814862847, 39.976881474256516, 40.623455841094255, 57.198360050717994, 57.191661531726524, 57.634412432710334, 51.94278974893193, 51.458982656399414, 51.22578797737758, 47.81853637595971, 47.928301607569054, 48.82514205699165, 53.49255229532717, 54.21829096227883, 54.59217849839477, 62.97435921430586, 64.02163578942417, 63.83917589485644, 39.913124442100525, 40.17405027523637, 40.24134795181453, 62.81302260855834, 63.249348501364395, 63.674430588168136, 54.406044242282704, 54.5368241717418, 54.56445086871584, 57.68005047428112, 57.56947244952123, 57.80820566169375, 44.78189635835588, 44.64324655756354, 44.7905610576272, 44.96340624491373, 46.57584834347168, 46.32535384471217, 55.358789401749775, 55.34476174662511, 55.55923100250463, 46.42989966770013, 46.536739112188414, 46.47374491890271, 53.54748492191236, 53.57187976191442, 53.58488191912572, 44.3212786813577, 44.1401903082927, 44.37016728644569, 47.963549452523395, 48.09400855998199, 48.171110036472484, 46.146468602120876, 46.34365360066295, 46.36872074380517, 39.31776199489832, 39.329022876918316, 39.59187384694815, 57.528083751599, 57.24685350308816, 57.16757843146722, 47.28858834120909, 46.686551131308065, 47.25511000305413, 48.47852257204552, 48.587622725249574, 48.572649719504014, 60.747079789638505, 61.390312354546026, 61.09829390048979, 49.067599425713226, 48.62533713380496, 48.78158784161012, 45.286146129171044, 45.850876436258346, 44.905967513720185, 52.57667487611373, 51.85989098747571, 52.49419070904453, 50.195348948240266, 50.789324227720485, 50.89656967297195, 49.43598049320279, 49.440061790868626, 48.824030771851525, 50.607780380795404, 50.41374120364587, 50.23773394028346, 50.29742456103365, 50.182923647264644, 50.49848415485273, 49.78540665159623, 49.89294866720836, 49.99587154636781, 45.956792081395776, 46.42317022631565, 46.45262781033912, 51.57214622572063, 51.17336833477019, 51.35862463712691, 52.700043457249805, 52.834836045900985, 52.61681775252025, 58.22357696294783, 58.30069330334662, 59.132110253442065, 44.5656039516131, 44.64567508051792, 44.91683061669269, 37.433664468427494, 37.657870934655264, 37.45413162310918, 55.80118922889231, 56.21198880858718, 56.14409166760741, 55.26339209079741, 55.75557174533604, 55.20378044247626, 55.08817231158416, 55.67433906594913, 55.6001966247956, 45.66285956402619, 45.52892021586497, 46.05848601305236, 38.30060825745264, 38.627024051422865, 38.52678545812765, 42.27678386121988, 42.193790167570114, 42.799513364210725, 43.924971790130556, 43.298832704623536, 43.60693935801585, 57.357624116043255, 57.57798066238563, 57.75801122064392, 56.36970338824902, 55.909007653594, 55.25074721872805, 51.52265101174514, 51.429920824865505, 51.37243572125833, 41.66365697483221, 41.58659580598274, 41.97567594672242, 51.76389946540196, 52.10240988930066, 52.097290502240256, 47.49159745872019, 47.188699729740605, 47.74950144696048, 59.478577863425, 59.46076508983968, 58.267098575830445, 48.532691287497684, 48.51762587825458, 48.77484202074508, 43.025222420692444, 42.73225925862789, 43.285303711891174, 47.87339924275874, 48.24747637752442, 47.569487079977975, 44.371378672619656, 44.93264274143924, 44.954679334730216, 45.992773893599704, 45.79769078766306, 45.415775795777634, 47.051225095987306, 46.95168980956076, 47.04031137377022, 46.148794412612915, 46.4295190833509, 45.731342032551765, 33.25744315710229, 33.10560702656706, 32.59834853311379, 47.27306324491899, 47.59436187303315, 47.41649427885811, 54.36369875632225, 54.35902490466832, 54.1299918591976, 55.18602316329877, 55.188067826131984, 54.756083572904274, 44.83911707873145, 44.64078083510199, 44.737908652673156, 37.99869242062171, 37.76085766901572, 37.82912517835696, 41.081368774175644, 41.618270091712475, 42.01831670477986, 51.41998023943354, 51.453142633972064, 51.377365912621215, 50.15642028301953, 50.2518064342439, 49.570631533861146, 53.20914877206086, 53.357565562240765, 53.125761110335574, 48.78349564969538, 49.65626669116317, 49.54460062086581, 55.20466831326483, 55.36548220366238, 55.08649007230996, 53.39476294815539, 53.932412341237054, 54.213727377355085, 48.85117776940267, 49.33129983154747, 49.27997440348069, 53.97868332344417, 53.22684707244237, 53.415435572465256, 49.53206750253837, 50.414262769433364, 50.435111323992416, 37.32290151591101, 37.09292610237995, 36.988633694748074, 37.15943917632103, 37.49539289623499, 37.48416841030121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14604586416357868, "mean_inference_ms": 0.7047813850113838, "mean_action_processing_ms": 0.1016045950778258, "mean_env_wait_ms": 0.8451242911308241, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 755000, "timesteps_this_iter": 0, "agent_timesteps_total": 2265000, "timers": {"sample_time_ms": 12087.318, "sample_throughput": 413.657, "load_time_ms": 0.211, "load_throughput": 23680578.139, "learn_time_ms": 1688.215, "learn_throughput": 2961.708, "update_time_ms": 8.325}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.573064690121713e-30, "cur_lr": 0.0005000000000000001, "total_loss": 10.25830364227295, "policy_loss": 0.0010107363791522772, "vf_loss": 10.341997814178466, "vf_explained_var": 0.00705174207687378, "kl": 0.010899287182867355, "entropy": 8.47050142288208, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 755000, "num_agent_steps_sampled": 2265000, "num_steps_trained": 755000, "num_agent_steps_trained": 2265000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2366, "training_iteration": 151, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-36-33", "timestamp": 1706229393, "time_this_iter_s": 11.083080291748047, "time_total_s": 1633.7931237220764, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202846E41F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1633.7931237220764, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 10.193333333333335, "ram_util_percent": 51.160000000000004}}
{"episode_reward_max": 190.83517089858654, "episode_reward_min": -226.86492830328643, "episode_reward_mean": 143.98899905875365, "episode_len_mean": 498.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -81.89594047702849}, "policy_reward_max": {"shared_policy": 64.02163578942417}, "policy_reward_mean": {"shared_policy": 47.99633301958456}, "custom_metrics": {}, "hist_stats": {"episode_reward": [142.6267927139994, 158.14660183340294, -226.86492830328643, 164.00881864130477, 170.17768881376816, 146.36652821861207, 142.27911720424882, 123.95217544771728, 127.18856738135219, 171.43609064118928, 125.35414229438173, 126.8464468810707, 132.57077575754374, 181.29264631867383, 121.30729546397924, 172.02443401515478, 154.62756038270905, 144.57198004052006, 162.30302175600096, 190.83517089858654, 120.32852266915143, 189.736801698091, 163.5073192827406, 173.05772858549625, 134.21570397354665, 137.86460843309737, 166.26278215087953, 139.4403836987915, 160.70424660295257, 132.831636276096, 144.22866804897788, 138.85884294658922, 118.23865871876478, 171.9425156861546, 141.23024947557136, 145.6387950167989, 183.23568604467408, 146.47452440112866, 136.04299007914938, 156.93075657263378, 151.88124284893277, 147.70007305592281, 151.25925552472484, 150.97883236315087, 149.67422686517224, 138.83259011805083, 154.10413919761777, 158.15169725567117, 175.65638051973636, 134.12810964882345, 112.54566702619194, 168.15726970508715, 166.2227442786095, 166.36270800232873, 137.2502657929437, 115.45441776700315, 127.27008739300072, 130.83074385277, 172.69361599907276, 167.52945826057083, 154.32500755786884, 125.22592872753737, 155.96359985694266, 142.4297986354211, 177.2064415290951, 145.82515918649727, 129.04278539121148, 143.69036270026115, 134.25870074878924, 137.2062404770403, 141.0432262793181, 138.30965552851544, 98.96139871678314, 142.28391939681043, 162.8527155201883, 165.130174562335, 134.2178065665067, 113.58867526799439, 124.71795557066798, 154.25048878602664, 149.9788582511245, 159.69247544463715, 147.98436296172454, 165.65664058923724, 161.54090266674748, 147.46245200443062, 160.6209659683518, 150.38144159596385, 111.40446131303904, 112.13900048285723, 153.57758372277002, 162.69701835140566, 137.34343376196932, 140.4473799057305, 151.23687750083647, 184.25711887143518, 173.6957300044595, 117.13885906571522, 158.89768863096836, 123.71074153855442], "episode_lengths": [500, 500, 380, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [47.42966167628764, 47.49793611466883, 47.69919492304324, 52.89790522679685, 53.00325837358831, 52.24543823301791, -71.97750787809491, -72.99147994816303, -81.89594047702849, 54.64251247545083, 54.63844199975331, 54.727864166100815, 56.29759498437245, 56.93720312354465, 56.94289070585121, 48.91984648754199, 48.489989077051476, 48.956692654018596, 47.44735261549552, 47.430761737128094, 47.40100285162528, 41.3212702559928, 41.44355753871301, 41.18734765301147, 42.72995390370488, 42.27268012613058, 42.185933351516724, 56.6383119771878, 57.39013247486825, 57.40764618913333, 41.489351143439606, 41.87220453595121, 41.99258661499091, 42.672664616877825, 42.52480679253736, 41.64897547165552, 44.38697586487979, 43.974721275269985, 44.20907861739397, 60.612815387547, 60.15649884194134, 60.5233320891857, 40.70695814862847, 39.976881474256516, 40.623455841094255, 57.198360050717994, 57.191661531726524, 57.634412432710334, 51.94278974893193, 51.458982656399414, 51.22578797737758, 47.81853637595971, 47.928301607569054, 48.82514205699165, 53.49255229532717, 54.21829096227883, 54.59217849839477, 62.97435921430586, 64.02163578942417, 63.83917589485644, 39.913124442100525, 40.17405027523637, 40.24134795181453, 62.81302260855834, 63.249348501364395, 63.674430588168136, 54.406044242282704, 54.5368241717418, 54.56445086871584, 57.68005047428112, 57.56947244952123, 57.80820566169375, 44.78189635835588, 44.64324655756354, 44.7905610576272, 44.96340624491373, 46.57584834347168, 46.32535384471217, 55.358789401749775, 55.34476174662511, 55.55923100250463, 46.42989966770013, 46.536739112188414, 46.47374491890271, 53.54748492191236, 53.57187976191442, 53.58488191912572, 44.3212786813577, 44.1401903082927, 44.37016728644569, 47.963549452523395, 48.09400855998199, 48.171110036472484, 46.146468602120876, 46.34365360066295, 46.36872074380517, 39.31776199489832, 39.329022876918316, 39.59187384694815, 57.528083751599, 57.24685350308816, 57.16757843146722, 47.28858834120909, 46.686551131308065, 47.25511000305413, 48.47852257204552, 48.587622725249574, 48.572649719504014, 60.747079789638505, 61.390312354546026, 61.09829390048979, 49.067599425713226, 48.62533713380496, 48.78158784161012, 45.286146129171044, 45.850876436258346, 44.905967513720185, 52.57667487611373, 51.85989098747571, 52.49419070904453, 50.195348948240266, 50.789324227720485, 50.89656967297195, 49.43598049320279, 49.440061790868626, 48.824030771851525, 50.607780380795404, 50.41374120364587, 50.23773394028346, 50.29742456103365, 50.182923647264644, 50.49848415485273, 49.78540665159623, 49.89294866720836, 49.99587154636781, 45.956792081395776, 46.42317022631565, 46.45262781033912, 51.57214622572063, 51.17336833477019, 51.35862463712691, 52.700043457249805, 52.834836045900985, 52.61681775252025, 58.22357696294783, 58.30069330334662, 59.132110253442065, 44.5656039516131, 44.64567508051792, 44.91683061669269, 37.433664468427494, 37.657870934655264, 37.45413162310918, 55.80118922889231, 56.21198880858718, 56.14409166760741, 55.26339209079741, 55.75557174533604, 55.20378044247626, 55.08817231158416, 55.67433906594913, 55.6001966247956, 45.66285956402619, 45.52892021586497, 46.05848601305236, 38.30060825745264, 38.627024051422865, 38.52678545812765, 42.27678386121988, 42.193790167570114, 42.799513364210725, 43.924971790130556, 43.298832704623536, 43.60693935801585, 57.357624116043255, 57.57798066238563, 57.75801122064392, 56.36970338824902, 55.909007653594, 55.25074721872805, 51.52265101174514, 51.429920824865505, 51.37243572125833, 41.66365697483221, 41.58659580598274, 41.97567594672242, 51.76389946540196, 52.10240988930066, 52.097290502240256, 47.49159745872019, 47.188699729740605, 47.74950144696048, 59.478577863425, 59.46076508983968, 58.267098575830445, 48.532691287497684, 48.51762587825458, 48.77484202074508, 43.025222420692444, 42.73225925862789, 43.285303711891174, 47.87339924275874, 48.24747637752442, 47.569487079977975, 44.371378672619656, 44.93264274143924, 44.954679334730216, 45.992773893599704, 45.79769078766306, 45.415775795777634, 47.051225095987306, 46.95168980956076, 47.04031137377022, 46.148794412612915, 46.4295190833509, 45.731342032551765, 33.25744315710229, 33.10560702656706, 32.59834853311379, 47.27306324491899, 47.59436187303315, 47.41649427885811, 54.36369875632225, 54.35902490466832, 54.1299918591976, 55.18602316329877, 55.188067826131984, 54.756083572904274, 44.83911707873145, 44.64078083510199, 44.737908652673156, 37.99869242062171, 37.76085766901572, 37.82912517835696, 41.081368774175644, 41.618270091712475, 42.01831670477986, 51.41998023943354, 51.453142633972064, 51.377365912621215, 50.15642028301953, 50.2518064342439, 49.570631533861146, 53.20914877206086, 53.357565562240765, 53.125761110335574, 48.78349564969538, 49.65626669116317, 49.54460062086581, 55.20466831326483, 55.36548220366238, 55.08649007230996, 53.39476294815539, 53.932412341237054, 54.213727377355085, 48.85117776940267, 49.33129983154747, 49.27997440348069, 53.97868332344417, 53.22684707244237, 53.415435572465256, 49.53206750253837, 50.414262769433364, 50.435111323992416, 37.32290151591101, 37.09292610237995, 36.988633694748074, 37.15943917632103, 37.49539289623499, 37.48416841030121, 51.469112209975705, 50.935339167714105, 51.17313234508036, 54.197319877644375, 54.30656328921516, 54.19313518454631, 46.062946801384285, 46.41863462266822, 44.86185233791669, 46.439984470605836, 47.09247355535625, 46.91492187976836, 50.566684633008364, 50.529920918556556, 50.140271949271366, 61.14757541318734, 61.937854762499526, 61.17168869574864, 58.02143592884143, 57.58216143151124, 58.09213264410694, 38.59113818407059, 39.160094022750854, 39.38762685889378, 53.267282104740545, 52.86380580315988, 52.766600723067924, 41.44866704878707, 40.79729518791039, 41.46477930185695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14610660552546012, "mean_inference_ms": 0.7051123134248917, "mean_action_processing_ms": 0.10161940640650557, "mean_env_wait_ms": 0.8452036394882865, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 760000, "timesteps_this_iter": 0, "agent_timesteps_total": 2280000, "timers": {"sample_time_ms": 12100.687, "sample_throughput": 413.2, "load_time_ms": 0.211, "load_throughput": 23680578.139, "learn_time_ms": 1700.882, "learn_throughput": 2939.652, "update_time_ms": 8.571}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.573064690121713e-30, "cur_lr": 0.0005000000000000001, "total_loss": 8.993541145324707, "policy_loss": -0.0008014930642937568, "vf_loss": 9.07924156188965, "vf_explained_var": 0.012613022327423095, "kl": 0.0039459279971509826, "entropy": 8.489902591705322, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 760000, "num_agent_steps_sampled": 2280000, "num_steps_trained": 760000, "num_agent_steps_trained": 2280000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2376, "training_iteration": 152, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-36-45", "timestamp": 1706229405, "time_this_iter_s": 11.37095308303833, "time_total_s": 1645.1640768051147, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028379EF70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1645.1640768051147, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 9.923529411764704, "ram_util_percent": 51.49411764705882}}
{"episode_reward_max": 193.2385709751396, "episode_reward_min": 98.96139871678314, "episode_reward_mean": 148.62005599133244, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 32.59834853311379}, "policy_reward_max": {"shared_policy": 64.72670998610555}, "policy_reward_mean": {"shared_policy": 49.540018663777495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.35414229438173, 126.8464468810707, 132.57077575754374, 181.29264631867383, 121.30729546397924, 172.02443401515478, 154.62756038270905, 144.57198004052006, 162.30302175600096, 190.83517089858654, 120.32852266915143, 189.736801698091, 163.5073192827406, 173.05772858549625, 134.21570397354665, 137.86460843309737, 166.26278215087953, 139.4403836987915, 160.70424660295257, 132.831636276096, 144.22866804897788, 138.85884294658922, 118.23865871876478, 171.9425156861546, 141.23024947557136, 145.6387950167989, 183.23568604467408, 146.47452440112866, 136.04299007914938, 156.93075657263378, 151.88124284893277, 147.70007305592281, 151.25925552472484, 150.97883236315087, 149.67422686517224, 138.83259011805083, 154.10413919761777, 158.15169725567117, 175.65638051973636, 134.12810964882345, 112.54566702619194, 168.15726970508715, 166.2227442786095, 166.36270800232873, 137.2502657929437, 115.45441776700315, 127.27008739300072, 130.83074385277, 172.69361599907276, 167.52945826057083, 154.32500755786884, 125.22592872753737, 155.96359985694266, 142.4297986354211, 177.2064415290951, 145.82515918649727, 129.04278539121148, 143.69036270026115, 134.25870074878924, 137.2062404770403, 141.0432262793181, 138.30965552851544, 98.96139871678314, 142.28391939681043, 162.8527155201883, 165.130174562335, 134.2178065665067, 113.58867526799439, 124.71795557066798, 154.25048878602664, 149.9788582511245, 159.69247544463715, 147.98436296172454, 165.65664058923724, 161.54090266674748, 147.46245200443062, 160.6209659683518, 150.38144159596385, 111.40446131303904, 112.13900048285723, 153.57758372277002, 162.69701835140566, 137.34343376196932, 140.4473799057305, 151.23687750083647, 184.25711887143518, 173.6957300044595, 117.13885906571522, 158.89768863096836, 123.71074153855442, 171.90891383402027, 155.54760999139378, 139.5505314320327, 151.09174324944604, 193.2385709751396, 171.0001661926511, 168.65598125010717, 143.46995116211482, 122.23662372678517, 165.72305403649804], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [41.489351143439606, 41.87220453595121, 41.99258661499091, 42.672664616877825, 42.52480679253736, 41.64897547165552, 44.38697586487979, 43.974721275269985, 44.20907861739397, 60.612815387547, 60.15649884194134, 60.5233320891857, 40.70695814862847, 39.976881474256516, 40.623455841094255, 57.198360050717994, 57.191661531726524, 57.634412432710334, 51.94278974893193, 51.458982656399414, 51.22578797737758, 47.81853637595971, 47.928301607569054, 48.82514205699165, 53.49255229532717, 54.21829096227883, 54.59217849839477, 62.97435921430586, 64.02163578942417, 63.83917589485644, 39.913124442100525, 40.17405027523637, 40.24134795181453, 62.81302260855834, 63.249348501364395, 63.674430588168136, 54.406044242282704, 54.5368241717418, 54.56445086871584, 57.68005047428112, 57.56947244952123, 57.80820566169375, 44.78189635835588, 44.64324655756354, 44.7905610576272, 44.96340624491373, 46.57584834347168, 46.32535384471217, 55.358789401749775, 55.34476174662511, 55.55923100250463, 46.42989966770013, 46.536739112188414, 46.47374491890271, 53.54748492191236, 53.57187976191442, 53.58488191912572, 44.3212786813577, 44.1401903082927, 44.37016728644569, 47.963549452523395, 48.09400855998199, 48.171110036472484, 46.146468602120876, 46.34365360066295, 46.36872074380517, 39.31776199489832, 39.329022876918316, 39.59187384694815, 57.528083751599, 57.24685350308816, 57.16757843146722, 47.28858834120909, 46.686551131308065, 47.25511000305413, 48.47852257204552, 48.587622725249574, 48.572649719504014, 60.747079789638505, 61.390312354546026, 61.09829390048979, 49.067599425713226, 48.62533713380496, 48.78158784161012, 45.286146129171044, 45.850876436258346, 44.905967513720185, 52.57667487611373, 51.85989098747571, 52.49419070904453, 50.195348948240266, 50.789324227720485, 50.89656967297195, 49.43598049320279, 49.440061790868626, 48.824030771851525, 50.607780380795404, 50.41374120364587, 50.23773394028346, 50.29742456103365, 50.182923647264644, 50.49848415485273, 49.78540665159623, 49.89294866720836, 49.99587154636781, 45.956792081395776, 46.42317022631565, 46.45262781033912, 51.57214622572063, 51.17336833477019, 51.35862463712691, 52.700043457249805, 52.834836045900985, 52.61681775252025, 58.22357696294783, 58.30069330334662, 59.132110253442065, 44.5656039516131, 44.64567508051792, 44.91683061669269, 37.433664468427494, 37.657870934655264, 37.45413162310918, 55.80118922889231, 56.21198880858718, 56.14409166760741, 55.26339209079741, 55.75557174533604, 55.20378044247626, 55.08817231158416, 55.67433906594913, 55.6001966247956, 45.66285956402619, 45.52892021586497, 46.05848601305236, 38.30060825745264, 38.627024051422865, 38.52678545812765, 42.27678386121988, 42.193790167570114, 42.799513364210725, 43.924971790130556, 43.298832704623536, 43.60693935801585, 57.357624116043255, 57.57798066238563, 57.75801122064392, 56.36970338824902, 55.909007653594, 55.25074721872805, 51.52265101174514, 51.429920824865505, 51.37243572125833, 41.66365697483221, 41.58659580598274, 41.97567594672242, 51.76389946540196, 52.10240988930066, 52.097290502240256, 47.49159745872019, 47.188699729740605, 47.74950144696048, 59.478577863425, 59.46076508983968, 58.267098575830445, 48.532691287497684, 48.51762587825458, 48.77484202074508, 43.025222420692444, 42.73225925862789, 43.285303711891174, 47.87339924275874, 48.24747637752442, 47.569487079977975, 44.371378672619656, 44.93264274143924, 44.954679334730216, 45.992773893599704, 45.79769078766306, 45.415775795777634, 47.051225095987306, 46.95168980956076, 47.04031137377022, 46.148794412612915, 46.4295190833509, 45.731342032551765, 33.25744315710229, 33.10560702656706, 32.59834853311379, 47.27306324491899, 47.59436187303315, 47.41649427885811, 54.36369875632225, 54.35902490466832, 54.1299918591976, 55.18602316329877, 55.188067826131984, 54.756083572904274, 44.83911707873145, 44.64078083510199, 44.737908652673156, 37.99869242062171, 37.76085766901572, 37.82912517835696, 41.081368774175644, 41.618270091712475, 42.01831670477986, 51.41998023943354, 51.453142633972064, 51.377365912621215, 50.15642028301953, 50.2518064342439, 49.570631533861146, 53.20914877206086, 53.357565562240765, 53.125761110335574, 48.78349564969538, 49.65626669116317, 49.54460062086581, 55.20466831326483, 55.36548220366238, 55.08649007230996, 53.39476294815539, 53.932412341237054, 54.213727377355085, 48.85117776940267, 49.33129983154747, 49.27997440348069, 53.97868332344417, 53.22684707244237, 53.415435572465256, 49.53206750253837, 50.414262769433364, 50.435111323992416, 37.32290151591101, 37.09292610237995, 36.988633694748074, 37.15943917632103, 37.49539289623499, 37.48416841030121, 51.469112209975705, 50.935339167714105, 51.17313234508036, 54.197319877644375, 54.30656328921516, 54.19313518454631, 46.062946801384285, 46.41863462266822, 44.86185233791669, 46.439984470605836, 47.09247355535625, 46.91492187976836, 50.566684633008364, 50.529920918556556, 50.140271949271366, 61.14757541318734, 61.937854762499526, 61.17168869574864, 58.02143592884143, 57.58216143151124, 58.09213264410694, 38.59113818407059, 39.160094022750854, 39.38762685889378, 53.267282104740545, 52.86380580315988, 52.766600723067924, 41.44866704878707, 40.79729518791039, 41.46477930185695, 57.324555718650416, 57.26752182220419, 57.31683629316588, 52.201327054761336, 51.73234875500201, 51.6139341816306, 46.68454524129629, 46.47410739213228, 46.39187879860401, 50.07277321318786, 50.561790208021804, 50.457179828236505, 64.30616936832665, 64.2056916207075, 64.72670998610555, 56.779829869667694, 57.24333551774423, 56.97700080523889, 56.16721541186173, 56.28425237288077, 56.20451346536477, 47.891850999246046, 47.94134946229558, 47.63675070057313, 40.96273661901553, 41.33751695354779, 39.93637015422185, 55.631382986903176, 55.51951408386229, 54.57215696573256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14617940797813453, "mean_inference_ms": 0.7054688012309005, "mean_action_processing_ms": 0.10164889198330684, "mean_env_wait_ms": 0.8452986381311485, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 765000, "timesteps_this_iter": 0, "agent_timesteps_total": 2295000, "timers": {"sample_time_ms": 12175.489, "sample_throughput": 410.661, "load_time_ms": 0.211, "load_throughput": 23680578.139, "learn_time_ms": 1708.667, "learn_throughput": 2926.258, "update_time_ms": 8.833}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.7865323450608565e-30, "cur_lr": 0.0005000000000000001, "total_loss": 10.537030696868896, "policy_loss": -0.0010206258528411283, "vf_loss": 10.623159885406494, "vf_explained_var": 0.008253592252731323, "kl": 0.0033542652381881644, "entropy": 8.510872554779052, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 765000, "num_agent_steps_sampled": 2295000, "num_steps_trained": 765000, "num_agent_steps_trained": 2295000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2386, "training_iteration": 153, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-36-57", "timestamp": 1706229417, "time_this_iter_s": 12.247291803359985, "time_total_s": 1657.4113686084747, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282552DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1657.4113686084747, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 10.058823529411766, "ram_util_percent": 52.00588235294118}}
{"episode_reward_max": 193.2385709751396, "episode_reward_min": 98.96139871678314, "episode_reward_mean": 148.89086371326044, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 32.59834853311379}, "policy_reward_max": {"shared_policy": 64.72670998610555}, "policy_reward_mean": {"shared_policy": 49.63028790442016}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.32852266915143, 189.736801698091, 163.5073192827406, 173.05772858549625, 134.21570397354665, 137.86460843309737, 166.26278215087953, 139.4403836987915, 160.70424660295257, 132.831636276096, 144.22866804897788, 138.85884294658922, 118.23865871876478, 171.9425156861546, 141.23024947557136, 145.6387950167989, 183.23568604467408, 146.47452440112866, 136.04299007914938, 156.93075657263378, 151.88124284893277, 147.70007305592281, 151.25925552472484, 150.97883236315087, 149.67422686517224, 138.83259011805083, 154.10413919761777, 158.15169725567117, 175.65638051973636, 134.12810964882345, 112.54566702619194, 168.15726970508715, 166.2227442786095, 166.36270800232873, 137.2502657929437, 115.45441776700315, 127.27008739300072, 130.83074385277, 172.69361599907276, 167.52945826057083, 154.32500755786884, 125.22592872753737, 155.96359985694266, 142.4297986354211, 177.2064415290951, 145.82515918649727, 129.04278539121148, 143.69036270026115, 134.25870074878924, 137.2062404770403, 141.0432262793181, 138.30965552851544, 98.96139871678314, 142.28391939681043, 162.8527155201883, 165.130174562335, 134.2178065665067, 113.58867526799439, 124.71795557066798, 154.25048878602664, 149.9788582511245, 159.69247544463715, 147.98436296172454, 165.65664058923724, 161.54090266674748, 147.46245200443062, 160.6209659683518, 150.38144159596385, 111.40446131303904, 112.13900048285723, 153.57758372277002, 162.69701835140566, 137.34343376196932, 140.4473799057305, 151.23687750083647, 184.25711887143518, 173.6957300044595, 117.13885906571522, 158.89768863096836, 123.71074153855442, 171.90891383402027, 155.54760999139378, 139.5505314320327, 151.09174324944604, 193.2385709751396, 171.0001661926511, 168.65598125010717, 143.46995116211482, 122.23662372678517, 165.72305403649804, 183.82322385162092, 150.47785477340227, 134.89787428360432, 175.10353946709057, 139.86600125208497, 189.65264766849566, 127.85625144187358, 163.01622824883083, 126.89877328276634, 147.22185173165036], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [39.913124442100525, 40.17405027523637, 40.24134795181453, 62.81302260855834, 63.249348501364395, 63.674430588168136, 54.406044242282704, 54.5368241717418, 54.56445086871584, 57.68005047428112, 57.56947244952123, 57.80820566169375, 44.78189635835588, 44.64324655756354, 44.7905610576272, 44.96340624491373, 46.57584834347168, 46.32535384471217, 55.358789401749775, 55.34476174662511, 55.55923100250463, 46.42989966770013, 46.536739112188414, 46.47374491890271, 53.54748492191236, 53.57187976191442, 53.58488191912572, 44.3212786813577, 44.1401903082927, 44.37016728644569, 47.963549452523395, 48.09400855998199, 48.171110036472484, 46.146468602120876, 46.34365360066295, 46.36872074380517, 39.31776199489832, 39.329022876918316, 39.59187384694815, 57.528083751599, 57.24685350308816, 57.16757843146722, 47.28858834120909, 46.686551131308065, 47.25511000305413, 48.47852257204552, 48.587622725249574, 48.572649719504014, 60.747079789638505, 61.390312354546026, 61.09829390048979, 49.067599425713226, 48.62533713380496, 48.78158784161012, 45.286146129171044, 45.850876436258346, 44.905967513720185, 52.57667487611373, 51.85989098747571, 52.49419070904453, 50.195348948240266, 50.789324227720485, 50.89656967297195, 49.43598049320279, 49.440061790868626, 48.824030771851525, 50.607780380795404, 50.41374120364587, 50.23773394028346, 50.29742456103365, 50.182923647264644, 50.49848415485273, 49.78540665159623, 49.89294866720836, 49.99587154636781, 45.956792081395776, 46.42317022631565, 46.45262781033912, 51.57214622572063, 51.17336833477019, 51.35862463712691, 52.700043457249805, 52.834836045900985, 52.61681775252025, 58.22357696294783, 58.30069330334662, 59.132110253442065, 44.5656039516131, 44.64567508051792, 44.91683061669269, 37.433664468427494, 37.657870934655264, 37.45413162310918, 55.80118922889231, 56.21198880858718, 56.14409166760741, 55.26339209079741, 55.75557174533604, 55.20378044247626, 55.08817231158416, 55.67433906594913, 55.6001966247956, 45.66285956402619, 45.52892021586497, 46.05848601305236, 38.30060825745264, 38.627024051422865, 38.52678545812765, 42.27678386121988, 42.193790167570114, 42.799513364210725, 43.924971790130556, 43.298832704623536, 43.60693935801585, 57.357624116043255, 57.57798066238563, 57.75801122064392, 56.36970338824902, 55.909007653594, 55.25074721872805, 51.52265101174514, 51.429920824865505, 51.37243572125833, 41.66365697483221, 41.58659580598274, 41.97567594672242, 51.76389946540196, 52.10240988930066, 52.097290502240256, 47.49159745872019, 47.188699729740605, 47.74950144696048, 59.478577863425, 59.46076508983968, 58.267098575830445, 48.532691287497684, 48.51762587825458, 48.77484202074508, 43.025222420692444, 42.73225925862789, 43.285303711891174, 47.87339924275874, 48.24747637752442, 47.569487079977975, 44.371378672619656, 44.93264274143924, 44.954679334730216, 45.992773893599704, 45.79769078766306, 45.415775795777634, 47.051225095987306, 46.95168980956076, 47.04031137377022, 46.148794412612915, 46.4295190833509, 45.731342032551765, 33.25744315710229, 33.10560702656706, 32.59834853311379, 47.27306324491899, 47.59436187303315, 47.41649427885811, 54.36369875632225, 54.35902490466832, 54.1299918591976, 55.18602316329877, 55.188067826131984, 54.756083572904274, 44.83911707873145, 44.64078083510199, 44.737908652673156, 37.99869242062171, 37.76085766901572, 37.82912517835696, 41.081368774175644, 41.618270091712475, 42.01831670477986, 51.41998023943354, 51.453142633972064, 51.377365912621215, 50.15642028301953, 50.2518064342439, 49.570631533861146, 53.20914877206086, 53.357565562240765, 53.125761110335574, 48.78349564969538, 49.65626669116317, 49.54460062086581, 55.20466831326483, 55.36548220366238, 55.08649007230996, 53.39476294815539, 53.932412341237054, 54.213727377355085, 48.85117776940267, 49.33129983154747, 49.27997440348069, 53.97868332344417, 53.22684707244237, 53.415435572465256, 49.53206750253837, 50.414262769433364, 50.435111323992416, 37.32290151591101, 37.09292610237995, 36.988633694748074, 37.15943917632103, 37.49539289623499, 37.48416841030121, 51.469112209975705, 50.935339167714105, 51.17313234508036, 54.197319877644375, 54.30656328921516, 54.19313518454631, 46.062946801384285, 46.41863462266822, 44.86185233791669, 46.439984470605836, 47.09247355535625, 46.91492187976836, 50.566684633008364, 50.529920918556556, 50.140271949271366, 61.14757541318734, 61.937854762499526, 61.17168869574864, 58.02143592884143, 57.58216143151124, 58.09213264410694, 38.59113818407059, 39.160094022750854, 39.38762685889378, 53.267282104740545, 52.86380580315988, 52.766600723067924, 41.44866704878707, 40.79729518791039, 41.46477930185695, 57.324555718650416, 57.26752182220419, 57.31683629316588, 52.201327054761336, 51.73234875500201, 51.6139341816306, 46.68454524129629, 46.47410739213228, 46.39187879860401, 50.07277321318786, 50.561790208021804, 50.457179828236505, 64.30616936832665, 64.2056916207075, 64.72670998610555, 56.779829869667694, 57.24333551774423, 56.97700080523889, 56.16721541186173, 56.28425237288077, 56.20451346536477, 47.891850999246046, 47.94134946229558, 47.63675070057313, 40.96273661901553, 41.33751695354779, 39.93637015422185, 55.631382986903176, 55.51951408386229, 54.57215696573256, 60.91940091053645, 61.709894063572094, 61.19392887751262, 50.23223909735678, 50.14247085154055, 50.10314482450484, 45.14881014109899, 44.88845448692639, 44.860609655578926, 58.0856345842282, 58.376019547382995, 58.64188533547956, 46.640686206519604, 46.40739653259516, 46.81791851297021, 63.38747675654788, 63.240008076032, 63.02516283591588, 43.009810641097516, 42.06926103929678, 42.77717976147929, 54.412391265388564, 54.273100614547715, 54.33073636889456, 42.08928854763508, 42.404246754944324, 42.40523798018694, 49.41063248272984, 49.23204985633491, 48.57916939258574]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1462530804947509, "mean_inference_ms": 0.7058338944973181, "mean_action_processing_ms": 0.10168477231544312, "mean_env_wait_ms": 0.8454061772574001, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 770000, "timesteps_this_iter": 0, "agent_timesteps_total": 2310000, "timers": {"sample_time_ms": 12209.906, "sample_throughput": 409.504, "load_time_ms": 0.211, "load_throughput": 23680578.139, "learn_time_ms": 1717.841, "learn_throughput": 2910.631, "update_time_ms": 8.731}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8932661725304283e-30, "cur_lr": 0.0005000000000000001, "total_loss": 8.643782424926759, "policy_loss": -0.0015174614944724496, "vf_loss": 8.728619861602784, "vf_explained_var": 0.008631223440170288, "kl": 0.003407727985207252, "entropy": 8.332016563415527, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 770000, "num_agent_steps_sampled": 2310000, "num_steps_trained": 770000, "num_agent_steps_trained": 2310000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2396, "training_iteration": 154, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-37-08", "timestamp": 1706229428, "time_this_iter_s": 11.277403116226196, "time_total_s": 1668.688771724701, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020284554CA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1668.688771724701, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 9.968750000000002, "ram_util_percent": 51.9375}}
{"episode_reward_max": 193.2385709751396, "episode_reward_min": -266.75915344804525, "episode_reward_mean": 143.23978290661466, "episode_len_mean": 496.56, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -95.40713151047628}, "policy_reward_max": {"shared_policy": 64.72670998610555}, "policy_reward_mean": {"shared_policy": 47.7465943022049}, "custom_metrics": {}, "hist_stats": {"episode_reward": [138.85884294658922, 118.23865871876478, 171.9425156861546, 141.23024947557136, 145.6387950167989, 183.23568604467408, 146.47452440112866, 136.04299007914938, 156.93075657263378, 151.88124284893277, 147.70007305592281, 151.25925552472484, 150.97883236315087, 149.67422686517224, 138.83259011805083, 154.10413919761777, 158.15169725567117, 175.65638051973636, 134.12810964882345, 112.54566702619194, 168.15726970508715, 166.2227442786095, 166.36270800232873, 137.2502657929437, 115.45441776700315, 127.27008739300072, 130.83074385277, 172.69361599907276, 167.52945826057083, 154.32500755786884, 125.22592872753737, 155.96359985694266, 142.4297986354211, 177.2064415290951, 145.82515918649727, 129.04278539121148, 143.69036270026115, 134.25870074878924, 137.2062404770403, 141.0432262793181, 138.30965552851544, 98.96139871678314, 142.28391939681043, 162.8527155201883, 165.130174562335, 134.2178065665067, 113.58867526799439, 124.71795557066798, 154.25048878602664, 149.9788582511245, 159.69247544463715, 147.98436296172454, 165.65664058923724, 161.54090266674748, 147.46245200443062, 160.6209659683518, 150.38144159596385, 111.40446131303904, 112.13900048285723, 153.57758372277002, 162.69701835140566, 137.34343376196932, 140.4473799057305, 151.23687750083647, 184.25711887143518, 173.6957300044595, 117.13885906571522, 158.89768863096836, 123.71074153855442, 171.90891383402027, 155.54760999139378, 139.5505314320327, 151.09174324944604, 193.2385709751396, 171.0001661926511, 168.65598125010717, 143.46995116211482, 122.23662372678517, 165.72305403649804, 183.82322385162092, 150.47785477340227, 134.89787428360432, 175.10353946709057, 139.86600125208497, 189.65264766849566, 127.85625144187358, 163.01622824883083, 126.89877328276634, 147.22185173165036, 161.29995676130034, 122.884271916002, 138.09096900373692, -266.75915344804525, 135.77109112963083, 95.4672312773764, 139.87140977010137, 132.0951942801476, 128.901290576905, 170.22656390816, 139.22149557992816], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 156, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [46.146468602120876, 46.34365360066295, 46.36872074380517, 39.31776199489832, 39.329022876918316, 39.59187384694815, 57.528083751599, 57.24685350308816, 57.16757843146722, 47.28858834120909, 46.686551131308065, 47.25511000305413, 48.47852257204552, 48.587622725249574, 48.572649719504014, 60.747079789638505, 61.390312354546026, 61.09829390048979, 49.067599425713226, 48.62533713380496, 48.78158784161012, 45.286146129171044, 45.850876436258346, 44.905967513720185, 52.57667487611373, 51.85989098747571, 52.49419070904453, 50.195348948240266, 50.789324227720485, 50.89656967297195, 49.43598049320279, 49.440061790868626, 48.824030771851525, 50.607780380795404, 50.41374120364587, 50.23773394028346, 50.29742456103365, 50.182923647264644, 50.49848415485273, 49.78540665159623, 49.89294866720836, 49.99587154636781, 45.956792081395776, 46.42317022631565, 46.45262781033912, 51.57214622572063, 51.17336833477019, 51.35862463712691, 52.700043457249805, 52.834836045900985, 52.61681775252025, 58.22357696294783, 58.30069330334662, 59.132110253442065, 44.5656039516131, 44.64567508051792, 44.91683061669269, 37.433664468427494, 37.657870934655264, 37.45413162310918, 55.80118922889231, 56.21198880858718, 56.14409166760741, 55.26339209079741, 55.75557174533604, 55.20378044247626, 55.08817231158416, 55.67433906594913, 55.6001966247956, 45.66285956402619, 45.52892021586497, 46.05848601305236, 38.30060825745264, 38.627024051422865, 38.52678545812765, 42.27678386121988, 42.193790167570114, 42.799513364210725, 43.924971790130556, 43.298832704623536, 43.60693935801585, 57.357624116043255, 57.57798066238563, 57.75801122064392, 56.36970338824902, 55.909007653594, 55.25074721872805, 51.52265101174514, 51.429920824865505, 51.37243572125833, 41.66365697483221, 41.58659580598274, 41.97567594672242, 51.76389946540196, 52.10240988930066, 52.097290502240256, 47.49159745872019, 47.188699729740605, 47.74950144696048, 59.478577863425, 59.46076508983968, 58.267098575830445, 48.532691287497684, 48.51762587825458, 48.77484202074508, 43.025222420692444, 42.73225925862789, 43.285303711891174, 47.87339924275874, 48.24747637752442, 47.569487079977975, 44.371378672619656, 44.93264274143924, 44.954679334730216, 45.992773893599704, 45.79769078766306, 45.415775795777634, 47.051225095987306, 46.95168980956076, 47.04031137377022, 46.148794412612915, 46.4295190833509, 45.731342032551765, 33.25744315710229, 33.10560702656706, 32.59834853311379, 47.27306324491899, 47.59436187303315, 47.41649427885811, 54.36369875632225, 54.35902490466832, 54.1299918591976, 55.18602316329877, 55.188067826131984, 54.756083572904274, 44.83911707873145, 44.64078083510199, 44.737908652673156, 37.99869242062171, 37.76085766901572, 37.82912517835696, 41.081368774175644, 41.618270091712475, 42.01831670477986, 51.41998023943354, 51.453142633972064, 51.377365912621215, 50.15642028301953, 50.2518064342439, 49.570631533861146, 53.20914877206086, 53.357565562240765, 53.125761110335574, 48.78349564969538, 49.65626669116317, 49.54460062086581, 55.20466831326483, 55.36548220366238, 55.08649007230996, 53.39476294815539, 53.932412341237054, 54.213727377355085, 48.85117776940267, 49.33129983154747, 49.27997440348069, 53.97868332344417, 53.22684707244237, 53.415435572465256, 49.53206750253837, 50.414262769433364, 50.435111323992416, 37.32290151591101, 37.09292610237995, 36.988633694748074, 37.15943917632103, 37.49539289623499, 37.48416841030121, 51.469112209975705, 50.935339167714105, 51.17313234508036, 54.197319877644375, 54.30656328921516, 54.19313518454631, 46.062946801384285, 46.41863462266822, 44.86185233791669, 46.439984470605836, 47.09247355535625, 46.91492187976836, 50.566684633008364, 50.529920918556556, 50.140271949271366, 61.14757541318734, 61.937854762499526, 61.17168869574864, 58.02143592884143, 57.58216143151124, 58.09213264410694, 38.59113818407059, 39.160094022750854, 39.38762685889378, 53.267282104740545, 52.86380580315988, 52.766600723067924, 41.44866704878707, 40.79729518791039, 41.46477930185695, 57.324555718650416, 57.26752182220419, 57.31683629316588, 52.201327054761336, 51.73234875500201, 51.6139341816306, 46.68454524129629, 46.47410739213228, 46.39187879860401, 50.07277321318786, 50.561790208021804, 50.457179828236505, 64.30616936832665, 64.2056916207075, 64.72670998610555, 56.779829869667694, 57.24333551774423, 56.97700080523889, 56.16721541186173, 56.28425237288077, 56.20451346536477, 47.891850999246046, 47.94134946229558, 47.63675070057313, 40.96273661901553, 41.33751695354779, 39.93637015422185, 55.631382986903176, 55.51951408386229, 54.57215696573256, 60.91940091053645, 61.709894063572094, 61.19392887751262, 50.23223909735678, 50.14247085154055, 50.10314482450484, 45.14881014109899, 44.88845448692639, 44.860609655578926, 58.0856345842282, 58.376019547382995, 58.64188533547956, 46.640686206519604, 46.40739653259516, 46.81791851297021, 63.38747675654788, 63.240008076032, 63.02516283591588, 43.009810641097516, 42.06926103929678, 42.77717976147929, 54.412391265388564, 54.273100614547715, 54.33073636889456, 42.08928854763508, 42.404246754944324, 42.40523798018694, 49.41063248272984, 49.23204985633491, 48.57916939258574, 53.893278583884225, 53.34089276194571, 54.065785415470586, 40.86867049584785, 41.130077748248965, 40.88552367190519, 46.0562935831646, 46.10532022888461, 45.92935519168773, -85.32310330371062, -86.02891863385837, -95.40713151047628, 45.59093780691424, 45.19507991025844, 44.98507341245809, 32.09360864137609, 31.76366241772969, 31.609960218270615, 46.646591813613966, 46.37496284892161, 46.849855107565716, 44.17607170467575, 44.083799244215086, 43.8353233312567, 42.60613781710465, 43.019643177588776, 43.27550958221157, 56.72032282501458, 56.89832088351248, 56.60792019963263, 46.3629058326284, 45.96095330516496, 46.89763644213477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1462999370707316, "mean_inference_ms": 0.7060465781857356, "mean_action_processing_ms": 0.10173488969362364, "mean_env_wait_ms": 0.8453887091809316, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 775000, "timesteps_this_iter": 0, "agent_timesteps_total": 2325000, "timers": {"sample_time_ms": 12217.481, "sample_throughput": 409.25, "load_time_ms": 0.112, "load_throughput": 44772672.929, "learn_time_ms": 1732.664, "learn_throughput": 2885.729, "update_time_ms": 8.632}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.466330862652141e-31, "cur_lr": 0.0005000000000000001, "total_loss": 127.10580520629883, "policy_loss": -0.001270340101472689, "vf_loss": 127.19100189208984, "vf_explained_var": 0.00025876760482788084, "kl": 0.0032091220724714204, "entropy": 8.393229866027832, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 775000, "num_agent_steps_sampled": 2325000, "num_steps_trained": 775000, "num_agent_steps_trained": 2325000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2407, "training_iteration": 155, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-37-19", "timestamp": 1706229439, "time_this_iter_s": 10.797115325927734, "time_total_s": 1679.4858870506287, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202837C8EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1679.4858870506287, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 9.099999999999998, "ram_util_percent": 51.82}}
{"episode_reward_max": 193.2385709751396, "episode_reward_min": -266.75915344804525, "episode_reward_mean": 143.55252713457097, "episode_len_mean": 496.56, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -95.40713151047628}, "policy_reward_max": {"shared_policy": 64.72670998610555}, "policy_reward_mean": {"shared_policy": 47.85084237819033}, "custom_metrics": {}, "hist_stats": {"episode_reward": [147.70007305592281, 151.25925552472484, 150.97883236315087, 149.67422686517224, 138.83259011805083, 154.10413919761777, 158.15169725567117, 175.65638051973636, 134.12810964882345, 112.54566702619194, 168.15726970508715, 166.2227442786095, 166.36270800232873, 137.2502657929437, 115.45441776700315, 127.27008739300072, 130.83074385277, 172.69361599907276, 167.52945826057083, 154.32500755786884, 125.22592872753737, 155.96359985694266, 142.4297986354211, 177.2064415290951, 145.82515918649727, 129.04278539121148, 143.69036270026115, 134.25870074878924, 137.2062404770403, 141.0432262793181, 138.30965552851544, 98.96139871678314, 142.28391939681043, 162.8527155201883, 165.130174562335, 134.2178065665067, 113.58867526799439, 124.71795557066798, 154.25048878602664, 149.9788582511245, 159.69247544463715, 147.98436296172454, 165.65664058923724, 161.54090266674748, 147.46245200443062, 160.6209659683518, 150.38144159596385, 111.40446131303904, 112.13900048285723, 153.57758372277002, 162.69701835140566, 137.34343376196932, 140.4473799057305, 151.23687750083647, 184.25711887143518, 173.6957300044595, 117.13885906571522, 158.89768863096836, 123.71074153855442, 171.90891383402027, 155.54760999139378, 139.5505314320327, 151.09174324944604, 193.2385709751396, 171.0001661926511, 168.65598125010717, 143.46995116211482, 122.23662372678517, 165.72305403649804, 183.82322385162092, 150.47785477340227, 134.89787428360432, 175.10353946709057, 139.86600125208497, 189.65264766849566, 127.85625144187358, 163.01622824883083, 126.89877328276634, 147.22185173165036, 161.29995676130034, 122.884271916002, 138.09096900373692, -266.75915344804525, 135.77109112963083, 95.4672312773764, 139.87140977010137, 132.0951942801476, 128.901290576905, 170.22656390816, 139.22149557992816, 167.29711811617014, 154.9146966449918, 120.2885249815881, 138.47574885562045, 135.63967868313182, 179.17125343903913, 154.04153778497118, 145.25080377608555, 153.17331822216528, 173.49600408226263], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 156, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [49.43598049320279, 49.440061790868626, 48.824030771851525, 50.607780380795404, 50.41374120364587, 50.23773394028346, 50.29742456103365, 50.182923647264644, 50.49848415485273, 49.78540665159623, 49.89294866720836, 49.99587154636781, 45.956792081395776, 46.42317022631565, 46.45262781033912, 51.57214622572063, 51.17336833477019, 51.35862463712691, 52.700043457249805, 52.834836045900985, 52.61681775252025, 58.22357696294783, 58.30069330334662, 59.132110253442065, 44.5656039516131, 44.64567508051792, 44.91683061669269, 37.433664468427494, 37.657870934655264, 37.45413162310918, 55.80118922889231, 56.21198880858718, 56.14409166760741, 55.26339209079741, 55.75557174533604, 55.20378044247626, 55.08817231158416, 55.67433906594913, 55.6001966247956, 45.66285956402619, 45.52892021586497, 46.05848601305236, 38.30060825745264, 38.627024051422865, 38.52678545812765, 42.27678386121988, 42.193790167570114, 42.799513364210725, 43.924971790130556, 43.298832704623536, 43.60693935801585, 57.357624116043255, 57.57798066238563, 57.75801122064392, 56.36970338824902, 55.909007653594, 55.25074721872805, 51.52265101174514, 51.429920824865505, 51.37243572125833, 41.66365697483221, 41.58659580598274, 41.97567594672242, 51.76389946540196, 52.10240988930066, 52.097290502240256, 47.49159745872019, 47.188699729740605, 47.74950144696048, 59.478577863425, 59.46076508983968, 58.267098575830445, 48.532691287497684, 48.51762587825458, 48.77484202074508, 43.025222420692444, 42.73225925862789, 43.285303711891174, 47.87339924275874, 48.24747637752442, 47.569487079977975, 44.371378672619656, 44.93264274143924, 44.954679334730216, 45.992773893599704, 45.79769078766306, 45.415775795777634, 47.051225095987306, 46.95168980956076, 47.04031137377022, 46.148794412612915, 46.4295190833509, 45.731342032551765, 33.25744315710229, 33.10560702656706, 32.59834853311379, 47.27306324491899, 47.59436187303315, 47.41649427885811, 54.36369875632225, 54.35902490466832, 54.1299918591976, 55.18602316329877, 55.188067826131984, 54.756083572904274, 44.83911707873145, 44.64078083510199, 44.737908652673156, 37.99869242062171, 37.76085766901572, 37.82912517835696, 41.081368774175644, 41.618270091712475, 42.01831670477986, 51.41998023943354, 51.453142633972064, 51.377365912621215, 50.15642028301953, 50.2518064342439, 49.570631533861146, 53.20914877206086, 53.357565562240765, 53.125761110335574, 48.78349564969538, 49.65626669116317, 49.54460062086581, 55.20466831326483, 55.36548220366238, 55.08649007230996, 53.39476294815539, 53.932412341237054, 54.213727377355085, 48.85117776940267, 49.33129983154747, 49.27997440348069, 53.97868332344417, 53.22684707244237, 53.415435572465256, 49.53206750253837, 50.414262769433364, 50.435111323992416, 37.32290151591101, 37.09292610237995, 36.988633694748074, 37.15943917632103, 37.49539289623499, 37.48416841030121, 51.469112209975705, 50.935339167714105, 51.17313234508036, 54.197319877644375, 54.30656328921516, 54.19313518454631, 46.062946801384285, 46.41863462266822, 44.86185233791669, 46.439984470605836, 47.09247355535625, 46.91492187976836, 50.566684633008364, 50.529920918556556, 50.140271949271366, 61.14757541318734, 61.937854762499526, 61.17168869574864, 58.02143592884143, 57.58216143151124, 58.09213264410694, 38.59113818407059, 39.160094022750854, 39.38762685889378, 53.267282104740545, 52.86380580315988, 52.766600723067924, 41.44866704878707, 40.79729518791039, 41.46477930185695, 57.324555718650416, 57.26752182220419, 57.31683629316588, 52.201327054761336, 51.73234875500201, 51.6139341816306, 46.68454524129629, 46.47410739213228, 46.39187879860401, 50.07277321318786, 50.561790208021804, 50.457179828236505, 64.30616936832665, 64.2056916207075, 64.72670998610555, 56.779829869667694, 57.24333551774423, 56.97700080523889, 56.16721541186173, 56.28425237288077, 56.20451346536477, 47.891850999246046, 47.94134946229558, 47.63675070057313, 40.96273661901553, 41.33751695354779, 39.93637015422185, 55.631382986903176, 55.51951408386229, 54.57215696573256, 60.91940091053645, 61.709894063572094, 61.19392887751262, 50.23223909735678, 50.14247085154055, 50.10314482450484, 45.14881014109899, 44.88845448692639, 44.860609655578926, 58.0856345842282, 58.376019547382995, 58.64188533547956, 46.640686206519604, 46.40739653259516, 46.81791851297021, 63.38747675654788, 63.240008076032, 63.02516283591588, 43.009810641097516, 42.06926103929678, 42.77717976147929, 54.412391265388564, 54.273100614547715, 54.33073636889456, 42.08928854763508, 42.404246754944324, 42.40523798018694, 49.41063248272984, 49.23204985633491, 48.57916939258574, 53.893278583884225, 53.34089276194571, 54.065785415470586, 40.86867049584785, 41.130077748248965, 40.88552367190519, 46.0562935831646, 46.10532022888461, 45.92935519168773, -85.32310330371062, -86.02891863385837, -95.40713151047628, 45.59093780691424, 45.19507991025844, 44.98507341245809, 32.09360864137609, 31.76366241772969, 31.609960218270615, 46.646591813613966, 46.37496284892161, 46.849855107565716, 44.17607170467575, 44.083799244215086, 43.8353233312567, 42.60613781710465, 43.019643177588776, 43.27550958221157, 56.72032282501458, 56.89832088351248, 56.60792019963263, 46.3629058326284, 45.96095330516496, 46.89763644213477, 55.44695546726386, 55.825517120460674, 56.024645528445646, 51.490831089516476, 51.7724718277653, 51.651393727709845, 40.14009630928436, 39.9275796363751, 40.22084903592864, 46.02325128267208, 46.35079357648888, 46.101703996459634, 45.78312005723515, 44.809325392047555, 45.0472332338492, 59.8340647003303, 59.92144790353875, 59.415740835169956, 51.09772298733394, 51.48268431673448, 51.461130480902895, 48.43851776917775, 48.3041724016269, 48.50811360528071, 50.912542459865406, 51.1673185651501, 51.09345719714959, 57.52889884014924, 58.094914120932415, 57.87219112118085]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14636064624311623, "mean_inference_ms": 0.7063927811600234, "mean_action_processing_ms": 0.10176581387059334, "mean_env_wait_ms": 0.8454907284851305, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 780000, "timesteps_this_iter": 0, "agent_timesteps_total": 2340000, "timers": {"sample_time_ms": 12205.263, "sample_throughput": 409.659, "load_time_ms": 0.112, "load_throughput": 44772672.929, "learn_time_ms": 1744.274, "learn_throughput": 2866.523, "update_time_ms": 8.642}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.733165431326071e-31, "cur_lr": 0.0005000000000000001, "total_loss": 12.94109582901001, "policy_loss": -0.0009476578740278852, "vf_loss": 13.028559398651122, "vf_explained_var": 0.00801832675933838, "kl": 0.0032095808303301853, "entropy": 8.651581382751464, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 780000, "num_agent_steps_sampled": 2340000, "num_steps_trained": 780000, "num_agent_steps_trained": 2340000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2417, "training_iteration": 156, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-37-30", "timestamp": 1706229450, "time_this_iter_s": 10.694666862487793, "time_total_s": 1690.1805539131165, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202825ADCA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1690.1805539131165, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 9.243749999999999, "ram_util_percent": 51.787499999999994}}
{"episode_reward_max": 198.23500210046757, "episode_reward_min": -266.75915344804525, "episode_reward_mean": 144.07297125399924, "episode_len_mean": 496.56, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -95.40713151047628}, "policy_reward_max": {"shared_policy": 66.16669589529435}, "policy_reward_mean": {"shared_policy": 48.02432375133309}, "custom_metrics": {}, "hist_stats": {"episode_reward": [168.15726970508715, 166.2227442786095, 166.36270800232873, 137.2502657929437, 115.45441776700315, 127.27008739300072, 130.83074385277, 172.69361599907276, 167.52945826057083, 154.32500755786884, 125.22592872753737, 155.96359985694266, 142.4297986354211, 177.2064415290951, 145.82515918649727, 129.04278539121148, 143.69036270026115, 134.25870074878924, 137.2062404770403, 141.0432262793181, 138.30965552851544, 98.96139871678314, 142.28391939681043, 162.8527155201883, 165.130174562335, 134.2178065665067, 113.58867526799439, 124.71795557066798, 154.25048878602664, 149.9788582511245, 159.69247544463715, 147.98436296172454, 165.65664058923724, 161.54090266674748, 147.46245200443062, 160.6209659683518, 150.38144159596385, 111.40446131303904, 112.13900048285723, 153.57758372277002, 162.69701835140566, 137.34343376196932, 140.4473799057305, 151.23687750083647, 184.25711887143518, 173.6957300044595, 117.13885906571522, 158.89768863096836, 123.71074153855442, 171.90891383402027, 155.54760999139378, 139.5505314320327, 151.09174324944604, 193.2385709751396, 171.0001661926511, 168.65598125010717, 143.46995116211482, 122.23662372678517, 165.72305403649804, 183.82322385162092, 150.47785477340227, 134.89787428360432, 175.10353946709057, 139.86600125208497, 189.65264766849566, 127.85625144187358, 163.01622824883083, 126.89877328276634, 147.22185173165036, 161.29995676130034, 122.884271916002, 138.09096900373692, -266.75915344804525, 135.77109112963083, 95.4672312773764, 139.87140977010137, 132.0951942801476, 128.901290576905, 170.22656390816, 139.22149557992816, 167.29711811617014, 154.9146966449918, 120.2885249815881, 138.47574885562045, 135.63967868313182, 179.17125343903913, 154.04153778497118, 145.25080377608555, 153.17331822216528, 173.49600408226263, 163.08339593559504, 174.87167711183426, 126.39833529945463, 124.67575918324289, 120.87745890766381, 198.23500210046757, 185.5245358683168, 169.66737266629926, 102.58381060790268, 159.15803583711406], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 156, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [55.80118922889231, 56.21198880858718, 56.14409166760741, 55.26339209079741, 55.75557174533604, 55.20378044247626, 55.08817231158416, 55.67433906594913, 55.6001966247956, 45.66285956402619, 45.52892021586497, 46.05848601305236, 38.30060825745264, 38.627024051422865, 38.52678545812765, 42.27678386121988, 42.193790167570114, 42.799513364210725, 43.924971790130556, 43.298832704623536, 43.60693935801585, 57.357624116043255, 57.57798066238563, 57.75801122064392, 56.36970338824902, 55.909007653594, 55.25074721872805, 51.52265101174514, 51.429920824865505, 51.37243572125833, 41.66365697483221, 41.58659580598274, 41.97567594672242, 51.76389946540196, 52.10240988930066, 52.097290502240256, 47.49159745872019, 47.188699729740605, 47.74950144696048, 59.478577863425, 59.46076508983968, 58.267098575830445, 48.532691287497684, 48.51762587825458, 48.77484202074508, 43.025222420692444, 42.73225925862789, 43.285303711891174, 47.87339924275874, 48.24747637752442, 47.569487079977975, 44.371378672619656, 44.93264274143924, 44.954679334730216, 45.992773893599704, 45.79769078766306, 45.415775795777634, 47.051225095987306, 46.95168980956076, 47.04031137377022, 46.148794412612915, 46.4295190833509, 45.731342032551765, 33.25744315710229, 33.10560702656706, 32.59834853311379, 47.27306324491899, 47.59436187303315, 47.41649427885811, 54.36369875632225, 54.35902490466832, 54.1299918591976, 55.18602316329877, 55.188067826131984, 54.756083572904274, 44.83911707873145, 44.64078083510199, 44.737908652673156, 37.99869242062171, 37.76085766901572, 37.82912517835696, 41.081368774175644, 41.618270091712475, 42.01831670477986, 51.41998023943354, 51.453142633972064, 51.377365912621215, 50.15642028301953, 50.2518064342439, 49.570631533861146, 53.20914877206086, 53.357565562240765, 53.125761110335574, 48.78349564969538, 49.65626669116317, 49.54460062086581, 55.20466831326483, 55.36548220366238, 55.08649007230996, 53.39476294815539, 53.932412341237054, 54.213727377355085, 48.85117776940267, 49.33129983154747, 49.27997440348069, 53.97868332344417, 53.22684707244237, 53.415435572465256, 49.53206750253837, 50.414262769433364, 50.435111323992416, 37.32290151591101, 37.09292610237995, 36.988633694748074, 37.15943917632103, 37.49539289623499, 37.48416841030121, 51.469112209975705, 50.935339167714105, 51.17313234508036, 54.197319877644375, 54.30656328921516, 54.19313518454631, 46.062946801384285, 46.41863462266822, 44.86185233791669, 46.439984470605836, 47.09247355535625, 46.91492187976836, 50.566684633008364, 50.529920918556556, 50.140271949271366, 61.14757541318734, 61.937854762499526, 61.17168869574864, 58.02143592884143, 57.58216143151124, 58.09213264410694, 38.59113818407059, 39.160094022750854, 39.38762685889378, 53.267282104740545, 52.86380580315988, 52.766600723067924, 41.44866704878707, 40.79729518791039, 41.46477930185695, 57.324555718650416, 57.26752182220419, 57.31683629316588, 52.201327054761336, 51.73234875500201, 51.6139341816306, 46.68454524129629, 46.47410739213228, 46.39187879860401, 50.07277321318786, 50.561790208021804, 50.457179828236505, 64.30616936832665, 64.2056916207075, 64.72670998610555, 56.779829869667694, 57.24333551774423, 56.97700080523889, 56.16721541186173, 56.28425237288077, 56.20451346536477, 47.891850999246046, 47.94134946229558, 47.63675070057313, 40.96273661901553, 41.33751695354779, 39.93637015422185, 55.631382986903176, 55.51951408386229, 54.57215696573256, 60.91940091053645, 61.709894063572094, 61.19392887751262, 50.23223909735678, 50.14247085154055, 50.10314482450484, 45.14881014109899, 44.88845448692639, 44.860609655578926, 58.0856345842282, 58.376019547382995, 58.64188533547956, 46.640686206519604, 46.40739653259516, 46.81791851297021, 63.38747675654788, 63.240008076032, 63.02516283591588, 43.009810641097516, 42.06926103929678, 42.77717976147929, 54.412391265388564, 54.273100614547715, 54.33073636889456, 42.08928854763508, 42.404246754944324, 42.40523798018694, 49.41063248272984, 49.23204985633491, 48.57916939258574, 53.893278583884225, 53.34089276194571, 54.065785415470586, 40.86867049584785, 41.130077748248965, 40.88552367190519, 46.0562935831646, 46.10532022888461, 45.92935519168773, -85.32310330371062, -86.02891863385837, -95.40713151047628, 45.59093780691424, 45.19507991025844, 44.98507341245809, 32.09360864137609, 31.76366241772969, 31.609960218270615, 46.646591813613966, 46.37496284892161, 46.849855107565716, 44.17607170467575, 44.083799244215086, 43.8353233312567, 42.60613781710465, 43.019643177588776, 43.27550958221157, 56.72032282501458, 56.89832088351248, 56.60792019963263, 46.3629058326284, 45.96095330516496, 46.89763644213477, 55.44695546726386, 55.825517120460674, 56.024645528445646, 51.490831089516476, 51.7724718277653, 51.651393727709845, 40.14009630928436, 39.9275796363751, 40.22084903592864, 46.02325128267208, 46.35079357648888, 46.101703996459634, 45.78312005723515, 44.809325392047555, 45.0472332338492, 59.8340647003303, 59.92144790353875, 59.415740835169956, 51.09772298733394, 51.48268431673448, 51.461130480902895, 48.43851776917775, 48.3041724016269, 48.50811360528071, 50.912542459865406, 51.1673185651501, 51.09345719714959, 57.52889884014924, 58.094914120932415, 57.87219112118085, 54.13970324397086, 54.323950998485074, 54.61974169313906, 58.1850747168064, 58.5537002198398, 58.13290217518805, 41.97159260511398, 42.40209465380758, 42.024648040533066, 41.918619316692144, 41.37050762275854, 41.38663224379221, 40.29353707035382, 40.077195567389325, 40.50672626992066, 66.03630611548822, 66.03200008968513, 66.16669589529435, 61.603873570760086, 61.969419516002134, 61.951242781554654, 56.528512736161545, 57.04038382818301, 56.09847610195477, 33.92312905440727, 34.186493592957646, 34.47418796053776, 53.08698782821496, 53.22781166185935, 52.843236347039536]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1464163758076576, "mean_inference_ms": 0.7067539768022648, "mean_action_processing_ms": 0.10180656730434108, "mean_env_wait_ms": 0.8456032323272292, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 785000, "timesteps_this_iter": 0, "agent_timesteps_total": 2355000, "timers": {"sample_time_ms": 12248.667, "sample_throughput": 408.208, "load_time_ms": 0.112, "load_throughput": 44772672.929, "learn_time_ms": 1744.308, "learn_throughput": 2866.467, "update_time_ms": 8.557}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3665827156630353e-31, "cur_lr": 0.0005000000000000001, "total_loss": 9.48023681640625, "policy_loss": 0.002686517360355156, "vf_loss": 9.561667346954346, "vf_explained_var": 0.012807542085647583, "kl": 0.012244078528633368, "entropy": 8.411683750152587, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 785000, "num_agent_steps_sampled": 2355000, "num_steps_trained": 785000, "num_agent_steps_trained": 2355000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2427, "training_iteration": 157, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-37-41", "timestamp": 1706229461, "time_this_iter_s": 11.214952945709229, "time_total_s": 1701.3955068588257, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020284585040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1701.3955068588257, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 10.65625, "ram_util_percent": 51.90625}}
{"episode_reward_max": 198.23500210046757, "episode_reward_min": -266.75915344804525, "episode_reward_mean": 143.6974029402359, "episode_len_mean": 496.56, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -95.40713151047628}, "policy_reward_max": {"shared_policy": 66.16669589529435}, "policy_reward_mean": {"shared_policy": 47.89913431341197}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.22592872753737, 155.96359985694266, 142.4297986354211, 177.2064415290951, 145.82515918649727, 129.04278539121148, 143.69036270026115, 134.25870074878924, 137.2062404770403, 141.0432262793181, 138.30965552851544, 98.96139871678314, 142.28391939681043, 162.8527155201883, 165.130174562335, 134.2178065665067, 113.58867526799439, 124.71795557066798, 154.25048878602664, 149.9788582511245, 159.69247544463715, 147.98436296172454, 165.65664058923724, 161.54090266674748, 147.46245200443062, 160.6209659683518, 150.38144159596385, 111.40446131303904, 112.13900048285723, 153.57758372277002, 162.69701835140566, 137.34343376196932, 140.4473799057305, 151.23687750083647, 184.25711887143518, 173.6957300044595, 117.13885906571522, 158.89768863096836, 123.71074153855442, 171.90891383402027, 155.54760999139378, 139.5505314320327, 151.09174324944604, 193.2385709751396, 171.0001661926511, 168.65598125010717, 143.46995116211482, 122.23662372678517, 165.72305403649804, 183.82322385162092, 150.47785477340227, 134.89787428360432, 175.10353946709057, 139.86600125208497, 189.65264766849566, 127.85625144187358, 163.01622824883083, 126.89877328276634, 147.22185173165036, 161.29995676130034, 122.884271916002, 138.09096900373692, -266.75915344804525, 135.77109112963083, 95.4672312773764, 139.87140977010137, 132.0951942801476, 128.901290576905, 170.22656390816, 139.22149557992816, 167.29711811617014, 154.9146966449918, 120.2885249815881, 138.47574885562045, 135.63967868313182, 179.17125343903913, 154.04153778497118, 145.25080377608555, 153.17331822216528, 173.49600408226263, 163.08339593559504, 174.87167711183426, 126.39833529945463, 124.67575918324289, 120.87745890766381, 198.23500210046757, 185.5245358683168, 169.66737266629926, 102.58381060790268, 159.15803583711406, 154.29903959855423, 135.4910462051629, 186.0960291894151, 95.36704777088013, 128.73582166433334, 172.78337686322644, 171.36497702635793, 151.52845612168312, 155.3440742841921, 117.52961850911376], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 156, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [41.66365697483221, 41.58659580598274, 41.97567594672242, 51.76389946540196, 52.10240988930066, 52.097290502240256, 47.49159745872019, 47.188699729740605, 47.74950144696048, 59.478577863425, 59.46076508983968, 58.267098575830445, 48.532691287497684, 48.51762587825458, 48.77484202074508, 43.025222420692444, 42.73225925862789, 43.285303711891174, 47.87339924275874, 48.24747637752442, 47.569487079977975, 44.371378672619656, 44.93264274143924, 44.954679334730216, 45.992773893599704, 45.79769078766306, 45.415775795777634, 47.051225095987306, 46.95168980956076, 47.04031137377022, 46.148794412612915, 46.4295190833509, 45.731342032551765, 33.25744315710229, 33.10560702656706, 32.59834853311379, 47.27306324491899, 47.59436187303315, 47.41649427885811, 54.36369875632225, 54.35902490466832, 54.1299918591976, 55.18602316329877, 55.188067826131984, 54.756083572904274, 44.83911707873145, 44.64078083510199, 44.737908652673156, 37.99869242062171, 37.76085766901572, 37.82912517835696, 41.081368774175644, 41.618270091712475, 42.01831670477986, 51.41998023943354, 51.453142633972064, 51.377365912621215, 50.15642028301953, 50.2518064342439, 49.570631533861146, 53.20914877206086, 53.357565562240765, 53.125761110335574, 48.78349564969538, 49.65626669116317, 49.54460062086581, 55.20466831326483, 55.36548220366238, 55.08649007230996, 53.39476294815539, 53.932412341237054, 54.213727377355085, 48.85117776940267, 49.33129983154747, 49.27997440348069, 53.97868332344417, 53.22684707244237, 53.415435572465256, 49.53206750253837, 50.414262769433364, 50.435111323992416, 37.32290151591101, 37.09292610237995, 36.988633694748074, 37.15943917632103, 37.49539289623499, 37.48416841030121, 51.469112209975705, 50.935339167714105, 51.17313234508036, 54.197319877644375, 54.30656328921516, 54.19313518454631, 46.062946801384285, 46.41863462266822, 44.86185233791669, 46.439984470605836, 47.09247355535625, 46.91492187976836, 50.566684633008364, 50.529920918556556, 50.140271949271366, 61.14757541318734, 61.937854762499526, 61.17168869574864, 58.02143592884143, 57.58216143151124, 58.09213264410694, 38.59113818407059, 39.160094022750854, 39.38762685889378, 53.267282104740545, 52.86380580315988, 52.766600723067924, 41.44866704878707, 40.79729518791039, 41.46477930185695, 57.324555718650416, 57.26752182220419, 57.31683629316588, 52.201327054761336, 51.73234875500201, 51.6139341816306, 46.68454524129629, 46.47410739213228, 46.39187879860401, 50.07277321318786, 50.561790208021804, 50.457179828236505, 64.30616936832665, 64.2056916207075, 64.72670998610555, 56.779829869667694, 57.24333551774423, 56.97700080523889, 56.16721541186173, 56.28425237288077, 56.20451346536477, 47.891850999246046, 47.94134946229558, 47.63675070057313, 40.96273661901553, 41.33751695354779, 39.93637015422185, 55.631382986903176, 55.51951408386229, 54.57215696573256, 60.91940091053645, 61.709894063572094, 61.19392887751262, 50.23223909735678, 50.14247085154055, 50.10314482450484, 45.14881014109899, 44.88845448692639, 44.860609655578926, 58.0856345842282, 58.376019547382995, 58.64188533547956, 46.640686206519604, 46.40739653259516, 46.81791851297021, 63.38747675654788, 63.240008076032, 63.02516283591588, 43.009810641097516, 42.06926103929678, 42.77717976147929, 54.412391265388564, 54.273100614547715, 54.33073636889456, 42.08928854763508, 42.404246754944324, 42.40523798018694, 49.41063248272984, 49.23204985633491, 48.57916939258574, 53.893278583884225, 53.34089276194571, 54.065785415470586, 40.86867049584785, 41.130077748248965, 40.88552367190519, 46.0562935831646, 46.10532022888461, 45.92935519168773, -85.32310330371062, -86.02891863385837, -95.40713151047628, 45.59093780691424, 45.19507991025844, 44.98507341245809, 32.09360864137609, 31.76366241772969, 31.609960218270615, 46.646591813613966, 46.37496284892161, 46.849855107565716, 44.17607170467575, 44.083799244215086, 43.8353233312567, 42.60613781710465, 43.019643177588776, 43.27550958221157, 56.72032282501458, 56.89832088351248, 56.60792019963263, 46.3629058326284, 45.96095330516496, 46.89763644213477, 55.44695546726386, 55.825517120460674, 56.024645528445646, 51.490831089516476, 51.7724718277653, 51.651393727709845, 40.14009630928436, 39.9275796363751, 40.22084903592864, 46.02325128267208, 46.35079357648888, 46.101703996459634, 45.78312005723515, 44.809325392047555, 45.0472332338492, 59.8340647003303, 59.92144790353875, 59.415740835169956, 51.09772298733394, 51.48268431673448, 51.461130480902895, 48.43851776917775, 48.3041724016269, 48.50811360528071, 50.912542459865406, 51.1673185651501, 51.09345719714959, 57.52889884014924, 58.094914120932415, 57.87219112118085, 54.13970324397086, 54.323950998485074, 54.61974169313906, 58.1850747168064, 58.5537002198398, 58.13290217518805, 41.97159260511398, 42.40209465380758, 42.024648040533066, 41.918619316692144, 41.37050762275854, 41.38663224379221, 40.29353707035382, 40.077195567389325, 40.50672626992066, 66.03630611548822, 66.03200008968513, 66.16669589529435, 61.603873570760086, 61.969419516002134, 61.951242781554654, 56.528512736161545, 57.04038382818301, 56.09847610195477, 33.92312905440727, 34.186493592957646, 34.47418796053776, 53.08698782821496, 53.22781166185935, 52.843236347039536, 51.47581179315846, 51.14202393839757, 51.68120386699836, 45.07382538417974, 45.678913484017045, 44.73830733696619, 61.82250390946864, 62.33486398775129, 61.938661292195306, 31.580767820278794, 32.164166474404425, 31.622113476196915, 43.11683538307746, 42.72180004914601, 42.89718623210986, 57.32326763371627, 57.62462249646585, 57.83548673304419, 57.22358405341704, 57.1252448366334, 57.01614813630779, 50.67031637579201, 50.25279310345648, 50.60534664243458, 51.93605257570742, 52.005031166132525, 51.402990542352185, 39.186905222634465, 39.189437488714844, 39.15327579776445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14647465884372926, "mean_inference_ms": 0.7071181713204573, "mean_action_processing_ms": 0.101845937219675, "mean_env_wait_ms": 0.845723451490604, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 790000, "timesteps_this_iter": 0, "agent_timesteps_total": 2370000, "timers": {"sample_time_ms": 12256.219, "sample_throughput": 407.956, "load_time_ms": 0.1, "load_throughput": 49979790.276, "learn_time_ms": 1752.987, "learn_throughput": 2852.274, "update_time_ms": 8.563}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3665827156630353e-31, "cur_lr": 0.0005000000000000001, "total_loss": 8.44938039779663, "policy_loss": 0.001724985511767052, "vf_loss": 8.532424354553223, "vf_explained_var": 0.010169678926467895, "kl": 0.012791202054392123, "entropy": 8.47686939239502, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 790000, "num_agent_steps_sampled": 2370000, "num_steps_trained": 790000, "num_agent_steps_trained": 2370000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2437, "training_iteration": 158, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-37-52", "timestamp": 1706229472, "time_this_iter_s": 10.83480453491211, "time_total_s": 1712.2303113937378, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028379EDC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1712.2303113937378, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 10.2, "ram_util_percent": 52.013333333333335}}
{"episode_reward_max": 198.23500210046757, "episode_reward_min": -266.75915344804525, "episode_reward_mean": 143.4138304528041, "episode_len_mean": 496.56, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -95.40713151047628}, "policy_reward_max": {"shared_policy": 66.16669589529435}, "policy_reward_mean": {"shared_policy": 47.8046101509347}, "custom_metrics": {}, "hist_stats": {"episode_reward": [138.30965552851544, 98.96139871678314, 142.28391939681043, 162.8527155201883, 165.130174562335, 134.2178065665067, 113.58867526799439, 124.71795557066798, 154.25048878602664, 149.9788582511245, 159.69247544463715, 147.98436296172454, 165.65664058923724, 161.54090266674748, 147.46245200443062, 160.6209659683518, 150.38144159596385, 111.40446131303904, 112.13900048285723, 153.57758372277002, 162.69701835140566, 137.34343376196932, 140.4473799057305, 151.23687750083647, 184.25711887143518, 173.6957300044595, 117.13885906571522, 158.89768863096836, 123.71074153855442, 171.90891383402027, 155.54760999139378, 139.5505314320327, 151.09174324944604, 193.2385709751396, 171.0001661926511, 168.65598125010717, 143.46995116211482, 122.23662372678517, 165.72305403649804, 183.82322385162092, 150.47785477340227, 134.89787428360432, 175.10353946709057, 139.86600125208497, 189.65264766849566, 127.85625144187358, 163.01622824883083, 126.89877328276634, 147.22185173165036, 161.29995676130034, 122.884271916002, 138.09096900373692, -266.75915344804525, 135.77109112963083, 95.4672312773764, 139.87140977010137, 132.0951942801476, 128.901290576905, 170.22656390816, 139.22149557992816, 167.29711811617014, 154.9146966449918, 120.2885249815881, 138.47574885562045, 135.63967868313182, 179.17125343903913, 154.04153778497118, 145.25080377608555, 153.17331822216528, 173.49600408226263, 163.08339593559504, 174.87167711183426, 126.39833529945463, 124.67575918324289, 120.87745890766381, 198.23500210046757, 185.5245358683168, 169.66737266629926, 102.58381060790268, 159.15803583711406, 154.29903959855423, 135.4910462051629, 186.0960291894151, 95.36704777088013, 128.73582166433334, 172.78337686322644, 171.36497702635793, 151.52845612168312, 155.3440742841921, 117.52961850911376, 136.56728994520358, 147.796087389812, 134.78222066909086, 141.85314263217168, 136.6406906582414, 145.11742031201706, 145.3592088855799, 175.798382211942, 108.51369745656847, 131.106854628306], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 156, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [46.148794412612915, 46.4295190833509, 45.731342032551765, 33.25744315710229, 33.10560702656706, 32.59834853311379, 47.27306324491899, 47.59436187303315, 47.41649427885811, 54.36369875632225, 54.35902490466832, 54.1299918591976, 55.18602316329877, 55.188067826131984, 54.756083572904274, 44.83911707873145, 44.64078083510199, 44.737908652673156, 37.99869242062171, 37.76085766901572, 37.82912517835696, 41.081368774175644, 41.618270091712475, 42.01831670477986, 51.41998023943354, 51.453142633972064, 51.377365912621215, 50.15642028301953, 50.2518064342439, 49.570631533861146, 53.20914877206086, 53.357565562240765, 53.125761110335574, 48.78349564969538, 49.65626669116317, 49.54460062086581, 55.20466831326483, 55.36548220366238, 55.08649007230996, 53.39476294815539, 53.932412341237054, 54.213727377355085, 48.85117776940267, 49.33129983154747, 49.27997440348069, 53.97868332344417, 53.22684707244237, 53.415435572465256, 49.53206750253837, 50.414262769433364, 50.435111323992416, 37.32290151591101, 37.09292610237995, 36.988633694748074, 37.15943917632103, 37.49539289623499, 37.48416841030121, 51.469112209975705, 50.935339167714105, 51.17313234508036, 54.197319877644375, 54.30656328921516, 54.19313518454631, 46.062946801384285, 46.41863462266822, 44.86185233791669, 46.439984470605836, 47.09247355535625, 46.91492187976836, 50.566684633008364, 50.529920918556556, 50.140271949271366, 61.14757541318734, 61.937854762499526, 61.17168869574864, 58.02143592884143, 57.58216143151124, 58.09213264410694, 38.59113818407059, 39.160094022750854, 39.38762685889378, 53.267282104740545, 52.86380580315988, 52.766600723067924, 41.44866704878707, 40.79729518791039, 41.46477930185695, 57.324555718650416, 57.26752182220419, 57.31683629316588, 52.201327054761336, 51.73234875500201, 51.6139341816306, 46.68454524129629, 46.47410739213228, 46.39187879860401, 50.07277321318786, 50.561790208021804, 50.457179828236505, 64.30616936832665, 64.2056916207075, 64.72670998610555, 56.779829869667694, 57.24333551774423, 56.97700080523889, 56.16721541186173, 56.28425237288077, 56.20451346536477, 47.891850999246046, 47.94134946229558, 47.63675070057313, 40.96273661901553, 41.33751695354779, 39.93637015422185, 55.631382986903176, 55.51951408386229, 54.57215696573256, 60.91940091053645, 61.709894063572094, 61.19392887751262, 50.23223909735678, 50.14247085154055, 50.10314482450484, 45.14881014109899, 44.88845448692639, 44.860609655578926, 58.0856345842282, 58.376019547382995, 58.64188533547956, 46.640686206519604, 46.40739653259516, 46.81791851297021, 63.38747675654788, 63.240008076032, 63.02516283591588, 43.009810641097516, 42.06926103929678, 42.77717976147929, 54.412391265388564, 54.273100614547715, 54.33073636889456, 42.08928854763508, 42.404246754944324, 42.40523798018694, 49.41063248272984, 49.23204985633491, 48.57916939258574, 53.893278583884225, 53.34089276194571, 54.065785415470586, 40.86867049584785, 41.130077748248965, 40.88552367190519, 46.0562935831646, 46.10532022888461, 45.92935519168773, -85.32310330371062, -86.02891863385837, -95.40713151047628, 45.59093780691424, 45.19507991025844, 44.98507341245809, 32.09360864137609, 31.76366241772969, 31.609960218270615, 46.646591813613966, 46.37496284892161, 46.849855107565716, 44.17607170467575, 44.083799244215086, 43.8353233312567, 42.60613781710465, 43.019643177588776, 43.27550958221157, 56.72032282501458, 56.89832088351248, 56.60792019963263, 46.3629058326284, 45.96095330516496, 46.89763644213477, 55.44695546726386, 55.825517120460674, 56.024645528445646, 51.490831089516476, 51.7724718277653, 51.651393727709845, 40.14009630928436, 39.9275796363751, 40.22084903592864, 46.02325128267208, 46.35079357648888, 46.101703996459634, 45.78312005723515, 44.809325392047555, 45.0472332338492, 59.8340647003303, 59.92144790353875, 59.415740835169956, 51.09772298733394, 51.48268431673448, 51.461130480902895, 48.43851776917775, 48.3041724016269, 48.50811360528071, 50.912542459865406, 51.1673185651501, 51.09345719714959, 57.52889884014924, 58.094914120932415, 57.87219112118085, 54.13970324397086, 54.323950998485074, 54.61974169313906, 58.1850747168064, 58.5537002198398, 58.13290217518805, 41.97159260511398, 42.40209465380758, 42.024648040533066, 41.918619316692144, 41.37050762275854, 41.38663224379221, 40.29353707035382, 40.077195567389325, 40.50672626992066, 66.03630611548822, 66.03200008968513, 66.16669589529435, 61.603873570760086, 61.969419516002134, 61.951242781554654, 56.528512736161545, 57.04038382818301, 56.09847610195477, 33.92312905440727, 34.186493592957646, 34.47418796053776, 53.08698782821496, 53.22781166185935, 52.843236347039536, 51.47581179315846, 51.14202393839757, 51.68120386699836, 45.07382538417974, 45.678913484017045, 44.73830733696619, 61.82250390946864, 62.33486398775129, 61.938661292195306, 31.580767820278794, 32.164166474404425, 31.622113476196915, 43.11683538307746, 42.72180004914601, 42.89718623210986, 57.32326763371627, 57.62462249646585, 57.83548673304419, 57.22358405341704, 57.1252448366334, 57.01614813630779, 50.67031637579201, 50.25279310345648, 50.60534664243458, 51.93605257570742, 52.005031166132525, 51.402990542352185, 39.186905222634465, 39.189437488714844, 39.15327579776445, 45.199211473266274, 45.54385484258333, 45.82422362935418, 49.318454434474305, 48.714646865924195, 49.76298608941336, 44.70243705560763, 45.06040330169101, 45.01938031179209, 47.10215480377276, 47.54015494448443, 47.21083288391431, 45.50006594508886, 45.79960120841861, 45.34102350473404, 48.32709345966576, 48.4656268917024, 48.324699960649, 48.65997372940181, 48.36912830173968, 48.33010685443877, 58.92493811668827, 58.4045362100005, 58.468907885253415, 36.12564266224702, 36.402655379225806, 35.98539941509564, 42.96995927890141, 44.0055447195967, 44.131350629807756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14652459463730716, "mean_inference_ms": 0.7074460176146659, "mean_action_processing_ms": 0.10187875763165556, "mean_env_wait_ms": 0.845811917761754, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 795000, "timesteps_this_iter": 0, "agent_timesteps_total": 2385000, "timers": {"sample_time_ms": 12209.558, "sample_throughput": 409.515, "load_time_ms": 0.1, "load_throughput": 49979790.276, "learn_time_ms": 1751.628, "learn_throughput": 2854.487, "update_time_ms": 8.719}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3665827156630353e-31, "cur_lr": 0.0005000000000000001, "total_loss": 9.391449451446533, "policy_loss": 0.0038318853815319186, "vf_loss": 9.471113204956055, "vf_explained_var": 0.002577453851699829, "kl": 0.018077075295183733, "entropy": 8.349573612213135, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 795000, "num_agent_steps_sampled": 2385000, "num_steps_trained": 795000, "num_agent_steps_trained": 2385000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2447, "training_iteration": 159, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-38-03", "timestamp": 1706229483, "time_this_iter_s": 11.289767503738403, "time_total_s": 1723.5200788974762, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028216BEE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1723.5200788974762, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 9.631250000000001, "ram_util_percent": 52.10625}}
{"episode_reward_max": 198.23500210046757, "episode_reward_min": -266.75915344804525, "episode_reward_mean": 144.42141947455758, "episode_len_mean": 496.56, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -95.40713151047628}, "policy_reward_max": {"shared_policy": 66.16669589529435}, "policy_reward_mean": {"shared_policy": 48.14047315818586}, "custom_metrics": {}, "hist_stats": {"episode_reward": [159.69247544463715, 147.98436296172454, 165.65664058923724, 161.54090266674748, 147.46245200443062, 160.6209659683518, 150.38144159596385, 111.40446131303904, 112.13900048285723, 153.57758372277002, 162.69701835140566, 137.34343376196932, 140.4473799057305, 151.23687750083647, 184.25711887143518, 173.6957300044595, 117.13885906571522, 158.89768863096836, 123.71074153855442, 171.90891383402027, 155.54760999139378, 139.5505314320327, 151.09174324944604, 193.2385709751396, 171.0001661926511, 168.65598125010717, 143.46995116211482, 122.23662372678517, 165.72305403649804, 183.82322385162092, 150.47785477340227, 134.89787428360432, 175.10353946709057, 139.86600125208497, 189.65264766849566, 127.85625144187358, 163.01622824883083, 126.89877328276634, 147.22185173165036, 161.29995676130034, 122.884271916002, 138.09096900373692, -266.75915344804525, 135.77109112963083, 95.4672312773764, 139.87140977010137, 132.0951942801476, 128.901290576905, 170.22656390816, 139.22149557992816, 167.29711811617014, 154.9146966449918, 120.2885249815881, 138.47574885562045, 135.63967868313182, 179.17125343903913, 154.04153778497118, 145.25080377608555, 153.17331822216528, 173.49600408226263, 163.08339593559504, 174.87167711183426, 126.39833529945463, 124.67575918324289, 120.87745890766381, 198.23500210046757, 185.5245358683168, 169.66737266629926, 102.58381060790268, 159.15803583711406, 154.29903959855423, 135.4910462051629, 186.0960291894151, 95.36704777088013, 128.73582166433334, 172.78337686322644, 171.36497702635793, 151.52845612168312, 155.3440742841921, 117.52961850911376, 136.56728994520358, 147.796087389812, 134.78222066909086, 141.85314263217168, 136.6406906582414, 145.11742031201706, 145.3592088855799, 175.798382211942, 108.51369745656847, 131.106854628306, 195.06479448080063, 145.2997135668993, 131.98854989930973, 127.29172888584434, 150.53911297395842, 130.90787611994892, 161.80289067700542, 147.25767718255514, 140.8531400859356, 154.04506647004743], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 156, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [53.20914877206086, 53.357565562240765, 53.125761110335574, 48.78349564969538, 49.65626669116317, 49.54460062086581, 55.20466831326483, 55.36548220366238, 55.08649007230996, 53.39476294815539, 53.932412341237054, 54.213727377355085, 48.85117776940267, 49.33129983154747, 49.27997440348069, 53.97868332344417, 53.22684707244237, 53.415435572465256, 49.53206750253837, 50.414262769433364, 50.435111323992416, 37.32290151591101, 37.09292610237995, 36.988633694748074, 37.15943917632103, 37.49539289623499, 37.48416841030121, 51.469112209975705, 50.935339167714105, 51.17313234508036, 54.197319877644375, 54.30656328921516, 54.19313518454631, 46.062946801384285, 46.41863462266822, 44.86185233791669, 46.439984470605836, 47.09247355535625, 46.91492187976836, 50.566684633008364, 50.529920918556556, 50.140271949271366, 61.14757541318734, 61.937854762499526, 61.17168869574864, 58.02143592884143, 57.58216143151124, 58.09213264410694, 38.59113818407059, 39.160094022750854, 39.38762685889378, 53.267282104740545, 52.86380580315988, 52.766600723067924, 41.44866704878707, 40.79729518791039, 41.46477930185695, 57.324555718650416, 57.26752182220419, 57.31683629316588, 52.201327054761336, 51.73234875500201, 51.6139341816306, 46.68454524129629, 46.47410739213228, 46.39187879860401, 50.07277321318786, 50.561790208021804, 50.457179828236505, 64.30616936832665, 64.2056916207075, 64.72670998610555, 56.779829869667694, 57.24333551774423, 56.97700080523889, 56.16721541186173, 56.28425237288077, 56.20451346536477, 47.891850999246046, 47.94134946229558, 47.63675070057313, 40.96273661901553, 41.33751695354779, 39.93637015422185, 55.631382986903176, 55.51951408386229, 54.57215696573256, 60.91940091053645, 61.709894063572094, 61.19392887751262, 50.23223909735678, 50.14247085154055, 50.10314482450484, 45.14881014109899, 44.88845448692639, 44.860609655578926, 58.0856345842282, 58.376019547382995, 58.64188533547956, 46.640686206519604, 46.40739653259516, 46.81791851297021, 63.38747675654788, 63.240008076032, 63.02516283591588, 43.009810641097516, 42.06926103929678, 42.77717976147929, 54.412391265388564, 54.273100614547715, 54.33073636889456, 42.08928854763508, 42.404246754944324, 42.40523798018694, 49.41063248272984, 49.23204985633491, 48.57916939258574, 53.893278583884225, 53.34089276194571, 54.065785415470586, 40.86867049584785, 41.130077748248965, 40.88552367190519, 46.0562935831646, 46.10532022888461, 45.92935519168773, -85.32310330371062, -86.02891863385837, -95.40713151047628, 45.59093780691424, 45.19507991025844, 44.98507341245809, 32.09360864137609, 31.76366241772969, 31.609960218270615, 46.646591813613966, 46.37496284892161, 46.849855107565716, 44.17607170467575, 44.083799244215086, 43.8353233312567, 42.60613781710465, 43.019643177588776, 43.27550958221157, 56.72032282501458, 56.89832088351248, 56.60792019963263, 46.3629058326284, 45.96095330516496, 46.89763644213477, 55.44695546726386, 55.825517120460674, 56.024645528445646, 51.490831089516476, 51.7724718277653, 51.651393727709845, 40.14009630928436, 39.9275796363751, 40.22084903592864, 46.02325128267208, 46.35079357648888, 46.101703996459634, 45.78312005723515, 44.809325392047555, 45.0472332338492, 59.8340647003303, 59.92144790353875, 59.415740835169956, 51.09772298733394, 51.48268431673448, 51.461130480902895, 48.43851776917775, 48.3041724016269, 48.50811360528071, 50.912542459865406, 51.1673185651501, 51.09345719714959, 57.52889884014924, 58.094914120932415, 57.87219112118085, 54.13970324397086, 54.323950998485074, 54.61974169313906, 58.1850747168064, 58.5537002198398, 58.13290217518805, 41.97159260511398, 42.40209465380758, 42.024648040533066, 41.918619316692144, 41.37050762275854, 41.38663224379221, 40.29353707035382, 40.077195567389325, 40.50672626992066, 66.03630611548822, 66.03200008968513, 66.16669589529435, 61.603873570760086, 61.969419516002134, 61.951242781554654, 56.528512736161545, 57.04038382818301, 56.09847610195477, 33.92312905440727, 34.186493592957646, 34.47418796053776, 53.08698782821496, 53.22781166185935, 52.843236347039536, 51.47581179315846, 51.14202393839757, 51.68120386699836, 45.07382538417974, 45.678913484017045, 44.73830733696619, 61.82250390946864, 62.33486398775129, 61.938661292195306, 31.580767820278794, 32.164166474404425, 31.622113476196915, 43.11683538307746, 42.72180004914601, 42.89718623210986, 57.32326763371627, 57.62462249646585, 57.83548673304419, 57.22358405341704, 57.1252448366334, 57.01614813630779, 50.67031637579201, 50.25279310345648, 50.60534664243458, 51.93605257570742, 52.005031166132525, 51.402990542352185, 39.186905222634465, 39.189437488714844, 39.15327579776445, 45.199211473266274, 45.54385484258333, 45.82422362935418, 49.318454434474305, 48.714646865924195, 49.76298608941336, 44.70243705560763, 45.06040330169101, 45.01938031179209, 47.10215480377276, 47.54015494448443, 47.21083288391431, 45.50006594508886, 45.79960120841861, 45.34102350473404, 48.32709345966576, 48.4656268917024, 48.324699960649, 48.65997372940181, 48.36912830173968, 48.33010685443877, 58.92493811668827, 58.4045362100005, 58.468907885253415, 36.12564266224702, 36.402655379225806, 35.98539941509564, 42.96995927890141, 44.0055447195967, 44.131350629807756, 64.79514918724696, 65.08012666801612, 65.18951862553756, 48.62239093581836, 48.46215643982093, 48.215166191260025, 44.122039910405874, 44.07336260378361, 43.79314738512039, 42.86742734846969, 42.55656441797812, 41.86773711939652, 50.14560036609571, 50.305776430914804, 50.08773617694776, 43.57841682185729, 43.48194659252961, 43.84751270556201, 54.1628784822921, 53.92425484458606, 53.71575735012691, 49.09065416579445, 49.10682997231682, 49.06019304444392, 46.77525782088439, 47.04634659985702, 47.0315356651942, 51.41293057426809, 51.44115061103365, 51.19098528474568]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14659253501703495, "mean_inference_ms": 0.7078295339972002, "mean_action_processing_ms": 0.10192344737032556, "mean_env_wait_ms": 0.845952896253048, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 800000, "timesteps_this_iter": 0, "agent_timesteps_total": 2400000, "timers": {"sample_time_ms": 12338.752, "sample_throughput": 405.227, "load_time_ms": 0.1, "load_throughput": 49979790.276, "learn_time_ms": 1746.631, "learn_throughput": 2862.653, "update_time_ms": 8.47}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3665827156630353e-31, "cur_lr": 0.0005000000000000001, "total_loss": 10.261809825897217, "policy_loss": 0.007615326390638976, "vf_loss": 10.34075174331665, "vf_explained_var": 0.011217641830444335, "kl": 0.013566630473393331, "entropy": 8.655771827697754, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 800000, "num_agent_steps_sampled": 2400000, "num_steps_trained": 800000, "num_agent_steps_trained": 2400000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2457, "training_iteration": 160, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-38-16", "timestamp": 1706229496, "time_this_iter_s": 12.218242645263672, "time_total_s": 1735.7383215427399, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202CC7B6C10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1735.7383215427399, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 9.047058823529412, "ram_util_percent": 52.194117647058825}}
{"episode_reward_max": 198.23500210046757, "episode_reward_min": -266.75915344804525, "episode_reward_mean": 144.53414955992773, "episode_len_mean": 496.56, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -95.40713151047628}, "policy_reward_max": {"shared_policy": 66.16669589529435}, "policy_reward_mean": {"shared_policy": 48.178049853309254}, "custom_metrics": {}, "hist_stats": {"episode_reward": [162.69701835140566, 137.34343376196932, 140.4473799057305, 151.23687750083647, 184.25711887143518, 173.6957300044595, 117.13885906571522, 158.89768863096836, 123.71074153855442, 171.90891383402027, 155.54760999139378, 139.5505314320327, 151.09174324944604, 193.2385709751396, 171.0001661926511, 168.65598125010717, 143.46995116211482, 122.23662372678517, 165.72305403649804, 183.82322385162092, 150.47785477340227, 134.89787428360432, 175.10353946709057, 139.86600125208497, 189.65264766849566, 127.85625144187358, 163.01622824883083, 126.89877328276634, 147.22185173165036, 161.29995676130034, 122.884271916002, 138.09096900373692, -266.75915344804525, 135.77109112963083, 95.4672312773764, 139.87140977010137, 132.0951942801476, 128.901290576905, 170.22656390816, 139.22149557992816, 167.29711811617014, 154.9146966449918, 120.2885249815881, 138.47574885562045, 135.63967868313182, 179.17125343903913, 154.04153778497118, 145.25080377608555, 153.17331822216528, 173.49600408226263, 163.08339593559504, 174.87167711183426, 126.39833529945463, 124.67575918324289, 120.87745890766381, 198.23500210046757, 185.5245358683168, 169.66737266629926, 102.58381060790268, 159.15803583711406, 154.29903959855423, 135.4910462051629, 186.0960291894151, 95.36704777088013, 128.73582166433334, 172.78337686322644, 171.36497702635793, 151.52845612168312, 155.3440742841921, 117.52961850911376, 136.56728994520358, 147.796087389812, 134.78222066909086, 141.85314263217168, 136.6406906582414, 145.11742031201706, 145.3592088855799, 175.798382211942, 108.51369745656847, 131.106854628306, 195.06479448080063, 145.2997135668993, 131.98854989930973, 127.29172888584434, 150.53911297395842, 130.90787611994892, 161.80289067700542, 147.25767718255514, 140.8531400859356, 154.04506647004743, 138.36224216688407, 181.24458120949566, 157.24549684673545, 165.65157037228315, 170.63964699581263, 102.77533906511962, 138.92533581238254, 153.44200159260063, 142.85720162699008, 130.58987959846854], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 156, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [54.197319877644375, 54.30656328921516, 54.19313518454631, 46.062946801384285, 46.41863462266822, 44.86185233791669, 46.439984470605836, 47.09247355535625, 46.91492187976836, 50.566684633008364, 50.529920918556556, 50.140271949271366, 61.14757541318734, 61.937854762499526, 61.17168869574864, 58.02143592884143, 57.58216143151124, 58.09213264410694, 38.59113818407059, 39.160094022750854, 39.38762685889378, 53.267282104740545, 52.86380580315988, 52.766600723067924, 41.44866704878707, 40.79729518791039, 41.46477930185695, 57.324555718650416, 57.26752182220419, 57.31683629316588, 52.201327054761336, 51.73234875500201, 51.6139341816306, 46.68454524129629, 46.47410739213228, 46.39187879860401, 50.07277321318786, 50.561790208021804, 50.457179828236505, 64.30616936832665, 64.2056916207075, 64.72670998610555, 56.779829869667694, 57.24333551774423, 56.97700080523889, 56.16721541186173, 56.28425237288077, 56.20451346536477, 47.891850999246046, 47.94134946229558, 47.63675070057313, 40.96273661901553, 41.33751695354779, 39.93637015422185, 55.631382986903176, 55.51951408386229, 54.57215696573256, 60.91940091053645, 61.709894063572094, 61.19392887751262, 50.23223909735678, 50.14247085154055, 50.10314482450484, 45.14881014109899, 44.88845448692639, 44.860609655578926, 58.0856345842282, 58.376019547382995, 58.64188533547956, 46.640686206519604, 46.40739653259516, 46.81791851297021, 63.38747675654788, 63.240008076032, 63.02516283591588, 43.009810641097516, 42.06926103929678, 42.77717976147929, 54.412391265388564, 54.273100614547715, 54.33073636889456, 42.08928854763508, 42.404246754944324, 42.40523798018694, 49.41063248272984, 49.23204985633491, 48.57916939258574, 53.893278583884225, 53.34089276194571, 54.065785415470586, 40.86867049584785, 41.130077748248965, 40.88552367190519, 46.0562935831646, 46.10532022888461, 45.92935519168773, -85.32310330371062, -86.02891863385837, -95.40713151047628, 45.59093780691424, 45.19507991025844, 44.98507341245809, 32.09360864137609, 31.76366241772969, 31.609960218270615, 46.646591813613966, 46.37496284892161, 46.849855107565716, 44.17607170467575, 44.083799244215086, 43.8353233312567, 42.60613781710465, 43.019643177588776, 43.27550958221157, 56.72032282501458, 56.89832088351248, 56.60792019963263, 46.3629058326284, 45.96095330516496, 46.89763644213477, 55.44695546726386, 55.825517120460674, 56.024645528445646, 51.490831089516476, 51.7724718277653, 51.651393727709845, 40.14009630928436, 39.9275796363751, 40.22084903592864, 46.02325128267208, 46.35079357648888, 46.101703996459634, 45.78312005723515, 44.809325392047555, 45.0472332338492, 59.8340647003303, 59.92144790353875, 59.415740835169956, 51.09772298733394, 51.48268431673448, 51.461130480902895, 48.43851776917775, 48.3041724016269, 48.50811360528071, 50.912542459865406, 51.1673185651501, 51.09345719714959, 57.52889884014924, 58.094914120932415, 57.87219112118085, 54.13970324397086, 54.323950998485074, 54.61974169313906, 58.1850747168064, 58.5537002198398, 58.13290217518805, 41.97159260511398, 42.40209465380758, 42.024648040533066, 41.918619316692144, 41.37050762275854, 41.38663224379221, 40.29353707035382, 40.077195567389325, 40.50672626992066, 66.03630611548822, 66.03200008968513, 66.16669589529435, 61.603873570760086, 61.969419516002134, 61.951242781554654, 56.528512736161545, 57.04038382818301, 56.09847610195477, 33.92312905440727, 34.186493592957646, 34.47418796053776, 53.08698782821496, 53.22781166185935, 52.843236347039536, 51.47581179315846, 51.14202393839757, 51.68120386699836, 45.07382538417974, 45.678913484017045, 44.73830733696619, 61.82250390946864, 62.33486398775129, 61.938661292195306, 31.580767820278794, 32.164166474404425, 31.622113476196915, 43.11683538307746, 42.72180004914601, 42.89718623210986, 57.32326763371627, 57.62462249646585, 57.83548673304419, 57.22358405341704, 57.1252448366334, 57.01614813630779, 50.67031637579201, 50.25279310345648, 50.60534664243458, 51.93605257570742, 52.005031166132525, 51.402990542352185, 39.186905222634465, 39.189437488714844, 39.15327579776445, 45.199211473266274, 45.54385484258333, 45.82422362935418, 49.318454434474305, 48.714646865924195, 49.76298608941336, 44.70243705560763, 45.06040330169101, 45.01938031179209, 47.10215480377276, 47.54015494448443, 47.21083288391431, 45.50006594508886, 45.79960120841861, 45.34102350473404, 48.32709345966576, 48.4656268917024, 48.324699960649, 48.65997372940181, 48.36912830173968, 48.33010685443877, 58.92493811668827, 58.4045362100005, 58.468907885253415, 36.12564266224702, 36.402655379225806, 35.98539941509564, 42.96995927890141, 44.0055447195967, 44.131350629807756, 64.79514918724696, 65.08012666801612, 65.18951862553756, 48.62239093581836, 48.46215643982093, 48.215166191260025, 44.122039910405874, 44.07336260378361, 43.79314738512039, 42.86742734846969, 42.55656441797812, 41.86773711939652, 50.14560036609571, 50.305776430914804, 50.08773617694776, 43.57841682185729, 43.48194659252961, 43.84751270556201, 54.1628784822921, 53.92425484458606, 53.71575735012691, 49.09065416579445, 49.10682997231682, 49.06019304444392, 46.77525782088439, 47.04634659985702, 47.0315356651942, 51.41293057426809, 51.44115061103365, 51.19098528474568, 46.20693216317643, 46.02207751696308, 46.13323248674472, 60.067448879281685, 60.39793897668521, 60.77919335352878, 52.30942629277705, 52.16169044375418, 52.774380110204206, 55.00695278247197, 55.191816960771874, 55.4528006290396, 56.9136910053591, 56.82977239663403, 56.89618359381954, 34.33360149152577, 34.13958132266998, 34.30215625092387, 46.26781104753414, 46.564733108195156, 46.09279165665308, 50.95702487727006, 51.46343234328863, 51.021544372042015, 47.67251918216546, 47.81631157159184, 47.36837087323268, 43.55146923288703, 43.710472129285336, 43.32793823629618]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14666485874626228, "mean_inference_ms": 0.708233751177549, "mean_action_processing_ms": 0.10196918893240445, "mean_env_wait_ms": 0.8460898486608498, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 805000, "timesteps_this_iter": 0, "agent_timesteps_total": 2415000, "timers": {"sample_time_ms": 11350.496, "sample_throughput": 440.509, "load_time_ms": 0.1, "load_throughput": 49979790.276, "learn_time_ms": 1738.905, "learn_throughput": 2875.372, "update_time_ms": 8.367}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3665827156630353e-31, "cur_lr": 0.0005000000000000001, "total_loss": 7.922128105163575, "policy_loss": -0.00029142036052109965, "vf_loss": 8.011728715896606, "vf_explained_var": 0.018404895067214967, "kl": 0.006277280999383253, "entropy": 8.930922508239746, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 805000, "num_agent_steps_sampled": 2415000, "num_steps_trained": 805000, "num_agent_steps_trained": 2415000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2467, "training_iteration": 161, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-38-27", "timestamp": 1706229507, "time_this_iter_s": 11.113659620285034, "time_total_s": 1746.851981163025, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202846E4700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1746.851981163025, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 9.6125, "ram_util_percent": 52.275000000000006}}
{"episode_reward_max": 198.23500210046757, "episode_reward_min": -266.75915344804525, "episode_reward_mean": 144.51715687996938, "episode_len_mean": 496.56, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -95.40713151047628}, "policy_reward_max": {"shared_policy": 66.16669589529435}, "policy_reward_mean": {"shared_policy": 48.172385626656464}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.54760999139378, 139.5505314320327, 151.09174324944604, 193.2385709751396, 171.0001661926511, 168.65598125010717, 143.46995116211482, 122.23662372678517, 165.72305403649804, 183.82322385162092, 150.47785477340227, 134.89787428360432, 175.10353946709057, 139.86600125208497, 189.65264766849566, 127.85625144187358, 163.01622824883083, 126.89877328276634, 147.22185173165036, 161.29995676130034, 122.884271916002, 138.09096900373692, -266.75915344804525, 135.77109112963083, 95.4672312773764, 139.87140977010137, 132.0951942801476, 128.901290576905, 170.22656390816, 139.22149557992816, 167.29711811617014, 154.9146966449918, 120.2885249815881, 138.47574885562045, 135.63967868313182, 179.17125343903913, 154.04153778497118, 145.25080377608555, 153.17331822216528, 173.49600408226263, 163.08339593559504, 174.87167711183426, 126.39833529945463, 124.67575918324289, 120.87745890766381, 198.23500210046757, 185.5245358683168, 169.66737266629926, 102.58381060790268, 159.15803583711406, 154.29903959855423, 135.4910462051629, 186.0960291894151, 95.36704777088013, 128.73582166433334, 172.78337686322644, 171.36497702635793, 151.52845612168312, 155.3440742841921, 117.52961850911376, 136.56728994520358, 147.796087389812, 134.78222066909086, 141.85314263217168, 136.6406906582414, 145.11742031201706, 145.3592088855799, 175.798382211942, 108.51369745656847, 131.106854628306, 195.06479448080063, 145.2997135668993, 131.98854989930973, 127.29172888584434, 150.53911297395842, 130.90787611994892, 161.80289067700542, 147.25767718255514, 140.8531400859356, 154.04506647004743, 138.36224216688407, 181.24458120949566, 157.24549684673545, 165.65157037228315, 170.63964699581263, 102.77533906511962, 138.92533581238254, 153.44200159260063, 142.85720162699008, 130.58987959846854, 158.00193153787396, 155.57004679739453, 141.67166147008558, 147.8995367214083, 162.04627458844334, 156.21447814628476, 147.79780694842339, 154.20253772381702, 139.36426184326393, 156.86595769226548], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 156, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [52.201327054761336, 51.73234875500201, 51.6139341816306, 46.68454524129629, 46.47410739213228, 46.39187879860401, 50.07277321318786, 50.561790208021804, 50.457179828236505, 64.30616936832665, 64.2056916207075, 64.72670998610555, 56.779829869667694, 57.24333551774423, 56.97700080523889, 56.16721541186173, 56.28425237288077, 56.20451346536477, 47.891850999246046, 47.94134946229558, 47.63675070057313, 40.96273661901553, 41.33751695354779, 39.93637015422185, 55.631382986903176, 55.51951408386229, 54.57215696573256, 60.91940091053645, 61.709894063572094, 61.19392887751262, 50.23223909735678, 50.14247085154055, 50.10314482450484, 45.14881014109899, 44.88845448692639, 44.860609655578926, 58.0856345842282, 58.376019547382995, 58.64188533547956, 46.640686206519604, 46.40739653259516, 46.81791851297021, 63.38747675654788, 63.240008076032, 63.02516283591588, 43.009810641097516, 42.06926103929678, 42.77717976147929, 54.412391265388564, 54.273100614547715, 54.33073636889456, 42.08928854763508, 42.404246754944324, 42.40523798018694, 49.41063248272984, 49.23204985633491, 48.57916939258574, 53.893278583884225, 53.34089276194571, 54.065785415470586, 40.86867049584785, 41.130077748248965, 40.88552367190519, 46.0562935831646, 46.10532022888461, 45.92935519168773, -85.32310330371062, -86.02891863385837, -95.40713151047628, 45.59093780691424, 45.19507991025844, 44.98507341245809, 32.09360864137609, 31.76366241772969, 31.609960218270615, 46.646591813613966, 46.37496284892161, 46.849855107565716, 44.17607170467575, 44.083799244215086, 43.8353233312567, 42.60613781710465, 43.019643177588776, 43.27550958221157, 56.72032282501458, 56.89832088351248, 56.60792019963263, 46.3629058326284, 45.96095330516496, 46.89763644213477, 55.44695546726386, 55.825517120460674, 56.024645528445646, 51.490831089516476, 51.7724718277653, 51.651393727709845, 40.14009630928436, 39.9275796363751, 40.22084903592864, 46.02325128267208, 46.35079357648888, 46.101703996459634, 45.78312005723515, 44.809325392047555, 45.0472332338492, 59.8340647003303, 59.92144790353875, 59.415740835169956, 51.09772298733394, 51.48268431673448, 51.461130480902895, 48.43851776917775, 48.3041724016269, 48.50811360528071, 50.912542459865406, 51.1673185651501, 51.09345719714959, 57.52889884014924, 58.094914120932415, 57.87219112118085, 54.13970324397086, 54.323950998485074, 54.61974169313906, 58.1850747168064, 58.5537002198398, 58.13290217518805, 41.97159260511398, 42.40209465380758, 42.024648040533066, 41.918619316692144, 41.37050762275854, 41.38663224379221, 40.29353707035382, 40.077195567389325, 40.50672626992066, 66.03630611548822, 66.03200008968513, 66.16669589529435, 61.603873570760086, 61.969419516002134, 61.951242781554654, 56.528512736161545, 57.04038382818301, 56.09847610195477, 33.92312905440727, 34.186493592957646, 34.47418796053776, 53.08698782821496, 53.22781166185935, 52.843236347039536, 51.47581179315846, 51.14202393839757, 51.68120386699836, 45.07382538417974, 45.678913484017045, 44.73830733696619, 61.82250390946864, 62.33486398775129, 61.938661292195306, 31.580767820278794, 32.164166474404425, 31.622113476196915, 43.11683538307746, 42.72180004914601, 42.89718623210986, 57.32326763371627, 57.62462249646585, 57.83548673304419, 57.22358405341704, 57.1252448366334, 57.01614813630779, 50.67031637579201, 50.25279310345648, 50.60534664243458, 51.93605257570742, 52.005031166132525, 51.402990542352185, 39.186905222634465, 39.189437488714844, 39.15327579776445, 45.199211473266274, 45.54385484258333, 45.82422362935418, 49.318454434474305, 48.714646865924195, 49.76298608941336, 44.70243705560763, 45.06040330169101, 45.01938031179209, 47.10215480377276, 47.54015494448443, 47.21083288391431, 45.50006594508886, 45.79960120841861, 45.34102350473404, 48.32709345966576, 48.4656268917024, 48.324699960649, 48.65997372940181, 48.36912830173968, 48.33010685443877, 58.92493811668827, 58.4045362100005, 58.468907885253415, 36.12564266224702, 36.402655379225806, 35.98539941509564, 42.96995927890141, 44.0055447195967, 44.131350629807756, 64.79514918724696, 65.08012666801612, 65.18951862553756, 48.62239093581836, 48.46215643982093, 48.215166191260025, 44.122039910405874, 44.07336260378361, 43.79314738512039, 42.86742734846969, 42.55656441797812, 41.86773711939652, 50.14560036609571, 50.305776430914804, 50.08773617694776, 43.57841682185729, 43.48194659252961, 43.84751270556201, 54.1628784822921, 53.92425484458606, 53.71575735012691, 49.09065416579445, 49.10682997231682, 49.06019304444392, 46.77525782088439, 47.04634659985702, 47.0315356651942, 51.41293057426809, 51.44115061103365, 51.19098528474568, 46.20693216317643, 46.02207751696308, 46.13323248674472, 60.067448879281685, 60.39793897668521, 60.77919335352878, 52.30942629277705, 52.16169044375418, 52.774380110204206, 55.00695278247197, 55.191816960771874, 55.4528006290396, 56.9136910053591, 56.82977239663403, 56.89618359381954, 34.33360149152577, 34.13958132266998, 34.30215625092387, 46.26781104753414, 46.564733108195156, 46.09279165665308, 50.95702487727006, 51.46343234328863, 51.021544372042015, 47.67251918216546, 47.81631157159184, 47.36837087323268, 43.55146923288703, 43.710472129285336, 43.32793823629618, 52.47740123420952, 52.79778478201477, 52.726745521649704, 51.57939224441846, 52.10801056524117, 51.88264398773511, 47.050425489743546, 46.854254757364586, 47.766981222977236, 49.136422614256546, 49.678597527245685, 49.08451657990615, 54.08554226284225, 53.81532723208268, 54.14540509351839, 52.13416756441195, 52.0391386312743, 52.04117195059855, 49.282126301278666, 49.42112124090393, 49.094559406240776, 51.270756999651596, 51.37917283798258, 51.55260788618277, 46.42307851215203, 46.37823234995206, 46.56295098116, 52.37028394391139, 52.09108531971772, 52.40458842863639]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14673636858927283, "mean_inference_ms": 0.7086267989279061, "mean_action_processing_ms": 0.10200295533783774, "mean_env_wait_ms": 0.8462141287412352, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 810000, "timesteps_this_iter": 0, "agent_timesteps_total": 2430000, "timers": {"sample_time_ms": 11347.565, "sample_throughput": 440.623, "load_time_ms": 0.1, "load_throughput": 49979790.276, "learn_time_ms": 1720.866, "learn_throughput": 2905.514, "update_time_ms": 8.168}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3665827156630353e-31, "cur_lr": 0.0005000000000000001, "total_loss": 10.140740299224854, "policy_loss": -0.000753452428380541, "vf_loss": 10.229528617858886, "vf_explained_var": 0.016588038206100462, "kl": 0.00342958362310933, "entropy": 8.803466510772704, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 810000, "num_agent_steps_sampled": 2430000, "num_steps_trained": 810000, "num_agent_steps_trained": 2430000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2477, "training_iteration": 162, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-38-38", "timestamp": 1706229518, "time_this_iter_s": 11.205899953842163, "time_total_s": 1758.057881116867, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202846E41F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1758.057881116867, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 8.96875, "ram_util_percent": 52.375}}
{"episode_reward_max": 198.23500210046757, "episode_reward_min": -266.75915344804525, "episode_reward_mean": 144.5825496638566, "episode_len_mean": 496.56, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -95.40713151047628}, "policy_reward_max": {"shared_policy": 66.16669589529435}, "policy_reward_mean": {"shared_policy": 48.19418322128554}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.47785477340227, 134.89787428360432, 175.10353946709057, 139.86600125208497, 189.65264766849566, 127.85625144187358, 163.01622824883083, 126.89877328276634, 147.22185173165036, 161.29995676130034, 122.884271916002, 138.09096900373692, -266.75915344804525, 135.77109112963083, 95.4672312773764, 139.87140977010137, 132.0951942801476, 128.901290576905, 170.22656390816, 139.22149557992816, 167.29711811617014, 154.9146966449918, 120.2885249815881, 138.47574885562045, 135.63967868313182, 179.17125343903913, 154.04153778497118, 145.25080377608555, 153.17331822216528, 173.49600408226263, 163.08339593559504, 174.87167711183426, 126.39833529945463, 124.67575918324289, 120.87745890766381, 198.23500210046757, 185.5245358683168, 169.66737266629926, 102.58381060790268, 159.15803583711406, 154.29903959855423, 135.4910462051629, 186.0960291894151, 95.36704777088013, 128.73582166433334, 172.78337686322644, 171.36497702635793, 151.52845612168312, 155.3440742841921, 117.52961850911376, 136.56728994520358, 147.796087389812, 134.78222066909086, 141.85314263217168, 136.6406906582414, 145.11742031201706, 145.3592088855799, 175.798382211942, 108.51369745656847, 131.106854628306, 195.06479448080063, 145.2997135668993, 131.98854989930973, 127.29172888584434, 150.53911297395842, 130.90787611994892, 161.80289067700542, 147.25767718255514, 140.8531400859356, 154.04506647004743, 138.36224216688407, 181.24458120949566, 157.24549684673545, 165.65157037228315, 170.63964699581263, 102.77533906511962, 138.92533581238254, 153.44200159260063, 142.85720162699008, 130.58987959846854, 158.00193153787396, 155.57004679739453, 141.67166147008558, 147.8995367214083, 162.04627458844334, 156.21447814628476, 147.79780694842339, 154.20253772381702, 139.36426184326393, 156.86595769226548, 124.75509865768251, 195.48825687170014, 143.57637254148716, 145.32137596607214, 151.29144034534727, 194.11018678545935, 143.97498804330831, 179.81821987940924, 169.74915772397046, 152.7916374420745], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 156, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [50.23223909735678, 50.14247085154055, 50.10314482450484, 45.14881014109899, 44.88845448692639, 44.860609655578926, 58.0856345842282, 58.376019547382995, 58.64188533547956, 46.640686206519604, 46.40739653259516, 46.81791851297021, 63.38747675654788, 63.240008076032, 63.02516283591588, 43.009810641097516, 42.06926103929678, 42.77717976147929, 54.412391265388564, 54.273100614547715, 54.33073636889456, 42.08928854763508, 42.404246754944324, 42.40523798018694, 49.41063248272984, 49.23204985633491, 48.57916939258574, 53.893278583884225, 53.34089276194571, 54.065785415470586, 40.86867049584785, 41.130077748248965, 40.88552367190519, 46.0562935831646, 46.10532022888461, 45.92935519168773, -85.32310330371062, -86.02891863385837, -95.40713151047628, 45.59093780691424, 45.19507991025844, 44.98507341245809, 32.09360864137609, 31.76366241772969, 31.609960218270615, 46.646591813613966, 46.37496284892161, 46.849855107565716, 44.17607170467575, 44.083799244215086, 43.8353233312567, 42.60613781710465, 43.019643177588776, 43.27550958221157, 56.72032282501458, 56.89832088351248, 56.60792019963263, 46.3629058326284, 45.96095330516496, 46.89763644213477, 55.44695546726386, 55.825517120460674, 56.024645528445646, 51.490831089516476, 51.7724718277653, 51.651393727709845, 40.14009630928436, 39.9275796363751, 40.22084903592864, 46.02325128267208, 46.35079357648888, 46.101703996459634, 45.78312005723515, 44.809325392047555, 45.0472332338492, 59.8340647003303, 59.92144790353875, 59.415740835169956, 51.09772298733394, 51.48268431673448, 51.461130480902895, 48.43851776917775, 48.3041724016269, 48.50811360528071, 50.912542459865406, 51.1673185651501, 51.09345719714959, 57.52889884014924, 58.094914120932415, 57.87219112118085, 54.13970324397086, 54.323950998485074, 54.61974169313906, 58.1850747168064, 58.5537002198398, 58.13290217518805, 41.97159260511398, 42.40209465380758, 42.024648040533066, 41.918619316692144, 41.37050762275854, 41.38663224379221, 40.29353707035382, 40.077195567389325, 40.50672626992066, 66.03630611548822, 66.03200008968513, 66.16669589529435, 61.603873570760086, 61.969419516002134, 61.951242781554654, 56.528512736161545, 57.04038382818301, 56.09847610195477, 33.92312905440727, 34.186493592957646, 34.47418796053776, 53.08698782821496, 53.22781166185935, 52.843236347039536, 51.47581179315846, 51.14202393839757, 51.68120386699836, 45.07382538417974, 45.678913484017045, 44.73830733696619, 61.82250390946864, 62.33486398775129, 61.938661292195306, 31.580767820278794, 32.164166474404425, 31.622113476196915, 43.11683538307746, 42.72180004914601, 42.89718623210986, 57.32326763371627, 57.62462249646585, 57.83548673304419, 57.22358405341704, 57.1252448366334, 57.01614813630779, 50.67031637579201, 50.25279310345648, 50.60534664243458, 51.93605257570742, 52.005031166132525, 51.402990542352185, 39.186905222634465, 39.189437488714844, 39.15327579776445, 45.199211473266274, 45.54385484258333, 45.82422362935418, 49.318454434474305, 48.714646865924195, 49.76298608941336, 44.70243705560763, 45.06040330169101, 45.01938031179209, 47.10215480377276, 47.54015494448443, 47.21083288391431, 45.50006594508886, 45.79960120841861, 45.34102350473404, 48.32709345966576, 48.4656268917024, 48.324699960649, 48.65997372940181, 48.36912830173968, 48.33010685443877, 58.92493811668827, 58.4045362100005, 58.468907885253415, 36.12564266224702, 36.402655379225806, 35.98539941509564, 42.96995927890141, 44.0055447195967, 44.131350629807756, 64.79514918724696, 65.08012666801612, 65.18951862553756, 48.62239093581836, 48.46215643982093, 48.215166191260025, 44.122039910405874, 44.07336260378361, 43.79314738512039, 42.86742734846969, 42.55656441797812, 41.86773711939652, 50.14560036609571, 50.305776430914804, 50.08773617694776, 43.57841682185729, 43.48194659252961, 43.84751270556201, 54.1628784822921, 53.92425484458606, 53.71575735012691, 49.09065416579445, 49.10682997231682, 49.06019304444392, 46.77525782088439, 47.04634659985702, 47.0315356651942, 51.41293057426809, 51.44115061103365, 51.19098528474568, 46.20693216317643, 46.02207751696308, 46.13323248674472, 60.067448879281685, 60.39793897668521, 60.77919335352878, 52.30942629277705, 52.16169044375418, 52.774380110204206, 55.00695278247197, 55.191816960771874, 55.4528006290396, 56.9136910053591, 56.82977239663403, 56.89618359381954, 34.33360149152577, 34.13958132266998, 34.30215625092387, 46.26781104753414, 46.564733108195156, 46.09279165665308, 50.95702487727006, 51.46343234328863, 51.021544372042015, 47.67251918216546, 47.81631157159184, 47.36837087323268, 43.55146923288703, 43.710472129285336, 43.32793823629618, 52.47740123420952, 52.79778478201477, 52.726745521649704, 51.57939224441846, 52.10801056524117, 51.88264398773511, 47.050425489743546, 46.854254757364586, 47.766981222977236, 49.136422614256546, 49.678597527245685, 49.08451657990615, 54.08554226284225, 53.81532723208268, 54.14540509351839, 52.13416756441195, 52.0391386312743, 52.04117195059855, 49.282126301278666, 49.42112124090393, 49.094559406240776, 51.270756999651596, 51.37917283798258, 51.55260788618277, 46.42307851215203, 46.37823234995206, 46.56295098116, 52.37028394391139, 52.09108531971772, 52.40458842863639, 41.50220343718925, 41.698613566036016, 41.55428165445724, 65.01316678524016, 65.20963330566882, 65.26545678079127, 47.975389639536544, 47.57551832000415, 48.02546458194654, 48.385690716405705, 48.523505856593445, 48.41217939307292, 50.31581350664298, 50.59419457862775, 50.38143226007621, 64.64436171452205, 64.74040901164214, 64.72541605929534, 48.35308897991975, 47.79290538032849, 47.828993683060006, 59.65350013474624, 59.91655268023412, 60.248167064428955, 56.94948144474377, 56.06153208514054, 56.73814419408639, 50.844522299865886, 50.781083288292095, 51.16603185391675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14679243705772832, "mean_inference_ms": 0.708983831071726, "mean_action_processing_ms": 0.10202414300316746, "mean_env_wait_ms": 0.8463198346824303, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 815000, "timesteps_this_iter": 0, "agent_timesteps_total": 2445000, "timers": {"sample_time_ms": 11248.218, "sample_throughput": 444.515, "load_time_ms": 0.201, "load_throughput": 24924554.314, "learn_time_ms": 1709.206, "learn_throughput": 2925.335, "update_time_ms": 7.907}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1832913578315177e-31, "cur_lr": 0.0005000000000000001, "total_loss": 7.908551263809204, "policy_loss": -0.00027864258049064005, "vf_loss": 7.996248006820679, "vf_explained_var": 0.024254143238067627, "kl": 0.004362370050547729, "entropy": 8.741812705993652, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 815000, "num_agent_steps_sampled": 2445000, "num_steps_trained": 815000, "num_agent_steps_trained": 2445000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2487, "training_iteration": 163, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-38-49", "timestamp": 1706229529, "time_this_iter_s": 11.330138206481934, "time_total_s": 1769.388019323349, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020284553040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1769.388019323349, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 10.00625, "ram_util_percent": 51.8}}
{"episode_reward_max": 198.23500210046757, "episode_reward_min": -266.75915344804525, "episode_reward_mean": 144.46490458697488, "episode_len_mean": 496.56, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -95.40713151047628}, "policy_reward_max": {"shared_policy": 66.16669589529435}, "policy_reward_mean": {"shared_policy": 48.15496819565829}, "custom_metrics": {}, "hist_stats": {"episode_reward": [122.884271916002, 138.09096900373692, -266.75915344804525, 135.77109112963083, 95.4672312773764, 139.87140977010137, 132.0951942801476, 128.901290576905, 170.22656390816, 139.22149557992816, 167.29711811617014, 154.9146966449918, 120.2885249815881, 138.47574885562045, 135.63967868313182, 179.17125343903913, 154.04153778497118, 145.25080377608555, 153.17331822216528, 173.49600408226263, 163.08339593559504, 174.87167711183426, 126.39833529945463, 124.67575918324289, 120.87745890766381, 198.23500210046757, 185.5245358683168, 169.66737266629926, 102.58381060790268, 159.15803583711406, 154.29903959855423, 135.4910462051629, 186.0960291894151, 95.36704777088013, 128.73582166433334, 172.78337686322644, 171.36497702635793, 151.52845612168312, 155.3440742841921, 117.52961850911376, 136.56728994520358, 147.796087389812, 134.78222066909086, 141.85314263217168, 136.6406906582414, 145.11742031201706, 145.3592088855799, 175.798382211942, 108.51369745656847, 131.106854628306, 195.06479448080063, 145.2997135668993, 131.98854989930973, 127.29172888584434, 150.53911297395842, 130.90787611994892, 161.80289067700542, 147.25767718255514, 140.8531400859356, 154.04506647004743, 138.36224216688407, 181.24458120949566, 157.24549684673545, 165.65157037228315, 170.63964699581263, 102.77533906511962, 138.92533581238254, 153.44200159260063, 142.85720162699008, 130.58987959846854, 158.00193153787396, 155.57004679739453, 141.67166147008558, 147.8995367214083, 162.04627458844334, 156.21447814628476, 147.79780694842339, 154.20253772381702, 139.36426184326393, 156.86595769226548, 124.75509865768251, 195.48825687170014, 143.57637254148716, 145.32137596607214, 151.29144034534727, 194.11018678545935, 143.97498804330831, 179.81821987940924, 169.74915772397046, 152.7916374420745, 153.43788431864246, 154.07391841709622, 146.16123098880058, 135.81129025109124, 137.40178287401778, 159.57075694500222, 196.27090508118286, 123.30166390165685, 151.53501208778468, 146.96202635765073], "episode_lengths": [500, 500, 156, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [40.86867049584785, 41.130077748248965, 40.88552367190519, 46.0562935831646, 46.10532022888461, 45.92935519168773, -85.32310330371062, -86.02891863385837, -95.40713151047628, 45.59093780691424, 45.19507991025844, 44.98507341245809, 32.09360864137609, 31.76366241772969, 31.609960218270615, 46.646591813613966, 46.37496284892161, 46.849855107565716, 44.17607170467575, 44.083799244215086, 43.8353233312567, 42.60613781710465, 43.019643177588776, 43.27550958221157, 56.72032282501458, 56.89832088351248, 56.60792019963263, 46.3629058326284, 45.96095330516496, 46.89763644213477, 55.44695546726386, 55.825517120460674, 56.024645528445646, 51.490831089516476, 51.7724718277653, 51.651393727709845, 40.14009630928436, 39.9275796363751, 40.22084903592864, 46.02325128267208, 46.35079357648888, 46.101703996459634, 45.78312005723515, 44.809325392047555, 45.0472332338492, 59.8340647003303, 59.92144790353875, 59.415740835169956, 51.09772298733394, 51.48268431673448, 51.461130480902895, 48.43851776917775, 48.3041724016269, 48.50811360528071, 50.912542459865406, 51.1673185651501, 51.09345719714959, 57.52889884014924, 58.094914120932415, 57.87219112118085, 54.13970324397086, 54.323950998485074, 54.61974169313906, 58.1850747168064, 58.5537002198398, 58.13290217518805, 41.97159260511398, 42.40209465380758, 42.024648040533066, 41.918619316692144, 41.37050762275854, 41.38663224379221, 40.29353707035382, 40.077195567389325, 40.50672626992066, 66.03630611548822, 66.03200008968513, 66.16669589529435, 61.603873570760086, 61.969419516002134, 61.951242781554654, 56.528512736161545, 57.04038382818301, 56.09847610195477, 33.92312905440727, 34.186493592957646, 34.47418796053776, 53.08698782821496, 53.22781166185935, 52.843236347039536, 51.47581179315846, 51.14202393839757, 51.68120386699836, 45.07382538417974, 45.678913484017045, 44.73830733696619, 61.82250390946864, 62.33486398775129, 61.938661292195306, 31.580767820278794, 32.164166474404425, 31.622113476196915, 43.11683538307746, 42.72180004914601, 42.89718623210986, 57.32326763371627, 57.62462249646585, 57.83548673304419, 57.22358405341704, 57.1252448366334, 57.01614813630779, 50.67031637579201, 50.25279310345648, 50.60534664243458, 51.93605257570742, 52.005031166132525, 51.402990542352185, 39.186905222634465, 39.189437488714844, 39.15327579776445, 45.199211473266274, 45.54385484258333, 45.82422362935418, 49.318454434474305, 48.714646865924195, 49.76298608941336, 44.70243705560763, 45.06040330169101, 45.01938031179209, 47.10215480377276, 47.54015494448443, 47.21083288391431, 45.50006594508886, 45.79960120841861, 45.34102350473404, 48.32709345966576, 48.4656268917024, 48.324699960649, 48.65997372940181, 48.36912830173968, 48.33010685443877, 58.92493811668827, 58.4045362100005, 58.468907885253415, 36.12564266224702, 36.402655379225806, 35.98539941509564, 42.96995927890141, 44.0055447195967, 44.131350629807756, 64.79514918724696, 65.08012666801612, 65.18951862553756, 48.62239093581836, 48.46215643982093, 48.215166191260025, 44.122039910405874, 44.07336260378361, 43.79314738512039, 42.86742734846969, 42.55656441797812, 41.86773711939652, 50.14560036609571, 50.305776430914804, 50.08773617694776, 43.57841682185729, 43.48194659252961, 43.84751270556201, 54.1628784822921, 53.92425484458606, 53.71575735012691, 49.09065416579445, 49.10682997231682, 49.06019304444392, 46.77525782088439, 47.04634659985702, 47.0315356651942, 51.41293057426809, 51.44115061103365, 51.19098528474568, 46.20693216317643, 46.02207751696308, 46.13323248674472, 60.067448879281685, 60.39793897668521, 60.77919335352878, 52.30942629277705, 52.16169044375418, 52.774380110204206, 55.00695278247197, 55.191816960771874, 55.4528006290396, 56.9136910053591, 56.82977239663403, 56.89618359381954, 34.33360149152577, 34.13958132266998, 34.30215625092387, 46.26781104753414, 46.564733108195156, 46.09279165665308, 50.95702487727006, 51.46343234328863, 51.021544372042015, 47.67251918216546, 47.81631157159184, 47.36837087323268, 43.55146923288703, 43.710472129285336, 43.32793823629618, 52.47740123420952, 52.79778478201477, 52.726745521649704, 51.57939224441846, 52.10801056524117, 51.88264398773511, 47.050425489743546, 46.854254757364586, 47.766981222977236, 49.136422614256546, 49.678597527245685, 49.08451657990615, 54.08554226284225, 53.81532723208268, 54.14540509351839, 52.13416756441195, 52.0391386312743, 52.04117195059855, 49.282126301278666, 49.42112124090393, 49.094559406240776, 51.270756999651596, 51.37917283798258, 51.55260788618277, 46.42307851215203, 46.37823234995206, 46.56295098116, 52.37028394391139, 52.09108531971772, 52.40458842863639, 41.50220343718925, 41.698613566036016, 41.55428165445724, 65.01316678524016, 65.20963330566882, 65.26545678079127, 47.975389639536544, 47.57551832000415, 48.02546458194654, 48.385690716405705, 48.523505856593445, 48.41217939307292, 50.31581350664298, 50.59419457862775, 50.38143226007621, 64.64436171452205, 64.74040901164214, 64.72541605929534, 48.35308897991975, 47.79290538032849, 47.828993683060006, 59.65350013474624, 59.91655268023412, 60.248167064428955, 56.94948144474377, 56.06153208514054, 56.73814419408639, 50.844522299865886, 50.781083288292095, 51.16603185391675, 50.71436109145482, 51.11528391142686, 51.60823931576063, 51.353723491231605, 51.434413577119514, 51.28578134874503, 48.47220602134864, 48.98051782200734, 48.70850714544456, 45.214429281651974, 45.46008607186377, 45.13677489757538, 45.85868905112147, 45.65082263946533, 45.89227118343115, 53.05109655857085, 53.22918173298238, 53.290478653449085, 65.22094341615836, 65.57331871862213, 65.47664294640224, 41.12282605220874, 40.586826403935746, 41.59201144551237, 50.482864021013185, 50.372764463226005, 50.67938360354553, 48.70153516530989, 49.11725508049129, 49.14323611184953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1468422357473516, "mean_inference_ms": 0.709333076448834, "mean_action_processing_ms": 0.10204345565775823, "mean_env_wait_ms": 0.8464159756735465, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 820000, "timesteps_this_iter": 0, "agent_timesteps_total": 2460000, "timers": {"sample_time_ms": 11221.556, "sample_throughput": 445.571, "load_time_ms": 0.201, "load_throughput": 24924554.314, "learn_time_ms": 1697.075, "learn_throughput": 2946.246, "update_time_ms": 7.92}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.916456789157588e-32, "cur_lr": 0.0005000000000000001, "total_loss": 9.858511447906494, "policy_loss": 0.0019004061107198212, "vf_loss": 9.945162868499756, "vf_explained_var": 0.013359397649765015, "kl": 0.011630081152580041, "entropy": 8.855196094512939, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 820000, "num_agent_steps_sampled": 2460000, "num_steps_trained": 820000, "num_agent_steps_trained": 2460000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2497, "training_iteration": 164, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-39-00", "timestamp": 1706229540, "time_this_iter_s": 11.002779722213745, "time_total_s": 1780.3907990455627, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202845CEB80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1780.3907990455627, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 8.95625, "ram_util_percent": 51.556250000000006}}
{"episode_reward_max": 198.23500210046757, "episode_reward_min": 95.36704777088013, "episode_reward_mean": 149.98061173240245, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 31.580767820278794}, "policy_reward_max": {"shared_policy": 66.16669589529435}, "policy_reward_mean": {"shared_policy": 49.99353724413415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [167.29711811617014, 154.9146966449918, 120.2885249815881, 138.47574885562045, 135.63967868313182, 179.17125343903913, 154.04153778497118, 145.25080377608555, 153.17331822216528, 173.49600408226263, 163.08339593559504, 174.87167711183426, 126.39833529945463, 124.67575918324289, 120.87745890766381, 198.23500210046757, 185.5245358683168, 169.66737266629926, 102.58381060790268, 159.15803583711406, 154.29903959855423, 135.4910462051629, 186.0960291894151, 95.36704777088013, 128.73582166433334, 172.78337686322644, 171.36497702635793, 151.52845612168312, 155.3440742841921, 117.52961850911376, 136.56728994520358, 147.796087389812, 134.78222066909086, 141.85314263217168, 136.6406906582414, 145.11742031201706, 145.3592088855799, 175.798382211942, 108.51369745656847, 131.106854628306, 195.06479448080063, 145.2997135668993, 131.98854989930973, 127.29172888584434, 150.53911297395842, 130.90787611994892, 161.80289067700542, 147.25767718255514, 140.8531400859356, 154.04506647004743, 138.36224216688407, 181.24458120949566, 157.24549684673545, 165.65157037228315, 170.63964699581263, 102.77533906511962, 138.92533581238254, 153.44200159260063, 142.85720162699008, 130.58987959846854, 158.00193153787396, 155.57004679739453, 141.67166147008558, 147.8995367214083, 162.04627458844334, 156.21447814628476, 147.79780694842339, 154.20253772381702, 139.36426184326393, 156.86595769226548, 124.75509865768251, 195.48825687170014, 143.57637254148716, 145.32137596607214, 151.29144034534727, 194.11018678545935, 143.97498804330831, 179.81821987940924, 169.74915772397046, 152.7916374420745, 153.43788431864246, 154.07391841709622, 146.16123098880058, 135.81129025109124, 137.40178287401778, 159.57075694500222, 196.27090508118286, 123.30166390165685, 151.53501208778468, 146.96202635765073, 131.4678499717266, 173.3331430405378, 143.8937676997155, 154.91135486215347, 151.64322108775374, 145.53719570115234, 141.84103875979784, 134.0919208973646, 152.12860475108033, 158.49298176541953], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [55.44695546726386, 55.825517120460674, 56.024645528445646, 51.490831089516476, 51.7724718277653, 51.651393727709845, 40.14009630928436, 39.9275796363751, 40.22084903592864, 46.02325128267208, 46.35079357648888, 46.101703996459634, 45.78312005723515, 44.809325392047555, 45.0472332338492, 59.8340647003303, 59.92144790353875, 59.415740835169956, 51.09772298733394, 51.48268431673448, 51.461130480902895, 48.43851776917775, 48.3041724016269, 48.50811360528071, 50.912542459865406, 51.1673185651501, 51.09345719714959, 57.52889884014924, 58.094914120932415, 57.87219112118085, 54.13970324397086, 54.323950998485074, 54.61974169313906, 58.1850747168064, 58.5537002198398, 58.13290217518805, 41.97159260511398, 42.40209465380758, 42.024648040533066, 41.918619316692144, 41.37050762275854, 41.38663224379221, 40.29353707035382, 40.077195567389325, 40.50672626992066, 66.03630611548822, 66.03200008968513, 66.16669589529435, 61.603873570760086, 61.969419516002134, 61.951242781554654, 56.528512736161545, 57.04038382818301, 56.09847610195477, 33.92312905440727, 34.186493592957646, 34.47418796053776, 53.08698782821496, 53.22781166185935, 52.843236347039536, 51.47581179315846, 51.14202393839757, 51.68120386699836, 45.07382538417974, 45.678913484017045, 44.73830733696619, 61.82250390946864, 62.33486398775129, 61.938661292195306, 31.580767820278794, 32.164166474404425, 31.622113476196915, 43.11683538307746, 42.72180004914601, 42.89718623210986, 57.32326763371627, 57.62462249646585, 57.83548673304419, 57.22358405341704, 57.1252448366334, 57.01614813630779, 50.67031637579201, 50.25279310345648, 50.60534664243458, 51.93605257570742, 52.005031166132525, 51.402990542352185, 39.186905222634465, 39.189437488714844, 39.15327579776445, 45.199211473266274, 45.54385484258333, 45.82422362935418, 49.318454434474305, 48.714646865924195, 49.76298608941336, 44.70243705560763, 45.06040330169101, 45.01938031179209, 47.10215480377276, 47.54015494448443, 47.21083288391431, 45.50006594508886, 45.79960120841861, 45.34102350473404, 48.32709345966576, 48.4656268917024, 48.324699960649, 48.65997372940181, 48.36912830173968, 48.33010685443877, 58.92493811668827, 58.4045362100005, 58.468907885253415, 36.12564266224702, 36.402655379225806, 35.98539941509564, 42.96995927890141, 44.0055447195967, 44.131350629807756, 64.79514918724696, 65.08012666801612, 65.18951862553756, 48.62239093581836, 48.46215643982093, 48.215166191260025, 44.122039910405874, 44.07336260378361, 43.79314738512039, 42.86742734846969, 42.55656441797812, 41.86773711939652, 50.14560036609571, 50.305776430914804, 50.08773617694776, 43.57841682185729, 43.48194659252961, 43.84751270556201, 54.1628784822921, 53.92425484458606, 53.71575735012691, 49.09065416579445, 49.10682997231682, 49.06019304444392, 46.77525782088439, 47.04634659985702, 47.0315356651942, 51.41293057426809, 51.44115061103365, 51.19098528474568, 46.20693216317643, 46.02207751696308, 46.13323248674472, 60.067448879281685, 60.39793897668521, 60.77919335352878, 52.30942629277705, 52.16169044375418, 52.774380110204206, 55.00695278247197, 55.191816960771874, 55.4528006290396, 56.9136910053591, 56.82977239663403, 56.89618359381954, 34.33360149152577, 34.13958132266998, 34.30215625092387, 46.26781104753414, 46.564733108195156, 46.09279165665308, 50.95702487727006, 51.46343234328863, 51.021544372042015, 47.67251918216546, 47.81631157159184, 47.36837087323268, 43.55146923288703, 43.710472129285336, 43.32793823629618, 52.47740123420952, 52.79778478201477, 52.726745521649704, 51.57939224441846, 52.10801056524117, 51.88264398773511, 47.050425489743546, 46.854254757364586, 47.766981222977236, 49.136422614256546, 49.678597527245685, 49.08451657990615, 54.08554226284225, 53.81532723208268, 54.14540509351839, 52.13416756441195, 52.0391386312743, 52.04117195059855, 49.282126301278666, 49.42112124090393, 49.094559406240776, 51.270756999651596, 51.37917283798258, 51.55260788618277, 46.42307851215203, 46.37823234995206, 46.56295098116, 52.37028394391139, 52.09108531971772, 52.40458842863639, 41.50220343718925, 41.698613566036016, 41.55428165445724, 65.01316678524016, 65.20963330566882, 65.26545678079127, 47.975389639536544, 47.57551832000415, 48.02546458194654, 48.385690716405705, 48.523505856593445, 48.41217939307292, 50.31581350664298, 50.59419457862775, 50.38143226007621, 64.64436171452205, 64.74040901164214, 64.72541605929534, 48.35308897991975, 47.79290538032849, 47.828993683060006, 59.65350013474624, 59.91655268023412, 60.248167064428955, 56.94948144474377, 56.06153208514054, 56.73814419408639, 50.844522299865886, 50.781083288292095, 51.16603185391675, 50.71436109145482, 51.11528391142686, 51.60823931576063, 51.353723491231605, 51.434413577119514, 51.28578134874503, 48.47220602134864, 48.98051782200734, 48.70850714544456, 45.214429281651974, 45.46008607186377, 45.13677489757538, 45.85868905112147, 45.65082263946533, 45.89227118343115, 53.05109655857085, 53.22918173298238, 53.290478653449085, 65.22094341615836, 65.57331871862213, 65.47664294640224, 41.12282605220874, 40.586826403935746, 41.59201144551237, 50.482864021013185, 50.372764463226005, 50.67938360354553, 48.70153516530989, 49.11725508049129, 49.14323611184953, 43.99205114878714, 43.78566700220108, 43.690131820738316, 57.51266868412493, 58.29815717041491, 57.52231718599795, 48.185014131284944, 47.82012838373582, 47.88862518469493, 51.73301053792237, 51.50810790807007, 51.670236416161046, 50.32219868401687, 50.68115510294835, 50.639867300788566, 48.2989068677028, 48.63237255935867, 48.6059162740906, 47.27381087094544, 47.40288910642265, 47.16433878242968, 44.76788543413082, 44.43349596361318, 44.89053949962059, 50.56609942515691, 51.03772220139702, 50.52478312452634, 51.767212460438415, 53.26054907465975, 53.465220230321094]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14692367745517168, "mean_inference_ms": 0.7098697758406314, "mean_action_processing_ms": 0.10206826384322952, "mean_env_wait_ms": 0.8466441772960228, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 825000, "timesteps_this_iter": 0, "agent_timesteps_total": 2475000, "timers": {"sample_time_ms": 11253.149, "sample_throughput": 444.32, "load_time_ms": 0.201, "load_throughput": 24924554.314, "learn_time_ms": 1693.401, "learn_throughput": 2952.638, "update_time_ms": 8.072}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.916456789157588e-32, "cur_lr": 0.0005000000000000001, "total_loss": 8.243709373474122, "policy_loss": -0.0004824529158354629, "vf_loss": 8.331627368927002, "vf_explained_var": 0.018758130073547364, "kl": 0.004712489573319725, "entropy": 8.743556022644043, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 825000, "num_agent_steps_sampled": 2475000, "num_steps_trained": 825000, "num_agent_steps_trained": 2475000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2507, "training_iteration": 165, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-39-12", "timestamp": 1706229552, "time_this_iter_s": 11.196815252304077, "time_total_s": 1791.5876142978668, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202845CE040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1791.5876142978668, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 10.46875, "ram_util_percent": 51.587500000000006}}
{"episode_reward_max": 209.5563368350266, "episode_reward_min": 95.36704777088013, "episode_reward_mean": 150.12824057291607, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 31.580767820278794}, "policy_reward_max": {"shared_policy": 70.18273550520341}, "policy_reward_mean": {"shared_policy": 50.0427468576387}, "custom_metrics": {}, "hist_stats": {"episode_reward": [163.08339593559504, 174.87167711183426, 126.39833529945463, 124.67575918324289, 120.87745890766381, 198.23500210046757, 185.5245358683168, 169.66737266629926, 102.58381060790268, 159.15803583711406, 154.29903959855423, 135.4910462051629, 186.0960291894151, 95.36704777088013, 128.73582166433334, 172.78337686322644, 171.36497702635793, 151.52845612168312, 155.3440742841921, 117.52961850911376, 136.56728994520358, 147.796087389812, 134.78222066909086, 141.85314263217168, 136.6406906582414, 145.11742031201706, 145.3592088855799, 175.798382211942, 108.51369745656847, 131.106854628306, 195.06479448080063, 145.2997135668993, 131.98854989930973, 127.29172888584434, 150.53911297395842, 130.90787611994892, 161.80289067700542, 147.25767718255514, 140.8531400859356, 154.04506647004743, 138.36224216688407, 181.24458120949566, 157.24549684673545, 165.65157037228315, 170.63964699581263, 102.77533906511962, 138.92533581238254, 153.44200159260063, 142.85720162699008, 130.58987959846854, 158.00193153787396, 155.57004679739453, 141.67166147008558, 147.8995367214083, 162.04627458844334, 156.21447814628476, 147.79780694842339, 154.20253772381702, 139.36426184326393, 156.86595769226548, 124.75509865768251, 195.48825687170014, 143.57637254148716, 145.32137596607214, 151.29144034534727, 194.11018678545935, 143.97498804330831, 179.81821987940924, 169.74915772397046, 152.7916374420745, 153.43788431864246, 154.07391841709622, 146.16123098880058, 135.81129025109124, 137.40178287401778, 159.57075694500222, 196.27090508118286, 123.30166390165685, 151.53501208778468, 146.96202635765073, 131.4678499717266, 173.3331430405378, 143.8937676997155, 154.91135486215347, 151.64322108775374, 145.53719570115234, 141.84103875979784, 134.0919208973646, 152.12860475108033, 158.49298176541953, 146.3094928786157, 161.53664927021572, 172.4990283474327, 158.69034225959322, 121.09683272388065, 133.32563954591728, 143.0355761428363, 209.5563368350266, 139.00656017707652, 151.45511045679447], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [54.13970324397086, 54.323950998485074, 54.61974169313906, 58.1850747168064, 58.5537002198398, 58.13290217518805, 41.97159260511398, 42.40209465380758, 42.024648040533066, 41.918619316692144, 41.37050762275854, 41.38663224379221, 40.29353707035382, 40.077195567389325, 40.50672626992066, 66.03630611548822, 66.03200008968513, 66.16669589529435, 61.603873570760086, 61.969419516002134, 61.951242781554654, 56.528512736161545, 57.04038382818301, 56.09847610195477, 33.92312905440727, 34.186493592957646, 34.47418796053776, 53.08698782821496, 53.22781166185935, 52.843236347039536, 51.47581179315846, 51.14202393839757, 51.68120386699836, 45.07382538417974, 45.678913484017045, 44.73830733696619, 61.82250390946864, 62.33486398775129, 61.938661292195306, 31.580767820278794, 32.164166474404425, 31.622113476196915, 43.11683538307746, 42.72180004914601, 42.89718623210986, 57.32326763371627, 57.62462249646585, 57.83548673304419, 57.22358405341704, 57.1252448366334, 57.01614813630779, 50.67031637579201, 50.25279310345648, 50.60534664243458, 51.93605257570742, 52.005031166132525, 51.402990542352185, 39.186905222634465, 39.189437488714844, 39.15327579776445, 45.199211473266274, 45.54385484258333, 45.82422362935418, 49.318454434474305, 48.714646865924195, 49.76298608941336, 44.70243705560763, 45.06040330169101, 45.01938031179209, 47.10215480377276, 47.54015494448443, 47.21083288391431, 45.50006594508886, 45.79960120841861, 45.34102350473404, 48.32709345966576, 48.4656268917024, 48.324699960649, 48.65997372940181, 48.36912830173968, 48.33010685443877, 58.92493811668827, 58.4045362100005, 58.468907885253415, 36.12564266224702, 36.402655379225806, 35.98539941509564, 42.96995927890141, 44.0055447195967, 44.131350629807756, 64.79514918724696, 65.08012666801612, 65.18951862553756, 48.62239093581836, 48.46215643982093, 48.215166191260025, 44.122039910405874, 44.07336260378361, 43.79314738512039, 42.86742734846969, 42.55656441797812, 41.86773711939652, 50.14560036609571, 50.305776430914804, 50.08773617694776, 43.57841682185729, 43.48194659252961, 43.84751270556201, 54.1628784822921, 53.92425484458606, 53.71575735012691, 49.09065416579445, 49.10682997231682, 49.06019304444392, 46.77525782088439, 47.04634659985702, 47.0315356651942, 51.41293057426809, 51.44115061103365, 51.19098528474568, 46.20693216317643, 46.02207751696308, 46.13323248674472, 60.067448879281685, 60.39793897668521, 60.77919335352878, 52.30942629277705, 52.16169044375418, 52.774380110204206, 55.00695278247197, 55.191816960771874, 55.4528006290396, 56.9136910053591, 56.82977239663403, 56.89618359381954, 34.33360149152577, 34.13958132266998, 34.30215625092387, 46.26781104753414, 46.564733108195156, 46.09279165665308, 50.95702487727006, 51.46343234328863, 51.021544372042015, 47.67251918216546, 47.81631157159184, 47.36837087323268, 43.55146923288703, 43.710472129285336, 43.32793823629618, 52.47740123420952, 52.79778478201477, 52.726745521649704, 51.57939224441846, 52.10801056524117, 51.88264398773511, 47.050425489743546, 46.854254757364586, 47.766981222977236, 49.136422614256546, 49.678597527245685, 49.08451657990615, 54.08554226284225, 53.81532723208268, 54.14540509351839, 52.13416756441195, 52.0391386312743, 52.04117195059855, 49.282126301278666, 49.42112124090393, 49.094559406240776, 51.270756999651596, 51.37917283798258, 51.55260788618277, 46.42307851215203, 46.37823234995206, 46.56295098116, 52.37028394391139, 52.09108531971772, 52.40458842863639, 41.50220343718925, 41.698613566036016, 41.55428165445724, 65.01316678524016, 65.20963330566882, 65.26545678079127, 47.975389639536544, 47.57551832000415, 48.02546458194654, 48.385690716405705, 48.523505856593445, 48.41217939307292, 50.31581350664298, 50.59419457862775, 50.38143226007621, 64.64436171452205, 64.74040901164214, 64.72541605929534, 48.35308897991975, 47.79290538032849, 47.828993683060006, 59.65350013474624, 59.91655268023412, 60.248167064428955, 56.94948144474377, 56.06153208514054, 56.73814419408639, 50.844522299865886, 50.781083288292095, 51.16603185391675, 50.71436109145482, 51.11528391142686, 51.60823931576063, 51.353723491231605, 51.434413577119514, 51.28578134874503, 48.47220602134864, 48.98051782200734, 48.70850714544456, 45.214429281651974, 45.46008607186377, 45.13677489757538, 45.85868905112147, 45.65082263946533, 45.89227118343115, 53.05109655857085, 53.22918173298238, 53.290478653449085, 65.22094341615836, 65.57331871862213, 65.47664294640224, 41.12282605220874, 40.586826403935746, 41.59201144551237, 50.482864021013185, 50.372764463226005, 50.67938360354553, 48.70153516530989, 49.11725508049129, 49.14323611184953, 43.99205114878714, 43.78566700220108, 43.690131820738316, 57.51266868412493, 58.29815717041491, 57.52231718599795, 48.185014131284944, 47.82012838373582, 47.88862518469493, 51.73301053792237, 51.50810790807007, 51.670236416161046, 50.32219868401687, 50.68115510294835, 50.639867300788566, 48.2989068677028, 48.63237255935867, 48.6059162740906, 47.27381087094544, 47.40288910642265, 47.16433878242968, 44.76788543413082, 44.43349596361318, 44.89053949962059, 50.56609942515691, 51.03772220139702, 50.52478312452634, 51.767212460438415, 53.26054907465975, 53.465220230321094, 48.812970119218036, 48.79567922155063, 48.700843537847206, 53.731193823119, 53.76656388988097, 54.03889155721602, 57.336185182134315, 57.61037437121074, 57.552468794087574, 52.88504744072755, 52.56371224423249, 53.241582574633256, 40.12605046480894, 40.32884744554758, 40.64193481352413, 44.34755628059307, 44.30783723543087, 44.67024602989355, 47.83555669927348, 47.32047330339749, 47.879546140165374, 70.18273550520341, 69.56064685682456, 69.81295447299878, 46.66497155325487, 46.1955701187253, 46.146018505096436, 50.148289059599236, 50.57815883805354, 50.72866255914171]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14698236612163232, "mean_inference_ms": 0.7102542450854409, "mean_action_processing_ms": 0.10209770419386036, "mean_env_wait_ms": 0.8467777448025217, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 830000, "timesteps_this_iter": 0, "agent_timesteps_total": 2490000, "timers": {"sample_time_ms": 11287.482, "sample_throughput": 442.969, "load_time_ms": 0.201, "load_throughput": 24924554.314, "learn_time_ms": 1683.929, "learn_throughput": 2969.246, "update_time_ms": 8.051}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.958228394578794e-32, "cur_lr": 0.0005000000000000001, "total_loss": 6.756020832061767, "policy_loss": -0.0008221789255257406, "vf_loss": 6.846038722991944, "vf_explained_var": 0.022394365072250365, "kl": 0.0031660976354394047, "entropy": 8.919589424133301, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 830000, "num_agent_steps_sampled": 2490000, "num_steps_trained": 830000, "num_agent_steps_trained": 2490000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2517, "training_iteration": 166, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-39-23", "timestamp": 1706229563, "time_this_iter_s": 10.97889757156372, "time_total_s": 1802.5665118694305, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202808349D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1802.5665118694305, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 8.95625, "ram_util_percent": 51.5625}}
{"episode_reward_max": 209.5563368350266, "episode_reward_min": 95.36704777088013, "episode_reward_mean": 149.82282303485883, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 31.580767820278794}, "policy_reward_max": {"shared_policy": 70.18273550520341}, "policy_reward_mean": {"shared_policy": 49.940941011619614}, "custom_metrics": {}, "hist_stats": {"episode_reward": [154.29903959855423, 135.4910462051629, 186.0960291894151, 95.36704777088013, 128.73582166433334, 172.78337686322644, 171.36497702635793, 151.52845612168312, 155.3440742841921, 117.52961850911376, 136.56728994520358, 147.796087389812, 134.78222066909086, 141.85314263217168, 136.6406906582414, 145.11742031201706, 145.3592088855799, 175.798382211942, 108.51369745656847, 131.106854628306, 195.06479448080063, 145.2997135668993, 131.98854989930973, 127.29172888584434, 150.53911297395842, 130.90787611994892, 161.80289067700542, 147.25767718255514, 140.8531400859356, 154.04506647004743, 138.36224216688407, 181.24458120949566, 157.24549684673545, 165.65157037228315, 170.63964699581263, 102.77533906511962, 138.92533581238254, 153.44200159260063, 142.85720162699008, 130.58987959846854, 158.00193153787396, 155.57004679739453, 141.67166147008558, 147.8995367214083, 162.04627458844334, 156.21447814628476, 147.79780694842339, 154.20253772381702, 139.36426184326393, 156.86595769226548, 124.75509865768251, 195.48825687170014, 143.57637254148716, 145.32137596607214, 151.29144034534727, 194.11018678545935, 143.97498804330831, 179.81821987940924, 169.74915772397046, 152.7916374420745, 153.43788431864246, 154.07391841709622, 146.16123098880058, 135.81129025109124, 137.40178287401778, 159.57075694500222, 196.27090508118286, 123.30166390165685, 151.53501208778468, 146.96202635765073, 131.4678499717266, 173.3331430405378, 143.8937676997155, 154.91135486215347, 151.64322108775374, 145.53719570115234, 141.84103875979784, 134.0919208973646, 152.12860475108033, 158.49298176541953, 146.3094928786157, 161.53664927021572, 172.4990283474327, 158.69034225959322, 121.09683272388065, 133.32563954591728, 143.0355761428363, 209.5563368350266, 139.00656017707652, 151.45511045679447, 138.6213423684238, 144.21789395809162, 143.03059025295082, 144.036084196978, 143.3836516849696, 139.45852762740108, 165.94741271436223, 174.12057987600556, 142.5911151915789, 159.12643184140342], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [51.47581179315846, 51.14202393839757, 51.68120386699836, 45.07382538417974, 45.678913484017045, 44.73830733696619, 61.82250390946864, 62.33486398775129, 61.938661292195306, 31.580767820278794, 32.164166474404425, 31.622113476196915, 43.11683538307746, 42.72180004914601, 42.89718623210986, 57.32326763371627, 57.62462249646585, 57.83548673304419, 57.22358405341704, 57.1252448366334, 57.01614813630779, 50.67031637579201, 50.25279310345648, 50.60534664243458, 51.93605257570742, 52.005031166132525, 51.402990542352185, 39.186905222634465, 39.189437488714844, 39.15327579776445, 45.199211473266274, 45.54385484258333, 45.82422362935418, 49.318454434474305, 48.714646865924195, 49.76298608941336, 44.70243705560763, 45.06040330169101, 45.01938031179209, 47.10215480377276, 47.54015494448443, 47.21083288391431, 45.50006594508886, 45.79960120841861, 45.34102350473404, 48.32709345966576, 48.4656268917024, 48.324699960649, 48.65997372940181, 48.36912830173968, 48.33010685443877, 58.92493811668827, 58.4045362100005, 58.468907885253415, 36.12564266224702, 36.402655379225806, 35.98539941509564, 42.96995927890141, 44.0055447195967, 44.131350629807756, 64.79514918724696, 65.08012666801612, 65.18951862553756, 48.62239093581836, 48.46215643982093, 48.215166191260025, 44.122039910405874, 44.07336260378361, 43.79314738512039, 42.86742734846969, 42.55656441797812, 41.86773711939652, 50.14560036609571, 50.305776430914804, 50.08773617694776, 43.57841682185729, 43.48194659252961, 43.84751270556201, 54.1628784822921, 53.92425484458606, 53.71575735012691, 49.09065416579445, 49.10682997231682, 49.06019304444392, 46.77525782088439, 47.04634659985702, 47.0315356651942, 51.41293057426809, 51.44115061103365, 51.19098528474568, 46.20693216317643, 46.02207751696308, 46.13323248674472, 60.067448879281685, 60.39793897668521, 60.77919335352878, 52.30942629277705, 52.16169044375418, 52.774380110204206, 55.00695278247197, 55.191816960771874, 55.4528006290396, 56.9136910053591, 56.82977239663403, 56.89618359381954, 34.33360149152577, 34.13958132266998, 34.30215625092387, 46.26781104753414, 46.564733108195156, 46.09279165665308, 50.95702487727006, 51.46343234328863, 51.021544372042015, 47.67251918216546, 47.81631157159184, 47.36837087323268, 43.55146923288703, 43.710472129285336, 43.32793823629618, 52.47740123420952, 52.79778478201477, 52.726745521649704, 51.57939224441846, 52.10801056524117, 51.88264398773511, 47.050425489743546, 46.854254757364586, 47.766981222977236, 49.136422614256546, 49.678597527245685, 49.08451657990615, 54.08554226284225, 53.81532723208268, 54.14540509351839, 52.13416756441195, 52.0391386312743, 52.04117195059855, 49.282126301278666, 49.42112124090393, 49.094559406240776, 51.270756999651596, 51.37917283798258, 51.55260788618277, 46.42307851215203, 46.37823234995206, 46.56295098116, 52.37028394391139, 52.09108531971772, 52.40458842863639, 41.50220343718925, 41.698613566036016, 41.55428165445724, 65.01316678524016, 65.20963330566882, 65.26545678079127, 47.975389639536544, 47.57551832000415, 48.02546458194654, 48.385690716405705, 48.523505856593445, 48.41217939307292, 50.31581350664298, 50.59419457862775, 50.38143226007621, 64.64436171452205, 64.74040901164214, 64.72541605929534, 48.35308897991975, 47.79290538032849, 47.828993683060006, 59.65350013474624, 59.91655268023412, 60.248167064428955, 56.94948144474377, 56.06153208514054, 56.73814419408639, 50.844522299865886, 50.781083288292095, 51.16603185391675, 50.71436109145482, 51.11528391142686, 51.60823931576063, 51.353723491231605, 51.434413577119514, 51.28578134874503, 48.47220602134864, 48.98051782200734, 48.70850714544456, 45.214429281651974, 45.46008607186377, 45.13677489757538, 45.85868905112147, 45.65082263946533, 45.89227118343115, 53.05109655857085, 53.22918173298238, 53.290478653449085, 65.22094341615836, 65.57331871862213, 65.47664294640224, 41.12282605220874, 40.586826403935746, 41.59201144551237, 50.482864021013185, 50.372764463226005, 50.67938360354553, 48.70153516530989, 49.11725508049129, 49.14323611184953, 43.99205114878714, 43.78566700220108, 43.690131820738316, 57.51266868412493, 58.29815717041491, 57.52231718599795, 48.185014131284944, 47.82012838373582, 47.88862518469493, 51.73301053792237, 51.50810790807007, 51.670236416161046, 50.32219868401687, 50.68115510294835, 50.639867300788566, 48.2989068677028, 48.63237255935867, 48.6059162740906, 47.27381087094544, 47.40288910642265, 47.16433878242968, 44.76788543413082, 44.43349596361318, 44.89053949962059, 50.56609942515691, 51.03772220139702, 50.52478312452634, 51.767212460438415, 53.26054907465975, 53.465220230321094, 48.812970119218036, 48.79567922155063, 48.700843537847206, 53.731193823119, 53.76656388988097, 54.03889155721602, 57.336185182134315, 57.61037437121074, 57.552468794087574, 52.88504744072755, 52.56371224423249, 53.241582574633256, 40.12605046480894, 40.32884744554758, 40.64193481352413, 44.34755628059307, 44.30783723543087, 44.67024602989355, 47.83555669927348, 47.32047330339749, 47.879546140165374, 70.18273550520341, 69.56064685682456, 69.81295447299878, 46.66497155325487, 46.1955701187253, 46.146018505096436, 50.148289059599236, 50.57815883805354, 50.72866255914171, 46.34624496102333, 46.092411652207375, 46.18268575519323, 47.98207370936869, 48.496918290853486, 47.738901957869516, 47.74301531910895, 47.47337385267018, 47.81420108117162, 47.910264121989414, 48.23884657970363, 47.88697349528472, 47.50612664719422, 47.84981373449166, 48.027711303283766, 46.72347721240172, 46.26699988792339, 46.46805052707592, 55.36476217706998, 55.267293234666184, 55.31535730262597, 57.79313170413177, 57.9017198185126, 58.42572835336129, 47.20581823090713, 47.85912708441417, 47.52616987625758, 53.00533090780179, 52.89283097783725, 53.22826995576422]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14703575940104543, "mean_inference_ms": 0.7105934963789098, "mean_action_processing_ms": 0.10211595307123736, "mean_env_wait_ms": 0.8468860090736, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 835000, "timesteps_this_iter": 0, "agent_timesteps_total": 2505000, "timers": {"sample_time_ms": 11211.191, "sample_throughput": 445.983, "load_time_ms": 0.301, "load_throughput": 16584831.949, "learn_time_ms": 1693.583, "learn_throughput": 2952.32, "update_time_ms": 8.251}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.479114197289397e-32, "cur_lr": 0.0005000000000000001, "total_loss": 10.645123863220215, "policy_loss": 0.004903545182806823, "vf_loss": 10.727160167694091, "vf_explained_var": 0.013531714677810669, "kl": 0.014895753189957861, "entropy": 8.69396333694458, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 835000, "num_agent_steps_sampled": 2505000, "num_steps_trained": 835000, "num_agent_steps_trained": 2505000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2527, "training_iteration": 167, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-39-33", "timestamp": 1706229573, "time_this_iter_s": 10.652917861938477, "time_total_s": 1813.219429731369, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020284553040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1813.219429731369, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 9.360000000000001, "ram_util_percent": 51.573333333333345}}
{"episode_reward_max": 209.5563368350266, "episode_reward_min": 102.77533906511962, "episode_reward_mean": 151.02174762757124, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 34.13958132266998}, "policy_reward_max": {"shared_policy": 70.18273550520341}, "policy_reward_mean": {"shared_policy": 50.340582542523755}, "custom_metrics": {}, "hist_stats": {"episode_reward": [136.56728994520358, 147.796087389812, 134.78222066909086, 141.85314263217168, 136.6406906582414, 145.11742031201706, 145.3592088855799, 175.798382211942, 108.51369745656847, 131.106854628306, 195.06479448080063, 145.2997135668993, 131.98854989930973, 127.29172888584434, 150.53911297395842, 130.90787611994892, 161.80289067700542, 147.25767718255514, 140.8531400859356, 154.04506647004743, 138.36224216688407, 181.24458120949566, 157.24549684673545, 165.65157037228315, 170.63964699581263, 102.77533906511962, 138.92533581238254, 153.44200159260063, 142.85720162699008, 130.58987959846854, 158.00193153787396, 155.57004679739453, 141.67166147008558, 147.8995367214083, 162.04627458844334, 156.21447814628476, 147.79780694842339, 154.20253772381702, 139.36426184326393, 156.86595769226548, 124.75509865768251, 195.48825687170014, 143.57637254148716, 145.32137596607214, 151.29144034534727, 194.11018678545935, 143.97498804330831, 179.81821987940924, 169.74915772397046, 152.7916374420745, 153.43788431864246, 154.07391841709622, 146.16123098880058, 135.81129025109124, 137.40178287401778, 159.57075694500222, 196.27090508118286, 123.30166390165685, 151.53501208778468, 146.96202635765073, 131.4678499717266, 173.3331430405378, 143.8937676997155, 154.91135486215347, 151.64322108775374, 145.53719570115234, 141.84103875979784, 134.0919208973646, 152.12860475108033, 158.49298176541953, 146.3094928786157, 161.53664927021572, 172.4990283474327, 158.69034225959322, 121.09683272388065, 133.32563954591728, 143.0355761428363, 209.5563368350266, 139.00656017707652, 151.45511045679447, 138.6213423684238, 144.21789395809162, 143.03059025295082, 144.036084196978, 143.3836516849696, 139.45852762740108, 165.94741271436223, 174.12057987600556, 142.5911151915789, 159.12643184140342, 170.68745271116478, 143.37014530226568, 175.0486257895827, 172.0916058421136, 134.7993693586904, 168.91150784492513, 170.3469083458186, 147.85394001658986, 170.86926613654913, 134.45312515646214], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [45.199211473266274, 45.54385484258333, 45.82422362935418, 49.318454434474305, 48.714646865924195, 49.76298608941336, 44.70243705560763, 45.06040330169101, 45.01938031179209, 47.10215480377276, 47.54015494448443, 47.21083288391431, 45.50006594508886, 45.79960120841861, 45.34102350473404, 48.32709345966576, 48.4656268917024, 48.324699960649, 48.65997372940181, 48.36912830173968, 48.33010685443877, 58.92493811668827, 58.4045362100005, 58.468907885253415, 36.12564266224702, 36.402655379225806, 35.98539941509564, 42.96995927890141, 44.0055447195967, 44.131350629807756, 64.79514918724696, 65.08012666801612, 65.18951862553756, 48.62239093581836, 48.46215643982093, 48.215166191260025, 44.122039910405874, 44.07336260378361, 43.79314738512039, 42.86742734846969, 42.55656441797812, 41.86773711939652, 50.14560036609571, 50.305776430914804, 50.08773617694776, 43.57841682185729, 43.48194659252961, 43.84751270556201, 54.1628784822921, 53.92425484458606, 53.71575735012691, 49.09065416579445, 49.10682997231682, 49.06019304444392, 46.77525782088439, 47.04634659985702, 47.0315356651942, 51.41293057426809, 51.44115061103365, 51.19098528474568, 46.20693216317643, 46.02207751696308, 46.13323248674472, 60.067448879281685, 60.39793897668521, 60.77919335352878, 52.30942629277705, 52.16169044375418, 52.774380110204206, 55.00695278247197, 55.191816960771874, 55.4528006290396, 56.9136910053591, 56.82977239663403, 56.89618359381954, 34.33360149152577, 34.13958132266998, 34.30215625092387, 46.26781104753414, 46.564733108195156, 46.09279165665308, 50.95702487727006, 51.46343234328863, 51.021544372042015, 47.67251918216546, 47.81631157159184, 47.36837087323268, 43.55146923288703, 43.710472129285336, 43.32793823629618, 52.47740123420952, 52.79778478201477, 52.726745521649704, 51.57939224441846, 52.10801056524117, 51.88264398773511, 47.050425489743546, 46.854254757364586, 47.766981222977236, 49.136422614256546, 49.678597527245685, 49.08451657990615, 54.08554226284225, 53.81532723208268, 54.14540509351839, 52.13416756441195, 52.0391386312743, 52.04117195059855, 49.282126301278666, 49.42112124090393, 49.094559406240776, 51.270756999651596, 51.37917283798258, 51.55260788618277, 46.42307851215203, 46.37823234995206, 46.56295098116, 52.37028394391139, 52.09108531971772, 52.40458842863639, 41.50220343718925, 41.698613566036016, 41.55428165445724, 65.01316678524016, 65.20963330566882, 65.26545678079127, 47.975389639536544, 47.57551832000415, 48.02546458194654, 48.385690716405705, 48.523505856593445, 48.41217939307292, 50.31581350664298, 50.59419457862775, 50.38143226007621, 64.64436171452205, 64.74040901164214, 64.72541605929534, 48.35308897991975, 47.79290538032849, 47.828993683060006, 59.65350013474624, 59.91655268023412, 60.248167064428955, 56.94948144474377, 56.06153208514054, 56.73814419408639, 50.844522299865886, 50.781083288292095, 51.16603185391675, 50.71436109145482, 51.11528391142686, 51.60823931576063, 51.353723491231605, 51.434413577119514, 51.28578134874503, 48.47220602134864, 48.98051782200734, 48.70850714544456, 45.214429281651974, 45.46008607186377, 45.13677489757538, 45.85868905112147, 45.65082263946533, 45.89227118343115, 53.05109655857085, 53.22918173298238, 53.290478653449085, 65.22094341615836, 65.57331871862213, 65.47664294640224, 41.12282605220874, 40.586826403935746, 41.59201144551237, 50.482864021013185, 50.372764463226005, 50.67938360354553, 48.70153516530989, 49.11725508049129, 49.14323611184953, 43.99205114878714, 43.78566700220108, 43.690131820738316, 57.51266868412493, 58.29815717041491, 57.52231718599795, 48.185014131284944, 47.82012838373582, 47.88862518469493, 51.73301053792237, 51.50810790807007, 51.670236416161046, 50.32219868401687, 50.68115510294835, 50.639867300788566, 48.2989068677028, 48.63237255935867, 48.6059162740906, 47.27381087094544, 47.40288910642265, 47.16433878242968, 44.76788543413082, 44.43349596361318, 44.89053949962059, 50.56609942515691, 51.03772220139702, 50.52478312452634, 51.767212460438415, 53.26054907465975, 53.465220230321094, 48.812970119218036, 48.79567922155063, 48.700843537847206, 53.731193823119, 53.76656388988097, 54.03889155721602, 57.336185182134315, 57.61037437121074, 57.552468794087574, 52.88504744072755, 52.56371224423249, 53.241582574633256, 40.12605046480894, 40.32884744554758, 40.64193481352413, 44.34755628059307, 44.30783723543087, 44.67024602989355, 47.83555669927348, 47.32047330339749, 47.879546140165374, 70.18273550520341, 69.56064685682456, 69.81295447299878, 46.66497155325487, 46.1955701187253, 46.146018505096436, 50.148289059599236, 50.57815883805354, 50.72866255914171, 46.34624496102333, 46.092411652207375, 46.18268575519323, 47.98207370936869, 48.496918290853486, 47.738901957869516, 47.74301531910895, 47.47337385267018, 47.81420108117162, 47.910264121989414, 48.23884657970363, 47.88697349528472, 47.50612664719422, 47.84981373449166, 48.027711303283766, 46.72347721240172, 46.26699988792339, 46.46805052707592, 55.36476217706998, 55.267293234666184, 55.31535730262597, 57.79313170413177, 57.9017198185126, 58.42572835336129, 47.20581823090713, 47.85912708441417, 47.52616987625758, 53.00533090780179, 52.89283097783725, 53.22826995576422, 57.37735751022895, 56.72091632088025, 56.58917888005574, 47.6551864867409, 48.15306708340843, 47.561891732116536, 58.44973584140341, 58.268333929280445, 58.33055601889889, 57.23250653346379, 57.504023795326546, 57.35507551332314, 44.70120006799698, 45.403942668111995, 44.69422662258148, 56.37889947990577, 56.361544097463295, 56.17106426755588, 56.98003043731053, 56.80947711070378, 56.55740079780419, 49.45807599431525, 49.420179533461734, 48.97568448881309, 56.413776611288384, 56.98663539936145, 57.46885412589957, 44.481654182076454, 44.98356429487467, 44.98790667951107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1470927912967152, "mean_inference_ms": 0.7109720556719801, "mean_action_processing_ms": 0.1021407477662209, "mean_env_wait_ms": 0.847016104953791, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 840000, "timesteps_this_iter": 0, "agent_timesteps_total": 2520000, "timers": {"sample_time_ms": 11284.722, "sample_throughput": 443.077, "load_time_ms": 0.201, "load_throughput": 24821304.296, "learn_time_ms": 1713.393, "learn_throughput": 2918.187, "update_time_ms": 8.145}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.479114197289397e-32, "cur_lr": 0.0005000000000000001, "total_loss": 8.871755886077882, "policy_loss": 0.001031203649553092, "vf_loss": 8.959416103363036, "vf_explained_var": 0.02299622893333435, "kl": 0.007666175998783572, "entropy": 8.86911849975586, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 840000, "num_agent_steps_sampled": 2520000, "num_steps_trained": 840000, "num_agent_steps_trained": 2520000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2537, "training_iteration": 168, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-39-45", "timestamp": 1706229585, "time_this_iter_s": 11.66911792755127, "time_total_s": 1824.8885476589203, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282218310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1824.8885476589203, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 9.44375, "ram_util_percent": 51.83125}}
{"episode_reward_max": 209.5563368350266, "episode_reward_min": 102.77533906511962, "episode_reward_mean": 152.37407535006156, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 34.13958132266998}, "policy_reward_max": {"shared_policy": 70.18273550520341}, "policy_reward_mean": {"shared_policy": 50.79135845002052}, "custom_metrics": {}, "hist_stats": {"episode_reward": [195.06479448080063, 145.2997135668993, 131.98854989930973, 127.29172888584434, 150.53911297395842, 130.90787611994892, 161.80289067700542, 147.25767718255514, 140.8531400859356, 154.04506647004743, 138.36224216688407, 181.24458120949566, 157.24549684673545, 165.65157037228315, 170.63964699581263, 102.77533906511962, 138.92533581238254, 153.44200159260063, 142.85720162699008, 130.58987959846854, 158.00193153787396, 155.57004679739453, 141.67166147008558, 147.8995367214083, 162.04627458844334, 156.21447814628476, 147.79780694842339, 154.20253772381702, 139.36426184326393, 156.86595769226548, 124.75509865768251, 195.48825687170014, 143.57637254148716, 145.32137596607214, 151.29144034534727, 194.11018678545935, 143.97498804330831, 179.81821987940924, 169.74915772397046, 152.7916374420745, 153.43788431864246, 154.07391841709622, 146.16123098880058, 135.81129025109124, 137.40178287401778, 159.57075694500222, 196.27090508118286, 123.30166390165685, 151.53501208778468, 146.96202635765073, 131.4678499717266, 173.3331430405378, 143.8937676997155, 154.91135486215347, 151.64322108775374, 145.53719570115234, 141.84103875979784, 134.0919208973646, 152.12860475108033, 158.49298176541953, 146.3094928786157, 161.53664927021572, 172.4990283474327, 158.69034225959322, 121.09683272388065, 133.32563954591728, 143.0355761428363, 209.5563368350266, 139.00656017707652, 151.45511045679447, 138.6213423684238, 144.21789395809162, 143.03059025295082, 144.036084196978, 143.3836516849696, 139.45852762740108, 165.94741271436223, 174.12057987600556, 142.5911151915789, 159.12643184140342, 170.68745271116478, 143.37014530226568, 175.0486257895827, 172.0916058421136, 134.7993693586904, 168.91150784492513, 170.3469083458186, 147.85394001658986, 170.86926613654913, 134.45312515646214, 146.6216513141991, 133.0311255846172, 153.15990808233607, 154.41246754676123, 163.18073012307298, 143.07130255550155, 120.50533770304172, 179.13429195806347, 185.7972649820148, 159.85368718835548], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [64.79514918724696, 65.08012666801612, 65.18951862553756, 48.62239093581836, 48.46215643982093, 48.215166191260025, 44.122039910405874, 44.07336260378361, 43.79314738512039, 42.86742734846969, 42.55656441797812, 41.86773711939652, 50.14560036609571, 50.305776430914804, 50.08773617694776, 43.57841682185729, 43.48194659252961, 43.84751270556201, 54.1628784822921, 53.92425484458606, 53.71575735012691, 49.09065416579445, 49.10682997231682, 49.06019304444392, 46.77525782088439, 47.04634659985702, 47.0315356651942, 51.41293057426809, 51.44115061103365, 51.19098528474568, 46.20693216317643, 46.02207751696308, 46.13323248674472, 60.067448879281685, 60.39793897668521, 60.77919335352878, 52.30942629277705, 52.16169044375418, 52.774380110204206, 55.00695278247197, 55.191816960771874, 55.4528006290396, 56.9136910053591, 56.82977239663403, 56.89618359381954, 34.33360149152577, 34.13958132266998, 34.30215625092387, 46.26781104753414, 46.564733108195156, 46.09279165665308, 50.95702487727006, 51.46343234328863, 51.021544372042015, 47.67251918216546, 47.81631157159184, 47.36837087323268, 43.55146923288703, 43.710472129285336, 43.32793823629618, 52.47740123420952, 52.79778478201477, 52.726745521649704, 51.57939224441846, 52.10801056524117, 51.88264398773511, 47.050425489743546, 46.854254757364586, 47.766981222977236, 49.136422614256546, 49.678597527245685, 49.08451657990615, 54.08554226284225, 53.81532723208268, 54.14540509351839, 52.13416756441195, 52.0391386312743, 52.04117195059855, 49.282126301278666, 49.42112124090393, 49.094559406240776, 51.270756999651596, 51.37917283798258, 51.55260788618277, 46.42307851215203, 46.37823234995206, 46.56295098116, 52.37028394391139, 52.09108531971772, 52.40458842863639, 41.50220343718925, 41.698613566036016, 41.55428165445724, 65.01316678524016, 65.20963330566882, 65.26545678079127, 47.975389639536544, 47.57551832000415, 48.02546458194654, 48.385690716405705, 48.523505856593445, 48.41217939307292, 50.31581350664298, 50.59419457862775, 50.38143226007621, 64.64436171452205, 64.74040901164214, 64.72541605929534, 48.35308897991975, 47.79290538032849, 47.828993683060006, 59.65350013474624, 59.91655268023412, 60.248167064428955, 56.94948144474377, 56.06153208514054, 56.73814419408639, 50.844522299865886, 50.781083288292095, 51.16603185391675, 50.71436109145482, 51.11528391142686, 51.60823931576063, 51.353723491231605, 51.434413577119514, 51.28578134874503, 48.47220602134864, 48.98051782200734, 48.70850714544456, 45.214429281651974, 45.46008607186377, 45.13677489757538, 45.85868905112147, 45.65082263946533, 45.89227118343115, 53.05109655857085, 53.22918173298238, 53.290478653449085, 65.22094341615836, 65.57331871862213, 65.47664294640224, 41.12282605220874, 40.586826403935746, 41.59201144551237, 50.482864021013185, 50.372764463226005, 50.67938360354553, 48.70153516530989, 49.11725508049129, 49.14323611184953, 43.99205114878714, 43.78566700220108, 43.690131820738316, 57.51266868412493, 58.29815717041491, 57.52231718599795, 48.185014131284944, 47.82012838373582, 47.88862518469493, 51.73301053792237, 51.50810790807007, 51.670236416161046, 50.32219868401687, 50.68115510294835, 50.639867300788566, 48.2989068677028, 48.63237255935867, 48.6059162740906, 47.27381087094544, 47.40288910642265, 47.16433878242968, 44.76788543413082, 44.43349596361318, 44.89053949962059, 50.56609942515691, 51.03772220139702, 50.52478312452634, 51.767212460438415, 53.26054907465975, 53.465220230321094, 48.812970119218036, 48.79567922155063, 48.700843537847206, 53.731193823119, 53.76656388988097, 54.03889155721602, 57.336185182134315, 57.61037437121074, 57.552468794087574, 52.88504744072755, 52.56371224423249, 53.241582574633256, 40.12605046480894, 40.32884744554758, 40.64193481352413, 44.34755628059307, 44.30783723543087, 44.67024602989355, 47.83555669927348, 47.32047330339749, 47.879546140165374, 70.18273550520341, 69.56064685682456, 69.81295447299878, 46.66497155325487, 46.1955701187253, 46.146018505096436, 50.148289059599236, 50.57815883805354, 50.72866255914171, 46.34624496102333, 46.092411652207375, 46.18268575519323, 47.98207370936869, 48.496918290853486, 47.738901957869516, 47.74301531910895, 47.47337385267018, 47.81420108117162, 47.910264121989414, 48.23884657970363, 47.88697349528472, 47.50612664719422, 47.84981373449166, 48.027711303283766, 46.72347721240172, 46.26699988792339, 46.46805052707592, 55.36476217706998, 55.267293234666184, 55.31535730262597, 57.79313170413177, 57.9017198185126, 58.42572835336129, 47.20581823090713, 47.85912708441417, 47.52616987625758, 53.00533090780179, 52.89283097783725, 53.22826995576422, 57.37735751022895, 56.72091632088025, 56.58917888005574, 47.6551864867409, 48.15306708340843, 47.561891732116536, 58.44973584140341, 58.268333929280445, 58.33055601889889, 57.23250653346379, 57.504023795326546, 57.35507551332314, 44.70120006799698, 45.403942668111995, 44.69422662258148, 56.37889947990577, 56.361544097463295, 56.17106426755588, 56.98003043731053, 56.80947711070378, 56.55740079780419, 49.45807599431525, 49.420179533461734, 48.97568448881309, 56.413776611288384, 56.98663539936145, 57.46885412589957, 44.481654182076454, 44.98356429487467, 44.98790667951107, 48.7973219777147, 48.95364000151555, 48.87068933496873, 44.64307669363916, 44.46042186394334, 43.92762702703476, 50.76191126306851, 51.38627999400099, 51.011716825266674, 51.85953403885166, 51.74811738605301, 50.804816121856376, 54.28305649012326, 54.562225889414535, 54.33544774353503, 47.35977201660474, 47.80323150505622, 47.90829903384049, 40.412065193367496, 40.04860799511273, 40.04466451456149, 59.41838720440863, 59.95298415049909, 59.762920603156076, 61.83103877305983, 61.76614794135092, 62.2000782676041, 53.46522899724853, 52.989770253499344, 53.39868793760736]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14714142398731267, "mean_inference_ms": 0.711309662261399, "mean_action_processing_ms": 0.10216482242483281, "mean_env_wait_ms": 0.8471104442191941, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 845000, "timesteps_this_iter": 0, "agent_timesteps_total": 2535000, "timers": {"sample_time_ms": 11238.568, "sample_throughput": 444.897, "load_time_ms": 0.201, "load_throughput": 24821304.296, "learn_time_ms": 1715.772, "learn_throughput": 2914.14, "update_time_ms": 7.872}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.479114197289397e-32, "cur_lr": 0.0005000000000000001, "total_loss": 7.745396709442138, "policy_loss": -0.0013316083852294546, "vf_loss": 7.83493595123291, "vf_explained_var": 0.02100946307182312, "kl": 0.003491530555800275, "entropy": 8.820759296417236, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 845000, "num_agent_steps_sampled": 2535000, "num_steps_trained": 845000, "num_agent_steps_trained": 2535000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2547, "training_iteration": 169, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-39-56", "timestamp": 1706229596, "time_this_iter_s": 10.646445274353027, "time_total_s": 1835.5349929332733, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020280834820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1835.5349929332733, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 10.566666666666665, "ram_util_percent": 52.153333333333336}}
{"episode_reward_max": 209.5563368350266, "episode_reward_min": 102.77533906511962, "episode_reward_mean": 153.27641930057297, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 34.13958132266998}, "policy_reward_max": {"shared_policy": 70.18273550520341}, "policy_reward_mean": {"shared_policy": 51.09213976685766}, "custom_metrics": {}, "hist_stats": {"episode_reward": [138.36224216688407, 181.24458120949566, 157.24549684673545, 165.65157037228315, 170.63964699581263, 102.77533906511962, 138.92533581238254, 153.44200159260063, 142.85720162699008, 130.58987959846854, 158.00193153787396, 155.57004679739453, 141.67166147008558, 147.8995367214083, 162.04627458844334, 156.21447814628476, 147.79780694842339, 154.20253772381702, 139.36426184326393, 156.86595769226548, 124.75509865768251, 195.48825687170014, 143.57637254148716, 145.32137596607214, 151.29144034534727, 194.11018678545935, 143.97498804330831, 179.81821987940924, 169.74915772397046, 152.7916374420745, 153.43788431864246, 154.07391841709622, 146.16123098880058, 135.81129025109124, 137.40178287401778, 159.57075694500222, 196.27090508118286, 123.30166390165685, 151.53501208778468, 146.96202635765073, 131.4678499717266, 173.3331430405378, 143.8937676997155, 154.91135486215347, 151.64322108775374, 145.53719570115234, 141.84103875979784, 134.0919208973646, 152.12860475108033, 158.49298176541953, 146.3094928786157, 161.53664927021572, 172.4990283474327, 158.69034225959322, 121.09683272388065, 133.32563954591728, 143.0355761428363, 209.5563368350266, 139.00656017707652, 151.45511045679447, 138.6213423684238, 144.21789395809162, 143.03059025295082, 144.036084196978, 143.3836516849696, 139.45852762740108, 165.94741271436223, 174.12057987600556, 142.5911151915789, 159.12643184140342, 170.68745271116478, 143.37014530226568, 175.0486257895827, 172.0916058421136, 134.7993693586904, 168.91150784492513, 170.3469083458186, 147.85394001658986, 170.86926613654913, 134.45312515646214, 146.6216513141991, 133.0311255846172, 153.15990808233607, 154.41246754676123, 163.18073012307298, 143.07130255550155, 120.50533770304172, 179.13429195806347, 185.7972649820148, 159.85368718835548, 158.58792840689395, 164.56142744235706, 147.88208197802297, 146.20915407873667, 157.2744152639063, 172.7986135575919, 187.85309084877363, 117.3425043062307, 176.98676590994015, 145.7889636009933], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [46.20693216317643, 46.02207751696308, 46.13323248674472, 60.067448879281685, 60.39793897668521, 60.77919335352878, 52.30942629277705, 52.16169044375418, 52.774380110204206, 55.00695278247197, 55.191816960771874, 55.4528006290396, 56.9136910053591, 56.82977239663403, 56.89618359381954, 34.33360149152577, 34.13958132266998, 34.30215625092387, 46.26781104753414, 46.564733108195156, 46.09279165665308, 50.95702487727006, 51.46343234328863, 51.021544372042015, 47.67251918216546, 47.81631157159184, 47.36837087323268, 43.55146923288703, 43.710472129285336, 43.32793823629618, 52.47740123420952, 52.79778478201477, 52.726745521649704, 51.57939224441846, 52.10801056524117, 51.88264398773511, 47.050425489743546, 46.854254757364586, 47.766981222977236, 49.136422614256546, 49.678597527245685, 49.08451657990615, 54.08554226284225, 53.81532723208268, 54.14540509351839, 52.13416756441195, 52.0391386312743, 52.04117195059855, 49.282126301278666, 49.42112124090393, 49.094559406240776, 51.270756999651596, 51.37917283798258, 51.55260788618277, 46.42307851215203, 46.37823234995206, 46.56295098116, 52.37028394391139, 52.09108531971772, 52.40458842863639, 41.50220343718925, 41.698613566036016, 41.55428165445724, 65.01316678524016, 65.20963330566882, 65.26545678079127, 47.975389639536544, 47.57551832000415, 48.02546458194654, 48.385690716405705, 48.523505856593445, 48.41217939307292, 50.31581350664298, 50.59419457862775, 50.38143226007621, 64.64436171452205, 64.74040901164214, 64.72541605929534, 48.35308897991975, 47.79290538032849, 47.828993683060006, 59.65350013474624, 59.91655268023412, 60.248167064428955, 56.94948144474377, 56.06153208514054, 56.73814419408639, 50.844522299865886, 50.781083288292095, 51.16603185391675, 50.71436109145482, 51.11528391142686, 51.60823931576063, 51.353723491231605, 51.434413577119514, 51.28578134874503, 48.47220602134864, 48.98051782200734, 48.70850714544456, 45.214429281651974, 45.46008607186377, 45.13677489757538, 45.85868905112147, 45.65082263946533, 45.89227118343115, 53.05109655857085, 53.22918173298238, 53.290478653449085, 65.22094341615836, 65.57331871862213, 65.47664294640224, 41.12282605220874, 40.586826403935746, 41.59201144551237, 50.482864021013185, 50.372764463226005, 50.67938360354553, 48.70153516530989, 49.11725508049129, 49.14323611184953, 43.99205114878714, 43.78566700220108, 43.690131820738316, 57.51266868412493, 58.29815717041491, 57.52231718599795, 48.185014131284944, 47.82012838373582, 47.88862518469493, 51.73301053792237, 51.50810790807007, 51.670236416161046, 50.32219868401687, 50.68115510294835, 50.639867300788566, 48.2989068677028, 48.63237255935867, 48.6059162740906, 47.27381087094544, 47.40288910642265, 47.16433878242968, 44.76788543413082, 44.43349596361318, 44.89053949962059, 50.56609942515691, 51.03772220139702, 50.52478312452634, 51.767212460438415, 53.26054907465975, 53.465220230321094, 48.812970119218036, 48.79567922155063, 48.700843537847206, 53.731193823119, 53.76656388988097, 54.03889155721602, 57.336185182134315, 57.61037437121074, 57.552468794087574, 52.88504744072755, 52.56371224423249, 53.241582574633256, 40.12605046480894, 40.32884744554758, 40.64193481352413, 44.34755628059307, 44.30783723543087, 44.67024602989355, 47.83555669927348, 47.32047330339749, 47.879546140165374, 70.18273550520341, 69.56064685682456, 69.81295447299878, 46.66497155325487, 46.1955701187253, 46.146018505096436, 50.148289059599236, 50.57815883805354, 50.72866255914171, 46.34624496102333, 46.092411652207375, 46.18268575519323, 47.98207370936869, 48.496918290853486, 47.738901957869516, 47.74301531910895, 47.47337385267018, 47.81420108117162, 47.910264121989414, 48.23884657970363, 47.88697349528472, 47.50612664719422, 47.84981373449166, 48.027711303283766, 46.72347721240172, 46.26699988792339, 46.46805052707592, 55.36476217706998, 55.267293234666184, 55.31535730262597, 57.79313170413177, 57.9017198185126, 58.42572835336129, 47.20581823090713, 47.85912708441417, 47.52616987625758, 53.00533090780179, 52.89283097783725, 53.22826995576422, 57.37735751022895, 56.72091632088025, 56.58917888005574, 47.6551864867409, 48.15306708340843, 47.561891732116536, 58.44973584140341, 58.268333929280445, 58.33055601889889, 57.23250653346379, 57.504023795326546, 57.35507551332314, 44.70120006799698, 45.403942668111995, 44.69422662258148, 56.37889947990577, 56.361544097463295, 56.17106426755588, 56.98003043731053, 56.80947711070378, 56.55740079780419, 49.45807599431525, 49.420179533461734, 48.97568448881309, 56.413776611288384, 56.98663539936145, 57.46885412589957, 44.481654182076454, 44.98356429487467, 44.98790667951107, 48.7973219777147, 48.95364000151555, 48.87068933496873, 44.64307669363916, 44.46042186394334, 43.92762702703476, 50.76191126306851, 51.38627999400099, 51.011716825266674, 51.85953403885166, 51.74811738605301, 50.804816121856376, 54.28305649012326, 54.562225889414535, 54.33544774353503, 47.35977201660474, 47.80323150505622, 47.90829903384049, 40.412065193367496, 40.04860799511273, 40.04466451456149, 59.41838720440863, 59.95298415049909, 59.762920603156076, 61.83103877305983, 61.76614794135092, 62.2000782676041, 53.46522899724853, 52.989770253499344, 53.39868793760736, 52.904315569748476, 52.79572535057862, 52.887887486567095, 54.84134641538064, 54.49096643428008, 55.229114592696234, 49.66317508369683, 49.203864410519586, 49.015042483806596, 48.87139572948216, 48.08185982704161, 49.25589852221309, 52.34268916894992, 52.38547159483035, 52.54625450012584, 56.97828715542953, 57.67523927489917, 58.14508712726335, 62.7664981385072, 62.89141626780231, 62.19517644246419, 39.320365293417126, 38.942857541143894, 39.079281471669674, 58.60914340615271, 59.20482332259415, 59.1727991811931, 48.73994883646567, 48.49684779097636, 48.55216697355111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1471688317218622, "mean_inference_ms": 0.711565884104411, "mean_action_processing_ms": 0.10217554795950681, "mean_env_wait_ms": 0.8471413264100989, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 850000, "timesteps_this_iter": 0, "agent_timesteps_total": 2550000, "timers": {"sample_time_ms": 11100.058, "sample_throughput": 450.448, "load_time_ms": 0.301, "load_throughput": 16605843.693, "learn_time_ms": 1703.003, "learn_throughput": 2935.991, "update_time_ms": 7.721}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.395570986446985e-33, "cur_lr": 0.0005000000000000001, "total_loss": 9.591936206817627, "policy_loss": -0.001163509218769576, "vf_loss": 9.681615829467773, "vf_explained_var": 0.02329270839691162, "kl": 0.003380537970259701, "entropy": 8.851603794097901, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 850000, "num_agent_steps_sampled": 2550000, "num_steps_trained": 850000, "num_agent_steps_trained": 2550000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2557, "training_iteration": 170, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-40-06", "timestamp": 1706229606, "time_this_iter_s": 10.688023805618286, "time_total_s": 1846.2230167388916, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020284553040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1846.2230167388916, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 10.525, "ram_util_percent": 51.9}}
{"episode_reward_max": 209.5563368350266, "episode_reward_min": 117.3425043062307, "episode_reward_mean": 153.65218665206203, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 38.942857541143894}, "policy_reward_max": {"shared_policy": 70.18273550520341}, "policy_reward_mean": {"shared_policy": 51.21739555068735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [158.00193153787396, 155.57004679739453, 141.67166147008558, 147.8995367214083, 162.04627458844334, 156.21447814628476, 147.79780694842339, 154.20253772381702, 139.36426184326393, 156.86595769226548, 124.75509865768251, 195.48825687170014, 143.57637254148716, 145.32137596607214, 151.29144034534727, 194.11018678545935, 143.97498804330831, 179.81821987940924, 169.74915772397046, 152.7916374420745, 153.43788431864246, 154.07391841709622, 146.16123098880058, 135.81129025109124, 137.40178287401778, 159.57075694500222, 196.27090508118286, 123.30166390165685, 151.53501208778468, 146.96202635765073, 131.4678499717266, 173.3331430405378, 143.8937676997155, 154.91135486215347, 151.64322108775374, 145.53719570115234, 141.84103875979784, 134.0919208973646, 152.12860475108033, 158.49298176541953, 146.3094928786157, 161.53664927021572, 172.4990283474327, 158.69034225959322, 121.09683272388065, 133.32563954591728, 143.0355761428363, 209.5563368350266, 139.00656017707652, 151.45511045679447, 138.6213423684238, 144.21789395809162, 143.03059025295082, 144.036084196978, 143.3836516849696, 139.45852762740108, 165.94741271436223, 174.12057987600556, 142.5911151915789, 159.12643184140342, 170.68745271116478, 143.37014530226568, 175.0486257895827, 172.0916058421136, 134.7993693586904, 168.91150784492513, 170.3469083458186, 147.85394001658986, 170.86926613654913, 134.45312515646214, 146.6216513141991, 133.0311255846172, 153.15990808233607, 154.41246754676123, 163.18073012307298, 143.07130255550155, 120.50533770304172, 179.13429195806347, 185.7972649820148, 159.85368718835548, 158.58792840689395, 164.56142744235706, 147.88208197802297, 146.20915407873667, 157.2744152639063, 172.7986135575919, 187.85309084877363, 117.3425043062307, 176.98676590994015, 145.7889636009933, 168.6829002201558, 172.6975429635493, 156.22036604955767, 146.86148780351533, 169.44199831411248, 148.2544911354778, 124.56496933475135, 148.12574663572022, 145.84089571237536, 138.6196322664619], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [52.47740123420952, 52.79778478201477, 52.726745521649704, 51.57939224441846, 52.10801056524117, 51.88264398773511, 47.050425489743546, 46.854254757364586, 47.766981222977236, 49.136422614256546, 49.678597527245685, 49.08451657990615, 54.08554226284225, 53.81532723208268, 54.14540509351839, 52.13416756441195, 52.0391386312743, 52.04117195059855, 49.282126301278666, 49.42112124090393, 49.094559406240776, 51.270756999651596, 51.37917283798258, 51.55260788618277, 46.42307851215203, 46.37823234995206, 46.56295098116, 52.37028394391139, 52.09108531971772, 52.40458842863639, 41.50220343718925, 41.698613566036016, 41.55428165445724, 65.01316678524016, 65.20963330566882, 65.26545678079127, 47.975389639536544, 47.57551832000415, 48.02546458194654, 48.385690716405705, 48.523505856593445, 48.41217939307292, 50.31581350664298, 50.59419457862775, 50.38143226007621, 64.64436171452205, 64.74040901164214, 64.72541605929534, 48.35308897991975, 47.79290538032849, 47.828993683060006, 59.65350013474624, 59.91655268023412, 60.248167064428955, 56.94948144474377, 56.06153208514054, 56.73814419408639, 50.844522299865886, 50.781083288292095, 51.16603185391675, 50.71436109145482, 51.11528391142686, 51.60823931576063, 51.353723491231605, 51.434413577119514, 51.28578134874503, 48.47220602134864, 48.98051782200734, 48.70850714544456, 45.214429281651974, 45.46008607186377, 45.13677489757538, 45.85868905112147, 45.65082263946533, 45.89227118343115, 53.05109655857085, 53.22918173298238, 53.290478653449085, 65.22094341615836, 65.57331871862213, 65.47664294640224, 41.12282605220874, 40.586826403935746, 41.59201144551237, 50.482864021013185, 50.372764463226005, 50.67938360354553, 48.70153516530989, 49.11725508049129, 49.14323611184953, 43.99205114878714, 43.78566700220108, 43.690131820738316, 57.51266868412493, 58.29815717041491, 57.52231718599795, 48.185014131284944, 47.82012838373582, 47.88862518469493, 51.73301053792237, 51.50810790807007, 51.670236416161046, 50.32219868401687, 50.68115510294835, 50.639867300788566, 48.2989068677028, 48.63237255935867, 48.6059162740906, 47.27381087094544, 47.40288910642265, 47.16433878242968, 44.76788543413082, 44.43349596361318, 44.89053949962059, 50.56609942515691, 51.03772220139702, 50.52478312452634, 51.767212460438415, 53.26054907465975, 53.465220230321094, 48.812970119218036, 48.79567922155063, 48.700843537847206, 53.731193823119, 53.76656388988097, 54.03889155721602, 57.336185182134315, 57.61037437121074, 57.552468794087574, 52.88504744072755, 52.56371224423249, 53.241582574633256, 40.12605046480894, 40.32884744554758, 40.64193481352413, 44.34755628059307, 44.30783723543087, 44.67024602989355, 47.83555669927348, 47.32047330339749, 47.879546140165374, 70.18273550520341, 69.56064685682456, 69.81295447299878, 46.66497155325487, 46.1955701187253, 46.146018505096436, 50.148289059599236, 50.57815883805354, 50.72866255914171, 46.34624496102333, 46.092411652207375, 46.18268575519323, 47.98207370936869, 48.496918290853486, 47.738901957869516, 47.74301531910895, 47.47337385267018, 47.81420108117162, 47.910264121989414, 48.23884657970363, 47.88697349528472, 47.50612664719422, 47.84981373449166, 48.027711303283766, 46.72347721240172, 46.26699988792339, 46.46805052707592, 55.36476217706998, 55.267293234666184, 55.31535730262597, 57.79313170413177, 57.9017198185126, 58.42572835336129, 47.20581823090713, 47.85912708441417, 47.52616987625758, 53.00533090780179, 52.89283097783725, 53.22826995576422, 57.37735751022895, 56.72091632088025, 56.58917888005574, 47.6551864867409, 48.15306708340843, 47.561891732116536, 58.44973584140341, 58.268333929280445, 58.33055601889889, 57.23250653346379, 57.504023795326546, 57.35507551332314, 44.70120006799698, 45.403942668111995, 44.69422662258148, 56.37889947990577, 56.361544097463295, 56.17106426755588, 56.98003043731053, 56.80947711070378, 56.55740079780419, 49.45807599431525, 49.420179533461734, 48.97568448881309, 56.413776611288384, 56.98663539936145, 57.46885412589957, 44.481654182076454, 44.98356429487467, 44.98790667951107, 48.7973219777147, 48.95364000151555, 48.87068933496873, 44.64307669363916, 44.46042186394334, 43.92762702703476, 50.76191126306851, 51.38627999400099, 51.011716825266674, 51.85953403885166, 51.74811738605301, 50.804816121856376, 54.28305649012326, 54.562225889414535, 54.33544774353503, 47.35977201660474, 47.80323150505622, 47.90829903384049, 40.412065193367496, 40.04860799511273, 40.04466451456149, 59.41838720440863, 59.95298415049909, 59.762920603156076, 61.83103877305983, 61.76614794135092, 62.2000782676041, 53.46522899724853, 52.989770253499344, 53.39868793760736, 52.904315569748476, 52.79572535057862, 52.887887486567095, 54.84134641538064, 54.49096643428008, 55.229114592696234, 49.66317508369683, 49.203864410519586, 49.015042483806596, 48.87139572948216, 48.08185982704161, 49.25589852221309, 52.34268916894992, 52.38547159483035, 52.54625450012584, 56.97828715542953, 57.67523927489917, 58.14508712726335, 62.7664981385072, 62.89141626780231, 62.19517644246419, 39.320365293417126, 38.942857541143894, 39.079281471669674, 58.60914340615271, 59.20482332259415, 59.1727991811931, 48.73994883646567, 48.49684779097636, 48.55216697355111, 56.019876549641296, 56.30054137359063, 56.3624822969238, 57.48324963947137, 57.43047699083884, 57.78381633323927, 52.301902208477244, 52.14222671091555, 51.776237130165086, 48.27016265193622, 49.1737860540549, 49.41753909752394, 56.494995576639965, 56.32534309973319, 56.621659637739256, 49.18696022530396, 49.38435851534207, 49.68317239483197, 41.537195568283394, 41.39795583983262, 41.62981792663534, 49.09048653642337, 49.421642380456134, 49.61361771884064, 48.495862153669194, 48.63825064649184, 48.70678291221459, 46.27203567326069, 46.33645357936621, 46.01114301383495]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14718648563897507, "mean_inference_ms": 0.7117644990725354, "mean_action_processing_ms": 0.10218073428770243, "mean_env_wait_ms": 0.8471315254604325, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 855000, "timesteps_this_iter": 0, "agent_timesteps_total": 2565000, "timers": {"sample_time_ms": 10991.515, "sample_throughput": 454.896, "load_time_ms": 0.301, "load_throughput": 16605843.693, "learn_time_ms": 1704.877, "learn_throughput": 2932.762, "update_time_ms": 8.122}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.697785493223493e-33, "cur_lr": 0.0005000000000000001, "total_loss": 9.105037307739257, "policy_loss": -0.0006831600237730884, "vf_loss": 9.194148921966553, "vf_explained_var": 0.01579340100288391, "kl": 0.004333079617973768, "entropy": 8.84286584854126, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 855000, "num_agent_steps_sampled": 2565000, "num_steps_trained": 855000, "num_agent_steps_trained": 2565000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2567, "training_iteration": 171, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-40-17", "timestamp": 1706229617, "time_this_iter_s": 10.19363260269165, "time_total_s": 1856.4166493415833, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202808349D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1856.4166493415833, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 10.042857142857144, "ram_util_percent": 51.69285714285714}}
{"episode_reward_max": 209.5563368350266, "episode_reward_min": 117.3425043062307, "episode_reward_mean": 154.43364033115193, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 38.942857541143894}, "policy_reward_max": {"shared_policy": 70.18273550520341}, "policy_reward_mean": {"shared_policy": 51.477880110383985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [124.75509865768251, 195.48825687170014, 143.57637254148716, 145.32137596607214, 151.29144034534727, 194.11018678545935, 143.97498804330831, 179.81821987940924, 169.74915772397046, 152.7916374420745, 153.43788431864246, 154.07391841709622, 146.16123098880058, 135.81129025109124, 137.40178287401778, 159.57075694500222, 196.27090508118286, 123.30166390165685, 151.53501208778468, 146.96202635765073, 131.4678499717266, 173.3331430405378, 143.8937676997155, 154.91135486215347, 151.64322108775374, 145.53719570115234, 141.84103875979784, 134.0919208973646, 152.12860475108033, 158.49298176541953, 146.3094928786157, 161.53664927021572, 172.4990283474327, 158.69034225959322, 121.09683272388065, 133.32563954591728, 143.0355761428363, 209.5563368350266, 139.00656017707652, 151.45511045679447, 138.6213423684238, 144.21789395809162, 143.03059025295082, 144.036084196978, 143.3836516849696, 139.45852762740108, 165.94741271436223, 174.12057987600556, 142.5911151915789, 159.12643184140342, 170.68745271116478, 143.37014530226568, 175.0486257895827, 172.0916058421136, 134.7993693586904, 168.91150784492513, 170.3469083458186, 147.85394001658986, 170.86926613654913, 134.45312515646214, 146.6216513141991, 133.0311255846172, 153.15990808233607, 154.41246754676123, 163.18073012307298, 143.07130255550155, 120.50533770304172, 179.13429195806347, 185.7972649820148, 159.85368718835548, 158.58792840689395, 164.56142744235706, 147.88208197802297, 146.20915407873667, 157.2744152639063, 172.7986135575919, 187.85309084877363, 117.3425043062307, 176.98676590994015, 145.7889636009933, 168.6829002201558, 172.6975429635493, 156.22036604955767, 146.86148780351533, 169.44199831411248, 148.2544911354778, 124.56496933475135, 148.12574663572022, 145.84089571237536, 138.6196322664619, 153.71216822601855, 184.14814977347862, 161.06059417128566, 175.80973009206375, 198.6723362870979, 163.89182837260887, 142.94742738641813, 133.06170957535505, 127.73409932106732, 156.74181817285734], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [41.50220343718925, 41.698613566036016, 41.55428165445724, 65.01316678524016, 65.20963330566882, 65.26545678079127, 47.975389639536544, 47.57551832000415, 48.02546458194654, 48.385690716405705, 48.523505856593445, 48.41217939307292, 50.31581350664298, 50.59419457862775, 50.38143226007621, 64.64436171452205, 64.74040901164214, 64.72541605929534, 48.35308897991975, 47.79290538032849, 47.828993683060006, 59.65350013474624, 59.91655268023412, 60.248167064428955, 56.94948144474377, 56.06153208514054, 56.73814419408639, 50.844522299865886, 50.781083288292095, 51.16603185391675, 50.71436109145482, 51.11528391142686, 51.60823931576063, 51.353723491231605, 51.434413577119514, 51.28578134874503, 48.47220602134864, 48.98051782200734, 48.70850714544456, 45.214429281651974, 45.46008607186377, 45.13677489757538, 45.85868905112147, 45.65082263946533, 45.89227118343115, 53.05109655857085, 53.22918173298238, 53.290478653449085, 65.22094341615836, 65.57331871862213, 65.47664294640224, 41.12282605220874, 40.586826403935746, 41.59201144551237, 50.482864021013185, 50.372764463226005, 50.67938360354553, 48.70153516530989, 49.11725508049129, 49.14323611184953, 43.99205114878714, 43.78566700220108, 43.690131820738316, 57.51266868412493, 58.29815717041491, 57.52231718599795, 48.185014131284944, 47.82012838373582, 47.88862518469493, 51.73301053792237, 51.50810790807007, 51.670236416161046, 50.32219868401687, 50.68115510294835, 50.639867300788566, 48.2989068677028, 48.63237255935867, 48.6059162740906, 47.27381087094544, 47.40288910642265, 47.16433878242968, 44.76788543413082, 44.43349596361318, 44.89053949962059, 50.56609942515691, 51.03772220139702, 50.52478312452634, 51.767212460438415, 53.26054907465975, 53.465220230321094, 48.812970119218036, 48.79567922155063, 48.700843537847206, 53.731193823119, 53.76656388988097, 54.03889155721602, 57.336185182134315, 57.61037437121074, 57.552468794087574, 52.88504744072755, 52.56371224423249, 53.241582574633256, 40.12605046480894, 40.32884744554758, 40.64193481352413, 44.34755628059307, 44.30783723543087, 44.67024602989355, 47.83555669927348, 47.32047330339749, 47.879546140165374, 70.18273550520341, 69.56064685682456, 69.81295447299878, 46.66497155325487, 46.1955701187253, 46.146018505096436, 50.148289059599236, 50.57815883805354, 50.72866255914171, 46.34624496102333, 46.092411652207375, 46.18268575519323, 47.98207370936869, 48.496918290853486, 47.738901957869516, 47.74301531910895, 47.47337385267018, 47.81420108117162, 47.910264121989414, 48.23884657970363, 47.88697349528472, 47.50612664719422, 47.84981373449166, 48.027711303283766, 46.72347721240172, 46.26699988792339, 46.46805052707592, 55.36476217706998, 55.267293234666184, 55.31535730262597, 57.79313170413177, 57.9017198185126, 58.42572835336129, 47.20581823090713, 47.85912708441417, 47.52616987625758, 53.00533090780179, 52.89283097783725, 53.22826995576422, 57.37735751022895, 56.72091632088025, 56.58917888005574, 47.6551864867409, 48.15306708340843, 47.561891732116536, 58.44973584140341, 58.268333929280445, 58.33055601889889, 57.23250653346379, 57.504023795326546, 57.35507551332314, 44.70120006799698, 45.403942668111995, 44.69422662258148, 56.37889947990577, 56.361544097463295, 56.17106426755588, 56.98003043731053, 56.80947711070378, 56.55740079780419, 49.45807599431525, 49.420179533461734, 48.97568448881309, 56.413776611288384, 56.98663539936145, 57.46885412589957, 44.481654182076454, 44.98356429487467, 44.98790667951107, 48.7973219777147, 48.95364000151555, 48.87068933496873, 44.64307669363916, 44.46042186394334, 43.92762702703476, 50.76191126306851, 51.38627999400099, 51.011716825266674, 51.85953403885166, 51.74811738605301, 50.804816121856376, 54.28305649012326, 54.562225889414535, 54.33544774353503, 47.35977201660474, 47.80323150505622, 47.90829903384049, 40.412065193367496, 40.04860799511273, 40.04466451456149, 59.41838720440863, 59.95298415049909, 59.762920603156076, 61.83103877305983, 61.76614794135092, 62.2000782676041, 53.46522899724853, 52.989770253499344, 53.39868793760736, 52.904315569748476, 52.79572535057862, 52.887887486567095, 54.84134641538064, 54.49096643428008, 55.229114592696234, 49.66317508369683, 49.203864410519586, 49.015042483806596, 48.87139572948216, 48.08185982704161, 49.25589852221309, 52.34268916894992, 52.38547159483035, 52.54625450012584, 56.97828715542953, 57.67523927489917, 58.14508712726335, 62.7664981385072, 62.89141626780231, 62.19517644246419, 39.320365293417126, 38.942857541143894, 39.079281471669674, 58.60914340615271, 59.20482332259415, 59.1727991811931, 48.73994883646567, 48.49684779097636, 48.55216697355111, 56.019876549641296, 56.30054137359063, 56.3624822969238, 57.48324963947137, 57.43047699083884, 57.78381633323927, 52.301902208477244, 52.14222671091555, 51.776237130165086, 48.27016265193622, 49.1737860540549, 49.41753909752394, 56.494995576639965, 56.32534309973319, 56.621659637739256, 49.18696022530396, 49.38435851534207, 49.68317239483197, 41.537195568283394, 41.39795583983262, 41.62981792663534, 49.09048653642337, 49.421642380456134, 49.61361771884064, 48.495862153669194, 48.63825064649184, 48.70678291221459, 46.27203567326069, 46.33645357936621, 46.01114301383495, 51.167223587632165, 51.16074679791926, 51.38419784046708, 61.21339817345141, 61.799722507596, 61.135029092431054, 53.65931579222281, 53.936228317519024, 53.46505006154378, 58.69755409844218, 58.394235178828225, 58.717940814793096, 66.40163202638117, 66.13245505591233, 66.1382492048045, 54.77941198988508, 54.80351778228457, 54.308898600439235, 47.2006682207187, 47.885125972641006, 47.86163319305827, 44.50102043772736, 44.42594157035151, 44.13474756727615, 42.544032891591385, 42.57793131967385, 42.61213510980208, 52.29134356975554, 52.65636505000292, 51.794109553098664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1471984950989571, "mean_inference_ms": 0.7119253312747291, "mean_action_processing_ms": 0.10218676731174148, "mean_env_wait_ms": 0.8470959177074608, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 860000, "timesteps_this_iter": 0, "agent_timesteps_total": 2580000, "timers": {"sample_time_ms": 10936.188, "sample_throughput": 457.198, "load_time_ms": 0.452, "load_throughput": 11070270.27, "learn_time_ms": 1710.28, "learn_throughput": 2923.498, "update_time_ms": 8.223}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8488927466117464e-33, "cur_lr": 0.0005000000000000001, "total_loss": 9.429550266265869, "policy_loss": -0.0005244381069415382, "vf_loss": 9.521323108673096, "vf_explained_var": 0.03468581438064575, "kl": 0.003723501693496628, "entropy": 9.124849033355712, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 860000, "num_agent_steps_sampled": 2580000, "num_steps_trained": 860000, "num_agent_steps_trained": 2580000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2577, "training_iteration": 172, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-40-27", "timestamp": 1706229627, "time_this_iter_s": 10.720174789428711, "time_total_s": 1867.136824131012, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282490040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1867.136824131012, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 11.073333333333332, "ram_util_percent": 51.67333333333334}}
{"episode_reward_max": 209.5563368350266, "episode_reward_min": 117.3425043062307, "episode_reward_mean": 153.49984174653753, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 38.942857541143894}, "policy_reward_max": {"shared_policy": 70.18273550520341}, "policy_reward_mean": {"shared_policy": 51.16661391551251}, "custom_metrics": {}, "hist_stats": {"episode_reward": [153.43788431864246, 154.07391841709622, 146.16123098880058, 135.81129025109124, 137.40178287401778, 159.57075694500222, 196.27090508118286, 123.30166390165685, 151.53501208778468, 146.96202635765073, 131.4678499717266, 173.3331430405378, 143.8937676997155, 154.91135486215347, 151.64322108775374, 145.53719570115234, 141.84103875979784, 134.0919208973646, 152.12860475108033, 158.49298176541953, 146.3094928786157, 161.53664927021572, 172.4990283474327, 158.69034225959322, 121.09683272388065, 133.32563954591728, 143.0355761428363, 209.5563368350266, 139.00656017707652, 151.45511045679447, 138.6213423684238, 144.21789395809162, 143.03059025295082, 144.036084196978, 143.3836516849696, 139.45852762740108, 165.94741271436223, 174.12057987600556, 142.5911151915789, 159.12643184140342, 170.68745271116478, 143.37014530226568, 175.0486257895827, 172.0916058421136, 134.7993693586904, 168.91150784492513, 170.3469083458186, 147.85394001658986, 170.86926613654913, 134.45312515646214, 146.6216513141991, 133.0311255846172, 153.15990808233607, 154.41246754676123, 163.18073012307298, 143.07130255550155, 120.50533770304172, 179.13429195806347, 185.7972649820148, 159.85368718835548, 158.58792840689395, 164.56142744235706, 147.88208197802297, 146.20915407873667, 157.2744152639063, 172.7986135575919, 187.85309084877363, 117.3425043062307, 176.98676590994015, 145.7889636009933, 168.6829002201558, 172.6975429635493, 156.22036604955767, 146.86148780351533, 169.44199831411248, 148.2544911354778, 124.56496933475135, 148.12574663572022, 145.84089571237536, 138.6196322664619, 153.71216822601855, 184.14814977347862, 161.06059417128566, 175.80973009206375, 198.6723362870979, 163.89182837260887, 142.94742738641813, 133.06170957535505, 127.73409932106732, 156.74181817285734, 151.6120549868792, 151.94303973019123, 164.57658575475207, 145.9157095099798, 127.86065397039053, 164.91286965459582, 136.0639606751503, 149.62627182900917, 148.05987896863383, 166.92585071548814], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [50.71436109145482, 51.11528391142686, 51.60823931576063, 51.353723491231605, 51.434413577119514, 51.28578134874503, 48.47220602134864, 48.98051782200734, 48.70850714544456, 45.214429281651974, 45.46008607186377, 45.13677489757538, 45.85868905112147, 45.65082263946533, 45.89227118343115, 53.05109655857085, 53.22918173298238, 53.290478653449085, 65.22094341615836, 65.57331871862213, 65.47664294640224, 41.12282605220874, 40.586826403935746, 41.59201144551237, 50.482864021013185, 50.372764463226005, 50.67938360354553, 48.70153516530989, 49.11725508049129, 49.14323611184953, 43.99205114878714, 43.78566700220108, 43.690131820738316, 57.51266868412493, 58.29815717041491, 57.52231718599795, 48.185014131284944, 47.82012838373582, 47.88862518469493, 51.73301053792237, 51.50810790807007, 51.670236416161046, 50.32219868401687, 50.68115510294835, 50.639867300788566, 48.2989068677028, 48.63237255935867, 48.6059162740906, 47.27381087094544, 47.40288910642265, 47.16433878242968, 44.76788543413082, 44.43349596361318, 44.89053949962059, 50.56609942515691, 51.03772220139702, 50.52478312452634, 51.767212460438415, 53.26054907465975, 53.465220230321094, 48.812970119218036, 48.79567922155063, 48.700843537847206, 53.731193823119, 53.76656388988097, 54.03889155721602, 57.336185182134315, 57.61037437121074, 57.552468794087574, 52.88504744072755, 52.56371224423249, 53.241582574633256, 40.12605046480894, 40.32884744554758, 40.64193481352413, 44.34755628059307, 44.30783723543087, 44.67024602989355, 47.83555669927348, 47.32047330339749, 47.879546140165374, 70.18273550520341, 69.56064685682456, 69.81295447299878, 46.66497155325487, 46.1955701187253, 46.146018505096436, 50.148289059599236, 50.57815883805354, 50.72866255914171, 46.34624496102333, 46.092411652207375, 46.18268575519323, 47.98207370936869, 48.496918290853486, 47.738901957869516, 47.74301531910895, 47.47337385267018, 47.81420108117162, 47.910264121989414, 48.23884657970363, 47.88697349528472, 47.50612664719422, 47.84981373449166, 48.027711303283766, 46.72347721240172, 46.26699988792339, 46.46805052707592, 55.36476217706998, 55.267293234666184, 55.31535730262597, 57.79313170413177, 57.9017198185126, 58.42572835336129, 47.20581823090713, 47.85912708441417, 47.52616987625758, 53.00533090780179, 52.89283097783725, 53.22826995576422, 57.37735751022895, 56.72091632088025, 56.58917888005574, 47.6551864867409, 48.15306708340843, 47.561891732116536, 58.44973584140341, 58.268333929280445, 58.33055601889889, 57.23250653346379, 57.504023795326546, 57.35507551332314, 44.70120006799698, 45.403942668111995, 44.69422662258148, 56.37889947990577, 56.361544097463295, 56.17106426755588, 56.98003043731053, 56.80947711070378, 56.55740079780419, 49.45807599431525, 49.420179533461734, 48.97568448881309, 56.413776611288384, 56.98663539936145, 57.46885412589957, 44.481654182076454, 44.98356429487467, 44.98790667951107, 48.7973219777147, 48.95364000151555, 48.87068933496873, 44.64307669363916, 44.46042186394334, 43.92762702703476, 50.76191126306851, 51.38627999400099, 51.011716825266674, 51.85953403885166, 51.74811738605301, 50.804816121856376, 54.28305649012326, 54.562225889414535, 54.33544774353503, 47.35977201660474, 47.80323150505622, 47.90829903384049, 40.412065193367496, 40.04860799511273, 40.04466451456149, 59.41838720440863, 59.95298415049909, 59.762920603156076, 61.83103877305983, 61.76614794135092, 62.2000782676041, 53.46522899724853, 52.989770253499344, 53.39868793760736, 52.904315569748476, 52.79572535057862, 52.887887486567095, 54.84134641538064, 54.49096643428008, 55.229114592696234, 49.66317508369683, 49.203864410519586, 49.015042483806596, 48.87139572948216, 48.08185982704161, 49.25589852221309, 52.34268916894992, 52.38547159483035, 52.54625450012584, 56.97828715542953, 57.67523927489917, 58.14508712726335, 62.7664981385072, 62.89141626780231, 62.19517644246419, 39.320365293417126, 38.942857541143894, 39.079281471669674, 58.60914340615271, 59.20482332259415, 59.1727991811931, 48.73994883646567, 48.49684779097636, 48.55216697355111, 56.019876549641296, 56.30054137359063, 56.3624822969238, 57.48324963947137, 57.43047699083884, 57.78381633323927, 52.301902208477244, 52.14222671091555, 51.776237130165086, 48.27016265193622, 49.1737860540549, 49.41753909752394, 56.494995576639965, 56.32534309973319, 56.621659637739256, 49.18696022530396, 49.38435851534207, 49.68317239483197, 41.537195568283394, 41.39795583983262, 41.62981792663534, 49.09048653642337, 49.421642380456134, 49.61361771884064, 48.495862153669194, 48.63825064649184, 48.70678291221459, 46.27203567326069, 46.33645357936621, 46.01114301383495, 51.167223587632165, 51.16074679791926, 51.38419784046708, 61.21339817345141, 61.799722507596, 61.135029092431054, 53.65931579222281, 53.936228317519024, 53.46505006154378, 58.69755409844218, 58.394235178828225, 58.717940814793096, 66.40163202638117, 66.13245505591233, 66.1382492048045, 54.77941198988508, 54.80351778228457, 54.308898600439235, 47.2006682207187, 47.885125972641006, 47.86163319305827, 44.50102043772736, 44.42594157035151, 44.13474756727615, 42.544032891591385, 42.57793131967385, 42.61213510980208, 52.29134356975554, 52.65636505000292, 51.794109553098664, 50.90016132903595, 50.36266974856456, 50.349223909278706, 50.89400315781434, 50.47065163155396, 50.578384940822914, 54.59068919718264, 55.161347977817044, 54.82454857975243, 48.139753599961594, 48.99227181899671, 48.78368409102161, 42.48878576854864, 42.41987251738706, 42.95199568445483, 54.62910274167855, 55.14240672936042, 55.14136018355687, 45.20882053176561, 45.36572581032911, 45.48941433305541, 49.69345771769683, 49.76863243679206, 50.16418167452018, 49.47072666448851, 48.97588205834229, 49.613270245802894, 55.5738986035188, 55.5057401706775, 55.846211941291884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14721070636353575, "mean_inference_ms": 0.7120436283954942, "mean_action_processing_ms": 0.10219210071220264, "mean_env_wait_ms": 0.8470214323910058, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 865000, "timesteps_this_iter": 0, "agent_timesteps_total": 2595000, "timers": {"sample_time_ms": 10873.659, "sample_throughput": 459.827, "load_time_ms": 0.351, "load_throughput": 14241151.704, "learn_time_ms": 1703.707, "learn_throughput": 2934.777, "update_time_ms": 8.134}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.244463733058732e-34, "cur_lr": 0.0005000000000000001, "total_loss": 10.983760738372803, "policy_loss": -0.0015019608350346659, "vf_loss": 11.07606773376465, "vf_explained_var": 0.022179281711578368, "kl": 0.003144007211124142, "entropy": 9.080489349365234, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 865000, "num_agent_steps_sampled": 2595000, "num_steps_trained": 865000, "num_agent_steps_trained": 2595000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2587, "training_iteration": 173, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-40-38", "timestamp": 1706229638, "time_this_iter_s": 10.582350492477417, "time_total_s": 1877.7191746234894, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202845539D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1877.7191746234894, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 9.606666666666667, "ram_util_percent": 51.886666666666656}}
{"episode_reward_max": 209.5563368350266, "episode_reward_min": 117.3425043062307, "episode_reward_mean": 154.1736157547093, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 38.942857541143894}, "policy_reward_max": {"shared_policy": 70.18273550520341}, "policy_reward_mean": {"shared_policy": 51.39120525156975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [131.4678499717266, 173.3331430405378, 143.8937676997155, 154.91135486215347, 151.64322108775374, 145.53719570115234, 141.84103875979784, 134.0919208973646, 152.12860475108033, 158.49298176541953, 146.3094928786157, 161.53664927021572, 172.4990283474327, 158.69034225959322, 121.09683272388065, 133.32563954591728, 143.0355761428363, 209.5563368350266, 139.00656017707652, 151.45511045679447, 138.6213423684238, 144.21789395809162, 143.03059025295082, 144.036084196978, 143.3836516849696, 139.45852762740108, 165.94741271436223, 174.12057987600556, 142.5911151915789, 159.12643184140342, 170.68745271116478, 143.37014530226568, 175.0486257895827, 172.0916058421136, 134.7993693586904, 168.91150784492513, 170.3469083458186, 147.85394001658986, 170.86926613654913, 134.45312515646214, 146.6216513141991, 133.0311255846172, 153.15990808233607, 154.41246754676123, 163.18073012307298, 143.07130255550155, 120.50533770304172, 179.13429195806347, 185.7972649820148, 159.85368718835548, 158.58792840689395, 164.56142744235706, 147.88208197802297, 146.20915407873667, 157.2744152639063, 172.7986135575919, 187.85309084877363, 117.3425043062307, 176.98676590994015, 145.7889636009933, 168.6829002201558, 172.6975429635493, 156.22036604955767, 146.86148780351533, 169.44199831411248, 148.2544911354778, 124.56496933475135, 148.12574663572022, 145.84089571237536, 138.6196322664619, 153.71216822601855, 184.14814977347862, 161.06059417128566, 175.80973009206375, 198.6723362870979, 163.89182837260887, 142.94742738641813, 133.06170957535505, 127.73409932106732, 156.74181817285734, 151.6120549868792, 151.94303973019123, 164.57658575475207, 145.9157095099798, 127.86065397039053, 164.91286965459582, 136.0639606751503, 149.62627182900917, 148.05987896863383, 166.92585071548814, 157.49493829160937, 176.92701187171033, 150.5104188472032, 152.60225724894534, 168.65872036665655, 172.81308143585923, 131.80970044434048, 159.18468885309994, 132.14511024579403, 169.75794443488115], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [43.99205114878714, 43.78566700220108, 43.690131820738316, 57.51266868412493, 58.29815717041491, 57.52231718599795, 48.185014131284944, 47.82012838373582, 47.88862518469493, 51.73301053792237, 51.50810790807007, 51.670236416161046, 50.32219868401687, 50.68115510294835, 50.639867300788566, 48.2989068677028, 48.63237255935867, 48.6059162740906, 47.27381087094544, 47.40288910642265, 47.16433878242968, 44.76788543413082, 44.43349596361318, 44.89053949962059, 50.56609942515691, 51.03772220139702, 50.52478312452634, 51.767212460438415, 53.26054907465975, 53.465220230321094, 48.812970119218036, 48.79567922155063, 48.700843537847206, 53.731193823119, 53.76656388988097, 54.03889155721602, 57.336185182134315, 57.61037437121074, 57.552468794087574, 52.88504744072755, 52.56371224423249, 53.241582574633256, 40.12605046480894, 40.32884744554758, 40.64193481352413, 44.34755628059307, 44.30783723543087, 44.67024602989355, 47.83555669927348, 47.32047330339749, 47.879546140165374, 70.18273550520341, 69.56064685682456, 69.81295447299878, 46.66497155325487, 46.1955701187253, 46.146018505096436, 50.148289059599236, 50.57815883805354, 50.72866255914171, 46.34624496102333, 46.092411652207375, 46.18268575519323, 47.98207370936869, 48.496918290853486, 47.738901957869516, 47.74301531910895, 47.47337385267018, 47.81420108117162, 47.910264121989414, 48.23884657970363, 47.88697349528472, 47.50612664719422, 47.84981373449166, 48.027711303283766, 46.72347721240172, 46.26699988792339, 46.46805052707592, 55.36476217706998, 55.267293234666184, 55.31535730262597, 57.79313170413177, 57.9017198185126, 58.42572835336129, 47.20581823090713, 47.85912708441417, 47.52616987625758, 53.00533090780179, 52.89283097783725, 53.22826995576422, 57.37735751022895, 56.72091632088025, 56.58917888005574, 47.6551864867409, 48.15306708340843, 47.561891732116536, 58.44973584140341, 58.268333929280445, 58.33055601889889, 57.23250653346379, 57.504023795326546, 57.35507551332314, 44.70120006799698, 45.403942668111995, 44.69422662258148, 56.37889947990577, 56.361544097463295, 56.17106426755588, 56.98003043731053, 56.80947711070378, 56.55740079780419, 49.45807599431525, 49.420179533461734, 48.97568448881309, 56.413776611288384, 56.98663539936145, 57.46885412589957, 44.481654182076454, 44.98356429487467, 44.98790667951107, 48.7973219777147, 48.95364000151555, 48.87068933496873, 44.64307669363916, 44.46042186394334, 43.92762702703476, 50.76191126306851, 51.38627999400099, 51.011716825266674, 51.85953403885166, 51.74811738605301, 50.804816121856376, 54.28305649012326, 54.562225889414535, 54.33544774353503, 47.35977201660474, 47.80323150505622, 47.90829903384049, 40.412065193367496, 40.04860799511273, 40.04466451456149, 59.41838720440863, 59.95298415049909, 59.762920603156076, 61.83103877305983, 61.76614794135092, 62.2000782676041, 53.46522899724853, 52.989770253499344, 53.39868793760736, 52.904315569748476, 52.79572535057862, 52.887887486567095, 54.84134641538064, 54.49096643428008, 55.229114592696234, 49.66317508369683, 49.203864410519586, 49.015042483806596, 48.87139572948216, 48.08185982704161, 49.25589852221309, 52.34268916894992, 52.38547159483035, 52.54625450012584, 56.97828715542953, 57.67523927489917, 58.14508712726335, 62.7664981385072, 62.89141626780231, 62.19517644246419, 39.320365293417126, 38.942857541143894, 39.079281471669674, 58.60914340615271, 59.20482332259415, 59.1727991811931, 48.73994883646567, 48.49684779097636, 48.55216697355111, 56.019876549641296, 56.30054137359063, 56.3624822969238, 57.48324963947137, 57.43047699083884, 57.78381633323927, 52.301902208477244, 52.14222671091555, 51.776237130165086, 48.27016265193622, 49.1737860540549, 49.41753909752394, 56.494995576639965, 56.32534309973319, 56.621659637739256, 49.18696022530396, 49.38435851534207, 49.68317239483197, 41.537195568283394, 41.39795583983262, 41.62981792663534, 49.09048653642337, 49.421642380456134, 49.61361771884064, 48.495862153669194, 48.63825064649184, 48.70678291221459, 46.27203567326069, 46.33645357936621, 46.01114301383495, 51.167223587632165, 51.16074679791926, 51.38419784046708, 61.21339817345141, 61.799722507596, 61.135029092431054, 53.65931579222281, 53.936228317519024, 53.46505006154378, 58.69755409844218, 58.394235178828225, 58.717940814793096, 66.40163202638117, 66.13245505591233, 66.1382492048045, 54.77941198988508, 54.80351778228457, 54.308898600439235, 47.2006682207187, 47.885125972641006, 47.86163319305827, 44.50102043772736, 44.42594157035151, 44.13474756727615, 42.544032891591385, 42.57793131967385, 42.61213510980208, 52.29134356975554, 52.65636505000292, 51.794109553098664, 50.90016132903595, 50.36266974856456, 50.349223909278706, 50.89400315781434, 50.47065163155396, 50.578384940822914, 54.59068919718264, 55.161347977817044, 54.82454857975243, 48.139753599961594, 48.99227181899671, 48.78368409102161, 42.48878576854864, 42.41987251738706, 42.95199568445483, 54.62910274167855, 55.14240672936042, 55.14136018355687, 45.20882053176561, 45.36572581032911, 45.48941433305541, 49.69345771769683, 49.76863243679206, 50.16418167452018, 49.47072666448851, 48.97588205834229, 49.613270245802894, 55.5738986035188, 55.5057401706775, 55.846211941291884, 52.42185938855012, 52.18824293216069, 52.884835970898465, 58.71264714499314, 58.99713258941968, 59.217232137297586, 50.13377235084771, 50.329233229160295, 50.04741326719521, 50.82328685869773, 50.6468237315615, 51.132146658686295, 56.37435149401425, 56.09011910855769, 56.1942497640848, 57.50009213636319, 57.76376836995284, 57.54922092954318, 43.732734998067215, 44.058269043763474, 44.01869640251, 52.72924605508645, 53.23814066809912, 53.21730212991436, 44.21356956722835, 44.15497838767865, 43.77656229088703, 56.96166135867436, 56.34665728112061, 56.44962579508622]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14722110911438896, "mean_inference_ms": 0.7121225074097637, "mean_action_processing_ms": 0.10218945656035829, "mean_env_wait_ms": 0.8469244918295189, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 870000, "timesteps_this_iter": 0, "agent_timesteps_total": 2610000, "timers": {"sample_time_ms": 10805.835, "sample_throughput": 462.713, "load_time_ms": 0.351, "load_throughput": 14241151.704, "learn_time_ms": 1701.052, "learn_throughput": 2939.357, "update_time_ms": 8.175}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.622231866529366e-34, "cur_lr": 0.0005000000000000001, "total_loss": 8.368207645416259, "policy_loss": -0.0009773307973720336, "vf_loss": 8.462271118164063, "vf_explained_var": 0.015297538042068482, "kl": 0.0038953513838773115, "entropy": 9.308619499206543, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 870000, "num_agent_steps_sampled": 2610000, "num_steps_trained": 870000, "num_agent_steps_trained": 2610000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2597, "training_iteration": 174, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-40-48", "timestamp": 1706229648, "time_this_iter_s": 10.374577283859253, "time_total_s": 1888.0937519073486, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282552DC0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1888.0937519073486, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 9.386666666666665, "ram_util_percent": 51.98666666666666}}
{"episode_reward_max": 209.5563368350266, "episode_reward_min": 97.57211121171713, "episode_reward_mean": 153.81923918271593, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 32.181627720594406}, "policy_reward_max": {"shared_policy": 70.18273550520341}, "policy_reward_mean": {"shared_policy": 51.27307972757198}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.3094928786157, 161.53664927021572, 172.4990283474327, 158.69034225959322, 121.09683272388065, 133.32563954591728, 143.0355761428363, 209.5563368350266, 139.00656017707652, 151.45511045679447, 138.6213423684238, 144.21789395809162, 143.03059025295082, 144.036084196978, 143.3836516849696, 139.45852762740108, 165.94741271436223, 174.12057987600556, 142.5911151915789, 159.12643184140342, 170.68745271116478, 143.37014530226568, 175.0486257895827, 172.0916058421136, 134.7993693586904, 168.91150784492513, 170.3469083458186, 147.85394001658986, 170.86926613654913, 134.45312515646214, 146.6216513141991, 133.0311255846172, 153.15990808233607, 154.41246754676123, 163.18073012307298, 143.07130255550155, 120.50533770304172, 179.13429195806347, 185.7972649820148, 159.85368718835548, 158.58792840689395, 164.56142744235706, 147.88208197802297, 146.20915407873667, 157.2744152639063, 172.7986135575919, 187.85309084877363, 117.3425043062307, 176.98676590994015, 145.7889636009933, 168.6829002201558, 172.6975429635493, 156.22036604955767, 146.86148780351533, 169.44199831411248, 148.2544911354778, 124.56496933475135, 148.12574663572022, 145.84089571237536, 138.6196322664619, 153.71216822601855, 184.14814977347862, 161.06059417128566, 175.80973009206375, 198.6723362870979, 163.89182837260887, 142.94742738641813, 133.06170957535505, 127.73409932106732, 156.74181817285734, 151.6120549868792, 151.94303973019123, 164.57658575475207, 145.9157095099798, 127.86065397039053, 164.91286965459582, 136.0639606751503, 149.62627182900917, 148.05987896863383, 166.92585071548814, 157.49493829160937, 176.92701187171033, 150.5104188472032, 152.60225724894534, 168.65872036665655, 172.81308143585923, 131.80970044434048, 159.18468885309994, 132.14511024579403, 169.75794443488115, 157.14123216364524, 157.32732587121427, 151.85889359936115, 178.08973778411737, 100.63684172742069, 145.04488966986546, 144.69434611126795, 97.57211121171713, 155.6471461839973, 163.89089701476038], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [48.812970119218036, 48.79567922155063, 48.700843537847206, 53.731193823119, 53.76656388988097, 54.03889155721602, 57.336185182134315, 57.61037437121074, 57.552468794087574, 52.88504744072755, 52.56371224423249, 53.241582574633256, 40.12605046480894, 40.32884744554758, 40.64193481352413, 44.34755628059307, 44.30783723543087, 44.67024602989355, 47.83555669927348, 47.32047330339749, 47.879546140165374, 70.18273550520341, 69.56064685682456, 69.81295447299878, 46.66497155325487, 46.1955701187253, 46.146018505096436, 50.148289059599236, 50.57815883805354, 50.72866255914171, 46.34624496102333, 46.092411652207375, 46.18268575519323, 47.98207370936869, 48.496918290853486, 47.738901957869516, 47.74301531910895, 47.47337385267018, 47.81420108117162, 47.910264121989414, 48.23884657970363, 47.88697349528472, 47.50612664719422, 47.84981373449166, 48.027711303283766, 46.72347721240172, 46.26699988792339, 46.46805052707592, 55.36476217706998, 55.267293234666184, 55.31535730262597, 57.79313170413177, 57.9017198185126, 58.42572835336129, 47.20581823090713, 47.85912708441417, 47.52616987625758, 53.00533090780179, 52.89283097783725, 53.22826995576422, 57.37735751022895, 56.72091632088025, 56.58917888005574, 47.6551864867409, 48.15306708340843, 47.561891732116536, 58.44973584140341, 58.268333929280445, 58.33055601889889, 57.23250653346379, 57.504023795326546, 57.35507551332314, 44.70120006799698, 45.403942668111995, 44.69422662258148, 56.37889947990577, 56.361544097463295, 56.17106426755588, 56.98003043731053, 56.80947711070378, 56.55740079780419, 49.45807599431525, 49.420179533461734, 48.97568448881309, 56.413776611288384, 56.98663539936145, 57.46885412589957, 44.481654182076454, 44.98356429487467, 44.98790667951107, 48.7973219777147, 48.95364000151555, 48.87068933496873, 44.64307669363916, 44.46042186394334, 43.92762702703476, 50.76191126306851, 51.38627999400099, 51.011716825266674, 51.85953403885166, 51.74811738605301, 50.804816121856376, 54.28305649012326, 54.562225889414535, 54.33544774353503, 47.35977201660474, 47.80323150505622, 47.90829903384049, 40.412065193367496, 40.04860799511273, 40.04466451456149, 59.41838720440863, 59.95298415049909, 59.762920603156076, 61.83103877305983, 61.76614794135092, 62.2000782676041, 53.46522899724853, 52.989770253499344, 53.39868793760736, 52.904315569748476, 52.79572535057862, 52.887887486567095, 54.84134641538064, 54.49096643428008, 55.229114592696234, 49.66317508369683, 49.203864410519586, 49.015042483806596, 48.87139572948216, 48.08185982704161, 49.25589852221309, 52.34268916894992, 52.38547159483035, 52.54625450012584, 56.97828715542953, 57.67523927489917, 58.14508712726335, 62.7664981385072, 62.89141626780231, 62.19517644246419, 39.320365293417126, 38.942857541143894, 39.079281471669674, 58.60914340615271, 59.20482332259415, 59.1727991811931, 48.73994883646567, 48.49684779097636, 48.55216697355111, 56.019876549641296, 56.30054137359063, 56.3624822969238, 57.48324963947137, 57.43047699083884, 57.78381633323927, 52.301902208477244, 52.14222671091555, 51.776237130165086, 48.27016265193622, 49.1737860540549, 49.41753909752394, 56.494995576639965, 56.32534309973319, 56.621659637739256, 49.18696022530396, 49.38435851534207, 49.68317239483197, 41.537195568283394, 41.39795583983262, 41.62981792663534, 49.09048653642337, 49.421642380456134, 49.61361771884064, 48.495862153669194, 48.63825064649184, 48.70678291221459, 46.27203567326069, 46.33645357936621, 46.01114301383495, 51.167223587632165, 51.16074679791926, 51.38419784046708, 61.21339817345141, 61.799722507596, 61.135029092431054, 53.65931579222281, 53.936228317519024, 53.46505006154378, 58.69755409844218, 58.394235178828225, 58.717940814793096, 66.40163202638117, 66.13245505591233, 66.1382492048045, 54.77941198988508, 54.80351778228457, 54.308898600439235, 47.2006682207187, 47.885125972641006, 47.86163319305827, 44.50102043772736, 44.42594157035151, 44.13474756727615, 42.544032891591385, 42.57793131967385, 42.61213510980208, 52.29134356975554, 52.65636505000292, 51.794109553098664, 50.90016132903595, 50.36266974856456, 50.349223909278706, 50.89400315781434, 50.47065163155396, 50.578384940822914, 54.59068919718264, 55.161347977817044, 54.82454857975243, 48.139753599961594, 48.99227181899671, 48.78368409102161, 42.48878576854864, 42.41987251738706, 42.95199568445483, 54.62910274167855, 55.14240672936042, 55.14136018355687, 45.20882053176561, 45.36572581032911, 45.48941433305541, 49.69345771769683, 49.76863243679206, 50.16418167452018, 49.47072666448851, 48.97588205834229, 49.613270245802894, 55.5738986035188, 55.5057401706775, 55.846211941291884, 52.42185938855012, 52.18824293216069, 52.884835970898465, 58.71264714499314, 58.99713258941968, 59.217232137297586, 50.13377235084771, 50.329233229160295, 50.04741326719521, 50.82328685869773, 50.6468237315615, 51.132146658686295, 56.37435149401425, 56.09011910855769, 56.1942497640848, 57.50009213636319, 57.76376836995284, 57.54922092954318, 43.732734998067215, 44.058269043763474, 44.01869640251, 52.72924605508645, 53.23814066809912, 53.21730212991436, 44.21356956722835, 44.15497838767865, 43.77656229088703, 56.96166135867436, 56.34665728112061, 56.44962579508622, 52.522345439530895, 52.15907526016234, 52.45981146395205, 52.16804246604441, 52.79866146109997, 52.36062194406985, 50.41448552906512, 50.4232561290264, 51.02115194126962, 59.30200670659541, 59.13944151997565, 59.64828955754636, 33.655664497986436, 33.459067303687334, 33.52210992574692, 47.93230288227399, 48.65924822663267, 48.4533385609587, 48.10427522162597, 48.211702908078834, 48.37836798156302, 32.181627720594406, 33.0219706222415, 32.368512868881226, 51.771269758542374, 51.56920852263768, 52.306667902817324, 54.74321221063535, 54.22064506510894, 54.92703973901614]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14722894066883258, "mean_inference_ms": 0.7121554994843271, "mean_action_processing_ms": 0.10218355863467146, "mean_env_wait_ms": 0.8468049213683919, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 875000, "timesteps_this_iter": 0, "agent_timesteps_total": 2625000, "timers": {"sample_time_ms": 10738.676, "sample_throughput": 465.607, "load_time_ms": 0.351, "load_throughput": 14241151.704, "learn_time_ms": 1696.952, "learn_throughput": 2946.459, "update_time_ms": 7.879}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.311115933264683e-34, "cur_lr": 0.0005000000000000001, "total_loss": 8.634202194213866, "policy_loss": 0.0003321383599967476, "vf_loss": 8.725511169433593, "vf_explained_var": 0.015004378557205201, "kl": 0.006501369783696249, "entropy": 9.164102935791016, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 875000, "num_agent_steps_sampled": 2625000, "num_steps_trained": 875000, "num_agent_steps_trained": 2625000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2607, "training_iteration": 175, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-40-59", "timestamp": 1706229659, "time_this_iter_s": 10.515577554702759, "time_total_s": 1898.6093294620514, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028379EC10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1898.6093294620514, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 11.806666666666667, "ram_util_percent": 51.813333333333325}}
{"episode_reward_max": 198.6723362870979, "episode_reward_min": -256.5152857080102, "episode_reward_mean": 145.46566969026676, "episode_len_mean": 495.39, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -91.98327746242285}, "policy_reward_max": {"shared_policy": 66.40163202638117}, "policy_reward_mean": {"shared_policy": 48.48855656342226}, "custom_metrics": {}, "hist_stats": {"episode_reward": [144.21789395809162, 143.03059025295082, 144.036084196978, 143.3836516849696, 139.45852762740108, 165.94741271436223, 174.12057987600556, 142.5911151915789, 159.12643184140342, 170.68745271116478, 143.37014530226568, 175.0486257895827, 172.0916058421136, 134.7993693586904, 168.91150784492513, 170.3469083458186, 147.85394001658986, 170.86926613654913, 134.45312515646214, 146.6216513141991, 133.0311255846172, 153.15990808233607, 154.41246754676123, 163.18073012307298, 143.07130255550155, 120.50533770304172, 179.13429195806347, 185.7972649820148, 159.85368718835548, 158.58792840689395, 164.56142744235706, 147.88208197802297, 146.20915407873667, 157.2744152639063, 172.7986135575919, 187.85309084877363, 117.3425043062307, 176.98676590994015, 145.7889636009933, 168.6829002201558, 172.6975429635493, 156.22036604955767, 146.86148780351533, 169.44199831411248, 148.2544911354778, 124.56496933475135, 148.12574663572022, 145.84089571237536, 138.6196322664619, 153.71216822601855, 184.14814977347862, 161.06059417128566, 175.80973009206375, 198.6723362870979, 163.89182837260887, 142.94742738641813, 133.06170957535505, 127.73409932106732, 156.74181817285734, 151.6120549868792, 151.94303973019123, 164.57658575475207, 145.9157095099798, 127.86065397039053, 164.91286965459582, 136.0639606751503, 149.62627182900917, 148.05987896863383, 166.92585071548814, 157.49493829160937, 176.92701187171033, 150.5104188472032, 152.60225724894534, 168.65872036665655, 172.81308143585923, 131.80970044434048, 159.18468885309994, 132.14511024579403, 169.75794443488115, 157.14123216364524, 157.32732587121427, 151.85889359936115, 178.08973778411737, 100.63684172742069, 145.04488966986546, 144.69434611126795, 97.57211121171713, 155.6471461839973, 163.89089701476038, 163.48326853290203, 161.75507161486874, 153.90321714431028, 106.12545904796569, -256.5152857080102, 139.33248609490698, 161.17331242002552, 145.14927507750684, 161.29667130857698, 118.53036172688007, -214.45787549903616], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 140, 500, 500, 500, 500, 500, 399], "policy_shared_policy_reward": [47.98207370936869, 48.496918290853486, 47.738901957869516, 47.74301531910895, 47.47337385267018, 47.81420108117162, 47.910264121989414, 48.23884657970363, 47.88697349528472, 47.50612664719422, 47.84981373449166, 48.027711303283766, 46.72347721240172, 46.26699988792339, 46.46805052707592, 55.36476217706998, 55.267293234666184, 55.31535730262597, 57.79313170413177, 57.9017198185126, 58.42572835336129, 47.20581823090713, 47.85912708441417, 47.52616987625758, 53.00533090780179, 52.89283097783725, 53.22826995576422, 57.37735751022895, 56.72091632088025, 56.58917888005574, 47.6551864867409, 48.15306708340843, 47.561891732116536, 58.44973584140341, 58.268333929280445, 58.33055601889889, 57.23250653346379, 57.504023795326546, 57.35507551332314, 44.70120006799698, 45.403942668111995, 44.69422662258148, 56.37889947990577, 56.361544097463295, 56.17106426755588, 56.98003043731053, 56.80947711070378, 56.55740079780419, 49.45807599431525, 49.420179533461734, 48.97568448881309, 56.413776611288384, 56.98663539936145, 57.46885412589957, 44.481654182076454, 44.98356429487467, 44.98790667951107, 48.7973219777147, 48.95364000151555, 48.87068933496873, 44.64307669363916, 44.46042186394334, 43.92762702703476, 50.76191126306851, 51.38627999400099, 51.011716825266674, 51.85953403885166, 51.74811738605301, 50.804816121856376, 54.28305649012326, 54.562225889414535, 54.33544774353503, 47.35977201660474, 47.80323150505622, 47.90829903384049, 40.412065193367496, 40.04860799511273, 40.04466451456149, 59.41838720440863, 59.95298415049909, 59.762920603156076, 61.83103877305983, 61.76614794135092, 62.2000782676041, 53.46522899724853, 52.989770253499344, 53.39868793760736, 52.904315569748476, 52.79572535057862, 52.887887486567095, 54.84134641538064, 54.49096643428008, 55.229114592696234, 49.66317508369683, 49.203864410519586, 49.015042483806596, 48.87139572948216, 48.08185982704161, 49.25589852221309, 52.34268916894992, 52.38547159483035, 52.54625450012584, 56.97828715542953, 57.67523927489917, 58.14508712726335, 62.7664981385072, 62.89141626780231, 62.19517644246419, 39.320365293417126, 38.942857541143894, 39.079281471669674, 58.60914340615271, 59.20482332259415, 59.1727991811931, 48.73994883646567, 48.49684779097636, 48.55216697355111, 56.019876549641296, 56.30054137359063, 56.3624822969238, 57.48324963947137, 57.43047699083884, 57.78381633323927, 52.301902208477244, 52.14222671091555, 51.776237130165086, 48.27016265193622, 49.1737860540549, 49.41753909752394, 56.494995576639965, 56.32534309973319, 56.621659637739256, 49.18696022530396, 49.38435851534207, 49.68317239483197, 41.537195568283394, 41.39795583983262, 41.62981792663534, 49.09048653642337, 49.421642380456134, 49.61361771884064, 48.495862153669194, 48.63825064649184, 48.70678291221459, 46.27203567326069, 46.33645357936621, 46.01114301383495, 51.167223587632165, 51.16074679791926, 51.38419784046708, 61.21339817345141, 61.799722507596, 61.135029092431054, 53.65931579222281, 53.936228317519024, 53.46505006154378, 58.69755409844218, 58.394235178828225, 58.717940814793096, 66.40163202638117, 66.13245505591233, 66.1382492048045, 54.77941198988508, 54.80351778228457, 54.308898600439235, 47.2006682207187, 47.885125972641006, 47.86163319305827, 44.50102043772736, 44.42594157035151, 44.13474756727615, 42.544032891591385, 42.57793131967385, 42.61213510980208, 52.29134356975554, 52.65636505000292, 51.794109553098664, 50.90016132903595, 50.36266974856456, 50.349223909278706, 50.89400315781434, 50.47065163155396, 50.578384940822914, 54.59068919718264, 55.161347977817044, 54.82454857975243, 48.139753599961594, 48.99227181899671, 48.78368409102161, 42.48878576854864, 42.41987251738706, 42.95199568445483, 54.62910274167855, 55.14240672936042, 55.14136018355687, 45.20882053176561, 45.36572581032911, 45.48941433305541, 49.69345771769683, 49.76863243679206, 50.16418167452018, 49.47072666448851, 48.97588205834229, 49.613270245802894, 55.5738986035188, 55.5057401706775, 55.846211941291884, 52.42185938855012, 52.18824293216069, 52.884835970898465, 58.71264714499314, 58.99713258941968, 59.217232137297586, 50.13377235084771, 50.329233229160295, 50.04741326719521, 50.82328685869773, 50.6468237315615, 51.132146658686295, 56.37435149401425, 56.09011910855769, 56.1942497640848, 57.50009213636319, 57.76376836995284, 57.54922092954318, 43.732734998067215, 44.058269043763474, 44.01869640251, 52.72924605508645, 53.23814066809912, 53.21730212991436, 44.21356956722835, 44.15497838767865, 43.77656229088703, 56.96166135867436, 56.34665728112061, 56.44962579508622, 52.522345439530895, 52.15907526016234, 52.45981146395205, 52.16804246604441, 52.79866146109997, 52.36062194406985, 50.41448552906512, 50.4232561290264, 51.02115194126962, 59.30200670659541, 59.13944151997565, 59.64828955754636, 33.655664497986436, 33.459067303687334, 33.52210992574692, 47.93230288227399, 48.65924822663267, 48.4533385609587, 48.10427522162597, 48.211702908078834, 48.37836798156302, 32.181627720594406, 33.0219706222415, 32.368512868881226, 51.771269758542374, 51.56920852263768, 52.306667902817324, 54.74321221063535, 54.22064506510894, 54.92703973901614, 54.5758082618316, 54.2564833809932, 54.65097689007719, 53.23304823040961, 54.28950704541056, 54.23251633904873, 51.233631675442055, 51.766822827359036, 50.90276264150937, 35.776236616385475, 35.511087258656815, 34.8381351729234, -82.14186005294323, -82.39014819264412, -91.98327746242285, 46.236827209591866, 46.53307780995965, 46.56258107535541, 53.47684401025374, 53.9146556140234, 53.78181279574831, 48.715838049228, 48.60432708139221, 47.8291099468867, 53.433709124724075, 53.9094372826318, 53.9535249012212, 39.1829364746809, 39.562244936823845, 39.78518031537533, -71.59439268584053, -71.42379100496571, -71.43969180822994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1472066893222726, "mean_inference_ms": 0.7119539261941958, "mean_action_processing_ms": 0.10215717160105424, "mean_env_wait_ms": 0.8464878668239713, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 880000, "timesteps_this_iter": 0, "agent_timesteps_total": 2640000, "timers": {"sample_time_ms": 10684.318, "sample_throughput": 467.976, "load_time_ms": 0.351, "load_throughput": 14241151.704, "learn_time_ms": 1702.649, "learn_throughput": 2936.6, "update_time_ms": 7.976}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.311115933264683e-34, "cur_lr": 0.0005000000000000001, "total_loss": 231.76659698486327, "policy_loss": -0.0010352735557841442, "vf_loss": 231.86090545654298, "vf_explained_var": -0.002628767490386963, "kl": 0.0067666675430213515, "entropy": 9.327647304534912, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 880000, "num_agent_steps_sampled": 2640000, "num_steps_trained": 880000, "num_agent_steps_trained": 2640000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2618, "training_iteration": 176, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-41-10", "timestamp": 1706229670, "time_this_iter_s": 10.543163299560547, "time_total_s": 1909.152492761612, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028379E040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1909.152492761612, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 10.093333333333334, "ram_util_percent": 51.81333333333331}}
{"episode_reward_max": 198.6723362870979, "episode_reward_min": -256.5152857080102, "episode_reward_mean": 144.41490305994986, "episode_len_mean": 495.39, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -91.98327746242285}, "policy_reward_max": {"shared_policy": 66.40163202638117}, "policy_reward_mean": {"shared_policy": 48.13830101998329}, "custom_metrics": {}, "hist_stats": {"episode_reward": [143.37014530226568, 175.0486257895827, 172.0916058421136, 134.7993693586904, 168.91150784492513, 170.3469083458186, 147.85394001658986, 170.86926613654913, 134.45312515646214, 146.6216513141991, 133.0311255846172, 153.15990808233607, 154.41246754676123, 163.18073012307298, 143.07130255550155, 120.50533770304172, 179.13429195806347, 185.7972649820148, 159.85368718835548, 158.58792840689395, 164.56142744235706, 147.88208197802297, 146.20915407873667, 157.2744152639063, 172.7986135575919, 187.85309084877363, 117.3425043062307, 176.98676590994015, 145.7889636009933, 168.6829002201558, 172.6975429635493, 156.22036604955767, 146.86148780351533, 169.44199831411248, 148.2544911354778, 124.56496933475135, 148.12574663572022, 145.84089571237536, 138.6196322664619, 153.71216822601855, 184.14814977347862, 161.06059417128566, 175.80973009206375, 198.6723362870979, 163.89182837260887, 142.94742738641813, 133.06170957535505, 127.73409932106732, 156.74181817285734, 151.6120549868792, 151.94303973019123, 164.57658575475207, 145.9157095099798, 127.86065397039053, 164.91286965459582, 136.0639606751503, 149.62627182900917, 148.05987896863383, 166.92585071548814, 157.49493829160937, 176.92701187171033, 150.5104188472032, 152.60225724894534, 168.65872036665655, 172.81308143585923, 131.80970044434048, 159.18468885309994, 132.14511024579403, 169.75794443488115, 157.14123216364524, 157.32732587121427, 151.85889359936115, 178.08973778411737, 100.63684172742069, 145.04488966986546, 144.69434611126795, 97.57211121171713, 155.6471461839973, 163.89089701476038, 163.48326853290203, 161.75507161486874, 153.90321714431028, 106.12545904796569, -256.5152857080102, 139.33248609490698, 161.17331242002552, 145.14927507750684, 161.29667130857698, 118.53036172688007, -214.45787549903616, 158.9295799508692, 138.87261439627042, 159.1621043374763, 118.9647915083915, 151.22308809310198, 142.30483235046242, 138.84098507463938, 163.42574821412566, 138.62091755121952, 111.17841554665937], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 140, 500, 500, 500, 500, 500, 399, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [47.6551864867409, 48.15306708340843, 47.561891732116536, 58.44973584140341, 58.268333929280445, 58.33055601889889, 57.23250653346379, 57.504023795326546, 57.35507551332314, 44.70120006799698, 45.403942668111995, 44.69422662258148, 56.37889947990577, 56.361544097463295, 56.17106426755588, 56.98003043731053, 56.80947711070378, 56.55740079780419, 49.45807599431525, 49.420179533461734, 48.97568448881309, 56.413776611288384, 56.98663539936145, 57.46885412589957, 44.481654182076454, 44.98356429487467, 44.98790667951107, 48.7973219777147, 48.95364000151555, 48.87068933496873, 44.64307669363916, 44.46042186394334, 43.92762702703476, 50.76191126306851, 51.38627999400099, 51.011716825266674, 51.85953403885166, 51.74811738605301, 50.804816121856376, 54.28305649012326, 54.562225889414535, 54.33544774353503, 47.35977201660474, 47.80323150505622, 47.90829903384049, 40.412065193367496, 40.04860799511273, 40.04466451456149, 59.41838720440863, 59.95298415049909, 59.762920603156076, 61.83103877305983, 61.76614794135092, 62.2000782676041, 53.46522899724853, 52.989770253499344, 53.39868793760736, 52.904315569748476, 52.79572535057862, 52.887887486567095, 54.84134641538064, 54.49096643428008, 55.229114592696234, 49.66317508369683, 49.203864410519586, 49.015042483806596, 48.87139572948216, 48.08185982704161, 49.25589852221309, 52.34268916894992, 52.38547159483035, 52.54625450012584, 56.97828715542953, 57.67523927489917, 58.14508712726335, 62.7664981385072, 62.89141626780231, 62.19517644246419, 39.320365293417126, 38.942857541143894, 39.079281471669674, 58.60914340615271, 59.20482332259415, 59.1727991811931, 48.73994883646567, 48.49684779097636, 48.55216697355111, 56.019876549641296, 56.30054137359063, 56.3624822969238, 57.48324963947137, 57.43047699083884, 57.78381633323927, 52.301902208477244, 52.14222671091555, 51.776237130165086, 48.27016265193622, 49.1737860540549, 49.41753909752394, 56.494995576639965, 56.32534309973319, 56.621659637739256, 49.18696022530396, 49.38435851534207, 49.68317239483197, 41.537195568283394, 41.39795583983262, 41.62981792663534, 49.09048653642337, 49.421642380456134, 49.61361771884064, 48.495862153669194, 48.63825064649184, 48.70678291221459, 46.27203567326069, 46.33645357936621, 46.01114301383495, 51.167223587632165, 51.16074679791926, 51.38419784046708, 61.21339817345141, 61.799722507596, 61.135029092431054, 53.65931579222281, 53.936228317519024, 53.46505006154378, 58.69755409844218, 58.394235178828225, 58.717940814793096, 66.40163202638117, 66.13245505591233, 66.1382492048045, 54.77941198988508, 54.80351778228457, 54.308898600439235, 47.2006682207187, 47.885125972641006, 47.86163319305827, 44.50102043772736, 44.42594157035151, 44.13474756727615, 42.544032891591385, 42.57793131967385, 42.61213510980208, 52.29134356975554, 52.65636505000292, 51.794109553098664, 50.90016132903595, 50.36266974856456, 50.349223909278706, 50.89400315781434, 50.47065163155396, 50.578384940822914, 54.59068919718264, 55.161347977817044, 54.82454857975243, 48.139753599961594, 48.99227181899671, 48.78368409102161, 42.48878576854864, 42.41987251738706, 42.95199568445483, 54.62910274167855, 55.14240672936042, 55.14136018355687, 45.20882053176561, 45.36572581032911, 45.48941433305541, 49.69345771769683, 49.76863243679206, 50.16418167452018, 49.47072666448851, 48.97588205834229, 49.613270245802894, 55.5738986035188, 55.5057401706775, 55.846211941291884, 52.42185938855012, 52.18824293216069, 52.884835970898465, 58.71264714499314, 58.99713258941968, 59.217232137297586, 50.13377235084771, 50.329233229160295, 50.04741326719521, 50.82328685869773, 50.6468237315615, 51.132146658686295, 56.37435149401425, 56.09011910855769, 56.1942497640848, 57.50009213636319, 57.76376836995284, 57.54922092954318, 43.732734998067215, 44.058269043763474, 44.01869640251, 52.72924605508645, 53.23814066809912, 53.21730212991436, 44.21356956722835, 44.15497838767865, 43.77656229088703, 56.96166135867436, 56.34665728112061, 56.44962579508622, 52.522345439530895, 52.15907526016234, 52.45981146395205, 52.16804246604441, 52.79866146109997, 52.36062194406985, 50.41448552906512, 50.4232561290264, 51.02115194126962, 59.30200670659541, 59.13944151997565, 59.64828955754636, 33.655664497986436, 33.459067303687334, 33.52210992574692, 47.93230288227399, 48.65924822663267, 48.4533385609587, 48.10427522162597, 48.211702908078834, 48.37836798156302, 32.181627720594406, 33.0219706222415, 32.368512868881226, 51.771269758542374, 51.56920852263768, 52.306667902817324, 54.74321221063535, 54.22064506510894, 54.92703973901614, 54.5758082618316, 54.2564833809932, 54.65097689007719, 53.23304823040961, 54.28950704541056, 54.23251633904873, 51.233631675442055, 51.766822827359036, 50.90276264150937, 35.776236616385475, 35.511087258656815, 34.8381351729234, -82.14186005294323, -82.39014819264412, -91.98327746242285, 46.236827209591866, 46.53307780995965, 46.56258107535541, 53.47684401025374, 53.9146556140234, 53.78181279574831, 48.715838049228, 48.60432708139221, 47.8291099468867, 53.433709124724075, 53.9094372826318, 53.9535249012212, 39.1829364746809, 39.562244936823845, 39.78518031537533, -71.59439268584053, -71.42379100496571, -71.43969180822994, 53.01545762891571, 52.97167116279404, 52.94245115915935, 46.51320535084233, 45.957536935806274, 46.40187210962176, 53.45502519762765, 52.948088946441814, 52.758990193406746, 39.463844031095505, 39.73109928146005, 39.76984819583595, 50.60428859045108, 50.45190041263898, 50.16689909001191, 47.622524261474595, 46.867613628506646, 47.81469446048139, 46.012033124764756, 46.51901773487528, 46.309934214999274, 54.35510961214702, 54.55286016563575, 54.51777843634288, 46.45652863383293, 46.44836089760065, 45.71602801978588, 37.341038629257426, 36.894602221747235, 36.942774695654705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1472096885323189, "mean_inference_ms": 0.7119697184025369, "mean_action_processing_ms": 0.1021483335812706, "mean_env_wait_ms": 0.8463358629903002, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 885000, "timesteps_this_iter": 0, "agent_timesteps_total": 2655000, "timers": {"sample_time_ms": 10693.255, "sample_throughput": 467.584, "load_time_ms": 0.25, "load_throughput": 19982391.615, "learn_time_ms": 1716.131, "learn_throughput": 2913.531, "update_time_ms": 7.827}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.311115933264683e-34, "cur_lr": 0.0005000000000000001, "total_loss": 13.626579666137696, "policy_loss": -0.00097732453309467, "vf_loss": 13.72122859954834, "vf_explained_var": 0.008801841735839843, "kl": 0.0042927247006884885, "entropy": 9.367176532745361, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 885000, "num_agent_steps_sampled": 2655000, "num_steps_trained": 885000, "num_agent_steps_trained": 2655000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2628, "training_iteration": 177, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-41-20", "timestamp": 1706229680, "time_this_iter_s": 10.81433391571045, "time_total_s": 1919.9668266773224, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202CC9FB4C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1919.9668266773224, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 9.086666666666668, "ram_util_percent": 51.99333333333334}}
{"episode_reward_max": 198.6723362870979, "episode_reward_min": -256.5152857080102, "episode_reward_mean": 144.800185465301, "episode_len_mean": 495.39, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -91.98327746242285}, "policy_reward_max": {"shared_policy": 66.40163202638117}, "policy_reward_mean": {"shared_policy": 48.26672848843368}, "custom_metrics": {}, "hist_stats": {"episode_reward": [133.0311255846172, 153.15990808233607, 154.41246754676123, 163.18073012307298, 143.07130255550155, 120.50533770304172, 179.13429195806347, 185.7972649820148, 159.85368718835548, 158.58792840689395, 164.56142744235706, 147.88208197802297, 146.20915407873667, 157.2744152639063, 172.7986135575919, 187.85309084877363, 117.3425043062307, 176.98676590994015, 145.7889636009933, 168.6829002201558, 172.6975429635493, 156.22036604955767, 146.86148780351533, 169.44199831411248, 148.2544911354778, 124.56496933475135, 148.12574663572022, 145.84089571237536, 138.6196322664619, 153.71216822601855, 184.14814977347862, 161.06059417128566, 175.80973009206375, 198.6723362870979, 163.89182837260887, 142.94742738641813, 133.06170957535505, 127.73409932106732, 156.74181817285734, 151.6120549868792, 151.94303973019123, 164.57658575475207, 145.9157095099798, 127.86065397039053, 164.91286965459582, 136.0639606751503, 149.62627182900917, 148.05987896863383, 166.92585071548814, 157.49493829160937, 176.92701187171033, 150.5104188472032, 152.60225724894534, 168.65872036665655, 172.81308143585923, 131.80970044434048, 159.18468885309994, 132.14511024579403, 169.75794443488115, 157.14123216364524, 157.32732587121427, 151.85889359936115, 178.08973778411737, 100.63684172742069, 145.04488966986546, 144.69434611126795, 97.57211121171713, 155.6471461839973, 163.89089701476038, 163.48326853290203, 161.75507161486874, 153.90321714431028, 106.12545904796569, -256.5152857080102, 139.33248609490698, 161.17331242002552, 145.14927507750684, 161.29667130857698, 118.53036172688007, -214.45787549903616, 158.9295799508692, 138.87261439627042, 159.1621043374763, 118.9647915083915, 151.22308809310198, 142.30483235046242, 138.84098507463938, 163.42574821412566, 138.62091755121952, 111.17841554665937, 180.81059439852814, 163.09948034206184, 156.8813878558576, 142.11863132566205, 152.96947919577332, 182.5148770101368, 160.3196384049953, 126.17497969511894, 182.8663614783437, 155.13895593583567], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 140, 500, 500, 500, 500, 500, 399, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [44.64307669363916, 44.46042186394334, 43.92762702703476, 50.76191126306851, 51.38627999400099, 51.011716825266674, 51.85953403885166, 51.74811738605301, 50.804816121856376, 54.28305649012326, 54.562225889414535, 54.33544774353503, 47.35977201660474, 47.80323150505622, 47.90829903384049, 40.412065193367496, 40.04860799511273, 40.04466451456149, 59.41838720440863, 59.95298415049909, 59.762920603156076, 61.83103877305983, 61.76614794135092, 62.2000782676041, 53.46522899724853, 52.989770253499344, 53.39868793760736, 52.904315569748476, 52.79572535057862, 52.887887486567095, 54.84134641538064, 54.49096643428008, 55.229114592696234, 49.66317508369683, 49.203864410519586, 49.015042483806596, 48.87139572948216, 48.08185982704161, 49.25589852221309, 52.34268916894992, 52.38547159483035, 52.54625450012584, 56.97828715542953, 57.67523927489917, 58.14508712726335, 62.7664981385072, 62.89141626780231, 62.19517644246419, 39.320365293417126, 38.942857541143894, 39.079281471669674, 58.60914340615271, 59.20482332259415, 59.1727991811931, 48.73994883646567, 48.49684779097636, 48.55216697355111, 56.019876549641296, 56.30054137359063, 56.3624822969238, 57.48324963947137, 57.43047699083884, 57.78381633323927, 52.301902208477244, 52.14222671091555, 51.776237130165086, 48.27016265193622, 49.1737860540549, 49.41753909752394, 56.494995576639965, 56.32534309973319, 56.621659637739256, 49.18696022530396, 49.38435851534207, 49.68317239483197, 41.537195568283394, 41.39795583983262, 41.62981792663534, 49.09048653642337, 49.421642380456134, 49.61361771884064, 48.495862153669194, 48.63825064649184, 48.70678291221459, 46.27203567326069, 46.33645357936621, 46.01114301383495, 51.167223587632165, 51.16074679791926, 51.38419784046708, 61.21339817345141, 61.799722507596, 61.135029092431054, 53.65931579222281, 53.936228317519024, 53.46505006154378, 58.69755409844218, 58.394235178828225, 58.717940814793096, 66.40163202638117, 66.13245505591233, 66.1382492048045, 54.77941198988508, 54.80351778228457, 54.308898600439235, 47.2006682207187, 47.885125972641006, 47.86163319305827, 44.50102043772736, 44.42594157035151, 44.13474756727615, 42.544032891591385, 42.57793131967385, 42.61213510980208, 52.29134356975554, 52.65636505000292, 51.794109553098664, 50.90016132903595, 50.36266974856456, 50.349223909278706, 50.89400315781434, 50.47065163155396, 50.578384940822914, 54.59068919718264, 55.161347977817044, 54.82454857975243, 48.139753599961594, 48.99227181899671, 48.78368409102161, 42.48878576854864, 42.41987251738706, 42.95199568445483, 54.62910274167855, 55.14240672936042, 55.14136018355687, 45.20882053176561, 45.36572581032911, 45.48941433305541, 49.69345771769683, 49.76863243679206, 50.16418167452018, 49.47072666448851, 48.97588205834229, 49.613270245802894, 55.5738986035188, 55.5057401706775, 55.846211941291884, 52.42185938855012, 52.18824293216069, 52.884835970898465, 58.71264714499314, 58.99713258941968, 59.217232137297586, 50.13377235084771, 50.329233229160295, 50.04741326719521, 50.82328685869773, 50.6468237315615, 51.132146658686295, 56.37435149401425, 56.09011910855769, 56.1942497640848, 57.50009213636319, 57.76376836995284, 57.54922092954318, 43.732734998067215, 44.058269043763474, 44.01869640251, 52.72924605508645, 53.23814066809912, 53.21730212991436, 44.21356956722835, 44.15497838767865, 43.77656229088703, 56.96166135867436, 56.34665728112061, 56.44962579508622, 52.522345439530895, 52.15907526016234, 52.45981146395205, 52.16804246604441, 52.79866146109997, 52.36062194406985, 50.41448552906512, 50.4232561290264, 51.02115194126962, 59.30200670659541, 59.13944151997565, 59.64828955754636, 33.655664497986436, 33.459067303687334, 33.52210992574692, 47.93230288227399, 48.65924822663267, 48.4533385609587, 48.10427522162597, 48.211702908078834, 48.37836798156302, 32.181627720594406, 33.0219706222415, 32.368512868881226, 51.771269758542374, 51.56920852263768, 52.306667902817324, 54.74321221063535, 54.22064506510894, 54.92703973901614, 54.5758082618316, 54.2564833809932, 54.65097689007719, 53.23304823040961, 54.28950704541056, 54.23251633904873, 51.233631675442055, 51.766822827359036, 50.90276264150937, 35.776236616385475, 35.511087258656815, 34.8381351729234, -82.14186005294323, -82.39014819264412, -91.98327746242285, 46.236827209591866, 46.53307780995965, 46.56258107535541, 53.47684401025374, 53.9146556140234, 53.78181279574831, 48.715838049228, 48.60432708139221, 47.8291099468867, 53.433709124724075, 53.9094372826318, 53.9535249012212, 39.1829364746809, 39.562244936823845, 39.78518031537533, -71.59439268584053, -71.42379100496571, -71.43969180822994, 53.01545762891571, 52.97167116279404, 52.94245115915935, 46.51320535084233, 45.957536935806274, 46.40187210962176, 53.45502519762765, 52.948088946441814, 52.758990193406746, 39.463844031095505, 39.73109928146005, 39.76984819583595, 50.60428859045108, 50.45190041263898, 50.16689909001191, 47.622524261474595, 46.867613628506646, 47.81469446048139, 46.012033124764756, 46.51901773487528, 46.309934214999274, 54.35510961214702, 54.55286016563575, 54.51777843634288, 46.45652863383293, 46.44836089760065, 45.71602801978588, 37.341038629257426, 36.894602221747235, 36.942774695654705, 60.317999400198445, 60.03679079562424, 60.45580420270561, 54.601545056890856, 54.52477949361007, 53.973155791560814, 52.21465312192838, 52.34099900598328, 52.32573572794597, 47.21005373448132, 47.46057853847741, 47.447999052703366, 50.74946755170821, 51.20059555023907, 51.01941609382628, 61.0245332767566, 61.35646738981207, 60.13387634356816, 53.416626721620545, 53.660179216414676, 53.24283246695994, 42.281957532900066, 41.96838145951429, 41.92464070270458, 60.86100857456525, 61.13390807745357, 60.871444826324776, 51.77651820083459, 51.09743436177571, 52.265003373225525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14721000317788466, "mean_inference_ms": 0.711965557910081, "mean_action_processing_ms": 0.10213480031744675, "mean_env_wait_ms": 0.8461885307496426, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 890000, "timesteps_this_iter": 0, "agent_timesteps_total": 2670000, "timers": {"sample_time_ms": 10678.044, "sample_throughput": 468.251, "load_time_ms": 0.35, "load_throughput": 14277995.643, "learn_time_ms": 1698.3, "learn_throughput": 2944.121, "update_time_ms": 8.027}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1555579666323415e-34, "cur_lr": 0.0005000000000000001, "total_loss": 8.849579811096191, "policy_loss": 7.032836990887859e-05, "vf_loss": 8.94308385848999, "vf_explained_var": 0.01308717131614685, "kl": 0.007279371330555516, "entropy": 9.357434463500976, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 890000, "num_agent_steps_sampled": 2670000, "num_steps_trained": 890000, "num_agent_steps_trained": 2670000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2638, "training_iteration": 178, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-41-32", "timestamp": 1706229692, "time_this_iter_s": 11.201786279678345, "time_total_s": 1931.1686129570007, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824BAEE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1931.1686129570007, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 9.5375, "ram_util_percent": 52.175}}
{"episode_reward_max": 198.6723362870979, "episode_reward_min": -256.5152857080102, "episode_reward_mean": 140.05732244911428, "episode_len_mean": 492.31, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"shared_policy": -91.98327746242285}, "policy_reward_max": {"shared_policy": 66.40163202638117}, "policy_reward_mean": {"shared_policy": 46.68577414970475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [147.88208197802297, 146.20915407873667, 157.2744152639063, 172.7986135575919, 187.85309084877363, 117.3425043062307, 176.98676590994015, 145.7889636009933, 168.6829002201558, 172.6975429635493, 156.22036604955767, 146.86148780351533, 169.44199831411248, 148.2544911354778, 124.56496933475135, 148.12574663572022, 145.84089571237536, 138.6196322664619, 153.71216822601855, 184.14814977347862, 161.06059417128566, 175.80973009206375, 198.6723362870979, 163.89182837260887, 142.94742738641813, 133.06170957535505, 127.73409932106732, 156.74181817285734, 151.6120549868792, 151.94303973019123, 164.57658575475207, 145.9157095099798, 127.86065397039053, 164.91286965459582, 136.0639606751503, 149.62627182900917, 148.05987896863383, 166.92585071548814, 157.49493829160937, 176.92701187171033, 150.5104188472032, 152.60225724894534, 168.65872036665655, 172.81308143585923, 131.80970044434048, 159.18468885309994, 132.14511024579403, 169.75794443488115, 157.14123216364524, 157.32732587121427, 151.85889359936115, 178.08973778411737, 100.63684172742069, 145.04488966986546, 144.69434611126795, 97.57211121171713, 155.6471461839973, 163.89089701476038, 163.48326853290203, 161.75507161486874, 153.90321714431028, 106.12545904796569, -256.5152857080102, 139.33248609490698, 161.17331242002552, 145.14927507750684, 161.29667130857698, 118.53036172688007, -214.45787549903616, 158.9295799508692, 138.87261439627042, 159.1621043374763, 118.9647915083915, 151.22308809310198, 142.30483235046242, 138.84098507463938, 163.42574821412566, 138.62091755121952, 111.17841554665937, 180.81059439852814, 163.09948034206184, 156.8813878558576, 142.11863132566205, 152.96947919577332, 182.5148770101368, 160.3196384049953, 126.17497969511894, 182.8663614783437, 155.13895593583567, 169.66863979212954, 156.5838064709678, -234.48274227604273, 145.59694190882152, 146.60490405932075, 105.40233297646043, 148.09806390199813, 152.44150372967104, 170.3739725737831, 128.1789854541421, 152.54276136308928], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 140, 500, 500, 500, 500, 500, 399, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 192, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [49.66317508369683, 49.203864410519586, 49.015042483806596, 48.87139572948216, 48.08185982704161, 49.25589852221309, 52.34268916894992, 52.38547159483035, 52.54625450012584, 56.97828715542953, 57.67523927489917, 58.14508712726335, 62.7664981385072, 62.89141626780231, 62.19517644246419, 39.320365293417126, 38.942857541143894, 39.079281471669674, 58.60914340615271, 59.20482332259415, 59.1727991811931, 48.73994883646567, 48.49684779097636, 48.55216697355111, 56.019876549641296, 56.30054137359063, 56.3624822969238, 57.48324963947137, 57.43047699083884, 57.78381633323927, 52.301902208477244, 52.14222671091555, 51.776237130165086, 48.27016265193622, 49.1737860540549, 49.41753909752394, 56.494995576639965, 56.32534309973319, 56.621659637739256, 49.18696022530396, 49.38435851534207, 49.68317239483197, 41.537195568283394, 41.39795583983262, 41.62981792663534, 49.09048653642337, 49.421642380456134, 49.61361771884064, 48.495862153669194, 48.63825064649184, 48.70678291221459, 46.27203567326069, 46.33645357936621, 46.01114301383495, 51.167223587632165, 51.16074679791926, 51.38419784046708, 61.21339817345141, 61.799722507596, 61.135029092431054, 53.65931579222281, 53.936228317519024, 53.46505006154378, 58.69755409844218, 58.394235178828225, 58.717940814793096, 66.40163202638117, 66.13245505591233, 66.1382492048045, 54.77941198988508, 54.80351778228457, 54.308898600439235, 47.2006682207187, 47.885125972641006, 47.86163319305827, 44.50102043772736, 44.42594157035151, 44.13474756727615, 42.544032891591385, 42.57793131967385, 42.61213510980208, 52.29134356975554, 52.65636505000292, 51.794109553098664, 50.90016132903595, 50.36266974856456, 50.349223909278706, 50.89400315781434, 50.47065163155396, 50.578384940822914, 54.59068919718264, 55.161347977817044, 54.82454857975243, 48.139753599961594, 48.99227181899671, 48.78368409102161, 42.48878576854864, 42.41987251738706, 42.95199568445483, 54.62910274167855, 55.14240672936042, 55.14136018355687, 45.20882053176561, 45.36572581032911, 45.48941433305541, 49.69345771769683, 49.76863243679206, 50.16418167452018, 49.47072666448851, 48.97588205834229, 49.613270245802894, 55.5738986035188, 55.5057401706775, 55.846211941291884, 52.42185938855012, 52.18824293216069, 52.884835970898465, 58.71264714499314, 58.99713258941968, 59.217232137297586, 50.13377235084771, 50.329233229160295, 50.04741326719521, 50.82328685869773, 50.6468237315615, 51.132146658686295, 56.37435149401425, 56.09011910855769, 56.1942497640848, 57.50009213636319, 57.76376836995284, 57.54922092954318, 43.732734998067215, 44.058269043763474, 44.01869640251, 52.72924605508645, 53.23814066809912, 53.21730212991436, 44.21356956722835, 44.15497838767865, 43.77656229088703, 56.96166135867436, 56.34665728112061, 56.44962579508622, 52.522345439530895, 52.15907526016234, 52.45981146395205, 52.16804246604441, 52.79866146109997, 52.36062194406985, 50.41448552906512, 50.4232561290264, 51.02115194126962, 59.30200670659541, 59.13944151997565, 59.64828955754636, 33.655664497986436, 33.459067303687334, 33.52210992574692, 47.93230288227399, 48.65924822663267, 48.4533385609587, 48.10427522162597, 48.211702908078834, 48.37836798156302, 32.181627720594406, 33.0219706222415, 32.368512868881226, 51.771269758542374, 51.56920852263768, 52.306667902817324, 54.74321221063535, 54.22064506510894, 54.92703973901614, 54.5758082618316, 54.2564833809932, 54.65097689007719, 53.23304823040961, 54.28950704541056, 54.23251633904873, 51.233631675442055, 51.766822827359036, 50.90276264150937, 35.776236616385475, 35.511087258656815, 34.8381351729234, -82.14186005294323, -82.39014819264412, -91.98327746242285, 46.236827209591866, 46.53307780995965, 46.56258107535541, 53.47684401025374, 53.9146556140234, 53.78181279574831, 48.715838049228, 48.60432708139221, 47.8291099468867, 53.433709124724075, 53.9094372826318, 53.9535249012212, 39.1829364746809, 39.562244936823845, 39.78518031537533, -71.59439268584053, -71.42379100496571, -71.43969180822994, 53.01545762891571, 52.97167116279404, 52.94245115915935, 46.51320535084233, 45.957536935806274, 46.40187210962176, 53.45502519762765, 52.948088946441814, 52.758990193406746, 39.463844031095505, 39.73109928146005, 39.76984819583595, 50.60428859045108, 50.45190041263898, 50.16689909001191, 47.622524261474595, 46.867613628506646, 47.81469446048139, 46.012033124764756, 46.51901773487528, 46.309934214999274, 54.35510961214702, 54.55286016563575, 54.51777843634288, 46.45652863383293, 46.44836089760065, 45.71602801978588, 37.341038629257426, 36.894602221747235, 36.942774695654705, 60.317999400198445, 60.03679079562424, 60.45580420270561, 54.601545056890856, 54.52477949361007, 53.973155791560814, 52.21465312192838, 52.34099900598328, 52.32573572794597, 47.21005373448132, 47.46057853847741, 47.447999052703366, 50.74946755170821, 51.20059555023907, 51.01941609382628, 61.0245332767566, 61.35646738981207, 60.13387634356816, 53.416626721620545, 53.660179216414676, 53.24283246695994, 42.281957532900066, 41.96838145951429, 41.92464070270458, 60.86100857456525, 61.13390807745357, 60.871444826324776, 51.77651820083459, 51.09743436177571, 52.265003373225525, 56.16950879991053, 56.536874465644345, 56.96225652657448, 52.0581595674157, 52.22321488708256, 52.302432016469524, -74.21643082921705, -75.34288733204207, -84.92342411478361, 48.392290865381554, 48.95871059161921, 48.24594045182069, 48.686828598380075, 49.08058133348821, 48.83749412745236, 35.093541661898286, 35.01101556668678, 35.29777574787536, 49.03745293617247, 49.56129297148435, 49.49931799434124, 50.98986294989784, 50.669972998400524, 50.78166778137286, 56.74097794294356, 56.80726289004086, 56.82573174079879, 42.47497037053108, 43.0778868868947, 42.62612819671631, 50.9838723341624, 50.98585653553407, 50.57303249339263]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14722608818737157, "mean_inference_ms": 0.7120389018631406, "mean_action_processing_ms": 0.102133926108806, "mean_env_wait_ms": 0.846111171606036, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 895000, "timesteps_this_iter": 0, "agent_timesteps_total": 2685000, "timers": {"sample_time_ms": 10786.876, "sample_throughput": 463.526, "load_time_ms": 0.35, "load_throughput": 14277995.643, "learn_time_ms": 1720.63, "learn_throughput": 2905.912, "update_time_ms": 8.189}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1555579666323415e-34, "cur_lr": 0.0005000000000000001, "total_loss": 122.71497344970703, "policy_loss": -0.0004622001394924302, "vf_loss": 122.81244277954102, "vf_explained_var": -0.001091146469116211, "kl": 0.0076357153710441775, "entropy": 9.700802612304688, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 895000, "num_agent_steps_sampled": 2685000, "num_steps_trained": 895000, "num_agent_steps_trained": 2685000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2649, "training_iteration": 179, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-41-44", "timestamp": 1706229704, "time_this_iter_s": 12.13738465309143, "time_total_s": 1943.3059976100922, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202821C6790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1943.3059976100922, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 9.876470588235293, "ram_util_percent": 52.19411764705882}}
{"episode_reward_max": 198.6723362870979, "episode_reward_min": -256.5152857080102, "episode_reward_mean": 138.3531943996559, "episode_len_mean": 492.31, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -91.98327746242285}, "policy_reward_max": {"shared_policy": 66.40163202638117}, "policy_reward_mean": {"shared_policy": 46.11773146655197}, "custom_metrics": {}, "hist_stats": {"episode_reward": [156.22036604955767, 146.86148780351533, 169.44199831411248, 148.2544911354778, 124.56496933475135, 148.12574663572022, 145.84089571237536, 138.6196322664619, 153.71216822601855, 184.14814977347862, 161.06059417128566, 175.80973009206375, 198.6723362870979, 163.89182837260887, 142.94742738641813, 133.06170957535505, 127.73409932106732, 156.74181817285734, 151.6120549868792, 151.94303973019123, 164.57658575475207, 145.9157095099798, 127.86065397039053, 164.91286965459582, 136.0639606751503, 149.62627182900917, 148.05987896863383, 166.92585071548814, 157.49493829160937, 176.92701187171033, 150.5104188472032, 152.60225724894534, 168.65872036665655, 172.81308143585923, 131.80970044434048, 159.18468885309994, 132.14511024579403, 169.75794443488115, 157.14123216364524, 157.32732587121427, 151.85889359936115, 178.08973778411737, 100.63684172742069, 145.04488966986546, 144.69434611126795, 97.57211121171713, 155.6471461839973, 163.89089701476038, 163.48326853290203, 161.75507161486874, 153.90321714431028, 106.12545904796569, -256.5152857080102, 139.33248609490698, 161.17331242002552, 145.14927507750684, 161.29667130857698, 118.53036172688007, -214.45787549903616, 158.9295799508692, 138.87261439627042, 159.1621043374763, 118.9647915083915, 151.22308809310198, 142.30483235046242, 138.84098507463938, 163.42574821412566, 138.62091755121952, 111.17841554665937, 180.81059439852814, 163.09948034206184, 156.8813878558576, 142.11863132566205, 152.96947919577332, 182.5148770101368, 160.3196384049953, 126.17497969511894, 182.8663614783437, 155.13895593583567, 169.66863979212954, 156.5838064709678, -234.48274227604273, 145.59694190882152, 146.60490405932075, 105.40233297646043, 148.09806390199813, 152.44150372967104, 170.3739725737831, 128.1789854541421, 152.54276136308928, 127.04397269058971, 125.49797632172704, 138.58505168557153, 141.60240403935322, 111.79963500611484, 142.53571774996843, 165.81206005066645, 177.84288439527168, 154.6059542223809, 137.77757162041965], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 140, 500, 500, 500, 500, 500, 399, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 192, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [52.301902208477244, 52.14222671091555, 51.776237130165086, 48.27016265193622, 49.1737860540549, 49.41753909752394, 56.494995576639965, 56.32534309973319, 56.621659637739256, 49.18696022530396, 49.38435851534207, 49.68317239483197, 41.537195568283394, 41.39795583983262, 41.62981792663534, 49.09048653642337, 49.421642380456134, 49.61361771884064, 48.495862153669194, 48.63825064649184, 48.70678291221459, 46.27203567326069, 46.33645357936621, 46.01114301383495, 51.167223587632165, 51.16074679791926, 51.38419784046708, 61.21339817345141, 61.799722507596, 61.135029092431054, 53.65931579222281, 53.936228317519024, 53.46505006154378, 58.69755409844218, 58.394235178828225, 58.717940814793096, 66.40163202638117, 66.13245505591233, 66.1382492048045, 54.77941198988508, 54.80351778228457, 54.308898600439235, 47.2006682207187, 47.885125972641006, 47.86163319305827, 44.50102043772736, 44.42594157035151, 44.13474756727615, 42.544032891591385, 42.57793131967385, 42.61213510980208, 52.29134356975554, 52.65636505000292, 51.794109553098664, 50.90016132903595, 50.36266974856456, 50.349223909278706, 50.89400315781434, 50.47065163155396, 50.578384940822914, 54.59068919718264, 55.161347977817044, 54.82454857975243, 48.139753599961594, 48.99227181899671, 48.78368409102161, 42.48878576854864, 42.41987251738706, 42.95199568445483, 54.62910274167855, 55.14240672936042, 55.14136018355687, 45.20882053176561, 45.36572581032911, 45.48941433305541, 49.69345771769683, 49.76863243679206, 50.16418167452018, 49.47072666448851, 48.97588205834229, 49.613270245802894, 55.5738986035188, 55.5057401706775, 55.846211941291884, 52.42185938855012, 52.18824293216069, 52.884835970898465, 58.71264714499314, 58.99713258941968, 59.217232137297586, 50.13377235084771, 50.329233229160295, 50.04741326719521, 50.82328685869773, 50.6468237315615, 51.132146658686295, 56.37435149401425, 56.09011910855769, 56.1942497640848, 57.50009213636319, 57.76376836995284, 57.54922092954318, 43.732734998067215, 44.058269043763474, 44.01869640251, 52.72924605508645, 53.23814066809912, 53.21730212991436, 44.21356956722835, 44.15497838767865, 43.77656229088703, 56.96166135867436, 56.34665728112061, 56.44962579508622, 52.522345439530895, 52.15907526016234, 52.45981146395205, 52.16804246604441, 52.79866146109997, 52.36062194406985, 50.41448552906512, 50.4232561290264, 51.02115194126962, 59.30200670659541, 59.13944151997565, 59.64828955754636, 33.655664497986436, 33.459067303687334, 33.52210992574692, 47.93230288227399, 48.65924822663267, 48.4533385609587, 48.10427522162597, 48.211702908078834, 48.37836798156302, 32.181627720594406, 33.0219706222415, 32.368512868881226, 51.771269758542374, 51.56920852263768, 52.306667902817324, 54.74321221063535, 54.22064506510894, 54.92703973901614, 54.5758082618316, 54.2564833809932, 54.65097689007719, 53.23304823040961, 54.28950704541056, 54.23251633904873, 51.233631675442055, 51.766822827359036, 50.90276264150937, 35.776236616385475, 35.511087258656815, 34.8381351729234, -82.14186005294323, -82.39014819264412, -91.98327746242285, 46.236827209591866, 46.53307780995965, 46.56258107535541, 53.47684401025374, 53.9146556140234, 53.78181279574831, 48.715838049228, 48.60432708139221, 47.8291099468867, 53.433709124724075, 53.9094372826318, 53.9535249012212, 39.1829364746809, 39.562244936823845, 39.78518031537533, -71.59439268584053, -71.42379100496571, -71.43969180822994, 53.01545762891571, 52.97167116279404, 52.94245115915935, 46.51320535084233, 45.957536935806274, 46.40187210962176, 53.45502519762765, 52.948088946441814, 52.758990193406746, 39.463844031095505, 39.73109928146005, 39.76984819583595, 50.60428859045108, 50.45190041263898, 50.16689909001191, 47.622524261474595, 46.867613628506646, 47.81469446048139, 46.012033124764756, 46.51901773487528, 46.309934214999274, 54.35510961214702, 54.55286016563575, 54.51777843634288, 46.45652863383293, 46.44836089760065, 45.71602801978588, 37.341038629257426, 36.894602221747235, 36.942774695654705, 60.317999400198445, 60.03679079562424, 60.45580420270561, 54.601545056890856, 54.52477949361007, 53.973155791560814, 52.21465312192838, 52.34099900598328, 52.32573572794597, 47.21005373448132, 47.46057853847741, 47.447999052703366, 50.74946755170821, 51.20059555023907, 51.01941609382628, 61.0245332767566, 61.35646738981207, 60.13387634356816, 53.416626721620545, 53.660179216414676, 53.24283246695994, 42.281957532900066, 41.96838145951429, 41.92464070270458, 60.86100857456525, 61.13390807745357, 60.871444826324776, 51.77651820083459, 51.09743436177571, 52.265003373225525, 56.16950879991053, 56.536874465644345, 56.96225652657448, 52.0581595674157, 52.22321488708256, 52.302432016469524, -74.21643082921705, -75.34288733204207, -84.92342411478361, 48.392290865381554, 48.95871059161921, 48.24594045182069, 48.686828598380075, 49.08058133348821, 48.83749412745236, 35.093541661898286, 35.01101556668678, 35.29777574787536, 49.03745293617247, 49.56129297148435, 49.49931799434124, 50.98986294989784, 50.669972998400524, 50.78166778137286, 56.74097794294356, 56.80726289004086, 56.82573174079879, 42.47497037053108, 43.0778868868947, 42.62612819671631, 50.9838723341624, 50.98585653553407, 50.57303249339263, 42.0579303925236, 42.601080386278525, 42.384961911787585, 40.94885390996933, 42.495316814631224, 42.053805597126484, 46.163071162998676, 46.23502995073795, 46.18695057183504, 47.2779904976487, 47.451530221849666, 46.87288331985472, 37.08394531905651, 36.93614658713341, 37.77954309992492, 47.69593495937686, 47.21309640506904, 47.62668638552229, 55.42632921288411, 54.99726886550586, 55.388461972276374, 59.05829422672589, 59.36153013755877, 59.42306003098686, 51.3413674533367, 51.514295205473886, 51.750291563570485, 45.937302375833184, 46.17882871317366, 45.66144053141275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1472275392864043, "mean_inference_ms": 0.7120651514655001, "mean_action_processing_ms": 0.10212710931841458, "mean_env_wait_ms": 0.8460009292799349, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 900000, "timesteps_this_iter": 0, "agent_timesteps_total": 2700000, "timers": {"sample_time_ms": 10732.573, "sample_throughput": 465.872, "load_time_ms": 0.251, "load_throughput": 19957670.346, "learn_time_ms": 1722.421, "learn_throughput": 2902.89, "update_time_ms": 8.287}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1555579666323415e-34, "cur_lr": 0.0005000000000000001, "total_loss": 8.553470230102539, "policy_loss": -0.001509038571392507, "vf_loss": 8.650448226928711, "vf_explained_var": 0.010376840829849243, "kl": 0.00403364382223075, "entropy": 9.546893978118897, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 900000, "num_agent_steps_sampled": 2700000, "num_steps_trained": 900000, "num_agent_steps_trained": 2700000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2659, "training_iteration": 180, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-41-54", "timestamp": 1706229714, "time_this_iter_s": 9.937898397445679, "time_total_s": 1953.2438960075378, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028379ECA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1953.2438960075378, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 9.733333333333333, "ram_util_percent": 52.286666666666655}}
{"episode_reward_max": 198.6723362870979, "episode_reward_min": -256.5152857080102, "episode_reward_mean": 137.06086751142342, "episode_len_mean": 492.31, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -91.98327746242285}, "policy_reward_max": {"shared_policy": 66.40163202638117}, "policy_reward_mean": {"shared_policy": 45.686955837141134}, "custom_metrics": {}, "hist_stats": {"episode_reward": [161.06059417128566, 175.80973009206375, 198.6723362870979, 163.89182837260887, 142.94742738641813, 133.06170957535505, 127.73409932106732, 156.74181817285734, 151.6120549868792, 151.94303973019123, 164.57658575475207, 145.9157095099798, 127.86065397039053, 164.91286965459582, 136.0639606751503, 149.62627182900917, 148.05987896863383, 166.92585071548814, 157.49493829160937, 176.92701187171033, 150.5104188472032, 152.60225724894534, 168.65872036665655, 172.81308143585923, 131.80970044434048, 159.18468885309994, 132.14511024579403, 169.75794443488115, 157.14123216364524, 157.32732587121427, 151.85889359936115, 178.08973778411737, 100.63684172742069, 145.04488966986546, 144.69434611126795, 97.57211121171713, 155.6471461839973, 163.89089701476038, 163.48326853290203, 161.75507161486874, 153.90321714431028, 106.12545904796569, -256.5152857080102, 139.33248609490698, 161.17331242002552, 145.14927507750684, 161.29667130857698, 118.53036172688007, -214.45787549903616, 158.9295799508692, 138.87261439627042, 159.1621043374763, 118.9647915083915, 151.22308809310198, 142.30483235046242, 138.84098507463938, 163.42574821412566, 138.62091755121952, 111.17841554665937, 180.81059439852814, 163.09948034206184, 156.8813878558576, 142.11863132566205, 152.96947919577332, 182.5148770101368, 160.3196384049953, 126.17497969511894, 182.8663614783437, 155.13895593583567, 169.66863979212954, 156.5838064709678, -234.48274227604273, 145.59694190882152, 146.60490405932075, 105.40233297646043, 148.09806390199813, 152.44150372967104, 170.3739725737831, 128.1789854541421, 152.54276136308928, 127.04397269058971, 125.49797632172704, 138.58505168557153, 141.60240403935322, 111.79963500611484, 142.53571774996843, 165.81206005066645, 177.84288439527168, 154.6059542223809, 137.77757162041965, 178.11117494851345, 111.683245845139, 153.67821407876934, 147.20154132694014, 103.79947336204347, 153.32773325592274, 140.22151399031281, 118.53082152083513, 141.36228552646915, 138.64121257327506], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 140, 500, 500, 500, 500, 500, 399, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 192, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [53.65931579222281, 53.936228317519024, 53.46505006154378, 58.69755409844218, 58.394235178828225, 58.717940814793096, 66.40163202638117, 66.13245505591233, 66.1382492048045, 54.77941198988508, 54.80351778228457, 54.308898600439235, 47.2006682207187, 47.885125972641006, 47.86163319305827, 44.50102043772736, 44.42594157035151, 44.13474756727615, 42.544032891591385, 42.57793131967385, 42.61213510980208, 52.29134356975554, 52.65636505000292, 51.794109553098664, 50.90016132903595, 50.36266974856456, 50.349223909278706, 50.89400315781434, 50.47065163155396, 50.578384940822914, 54.59068919718264, 55.161347977817044, 54.82454857975243, 48.139753599961594, 48.99227181899671, 48.78368409102161, 42.48878576854864, 42.41987251738706, 42.95199568445483, 54.62910274167855, 55.14240672936042, 55.14136018355687, 45.20882053176561, 45.36572581032911, 45.48941433305541, 49.69345771769683, 49.76863243679206, 50.16418167452018, 49.47072666448851, 48.97588205834229, 49.613270245802894, 55.5738986035188, 55.5057401706775, 55.846211941291884, 52.42185938855012, 52.18824293216069, 52.884835970898465, 58.71264714499314, 58.99713258941968, 59.217232137297586, 50.13377235084771, 50.329233229160295, 50.04741326719521, 50.82328685869773, 50.6468237315615, 51.132146658686295, 56.37435149401425, 56.09011910855769, 56.1942497640848, 57.50009213636319, 57.76376836995284, 57.54922092954318, 43.732734998067215, 44.058269043763474, 44.01869640251, 52.72924605508645, 53.23814066809912, 53.21730212991436, 44.21356956722835, 44.15497838767865, 43.77656229088703, 56.96166135867436, 56.34665728112061, 56.44962579508622, 52.522345439530895, 52.15907526016234, 52.45981146395205, 52.16804246604441, 52.79866146109997, 52.36062194406985, 50.41448552906512, 50.4232561290264, 51.02115194126962, 59.30200670659541, 59.13944151997565, 59.64828955754636, 33.655664497986436, 33.459067303687334, 33.52210992574692, 47.93230288227399, 48.65924822663267, 48.4533385609587, 48.10427522162597, 48.211702908078834, 48.37836798156302, 32.181627720594406, 33.0219706222415, 32.368512868881226, 51.771269758542374, 51.56920852263768, 52.306667902817324, 54.74321221063535, 54.22064506510894, 54.92703973901614, 54.5758082618316, 54.2564833809932, 54.65097689007719, 53.23304823040961, 54.28950704541056, 54.23251633904873, 51.233631675442055, 51.766822827359036, 50.90276264150937, 35.776236616385475, 35.511087258656815, 34.8381351729234, -82.14186005294323, -82.39014819264412, -91.98327746242285, 46.236827209591866, 46.53307780995965, 46.56258107535541, 53.47684401025374, 53.9146556140234, 53.78181279574831, 48.715838049228, 48.60432708139221, 47.8291099468867, 53.433709124724075, 53.9094372826318, 53.9535249012212, 39.1829364746809, 39.562244936823845, 39.78518031537533, -71.59439268584053, -71.42379100496571, -71.43969180822994, 53.01545762891571, 52.97167116279404, 52.94245115915935, 46.51320535084233, 45.957536935806274, 46.40187210962176, 53.45502519762765, 52.948088946441814, 52.758990193406746, 39.463844031095505, 39.73109928146005, 39.76984819583595, 50.60428859045108, 50.45190041263898, 50.16689909001191, 47.622524261474595, 46.867613628506646, 47.81469446048139, 46.012033124764756, 46.51901773487528, 46.309934214999274, 54.35510961214702, 54.55286016563575, 54.51777843634288, 46.45652863383293, 46.44836089760065, 45.71602801978588, 37.341038629257426, 36.894602221747235, 36.942774695654705, 60.317999400198445, 60.03679079562424, 60.45580420270561, 54.601545056890856, 54.52477949361007, 53.973155791560814, 52.21465312192838, 52.34099900598328, 52.32573572794597, 47.21005373448132, 47.46057853847741, 47.447999052703366, 50.74946755170821, 51.20059555023907, 51.01941609382628, 61.0245332767566, 61.35646738981207, 60.13387634356816, 53.416626721620545, 53.660179216414676, 53.24283246695994, 42.281957532900066, 41.96838145951429, 41.92464070270458, 60.86100857456525, 61.13390807745357, 60.871444826324776, 51.77651820083459, 51.09743436177571, 52.265003373225525, 56.16950879991053, 56.536874465644345, 56.96225652657448, 52.0581595674157, 52.22321488708256, 52.302432016469524, -74.21643082921705, -75.34288733204207, -84.92342411478361, 48.392290865381554, 48.95871059161921, 48.24594045182069, 48.686828598380075, 49.08058133348821, 48.83749412745236, 35.093541661898286, 35.01101556668678, 35.29777574787536, 49.03745293617247, 49.56129297148435, 49.49931799434124, 50.98986294989784, 50.669972998400524, 50.78166778137286, 56.74097794294356, 56.80726289004086, 56.82573174079879, 42.47497037053108, 43.0778868868947, 42.62612819671631, 50.9838723341624, 50.98585653553407, 50.57303249339263, 42.0579303925236, 42.601080386278525, 42.384961911787585, 40.94885390996933, 42.495316814631224, 42.053805597126484, 46.163071162998676, 46.23502995073795, 46.18695057183504, 47.2779904976487, 47.451530221849666, 46.87288331985472, 37.08394531905651, 36.93614658713341, 37.77954309992492, 47.69593495937686, 47.21309640506904, 47.62668638552229, 55.42632921288411, 54.99726886550586, 55.388461972276374, 59.05829422672589, 59.36153013755877, 59.42306003098686, 51.3413674533367, 51.514295205473886, 51.750291563570485, 45.937302375833184, 46.17882871317366, 45.66144053141275, 59.41980498656629, 59.27526985108851, 59.416100110858665, 36.888789306084306, 37.28680133322874, 37.507655205825955, 51.47941858631869, 50.95555381973584, 51.24324167271455, 49.07295918713014, 49.023358287910625, 49.10522385189931, 34.75230165074268, 33.976370881001145, 35.070800830299646, 51.46072641511758, 50.593596180280045, 51.27341066052516, 46.75976329669356, 46.85878127068281, 46.60296942293644, 39.23902707795301, 39.444463724891335, 39.847330717990786, 47.266139734536395, 46.87344807386397, 47.22269771806894, 46.52287310610214, 46.6110931119571, 45.5072463552157]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1472246648706481, "mean_inference_ms": 0.7120864426820556, "mean_action_processing_ms": 0.10212265427978882, "mean_env_wait_ms": 0.8458971801687234, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 905000, "timesteps_this_iter": 0, "agent_timesteps_total": 2715000, "timers": {"sample_time_ms": 10755.081, "sample_throughput": 464.897, "load_time_ms": 0.251, "load_throughput": 19957670.346, "learn_time_ms": 1709.104, "learn_throughput": 2925.509, "update_time_ms": 7.943}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.777789833161707e-35, "cur_lr": 0.0005000000000000001, "total_loss": 6.894714879989624, "policy_loss": -0.0009620393309978326, "vf_loss": 6.993401098251343, "vf_explained_var": 0.009046018123626709, "kl": 0.003552569879731869, "entropy": 9.772427177429199, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 905000, "num_agent_steps_sampled": 2715000, "num_steps_trained": 905000, "num_agent_steps_trained": 2715000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2669, "training_iteration": 181, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-42-04", "timestamp": 1706229724, "time_this_iter_s": 10.260074377059937, "time_total_s": 1963.5039703845978, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028379E9D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1963.5039703845978, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 12.200000000000001, "ram_util_percent": 52.028571428571425}}
{"episode_reward_max": 182.8663614783437, "episode_reward_min": -256.5152857080102, "episode_reward_mean": 136.16645976364669, "episode_len_mean": 492.31, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -91.98327746242285}, "policy_reward_max": {"shared_policy": 61.35646738981207}, "policy_reward_mean": {"shared_policy": 45.388819921215564}, "custom_metrics": {}, "hist_stats": {"episode_reward": [164.57658575475207, 145.9157095099798, 127.86065397039053, 164.91286965459582, 136.0639606751503, 149.62627182900917, 148.05987896863383, 166.92585071548814, 157.49493829160937, 176.92701187171033, 150.5104188472032, 152.60225724894534, 168.65872036665655, 172.81308143585923, 131.80970044434048, 159.18468885309994, 132.14511024579403, 169.75794443488115, 157.14123216364524, 157.32732587121427, 151.85889359936115, 178.08973778411737, 100.63684172742069, 145.04488966986546, 144.69434611126795, 97.57211121171713, 155.6471461839973, 163.89089701476038, 163.48326853290203, 161.75507161486874, 153.90321714431028, 106.12545904796569, -256.5152857080102, 139.33248609490698, 161.17331242002552, 145.14927507750684, 161.29667130857698, 118.53036172688007, -214.45787549903616, 158.9295799508692, 138.87261439627042, 159.1621043374763, 118.9647915083915, 151.22308809310198, 142.30483235046242, 138.84098507463938, 163.42574821412566, 138.62091755121952, 111.17841554665937, 180.81059439852814, 163.09948034206184, 156.8813878558576, 142.11863132566205, 152.96947919577332, 182.5148770101368, 160.3196384049953, 126.17497969511894, 182.8663614783437, 155.13895593583567, 169.66863979212954, 156.5838064709678, -234.48274227604273, 145.59694190882152, 146.60490405932075, 105.40233297646043, 148.09806390199813, 152.44150372967104, 170.3739725737831, 128.1789854541421, 152.54276136308928, 127.04397269058971, 125.49797632172704, 138.58505168557153, 141.60240403935322, 111.79963500611484, 142.53571774996843, 165.81206005066645, 177.84288439527168, 154.6059542223809, 137.77757162041965, 178.11117494851345, 111.683245845139, 153.67821407876934, 147.20154132694014, 103.79947336204347, 153.32773325592274, 140.22151399031281, 118.53082152083513, 141.36228552646915, 138.64121257327506, 168.55672069266438, 129.47626756504172, 120.69183960556984, 148.6197771877048, 129.92779694125048, 169.44614113587878, 176.51491199806333, 140.04160647653043, 150.37507588043815, 140.38372583501038], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 140, 500, 500, 500, 500, 500, 399, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 192, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [54.59068919718264, 55.161347977817044, 54.82454857975243, 48.139753599961594, 48.99227181899671, 48.78368409102161, 42.48878576854864, 42.41987251738706, 42.95199568445483, 54.62910274167855, 55.14240672936042, 55.14136018355687, 45.20882053176561, 45.36572581032911, 45.48941433305541, 49.69345771769683, 49.76863243679206, 50.16418167452018, 49.47072666448851, 48.97588205834229, 49.613270245802894, 55.5738986035188, 55.5057401706775, 55.846211941291884, 52.42185938855012, 52.18824293216069, 52.884835970898465, 58.71264714499314, 58.99713258941968, 59.217232137297586, 50.13377235084771, 50.329233229160295, 50.04741326719521, 50.82328685869773, 50.6468237315615, 51.132146658686295, 56.37435149401425, 56.09011910855769, 56.1942497640848, 57.50009213636319, 57.76376836995284, 57.54922092954318, 43.732734998067215, 44.058269043763474, 44.01869640251, 52.72924605508645, 53.23814066809912, 53.21730212991436, 44.21356956722835, 44.15497838767865, 43.77656229088703, 56.96166135867436, 56.34665728112061, 56.44962579508622, 52.522345439530895, 52.15907526016234, 52.45981146395205, 52.16804246604441, 52.79866146109997, 52.36062194406985, 50.41448552906512, 50.4232561290264, 51.02115194126962, 59.30200670659541, 59.13944151997565, 59.64828955754636, 33.655664497986436, 33.459067303687334, 33.52210992574692, 47.93230288227399, 48.65924822663267, 48.4533385609587, 48.10427522162597, 48.211702908078834, 48.37836798156302, 32.181627720594406, 33.0219706222415, 32.368512868881226, 51.771269758542374, 51.56920852263768, 52.306667902817324, 54.74321221063535, 54.22064506510894, 54.92703973901614, 54.5758082618316, 54.2564833809932, 54.65097689007719, 53.23304823040961, 54.28950704541056, 54.23251633904873, 51.233631675442055, 51.766822827359036, 50.90276264150937, 35.776236616385475, 35.511087258656815, 34.8381351729234, -82.14186005294323, -82.39014819264412, -91.98327746242285, 46.236827209591866, 46.53307780995965, 46.56258107535541, 53.47684401025374, 53.9146556140234, 53.78181279574831, 48.715838049228, 48.60432708139221, 47.8291099468867, 53.433709124724075, 53.9094372826318, 53.9535249012212, 39.1829364746809, 39.562244936823845, 39.78518031537533, -71.59439268584053, -71.42379100496571, -71.43969180822994, 53.01545762891571, 52.97167116279404, 52.94245115915935, 46.51320535084233, 45.957536935806274, 46.40187210962176, 53.45502519762765, 52.948088946441814, 52.758990193406746, 39.463844031095505, 39.73109928146005, 39.76984819583595, 50.60428859045108, 50.45190041263898, 50.16689909001191, 47.622524261474595, 46.867613628506646, 47.81469446048139, 46.012033124764756, 46.51901773487528, 46.309934214999274, 54.35510961214702, 54.55286016563575, 54.51777843634288, 46.45652863383293, 46.44836089760065, 45.71602801978588, 37.341038629257426, 36.894602221747235, 36.942774695654705, 60.317999400198445, 60.03679079562424, 60.45580420270561, 54.601545056890856, 54.52477949361007, 53.973155791560814, 52.21465312192838, 52.34099900598328, 52.32573572794597, 47.21005373448132, 47.46057853847741, 47.447999052703366, 50.74946755170821, 51.20059555023907, 51.01941609382628, 61.0245332767566, 61.35646738981207, 60.13387634356816, 53.416626721620545, 53.660179216414676, 53.24283246695994, 42.281957532900066, 41.96838145951429, 41.92464070270458, 60.86100857456525, 61.13390807745357, 60.871444826324776, 51.77651820083459, 51.09743436177571, 52.265003373225525, 56.16950879991053, 56.536874465644345, 56.96225652657448, 52.0581595674157, 52.22321488708256, 52.302432016469524, -74.21643082921705, -75.34288733204207, -84.92342411478361, 48.392290865381554, 48.95871059161921, 48.24594045182069, 48.686828598380075, 49.08058133348821, 48.83749412745236, 35.093541661898286, 35.01101556668678, 35.29777574787536, 49.03745293617247, 49.56129297148435, 49.49931799434124, 50.98986294989784, 50.669972998400524, 50.78166778137286, 56.74097794294356, 56.80726289004086, 56.82573174079879, 42.47497037053108, 43.0778868868947, 42.62612819671631, 50.9838723341624, 50.98585653553407, 50.57303249339263, 42.0579303925236, 42.601080386278525, 42.384961911787585, 40.94885390996933, 42.495316814631224, 42.053805597126484, 46.163071162998676, 46.23502995073795, 46.18695057183504, 47.2779904976487, 47.451530221849666, 46.87288331985472, 37.08394531905651, 36.93614658713341, 37.77954309992492, 47.69593495937686, 47.21309640506904, 47.62668638552229, 55.42632921288411, 54.99726886550586, 55.388461972276374, 59.05829422672589, 59.36153013755877, 59.42306003098686, 51.3413674533367, 51.514295205473886, 51.750291563570485, 45.937302375833184, 46.17882871317366, 45.66144053141275, 59.41980498656629, 59.27526985108851, 59.416100110858665, 36.888789306084306, 37.28680133322874, 37.507655205825955, 51.47941858631869, 50.95555381973584, 51.24324167271455, 49.07295918713014, 49.023358287910625, 49.10522385189931, 34.75230165074268, 33.976370881001145, 35.070800830299646, 51.46072641511758, 50.593596180280045, 51.27341066052516, 46.75976329669356, 46.85878127068281, 46.60296942293644, 39.23902707795301, 39.444463724891335, 39.847330717990786, 47.266139734536395, 46.87344807386397, 47.22269771806894, 46.52287310610214, 46.6110931119571, 45.5072463552157, 55.87987780074279, 56.38976875195901, 56.2870741399626, 42.879877040783555, 43.35963216299811, 43.23675836126009, 40.61437103897333, 40.29703076928854, 39.78043779730797, 49.75442040090759, 49.7450705555578, 49.12028623123963, 43.300307366997004, 43.16724094748497, 43.46024862676859, 56.22059269746144, 56.69847681590666, 56.527071622510746, 59.2734442812701, 58.33456668754418, 58.90690102924903, 46.6053025747339, 46.97054075511794, 46.46576314667861, 49.741087456544236, 50.1206196223696, 50.51336880152424, 47.01758701913057, 46.72665932774542, 46.63947948813437]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14722643728181287, "mean_inference_ms": 0.7121330844702514, "mean_action_processing_ms": 0.10211667589947827, "mean_env_wait_ms": 0.8458147665803564, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 910000, "timesteps_this_iter": 0, "agent_timesteps_total": 2730000, "timers": {"sample_time_ms": 10774.427, "sample_throughput": 464.062, "load_time_ms": 0.1, "load_throughput": 50015549.726, "learn_time_ms": 1708.86, "learn_throughput": 2925.928, "update_time_ms": 8.629}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.8888949165808537e-35, "cur_lr": 0.0005000000000000001, "total_loss": 9.517380523681641, "policy_loss": -0.0011836983978554371, "vf_loss": 9.614774799346923, "vf_explained_var": 0.011425662040710449, "kl": 0.003758528718073332, "entropy": 9.621035957336426, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 910000, "num_agent_steps_sampled": 2730000, "num_steps_trained": 910000, "num_agent_steps_trained": 2730000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2679, "training_iteration": 182, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-42-15", "timestamp": 1706229735, "time_this_iter_s": 11.02224063873291, "time_total_s": 1974.5262110233307, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028379E4C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1974.5262110233307, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 11.106250000000001, "ram_util_percent": 51.975}}
{"episode_reward_max": 182.8663614783437, "episode_reward_min": -256.5152857080102, "episode_reward_mean": 135.08828924029658, "episode_len_mean": 492.31, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -91.98327746242285}, "policy_reward_max": {"shared_policy": 61.35646738981207}, "policy_reward_mean": {"shared_policy": 45.02942974676553}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.5104188472032, 152.60225724894534, 168.65872036665655, 172.81308143585923, 131.80970044434048, 159.18468885309994, 132.14511024579403, 169.75794443488115, 157.14123216364524, 157.32732587121427, 151.85889359936115, 178.08973778411737, 100.63684172742069, 145.04488966986546, 144.69434611126795, 97.57211121171713, 155.6471461839973, 163.89089701476038, 163.48326853290203, 161.75507161486874, 153.90321714431028, 106.12545904796569, -256.5152857080102, 139.33248609490698, 161.17331242002552, 145.14927507750684, 161.29667130857698, 118.53036172688007, -214.45787549903616, 158.9295799508692, 138.87261439627042, 159.1621043374763, 118.9647915083915, 151.22308809310198, 142.30483235046242, 138.84098507463938, 163.42574821412566, 138.62091755121952, 111.17841554665937, 180.81059439852814, 163.09948034206184, 156.8813878558576, 142.11863132566205, 152.96947919577332, 182.5148770101368, 160.3196384049953, 126.17497969511894, 182.8663614783437, 155.13895593583567, 169.66863979212954, 156.5838064709678, -234.48274227604273, 145.59694190882152, 146.60490405932075, 105.40233297646043, 148.09806390199813, 152.44150372967104, 170.3739725737831, 128.1789854541421, 152.54276136308928, 127.04397269058971, 125.49797632172704, 138.58505168557153, 141.60240403935322, 111.79963500611484, 142.53571774996843, 165.81206005066645, 177.84288439527168, 154.6059542223809, 137.77757162041965, 178.11117494851345, 111.683245845139, 153.67821407876934, 147.20154132694014, 103.79947336204347, 153.32773325592274, 140.22151399031281, 118.53082152083513, 141.36228552646915, 138.64121257327506, 168.55672069266438, 129.47626756504172, 120.69183960556984, 148.6197771877048, 129.92779694125048, 169.44614113587878, 176.51491199806333, 140.04160647653043, 150.37507588043815, 140.38372583501038, 149.90718429908154, 150.40148308500645, 146.6252349764109, 150.54406935721627, 129.05344554781936, 150.02450582757604, 131.24354859069004, 130.96083493344497, 169.06926625408244, 122.71710603497921], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 140, 500, 500, 500, 500, 500, 399, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 192, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [50.13377235084771, 50.329233229160295, 50.04741326719521, 50.82328685869773, 50.6468237315615, 51.132146658686295, 56.37435149401425, 56.09011910855769, 56.1942497640848, 57.50009213636319, 57.76376836995284, 57.54922092954318, 43.732734998067215, 44.058269043763474, 44.01869640251, 52.72924605508645, 53.23814066809912, 53.21730212991436, 44.21356956722835, 44.15497838767865, 43.77656229088703, 56.96166135867436, 56.34665728112061, 56.44962579508622, 52.522345439530895, 52.15907526016234, 52.45981146395205, 52.16804246604441, 52.79866146109997, 52.36062194406985, 50.41448552906512, 50.4232561290264, 51.02115194126962, 59.30200670659541, 59.13944151997565, 59.64828955754636, 33.655664497986436, 33.459067303687334, 33.52210992574692, 47.93230288227399, 48.65924822663267, 48.4533385609587, 48.10427522162597, 48.211702908078834, 48.37836798156302, 32.181627720594406, 33.0219706222415, 32.368512868881226, 51.771269758542374, 51.56920852263768, 52.306667902817324, 54.74321221063535, 54.22064506510894, 54.92703973901614, 54.5758082618316, 54.2564833809932, 54.65097689007719, 53.23304823040961, 54.28950704541056, 54.23251633904873, 51.233631675442055, 51.766822827359036, 50.90276264150937, 35.776236616385475, 35.511087258656815, 34.8381351729234, -82.14186005294323, -82.39014819264412, -91.98327746242285, 46.236827209591866, 46.53307780995965, 46.56258107535541, 53.47684401025374, 53.9146556140234, 53.78181279574831, 48.715838049228, 48.60432708139221, 47.8291099468867, 53.433709124724075, 53.9094372826318, 53.9535249012212, 39.1829364746809, 39.562244936823845, 39.78518031537533, -71.59439268584053, -71.42379100496571, -71.43969180822994, 53.01545762891571, 52.97167116279404, 52.94245115915935, 46.51320535084233, 45.957536935806274, 46.40187210962176, 53.45502519762765, 52.948088946441814, 52.758990193406746, 39.463844031095505, 39.73109928146005, 39.76984819583595, 50.60428859045108, 50.45190041263898, 50.16689909001191, 47.622524261474595, 46.867613628506646, 47.81469446048139, 46.012033124764756, 46.51901773487528, 46.309934214999274, 54.35510961214702, 54.55286016563575, 54.51777843634288, 46.45652863383293, 46.44836089760065, 45.71602801978588, 37.341038629257426, 36.894602221747235, 36.942774695654705, 60.317999400198445, 60.03679079562424, 60.45580420270561, 54.601545056890856, 54.52477949361007, 53.973155791560814, 52.21465312192838, 52.34099900598328, 52.32573572794597, 47.21005373448132, 47.46057853847741, 47.447999052703366, 50.74946755170821, 51.20059555023907, 51.01941609382628, 61.0245332767566, 61.35646738981207, 60.13387634356816, 53.416626721620545, 53.660179216414676, 53.24283246695994, 42.281957532900066, 41.96838145951429, 41.92464070270458, 60.86100857456525, 61.13390807745357, 60.871444826324776, 51.77651820083459, 51.09743436177571, 52.265003373225525, 56.16950879991053, 56.536874465644345, 56.96225652657448, 52.0581595674157, 52.22321488708256, 52.302432016469524, -74.21643082921705, -75.34288733204207, -84.92342411478361, 48.392290865381554, 48.95871059161921, 48.24594045182069, 48.686828598380075, 49.08058133348821, 48.83749412745236, 35.093541661898286, 35.01101556668678, 35.29777574787536, 49.03745293617247, 49.56129297148435, 49.49931799434124, 50.98986294989784, 50.669972998400524, 50.78166778137286, 56.74097794294356, 56.80726289004086, 56.82573174079879, 42.47497037053108, 43.0778868868947, 42.62612819671631, 50.9838723341624, 50.98585653553407, 50.57303249339263, 42.0579303925236, 42.601080386278525, 42.384961911787585, 40.94885390996933, 42.495316814631224, 42.053805597126484, 46.163071162998676, 46.23502995073795, 46.18695057183504, 47.2779904976487, 47.451530221849666, 46.87288331985472, 37.08394531905651, 36.93614658713341, 37.77954309992492, 47.69593495937686, 47.21309640506904, 47.62668638552229, 55.42632921288411, 54.99726886550586, 55.388461972276374, 59.05829422672589, 59.36153013755877, 59.42306003098686, 51.3413674533367, 51.514295205473886, 51.750291563570485, 45.937302375833184, 46.17882871317366, 45.66144053141275, 59.41980498656629, 59.27526985108851, 59.416100110858665, 36.888789306084306, 37.28680133322874, 37.507655205825955, 51.47941858631869, 50.95555381973584, 51.24324167271455, 49.07295918713014, 49.023358287910625, 49.10522385189931, 34.75230165074268, 33.976370881001145, 35.070800830299646, 51.46072641511758, 50.593596180280045, 51.27341066052516, 46.75976329669356, 46.85878127068281, 46.60296942293644, 39.23902707795301, 39.444463724891335, 39.847330717990786, 47.266139734536395, 46.87344807386397, 47.22269771806894, 46.52287310610214, 46.6110931119571, 45.5072463552157, 55.87987780074279, 56.38976875195901, 56.2870741399626, 42.879877040783555, 43.35963216299811, 43.23675836126009, 40.61437103897333, 40.29703076928854, 39.78043779730797, 49.75442040090759, 49.7450705555578, 49.12028623123963, 43.300307366997004, 43.16724094748497, 43.46024862676859, 56.22059269746144, 56.69847681590666, 56.527071622510746, 59.2734442812701, 58.33456668754418, 58.90690102924903, 46.6053025747339, 46.97054075511794, 46.46576314667861, 49.741087456544236, 50.1206196223696, 50.51336880152424, 47.01758701913057, 46.72665932774542, 46.63947948813437, 49.175581584374115, 50.43166645492117, 50.29993625978629, 50.424275776992246, 49.98973524818818, 49.98747205982606, 48.76575317482154, 48.82329259316127, 49.03618920842807, 50.14319220681985, 50.099575241406754, 50.30130190898974, 43.85877453287442, 42.52561055620511, 42.669060458739594, 50.291219208389506, 50.07195396721362, 49.66133265197276, 43.652193332711846, 43.727986002961785, 43.86336925501624, 43.43732202549775, 43.979582946126655, 43.54392996182044, 56.55198021170993, 56.23345324148734, 56.28383280088504, 40.837054451306656, 41.101881045227245, 40.77817053844531]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14722366229526737, "mean_inference_ms": 0.7121706301153304, "mean_action_processing_ms": 0.10211094415132399, "mean_env_wait_ms": 0.8457401309717999, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 915000, "timesteps_this_iter": 0, "agent_timesteps_total": 2745000, "timers": {"sample_time_ms": 10783.821, "sample_throughput": 463.658, "load_time_ms": 0.2, "load_throughput": 25004793.132, "learn_time_ms": 1707.042, "learn_throughput": 2929.043, "update_time_ms": 8.565}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4444474582904268e-35, "cur_lr": 0.0005000000000000001, "total_loss": 7.451135110855103, "policy_loss": -0.0007883930075424317, "vf_loss": 7.548851728439331, "vf_explained_var": 0.010021752119064331, "kl": 0.005313623952726431, "entropy": 9.692815399169922, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 915000, "num_agent_steps_sampled": 2745000, "num_steps_trained": 915000, "num_agent_steps_trained": 2745000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2689, "training_iteration": 183, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-42-26", "timestamp": 1706229746, "time_this_iter_s": 10.643584489822388, "time_total_s": 1985.169795513153, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028216BF70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1985.169795513153, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 9.946666666666667, "ram_util_percent": 52.100000000000016}}
{"episode_reward_max": 182.8663614783437, "episode_reward_min": -256.5152857080102, "episode_reward_mean": 133.69215740203973, "episode_len_mean": 492.31, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -91.98327746242285}, "policy_reward_max": {"shared_policy": 61.35646738981207}, "policy_reward_mean": {"shared_policy": 44.56405246734657}, "custom_metrics": {}, "hist_stats": {"episode_reward": [151.85889359936115, 178.08973778411737, 100.63684172742069, 145.04488966986546, 144.69434611126795, 97.57211121171713, 155.6471461839973, 163.89089701476038, 163.48326853290203, 161.75507161486874, 153.90321714431028, 106.12545904796569, -256.5152857080102, 139.33248609490698, 161.17331242002552, 145.14927507750684, 161.29667130857698, 118.53036172688007, -214.45787549903616, 158.9295799508692, 138.87261439627042, 159.1621043374763, 118.9647915083915, 151.22308809310198, 142.30483235046242, 138.84098507463938, 163.42574821412566, 138.62091755121952, 111.17841554665937, 180.81059439852814, 163.09948034206184, 156.8813878558576, 142.11863132566205, 152.96947919577332, 182.5148770101368, 160.3196384049953, 126.17497969511894, 182.8663614783437, 155.13895593583567, 169.66863979212954, 156.5838064709678, -234.48274227604273, 145.59694190882152, 146.60490405932075, 105.40233297646043, 148.09806390199813, 152.44150372967104, 170.3739725737831, 128.1789854541421, 152.54276136308928, 127.04397269058971, 125.49797632172704, 138.58505168557153, 141.60240403935322, 111.79963500611484, 142.53571774996843, 165.81206005066645, 177.84288439527168, 154.6059542223809, 137.77757162041965, 178.11117494851345, 111.683245845139, 153.67821407876934, 147.20154132694014, 103.79947336204347, 153.32773325592274, 140.22151399031281, 118.53082152083513, 141.36228552646915, 138.64121257327506, 168.55672069266438, 129.47626756504172, 120.69183960556984, 148.6197771877048, 129.92779694125048, 169.44614113587878, 176.51491199806333, 140.04160647653043, 150.37507588043815, 140.38372583501038, 149.90718429908154, 150.40148308500645, 146.6252349764109, 150.54406935721627, 129.05344554781936, 150.02450582757604, 131.24354859069004, 130.96083493344497, 169.06926625408244, 122.71710603497921, 132.0753236580639, 170.10212103277445, 146.07942336425168, 127.52502655982968, 126.76807225309311, 144.18969775363806, 148.4820804409684, 144.83156659081564, 144.03909385536087, 128.24489057715982], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 140, 500, 500, 500, 500, 500, 399, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 192, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [50.41448552906512, 50.4232561290264, 51.02115194126962, 59.30200670659541, 59.13944151997565, 59.64828955754636, 33.655664497986436, 33.459067303687334, 33.52210992574692, 47.93230288227399, 48.65924822663267, 48.4533385609587, 48.10427522162597, 48.211702908078834, 48.37836798156302, 32.181627720594406, 33.0219706222415, 32.368512868881226, 51.771269758542374, 51.56920852263768, 52.306667902817324, 54.74321221063535, 54.22064506510894, 54.92703973901614, 54.5758082618316, 54.2564833809932, 54.65097689007719, 53.23304823040961, 54.28950704541056, 54.23251633904873, 51.233631675442055, 51.766822827359036, 50.90276264150937, 35.776236616385475, 35.511087258656815, 34.8381351729234, -82.14186005294323, -82.39014819264412, -91.98327746242285, 46.236827209591866, 46.53307780995965, 46.56258107535541, 53.47684401025374, 53.9146556140234, 53.78181279574831, 48.715838049228, 48.60432708139221, 47.8291099468867, 53.433709124724075, 53.9094372826318, 53.9535249012212, 39.1829364746809, 39.562244936823845, 39.78518031537533, -71.59439268584053, -71.42379100496571, -71.43969180822994, 53.01545762891571, 52.97167116279404, 52.94245115915935, 46.51320535084233, 45.957536935806274, 46.40187210962176, 53.45502519762765, 52.948088946441814, 52.758990193406746, 39.463844031095505, 39.73109928146005, 39.76984819583595, 50.60428859045108, 50.45190041263898, 50.16689909001191, 47.622524261474595, 46.867613628506646, 47.81469446048139, 46.012033124764756, 46.51901773487528, 46.309934214999274, 54.35510961214702, 54.55286016563575, 54.51777843634288, 46.45652863383293, 46.44836089760065, 45.71602801978588, 37.341038629257426, 36.894602221747235, 36.942774695654705, 60.317999400198445, 60.03679079562424, 60.45580420270561, 54.601545056890856, 54.52477949361007, 53.973155791560814, 52.21465312192838, 52.34099900598328, 52.32573572794597, 47.21005373448132, 47.46057853847741, 47.447999052703366, 50.74946755170821, 51.20059555023907, 51.01941609382628, 61.0245332767566, 61.35646738981207, 60.13387634356816, 53.416626721620545, 53.660179216414676, 53.24283246695994, 42.281957532900066, 41.96838145951429, 41.92464070270458, 60.86100857456525, 61.13390807745357, 60.871444826324776, 51.77651820083459, 51.09743436177571, 52.265003373225525, 56.16950879991053, 56.536874465644345, 56.96225652657448, 52.0581595674157, 52.22321488708256, 52.302432016469524, -74.21643082921705, -75.34288733204207, -84.92342411478361, 48.392290865381554, 48.95871059161921, 48.24594045182069, 48.686828598380075, 49.08058133348821, 48.83749412745236, 35.093541661898286, 35.01101556668678, 35.29777574787536, 49.03745293617247, 49.56129297148435, 49.49931799434124, 50.98986294989784, 50.669972998400524, 50.78166778137286, 56.74097794294356, 56.80726289004086, 56.82573174079879, 42.47497037053108, 43.0778868868947, 42.62612819671631, 50.9838723341624, 50.98585653553407, 50.57303249339263, 42.0579303925236, 42.601080386278525, 42.384961911787585, 40.94885390996933, 42.495316814631224, 42.053805597126484, 46.163071162998676, 46.23502995073795, 46.18695057183504, 47.2779904976487, 47.451530221849666, 46.87288331985472, 37.08394531905651, 36.93614658713341, 37.77954309992492, 47.69593495937686, 47.21309640506904, 47.62668638552229, 55.42632921288411, 54.99726886550586, 55.388461972276374, 59.05829422672589, 59.36153013755877, 59.42306003098686, 51.3413674533367, 51.514295205473886, 51.750291563570485, 45.937302375833184, 46.17882871317366, 45.66144053141275, 59.41980498656629, 59.27526985108851, 59.416100110858665, 36.888789306084306, 37.28680133322874, 37.507655205825955, 51.47941858631869, 50.95555381973584, 51.24324167271455, 49.07295918713014, 49.023358287910625, 49.10522385189931, 34.75230165074268, 33.976370881001145, 35.070800830299646, 51.46072641511758, 50.593596180280045, 51.27341066052516, 46.75976329669356, 46.85878127068281, 46.60296942293644, 39.23902707795301, 39.444463724891335, 39.847330717990786, 47.266139734536395, 46.87344807386397, 47.22269771806894, 46.52287310610214, 46.6110931119571, 45.5072463552157, 55.87987780074279, 56.38976875195901, 56.2870741399626, 42.879877040783555, 43.35963216299811, 43.23675836126009, 40.61437103897333, 40.29703076928854, 39.78043779730797, 49.75442040090759, 49.7450705555578, 49.12028623123963, 43.300307366997004, 43.16724094748497, 43.46024862676859, 56.22059269746144, 56.69847681590666, 56.527071622510746, 59.2734442812701, 58.33456668754418, 58.90690102924903, 46.6053025747339, 46.97054075511794, 46.46576314667861, 49.741087456544236, 50.1206196223696, 50.51336880152424, 47.01758701913057, 46.72665932774542, 46.63947948813437, 49.175581584374115, 50.43166645492117, 50.29993625978629, 50.424275776992246, 49.98973524818818, 49.98747205982606, 48.76575317482154, 48.82329259316127, 49.03618920842807, 50.14319220681985, 50.099575241406754, 50.30130190898974, 43.85877453287442, 42.52561055620511, 42.669060458739594, 50.291219208389506, 50.07195396721362, 49.66133265197276, 43.652193332711846, 43.727986002961785, 43.86336925501624, 43.43732202549775, 43.979582946126655, 43.54392996182044, 56.55198021170993, 56.23345324148734, 56.28383280088504, 40.837054451306656, 41.101881045227245, 40.77817053844531, 43.72059506674607, 44.358984849726156, 43.99574374159177, 56.43039533992608, 56.72430867453416, 56.9474170183142, 48.52502585450809, 48.61272980521123, 48.94166770453255, 42.609391431013734, 42.5215053881208, 42.39412974069515, 42.64992247832318, 41.70641214152177, 42.411737633248165, 47.9186669141054, 48.070739746093736, 48.20029109343885, 49.011346841851875, 49.858397855112955, 49.61233574400346, 48.318296277895556, 48.19150890037416, 48.321761412546024, 47.86082410315673, 48.18653479426091, 47.991734957943365, 43.083809574445084, 43.170558300179735, 41.99052270253499]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14722228028390655, "mean_inference_ms": 0.7122144239752014, "mean_action_processing_ms": 0.10211086497235806, "mean_env_wait_ms": 0.8456756265443787, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 920000, "timesteps_this_iter": 0, "agent_timesteps_total": 2760000, "timers": {"sample_time_ms": 10792.912, "sample_throughput": 463.267, "load_time_ms": 0.2, "load_throughput": 25004793.132, "learn_time_ms": 1709.123, "learn_throughput": 2925.477, "update_time_ms": 8.611}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4444474582904268e-35, "cur_lr": 0.0005000000000000001, "total_loss": 6.690116024017334, "policy_loss": -0.0009548916929401407, "vf_loss": 6.787666940689087, "vf_explained_var": 0.012595671415328979, "kl": 0.003214397677266525, "entropy": 9.659612560272217, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 920000, "num_agent_steps_sampled": 2760000, "num_steps_trained": 920000, "num_agent_steps_trained": 2760000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2699, "training_iteration": 184, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-42-36", "timestamp": 1706229756, "time_this_iter_s": 10.499876260757446, "time_total_s": 1995.6696717739105, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202845CE280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1995.6696717739105, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 11.82, "ram_util_percent": 52.00000000000001}}
{"episode_reward_max": 183.95851212367404, "episode_reward_min": -256.5152857080102, "episode_reward_mean": 134.09274055740562, "episode_len_mean": 492.31, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -91.98327746242285}, "policy_reward_max": {"shared_policy": 61.5698294552664}, "policy_reward_mean": {"shared_policy": 44.697580185801876}, "custom_metrics": {}, "hist_stats": {"episode_reward": [153.90321714431028, 106.12545904796569, -256.5152857080102, 139.33248609490698, 161.17331242002552, 145.14927507750684, 161.29667130857698, 118.53036172688007, -214.45787549903616, 158.9295799508692, 138.87261439627042, 159.1621043374763, 118.9647915083915, 151.22308809310198, 142.30483235046242, 138.84098507463938, 163.42574821412566, 138.62091755121952, 111.17841554665937, 180.81059439852814, 163.09948034206184, 156.8813878558576, 142.11863132566205, 152.96947919577332, 182.5148770101368, 160.3196384049953, 126.17497969511894, 182.8663614783437, 155.13895593583567, 169.66863979212954, 156.5838064709678, -234.48274227604273, 145.59694190882152, 146.60490405932075, 105.40233297646043, 148.09806390199813, 152.44150372967104, 170.3739725737831, 128.1789854541421, 152.54276136308928, 127.04397269058971, 125.49797632172704, 138.58505168557153, 141.60240403935322, 111.79963500611484, 142.53571774996843, 165.81206005066645, 177.84288439527168, 154.6059542223809, 137.77757162041965, 178.11117494851345, 111.683245845139, 153.67821407876934, 147.20154132694014, 103.79947336204347, 153.32773325592274, 140.22151399031281, 118.53082152083513, 141.36228552646915, 138.64121257327506, 168.55672069266438, 129.47626756504172, 120.69183960556984, 148.6197771877048, 129.92779694125048, 169.44614113587878, 176.51491199806333, 140.04160647653043, 150.37507588043815, 140.38372583501038, 149.90718429908154, 150.40148308500645, 146.6252349764109, 150.54406935721627, 129.05344554781936, 150.02450582757604, 131.24354859069004, 130.96083493344497, 169.06926625408244, 122.71710603497921, 132.0753236580639, 170.10212103277445, 146.07942336425168, 127.52502655982968, 126.76807225309311, 144.18969775363806, 148.4820804409684, 144.83156659081564, 144.03909385536087, 128.24489057715982, 149.24247780861322, 162.9289148820097, 155.6534725818781, 149.49300455674526, 153.92040202394125, 136.45041498541838, 183.95851212367404, 156.2956919064746, 142.74590293504306, 112.04272518306969], "episode_lengths": [500, 500, 140, 500, 500, 500, 500, 500, 399, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 192, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [51.233631675442055, 51.766822827359036, 50.90276264150937, 35.776236616385475, 35.511087258656815, 34.8381351729234, -82.14186005294323, -82.39014819264412, -91.98327746242285, 46.236827209591866, 46.53307780995965, 46.56258107535541, 53.47684401025374, 53.9146556140234, 53.78181279574831, 48.715838049228, 48.60432708139221, 47.8291099468867, 53.433709124724075, 53.9094372826318, 53.9535249012212, 39.1829364746809, 39.562244936823845, 39.78518031537533, -71.59439268584053, -71.42379100496571, -71.43969180822994, 53.01545762891571, 52.97167116279404, 52.94245115915935, 46.51320535084233, 45.957536935806274, 46.40187210962176, 53.45502519762765, 52.948088946441814, 52.758990193406746, 39.463844031095505, 39.73109928146005, 39.76984819583595, 50.60428859045108, 50.45190041263898, 50.16689909001191, 47.622524261474595, 46.867613628506646, 47.81469446048139, 46.012033124764756, 46.51901773487528, 46.309934214999274, 54.35510961214702, 54.55286016563575, 54.51777843634288, 46.45652863383293, 46.44836089760065, 45.71602801978588, 37.341038629257426, 36.894602221747235, 36.942774695654705, 60.317999400198445, 60.03679079562424, 60.45580420270561, 54.601545056890856, 54.52477949361007, 53.973155791560814, 52.21465312192838, 52.34099900598328, 52.32573572794597, 47.21005373448132, 47.46057853847741, 47.447999052703366, 50.74946755170821, 51.20059555023907, 51.01941609382628, 61.0245332767566, 61.35646738981207, 60.13387634356816, 53.416626721620545, 53.660179216414676, 53.24283246695994, 42.281957532900066, 41.96838145951429, 41.92464070270458, 60.86100857456525, 61.13390807745357, 60.871444826324776, 51.77651820083459, 51.09743436177571, 52.265003373225525, 56.16950879991053, 56.536874465644345, 56.96225652657448, 52.0581595674157, 52.22321488708256, 52.302432016469524, -74.21643082921705, -75.34288733204207, -84.92342411478361, 48.392290865381554, 48.95871059161921, 48.24594045182069, 48.686828598380075, 49.08058133348821, 48.83749412745236, 35.093541661898286, 35.01101556668678, 35.29777574787536, 49.03745293617247, 49.56129297148435, 49.49931799434124, 50.98986294989784, 50.669972998400524, 50.78166778137286, 56.74097794294356, 56.80726289004086, 56.82573174079879, 42.47497037053108, 43.0778868868947, 42.62612819671631, 50.9838723341624, 50.98585653553407, 50.57303249339263, 42.0579303925236, 42.601080386278525, 42.384961911787585, 40.94885390996933, 42.495316814631224, 42.053805597126484, 46.163071162998676, 46.23502995073795, 46.18695057183504, 47.2779904976487, 47.451530221849666, 46.87288331985472, 37.08394531905651, 36.93614658713341, 37.77954309992492, 47.69593495937686, 47.21309640506904, 47.62668638552229, 55.42632921288411, 54.99726886550586, 55.388461972276374, 59.05829422672589, 59.36153013755877, 59.42306003098686, 51.3413674533367, 51.514295205473886, 51.750291563570485, 45.937302375833184, 46.17882871317366, 45.66144053141275, 59.41980498656629, 59.27526985108851, 59.416100110858665, 36.888789306084306, 37.28680133322874, 37.507655205825955, 51.47941858631869, 50.95555381973584, 51.24324167271455, 49.07295918713014, 49.023358287910625, 49.10522385189931, 34.75230165074268, 33.976370881001145, 35.070800830299646, 51.46072641511758, 50.593596180280045, 51.27341066052516, 46.75976329669356, 46.85878127068281, 46.60296942293644, 39.23902707795301, 39.444463724891335, 39.847330717990786, 47.266139734536395, 46.87344807386397, 47.22269771806894, 46.52287310610214, 46.6110931119571, 45.5072463552157, 55.87987780074279, 56.38976875195901, 56.2870741399626, 42.879877040783555, 43.35963216299811, 43.23675836126009, 40.61437103897333, 40.29703076928854, 39.78043779730797, 49.75442040090759, 49.7450705555578, 49.12028623123963, 43.300307366997004, 43.16724094748497, 43.46024862676859, 56.22059269746144, 56.69847681590666, 56.527071622510746, 59.2734442812701, 58.33456668754418, 58.90690102924903, 46.6053025747339, 46.97054075511794, 46.46576314667861, 49.741087456544236, 50.1206196223696, 50.51336880152424, 47.01758701913057, 46.72665932774542, 46.63947948813437, 49.175581584374115, 50.43166645492117, 50.29993625978629, 50.424275776992246, 49.98973524818818, 49.98747205982606, 48.76575317482154, 48.82329259316127, 49.03618920842807, 50.14319220681985, 50.099575241406754, 50.30130190898974, 43.85877453287442, 42.52561055620511, 42.669060458739594, 50.291219208389506, 50.07195396721362, 49.66133265197276, 43.652193332711846, 43.727986002961785, 43.86336925501624, 43.43732202549775, 43.979582946126655, 43.54392996182044, 56.55198021170993, 56.23345324148734, 56.28383280088504, 40.837054451306656, 41.101881045227245, 40.77817053844531, 43.72059506674607, 44.358984849726156, 43.99574374159177, 56.43039533992608, 56.72430867453416, 56.9474170183142, 48.52502585450809, 48.61272980521123, 48.94166770453255, 42.609391431013734, 42.5215053881208, 42.39412974069515, 42.64992247832318, 41.70641214152177, 42.411737633248165, 47.9186669141054, 48.070739746093736, 48.20029109343885, 49.011346841851875, 49.858397855112955, 49.61233574400346, 48.318296277895556, 48.19150890037416, 48.321761412546024, 47.86082410315673, 48.18653479426091, 47.991734957943365, 43.083809574445084, 43.170558300179735, 41.99052270253499, 49.240180939435945, 50.068911042530075, 49.93338582664727, 53.56623288989066, 54.43701327592133, 54.92566871619782, 51.67993150403102, 51.87102682640155, 52.102514251445726, 49.78378369410832, 49.67879394938548, 50.030426913251475, 51.534062406669065, 51.14060035596292, 51.24573926130931, 45.51356333990891, 45.79343635340531, 45.14341529210408, 60.977407659093544, 61.5698294552664, 61.411275009314224, 52.40512406484534, 51.850229804714516, 52.04033803691466, 47.022706275184945, 47.85564054300387, 47.867556116854146, 37.41143887986739, 36.976227705677346, 37.655058597524956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14721141808775687, "mean_inference_ms": 0.7122348088665, "mean_action_processing_ms": 0.10210884283086802, "mean_env_wait_ms": 0.8455869263602429, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 925000, "timesteps_this_iter": 0, "agent_timesteps_total": 2775000, "timers": {"sample_time_ms": 10740.622, "sample_throughput": 465.522, "load_time_ms": 0.2, "load_throughput": 25004793.132, "learn_time_ms": 1713.969, "learn_throughput": 2917.206, "update_time_ms": 8.805}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.222237291452134e-36, "cur_lr": 0.0005000000000000001, "total_loss": 8.484887790679931, "policy_loss": 0.005959569291199074, "vf_loss": 8.574670791625977, "vf_explained_var": 0.017821043729782104, "kl": 0.2135563556105368, "entropy": 9.574305438995362, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 925000, "num_agent_steps_sampled": 2775000, "num_steps_trained": 925000, "num_agent_steps_trained": 2775000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2709, "training_iteration": 185, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-42-46", "timestamp": 1706229766, "time_this_iter_s": 10.01999282836914, "time_total_s": 2005.6896646022797, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824D0EE0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2005.6896646022797, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 10.071428571428571, "ram_util_percent": 52.085714285714296}}
{"episode_reward_max": 183.95851212367404, "episode_reward_min": -234.48274227604273, "episode_reward_mean": 142.57768927451457, "episode_len_mean": 496.92, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -84.92342411478361}, "policy_reward_max": {"shared_policy": 61.5698294552664}, "policy_reward_mean": {"shared_policy": 47.52589642483818}, "custom_metrics": {}, "hist_stats": {"episode_reward": [138.87261439627042, 159.1621043374763, 118.9647915083915, 151.22308809310198, 142.30483235046242, 138.84098507463938, 163.42574821412566, 138.62091755121952, 111.17841554665937, 180.81059439852814, 163.09948034206184, 156.8813878558576, 142.11863132566205, 152.96947919577332, 182.5148770101368, 160.3196384049953, 126.17497969511894, 182.8663614783437, 155.13895593583567, 169.66863979212954, 156.5838064709678, -234.48274227604273, 145.59694190882152, 146.60490405932075, 105.40233297646043, 148.09806390199813, 152.44150372967104, 170.3739725737831, 128.1789854541421, 152.54276136308928, 127.04397269058971, 125.49797632172704, 138.58505168557153, 141.60240403935322, 111.79963500611484, 142.53571774996843, 165.81206005066645, 177.84288439527168, 154.6059542223809, 137.77757162041965, 178.11117494851345, 111.683245845139, 153.67821407876934, 147.20154132694014, 103.79947336204347, 153.32773325592274, 140.22151399031281, 118.53082152083513, 141.36228552646915, 138.64121257327506, 168.55672069266438, 129.47626756504172, 120.69183960556984, 148.6197771877048, 129.92779694125048, 169.44614113587878, 176.51491199806333, 140.04160647653043, 150.37507588043815, 140.38372583501038, 149.90718429908154, 150.40148308500645, 146.6252349764109, 150.54406935721627, 129.05344554781936, 150.02450582757604, 131.24354859069004, 130.96083493344497, 169.06926625408244, 122.71710603497921, 132.0753236580639, 170.10212103277445, 146.07942336425168, 127.52502655982968, 126.76807225309311, 144.18969775363806, 148.4820804409684, 144.83156659081564, 144.03909385536087, 128.24489057715982, 149.24247780861322, 162.9289148820097, 155.6534725818781, 149.49300455674526, 153.92040202394125, 136.45041498541838, 183.95851212367404, 156.2956919064746, 142.74590293504306, 112.04272518306969, 141.978707274422, 156.8109898529947, 144.0900932457301, 163.20230873301614, 135.3517698505894, 169.33243328705416, 163.40433514863227, 147.1064841151236, 150.72992474958303, 149.95502701774248], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 192, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [46.51320535084233, 45.957536935806274, 46.40187210962176, 53.45502519762765, 52.948088946441814, 52.758990193406746, 39.463844031095505, 39.73109928146005, 39.76984819583595, 50.60428859045108, 50.45190041263898, 50.16689909001191, 47.622524261474595, 46.867613628506646, 47.81469446048139, 46.012033124764756, 46.51901773487528, 46.309934214999274, 54.35510961214702, 54.55286016563575, 54.51777843634288, 46.45652863383293, 46.44836089760065, 45.71602801978588, 37.341038629257426, 36.894602221747235, 36.942774695654705, 60.317999400198445, 60.03679079562424, 60.45580420270561, 54.601545056890856, 54.52477949361007, 53.973155791560814, 52.21465312192838, 52.34099900598328, 52.32573572794597, 47.21005373448132, 47.46057853847741, 47.447999052703366, 50.74946755170821, 51.20059555023907, 51.01941609382628, 61.0245332767566, 61.35646738981207, 60.13387634356816, 53.416626721620545, 53.660179216414676, 53.24283246695994, 42.281957532900066, 41.96838145951429, 41.92464070270458, 60.86100857456525, 61.13390807745357, 60.871444826324776, 51.77651820083459, 51.09743436177571, 52.265003373225525, 56.16950879991053, 56.536874465644345, 56.96225652657448, 52.0581595674157, 52.22321488708256, 52.302432016469524, -74.21643082921705, -75.34288733204207, -84.92342411478361, 48.392290865381554, 48.95871059161921, 48.24594045182069, 48.686828598380075, 49.08058133348821, 48.83749412745236, 35.093541661898286, 35.01101556668678, 35.29777574787536, 49.03745293617247, 49.56129297148435, 49.49931799434124, 50.98986294989784, 50.669972998400524, 50.78166778137286, 56.74097794294356, 56.80726289004086, 56.82573174079879, 42.47497037053108, 43.0778868868947, 42.62612819671631, 50.9838723341624, 50.98585653553407, 50.57303249339263, 42.0579303925236, 42.601080386278525, 42.384961911787585, 40.94885390996933, 42.495316814631224, 42.053805597126484, 46.163071162998676, 46.23502995073795, 46.18695057183504, 47.2779904976487, 47.451530221849666, 46.87288331985472, 37.08394531905651, 36.93614658713341, 37.77954309992492, 47.69593495937686, 47.21309640506904, 47.62668638552229, 55.42632921288411, 54.99726886550586, 55.388461972276374, 59.05829422672589, 59.36153013755877, 59.42306003098686, 51.3413674533367, 51.514295205473886, 51.750291563570485, 45.937302375833184, 46.17882871317366, 45.66144053141275, 59.41980498656629, 59.27526985108851, 59.416100110858665, 36.888789306084306, 37.28680133322874, 37.507655205825955, 51.47941858631869, 50.95555381973584, 51.24324167271455, 49.07295918713014, 49.023358287910625, 49.10522385189931, 34.75230165074268, 33.976370881001145, 35.070800830299646, 51.46072641511758, 50.593596180280045, 51.27341066052516, 46.75976329669356, 46.85878127068281, 46.60296942293644, 39.23902707795301, 39.444463724891335, 39.847330717990786, 47.266139734536395, 46.87344807386397, 47.22269771806894, 46.52287310610214, 46.6110931119571, 45.5072463552157, 55.87987780074279, 56.38976875195901, 56.2870741399626, 42.879877040783555, 43.35963216299811, 43.23675836126009, 40.61437103897333, 40.29703076928854, 39.78043779730797, 49.75442040090759, 49.7450705555578, 49.12028623123963, 43.300307366997004, 43.16724094748497, 43.46024862676859, 56.22059269746144, 56.69847681590666, 56.527071622510746, 59.2734442812701, 58.33456668754418, 58.90690102924903, 46.6053025747339, 46.97054075511794, 46.46576314667861, 49.741087456544236, 50.1206196223696, 50.51336880152424, 47.01758701913057, 46.72665932774542, 46.63947948813437, 49.175581584374115, 50.43166645492117, 50.29993625978629, 50.424275776992246, 49.98973524818818, 49.98747205982606, 48.76575317482154, 48.82329259316127, 49.03618920842807, 50.14319220681985, 50.099575241406754, 50.30130190898974, 43.85877453287442, 42.52561055620511, 42.669060458739594, 50.291219208389506, 50.07195396721362, 49.66133265197276, 43.652193332711846, 43.727986002961785, 43.86336925501624, 43.43732202549775, 43.979582946126655, 43.54392996182044, 56.55198021170993, 56.23345324148734, 56.28383280088504, 40.837054451306656, 41.101881045227245, 40.77817053844531, 43.72059506674607, 44.358984849726156, 43.99574374159177, 56.43039533992608, 56.72430867453416, 56.9474170183142, 48.52502585450809, 48.61272980521123, 48.94166770453255, 42.609391431013734, 42.5215053881208, 42.39412974069515, 42.64992247832318, 41.70641214152177, 42.411737633248165, 47.9186669141054, 48.070739746093736, 48.20029109343885, 49.011346841851875, 49.858397855112955, 49.61233574400346, 48.318296277895556, 48.19150890037416, 48.321761412546024, 47.86082410315673, 48.18653479426091, 47.991734957943365, 43.083809574445084, 43.170558300179735, 41.99052270253499, 49.240180939435945, 50.068911042530075, 49.93338582664727, 53.56623288989066, 54.43701327592133, 54.92566871619782, 51.67993150403102, 51.87102682640155, 52.102514251445726, 49.78378369410832, 49.67879394938548, 50.030426913251475, 51.534062406669065, 51.14060035596292, 51.24573926130931, 45.51356333990891, 45.79343635340531, 45.14341529210408, 60.977407659093544, 61.5698294552664, 61.411275009314224, 52.40512406484534, 51.850229804714516, 52.04033803691466, 47.022706275184945, 47.85564054300387, 47.867556116854146, 37.41143887986739, 36.976227705677346, 37.655058597524956, 47.48503176433344, 47.03825256725152, 47.455422942837075, 51.863856777548776, 52.376304060220704, 52.57082901522516, 47.84647570053737, 48.04554817328851, 48.19806937190394, 54.54230935623248, 53.88227557142575, 54.77772380535801, 45.36123194297154, 45.71740484827508, 44.2731330593427, 56.04108912249406, 56.53020703544219, 56.76113712911804, 54.48981492221354, 54.16135302186011, 54.753167204558835, 49.03173922747372, 48.88975928723811, 49.18498560041188, 50.03519401947658, 50.18400811652343, 50.51072261358301, 50.05104139074682, 49.767250359058366, 50.13673526793717]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1472235946946981, "mean_inference_ms": 0.7124990780794593, "mean_action_processing_ms": 0.10212579813636534, "mean_env_wait_ms": 0.8457022499860675, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 930000, "timesteps_this_iter": 0, "agent_timesteps_total": 2790000, "timers": {"sample_time_ms": 10700.11, "sample_throughput": 467.285, "load_time_ms": 0.2, "load_throughput": 25004793.132, "learn_time_ms": 1715.846, "learn_throughput": 2914.015, "update_time_ms": 8.755}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0833355937178203e-35, "cur_lr": 0.0005000000000000001, "total_loss": 9.368524837493897, "policy_loss": -0.0007007870564777364, "vf_loss": 9.46792230606079, "vf_explained_var": 0.016128796339035033, "kl": 0.005647247610663948, "entropy": 9.869622611999512, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 930000, "num_agent_steps_sampled": 2790000, "num_steps_trained": 930000, "num_agent_steps_trained": 2790000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2719, "training_iteration": 186, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-42-57", "timestamp": 1706229777, "time_this_iter_s": 10.100967407226562, "time_total_s": 2015.7906320095062, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202823BECA0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2015.7906320095062, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 10.164285714285713, "ram_util_percent": 52.05000000000001}}
{"episode_reward_max": 183.95851212367404, "episode_reward_min": -234.48274227604273, "episode_reward_mean": 142.91060932934283, "episode_len_mean": 496.92, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -84.92342411478361}, "policy_reward_max": {"shared_policy": 61.5698294552664}, "policy_reward_mean": {"shared_policy": 47.63686977644761}, "custom_metrics": {}, "hist_stats": {"episode_reward": [163.09948034206184, 156.8813878558576, 142.11863132566205, 152.96947919577332, 182.5148770101368, 160.3196384049953, 126.17497969511894, 182.8663614783437, 155.13895593583567, 169.66863979212954, 156.5838064709678, -234.48274227604273, 145.59694190882152, 146.60490405932075, 105.40233297646043, 148.09806390199813, 152.44150372967104, 170.3739725737831, 128.1789854541421, 152.54276136308928, 127.04397269058971, 125.49797632172704, 138.58505168557153, 141.60240403935322, 111.79963500611484, 142.53571774996843, 165.81206005066645, 177.84288439527168, 154.6059542223809, 137.77757162041965, 178.11117494851345, 111.683245845139, 153.67821407876934, 147.20154132694014, 103.79947336204347, 153.32773325592274, 140.22151399031281, 118.53082152083513, 141.36228552646915, 138.64121257327506, 168.55672069266438, 129.47626756504172, 120.69183960556984, 148.6197771877048, 129.92779694125048, 169.44614113587878, 176.51491199806333, 140.04160647653043, 150.37507588043815, 140.38372583501038, 149.90718429908154, 150.40148308500645, 146.6252349764109, 150.54406935721627, 129.05344554781936, 150.02450582757604, 131.24354859069004, 130.96083493344497, 169.06926625408244, 122.71710603497921, 132.0753236580639, 170.10212103277445, 146.07942336425168, 127.52502655982968, 126.76807225309311, 144.18969775363806, 148.4820804409684, 144.83156659081564, 144.03909385536087, 128.24489057715982, 149.24247780861322, 162.9289148820097, 155.6534725818781, 149.49300455674526, 153.92040202394125, 136.45041498541838, 183.95851212367404, 156.2956919064746, 142.74590293504306, 112.04272518306969, 141.978707274422, 156.8109898529947, 144.0900932457301, 163.20230873301614, 135.3517698505894, 169.33243328705416, 163.40433514863227, 147.1064841151236, 150.72992474958303, 149.95502701774248, 143.05173895508048, 143.77927643433193, 109.22283641248941, 166.79885149747125, 182.2633801698683, 161.16205138713133, 114.09609070420264, 147.73666408727902, 171.09350526705396, 137.49170203879473], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 192, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [54.601545056890856, 54.52477949361007, 53.973155791560814, 52.21465312192838, 52.34099900598328, 52.32573572794597, 47.21005373448132, 47.46057853847741, 47.447999052703366, 50.74946755170821, 51.20059555023907, 51.01941609382628, 61.0245332767566, 61.35646738981207, 60.13387634356816, 53.416626721620545, 53.660179216414676, 53.24283246695994, 42.281957532900066, 41.96838145951429, 41.92464070270458, 60.86100857456525, 61.13390807745357, 60.871444826324776, 51.77651820083459, 51.09743436177571, 52.265003373225525, 56.16950879991053, 56.536874465644345, 56.96225652657448, 52.0581595674157, 52.22321488708256, 52.302432016469524, -74.21643082921705, -75.34288733204207, -84.92342411478361, 48.392290865381554, 48.95871059161921, 48.24594045182069, 48.686828598380075, 49.08058133348821, 48.83749412745236, 35.093541661898286, 35.01101556668678, 35.29777574787536, 49.03745293617247, 49.56129297148435, 49.49931799434124, 50.98986294989784, 50.669972998400524, 50.78166778137286, 56.74097794294356, 56.80726289004086, 56.82573174079879, 42.47497037053108, 43.0778868868947, 42.62612819671631, 50.9838723341624, 50.98585653553407, 50.57303249339263, 42.0579303925236, 42.601080386278525, 42.384961911787585, 40.94885390996933, 42.495316814631224, 42.053805597126484, 46.163071162998676, 46.23502995073795, 46.18695057183504, 47.2779904976487, 47.451530221849666, 46.87288331985472, 37.08394531905651, 36.93614658713341, 37.77954309992492, 47.69593495937686, 47.21309640506904, 47.62668638552229, 55.42632921288411, 54.99726886550586, 55.388461972276374, 59.05829422672589, 59.36153013755877, 59.42306003098686, 51.3413674533367, 51.514295205473886, 51.750291563570485, 45.937302375833184, 46.17882871317366, 45.66144053141275, 59.41980498656629, 59.27526985108851, 59.416100110858665, 36.888789306084306, 37.28680133322874, 37.507655205825955, 51.47941858631869, 50.95555381973584, 51.24324167271455, 49.07295918713014, 49.023358287910625, 49.10522385189931, 34.75230165074268, 33.976370881001145, 35.070800830299646, 51.46072641511758, 50.593596180280045, 51.27341066052516, 46.75976329669356, 46.85878127068281, 46.60296942293644, 39.23902707795301, 39.444463724891335, 39.847330717990786, 47.266139734536395, 46.87344807386397, 47.22269771806894, 46.52287310610214, 46.6110931119571, 45.5072463552157, 55.87987780074279, 56.38976875195901, 56.2870741399626, 42.879877040783555, 43.35963216299811, 43.23675836126009, 40.61437103897333, 40.29703076928854, 39.78043779730797, 49.75442040090759, 49.7450705555578, 49.12028623123963, 43.300307366997004, 43.16724094748497, 43.46024862676859, 56.22059269746144, 56.69847681590666, 56.527071622510746, 59.2734442812701, 58.33456668754418, 58.90690102924903, 46.6053025747339, 46.97054075511794, 46.46576314667861, 49.741087456544236, 50.1206196223696, 50.51336880152424, 47.01758701913057, 46.72665932774542, 46.63947948813437, 49.175581584374115, 50.43166645492117, 50.29993625978629, 50.424275776992246, 49.98973524818818, 49.98747205982606, 48.76575317482154, 48.82329259316127, 49.03618920842807, 50.14319220681985, 50.099575241406754, 50.30130190898974, 43.85877453287442, 42.52561055620511, 42.669060458739594, 50.291219208389506, 50.07195396721362, 49.66133265197276, 43.652193332711846, 43.727986002961785, 43.86336925501624, 43.43732202549775, 43.979582946126655, 43.54392996182044, 56.55198021170993, 56.23345324148734, 56.28383280088504, 40.837054451306656, 41.101881045227245, 40.77817053844531, 43.72059506674607, 44.358984849726156, 43.99574374159177, 56.43039533992608, 56.72430867453416, 56.9474170183142, 48.52502585450809, 48.61272980521123, 48.94166770453255, 42.609391431013734, 42.5215053881208, 42.39412974069515, 42.64992247832318, 41.70641214152177, 42.411737633248165, 47.9186669141054, 48.070739746093736, 48.20029109343885, 49.011346841851875, 49.858397855112955, 49.61233574400346, 48.318296277895556, 48.19150890037416, 48.321761412546024, 47.86082410315673, 48.18653479426091, 47.991734957943365, 43.083809574445084, 43.170558300179735, 41.99052270253499, 49.240180939435945, 50.068911042530075, 49.93338582664727, 53.56623288989066, 54.43701327592133, 54.92566871619782, 51.67993150403102, 51.87102682640155, 52.102514251445726, 49.78378369410832, 49.67879394938548, 50.030426913251475, 51.534062406669065, 51.14060035596292, 51.24573926130931, 45.51356333990891, 45.79343635340531, 45.14341529210408, 60.977407659093544, 61.5698294552664, 61.411275009314224, 52.40512406484534, 51.850229804714516, 52.04033803691466, 47.022706275184945, 47.85564054300387, 47.867556116854146, 37.41143887986739, 36.976227705677346, 37.655058597524956, 47.48503176433344, 47.03825256725152, 47.455422942837075, 51.863856777548776, 52.376304060220704, 52.57082901522516, 47.84647570053737, 48.04554817328851, 48.19806937190394, 54.54230935623248, 53.88227557142575, 54.77772380535801, 45.36123194297154, 45.71740484827508, 44.2731330593427, 56.04108912249406, 56.53020703544219, 56.76113712911804, 54.48981492221354, 54.16135302186011, 54.753167204558835, 49.03173922747372, 48.88975928723811, 49.18498560041188, 50.03519401947658, 50.18400811652343, 50.51072261358301, 50.05104139074682, 49.767250359058366, 50.13673526793717, 47.671562169988945, 47.795050514241055, 47.585126270850495, 48.210684822251395, 48.089934212466076, 47.47865739961465, 36.384353287518024, 36.49127344042063, 36.34720968455076, 55.38257073859374, 55.6688213745753, 55.7474593843023, 60.912343310813114, 60.413304279247924, 60.937732579807445, 53.217167759935066, 54.005869532624885, 53.93901409457128, 38.12665822108586, 38.22999896605809, 37.739433517058686, 49.14479695260523, 49.39900896395555, 49.19285817071794, 56.98304592321317, 56.86183611551921, 57.24862322832148, 45.90296967327595, 45.84746454283595, 45.74126782268286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1472008312533131, "mean_inference_ms": 0.7124581528016368, "mean_action_processing_ms": 0.10212564764202943, "mean_env_wait_ms": 0.8455871079687151, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 935000, "timesteps_this_iter": 0, "agent_timesteps_total": 2805000, "timers": {"sample_time_ms": 10667.415, "sample_throughput": 468.717, "load_time_ms": 0.3, "load_throughput": 16669199.587, "learn_time_ms": 1702.904, "learn_throughput": 2936.161, "update_time_ms": 8.852}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0833355937178203e-35, "cur_lr": 0.0005000000000000001, "total_loss": 9.761084747314452, "policy_loss": -0.0012867276691551411, "vf_loss": 9.862267208099365, "vf_explained_var": 0.01228594183921814, "kl": 0.003486095275780615, "entropy": 9.989571380615235, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 935000, "num_agent_steps_sampled": 2805000, "num_steps_trained": 935000, "num_agent_steps_trained": 2805000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2729, "training_iteration": 187, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-43-07", "timestamp": 1706229787, "time_this_iter_s": 10.340386629104614, "time_total_s": 2026.1310186386108, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202846E4670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2026.1310186386108, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 11.866666666666667, "ram_util_percent": 52.04666666666667}}
{"episode_reward_max": 206.6198704186826, "episode_reward_min": -234.48274227604273, "episode_reward_mean": 141.93661688148103, "episode_len_mean": 496.92, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -84.92342411478361}, "policy_reward_max": {"shared_policy": 69.12746461667119}, "policy_reward_mean": {"shared_policy": 47.31220562716034}, "custom_metrics": {}, "hist_stats": {"episode_reward": [156.5838064709678, -234.48274227604273, 145.59694190882152, 146.60490405932075, 105.40233297646043, 148.09806390199813, 152.44150372967104, 170.3739725737831, 128.1789854541421, 152.54276136308928, 127.04397269058971, 125.49797632172704, 138.58505168557153, 141.60240403935322, 111.79963500611484, 142.53571774996843, 165.81206005066645, 177.84288439527168, 154.6059542223809, 137.77757162041965, 178.11117494851345, 111.683245845139, 153.67821407876934, 147.20154132694014, 103.79947336204347, 153.32773325592274, 140.22151399031281, 118.53082152083513, 141.36228552646915, 138.64121257327506, 168.55672069266438, 129.47626756504172, 120.69183960556984, 148.6197771877048, 129.92779694125048, 169.44614113587878, 176.51491199806333, 140.04160647653043, 150.37507588043815, 140.38372583501038, 149.90718429908154, 150.40148308500645, 146.6252349764109, 150.54406935721627, 129.05344554781936, 150.02450582757604, 131.24354859069004, 130.96083493344497, 169.06926625408244, 122.71710603497921, 132.0753236580639, 170.10212103277445, 146.07942336425168, 127.52502655982968, 126.76807225309311, 144.18969775363806, 148.4820804409684, 144.83156659081564, 144.03909385536087, 128.24489057715982, 149.24247780861322, 162.9289148820097, 155.6534725818781, 149.49300455674526, 153.92040202394125, 136.45041498541838, 183.95851212367404, 156.2956919064746, 142.74590293504306, 112.04272518306969, 141.978707274422, 156.8109898529947, 144.0900932457301, 163.20230873301614, 135.3517698505894, 169.33243328705416, 163.40433514863227, 147.1064841151236, 150.72992474958303, 149.95502701774248, 143.05173895508048, 143.77927643433193, 109.22283641248941, 166.79885149747125, 182.2633801698683, 161.16205138713133, 114.09609070420264, 147.73666408727902, 171.09350526705396, 137.49170203879473, 143.3837895542384, 171.7976651005449, 165.79844035860134, 145.22334733977917, 206.6198704186826, 129.68500471115118, 138.96760622784478, 139.70492058899228, 136.7550202086568, 116.4175217412412], "episode_lengths": [500, 192, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [52.0581595674157, 52.22321488708256, 52.302432016469524, -74.21643082921705, -75.34288733204207, -84.92342411478361, 48.392290865381554, 48.95871059161921, 48.24594045182069, 48.686828598380075, 49.08058133348821, 48.83749412745236, 35.093541661898286, 35.01101556668678, 35.29777574787536, 49.03745293617247, 49.56129297148435, 49.49931799434124, 50.98986294989784, 50.669972998400524, 50.78166778137286, 56.74097794294356, 56.80726289004086, 56.82573174079879, 42.47497037053108, 43.0778868868947, 42.62612819671631, 50.9838723341624, 50.98585653553407, 50.57303249339263, 42.0579303925236, 42.601080386278525, 42.384961911787585, 40.94885390996933, 42.495316814631224, 42.053805597126484, 46.163071162998676, 46.23502995073795, 46.18695057183504, 47.2779904976487, 47.451530221849666, 46.87288331985472, 37.08394531905651, 36.93614658713341, 37.77954309992492, 47.69593495937686, 47.21309640506904, 47.62668638552229, 55.42632921288411, 54.99726886550586, 55.388461972276374, 59.05829422672589, 59.36153013755877, 59.42306003098686, 51.3413674533367, 51.514295205473886, 51.750291563570485, 45.937302375833184, 46.17882871317366, 45.66144053141275, 59.41980498656629, 59.27526985108851, 59.416100110858665, 36.888789306084306, 37.28680133322874, 37.507655205825955, 51.47941858631869, 50.95555381973584, 51.24324167271455, 49.07295918713014, 49.023358287910625, 49.10522385189931, 34.75230165074268, 33.976370881001145, 35.070800830299646, 51.46072641511758, 50.593596180280045, 51.27341066052516, 46.75976329669356, 46.85878127068281, 46.60296942293644, 39.23902707795301, 39.444463724891335, 39.847330717990786, 47.266139734536395, 46.87344807386397, 47.22269771806894, 46.52287310610214, 46.6110931119571, 45.5072463552157, 55.87987780074279, 56.38976875195901, 56.2870741399626, 42.879877040783555, 43.35963216299811, 43.23675836126009, 40.61437103897333, 40.29703076928854, 39.78043779730797, 49.75442040090759, 49.7450705555578, 49.12028623123963, 43.300307366997004, 43.16724094748497, 43.46024862676859, 56.22059269746144, 56.69847681590666, 56.527071622510746, 59.2734442812701, 58.33456668754418, 58.90690102924903, 46.6053025747339, 46.97054075511794, 46.46576314667861, 49.741087456544236, 50.1206196223696, 50.51336880152424, 47.01758701913057, 46.72665932774542, 46.63947948813437, 49.175581584374115, 50.43166645492117, 50.29993625978629, 50.424275776992246, 49.98973524818818, 49.98747205982606, 48.76575317482154, 48.82329259316127, 49.03618920842807, 50.14319220681985, 50.099575241406754, 50.30130190898974, 43.85877453287442, 42.52561055620511, 42.669060458739594, 50.291219208389506, 50.07195396721362, 49.66133265197276, 43.652193332711846, 43.727986002961785, 43.86336925501624, 43.43732202549775, 43.979582946126655, 43.54392996182044, 56.55198021170993, 56.23345324148734, 56.28383280088504, 40.837054451306656, 41.101881045227245, 40.77817053844531, 43.72059506674607, 44.358984849726156, 43.99574374159177, 56.43039533992608, 56.72430867453416, 56.9474170183142, 48.52502585450809, 48.61272980521123, 48.94166770453255, 42.609391431013734, 42.5215053881208, 42.39412974069515, 42.64992247832318, 41.70641214152177, 42.411737633248165, 47.9186669141054, 48.070739746093736, 48.20029109343885, 49.011346841851875, 49.858397855112955, 49.61233574400346, 48.318296277895556, 48.19150890037416, 48.321761412546024, 47.86082410315673, 48.18653479426091, 47.991734957943365, 43.083809574445084, 43.170558300179735, 41.99052270253499, 49.240180939435945, 50.068911042530075, 49.93338582664727, 53.56623288989066, 54.43701327592133, 54.92566871619782, 51.67993150403102, 51.87102682640155, 52.102514251445726, 49.78378369410832, 49.67879394938548, 50.030426913251475, 51.534062406669065, 51.14060035596292, 51.24573926130931, 45.51356333990891, 45.79343635340531, 45.14341529210408, 60.977407659093544, 61.5698294552664, 61.411275009314224, 52.40512406484534, 51.850229804714516, 52.04033803691466, 47.022706275184945, 47.85564054300387, 47.867556116854146, 37.41143887986739, 36.976227705677346, 37.655058597524956, 47.48503176433344, 47.03825256725152, 47.455422942837075, 51.863856777548776, 52.376304060220704, 52.57082901522516, 47.84647570053737, 48.04554817328851, 48.19806937190394, 54.54230935623248, 53.88227557142575, 54.77772380535801, 45.36123194297154, 45.71740484827508, 44.2731330593427, 56.04108912249406, 56.53020703544219, 56.76113712911804, 54.48981492221354, 54.16135302186011, 54.753167204558835, 49.03173922747372, 48.88975928723811, 49.18498560041188, 50.03519401947658, 50.18400811652343, 50.51072261358301, 50.05104139074682, 49.767250359058366, 50.13673526793717, 47.671562169988945, 47.795050514241055, 47.585126270850495, 48.210684822251395, 48.089934212466076, 47.47865739961465, 36.384353287518024, 36.49127344042063, 36.34720968455076, 55.38257073859374, 55.6688213745753, 55.7474593843023, 60.912343310813114, 60.413304279247924, 60.937732579807445, 53.217167759935066, 54.005869532624885, 53.93901409457128, 38.12665822108586, 38.22999896605809, 37.739433517058686, 49.14479695260523, 49.39900896395555, 49.19285817071794, 56.98304592321317, 56.86183611551921, 57.24862322832148, 45.90296967327595, 45.84746454283595, 45.74126782268286, 47.85875464727481, 47.50206201275189, 48.022972894211605, 56.961387130121395, 57.523985220740244, 57.31229274968307, 54.80177107950051, 55.479721294095114, 55.51694798500587, 48.223499196271106, 48.6009310061733, 48.39891713733475, 68.88721534609793, 69.12746461667119, 68.60519045591353, 43.18607607980569, 43.13161132981379, 43.36731730153163, 46.301784083247185, 46.27141231298447, 46.3944098316133, 46.34142383933067, 46.35355852544308, 47.009938224218786, 45.775370349486664, 45.475467679401234, 45.504182179768875, 38.572946203251675, 38.91853220838432, 38.92604332960521]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14717192387451222, "mean_inference_ms": 0.7123967668432148, "mean_action_processing_ms": 0.10212305845187757, "mean_env_wait_ms": 0.8454418167864877, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 940000, "timesteps_this_iter": 0, "agent_timesteps_total": 2820000, "timers": {"sample_time_ms": 10607.898, "sample_throughput": 471.347, "load_time_ms": 0.2, "load_throughput": 25001812.113, "learn_time_ms": 1700.825, "learn_throughput": 2939.749, "update_time_ms": 8.797}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.4166779685891016e-36, "cur_lr": 0.0005000000000000001, "total_loss": 9.529979801177978, "policy_loss": -0.0014451682280516298, "vf_loss": 9.630664157867432, "vf_explained_var": 0.010659801959991454, "kl": 0.004684743634477162, "entropy": 9.923937797546387, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 940000, "num_agent_steps_sampled": 2820000, "num_steps_trained": 940000, "num_agent_steps_trained": 2820000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2739, "training_iteration": 188, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-43-18", "timestamp": 1706229798, "time_this_iter_s": 10.715885639190674, "time_total_s": 2036.8469042778015, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028379E430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2036.8469042778015, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 10.186666666666667, "ram_util_percent": 52.333333333333336}}
{"episode_reward_max": 206.6198704186826, "episode_reward_min": 103.79947336204347, "episode_reward_mean": 147.24563178962853, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 33.976370881001145}, "policy_reward_max": {"shared_policy": 69.12746461667119}, "policy_reward_mean": {"shared_policy": 49.081877263209506}, "custom_metrics": {}, "hist_stats": {"episode_reward": [127.04397269058971, 125.49797632172704, 138.58505168557153, 141.60240403935322, 111.79963500611484, 142.53571774996843, 165.81206005066645, 177.84288439527168, 154.6059542223809, 137.77757162041965, 178.11117494851345, 111.683245845139, 153.67821407876934, 147.20154132694014, 103.79947336204347, 153.32773325592274, 140.22151399031281, 118.53082152083513, 141.36228552646915, 138.64121257327506, 168.55672069266438, 129.47626756504172, 120.69183960556984, 148.6197771877048, 129.92779694125048, 169.44614113587878, 176.51491199806333, 140.04160647653043, 150.37507588043815, 140.38372583501038, 149.90718429908154, 150.40148308500645, 146.6252349764109, 150.54406935721627, 129.05344554781936, 150.02450582757604, 131.24354859069004, 130.96083493344497, 169.06926625408244, 122.71710603497921, 132.0753236580639, 170.10212103277445, 146.07942336425168, 127.52502655982968, 126.76807225309311, 144.18969775363806, 148.4820804409684, 144.83156659081564, 144.03909385536087, 128.24489057715982, 149.24247780861322, 162.9289148820097, 155.6534725818781, 149.49300455674526, 153.92040202394125, 136.45041498541838, 183.95851212367404, 156.2956919064746, 142.74590293504306, 112.04272518306969, 141.978707274422, 156.8109898529947, 144.0900932457301, 163.20230873301614, 135.3517698505894, 169.33243328705416, 163.40433514863227, 147.1064841151236, 150.72992474958303, 149.95502701774248, 143.05173895508048, 143.77927643433193, 109.22283641248941, 166.79885149747125, 182.2633801698683, 161.16205138713133, 114.09609070420264, 147.73666408727902, 171.09350526705396, 137.49170203879473, 143.3837895542384, 171.7976651005449, 165.79844035860134, 145.22334733977917, 206.6198704186826, 129.68500471115118, 138.96760622784478, 139.70492058899228, 136.7550202086568, 116.4175217412412, 131.05037422850737, 169.0666262954471, 141.3053961002735, 170.49386039748782, 202.24596636742348, 143.59177113417536, 183.5188490189614, 151.0730347321369, 155.93203565850837, 153.9641070440413], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [42.0579303925236, 42.601080386278525, 42.384961911787585, 40.94885390996933, 42.495316814631224, 42.053805597126484, 46.163071162998676, 46.23502995073795, 46.18695057183504, 47.2779904976487, 47.451530221849666, 46.87288331985472, 37.08394531905651, 36.93614658713341, 37.77954309992492, 47.69593495937686, 47.21309640506904, 47.62668638552229, 55.42632921288411, 54.99726886550586, 55.388461972276374, 59.05829422672589, 59.36153013755877, 59.42306003098686, 51.3413674533367, 51.514295205473886, 51.750291563570485, 45.937302375833184, 46.17882871317366, 45.66144053141275, 59.41980498656629, 59.27526985108851, 59.416100110858665, 36.888789306084306, 37.28680133322874, 37.507655205825955, 51.47941858631869, 50.95555381973584, 51.24324167271455, 49.07295918713014, 49.023358287910625, 49.10522385189931, 34.75230165074268, 33.976370881001145, 35.070800830299646, 51.46072641511758, 50.593596180280045, 51.27341066052516, 46.75976329669356, 46.85878127068281, 46.60296942293644, 39.23902707795301, 39.444463724891335, 39.847330717990786, 47.266139734536395, 46.87344807386397, 47.22269771806894, 46.52287310610214, 46.6110931119571, 45.5072463552157, 55.87987780074279, 56.38976875195901, 56.2870741399626, 42.879877040783555, 43.35963216299811, 43.23675836126009, 40.61437103897333, 40.29703076928854, 39.78043779730797, 49.75442040090759, 49.7450705555578, 49.12028623123963, 43.300307366997004, 43.16724094748497, 43.46024862676859, 56.22059269746144, 56.69847681590666, 56.527071622510746, 59.2734442812701, 58.33456668754418, 58.90690102924903, 46.6053025747339, 46.97054075511794, 46.46576314667861, 49.741087456544236, 50.1206196223696, 50.51336880152424, 47.01758701913057, 46.72665932774542, 46.63947948813437, 49.175581584374115, 50.43166645492117, 50.29993625978629, 50.424275776992246, 49.98973524818818, 49.98747205982606, 48.76575317482154, 48.82329259316127, 49.03618920842807, 50.14319220681985, 50.099575241406754, 50.30130190898974, 43.85877453287442, 42.52561055620511, 42.669060458739594, 50.291219208389506, 50.07195396721362, 49.66133265197276, 43.652193332711846, 43.727986002961785, 43.86336925501624, 43.43732202549775, 43.979582946126655, 43.54392996182044, 56.55198021170993, 56.23345324148734, 56.28383280088504, 40.837054451306656, 41.101881045227245, 40.77817053844531, 43.72059506674607, 44.358984849726156, 43.99574374159177, 56.43039533992608, 56.72430867453416, 56.9474170183142, 48.52502585450809, 48.61272980521123, 48.94166770453255, 42.609391431013734, 42.5215053881208, 42.39412974069515, 42.64992247832318, 41.70641214152177, 42.411737633248165, 47.9186669141054, 48.070739746093736, 48.20029109343885, 49.011346841851875, 49.858397855112955, 49.61233574400346, 48.318296277895556, 48.19150890037416, 48.321761412546024, 47.86082410315673, 48.18653479426091, 47.991734957943365, 43.083809574445084, 43.170558300179735, 41.99052270253499, 49.240180939435945, 50.068911042530075, 49.93338582664727, 53.56623288989066, 54.43701327592133, 54.92566871619782, 51.67993150403102, 51.87102682640155, 52.102514251445726, 49.78378369410832, 49.67879394938548, 50.030426913251475, 51.534062406669065, 51.14060035596292, 51.24573926130931, 45.51356333990891, 45.79343635340531, 45.14341529210408, 60.977407659093544, 61.5698294552664, 61.411275009314224, 52.40512406484534, 51.850229804714516, 52.04033803691466, 47.022706275184945, 47.85564054300387, 47.867556116854146, 37.41143887986739, 36.976227705677346, 37.655058597524956, 47.48503176433344, 47.03825256725152, 47.455422942837075, 51.863856777548776, 52.376304060220704, 52.57082901522516, 47.84647570053737, 48.04554817328851, 48.19806937190394, 54.54230935623248, 53.88227557142575, 54.77772380535801, 45.36123194297154, 45.71740484827508, 44.2731330593427, 56.04108912249406, 56.53020703544219, 56.76113712911804, 54.48981492221354, 54.16135302186011, 54.753167204558835, 49.03173922747372, 48.88975928723811, 49.18498560041188, 50.03519401947658, 50.18400811652343, 50.51072261358301, 50.05104139074682, 49.767250359058366, 50.13673526793717, 47.671562169988945, 47.795050514241055, 47.585126270850495, 48.210684822251395, 48.089934212466076, 47.47865739961465, 36.384353287518024, 36.49127344042063, 36.34720968455076, 55.38257073859374, 55.6688213745753, 55.7474593843023, 60.912343310813114, 60.413304279247924, 60.937732579807445, 53.217167759935066, 54.005869532624885, 53.93901409457128, 38.12665822108586, 38.22999896605809, 37.739433517058686, 49.14479695260523, 49.39900896395555, 49.19285817071794, 56.98304592321317, 56.86183611551921, 57.24862322832148, 45.90296967327595, 45.84746454283595, 45.74126782268286, 47.85875464727481, 47.50206201275189, 48.022972894211605, 56.961387130121395, 57.523985220740244, 57.31229274968307, 54.80177107950051, 55.479721294095114, 55.51694798500587, 48.223499196271106, 48.6009310061733, 48.39891713733475, 68.88721534609793, 69.12746461667119, 68.60519045591353, 43.18607607980569, 43.13161132981379, 43.36731730153163, 46.301784083247185, 46.27141231298447, 46.3944098316133, 46.34142383933067, 46.35355852544308, 47.009938224218786, 45.775370349486664, 45.475467679401234, 45.504182179768875, 38.572946203251675, 38.91853220838432, 38.92604332960521, 43.28673350314298, 44.01610855634013, 43.74753216902414, 56.35269700735806, 56.42166285961865, 56.2922664284706, 46.785862500468895, 47.47987079659167, 47.039662803212806, 56.42461773753165, 57.00333499163388, 57.06590766832231, 67.37172508736451, 67.44462276001771, 67.4296185200413, 47.84490117927392, 47.648945582409695, 48.09792437249173, 61.301730860024676, 60.85360628366469, 61.36351187527178, 50.17067226519187, 50.48977133988713, 50.412591127057865, 52.08575568099816, 52.060990193237856, 51.78528978427251, 51.71233487253387, 50.51726176341374, 51.73451040809353]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14710986782050461, "mean_inference_ms": 0.7121763974810049, "mean_action_processing_ms": 0.10210283645627712, "mean_env_wait_ms": 0.8451413789329548, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 945000, "timesteps_this_iter": 0, "agent_timesteps_total": 2835000, "timers": {"sample_time_ms": 10426.648, "sample_throughput": 479.54, "load_time_ms": 0.2, "load_throughput": 25001812.113, "learn_time_ms": 1678.831, "learn_throughput": 2978.263, "update_time_ms": 8.773}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7083389842945508e-36, "cur_lr": 0.0005000000000000001, "total_loss": 10.08584041595459, "policy_loss": 0.0005275238255388004, "vf_loss": 10.184971237182618, "vf_explained_var": 0.025437575578689576, "kl": 0.010779054323262377, "entropy": 9.965885448455811, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 945000, "num_agent_steps_sampled": 2835000, "num_steps_trained": 945000, "num_agent_steps_trained": 2835000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2749, "training_iteration": 189, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-43-28", "timestamp": 1706229808, "time_this_iter_s": 10.120507955551147, "time_total_s": 2046.9674122333527, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282218280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2046.9674122333527, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 9.500000000000002, "ram_util_percent": 52.392857142857125}}
{"episode_reward_max": 206.6198704186826, "episode_reward_min": 103.79947336204347, "episode_reward_mean": 147.55984434384678, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 33.976370881001145}, "policy_reward_max": {"shared_policy": 69.12746461667119}, "policy_reward_mean": {"shared_policy": 49.18661478128226}, "custom_metrics": {}, "hist_stats": {"episode_reward": [178.11117494851345, 111.683245845139, 153.67821407876934, 147.20154132694014, 103.79947336204347, 153.32773325592274, 140.22151399031281, 118.53082152083513, 141.36228552646915, 138.64121257327506, 168.55672069266438, 129.47626756504172, 120.69183960556984, 148.6197771877048, 129.92779694125048, 169.44614113587878, 176.51491199806333, 140.04160647653043, 150.37507588043815, 140.38372583501038, 149.90718429908154, 150.40148308500645, 146.6252349764109, 150.54406935721627, 129.05344554781936, 150.02450582757604, 131.24354859069004, 130.96083493344497, 169.06926625408244, 122.71710603497921, 132.0753236580639, 170.10212103277445, 146.07942336425168, 127.52502655982968, 126.76807225309311, 144.18969775363806, 148.4820804409684, 144.83156659081564, 144.03909385536087, 128.24489057715982, 149.24247780861322, 162.9289148820097, 155.6534725818781, 149.49300455674526, 153.92040202394125, 136.45041498541838, 183.95851212367404, 156.2956919064746, 142.74590293504306, 112.04272518306969, 141.978707274422, 156.8109898529947, 144.0900932457301, 163.20230873301614, 135.3517698505894, 169.33243328705416, 163.40433514863227, 147.1064841151236, 150.72992474958303, 149.95502701774248, 143.05173895508048, 143.77927643433193, 109.22283641248941, 166.79885149747125, 182.2633801698683, 161.16205138713133, 114.09609070420264, 147.73666408727902, 171.09350526705396, 137.49170203879473, 143.3837895542384, 171.7976651005449, 165.79844035860134, 145.22334733977917, 206.6198704186826, 129.68500471115118, 138.96760622784478, 139.70492058899228, 136.7550202086568, 116.4175217412412, 131.05037422850737, 169.0666262954471, 141.3053961002735, 170.49386039748782, 202.24596636742348, 143.59177113417536, 183.5188490189614, 151.0730347321369, 155.93203565850837, 153.9641070440413, 125.92463137581944, 124.75124145857987, 144.927408784628, 129.74545177817322, 158.61260835081356, 167.1709123551846, 140.50157412048424, 147.49124822393048, 161.86547507345662, 153.53393168281772], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [59.41980498656629, 59.27526985108851, 59.416100110858665, 36.888789306084306, 37.28680133322874, 37.507655205825955, 51.47941858631869, 50.95555381973584, 51.24324167271455, 49.07295918713014, 49.023358287910625, 49.10522385189931, 34.75230165074268, 33.976370881001145, 35.070800830299646, 51.46072641511758, 50.593596180280045, 51.27341066052516, 46.75976329669356, 46.85878127068281, 46.60296942293644, 39.23902707795301, 39.444463724891335, 39.847330717990786, 47.266139734536395, 46.87344807386397, 47.22269771806894, 46.52287310610214, 46.6110931119571, 45.5072463552157, 55.87987780074279, 56.38976875195901, 56.2870741399626, 42.879877040783555, 43.35963216299811, 43.23675836126009, 40.61437103897333, 40.29703076928854, 39.78043779730797, 49.75442040090759, 49.7450705555578, 49.12028623123963, 43.300307366997004, 43.16724094748497, 43.46024862676859, 56.22059269746144, 56.69847681590666, 56.527071622510746, 59.2734442812701, 58.33456668754418, 58.90690102924903, 46.6053025747339, 46.97054075511794, 46.46576314667861, 49.741087456544236, 50.1206196223696, 50.51336880152424, 47.01758701913057, 46.72665932774542, 46.63947948813437, 49.175581584374115, 50.43166645492117, 50.29993625978629, 50.424275776992246, 49.98973524818818, 49.98747205982606, 48.76575317482154, 48.82329259316127, 49.03618920842807, 50.14319220681985, 50.099575241406754, 50.30130190898974, 43.85877453287442, 42.52561055620511, 42.669060458739594, 50.291219208389506, 50.07195396721362, 49.66133265197276, 43.652193332711846, 43.727986002961785, 43.86336925501624, 43.43732202549775, 43.979582946126655, 43.54392996182044, 56.55198021170993, 56.23345324148734, 56.28383280088504, 40.837054451306656, 41.101881045227245, 40.77817053844531, 43.72059506674607, 44.358984849726156, 43.99574374159177, 56.43039533992608, 56.72430867453416, 56.9474170183142, 48.52502585450809, 48.61272980521123, 48.94166770453255, 42.609391431013734, 42.5215053881208, 42.39412974069515, 42.64992247832318, 41.70641214152177, 42.411737633248165, 47.9186669141054, 48.070739746093736, 48.20029109343885, 49.011346841851875, 49.858397855112955, 49.61233574400346, 48.318296277895556, 48.19150890037416, 48.321761412546024, 47.86082410315673, 48.18653479426091, 47.991734957943365, 43.083809574445084, 43.170558300179735, 41.99052270253499, 49.240180939435945, 50.068911042530075, 49.93338582664727, 53.56623288989066, 54.43701327592133, 54.92566871619782, 51.67993150403102, 51.87102682640155, 52.102514251445726, 49.78378369410832, 49.67879394938548, 50.030426913251475, 51.534062406669065, 51.14060035596292, 51.24573926130931, 45.51356333990891, 45.79343635340531, 45.14341529210408, 60.977407659093544, 61.5698294552664, 61.411275009314224, 52.40512406484534, 51.850229804714516, 52.04033803691466, 47.022706275184945, 47.85564054300387, 47.867556116854146, 37.41143887986739, 36.976227705677346, 37.655058597524956, 47.48503176433344, 47.03825256725152, 47.455422942837075, 51.863856777548776, 52.376304060220704, 52.57082901522516, 47.84647570053737, 48.04554817328851, 48.19806937190394, 54.54230935623248, 53.88227557142575, 54.77772380535801, 45.36123194297154, 45.71740484827508, 44.2731330593427, 56.04108912249406, 56.53020703544219, 56.76113712911804, 54.48981492221354, 54.16135302186011, 54.753167204558835, 49.03173922747372, 48.88975928723811, 49.18498560041188, 50.03519401947658, 50.18400811652343, 50.51072261358301, 50.05104139074682, 49.767250359058366, 50.13673526793717, 47.671562169988945, 47.795050514241055, 47.585126270850495, 48.210684822251395, 48.089934212466076, 47.47865739961465, 36.384353287518024, 36.49127344042063, 36.34720968455076, 55.38257073859374, 55.6688213745753, 55.7474593843023, 60.912343310813114, 60.413304279247924, 60.937732579807445, 53.217167759935066, 54.005869532624885, 53.93901409457128, 38.12665822108586, 38.22999896605809, 37.739433517058686, 49.14479695260523, 49.39900896395555, 49.19285817071794, 56.98304592321317, 56.86183611551921, 57.24862322832148, 45.90296967327595, 45.84746454283595, 45.74126782268286, 47.85875464727481, 47.50206201275189, 48.022972894211605, 56.961387130121395, 57.523985220740244, 57.31229274968307, 54.80177107950051, 55.479721294095114, 55.51694798500587, 48.223499196271106, 48.6009310061733, 48.39891713733475, 68.88721534609793, 69.12746461667119, 68.60519045591353, 43.18607607980569, 43.13161132981379, 43.36731730153163, 46.301784083247185, 46.27141231298447, 46.3944098316133, 46.34142383933067, 46.35355852544308, 47.009938224218786, 45.775370349486664, 45.475467679401234, 45.504182179768875, 38.572946203251675, 38.91853220838432, 38.92604332960521, 43.28673350314298, 44.01610855634013, 43.74753216902414, 56.35269700735806, 56.42166285961865, 56.2922664284706, 46.785862500468895, 47.47987079659167, 47.039662803212806, 56.42461773753165, 57.00333499163388, 57.06590766832231, 67.37172508736451, 67.44462276001771, 67.4296185200413, 47.84490117927392, 47.648945582409695, 48.09792437249173, 61.301730860024676, 60.85360628366469, 61.36351187527178, 50.17067226519187, 50.48977133988713, 50.412591127057865, 52.08575568099816, 52.060990193237856, 51.78528978427251, 51.71233487253387, 50.51726176341374, 51.73451040809353, 42.16444071382284, 42.47196799144149, 41.288222670555115, 41.11413563291231, 42.22787601562837, 41.40922981003919, 48.62626042713721, 48.3647002701958, 47.93644808729489, 43.23625911275545, 43.23155332605043, 43.27763933936754, 52.917568155874804, 52.95878640686472, 52.73625378807385, 55.660905525088296, 55.96775865554808, 55.542248174548135, 47.06138172217955, 47.02892338422437, 46.41126901408036, 49.110549375414834, 48.974234782159314, 49.406464066356406, 54.1533750941356, 54.11935708423455, 53.5927428950866, 51.121834043413386, 51.16729994490741, 51.244797694496796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14707660995673943, "mean_inference_ms": 0.7120907612789108, "mean_action_processing_ms": 0.10209370042021129, "mean_env_wait_ms": 0.8449683772075041, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 950000, "timesteps_this_iter": 0, "agent_timesteps_total": 2850000, "timers": {"sample_time_ms": 10508.155, "sample_throughput": 475.821, "load_time_ms": 0.3, "load_throughput": 16650670.901, "learn_time_ms": 1675.854, "learn_throughput": 2983.554, "update_time_ms": 8.773}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7083389842945508e-36, "cur_lr": 0.0005000000000000001, "total_loss": 8.955290603637696, "policy_loss": 0.00026476434917614976, "vf_loss": 9.054078960418702, "vf_explained_var": 0.007379180192947388, "kl": 0.008739965176261712, "entropy": 9.905318450927734, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 950000, "num_agent_steps_sampled": 2850000, "num_steps_trained": 950000, "num_agent_steps_trained": 2850000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2759, "training_iteration": 190, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-43-39", "timestamp": 1706229819, "time_this_iter_s": 10.947304010391235, "time_total_s": 2057.914716243744, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028379E040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2057.914716243744, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 10.83125, "ram_util_percent": 52.4}}
{"episode_reward_max": 206.6198704186826, "episode_reward_min": 109.22283641248941, "episode_reward_mean": 149.6390016123811, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 36.34720968455076}, "policy_reward_max": {"shared_policy": 69.12746461667119}, "policy_reward_mean": {"shared_policy": 49.87966720412703}, "custom_metrics": {}, "hist_stats": {"episode_reward": [168.55672069266438, 129.47626756504172, 120.69183960556984, 148.6197771877048, 129.92779694125048, 169.44614113587878, 176.51491199806333, 140.04160647653043, 150.37507588043815, 140.38372583501038, 149.90718429908154, 150.40148308500645, 146.6252349764109, 150.54406935721627, 129.05344554781936, 150.02450582757604, 131.24354859069004, 130.96083493344497, 169.06926625408244, 122.71710603497921, 132.0753236580639, 170.10212103277445, 146.07942336425168, 127.52502655982968, 126.76807225309311, 144.18969775363806, 148.4820804409684, 144.83156659081564, 144.03909385536087, 128.24489057715982, 149.24247780861322, 162.9289148820097, 155.6534725818781, 149.49300455674526, 153.92040202394125, 136.45041498541838, 183.95851212367404, 156.2956919064746, 142.74590293504306, 112.04272518306969, 141.978707274422, 156.8109898529947, 144.0900932457301, 163.20230873301614, 135.3517698505894, 169.33243328705416, 163.40433514863227, 147.1064841151236, 150.72992474958303, 149.95502701774248, 143.05173895508048, 143.77927643433193, 109.22283641248941, 166.79885149747125, 182.2633801698683, 161.16205138713133, 114.09609070420264, 147.73666408727902, 171.09350526705396, 137.49170203879473, 143.3837895542384, 171.7976651005449, 165.79844035860134, 145.22334733977917, 206.6198704186826, 129.68500471115118, 138.96760622784478, 139.70492058899228, 136.7550202086568, 116.4175217412412, 131.05037422850737, 169.0666262954471, 141.3053961002735, 170.49386039748782, 202.24596636742348, 143.59177113417536, 183.5188490189614, 151.0730347321369, 155.93203565850837, 153.9641070440413, 125.92463137581944, 124.75124145857987, 144.927408784628, 129.74545177817322, 158.61260835081356, 167.1709123551846, 140.50157412048424, 147.49124822393048, 161.86547507345662, 153.53393168281772, 159.1025096401569, 175.2023001915805, 192.17758149281164, 136.5868280753493, 150.35680951923146, 152.10772963613275, 162.98950476199374, 147.453862519178, 147.51354953646646, 170.98226790875177], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [55.87987780074279, 56.38976875195901, 56.2870741399626, 42.879877040783555, 43.35963216299811, 43.23675836126009, 40.61437103897333, 40.29703076928854, 39.78043779730797, 49.75442040090759, 49.7450705555578, 49.12028623123963, 43.300307366997004, 43.16724094748497, 43.46024862676859, 56.22059269746144, 56.69847681590666, 56.527071622510746, 59.2734442812701, 58.33456668754418, 58.90690102924903, 46.6053025747339, 46.97054075511794, 46.46576314667861, 49.741087456544236, 50.1206196223696, 50.51336880152424, 47.01758701913057, 46.72665932774542, 46.63947948813437, 49.175581584374115, 50.43166645492117, 50.29993625978629, 50.424275776992246, 49.98973524818818, 49.98747205982606, 48.76575317482154, 48.82329259316127, 49.03618920842807, 50.14319220681985, 50.099575241406754, 50.30130190898974, 43.85877453287442, 42.52561055620511, 42.669060458739594, 50.291219208389506, 50.07195396721362, 49.66133265197276, 43.652193332711846, 43.727986002961785, 43.86336925501624, 43.43732202549775, 43.979582946126655, 43.54392996182044, 56.55198021170993, 56.23345324148734, 56.28383280088504, 40.837054451306656, 41.101881045227245, 40.77817053844531, 43.72059506674607, 44.358984849726156, 43.99574374159177, 56.43039533992608, 56.72430867453416, 56.9474170183142, 48.52502585450809, 48.61272980521123, 48.94166770453255, 42.609391431013734, 42.5215053881208, 42.39412974069515, 42.64992247832318, 41.70641214152177, 42.411737633248165, 47.9186669141054, 48.070739746093736, 48.20029109343885, 49.011346841851875, 49.858397855112955, 49.61233574400346, 48.318296277895556, 48.19150890037416, 48.321761412546024, 47.86082410315673, 48.18653479426091, 47.991734957943365, 43.083809574445084, 43.170558300179735, 41.99052270253499, 49.240180939435945, 50.068911042530075, 49.93338582664727, 53.56623288989066, 54.43701327592133, 54.92566871619782, 51.67993150403102, 51.87102682640155, 52.102514251445726, 49.78378369410832, 49.67879394938548, 50.030426913251475, 51.534062406669065, 51.14060035596292, 51.24573926130931, 45.51356333990891, 45.79343635340531, 45.14341529210408, 60.977407659093544, 61.5698294552664, 61.411275009314224, 52.40512406484534, 51.850229804714516, 52.04033803691466, 47.022706275184945, 47.85564054300387, 47.867556116854146, 37.41143887986739, 36.976227705677346, 37.655058597524956, 47.48503176433344, 47.03825256725152, 47.455422942837075, 51.863856777548776, 52.376304060220704, 52.57082901522516, 47.84647570053737, 48.04554817328851, 48.19806937190394, 54.54230935623248, 53.88227557142575, 54.77772380535801, 45.36123194297154, 45.71740484827508, 44.2731330593427, 56.04108912249406, 56.53020703544219, 56.76113712911804, 54.48981492221354, 54.16135302186011, 54.753167204558835, 49.03173922747372, 48.88975928723811, 49.18498560041188, 50.03519401947658, 50.18400811652343, 50.51072261358301, 50.05104139074682, 49.767250359058366, 50.13673526793717, 47.671562169988945, 47.795050514241055, 47.585126270850495, 48.210684822251395, 48.089934212466076, 47.47865739961465, 36.384353287518024, 36.49127344042063, 36.34720968455076, 55.38257073859374, 55.6688213745753, 55.7474593843023, 60.912343310813114, 60.413304279247924, 60.937732579807445, 53.217167759935066, 54.005869532624885, 53.93901409457128, 38.12665822108586, 38.22999896605809, 37.739433517058686, 49.14479695260523, 49.39900896395555, 49.19285817071794, 56.98304592321317, 56.86183611551921, 57.24862322832148, 45.90296967327595, 45.84746454283595, 45.74126782268286, 47.85875464727481, 47.50206201275189, 48.022972894211605, 56.961387130121395, 57.523985220740244, 57.31229274968307, 54.80177107950051, 55.479721294095114, 55.51694798500587, 48.223499196271106, 48.6009310061733, 48.39891713733475, 68.88721534609793, 69.12746461667119, 68.60519045591353, 43.18607607980569, 43.13161132981379, 43.36731730153163, 46.301784083247185, 46.27141231298447, 46.3944098316133, 46.34142383933067, 46.35355852544308, 47.009938224218786, 45.775370349486664, 45.475467679401234, 45.504182179768875, 38.572946203251675, 38.91853220838432, 38.92604332960521, 43.28673350314298, 44.01610855634013, 43.74753216902414, 56.35269700735806, 56.42166285961865, 56.2922664284706, 46.785862500468895, 47.47987079659167, 47.039662803212806, 56.42461773753165, 57.00333499163388, 57.06590766832231, 67.37172508736451, 67.44462276001771, 67.4296185200413, 47.84490117927392, 47.648945582409695, 48.09792437249173, 61.301730860024676, 60.85360628366469, 61.36351187527178, 50.17067226519187, 50.48977133988713, 50.412591127057865, 52.08575568099816, 52.060990193237856, 51.78528978427251, 51.71233487253387, 50.51726176341374, 51.73451040809353, 42.16444071382284, 42.47196799144149, 41.288222670555115, 41.11413563291231, 42.22787601562837, 41.40922981003919, 48.62626042713721, 48.3647002701958, 47.93644808729489, 43.23625911275545, 43.23155332605043, 43.27763933936754, 52.917568155874804, 52.95878640686472, 52.73625378807385, 55.660905525088296, 55.96775865554808, 55.542248174548135, 47.06138172217955, 47.02892338422437, 46.41126901408036, 49.110549375414834, 48.974234782159314, 49.406464066356406, 54.1533750941356, 54.11935708423455, 53.5927428950866, 51.121834043413386, 51.16729994490741, 51.244797694496796, 52.66169045865534, 53.06494717299937, 53.37587200850247, 58.39301847418149, 58.04441541930039, 58.76486629809854, 64.2844076777498, 63.63870709637801, 64.25446671868364, 45.733043275773525, 45.661362543702126, 45.19242225587368, 49.99336547652881, 50.06201922396819, 50.30142481873433, 50.68756409734486, 50.61513793468474, 50.805027604103074, 54.2907726317644, 54.27145573496817, 54.42727639526127, 49.18166752594213, 49.22669985690543, 49.04549513633053, 49.51454221705596, 48.87485071520011, 49.12415660421054, 56.68773385882376, 57.13769187871365, 57.15684217121451]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14704179251708724, "mean_inference_ms": 0.7119908858589891, "mean_action_processing_ms": 0.10208326758178897, "mean_env_wait_ms": 0.8447889764431781, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 955000, "timesteps_this_iter": 0, "agent_timesteps_total": 2865000, "timers": {"sample_time_ms": 10479.048, "sample_throughput": 477.143, "load_time_ms": 0.3, "load_throughput": 16650670.901, "learn_time_ms": 1678.322, "learn_throughput": 2979.167, "update_time_ms": 8.66}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7083389842945508e-36, "cur_lr": 0.0005000000000000001, "total_loss": 9.492834377288819, "policy_loss": 0.0001957773944486263, "vf_loss": 9.590192890167236, "vf_explained_var": 0.012796425819396972, "kl": 0.005083208368210569, "entropy": 9.755475425720215, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 955000, "num_agent_steps_sampled": 2865000, "num_steps_trained": 955000, "num_agent_steps_trained": 2865000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2769, "training_iteration": 191, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-43-49", "timestamp": 1706229829, "time_this_iter_s": 10.02178692817688, "time_total_s": 2067.936503171921, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202823BE820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2067.936503171921, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 9.264285714285714, "ram_util_percent": 51.91428571428572}}
{"episode_reward_max": 206.6198704186826, "episode_reward_min": 109.22283641248941, "episode_reward_mean": 149.0780480712927, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 36.34720968455076}, "policy_reward_max": {"shared_policy": 69.12746461667119}, "policy_reward_mean": {"shared_policy": 49.69268269043091}, "custom_metrics": {}, "hist_stats": {"episode_reward": [149.90718429908154, 150.40148308500645, 146.6252349764109, 150.54406935721627, 129.05344554781936, 150.02450582757604, 131.24354859069004, 130.96083493344497, 169.06926625408244, 122.71710603497921, 132.0753236580639, 170.10212103277445, 146.07942336425168, 127.52502655982968, 126.76807225309311, 144.18969775363806, 148.4820804409684, 144.83156659081564, 144.03909385536087, 128.24489057715982, 149.24247780861322, 162.9289148820097, 155.6534725818781, 149.49300455674526, 153.92040202394125, 136.45041498541838, 183.95851212367404, 156.2956919064746, 142.74590293504306, 112.04272518306969, 141.978707274422, 156.8109898529947, 144.0900932457301, 163.20230873301614, 135.3517698505894, 169.33243328705416, 163.40433514863227, 147.1064841151236, 150.72992474958303, 149.95502701774248, 143.05173895508048, 143.77927643433193, 109.22283641248941, 166.79885149747125, 182.2633801698683, 161.16205138713133, 114.09609070420264, 147.73666408727902, 171.09350526705396, 137.49170203879473, 143.3837895542384, 171.7976651005449, 165.79844035860134, 145.22334733977917, 206.6198704186826, 129.68500471115118, 138.96760622784478, 139.70492058899228, 136.7550202086568, 116.4175217412412, 131.05037422850737, 169.0666262954471, 141.3053961002735, 170.49386039748782, 202.24596636742348, 143.59177113417536, 183.5188490189614, 151.0730347321369, 155.93203565850837, 153.9641070440413, 125.92463137581944, 124.75124145857987, 144.927408784628, 129.74545177817322, 158.61260835081356, 167.1709123551846, 140.50157412048424, 147.49124822393048, 161.86547507345662, 153.53393168281772, 159.1025096401569, 175.2023001915805, 192.17758149281164, 136.5868280753493, 150.35680951923146, 152.10772963613275, 162.98950476199374, 147.453862519178, 147.51354953646646, 170.98226790875177, 151.85434692539283, 137.6279569503388, 128.07822167128325, 141.94356634840372, 132.23894681432267, 122.80738702113737, 159.73740587010977, 139.21607595914963, 175.05550326965735, 129.37909837951895], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [49.175581584374115, 50.43166645492117, 50.29993625978629, 50.424275776992246, 49.98973524818818, 49.98747205982606, 48.76575317482154, 48.82329259316127, 49.03618920842807, 50.14319220681985, 50.099575241406754, 50.30130190898974, 43.85877453287442, 42.52561055620511, 42.669060458739594, 50.291219208389506, 50.07195396721362, 49.66133265197276, 43.652193332711846, 43.727986002961785, 43.86336925501624, 43.43732202549775, 43.979582946126655, 43.54392996182044, 56.55198021170993, 56.23345324148734, 56.28383280088504, 40.837054451306656, 41.101881045227245, 40.77817053844531, 43.72059506674607, 44.358984849726156, 43.99574374159177, 56.43039533992608, 56.72430867453416, 56.9474170183142, 48.52502585450809, 48.61272980521123, 48.94166770453255, 42.609391431013734, 42.5215053881208, 42.39412974069515, 42.64992247832318, 41.70641214152177, 42.411737633248165, 47.9186669141054, 48.070739746093736, 48.20029109343885, 49.011346841851875, 49.858397855112955, 49.61233574400346, 48.318296277895556, 48.19150890037416, 48.321761412546024, 47.86082410315673, 48.18653479426091, 47.991734957943365, 43.083809574445084, 43.170558300179735, 41.99052270253499, 49.240180939435945, 50.068911042530075, 49.93338582664727, 53.56623288989066, 54.43701327592133, 54.92566871619782, 51.67993150403102, 51.87102682640155, 52.102514251445726, 49.78378369410832, 49.67879394938548, 50.030426913251475, 51.534062406669065, 51.14060035596292, 51.24573926130931, 45.51356333990891, 45.79343635340531, 45.14341529210408, 60.977407659093544, 61.5698294552664, 61.411275009314224, 52.40512406484534, 51.850229804714516, 52.04033803691466, 47.022706275184945, 47.85564054300387, 47.867556116854146, 37.41143887986739, 36.976227705677346, 37.655058597524956, 47.48503176433344, 47.03825256725152, 47.455422942837075, 51.863856777548776, 52.376304060220704, 52.57082901522516, 47.84647570053737, 48.04554817328851, 48.19806937190394, 54.54230935623248, 53.88227557142575, 54.77772380535801, 45.36123194297154, 45.71740484827508, 44.2731330593427, 56.04108912249406, 56.53020703544219, 56.76113712911804, 54.48981492221354, 54.16135302186011, 54.753167204558835, 49.03173922747372, 48.88975928723811, 49.18498560041188, 50.03519401947658, 50.18400811652343, 50.51072261358301, 50.05104139074682, 49.767250359058366, 50.13673526793717, 47.671562169988945, 47.795050514241055, 47.585126270850495, 48.210684822251395, 48.089934212466076, 47.47865739961465, 36.384353287518024, 36.49127344042063, 36.34720968455076, 55.38257073859374, 55.6688213745753, 55.7474593843023, 60.912343310813114, 60.413304279247924, 60.937732579807445, 53.217167759935066, 54.005869532624885, 53.93901409457128, 38.12665822108586, 38.22999896605809, 37.739433517058686, 49.14479695260523, 49.39900896395555, 49.19285817071794, 56.98304592321317, 56.86183611551921, 57.24862322832148, 45.90296967327595, 45.84746454283595, 45.74126782268286, 47.85875464727481, 47.50206201275189, 48.022972894211605, 56.961387130121395, 57.523985220740244, 57.31229274968307, 54.80177107950051, 55.479721294095114, 55.51694798500587, 48.223499196271106, 48.6009310061733, 48.39891713733475, 68.88721534609793, 69.12746461667119, 68.60519045591353, 43.18607607980569, 43.13161132981379, 43.36731730153163, 46.301784083247185, 46.27141231298447, 46.3944098316133, 46.34142383933067, 46.35355852544308, 47.009938224218786, 45.775370349486664, 45.475467679401234, 45.504182179768875, 38.572946203251675, 38.91853220838432, 38.92604332960521, 43.28673350314298, 44.01610855634013, 43.74753216902414, 56.35269700735806, 56.42166285961865, 56.2922664284706, 46.785862500468895, 47.47987079659167, 47.039662803212806, 56.42461773753165, 57.00333499163388, 57.06590766832231, 67.37172508736451, 67.44462276001771, 67.4296185200413, 47.84490117927392, 47.648945582409695, 48.09792437249173, 61.301730860024676, 60.85360628366469, 61.36351187527178, 50.17067226519187, 50.48977133988713, 50.412591127057865, 52.08575568099816, 52.060990193237856, 51.78528978427251, 51.71233487253387, 50.51726176341374, 51.73451040809353, 42.16444071382284, 42.47196799144149, 41.288222670555115, 41.11413563291231, 42.22787601562837, 41.40922981003919, 48.62626042713721, 48.3647002701958, 47.93644808729489, 43.23625911275545, 43.23155332605043, 43.27763933936754, 52.917568155874804, 52.95878640686472, 52.73625378807385, 55.660905525088296, 55.96775865554808, 55.542248174548135, 47.06138172217955, 47.02892338422437, 46.41126901408036, 49.110549375414834, 48.974234782159314, 49.406464066356406, 54.1533750941356, 54.11935708423455, 53.5927428950866, 51.121834043413386, 51.16729994490741, 51.244797694496796, 52.66169045865534, 53.06494717299937, 53.37587200850247, 58.39301847418149, 58.04441541930039, 58.76486629809854, 64.2844076777498, 63.63870709637801, 64.25446671868364, 45.733043275773525, 45.661362543702126, 45.19242225587368, 49.99336547652881, 50.06201922396819, 50.30142481873433, 50.68756409734486, 50.61513793468474, 50.805027604103074, 54.2907726317644, 54.27145573496817, 54.42727639526127, 49.18166752594213, 49.22669985690543, 49.04549513633053, 49.51454221705596, 48.87485071520011, 49.12415660421054, 56.68773385882376, 57.13769187871365, 57.15684217121451, 50.63910231615107, 50.715630181754634, 50.49961442748706, 46.072574665459484, 45.47651872287193, 46.078863562007115, 43.11649478723605, 42.511996289094284, 42.4497305949529, 47.54111176853378, 47.295832862456635, 47.10662171741326, 44.06014849121371, 43.87886299441257, 44.299935328696534, 41.1288493866256, 40.672847042481095, 41.005690592030675, 53.170365293820694, 53.20490011324485, 53.36214046304424, 46.14819524437189, 46.56725586252287, 46.50062485225499, 58.06149876117705, 58.522464720532284, 58.47153978794812, 42.88654525578022, 42.98460868000984, 43.507944443728775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14699706275390514, "mean_inference_ms": 0.711831838211577, "mean_action_processing_ms": 0.10206278223223186, "mean_env_wait_ms": 0.8445659000270398, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 960000, "timesteps_this_iter": 0, "agent_timesteps_total": 2880000, "timers": {"sample_time_ms": 10358.788, "sample_throughput": 482.682, "load_time_ms": 0.4, "load_throughput": 12501651.267, "learn_time_ms": 1671.196, "learn_throughput": 2991.87, "update_time_ms": 7.82}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7083389842945508e-36, "cur_lr": 0.0005000000000000001, "total_loss": 7.656842279434204, "policy_loss": -0.0008053346966944375, "vf_loss": 7.753186273574829, "vf_explained_var": 0.015732020139694214, "kl": 0.004421609127940614, "entropy": 9.553854942321777, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 960000, "num_agent_steps_sampled": 2880000, "num_steps_trained": 960000, "num_agent_steps_trained": 2880000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2779, "training_iteration": 192, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-43-59", "timestamp": 1706229839, "time_this_iter_s": 9.75596809387207, "time_total_s": 2077.692471265793, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282490820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2077.692471265793, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 8.528571428571428, "ram_util_percent": 51.49285714285714}}
{"episode_reward_max": 206.6198704186826, "episode_reward_min": 81.3735032249242, "episode_reward_mean": 149.33812886058308, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 27.034999016672373}, "policy_reward_max": {"shared_policy": 69.12746461667119}, "policy_reward_mean": {"shared_policy": 49.77937628686102}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.0753236580639, 170.10212103277445, 146.07942336425168, 127.52502655982968, 126.76807225309311, 144.18969775363806, 148.4820804409684, 144.83156659081564, 144.03909385536087, 128.24489057715982, 149.24247780861322, 162.9289148820097, 155.6534725818781, 149.49300455674526, 153.92040202394125, 136.45041498541838, 183.95851212367404, 156.2956919064746, 142.74590293504306, 112.04272518306969, 141.978707274422, 156.8109898529947, 144.0900932457301, 163.20230873301614, 135.3517698505894, 169.33243328705416, 163.40433514863227, 147.1064841151236, 150.72992474958303, 149.95502701774248, 143.05173895508048, 143.77927643433193, 109.22283641248941, 166.79885149747125, 182.2633801698683, 161.16205138713133, 114.09609070420264, 147.73666408727902, 171.09350526705396, 137.49170203879473, 143.3837895542384, 171.7976651005449, 165.79844035860134, 145.22334733977917, 206.6198704186826, 129.68500471115118, 138.96760622784478, 139.70492058899228, 136.7550202086568, 116.4175217412412, 131.05037422850737, 169.0666262954471, 141.3053961002735, 170.49386039748782, 202.24596636742348, 143.59177113417536, 183.5188490189614, 151.0730347321369, 155.93203565850837, 153.9641070440413, 125.92463137581944, 124.75124145857987, 144.927408784628, 129.74545177817322, 158.61260835081356, 167.1709123551846, 140.50157412048424, 147.49124822393048, 161.86547507345662, 153.53393168281772, 159.1025096401569, 175.2023001915805, 192.17758149281164, 136.5868280753493, 150.35680951923146, 152.10772963613275, 162.98950476199374, 147.453862519178, 147.51354953646646, 170.98226790875177, 151.85434692539283, 137.6279569503388, 128.07822167128325, 141.94356634840372, 132.23894681432267, 122.80738702113737, 159.73740587010977, 139.21607595914963, 175.05550326965735, 129.37909837951895, 81.3735032249242, 162.585242538713, 146.71372683718795, 162.551470402628, 140.32498939707915, 116.80335263907908, 146.35415598936387, 166.4127967730164, 172.87211479246628, 160.56340524088583], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [43.72059506674607, 44.358984849726156, 43.99574374159177, 56.43039533992608, 56.72430867453416, 56.9474170183142, 48.52502585450809, 48.61272980521123, 48.94166770453255, 42.609391431013734, 42.5215053881208, 42.39412974069515, 42.64992247832318, 41.70641214152177, 42.411737633248165, 47.9186669141054, 48.070739746093736, 48.20029109343885, 49.011346841851875, 49.858397855112955, 49.61233574400346, 48.318296277895556, 48.19150890037416, 48.321761412546024, 47.86082410315673, 48.18653479426091, 47.991734957943365, 43.083809574445084, 43.170558300179735, 41.99052270253499, 49.240180939435945, 50.068911042530075, 49.93338582664727, 53.56623288989066, 54.43701327592133, 54.92566871619782, 51.67993150403102, 51.87102682640155, 52.102514251445726, 49.78378369410832, 49.67879394938548, 50.030426913251475, 51.534062406669065, 51.14060035596292, 51.24573926130931, 45.51356333990891, 45.79343635340531, 45.14341529210408, 60.977407659093544, 61.5698294552664, 61.411275009314224, 52.40512406484534, 51.850229804714516, 52.04033803691466, 47.022706275184945, 47.85564054300387, 47.867556116854146, 37.41143887986739, 36.976227705677346, 37.655058597524956, 47.48503176433344, 47.03825256725152, 47.455422942837075, 51.863856777548776, 52.376304060220704, 52.57082901522516, 47.84647570053737, 48.04554817328851, 48.19806937190394, 54.54230935623248, 53.88227557142575, 54.77772380535801, 45.36123194297154, 45.71740484827508, 44.2731330593427, 56.04108912249406, 56.53020703544219, 56.76113712911804, 54.48981492221354, 54.16135302186011, 54.753167204558835, 49.03173922747372, 48.88975928723811, 49.18498560041188, 50.03519401947658, 50.18400811652343, 50.51072261358301, 50.05104139074682, 49.767250359058366, 50.13673526793717, 47.671562169988945, 47.795050514241055, 47.585126270850495, 48.210684822251395, 48.089934212466076, 47.47865739961465, 36.384353287518024, 36.49127344042063, 36.34720968455076, 55.38257073859374, 55.6688213745753, 55.7474593843023, 60.912343310813114, 60.413304279247924, 60.937732579807445, 53.217167759935066, 54.005869532624885, 53.93901409457128, 38.12665822108586, 38.22999896605809, 37.739433517058686, 49.14479695260523, 49.39900896395555, 49.19285817071794, 56.98304592321317, 56.86183611551921, 57.24862322832148, 45.90296967327595, 45.84746454283595, 45.74126782268286, 47.85875464727481, 47.50206201275189, 48.022972894211605, 56.961387130121395, 57.523985220740244, 57.31229274968307, 54.80177107950051, 55.479721294095114, 55.51694798500587, 48.223499196271106, 48.6009310061733, 48.39891713733475, 68.88721534609793, 69.12746461667119, 68.60519045591353, 43.18607607980569, 43.13161132981379, 43.36731730153163, 46.301784083247185, 46.27141231298447, 46.3944098316133, 46.34142383933067, 46.35355852544308, 47.009938224218786, 45.775370349486664, 45.475467679401234, 45.504182179768875, 38.572946203251675, 38.91853220838432, 38.92604332960521, 43.28673350314298, 44.01610855634013, 43.74753216902414, 56.35269700735806, 56.42166285961865, 56.2922664284706, 46.785862500468895, 47.47987079659167, 47.039662803212806, 56.42461773753165, 57.00333499163388, 57.06590766832231, 67.37172508736451, 67.44462276001771, 67.4296185200413, 47.84490117927392, 47.648945582409695, 48.09792437249173, 61.301730860024676, 60.85360628366469, 61.36351187527178, 50.17067226519187, 50.48977133988713, 50.412591127057865, 52.08575568099816, 52.060990193237856, 51.78528978427251, 51.71233487253387, 50.51726176341374, 51.73451040809353, 42.16444071382284, 42.47196799144149, 41.288222670555115, 41.11413563291231, 42.22787601562837, 41.40922981003919, 48.62626042713721, 48.3647002701958, 47.93644808729489, 43.23625911275545, 43.23155332605043, 43.27763933936754, 52.917568155874804, 52.95878640686472, 52.73625378807385, 55.660905525088296, 55.96775865554808, 55.542248174548135, 47.06138172217955, 47.02892338422437, 46.41126901408036, 49.110549375414834, 48.974234782159314, 49.406464066356406, 54.1533750941356, 54.11935708423455, 53.5927428950866, 51.121834043413386, 51.16729994490741, 51.244797694496796, 52.66169045865534, 53.06494717299937, 53.37587200850247, 58.39301847418149, 58.04441541930039, 58.76486629809854, 64.2844076777498, 63.63870709637801, 64.25446671868364, 45.733043275773525, 45.661362543702126, 45.19242225587368, 49.99336547652881, 50.06201922396819, 50.30142481873433, 50.68756409734486, 50.61513793468474, 50.805027604103074, 54.2907726317644, 54.27145573496817, 54.42727639526127, 49.18166752594213, 49.22669985690543, 49.04549513633053, 49.51454221705596, 48.87485071520011, 49.12415660421054, 56.68773385882376, 57.13769187871365, 57.15684217121451, 50.63910231615107, 50.715630181754634, 50.49961442748706, 46.072574665459484, 45.47651872287193, 46.078863562007115, 43.11649478723605, 42.511996289094284, 42.4497305949529, 47.54111176853378, 47.295832862456635, 47.10662171741326, 44.06014849121371, 43.87886299441257, 44.299935328696534, 41.1288493866256, 40.672847042481095, 41.005690592030675, 53.170365293820694, 53.20490011324485, 53.36214046304424, 46.14819524437189, 46.56725586252287, 46.50062485225499, 58.06149876117705, 58.522464720532284, 58.47153978794812, 42.88654525578022, 42.98460868000984, 43.507944443728775, 27.034999016672373, 27.185065034776926, 27.153439173474908, 54.40516983127843, 54.34394847104947, 53.83612423638503, 48.873153676589325, 48.22882195313771, 49.611751207460955, 54.04305781672399, 54.380217115084335, 54.128195470819875, 46.86265011255939, 46.868421127398804, 46.59391815712054, 39.27963547625889, 38.2444994499286, 39.279217712891594, 49.04552887876828, 49.04870577839513, 48.25992133220036, 54.8273103137811, 55.98749077071746, 55.597995688517884, 57.30614851415156, 57.64119609445332, 57.92477018386124, 53.18558944265048, 53.68883920243631, 53.68897659579913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14694401265054752, "mean_inference_ms": 0.7116422952873165, "mean_action_processing_ms": 0.10203918577125666, "mean_env_wait_ms": 0.8443056952676904, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 965000, "timesteps_this_iter": 0, "agent_timesteps_total": 2895000, "timers": {"sample_time_ms": 10269.14, "sample_throughput": 486.896, "load_time_ms": 0.3, "load_throughput": 16669199.587, "learn_time_ms": 1673.06, "learn_throughput": 2988.535, "update_time_ms": 7.935}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3541694921472754e-36, "cur_lr": 0.0005000000000000001, "total_loss": 7.756245565414429, "policy_loss": -0.001166242882413826, "vf_loss": 7.852771615982055, "vf_explained_var": 0.017465388774871825, "kl": 0.005258238117724563, "entropy": 9.536006927490234, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 965000, "num_agent_steps_sampled": 2895000, "num_steps_trained": 965000, "num_agent_steps_trained": 2895000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2789, "training_iteration": 193, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-44-09", "timestamp": 1706229849, "time_this_iter_s": 9.867941856384277, "time_total_s": 2087.560413122177, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020282490D30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2087.560413122177, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 9.357142857142858, "ram_util_percent": 51.52142857142858}}
{"episode_reward_max": 206.6198704186826, "episode_reward_min": 81.3735032249242, "episode_reward_mean": 149.7090844825144, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 27.034999016672373}, "policy_reward_max": {"shared_policy": 69.12746461667119}, "policy_reward_mean": {"shared_policy": 49.90302816083815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [149.24247780861322, 162.9289148820097, 155.6534725818781, 149.49300455674526, 153.92040202394125, 136.45041498541838, 183.95851212367404, 156.2956919064746, 142.74590293504306, 112.04272518306969, 141.978707274422, 156.8109898529947, 144.0900932457301, 163.20230873301614, 135.3517698505894, 169.33243328705416, 163.40433514863227, 147.1064841151236, 150.72992474958303, 149.95502701774248, 143.05173895508048, 143.77927643433193, 109.22283641248941, 166.79885149747125, 182.2633801698683, 161.16205138713133, 114.09609070420264, 147.73666408727902, 171.09350526705396, 137.49170203879473, 143.3837895542384, 171.7976651005449, 165.79844035860134, 145.22334733977917, 206.6198704186826, 129.68500471115118, 138.96760622784478, 139.70492058899228, 136.7550202086568, 116.4175217412412, 131.05037422850737, 169.0666262954471, 141.3053961002735, 170.49386039748782, 202.24596636742348, 143.59177113417536, 183.5188490189614, 151.0730347321369, 155.93203565850837, 153.9641070440413, 125.92463137581944, 124.75124145857987, 144.927408784628, 129.74545177817322, 158.61260835081356, 167.1709123551846, 140.50157412048424, 147.49124822393048, 161.86547507345662, 153.53393168281772, 159.1025096401569, 175.2023001915805, 192.17758149281164, 136.5868280753493, 150.35680951923146, 152.10772963613275, 162.98950476199374, 147.453862519178, 147.51354953646646, 170.98226790875177, 151.85434692539283, 137.6279569503388, 128.07822167128325, 141.94356634840372, 132.23894681432267, 122.80738702113737, 159.73740587010977, 139.21607595914963, 175.05550326965735, 129.37909837951895, 81.3735032249242, 162.585242538713, 146.71372683718795, 162.551470402628, 140.32498939707915, 116.80335263907908, 146.35415598936387, 166.4127967730164, 172.87211479246628, 160.56340524088583, 154.20418229699135, 126.40283353812993, 128.37615451414604, 123.38931249314916, 143.565370268654, 130.6546700149775, 171.05862975493073, 161.00586456805482, 161.90215640701322, 148.87368442304458], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [49.240180939435945, 50.068911042530075, 49.93338582664727, 53.56623288989066, 54.43701327592133, 54.92566871619782, 51.67993150403102, 51.87102682640155, 52.102514251445726, 49.78378369410832, 49.67879394938548, 50.030426913251475, 51.534062406669065, 51.14060035596292, 51.24573926130931, 45.51356333990891, 45.79343635340531, 45.14341529210408, 60.977407659093544, 61.5698294552664, 61.411275009314224, 52.40512406484534, 51.850229804714516, 52.04033803691466, 47.022706275184945, 47.85564054300387, 47.867556116854146, 37.41143887986739, 36.976227705677346, 37.655058597524956, 47.48503176433344, 47.03825256725152, 47.455422942837075, 51.863856777548776, 52.376304060220704, 52.57082901522516, 47.84647570053737, 48.04554817328851, 48.19806937190394, 54.54230935623248, 53.88227557142575, 54.77772380535801, 45.36123194297154, 45.71740484827508, 44.2731330593427, 56.04108912249406, 56.53020703544219, 56.76113712911804, 54.48981492221354, 54.16135302186011, 54.753167204558835, 49.03173922747372, 48.88975928723811, 49.18498560041188, 50.03519401947658, 50.18400811652343, 50.51072261358301, 50.05104139074682, 49.767250359058366, 50.13673526793717, 47.671562169988945, 47.795050514241055, 47.585126270850495, 48.210684822251395, 48.089934212466076, 47.47865739961465, 36.384353287518024, 36.49127344042063, 36.34720968455076, 55.38257073859374, 55.6688213745753, 55.7474593843023, 60.912343310813114, 60.413304279247924, 60.937732579807445, 53.217167759935066, 54.005869532624885, 53.93901409457128, 38.12665822108586, 38.22999896605809, 37.739433517058686, 49.14479695260523, 49.39900896395555, 49.19285817071794, 56.98304592321317, 56.86183611551921, 57.24862322832148, 45.90296967327595, 45.84746454283595, 45.74126782268286, 47.85875464727481, 47.50206201275189, 48.022972894211605, 56.961387130121395, 57.523985220740244, 57.31229274968307, 54.80177107950051, 55.479721294095114, 55.51694798500587, 48.223499196271106, 48.6009310061733, 48.39891713733475, 68.88721534609793, 69.12746461667119, 68.60519045591353, 43.18607607980569, 43.13161132981379, 43.36731730153163, 46.301784083247185, 46.27141231298447, 46.3944098316133, 46.34142383933067, 46.35355852544308, 47.009938224218786, 45.775370349486664, 45.475467679401234, 45.504182179768875, 38.572946203251675, 38.91853220838432, 38.92604332960521, 43.28673350314298, 44.01610855634013, 43.74753216902414, 56.35269700735806, 56.42166285961865, 56.2922664284706, 46.785862500468895, 47.47987079659167, 47.039662803212806, 56.42461773753165, 57.00333499163388, 57.06590766832231, 67.37172508736451, 67.44462276001771, 67.4296185200413, 47.84490117927392, 47.648945582409695, 48.09792437249173, 61.301730860024676, 60.85360628366469, 61.36351187527178, 50.17067226519187, 50.48977133988713, 50.412591127057865, 52.08575568099816, 52.060990193237856, 51.78528978427251, 51.71233487253387, 50.51726176341374, 51.73451040809353, 42.16444071382284, 42.47196799144149, 41.288222670555115, 41.11413563291231, 42.22787601562837, 41.40922981003919, 48.62626042713721, 48.3647002701958, 47.93644808729489, 43.23625911275545, 43.23155332605043, 43.27763933936754, 52.917568155874804, 52.95878640686472, 52.73625378807385, 55.660905525088296, 55.96775865554808, 55.542248174548135, 47.06138172217955, 47.02892338422437, 46.41126901408036, 49.110549375414834, 48.974234782159314, 49.406464066356406, 54.1533750941356, 54.11935708423455, 53.5927428950866, 51.121834043413386, 51.16729994490741, 51.244797694496796, 52.66169045865534, 53.06494717299937, 53.37587200850247, 58.39301847418149, 58.04441541930039, 58.76486629809854, 64.2844076777498, 63.63870709637801, 64.25446671868364, 45.733043275773525, 45.661362543702126, 45.19242225587368, 49.99336547652881, 50.06201922396819, 50.30142481873433, 50.68756409734486, 50.61513793468474, 50.805027604103074, 54.2907726317644, 54.27145573496817, 54.42727639526127, 49.18166752594213, 49.22669985690543, 49.04549513633053, 49.51454221705596, 48.87485071520011, 49.12415660421054, 56.68773385882376, 57.13769187871365, 57.15684217121451, 50.63910231615107, 50.715630181754634, 50.49961442748706, 46.072574665459484, 45.47651872287193, 46.078863562007115, 43.11649478723605, 42.511996289094284, 42.4497305949529, 47.54111176853378, 47.295832862456635, 47.10662171741326, 44.06014849121371, 43.87886299441257, 44.299935328696534, 41.1288493866256, 40.672847042481095, 41.005690592030675, 53.170365293820694, 53.20490011324485, 53.36214046304424, 46.14819524437189, 46.56725586252287, 46.50062485225499, 58.06149876117705, 58.522464720532284, 58.47153978794812, 42.88654525578022, 42.98460868000984, 43.507944443728775, 27.034999016672373, 27.185065034776926, 27.153439173474908, 54.40516983127843, 54.34394847104947, 53.83612423638503, 48.873153676589325, 48.22882195313771, 49.611751207460955, 54.04305781672399, 54.380217115084335, 54.128195470819875, 46.86265011255939, 46.868421127398804, 46.59391815712054, 39.27963547625889, 38.2444994499286, 39.279217712891594, 49.04552887876828, 49.04870577839513, 48.25992133220036, 54.8273103137811, 55.98749077071746, 55.597995688517884, 57.30614851415156, 57.64119609445332, 57.92477018386124, 53.18558944265048, 53.68883920243631, 53.68897659579913, 51.39866738518079, 51.50413918246825, 51.3013757293423, 41.96385836601257, 41.99379926919937, 42.44517590291798, 42.902409270522185, 42.78410226665437, 42.68964297696948, 41.02834926793972, 41.282452625377715, 41.07851059983173, 48.11019517186408, 47.37660980721314, 48.078565289576844, 43.49463242292404, 43.451247468590736, 43.70879012346268, 57.100660324096665, 56.65299919247626, 57.30497023835777, 53.814033287266895, 53.62419267992179, 53.567638600866005, 54.0370938864847, 54.204171861832336, 53.66089065869649, 49.5566120892763, 49.55294174700974, 49.76413058675824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14688872150490404, "mean_inference_ms": 0.7114468793146177, "mean_action_processing_ms": 0.10201477523400908, "mean_env_wait_ms": 0.8440266579262001, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 970000, "timesteps_this_iter": 0, "agent_timesteps_total": 2910000, "timers": {"sample_time_ms": 10240.333, "sample_throughput": 488.265, "load_time_ms": 0.3, "load_throughput": 16669199.587, "learn_time_ms": 1677.926, "learn_throughput": 2979.869, "update_time_ms": 7.935}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3541694921472754e-36, "cur_lr": 0.0005000000000000001, "total_loss": 8.634436798095702, "policy_loss": 0.0009764954328544739, "vf_loss": 8.727864456176757, "vf_explained_var": 0.017376083135604858, "kl": 0.01028081979607386, "entropy": 9.440394592285156, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 970000, "num_agent_steps_sampled": 2910000, "num_steps_trained": 970000, "num_agent_steps_trained": 2910000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2799, "training_iteration": 194, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-44-19", "timestamp": 1706229859, "time_this_iter_s": 10.242821455001831, "time_total_s": 2097.803234577179, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202846E40D0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2097.803234577179, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 10.292857142857143, "ram_util_percent": 51.55000000000001}}
{"episode_reward_max": 206.70246805250625, "episode_reward_min": 81.3735032249242, "episode_reward_mean": 150.07732615227124, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 27.034999016672373}, "policy_reward_max": {"shared_policy": 69.17192178219555}, "policy_reward_mean": {"shared_policy": 50.02577538409042}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.978707274422, 156.8109898529947, 144.0900932457301, 163.20230873301614, 135.3517698505894, 169.33243328705416, 163.40433514863227, 147.1064841151236, 150.72992474958303, 149.95502701774248, 143.05173895508048, 143.77927643433193, 109.22283641248941, 166.79885149747125, 182.2633801698683, 161.16205138713133, 114.09609070420264, 147.73666408727902, 171.09350526705396, 137.49170203879473, 143.3837895542384, 171.7976651005449, 165.79844035860134, 145.22334733977917, 206.6198704186826, 129.68500471115118, 138.96760622784478, 139.70492058899228, 136.7550202086568, 116.4175217412412, 131.05037422850737, 169.0666262954471, 141.3053961002735, 170.49386039748782, 202.24596636742348, 143.59177113417536, 183.5188490189614, 151.0730347321369, 155.93203565850837, 153.9641070440413, 125.92463137581944, 124.75124145857987, 144.927408784628, 129.74545177817322, 158.61260835081356, 167.1709123551846, 140.50157412048424, 147.49124822393048, 161.86547507345662, 153.53393168281772, 159.1025096401569, 175.2023001915805, 192.17758149281164, 136.5868280753493, 150.35680951923146, 152.10772963613275, 162.98950476199374, 147.453862519178, 147.51354953646646, 170.98226790875177, 151.85434692539283, 137.6279569503388, 128.07822167128325, 141.94356634840372, 132.23894681432267, 122.80738702113737, 159.73740587010977, 139.21607595914963, 175.05550326965735, 129.37909837951895, 81.3735032249242, 162.585242538713, 146.71372683718795, 162.551470402628, 140.32498939707915, 116.80335263907908, 146.35415598936387, 166.4127967730164, 172.87211479246628, 160.56340524088583, 154.20418229699135, 126.40283353812993, 128.37615451414604, 123.38931249314916, 143.565370268654, 130.6546700149775, 171.05862975493073, 161.00586456805482, 161.90215640701322, 148.87368442304458, 206.28667690604905, 171.80444357171683, 134.93253333866596, 99.82013139128682, 167.10919317044298, 140.9179362589494, 127.14495123177764, 206.70246805250625, 129.4013624079525, 155.43598963320264], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [47.48503176433344, 47.03825256725152, 47.455422942837075, 51.863856777548776, 52.376304060220704, 52.57082901522516, 47.84647570053737, 48.04554817328851, 48.19806937190394, 54.54230935623248, 53.88227557142575, 54.77772380535801, 45.36123194297154, 45.71740484827508, 44.2731330593427, 56.04108912249406, 56.53020703544219, 56.76113712911804, 54.48981492221354, 54.16135302186011, 54.753167204558835, 49.03173922747372, 48.88975928723811, 49.18498560041188, 50.03519401947658, 50.18400811652343, 50.51072261358301, 50.05104139074682, 49.767250359058366, 50.13673526793717, 47.671562169988945, 47.795050514241055, 47.585126270850495, 48.210684822251395, 48.089934212466076, 47.47865739961465, 36.384353287518024, 36.49127344042063, 36.34720968455076, 55.38257073859374, 55.6688213745753, 55.7474593843023, 60.912343310813114, 60.413304279247924, 60.937732579807445, 53.217167759935066, 54.005869532624885, 53.93901409457128, 38.12665822108586, 38.22999896605809, 37.739433517058686, 49.14479695260523, 49.39900896395555, 49.19285817071794, 56.98304592321317, 56.86183611551921, 57.24862322832148, 45.90296967327595, 45.84746454283595, 45.74126782268286, 47.85875464727481, 47.50206201275189, 48.022972894211605, 56.961387130121395, 57.523985220740244, 57.31229274968307, 54.80177107950051, 55.479721294095114, 55.51694798500587, 48.223499196271106, 48.6009310061733, 48.39891713733475, 68.88721534609793, 69.12746461667119, 68.60519045591353, 43.18607607980569, 43.13161132981379, 43.36731730153163, 46.301784083247185, 46.27141231298447, 46.3944098316133, 46.34142383933067, 46.35355852544308, 47.009938224218786, 45.775370349486664, 45.475467679401234, 45.504182179768875, 38.572946203251675, 38.91853220838432, 38.92604332960521, 43.28673350314298, 44.01610855634013, 43.74753216902414, 56.35269700735806, 56.42166285961865, 56.2922664284706, 46.785862500468895, 47.47987079659167, 47.039662803212806, 56.42461773753165, 57.00333499163388, 57.06590766832231, 67.37172508736451, 67.44462276001771, 67.4296185200413, 47.84490117927392, 47.648945582409695, 48.09792437249173, 61.301730860024676, 60.85360628366469, 61.36351187527178, 50.17067226519187, 50.48977133988713, 50.412591127057865, 52.08575568099816, 52.060990193237856, 51.78528978427251, 51.71233487253387, 50.51726176341374, 51.73451040809353, 42.16444071382284, 42.47196799144149, 41.288222670555115, 41.11413563291231, 42.22787601562837, 41.40922981003919, 48.62626042713721, 48.3647002701958, 47.93644808729489, 43.23625911275545, 43.23155332605043, 43.27763933936754, 52.917568155874804, 52.95878640686472, 52.73625378807385, 55.660905525088296, 55.96775865554808, 55.542248174548135, 47.06138172217955, 47.02892338422437, 46.41126901408036, 49.110549375414834, 48.974234782159314, 49.406464066356406, 54.1533750941356, 54.11935708423455, 53.5927428950866, 51.121834043413386, 51.16729994490741, 51.244797694496796, 52.66169045865534, 53.06494717299937, 53.37587200850247, 58.39301847418149, 58.04441541930039, 58.76486629809854, 64.2844076777498, 63.63870709637801, 64.25446671868364, 45.733043275773525, 45.661362543702126, 45.19242225587368, 49.99336547652881, 50.06201922396819, 50.30142481873433, 50.68756409734486, 50.61513793468474, 50.805027604103074, 54.2907726317644, 54.27145573496817, 54.42727639526127, 49.18166752594213, 49.22669985690543, 49.04549513633053, 49.51454221705596, 48.87485071520011, 49.12415660421054, 56.68773385882376, 57.13769187871365, 57.15684217121451, 50.63910231615107, 50.715630181754634, 50.49961442748706, 46.072574665459484, 45.47651872287193, 46.078863562007115, 43.11649478723605, 42.511996289094284, 42.4497305949529, 47.54111176853378, 47.295832862456635, 47.10662171741326, 44.06014849121371, 43.87886299441257, 44.299935328696534, 41.1288493866256, 40.672847042481095, 41.005690592030675, 53.170365293820694, 53.20490011324485, 53.36214046304424, 46.14819524437189, 46.56725586252287, 46.50062485225499, 58.06149876117705, 58.522464720532284, 58.47153978794812, 42.88654525578022, 42.98460868000984, 43.507944443728775, 27.034999016672373, 27.185065034776926, 27.153439173474908, 54.40516983127843, 54.34394847104947, 53.83612423638503, 48.873153676589325, 48.22882195313771, 49.611751207460955, 54.04305781672399, 54.380217115084335, 54.128195470819875, 46.86265011255939, 46.868421127398804, 46.59391815712054, 39.27963547625889, 38.2444994499286, 39.279217712891594, 49.04552887876828, 49.04870577839513, 48.25992133220036, 54.8273103137811, 55.98749077071746, 55.597995688517884, 57.30614851415156, 57.64119609445332, 57.92477018386124, 53.18558944265048, 53.68883920243631, 53.68897659579913, 51.39866738518079, 51.50413918246825, 51.3013757293423, 41.96385836601257, 41.99379926919937, 42.44517590291798, 42.902409270522185, 42.78410226665437, 42.68964297696948, 41.02834926793972, 41.282452625377715, 41.07851059983173, 48.11019517186408, 47.37660980721314, 48.078565289576844, 43.49463242292404, 43.451247468590736, 43.70879012346268, 57.100660324096665, 56.65299919247626, 57.30497023835777, 53.814033287266895, 53.62419267992179, 53.567638600866005, 54.0370938864847, 54.204171861832336, 53.66089065869649, 49.5566120892763, 49.55294174700974, 49.76413058675824, 68.69045539697011, 68.70601586004098, 68.89020564903815, 57.06345750391482, 57.225973218679414, 57.51501284912227, 44.71307701865831, 44.81634936730066, 45.40310695270696, 33.08955245713392, 33.51502888898054, 33.215550045172364, 55.66779212156932, 55.98558472531538, 55.455816323558494, 46.62040510773657, 47.298499570228145, 46.99903158098458, 42.76621103535095, 42.44387399653593, 41.93486619989076, 68.71028209477662, 69.17192178219555, 68.82026417553423, 42.80591708918412, 43.100006630023316, 43.4954386887451, 51.69183102250098, 51.95292268693446, 51.791235923767076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1468393711313591, "mean_inference_ms": 0.7112819697477901, "mean_action_processing_ms": 0.1019905753497982, "mean_env_wait_ms": 0.8437829433210642, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 975000, "timesteps_this_iter": 0, "agent_timesteps_total": 2925000, "timers": {"sample_time_ms": 10308.414, "sample_throughput": 485.041, "load_time_ms": 0.3, "load_throughput": 16669199.587, "learn_time_ms": 1666.449, "learn_throughput": 3000.391, "update_time_ms": 7.834}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3541694921472754e-36, "cur_lr": 0.0005000000000000001, "total_loss": 12.657743072509765, "policy_loss": 0.0015037274398125079, "vf_loss": 12.754705142974853, "vf_explained_var": 0.008156949281692505, "kl": 0.013248664233887463, "entropy": 9.846608066558838, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 975000, "num_agent_steps_sampled": 2925000, "num_steps_trained": 975000, "num_agent_steps_trained": 2925000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2809, "training_iteration": 195, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-44-29", "timestamp": 1706229869, "time_this_iter_s": 10.536404132843018, "time_total_s": 2108.339638710022, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x0000020280834A60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2108.339638710022, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 11.706666666666669, "ram_util_percent": 51.84}}
{"episode_reward_max": 206.70246805250625, "episode_reward_min": 81.3735032249242, "episode_reward_mean": 150.56876170463755, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 27.034999016672373}, "policy_reward_max": {"shared_policy": 69.17192178219555}, "policy_reward_mean": {"shared_policy": 50.18958723487919}, "custom_metrics": {}, "hist_stats": {"episode_reward": [143.05173895508048, 143.77927643433193, 109.22283641248941, 166.79885149747125, 182.2633801698683, 161.16205138713133, 114.09609070420264, 147.73666408727902, 171.09350526705396, 137.49170203879473, 143.3837895542384, 171.7976651005449, 165.79844035860134, 145.22334733977917, 206.6198704186826, 129.68500471115118, 138.96760622784478, 139.70492058899228, 136.7550202086568, 116.4175217412412, 131.05037422850737, 169.0666262954471, 141.3053961002735, 170.49386039748782, 202.24596636742348, 143.59177113417536, 183.5188490189614, 151.0730347321369, 155.93203565850837, 153.9641070440413, 125.92463137581944, 124.75124145857987, 144.927408784628, 129.74545177817322, 158.61260835081356, 167.1709123551846, 140.50157412048424, 147.49124822393048, 161.86547507345662, 153.53393168281772, 159.1025096401569, 175.2023001915805, 192.17758149281164, 136.5868280753493, 150.35680951923146, 152.10772963613275, 162.98950476199374, 147.453862519178, 147.51354953646646, 170.98226790875177, 151.85434692539283, 137.6279569503388, 128.07822167128325, 141.94356634840372, 132.23894681432267, 122.80738702113737, 159.73740587010977, 139.21607595914963, 175.05550326965735, 129.37909837951895, 81.3735032249242, 162.585242538713, 146.71372683718795, 162.551470402628, 140.32498939707915, 116.80335263907908, 146.35415598936387, 166.4127967730164, 172.87211479246628, 160.56340524088583, 154.20418229699135, 126.40283353812993, 128.37615451414604, 123.38931249314916, 143.565370268654, 130.6546700149775, 171.05862975493073, 161.00586456805482, 161.90215640701322, 148.87368442304458, 206.28667690604905, 171.80444357171683, 134.93253333866596, 99.82013139128682, 167.10919317044298, 140.9179362589494, 127.14495123177764, 206.70246805250625, 129.4013624079525, 155.43598963320264, 156.65192113164832, 167.29002040205523, 178.281890153885, 152.53535222832548, 131.57781463116396, 138.5849140584467, 163.87557676155097, 196.9225976318123, 137.19643186591563, 148.18910964671545], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [47.671562169988945, 47.795050514241055, 47.585126270850495, 48.210684822251395, 48.089934212466076, 47.47865739961465, 36.384353287518024, 36.49127344042063, 36.34720968455076, 55.38257073859374, 55.6688213745753, 55.7474593843023, 60.912343310813114, 60.413304279247924, 60.937732579807445, 53.217167759935066, 54.005869532624885, 53.93901409457128, 38.12665822108586, 38.22999896605809, 37.739433517058686, 49.14479695260523, 49.39900896395555, 49.19285817071794, 56.98304592321317, 56.86183611551921, 57.24862322832148, 45.90296967327595, 45.84746454283595, 45.74126782268286, 47.85875464727481, 47.50206201275189, 48.022972894211605, 56.961387130121395, 57.523985220740244, 57.31229274968307, 54.80177107950051, 55.479721294095114, 55.51694798500587, 48.223499196271106, 48.6009310061733, 48.39891713733475, 68.88721534609793, 69.12746461667119, 68.60519045591353, 43.18607607980569, 43.13161132981379, 43.36731730153163, 46.301784083247185, 46.27141231298447, 46.3944098316133, 46.34142383933067, 46.35355852544308, 47.009938224218786, 45.775370349486664, 45.475467679401234, 45.504182179768875, 38.572946203251675, 38.91853220838432, 38.92604332960521, 43.28673350314298, 44.01610855634013, 43.74753216902414, 56.35269700735806, 56.42166285961865, 56.2922664284706, 46.785862500468895, 47.47987079659167, 47.039662803212806, 56.42461773753165, 57.00333499163388, 57.06590766832231, 67.37172508736451, 67.44462276001771, 67.4296185200413, 47.84490117927392, 47.648945582409695, 48.09792437249173, 61.301730860024676, 60.85360628366469, 61.36351187527178, 50.17067226519187, 50.48977133988713, 50.412591127057865, 52.08575568099816, 52.060990193237856, 51.78528978427251, 51.71233487253387, 50.51726176341374, 51.73451040809353, 42.16444071382284, 42.47196799144149, 41.288222670555115, 41.11413563291231, 42.22787601562837, 41.40922981003919, 48.62626042713721, 48.3647002701958, 47.93644808729489, 43.23625911275545, 43.23155332605043, 43.27763933936754, 52.917568155874804, 52.95878640686472, 52.73625378807385, 55.660905525088296, 55.96775865554808, 55.542248174548135, 47.06138172217955, 47.02892338422437, 46.41126901408036, 49.110549375414834, 48.974234782159314, 49.406464066356406, 54.1533750941356, 54.11935708423455, 53.5927428950866, 51.121834043413386, 51.16729994490741, 51.244797694496796, 52.66169045865534, 53.06494717299937, 53.37587200850247, 58.39301847418149, 58.04441541930039, 58.76486629809854, 64.2844076777498, 63.63870709637801, 64.25446671868364, 45.733043275773525, 45.661362543702126, 45.19242225587368, 49.99336547652881, 50.06201922396819, 50.30142481873433, 50.68756409734486, 50.61513793468474, 50.805027604103074, 54.2907726317644, 54.27145573496817, 54.42727639526127, 49.18166752594213, 49.22669985690543, 49.04549513633053, 49.51454221705596, 48.87485071520011, 49.12415660421054, 56.68773385882376, 57.13769187871365, 57.15684217121451, 50.63910231615107, 50.715630181754634, 50.49961442748706, 46.072574665459484, 45.47651872287193, 46.078863562007115, 43.11649478723605, 42.511996289094284, 42.4497305949529, 47.54111176853378, 47.295832862456635, 47.10662171741326, 44.06014849121371, 43.87886299441257, 44.299935328696534, 41.1288493866256, 40.672847042481095, 41.005690592030675, 53.170365293820694, 53.20490011324485, 53.36214046304424, 46.14819524437189, 46.56725586252287, 46.50062485225499, 58.06149876117705, 58.522464720532284, 58.47153978794812, 42.88654525578022, 42.98460868000984, 43.507944443728775, 27.034999016672373, 27.185065034776926, 27.153439173474908, 54.40516983127843, 54.34394847104947, 53.83612423638503, 48.873153676589325, 48.22882195313771, 49.611751207460955, 54.04305781672399, 54.380217115084335, 54.128195470819875, 46.86265011255939, 46.868421127398804, 46.59391815712054, 39.27963547625889, 38.2444994499286, 39.279217712891594, 49.04552887876828, 49.04870577839513, 48.25992133220036, 54.8273103137811, 55.98749077071746, 55.597995688517884, 57.30614851415156, 57.64119609445332, 57.92477018386124, 53.18558944265048, 53.68883920243631, 53.68897659579913, 51.39866738518079, 51.50413918246825, 51.3013757293423, 41.96385836601257, 41.99379926919937, 42.44517590291798, 42.902409270522185, 42.78410226665437, 42.68964297696948, 41.02834926793972, 41.282452625377715, 41.07851059983173, 48.11019517186408, 47.37660980721314, 48.078565289576844, 43.49463242292404, 43.451247468590736, 43.70879012346268, 57.100660324096665, 56.65299919247626, 57.30497023835777, 53.814033287266895, 53.62419267992179, 53.567638600866005, 54.0370938864847, 54.204171861832336, 53.66089065869649, 49.5566120892763, 49.55294174700974, 49.76413058675824, 68.69045539697011, 68.70601586004098, 68.89020564903815, 57.06345750391482, 57.225973218679414, 57.51501284912227, 44.71307701865831, 44.81634936730066, 45.40310695270696, 33.08955245713392, 33.51502888898054, 33.215550045172364, 55.66779212156932, 55.98558472531538, 55.455816323558494, 46.62040510773657, 47.298499570228145, 46.99903158098458, 42.76621103535095, 42.44387399653593, 41.93486619989076, 68.71028209477662, 69.17192178219555, 68.82026417553423, 42.80591708918412, 43.100006630023316, 43.4954386887451, 51.69183102250098, 51.95292268693446, 51.791235923767076, 52.1670794437329, 52.41036826713632, 52.074473420778915, 55.72145140916108, 55.59201426059006, 55.97655473230405, 59.38240533073743, 59.417633091409996, 59.48185173173745, 51.355755565804415, 50.84594243764876, 50.333654224872575, 44.031944448749215, 43.46276397506395, 44.08310620735088, 46.439854254325226, 46.1907044549783, 45.95435534914334, 54.69620990908395, 54.68070081310968, 54.49866603935759, 65.88182357931508, 65.88644755398853, 65.15432649850844, 46.02913311930993, 45.6634956623117, 45.50380308429399, 49.30293185139696, 49.370638965318605, 49.51553882999967]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14679740080658413, "mean_inference_ms": 0.7111333581349268, "mean_action_processing_ms": 0.10196426312066043, "mean_env_wait_ms": 0.843542805431633, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 980000, "timesteps_this_iter": 0, "agent_timesteps_total": 2940000, "timers": {"sample_time_ms": 10314.963, "sample_throughput": 484.733, "load_time_ms": 0.3, "load_throughput": 16669199.587, "learn_time_ms": 1668.26, "learn_throughput": 2997.134, "update_time_ms": 7.847}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3541694921472754e-36, "cur_lr": 0.0005000000000000001, "total_loss": 10.212150859832764, "policy_loss": -0.0003953064763367209, "vf_loss": 10.310527515411376, "vf_explained_var": 0.016554594039916992, "kl": 0.006314879935289142, "entropy": 9.798149108886719, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 980000, "num_agent_steps_sampled": 2940000, "num_steps_trained": 980000, "num_agent_steps_trained": 2940000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2819, "training_iteration": 196, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-44-40", "timestamp": 1706229880, "time_this_iter_s": 10.304696083068848, "time_total_s": 2118.644334793091, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824D0310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2118.644334793091, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 12.086666666666666, "ram_util_percent": 51.72000000000001}}
{"episode_reward_max": 206.70246805250625, "episode_reward_min": 81.3735032249242, "episode_reward_mean": 150.79429883470016, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 27.034999016672373}, "policy_reward_max": {"shared_policy": 69.17192178219555}, "policy_reward_mean": {"shared_policy": 50.26476627823338}, "custom_metrics": {}, "hist_stats": {"episode_reward": [143.3837895542384, 171.7976651005449, 165.79844035860134, 145.22334733977917, 206.6198704186826, 129.68500471115118, 138.96760622784478, 139.70492058899228, 136.7550202086568, 116.4175217412412, 131.05037422850737, 169.0666262954471, 141.3053961002735, 170.49386039748782, 202.24596636742348, 143.59177113417536, 183.5188490189614, 151.0730347321369, 155.93203565850837, 153.9641070440413, 125.92463137581944, 124.75124145857987, 144.927408784628, 129.74545177817322, 158.61260835081356, 167.1709123551846, 140.50157412048424, 147.49124822393048, 161.86547507345662, 153.53393168281772, 159.1025096401569, 175.2023001915805, 192.17758149281164, 136.5868280753493, 150.35680951923146, 152.10772963613275, 162.98950476199374, 147.453862519178, 147.51354953646646, 170.98226790875177, 151.85434692539283, 137.6279569503388, 128.07822167128325, 141.94356634840372, 132.23894681432267, 122.80738702113737, 159.73740587010977, 139.21607595914963, 175.05550326965735, 129.37909837951895, 81.3735032249242, 162.585242538713, 146.71372683718795, 162.551470402628, 140.32498939707915, 116.80335263907908, 146.35415598936387, 166.4127967730164, 172.87211479246628, 160.56340524088583, 154.20418229699135, 126.40283353812993, 128.37615451414604, 123.38931249314916, 143.565370268654, 130.6546700149775, 171.05862975493073, 161.00586456805482, 161.90215640701322, 148.87368442304458, 206.28667690604905, 171.80444357171683, 134.93253333866596, 99.82013139128682, 167.10919317044298, 140.9179362589494, 127.14495123177764, 206.70246805250625, 129.4013624079525, 155.43598963320264, 156.65192113164832, 167.29002040205523, 178.281890153885, 152.53535222832548, 131.57781463116396, 138.5849140584467, 163.87557676155097, 196.9225976318123, 137.19643186591563, 148.18910964671545, 175.42891330458224, 154.63098034262686, 179.69272836111483, 123.81946565955876, 150.57931803679094, 161.08575844764707, 147.01954112574455, 141.53856342338295, 103.11875151097772, 162.33578974753604], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [47.85875464727481, 47.50206201275189, 48.022972894211605, 56.961387130121395, 57.523985220740244, 57.31229274968307, 54.80177107950051, 55.479721294095114, 55.51694798500587, 48.223499196271106, 48.6009310061733, 48.39891713733475, 68.88721534609793, 69.12746461667119, 68.60519045591353, 43.18607607980569, 43.13161132981379, 43.36731730153163, 46.301784083247185, 46.27141231298447, 46.3944098316133, 46.34142383933067, 46.35355852544308, 47.009938224218786, 45.775370349486664, 45.475467679401234, 45.504182179768875, 38.572946203251675, 38.91853220838432, 38.92604332960521, 43.28673350314298, 44.01610855634013, 43.74753216902414, 56.35269700735806, 56.42166285961865, 56.2922664284706, 46.785862500468895, 47.47987079659167, 47.039662803212806, 56.42461773753165, 57.00333499163388, 57.06590766832231, 67.37172508736451, 67.44462276001771, 67.4296185200413, 47.84490117927392, 47.648945582409695, 48.09792437249173, 61.301730860024676, 60.85360628366469, 61.36351187527178, 50.17067226519187, 50.48977133988713, 50.412591127057865, 52.08575568099816, 52.060990193237856, 51.78528978427251, 51.71233487253387, 50.51726176341374, 51.73451040809353, 42.16444071382284, 42.47196799144149, 41.288222670555115, 41.11413563291231, 42.22787601562837, 41.40922981003919, 48.62626042713721, 48.3647002701958, 47.93644808729489, 43.23625911275545, 43.23155332605043, 43.27763933936754, 52.917568155874804, 52.95878640686472, 52.73625378807385, 55.660905525088296, 55.96775865554808, 55.542248174548135, 47.06138172217955, 47.02892338422437, 46.41126901408036, 49.110549375414834, 48.974234782159314, 49.406464066356406, 54.1533750941356, 54.11935708423455, 53.5927428950866, 51.121834043413386, 51.16729994490741, 51.244797694496796, 52.66169045865534, 53.06494717299937, 53.37587200850247, 58.39301847418149, 58.04441541930039, 58.76486629809854, 64.2844076777498, 63.63870709637801, 64.25446671868364, 45.733043275773525, 45.661362543702126, 45.19242225587368, 49.99336547652881, 50.06201922396819, 50.30142481873433, 50.68756409734486, 50.61513793468474, 50.805027604103074, 54.2907726317644, 54.27145573496817, 54.42727639526127, 49.18166752594213, 49.22669985690543, 49.04549513633053, 49.51454221705596, 48.87485071520011, 49.12415660421054, 56.68773385882376, 57.13769187871365, 57.15684217121451, 50.63910231615107, 50.715630181754634, 50.49961442748706, 46.072574665459484, 45.47651872287193, 46.078863562007115, 43.11649478723605, 42.511996289094284, 42.4497305949529, 47.54111176853378, 47.295832862456635, 47.10662171741326, 44.06014849121371, 43.87886299441257, 44.299935328696534, 41.1288493866256, 40.672847042481095, 41.005690592030675, 53.170365293820694, 53.20490011324485, 53.36214046304424, 46.14819524437189, 46.56725586252287, 46.50062485225499, 58.06149876117705, 58.522464720532284, 58.47153978794812, 42.88654525578022, 42.98460868000984, 43.507944443728775, 27.034999016672373, 27.185065034776926, 27.153439173474908, 54.40516983127843, 54.34394847104947, 53.83612423638503, 48.873153676589325, 48.22882195313771, 49.611751207460955, 54.04305781672399, 54.380217115084335, 54.128195470819875, 46.86265011255939, 46.868421127398804, 46.59391815712054, 39.27963547625889, 38.2444994499286, 39.279217712891594, 49.04552887876828, 49.04870577839513, 48.25992133220036, 54.8273103137811, 55.98749077071746, 55.597995688517884, 57.30614851415156, 57.64119609445332, 57.92477018386124, 53.18558944265048, 53.68883920243631, 53.68897659579913, 51.39866738518079, 51.50413918246825, 51.3013757293423, 41.96385836601257, 41.99379926919937, 42.44517590291798, 42.902409270522185, 42.78410226665437, 42.68964297696948, 41.02834926793972, 41.282452625377715, 41.07851059983173, 48.11019517186408, 47.37660980721314, 48.078565289576844, 43.49463242292404, 43.451247468590736, 43.70879012346268, 57.100660324096665, 56.65299919247626, 57.30497023835777, 53.814033287266895, 53.62419267992179, 53.567638600866005, 54.0370938864847, 54.204171861832336, 53.66089065869649, 49.5566120892763, 49.55294174700974, 49.76413058675824, 68.69045539697011, 68.70601586004098, 68.89020564903815, 57.06345750391482, 57.225973218679414, 57.51501284912227, 44.71307701865831, 44.81634936730066, 45.40310695270696, 33.08955245713392, 33.51502888898054, 33.215550045172364, 55.66779212156932, 55.98558472531538, 55.455816323558494, 46.62040510773657, 47.298499570228145, 46.99903158098458, 42.76621103535095, 42.44387399653593, 41.93486619989076, 68.71028209477662, 69.17192178219555, 68.82026417553423, 42.80591708918412, 43.100006630023316, 43.4954386887451, 51.69183102250098, 51.95292268693446, 51.791235923767076, 52.1670794437329, 52.41036826713632, 52.074473420778915, 55.72145140916108, 55.59201426059006, 55.97655473230405, 59.38240533073743, 59.417633091409996, 59.48185173173745, 51.355755565804415, 50.84594243764876, 50.333654224872575, 44.031944448749215, 43.46276397506395, 44.08310620735088, 46.439854254325226, 46.1907044549783, 45.95435534914334, 54.69620990908395, 54.68070081310968, 54.49866603935759, 65.88182357931508, 65.88644755398853, 65.15432649850844, 46.02913311930993, 45.6634956623117, 45.50380308429399, 49.30293185139696, 49.370638965318605, 49.51553882999967, 58.07480168342589, 58.677313419058905, 58.6767982020974, 51.44070236633222, 51.53889708841841, 51.65138088787596, 59.83713332563637, 59.795303307473645, 60.0602917280048, 41.49217514445384, 40.797148068745926, 41.530142446358994, 50.34253363978739, 49.919308202962085, 50.317476194041475, 53.41303540269534, 53.72923558453719, 53.94348746041457, 48.67155215144156, 49.25335601344703, 49.09463296085595, 47.20289348314206, 46.788017327586815, 47.54765261265372, 34.8918731684486, 33.75799251596132, 34.4688858265678, 54.17049635015427, 53.972833648324, 54.192459749057875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14675583205322457, "mean_inference_ms": 0.7109967954624254, "mean_action_processing_ms": 0.10193980448591193, "mean_env_wait_ms": 0.8433108217584673, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 985000, "timesteps_this_iter": 0, "agent_timesteps_total": 2955000, "timers": {"sample_time_ms": 10334.26, "sample_throughput": 483.828, "load_time_ms": 0.2, "load_throughput": 25004793.132, "learn_time_ms": 1657.705, "learn_throughput": 3016.218, "update_time_ms": 7.747}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3541694921472754e-36, "cur_lr": 0.0005000000000000001, "total_loss": 10.058081340789794, "policy_loss": -1.2705820904557185e-05, "vf_loss": 10.158414077758788, "vf_explained_var": 0.02118251919746399, "kl": 0.005325021967348883, "entropy": 10.03199462890625, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 985000, "num_agent_steps_sampled": 2955000, "num_steps_trained": 985000, "num_agent_steps_trained": 2955000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2829, "training_iteration": 197, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-44-50", "timestamp": 1706229890, "time_this_iter_s": 10.406152963638306, "time_total_s": 2129.050487756729, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202837911F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2129.050487756729, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 12.87857142857143, "ram_util_percent": 51.971428571428575}}
{"episode_reward_max": 206.70246805250625, "episode_reward_min": 81.3735032249242, "episode_reward_mean": 151.6211103643126, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 27.034999016672373}, "policy_reward_max": {"shared_policy": 69.17192178219555}, "policy_reward_mean": {"shared_policy": 50.54037012143754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [131.05037422850737, 169.0666262954471, 141.3053961002735, 170.49386039748782, 202.24596636742348, 143.59177113417536, 183.5188490189614, 151.0730347321369, 155.93203565850837, 153.9641070440413, 125.92463137581944, 124.75124145857987, 144.927408784628, 129.74545177817322, 158.61260835081356, 167.1709123551846, 140.50157412048424, 147.49124822393048, 161.86547507345662, 153.53393168281772, 159.1025096401569, 175.2023001915805, 192.17758149281164, 136.5868280753493, 150.35680951923146, 152.10772963613275, 162.98950476199374, 147.453862519178, 147.51354953646646, 170.98226790875177, 151.85434692539283, 137.6279569503388, 128.07822167128325, 141.94356634840372, 132.23894681432267, 122.80738702113737, 159.73740587010977, 139.21607595914963, 175.05550326965735, 129.37909837951895, 81.3735032249242, 162.585242538713, 146.71372683718795, 162.551470402628, 140.32498939707915, 116.80335263907908, 146.35415598936387, 166.4127967730164, 172.87211479246628, 160.56340524088583, 154.20418229699135, 126.40283353812993, 128.37615451414604, 123.38931249314916, 143.565370268654, 130.6546700149775, 171.05862975493073, 161.00586456805482, 161.90215640701322, 148.87368442304458, 206.28667690604905, 171.80444357171683, 134.93253333866596, 99.82013139128682, 167.10919317044298, 140.9179362589494, 127.14495123177764, 206.70246805250625, 129.4013624079525, 155.43598963320264, 156.65192113164832, 167.29002040205523, 178.281890153885, 152.53535222832548, 131.57781463116396, 138.5849140584467, 163.87557676155097, 196.9225976318123, 137.19643186591563, 148.18910964671545, 175.42891330458224, 154.63098034262686, 179.69272836111483, 123.81946565955876, 150.57931803679094, 161.08575844764707, 147.01954112574455, 141.53856342338295, 103.11875151097772, 162.33578974753604, 151.62067460641262, 173.37351107830196, 163.6653234763069, 178.57676197122785, 119.19015154242516, 153.1603452842684, 176.9746874426782, 169.1225226558745, 139.65579093992702, 151.6945702135566], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [43.28673350314298, 44.01610855634013, 43.74753216902414, 56.35269700735806, 56.42166285961865, 56.2922664284706, 46.785862500468895, 47.47987079659167, 47.039662803212806, 56.42461773753165, 57.00333499163388, 57.06590766832231, 67.37172508736451, 67.44462276001771, 67.4296185200413, 47.84490117927392, 47.648945582409695, 48.09792437249173, 61.301730860024676, 60.85360628366469, 61.36351187527178, 50.17067226519187, 50.48977133988713, 50.412591127057865, 52.08575568099816, 52.060990193237856, 51.78528978427251, 51.71233487253387, 50.51726176341374, 51.73451040809353, 42.16444071382284, 42.47196799144149, 41.288222670555115, 41.11413563291231, 42.22787601562837, 41.40922981003919, 48.62626042713721, 48.3647002701958, 47.93644808729489, 43.23625911275545, 43.23155332605043, 43.27763933936754, 52.917568155874804, 52.95878640686472, 52.73625378807385, 55.660905525088296, 55.96775865554808, 55.542248174548135, 47.06138172217955, 47.02892338422437, 46.41126901408036, 49.110549375414834, 48.974234782159314, 49.406464066356406, 54.1533750941356, 54.11935708423455, 53.5927428950866, 51.121834043413386, 51.16729994490741, 51.244797694496796, 52.66169045865534, 53.06494717299937, 53.37587200850247, 58.39301847418149, 58.04441541930039, 58.76486629809854, 64.2844076777498, 63.63870709637801, 64.25446671868364, 45.733043275773525, 45.661362543702126, 45.19242225587368, 49.99336547652881, 50.06201922396819, 50.30142481873433, 50.68756409734486, 50.61513793468474, 50.805027604103074, 54.2907726317644, 54.27145573496817, 54.42727639526127, 49.18166752594213, 49.22669985690543, 49.04549513633053, 49.51454221705596, 48.87485071520011, 49.12415660421054, 56.68773385882376, 57.13769187871365, 57.15684217121451, 50.63910231615107, 50.715630181754634, 50.49961442748706, 46.072574665459484, 45.47651872287193, 46.078863562007115, 43.11649478723605, 42.511996289094284, 42.4497305949529, 47.54111176853378, 47.295832862456635, 47.10662171741326, 44.06014849121371, 43.87886299441257, 44.299935328696534, 41.1288493866256, 40.672847042481095, 41.005690592030675, 53.170365293820694, 53.20490011324485, 53.36214046304424, 46.14819524437189, 46.56725586252287, 46.50062485225499, 58.06149876117705, 58.522464720532284, 58.47153978794812, 42.88654525578022, 42.98460868000984, 43.507944443728775, 27.034999016672373, 27.185065034776926, 27.153439173474908, 54.40516983127843, 54.34394847104947, 53.83612423638503, 48.873153676589325, 48.22882195313771, 49.611751207460955, 54.04305781672399, 54.380217115084335, 54.128195470819875, 46.86265011255939, 46.868421127398804, 46.59391815712054, 39.27963547625889, 38.2444994499286, 39.279217712891594, 49.04552887876828, 49.04870577839513, 48.25992133220036, 54.8273103137811, 55.98749077071746, 55.597995688517884, 57.30614851415156, 57.64119609445332, 57.92477018386124, 53.18558944265048, 53.68883920243631, 53.68897659579913, 51.39866738518079, 51.50413918246825, 51.3013757293423, 41.96385836601257, 41.99379926919937, 42.44517590291798, 42.902409270522185, 42.78410226665437, 42.68964297696948, 41.02834926793972, 41.282452625377715, 41.07851059983173, 48.11019517186408, 47.37660980721314, 48.078565289576844, 43.49463242292404, 43.451247468590736, 43.70879012346268, 57.100660324096665, 56.65299919247626, 57.30497023835777, 53.814033287266895, 53.62419267992179, 53.567638600866005, 54.0370938864847, 54.204171861832336, 53.66089065869649, 49.5566120892763, 49.55294174700974, 49.76413058675824, 68.69045539697011, 68.70601586004098, 68.89020564903815, 57.06345750391482, 57.225973218679414, 57.51501284912227, 44.71307701865831, 44.81634936730066, 45.40310695270696, 33.08955245713392, 33.51502888898054, 33.215550045172364, 55.66779212156932, 55.98558472531538, 55.455816323558494, 46.62040510773657, 47.298499570228145, 46.99903158098458, 42.76621103535095, 42.44387399653593, 41.93486619989076, 68.71028209477662, 69.17192178219555, 68.82026417553423, 42.80591708918412, 43.100006630023316, 43.4954386887451, 51.69183102250098, 51.95292268693446, 51.791235923767076, 52.1670794437329, 52.41036826713632, 52.074473420778915, 55.72145140916108, 55.59201426059006, 55.97655473230405, 59.38240533073743, 59.417633091409996, 59.48185173173745, 51.355755565804415, 50.84594243764876, 50.333654224872575, 44.031944448749215, 43.46276397506395, 44.08310620735088, 46.439854254325226, 46.1907044549783, 45.95435534914334, 54.69620990908395, 54.68070081310968, 54.49866603935759, 65.88182357931508, 65.88644755398853, 65.15432649850844, 46.02913311930993, 45.6634956623117, 45.50380308429399, 49.30293185139696, 49.370638965318605, 49.51553882999967, 58.07480168342589, 58.677313419058905, 58.6767982020974, 51.44070236633222, 51.53889708841841, 51.65138088787596, 59.83713332563637, 59.795303307473645, 60.0602917280048, 41.49217514445384, 40.797148068745926, 41.530142446358994, 50.34253363978739, 49.919308202962085, 50.317476194041475, 53.41303540269534, 53.72923558453719, 53.94348746041457, 48.67155215144156, 49.25335601344703, 49.09463296085595, 47.20289348314206, 46.788017327586815, 47.54765261265372, 34.8918731684486, 33.75799251596132, 34.4688858265678, 54.17049635015427, 53.972833648324, 54.192459749057875, 50.19354553520678, 50.72988826408981, 50.69724080711602, 57.56587833662827, 57.81725859766205, 57.99037414401148, 54.30516593158244, 54.99889269005506, 54.36126485466956, 59.257311897973224, 59.565152845035, 59.75429722821961, 40.044260770082474, 39.687977731227875, 39.45791304111481, 50.60838719209035, 51.05084256579478, 51.50111552638312, 58.588033080101, 59.422713451582226, 58.96394091099499, 55.55063419540723, 56.94653513406713, 56.625353326400116, 46.5244750107328, 46.565203386048466, 46.566112543145806, 50.72192271302144, 50.38250257323186, 50.590144927303]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14671254654551782, "mean_inference_ms": 0.710829057893849, "mean_action_processing_ms": 0.10191135047390634, "mean_env_wait_ms": 0.8430601095779404, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 990000, "timesteps_this_iter": 0, "agent_timesteps_total": 2970000, "timers": {"sample_time_ms": 10265.918, "sample_throughput": 487.048, "load_time_ms": 0.2, "load_throughput": 25004793.132, "learn_time_ms": 1654.161, "learn_throughput": 3022.681, "update_time_ms": 7.747}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3541694921472754e-36, "cur_lr": 0.0005000000000000001, "total_loss": 12.165730571746826, "policy_loss": 0.002510700377883879, "vf_loss": 12.25925941467285, "vf_explained_var": 0.0095142662525177, "kl": 0.022877613827638442, "entropy": 9.60391550064087, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 990000, "num_agent_steps_sampled": 2970000, "num_steps_trained": 990000, "num_agent_steps_trained": 2970000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2839, "training_iteration": 198, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-45-00", "timestamp": 1706229900, "time_this_iter_s": 10.107993364334106, "time_total_s": 2139.1584811210632, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202846E41F0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2139.1584811210632, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 10.666666666666666, "ram_util_percent": 51.99333333333333}}
{"episode_reward_max": 206.70246805250625, "episode_reward_min": 81.3735032249242, "episode_reward_mean": 151.61193578510532, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 27.034999016672373}, "policy_reward_max": {"shared_policy": 69.17192178219555}, "policy_reward_mean": {"shared_policy": 50.53731192836844}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.92463137581944, 124.75124145857987, 144.927408784628, 129.74545177817322, 158.61260835081356, 167.1709123551846, 140.50157412048424, 147.49124822393048, 161.86547507345662, 153.53393168281772, 159.1025096401569, 175.2023001915805, 192.17758149281164, 136.5868280753493, 150.35680951923146, 152.10772963613275, 162.98950476199374, 147.453862519178, 147.51354953646646, 170.98226790875177, 151.85434692539283, 137.6279569503388, 128.07822167128325, 141.94356634840372, 132.23894681432267, 122.80738702113737, 159.73740587010977, 139.21607595914963, 175.05550326965735, 129.37909837951895, 81.3735032249242, 162.585242538713, 146.71372683718795, 162.551470402628, 140.32498939707915, 116.80335263907908, 146.35415598936387, 166.4127967730164, 172.87211479246628, 160.56340524088583, 154.20418229699135, 126.40283353812993, 128.37615451414604, 123.38931249314916, 143.565370268654, 130.6546700149775, 171.05862975493073, 161.00586456805482, 161.90215640701322, 148.87368442304458, 206.28667690604905, 171.80444357171683, 134.93253333866596, 99.82013139128682, 167.10919317044298, 140.9179362589494, 127.14495123177764, 206.70246805250625, 129.4013624079525, 155.43598963320264, 156.65192113164832, 167.29002040205523, 178.281890153885, 152.53535222832548, 131.57781463116396, 138.5849140584467, 163.87557676155097, 196.9225976318123, 137.19643186591563, 148.18910964671545, 175.42891330458224, 154.63098034262686, 179.69272836111483, 123.81946565955876, 150.57931803679094, 161.08575844764707, 147.01954112574455, 141.53856342338295, 103.11875151097772, 162.33578974753604, 151.62067460641262, 173.37351107830196, 163.6653234763069, 178.57676197122785, 119.19015154242516, 153.1603452842684, 176.9746874426782, 169.1225226558745, 139.65579093992702, 151.6945702135566, 158.46704951673723, 172.4657948464155, 168.29451109096388, 136.73180869594222, 151.6788017246874, 182.75618393719205, 188.4469130709768, 151.4805152080953, 157.56851062923656, 133.43447433598342], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [42.16444071382284, 42.47196799144149, 41.288222670555115, 41.11413563291231, 42.22787601562837, 41.40922981003919, 48.62626042713721, 48.3647002701958, 47.93644808729489, 43.23625911275545, 43.23155332605043, 43.27763933936754, 52.917568155874804, 52.95878640686472, 52.73625378807385, 55.660905525088296, 55.96775865554808, 55.542248174548135, 47.06138172217955, 47.02892338422437, 46.41126901408036, 49.110549375414834, 48.974234782159314, 49.406464066356406, 54.1533750941356, 54.11935708423455, 53.5927428950866, 51.121834043413386, 51.16729994490741, 51.244797694496796, 52.66169045865534, 53.06494717299937, 53.37587200850247, 58.39301847418149, 58.04441541930039, 58.76486629809854, 64.2844076777498, 63.63870709637801, 64.25446671868364, 45.733043275773525, 45.661362543702126, 45.19242225587368, 49.99336547652881, 50.06201922396819, 50.30142481873433, 50.68756409734486, 50.61513793468474, 50.805027604103074, 54.2907726317644, 54.27145573496817, 54.42727639526127, 49.18166752594213, 49.22669985690543, 49.04549513633053, 49.51454221705596, 48.87485071520011, 49.12415660421054, 56.68773385882376, 57.13769187871365, 57.15684217121451, 50.63910231615107, 50.715630181754634, 50.49961442748706, 46.072574665459484, 45.47651872287193, 46.078863562007115, 43.11649478723605, 42.511996289094284, 42.4497305949529, 47.54111176853378, 47.295832862456635, 47.10662171741326, 44.06014849121371, 43.87886299441257, 44.299935328696534, 41.1288493866256, 40.672847042481095, 41.005690592030675, 53.170365293820694, 53.20490011324485, 53.36214046304424, 46.14819524437189, 46.56725586252287, 46.50062485225499, 58.06149876117705, 58.522464720532284, 58.47153978794812, 42.88654525578022, 42.98460868000984, 43.507944443728775, 27.034999016672373, 27.185065034776926, 27.153439173474908, 54.40516983127843, 54.34394847104947, 53.83612423638503, 48.873153676589325, 48.22882195313771, 49.611751207460955, 54.04305781672399, 54.380217115084335, 54.128195470819875, 46.86265011255939, 46.868421127398804, 46.59391815712054, 39.27963547625889, 38.2444994499286, 39.279217712891594, 49.04552887876828, 49.04870577839513, 48.25992133220036, 54.8273103137811, 55.98749077071746, 55.597995688517884, 57.30614851415156, 57.64119609445332, 57.92477018386124, 53.18558944265048, 53.68883920243631, 53.68897659579913, 51.39866738518079, 51.50413918246825, 51.3013757293423, 41.96385836601257, 41.99379926919937, 42.44517590291798, 42.902409270522185, 42.78410226665437, 42.68964297696948, 41.02834926793972, 41.282452625377715, 41.07851059983173, 48.11019517186408, 47.37660980721314, 48.078565289576844, 43.49463242292404, 43.451247468590736, 43.70879012346268, 57.100660324096665, 56.65299919247626, 57.30497023835777, 53.814033287266895, 53.62419267992179, 53.567638600866005, 54.0370938864847, 54.204171861832336, 53.66089065869649, 49.5566120892763, 49.55294174700974, 49.76413058675824, 68.69045539697011, 68.70601586004098, 68.89020564903815, 57.06345750391482, 57.225973218679414, 57.51501284912227, 44.71307701865831, 44.81634936730066, 45.40310695270696, 33.08955245713392, 33.51502888898054, 33.215550045172364, 55.66779212156932, 55.98558472531538, 55.455816323558494, 46.62040510773657, 47.298499570228145, 46.99903158098458, 42.76621103535095, 42.44387399653593, 41.93486619989076, 68.71028209477662, 69.17192178219555, 68.82026417553423, 42.80591708918412, 43.100006630023316, 43.4954386887451, 51.69183102250098, 51.95292268693446, 51.791235923767076, 52.1670794437329, 52.41036826713632, 52.074473420778915, 55.72145140916108, 55.59201426059006, 55.97655473230405, 59.38240533073743, 59.417633091409996, 59.48185173173745, 51.355755565804415, 50.84594243764876, 50.333654224872575, 44.031944448749215, 43.46276397506395, 44.08310620735088, 46.439854254325226, 46.1907044549783, 45.95435534914334, 54.69620990908395, 54.68070081310968, 54.49866603935759, 65.88182357931508, 65.88644755398853, 65.15432649850844, 46.02913311930993, 45.6634956623117, 45.50380308429399, 49.30293185139696, 49.370638965318605, 49.51553882999967, 58.07480168342589, 58.677313419058905, 58.6767982020974, 51.44070236633222, 51.53889708841841, 51.65138088787596, 59.83713332563637, 59.795303307473645, 60.0602917280048, 41.49217514445384, 40.797148068745926, 41.530142446358994, 50.34253363978739, 49.919308202962085, 50.317476194041475, 53.41303540269534, 53.72923558453719, 53.94348746041457, 48.67155215144156, 49.25335601344703, 49.09463296085595, 47.20289348314206, 46.788017327586815, 47.54765261265372, 34.8918731684486, 33.75799251596132, 34.4688858265678, 54.17049635015427, 53.972833648324, 54.192459749057875, 50.19354553520678, 50.72988826408981, 50.69724080711602, 57.56587833662827, 57.81725859766205, 57.99037414401148, 54.30516593158244, 54.99889269005506, 54.36126485466956, 59.257311897973224, 59.565152845035, 59.75429722821961, 40.044260770082474, 39.687977731227875, 39.45791304111481, 50.60838719209035, 51.05084256579478, 51.50111552638312, 58.588033080101, 59.422713451582226, 58.96394091099499, 55.55063419540723, 56.94653513406713, 56.625353326400116, 46.5244750107328, 46.565203386048466, 46.566112543145806, 50.72192271302144, 50.38250257323186, 50.590144927303, 52.71454181273778, 52.89589584556718, 52.85661185843249, 57.51459580411513, 57.43571304281552, 57.51548599948485, 56.49452622607349, 55.74220204353331, 56.057782821357236, 45.94728113089998, 45.686952014764145, 45.09757555027802, 50.981986710801706, 50.00148463249205, 50.69533038139342, 60.08532314499219, 61.37662912656863, 61.29423166563113, 62.690222091972814, 62.97586259990929, 62.78082837909459, 50.26658033331235, 50.59755080689986, 50.61638406788309, 52.00086252391337, 52.76762520521878, 52.80002290010451, 44.76320158938566, 44.69317474650839, 43.97809800008932]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14667086211095692, "mean_inference_ms": 0.7106612878403731, "mean_action_processing_ms": 0.10188622513673572, "mean_env_wait_ms": 0.8428094087592486, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 995000, "timesteps_this_iter": 0, "agent_timesteps_total": 2985000, "timers": {"sample_time_ms": 10259.139, "sample_throughput": 487.37, "load_time_ms": 0.2, "load_throughput": 25004793.132, "learn_time_ms": 1662.633, "learn_throughput": 3007.277, "update_time_ms": 7.834}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.031254238220913e-36, "cur_lr": 0.0005000000000000001, "total_loss": 10.20848207473755, "policy_loss": 0.0009368277438047024, "vf_loss": 10.305390644073487, "vf_explained_var": 0.011978352069854736, "kl": 0.01055942843673794, "entropy": 9.784586334228516, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 995000, "num_agent_steps_sampled": 2985000, "num_steps_trained": 995000, "num_agent_steps_trained": 2985000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2849, "training_iteration": 199, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-45-11", "timestamp": 1706229911, "time_this_iter_s": 10.186517477035522, "time_total_s": 2149.3449985980988, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202824924C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2149.3449985980988, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 10.299999999999999, "ram_util_percent": 52.064285714285724}}
{"episode_reward_max": 206.70246805250625, "episode_reward_min": 81.3735032249242, "episode_reward_mean": 151.7941385539643, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 27.034999016672373}, "policy_reward_max": {"shared_policy": 69.17192178219555}, "policy_reward_mean": {"shared_policy": 50.59804618465476}, "custom_metrics": {}, "hist_stats": {"episode_reward": [159.1025096401569, 175.2023001915805, 192.17758149281164, 136.5868280753493, 150.35680951923146, 152.10772963613275, 162.98950476199374, 147.453862519178, 147.51354953646646, 170.98226790875177, 151.85434692539283, 137.6279569503388, 128.07822167128325, 141.94356634840372, 132.23894681432267, 122.80738702113737, 159.73740587010977, 139.21607595914963, 175.05550326965735, 129.37909837951895, 81.3735032249242, 162.585242538713, 146.71372683718795, 162.551470402628, 140.32498939707915, 116.80335263907908, 146.35415598936387, 166.4127967730164, 172.87211479246628, 160.56340524088583, 154.20418229699135, 126.40283353812993, 128.37615451414604, 123.38931249314916, 143.565370268654, 130.6546700149775, 171.05862975493073, 161.00586456805482, 161.90215640701322, 148.87368442304458, 206.28667690604905, 171.80444357171683, 134.93253333866596, 99.82013139128682, 167.10919317044298, 140.9179362589494, 127.14495123177764, 206.70246805250625, 129.4013624079525, 155.43598963320264, 156.65192113164832, 167.29002040205523, 178.281890153885, 152.53535222832548, 131.57781463116396, 138.5849140584467, 163.87557676155097, 196.9225976318123, 137.19643186591563, 148.18910964671545, 175.42891330458224, 154.63098034262686, 179.69272836111483, 123.81946565955876, 150.57931803679094, 161.08575844764707, 147.01954112574455, 141.53856342338295, 103.11875151097772, 162.33578974753604, 151.62067460641262, 173.37351107830196, 163.6653234763069, 178.57676197122785, 119.19015154242516, 153.1603452842684, 176.9746874426782, 169.1225226558745, 139.65579093992702, 151.6945702135566, 158.46704951673723, 172.4657948464155, 168.29451109096388, 136.73180869594222, 151.6788017246874, 182.75618393719205, 188.4469130709768, 151.4805152080953, 157.56851062923656, 133.43447433598342, 191.94837850518513, 153.98061257135083, 116.22725192829964, 190.2934774346648, 135.5002321284263, 143.98005658015614, 134.51220798492423, 149.50079846568397, 125.32686929148619, 131.47487519960845], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [52.66169045865534, 53.06494717299937, 53.37587200850247, 58.39301847418149, 58.04441541930039, 58.76486629809854, 64.2844076777498, 63.63870709637801, 64.25446671868364, 45.733043275773525, 45.661362543702126, 45.19242225587368, 49.99336547652881, 50.06201922396819, 50.30142481873433, 50.68756409734486, 50.61513793468474, 50.805027604103074, 54.2907726317644, 54.27145573496817, 54.42727639526127, 49.18166752594213, 49.22669985690543, 49.04549513633053, 49.51454221705596, 48.87485071520011, 49.12415660421054, 56.68773385882376, 57.13769187871365, 57.15684217121451, 50.63910231615107, 50.715630181754634, 50.49961442748706, 46.072574665459484, 45.47651872287193, 46.078863562007115, 43.11649478723605, 42.511996289094284, 42.4497305949529, 47.54111176853378, 47.295832862456635, 47.10662171741326, 44.06014849121371, 43.87886299441257, 44.299935328696534, 41.1288493866256, 40.672847042481095, 41.005690592030675, 53.170365293820694, 53.20490011324485, 53.36214046304424, 46.14819524437189, 46.56725586252287, 46.50062485225499, 58.06149876117705, 58.522464720532284, 58.47153978794812, 42.88654525578022, 42.98460868000984, 43.507944443728775, 27.034999016672373, 27.185065034776926, 27.153439173474908, 54.40516983127843, 54.34394847104947, 53.83612423638503, 48.873153676589325, 48.22882195313771, 49.611751207460955, 54.04305781672399, 54.380217115084335, 54.128195470819875, 46.86265011255939, 46.868421127398804, 46.59391815712054, 39.27963547625889, 38.2444994499286, 39.279217712891594, 49.04552887876828, 49.04870577839513, 48.25992133220036, 54.8273103137811, 55.98749077071746, 55.597995688517884, 57.30614851415156, 57.64119609445332, 57.92477018386124, 53.18558944265048, 53.68883920243631, 53.68897659579913, 51.39866738518079, 51.50413918246825, 51.3013757293423, 41.96385836601257, 41.99379926919937, 42.44517590291798, 42.902409270522185, 42.78410226665437, 42.68964297696948, 41.02834926793972, 41.282452625377715, 41.07851059983173, 48.11019517186408, 47.37660980721314, 48.078565289576844, 43.49463242292404, 43.451247468590736, 43.70879012346268, 57.100660324096665, 56.65299919247626, 57.30497023835777, 53.814033287266895, 53.62419267992179, 53.567638600866005, 54.0370938864847, 54.204171861832336, 53.66089065869649, 49.5566120892763, 49.55294174700974, 49.76413058675824, 68.69045539697011, 68.70601586004098, 68.89020564903815, 57.06345750391482, 57.225973218679414, 57.51501284912227, 44.71307701865831, 44.81634936730066, 45.40310695270696, 33.08955245713392, 33.51502888898054, 33.215550045172364, 55.66779212156932, 55.98558472531538, 55.455816323558494, 46.62040510773657, 47.298499570228145, 46.99903158098458, 42.76621103535095, 42.44387399653593, 41.93486619989076, 68.71028209477662, 69.17192178219555, 68.82026417553423, 42.80591708918412, 43.100006630023316, 43.4954386887451, 51.69183102250098, 51.95292268693446, 51.791235923767076, 52.1670794437329, 52.41036826713632, 52.074473420778915, 55.72145140916108, 55.59201426059006, 55.97655473230405, 59.38240533073743, 59.417633091409996, 59.48185173173745, 51.355755565804415, 50.84594243764876, 50.333654224872575, 44.031944448749215, 43.46276397506395, 44.08310620735088, 46.439854254325226, 46.1907044549783, 45.95435534914334, 54.69620990908395, 54.68070081310968, 54.49866603935759, 65.88182357931508, 65.88644755398853, 65.15432649850844, 46.02913311930993, 45.6634956623117, 45.50380308429399, 49.30293185139696, 49.370638965318605, 49.51553882999967, 58.07480168342589, 58.677313419058905, 58.6767982020974, 51.44070236633222, 51.53889708841841, 51.65138088787596, 59.83713332563637, 59.795303307473645, 60.0602917280048, 41.49217514445384, 40.797148068745926, 41.530142446358994, 50.34253363978739, 49.919308202962085, 50.317476194041475, 53.41303540269534, 53.72923558453719, 53.94348746041457, 48.67155215144156, 49.25335601344703, 49.09463296085595, 47.20289348314206, 46.788017327586815, 47.54765261265372, 34.8918731684486, 33.75799251596132, 34.4688858265678, 54.17049635015427, 53.972833648324, 54.192459749057875, 50.19354553520678, 50.72988826408981, 50.69724080711602, 57.56587833662827, 57.81725859766205, 57.99037414401148, 54.30516593158244, 54.99889269005506, 54.36126485466956, 59.257311897973224, 59.565152845035, 59.75429722821961, 40.044260770082474, 39.687977731227875, 39.45791304111481, 50.60838719209035, 51.05084256579478, 51.50111552638312, 58.588033080101, 59.422713451582226, 58.96394091099499, 55.55063419540723, 56.94653513406713, 56.625353326400116, 46.5244750107328, 46.565203386048466, 46.566112543145806, 50.72192271302144, 50.38250257323186, 50.590144927303, 52.71454181273778, 52.89589584556718, 52.85661185843249, 57.51459580411513, 57.43571304281552, 57.51548599948485, 56.49452622607349, 55.74220204353331, 56.057782821357236, 45.94728113089998, 45.686952014764145, 45.09757555027802, 50.981986710801706, 50.00148463249205, 50.69533038139342, 60.08532314499219, 61.37662912656863, 61.29423166563113, 62.690222091972814, 62.97586259990929, 62.78082837909459, 50.26658033331235, 50.59755080689986, 50.61638406788309, 52.00086252391337, 52.76762520521878, 52.80002290010451, 44.76320158938566, 44.69317474650839, 43.97809800008932, 64.03235753066836, 64.03753485530613, 63.878486119210706, 50.238433470328644, 51.79742920150359, 51.94474989951898, 38.773963316033274, 38.74108977584788, 38.71219883641848, 63.95213853598882, 62.37854145963986, 63.962797439036265, 45.34554483927786, 44.92005968093872, 45.23462760820985, 48.07850520809491, 48.31240528946121, 47.58914608259995, 44.676383793354034, 44.87363985180855, 44.962184339761734, 49.97994054853915, 50.139666961505995, 49.38119095563887, 41.409806723395974, 41.82470534245172, 42.092357225638494, 43.6519855732719, 43.845937560002, 43.976952066334576]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14662960682843956, "mean_inference_ms": 0.7105135142807409, "mean_action_processing_ms": 0.10186470722529675, "mean_env_wait_ms": 0.8425670597693984, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1000000, "timesteps_this_iter": 0, "agent_timesteps_total": 3000000, "timers": {"sample_time_ms": 10299.608, "sample_throughput": 485.455, "load_time_ms": 0.122, "load_throughput": 41056225.529, "learn_time_ms": 1668.283, "learn_throughput": 2997.093, "update_time_ms": 7.834}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.031254238220913e-36, "cur_lr": 0.0005000000000000001, "total_loss": 8.905884552001954, "policy_loss": 0.002800429149403527, "vf_loss": 9.005582904815673, "vf_explained_var": 0.012251675128936768, "kl": 0.020925920270444646, "entropy": 10.249874114990234, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1000000, "num_agent_steps_sampled": 3000000, "num_steps_trained": 1000000, "num_agent_steps_trained": 3000000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 201.77882154611888, "episode_reward_min": -221.6379325501621, "episode_reward_mean": 106.90110489963554, "episode_len_mean": 488.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -80.57061145206293}, "policy_reward_max": {"shared_policy": 67.48303565514895}, "policy_reward_mean": {"shared_policy": 35.633701633211835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [122.9950438272208, 158.772348909639, 147.1099772304295, -221.6379325501621, 114.05188930314034, 149.80429084971527, 106.4830235056579, 138.63485240191238, 151.01873397268338, 201.77882154611888], "episode_lengths": [500, 500, 500, 381, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [40.24065873026848, 41.342915039509535, 41.411470057442784, 53.00886835561444, 52.78553348158796, 52.97794707243641, 49.23024671773116, 48.80684110025565, 49.07288941244285, -69.95975665872297, -71.1075644393762, -80.57061145206293, 37.5022688806057, 38.0860308855772, 38.46358953695744, 49.99566843422751, 49.8255346963803, 49.98308771910767, 35.381918383141354, 35.46634117265542, 35.634763949861124, 46.08837216099103, 46.32709979017575, 46.21938045074542, 50.765713234121606, 49.84931051234405, 50.40371022621791, 66.82110324005286, 67.4746826509169, 67.48303565514895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1552171623691228, "mean_inference_ms": 0.7800571804086924, "mean_action_processing_ms": 0.10976223216043875, "mean_env_wait_ms": 0.8752398442459375, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 2859, "training_iteration": 200, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-45-31", "timestamp": 1706229931, "time_this_iter_s": 20.8125958442688, "time_total_s": 2170.1575944423676, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202837AD4C0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2170.1575944423676, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 11.12, "ram_util_percent": 52.64333333333334}}
{"episode_reward_max": 206.70246805250625, "episode_reward_min": 80.48793830722568, "episode_reward_mean": 150.60969955347798, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 26.519064123431832}, "policy_reward_max": {"shared_policy": 69.17192178219555}, "policy_reward_mean": {"shared_policy": 50.20323318449266}, "custom_metrics": {}, "hist_stats": {"episode_reward": [151.85434692539283, 137.6279569503388, 128.07822167128325, 141.94356634840372, 132.23894681432267, 122.80738702113737, 159.73740587010977, 139.21607595914963, 175.05550326965735, 129.37909837951895, 81.3735032249242, 162.585242538713, 146.71372683718795, 162.551470402628, 140.32498939707915, 116.80335263907908, 146.35415598936387, 166.4127967730164, 172.87211479246628, 160.56340524088583, 154.20418229699135, 126.40283353812993, 128.37615451414604, 123.38931249314916, 143.565370268654, 130.6546700149775, 171.05862975493073, 161.00586456805482, 161.90215640701322, 148.87368442304458, 206.28667690604905, 171.80444357171683, 134.93253333866596, 99.82013139128682, 167.10919317044298, 140.9179362589494, 127.14495123177764, 206.70246805250625, 129.4013624079525, 155.43598963320264, 156.65192113164832, 167.29002040205523, 178.281890153885, 152.53535222832548, 131.57781463116396, 138.5849140584467, 163.87557676155097, 196.9225976318123, 137.19643186591563, 148.18910964671545, 175.42891330458224, 154.63098034262686, 179.69272836111483, 123.81946565955876, 150.57931803679094, 161.08575844764707, 147.01954112574455, 141.53856342338295, 103.11875151097772, 162.33578974753604, 151.62067460641262, 173.37351107830196, 163.6653234763069, 178.57676197122785, 119.19015154242516, 153.1603452842684, 176.9746874426782, 169.1225226558745, 139.65579093992702, 151.6945702135566, 158.46704951673723, 172.4657948464155, 168.29451109096388, 136.73180869594222, 151.6788017246874, 182.75618393719205, 188.4469130709768, 151.4805152080953, 157.56851062923656, 133.43447433598342, 191.94837850518513, 153.98061257135083, 116.22725192829964, 190.2934774346648, 135.5002321284263, 143.98005658015614, 134.51220798492423, 149.50079846568397, 125.32686929148619, 131.47487519960845, 132.91166996024543, 149.11115661263509, 126.27254928648472, 166.9891364164649, 138.4986911686138, 80.48793830722568, 171.73407313227642, 173.7944988971578, 146.71881696581812, 189.51051248610023], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [50.63910231615107, 50.715630181754634, 50.49961442748706, 46.072574665459484, 45.47651872287193, 46.078863562007115, 43.11649478723605, 42.511996289094284, 42.4497305949529, 47.54111176853378, 47.295832862456635, 47.10662171741326, 44.06014849121371, 43.87886299441257, 44.299935328696534, 41.1288493866256, 40.672847042481095, 41.005690592030675, 53.170365293820694, 53.20490011324485, 53.36214046304424, 46.14819524437189, 46.56725586252287, 46.50062485225499, 58.06149876117705, 58.522464720532284, 58.47153978794812, 42.88654525578022, 42.98460868000984, 43.507944443728775, 27.034999016672373, 27.185065034776926, 27.153439173474908, 54.40516983127843, 54.34394847104947, 53.83612423638503, 48.873153676589325, 48.22882195313771, 49.611751207460955, 54.04305781672399, 54.380217115084335, 54.128195470819875, 46.86265011255939, 46.868421127398804, 46.59391815712054, 39.27963547625889, 38.2444994499286, 39.279217712891594, 49.04552887876828, 49.04870577839513, 48.25992133220036, 54.8273103137811, 55.98749077071746, 55.597995688517884, 57.30614851415156, 57.64119609445332, 57.92477018386124, 53.18558944265048, 53.68883920243631, 53.68897659579913, 51.39866738518079, 51.50413918246825, 51.3013757293423, 41.96385836601257, 41.99379926919937, 42.44517590291798, 42.902409270522185, 42.78410226665437, 42.68964297696948, 41.02834926793972, 41.282452625377715, 41.07851059983173, 48.11019517186408, 47.37660980721314, 48.078565289576844, 43.49463242292404, 43.451247468590736, 43.70879012346268, 57.100660324096665, 56.65299919247626, 57.30497023835777, 53.814033287266895, 53.62419267992179, 53.567638600866005, 54.0370938864847, 54.204171861832336, 53.66089065869649, 49.5566120892763, 49.55294174700974, 49.76413058675824, 68.69045539697011, 68.70601586004098, 68.89020564903815, 57.06345750391482, 57.225973218679414, 57.51501284912227, 44.71307701865831, 44.81634936730066, 45.40310695270696, 33.08955245713392, 33.51502888898054, 33.215550045172364, 55.66779212156932, 55.98558472531538, 55.455816323558494, 46.62040510773657, 47.298499570228145, 46.99903158098458, 42.76621103535095, 42.44387399653593, 41.93486619989076, 68.71028209477662, 69.17192178219555, 68.82026417553423, 42.80591708918412, 43.100006630023316, 43.4954386887451, 51.69183102250098, 51.95292268693446, 51.791235923767076, 52.1670794437329, 52.41036826713632, 52.074473420778915, 55.72145140916108, 55.59201426059006, 55.97655473230405, 59.38240533073743, 59.417633091409996, 59.48185173173745, 51.355755565804415, 50.84594243764876, 50.333654224872575, 44.031944448749215, 43.46276397506395, 44.08310620735088, 46.439854254325226, 46.1907044549783, 45.95435534914334, 54.69620990908395, 54.68070081310968, 54.49866603935759, 65.88182357931508, 65.88644755398853, 65.15432649850844, 46.02913311930993, 45.6634956623117, 45.50380308429399, 49.30293185139696, 49.370638965318605, 49.51553882999967, 58.07480168342589, 58.677313419058905, 58.6767982020974, 51.44070236633222, 51.53889708841841, 51.65138088787596, 59.83713332563637, 59.795303307473645, 60.0602917280048, 41.49217514445384, 40.797148068745926, 41.530142446358994, 50.34253363978739, 49.919308202962085, 50.317476194041475, 53.41303540269534, 53.72923558453719, 53.94348746041457, 48.67155215144156, 49.25335601344703, 49.09463296085595, 47.20289348314206, 46.788017327586815, 47.54765261265372, 34.8918731684486, 33.75799251596132, 34.4688858265678, 54.17049635015427, 53.972833648324, 54.192459749057875, 50.19354553520678, 50.72988826408981, 50.69724080711602, 57.56587833662827, 57.81725859766205, 57.99037414401148, 54.30516593158244, 54.99889269005506, 54.36126485466956, 59.257311897973224, 59.565152845035, 59.75429722821961, 40.044260770082474, 39.687977731227875, 39.45791304111481, 50.60838719209035, 51.05084256579478, 51.50111552638312, 58.588033080101, 59.422713451582226, 58.96394091099499, 55.55063419540723, 56.94653513406713, 56.625353326400116, 46.5244750107328, 46.565203386048466, 46.566112543145806, 50.72192271302144, 50.38250257323186, 50.590144927303, 52.71454181273778, 52.89589584556718, 52.85661185843249, 57.51459580411513, 57.43571304281552, 57.51548599948485, 56.49452622607349, 55.74220204353331, 56.057782821357236, 45.94728113089998, 45.686952014764145, 45.09757555027802, 50.981986710801706, 50.00148463249205, 50.69533038139342, 60.08532314499219, 61.37662912656863, 61.29423166563113, 62.690222091972814, 62.97586259990929, 62.78082837909459, 50.26658033331235, 50.59755080689986, 50.61638406788309, 52.00086252391337, 52.76762520521878, 52.80002290010451, 44.76320158938566, 44.69317474650839, 43.97809800008932, 64.03235753066836, 64.03753485530613, 63.878486119210706, 50.238433470328644, 51.79742920150359, 51.94474989951898, 38.773963316033274, 38.74108977584788, 38.71219883641848, 63.95213853598882, 62.37854145963986, 63.962797439036265, 45.34554483927786, 44.92005968093872, 45.23462760820985, 48.07850520809491, 48.31240528946121, 47.58914608259995, 44.676383793354034, 44.87363985180855, 44.962184339761734, 49.97994054853915, 50.139666961505995, 49.38119095563887, 41.409806723395974, 41.82470534245172, 42.092357225638494, 43.6519855732719, 43.845937560002, 43.976952066334576, 44.4854666677614, 43.882553448279694, 44.54364984420438, 49.64422446986039, 49.959702913959816, 49.50722922881444, 41.979729518294334, 42.07163406908512, 42.22118569910526, 55.72167024140556, 55.653486159940556, 55.61398001511891, 45.59812447428703, 46.90520274359733, 45.99536395072937, 27.097504439453274, 26.519064123431832, 26.87136974434057, 57.4789191931486, 57.37642267346381, 56.878731265664086, 58.03138059160362, 57.99941062058012, 57.76370768497388, 48.67775578796862, 48.947857998311505, 49.093203179538236, 62.98874767621358, 62.98440126826365, 63.53736354162295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1465912366771611, "mean_inference_ms": 0.7103729779108017, "mean_action_processing_ms": 0.10184428158069155, "mean_env_wait_ms": 0.8423346619846542, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1005000, "timesteps_this_iter": 0, "agent_timesteps_total": 3015000, "timers": {"sample_time_ms": 11271.899, "sample_throughput": 443.581, "load_time_ms": 0.122, "load_throughput": 41056225.529, "learn_time_ms": 1679.658, "learn_throughput": 2976.796, "update_time_ms": 7.84}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.046881357331369e-36, "cur_lr": 0.0005000000000000001, "total_loss": 13.981128025054932, "policy_loss": 0.003445882198326267, "vf_loss": 14.079400444030762, "vf_explained_var": 0.0033974647521972656, "kl": 0.08387694209820254, "entropy": 10.171849536895753, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1005000, "num_agent_steps_sampled": 3015000, "num_steps_trained": 1005000, "num_agent_steps_trained": 3015000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2869, "training_iteration": 201, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-45-42", "timestamp": 1706229942, "time_this_iter_s": 10.290089845657349, "time_total_s": 2180.447684288025, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x000002028227AA60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2180.447684288025, "timesteps_since_restore": 0, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 9.614285714285714, "ram_util_percent": 52.57142857142857}}
{"episode_reward_max": 206.70246805250625, "episode_reward_min": 80.48793830722568, "episode_reward_mean": 152.54920272844697, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 26.519064123431832}, "policy_reward_max": {"shared_policy": 69.17192178219555}, "policy_reward_mean": {"shared_policy": 50.84973424281566}, "custom_metrics": {}, "hist_stats": {"episode_reward": [81.3735032249242, 162.585242538713, 146.71372683718795, 162.551470402628, 140.32498939707915, 116.80335263907908, 146.35415598936387, 166.4127967730164, 172.87211479246628, 160.56340524088583, 154.20418229699135, 126.40283353812993, 128.37615451414604, 123.38931249314916, 143.565370268654, 130.6546700149775, 171.05862975493073, 161.00586456805482, 161.90215640701322, 148.87368442304458, 206.28667690604905, 171.80444357171683, 134.93253333866596, 99.82013139128682, 167.10919317044298, 140.9179362589494, 127.14495123177764, 206.70246805250625, 129.4013624079525, 155.43598963320264, 156.65192113164832, 167.29002040205523, 178.281890153885, 152.53535222832548, 131.57781463116396, 138.5849140584467, 163.87557676155097, 196.9225976318123, 137.19643186591563, 148.18910964671545, 175.42891330458224, 154.63098034262686, 179.69272836111483, 123.81946565955876, 150.57931803679094, 161.08575844764707, 147.01954112574455, 141.53856342338295, 103.11875151097772, 162.33578974753604, 151.62067460641262, 173.37351107830196, 163.6653234763069, 178.57676197122785, 119.19015154242516, 153.1603452842684, 176.9746874426782, 169.1225226558745, 139.65579093992702, 151.6945702135566, 158.46704951673723, 172.4657948464155, 168.29451109096388, 136.73180869594222, 151.6788017246874, 182.75618393719205, 188.4469130709768, 151.4805152080953, 157.56851062923656, 133.43447433598342, 191.94837850518513, 153.98061257135083, 116.22725192829964, 190.2934774346648, 135.5002321284263, 143.98005658015614, 134.51220798492423, 149.50079846568397, 125.32686929148619, 131.47487519960845, 132.91166996024543, 149.11115661263509, 126.27254928648472, 166.9891364164649, 138.4986911686138, 80.48793830722568, 171.73407313227642, 173.7944988971578, 146.71881696581812, 189.51051248610023, 172.59397992864237, 149.3796333856882, 163.37808791548002, 145.34931075200402, 152.5897782817481, 185.60656897537413, 148.90069649182257, 170.53295605699537, 175.18391599133608, 148.37389892712235], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_shared_policy_reward": [27.034999016672373, 27.185065034776926, 27.153439173474908, 54.40516983127843, 54.34394847104947, 53.83612423638503, 48.873153676589325, 48.22882195313771, 49.611751207460955, 54.04305781672399, 54.380217115084335, 54.128195470819875, 46.86265011255939, 46.868421127398804, 46.59391815712054, 39.27963547625889, 38.2444994499286, 39.279217712891594, 49.04552887876828, 49.04870577839513, 48.25992133220036, 54.8273103137811, 55.98749077071746, 55.597995688517884, 57.30614851415156, 57.64119609445332, 57.92477018386124, 53.18558944265048, 53.68883920243631, 53.68897659579913, 51.39866738518079, 51.50413918246825, 51.3013757293423, 41.96385836601257, 41.99379926919937, 42.44517590291798, 42.902409270522185, 42.78410226665437, 42.68964297696948, 41.02834926793972, 41.282452625377715, 41.07851059983173, 48.11019517186408, 47.37660980721314, 48.078565289576844, 43.49463242292404, 43.451247468590736, 43.70879012346268, 57.100660324096665, 56.65299919247626, 57.30497023835777, 53.814033287266895, 53.62419267992179, 53.567638600866005, 54.0370938864847, 54.204171861832336, 53.66089065869649, 49.5566120892763, 49.55294174700974, 49.76413058675824, 68.69045539697011, 68.70601586004098, 68.89020564903815, 57.06345750391482, 57.225973218679414, 57.51501284912227, 44.71307701865831, 44.81634936730066, 45.40310695270696, 33.08955245713392, 33.51502888898054, 33.215550045172364, 55.66779212156932, 55.98558472531538, 55.455816323558494, 46.62040510773657, 47.298499570228145, 46.99903158098458, 42.76621103535095, 42.44387399653593, 41.93486619989076, 68.71028209477662, 69.17192178219555, 68.82026417553423, 42.80591708918412, 43.100006630023316, 43.4954386887451, 51.69183102250098, 51.95292268693446, 51.791235923767076, 52.1670794437329, 52.41036826713632, 52.074473420778915, 55.72145140916108, 55.59201426059006, 55.97655473230405, 59.38240533073743, 59.417633091409996, 59.48185173173745, 51.355755565804415, 50.84594243764876, 50.333654224872575, 44.031944448749215, 43.46276397506395, 44.08310620735088, 46.439854254325226, 46.1907044549783, 45.95435534914334, 54.69620990908395, 54.68070081310968, 54.49866603935759, 65.88182357931508, 65.88644755398853, 65.15432649850844, 46.02913311930993, 45.6634956623117, 45.50380308429399, 49.30293185139696, 49.370638965318605, 49.51553882999967, 58.07480168342589, 58.677313419058905, 58.6767982020974, 51.44070236633222, 51.53889708841841, 51.65138088787596, 59.83713332563637, 59.795303307473645, 60.0602917280048, 41.49217514445384, 40.797148068745926, 41.530142446358994, 50.34253363978739, 49.919308202962085, 50.317476194041475, 53.41303540269534, 53.72923558453719, 53.94348746041457, 48.67155215144156, 49.25335601344703, 49.09463296085595, 47.20289348314206, 46.788017327586815, 47.54765261265372, 34.8918731684486, 33.75799251596132, 34.4688858265678, 54.17049635015427, 53.972833648324, 54.192459749057875, 50.19354553520678, 50.72988826408981, 50.69724080711602, 57.56587833662827, 57.81725859766205, 57.99037414401148, 54.30516593158244, 54.99889269005506, 54.36126485466956, 59.257311897973224, 59.565152845035, 59.75429722821961, 40.044260770082474, 39.687977731227875, 39.45791304111481, 50.60838719209035, 51.05084256579478, 51.50111552638312, 58.588033080101, 59.422713451582226, 58.96394091099499, 55.55063419540723, 56.94653513406713, 56.625353326400116, 46.5244750107328, 46.565203386048466, 46.566112543145806, 50.72192271302144, 50.38250257323186, 50.590144927303, 52.71454181273778, 52.89589584556718, 52.85661185843249, 57.51459580411513, 57.43571304281552, 57.51548599948485, 56.49452622607349, 55.74220204353331, 56.057782821357236, 45.94728113089998, 45.686952014764145, 45.09757555027802, 50.981986710801706, 50.00148463249205, 50.69533038139342, 60.08532314499219, 61.37662912656863, 61.29423166563113, 62.690222091972814, 62.97586259990929, 62.78082837909459, 50.26658033331235, 50.59755080689986, 50.61638406788309, 52.00086252391337, 52.76762520521878, 52.80002290010451, 44.76320158938566, 44.69317474650839, 43.97809800008932, 64.03235753066836, 64.03753485530613, 63.878486119210706, 50.238433470328644, 51.79742920150359, 51.94474989951898, 38.773963316033274, 38.74108977584788, 38.71219883641848, 63.95213853598882, 62.37854145963986, 63.962797439036265, 45.34554483927786, 44.92005968093872, 45.23462760820985, 48.07850520809491, 48.31240528946121, 47.58914608259995, 44.676383793354034, 44.87363985180855, 44.962184339761734, 49.97994054853915, 50.139666961505995, 49.38119095563887, 41.409806723395974, 41.82470534245172, 42.092357225638494, 43.6519855732719, 43.845937560002, 43.976952066334576, 44.4854666677614, 43.882553448279694, 44.54364984420438, 49.64422446986039, 49.959702913959816, 49.50722922881444, 41.979729518294334, 42.07163406908512, 42.22118569910526, 55.72167024140556, 55.653486159940556, 55.61398001511891, 45.59812447428703, 46.90520274359733, 45.99536395072937, 27.097504439453274, 26.519064123431832, 26.87136974434057, 57.4789191931486, 57.37642267346381, 56.878731265664086, 58.03138059160362, 57.99941062058012, 57.76370768497388, 48.67775578796862, 48.947857998311505, 49.093203179538236, 62.98874767621358, 62.98440126826365, 63.53736354162295, 57.54127013807495, 57.71376048525174, 57.33894930531581, 49.50451649725436, 50.04986805841325, 49.82524883002041, 54.72887106239794, 54.643518216907964, 54.00569863617419, 48.909117009490714, 48.257697641849504, 48.182496100664125, 51.07173145314057, 50.762602915366486, 50.75544391324122, 62.06285797618328, 61.82982952892779, 61.71388147026299, 49.56967036426066, 49.71197490766643, 49.61905121989547, 56.74095327655475, 56.72986133644979, 57.0621414439908, 58.21011750400065, 58.5240104459226, 58.449788041412816, 49.24236768484114, 49.54662838578223, 49.58490285649894]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14656117971432672, "mean_inference_ms": 0.7102790346081305, "mean_action_processing_ms": 0.10183416067476302, "mean_env_wait_ms": 0.8421447795340398, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1010000, "timesteps_this_iter": 0, "agent_timesteps_total": 3030000, "timers": {"sample_time_ms": 11390.603, "sample_throughput": 438.958, "load_time_ms": 0.022, "load_throughput": 225986206.897, "learn_time_ms": 1692.112, "learn_throughput": 2954.887, "update_time_ms": 7.94}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.5703220359970546e-36, "cur_lr": 0.0005000000000000001, "total_loss": 12.430829811096192, "policy_loss": 0.03621534077137696, "vf_loss": 12.496769237518311, "vf_explained_var": 0.08625330328941345, "kl": 4020.867846679694, "entropy": 10.215450096130372, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1010000, "num_agent_steps_sampled": 3030000, "num_steps_trained": 1010000, "num_agent_steps_trained": 3030000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2879, "training_iteration": 202, "trial_id": "23630_00000", "experiment_id": "02fd7ca822e9403d8825e6f6648e353a", "date": "2024-01-26_01-45-53", "timestamp": 1706229953, "time_this_iter_s": 10.914105415344238, "time_total_s": 2191.361789703369, "pid": 27044, "hostname": "WAMAS-059", "node_ip": "127.0.0.1", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 500, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Base_Model", "custom_model_config": {"env": "sisl", "env_args": {"max_cycles": 500, "forward_reward": 2, "map_name": "multiwalker"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": false, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 20, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "ippo", "space_obs": "Dict(obs:Box([-inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf -inf\n -inf -inf -inf], [inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf\n inf inf inf inf inf inf inf inf inf inf inf inf inf], (31,), float32))", "space_act": "Box([-1. -1. -1. -1.], [1. 1. 1. 1.], (4,), float32)", "num_agents": 3, "episode_limit": 500, "policy_mapping_info": {"multiwalker": {"description": "one team cooperate", "team_prefix": ["walker_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "pursuit": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "waterworld": {"description": "one team cooperate", "team_prefix": ["pursuer_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["walker_0", "walker_1", "walker_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "sisl_multiwalker", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.IPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_il.<locals>.<lambda> at 0x00000202837C8940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2191.361789703369, "timesteps_since_restore": 0, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 11.78125, "ram_util_percent": 52.60625}}
